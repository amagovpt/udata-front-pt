var Rc=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var A=(t,e,n)=>(Rc(t,e,"read from private field"),n?n.call(t):e.get(t)),ie=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},G=(t,e,n,r)=>(Rc(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);var lp=(t,e,n)=>(Rc(t,e,"access private method"),n);import{a as Qe,g as Eb,c as rt,r as Nb,R as Db,y as Nt,b as zd,d as Uo,s as Ab,p as ge,e as vn,f as Br,h as pa,i as Ic,j as cp,n as Rb,t as rl,k as ol,u as be,_ as dr,Z as Ib,l as Fl,m as Wo,o as zg,q as xo,v as xn,w as Er,x as Oa,z as Pb,A as Lb,C as zb,B as Bd,D as ei,E as Wi,F as Vl,G as Bb,H as Fb,I as Vb,J as Hb,K as qr,L as Hl,M as Pc,N as qb,O as Ub,P as Wb,Q as jb,S as Fd,T as ji,U as Kb,V as up,W as Ou,X as Yb,Y as Bg,$ as Mu,a0 as Eu,a1 as Nu,a2 as Ki,a3 as dp,a4 as Gb,a5 as Jb,a6 as Du,a7 as Fg,a8 as fp,a9 as Xb,aa as Zb,ab as Qb,ac as ew,ad as Au,ae as tw,af as nw,ag as rw,ah as ow,ai as sw,aj as iw,ak as aw,al as lw}from"./i18n.6.2.4.js";import*as hp from"vue";import{defineComponent as L,inject as Ye,useAttrs as cw,computed as O,openBlock as b,createElementBlock as k,mergeProps as Tn,renderSlot as Le,createBlock as j,unref as m,normalizeProps as uw,withCtx as W,withAsyncContext as dw,createCommentVNode as I,normalizeClass as ae,ref as T,createVNode as M,createElementVNode as g,toDisplayString as C,toValue as Ke,watch as He,onMounted as De,nextTick as mi,getCurrentInstance as _s,getCurrentScope as fw,onScopeDispose as hw,customRef as Vg,onUpdated as Hg,isRef as sl,shallowRef as yr,watchEffect as bt,Fragment as K,createTextVNode as U,cloneVNode as pw,h as st,provide as at,onUnmounted as fn,Teleport as Pr,reactive as So,Suspense as qg,normalizeStyle as Ts,resolveDynamicComponent as to,renderList as Ne,withModifiers as ye,defineAsyncComponent as Ug,readonly as ql,resolveComponent as Je,withDirectives as nt,vModelText as Nr,onBeforeMount as Vd,onBeforeUnmount as Wg,Transition as Yi,vShow as fr,render as pp,TransitionGroup as mw,vModelSelect as Ul,withKeys as Hd,isReactive as gw,isReadonly as vw,pushScopeId as yw,popScopeId as bw,markRaw as Wl,toRaw as il,useId as mp,useTemplateRef as ww,createApp as kw}from"vue";import{ContentLoader as Gi}from"vue-content-loader";import{c as Cw,g as xw}from"./_commonjsHelpers.6.2.4.js";function YL(){import.meta.url,import("_").catch(()=>1);async function*t(){}}let ma=null;function Sw(){return Eb("reuses/types/")}async function _w(){return ma||(ma=(await Qe.get(Sw())).data,ma)}function Tw(t,e){const n=t.find(r=>r.id===e);return n?n.label:""}let ga=null;async function jg(){return ga||(ga=Qe.get("datasets/schemas/").then(t=>t.data),ga)}function $w(t,e){return t.find(n=>(e==null?void 0:e.name)===n.name)||null}function Ow(t){return"".concat(rt.schema_documentation_url).concat(t,"/")}function Mw(t,e){var o;if(!t.schema||!t.schema.name)return null;let n={schema_name:"schema-datagouvfr.".concat(t.schema.name)};if(t.schema&&t.schema.version){const s=t.schema.version,i=(o=e.versions.find(a=>a.version_name===s))==null?void 0:o.schema_url;i&&(n={schema_url:i})}const r=new URLSearchParams({input:"url",url:t.url,"header-case":"on",...n}).toString();return"".concat(rt.schema_validata_url,"/table-schema?").concat(r)}const Ew=["href"],ps=L({__name:"AppLink",props:{to:{},custom:{type:Boolean},activeClass:{},exactActiveClass:{},ariaCurrentValue:{default:"page"},viewTransition:{type:Boolean},replace:{type:Boolean}},setup(t){const e=Ye(Nb,null),n=cw(),r=O(()=>({...n,target:e?"_blank":n.target}));function o(s){return!e||typeof s=="string"&&s.startsWith("http")}return(s,i)=>o(t.to)?(b(),k("a",Tn({key:0},r.value,{href:t.to}),[Le(s.$slots,"default")],16,Ew)):(b(),j(m(Db),uw(Tn({key:1},s.$props)),{default:W(()=>[Le(s.$slots,"default")]),_:3},16))}}),Kg=L({__name:"AsyncTextClamp",props:{maxLines:{},text:{}},async setup(t){let e,n;const r=t,o=([e,n]=dw(()=>r.text),e=await e,n(),e);return(s,i)=>m(o)?(b(),j(m(Nt),{key:0,text:m(o),"max-lines":t.maxLines},null,8,["text","max-lines"])):I("",!0)}});function Nw(t,e){const n=(r,o)=>"".concat(rt.api_root,"avatars/").concat(r,"/").concat(o);return t.avatar_thumbnail||n(t.id,e)}const Dw=["src","width","height"],Yg=L({__name:"Avatar",props:{rounded:{type:Boolean,default:!1},size:{default:40},user:{}},setup(t){const e=t,n=O(()=>Nw(e.user,e.size));return(r,o)=>(b(),k("img",{class:ae({"rounded-circle border border-default-grey":t.rounded}),src:n.value,width:t.size,height:t.size,loading:"lazy",alt:""},null,10,Dw))}}),Aw={name:"ri-bank-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M2 20h20v2H2v-2zm2-8h2v7H4v-7zm5 0h2v7H9v-7zm4 0h2v7h-2v-7zm5 0h2v7h-2v-7zM2 7l10-5 10 5v4H2V7zm2 1.236V9h16v-.764l-8-4-8 4zM12 8a1 1 0 110-2 1 1 0 010 2z"/>'},Rw={name:"ri-building-2-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M3 19V5.7a1 1 0 01.658-.94l9.671-3.516a.5.5 0 01.671.47v4.953l6.316 2.105a1 1 0 01.684.949V19h2v2H1v-2h2zm2 0h7V3.855L5 6.401V19zm14 0v-8.558l-5-1.667V19h5z"/>'},Iw={name:"ri-check-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"/>'},Pw={name:"ri-clipboard-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M7 4V2h10v2h3.007c.548 0 .993.445.993.993v16.014a.994.994 0 01-.993.993H3.993A.994.994 0 013 21.007V4.993C3 4.445 3.445 4 3.993 4H7zm0 2H5v14h14V6h-2v2H7V6zm2-2v2h6V4H9z"/>'},Lw={name:"ri-community-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M21 21H3a1 1 0 01-1-1v-7.513a1 1 0 01.343-.754L6 8.544V4a1 1 0 011-1h14a1 1 0 011 1v16a1 1 0 01-1 1zM9 19h3v-6.058L8 9.454l-4 3.488V19h3v-4h2v4zm5 0h6V5H8v2.127c.234 0 .469.082.657.247l5 4.359a1 1 0 01.343.754V19zm2-8h2v2h-2v-2zm0 4h2v2h-2v-2zm0-8h2v2h-2V7zm-4 0h2v2h-2V7z"/>'},zw={name:"ri-download-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M3 19h18v2H3v-2zm10-5.828L19.071 7.1l1.414 1.414L12 17 3.515 8.515 4.929 7.1 11 13.17V2h2v11.172z"/>'},Bw={name:"ri-file-copy-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M7 6V3a1 1 0 011-1h12a1 1 0 011 1v14a1 1 0 01-1 1h-3v3c0 .552-.45 1-1.007 1H4.007A1.001 1.001 0 013 21l.003-14c0-.552.45-1 1.007-1H7zM5.003 8L5 20h10V8H5.003zM9 6h8v10h2V4H9v2z"/>'},Fw={name:"ri-file-warning-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M15 4H5v16h14V8h-4V4zM3 2.992C3 2.444 3.447 2 3.999 2H16l5 5v13.993A1 1 0 0120.007 22H3.993A1 1 0 013 21.008V2.992zM11 15h2v2h-2v-2zm0-8h2v6h-2V7z"/>'},Vw={name:"ri-government-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M20 6h3v2h-1v11h1v2H1v-2h1V8H1V6h3V4a1 1 0 011-1h14a1 1 0 011 1v2zm0 2H4v11h3v-7h2v7h2v-7h2v7h2v-7h2v7h3V8zM6 5v1h12V5H6z"/>'},Hw={name:"ri-user-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M4 22a8 8 0 1116 0h-2a6 6 0 10-12 0H4zm8-9c-3.315 0-6-2.685-6-6s2.685-6 6-6 6 2.685 6 6-2.685 6-6 6zm0-2c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4z"/>'},qw={key:0,style:{color:"#3558a2"}},Uw={key:1},Ww=L({__name:"CopyButton",props:{text:{},label:{},copiedLabel:{},hideLabel:{type:Boolean,default:!1}},setup(t){zd(Iw,Pw,Bw);const e=t,n=T(!1),r=()=>{navigator.clipboard.writeText(e.text),n.value=!0,setTimeout(()=>n.value=!1,2e3)};return(o,s)=>(b(),k("button",{type:"button",onClick:r,class:ae(["fr-text--sm fr-mb-0 whitespace-nowrap relative fr-p-1v text-mention-grey line-height-1",{"border bg-white rounded-xxs text-grey-500":t.hideLabel}])},[n.value?(b(),k("span",qw,[M(m(Uo),{height:16,width:16,name:"ri-check-line"}),g("span",{class:ae(["fr-ml-1v copy-label",{"fr-sr-only":t.hideLabel}])},C(t.copiedLabel),3)])):I("",!0),n.value?I("",!0):(b(),k("span",Uw,[M(m(Uo),{height:16,width:16,name:t.hideLabel?"ri-clipboard-line":"ri-file-copy-line",class:"copy-icon"},null,8,["name"]),g("span",{class:ae(["fr-ml-1v copy-link copy-label",{"fr-sr-only":t.hideLabel}])},C(t.label),3)]))],2))}}),ke=(t,e)=>{const n=t.__vccOpts||t;for(const[r,o]of e)n[r]=o;return n},Wr=ke(Ww,[["__scopeId","data-v-4d7d7e27"]]);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var gi=function(){return gi=Object.assign||function(e){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},gi.apply(this,arguments)};function qd(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n}var Ud=function(t){var e=t.onRead,n=t.onRender,r=t.uncachedValues,o=r===void 0?new Set:r,s=t.useCache,i=s===void 0?!0:s;return function(a){a===void 0&&(a={});var l=qd(a,[]),c={},u=[],d=!1;function f(h,v){h.startsWith("--")&&(l.hasCSSVariable=!0);var y=c[h];c[h]=v,c[h]!==y&&(u.indexOf(h)===-1&&u.push(h),d||(d=!0,Ab.render(p.render)))}var p={get:function(h,v){v===void 0&&(v=!1);var y=!v&&i&&!o.has(h)&&c[h]!==void 0;return y?c[h]:e(h,l)},set:function(h,v){if(typeof h=="string")f(h,v);else for(var y in h)f(y,h[y]);return this},render:function(h){return h===void 0&&(h=!1),(d||h===!0)&&(n(c,l,u),d=!1,u.length=0),this}};return p}},jw=/([a-z])([A-Z])/g,Kw="$1-$2",jl=function(t){return t.replace(jw,Kw).toLowerCase()},Gg=new Map,Wd=new Map,Jg=["Webkit","Moz","O","ms",""],Yw=Jg.length,Gw=typeof document<"u",Lc,Xg=function(t,e){return Wd.set(t,jl(e))},Jw=function(t){Lc=Lc||document.createElement("div");for(var e=0;e<Yw;e++){var n=Jg[e],r=n==="",o=r?t:n+t.charAt(0).toUpperCase()+t.slice(1);if(o in Lc.style||r){if(r&&t==="clipPath"&&Wd.has(t))return;Gg.set(t,o),Xg(t,(r?"":"-")+jl(o))}}},Xw=function(t){return Xg(t,t)},Zg=function(t,e){e===void 0&&(e=!1);var n=e?Wd:Gg;return n.has(t)||(Gw?Jw(t):Xw(t)),n.get(t)||t},Zw=["","X","Y","Z"],Qw=["translate","scale","rotate","skew","transformPerspective"],Ru=Qw.reduce(function(t,e){return Zw.reduce(function(n,r){return n.push(e+r),n},t)},["x","y","z"]),e2=Ru.reduce(function(t,e){return t[e]=!0,t},{});function jd(t){return e2[t]===!0}function t2(t,e){return Ru.indexOf(t)-Ru.indexOf(e)}var n2=new Set(["originX","originY","originZ"]);function r2(t){return n2.has(t)}var gp=gi(gi({},Rb),{transform:Math.round}),o2={color:vn,backgroundColor:vn,outlineColor:vn,fill:vn,stroke:vn,borderColor:vn,borderTopColor:vn,borderRightColor:vn,borderBottomColor:vn,borderLeftColor:vn,borderWidth:ge,borderTopWidth:ge,borderRightWidth:ge,borderBottomWidth:ge,borderLeftWidth:ge,borderRadius:ge,radius:ge,borderTopLeftRadius:ge,borderTopRightRadius:ge,borderBottomRightRadius:ge,borderBottomLeftRadius:ge,width:ge,maxWidth:ge,height:ge,maxHeight:ge,size:ge,top:ge,right:ge,bottom:ge,left:ge,padding:ge,paddingTop:ge,paddingRight:ge,paddingBottom:ge,paddingLeft:ge,margin:ge,marginTop:ge,marginRight:ge,marginBottom:ge,marginLeft:ge,rotate:Br,rotateX:Br,rotateY:Br,rotateZ:Br,scale:pa,scaleX:pa,scaleY:pa,scaleZ:pa,skew:Br,skewX:Br,skewY:Br,distance:ge,translateX:ge,translateY:ge,translateZ:ge,x:ge,y:ge,z:ge,perspective:ge,opacity:Ic,originX:cp,originY:cp,originZ:ge,zIndex:gp,fillOpacity:Ic,strokeOpacity:Ic,numOctaves:gp},Kd=function(t){return o2[t]},s2=function(t,e){return e&&typeof t=="number"?e.transform(t):t},ti="scrollLeft",ni="scrollTop",Qg=new Set([ti,ni]),i2=new Set([ti,ni,"transform"]),a2={x:"translateX",y:"translateY",z:"translateZ"};function e1(t){return typeof t=="function"}function l2(t,e,n,r,o,s){s===void 0&&(s=!0);var i="",a=!1;n.sort(t2);for(var l=n.length,c=0;c<l;c++){var u=n[c];i+=(a2[u]||u)+"("+e[u]+") ",a=u==="z"?!0:a}return!a&&o?i+="translateZ(0)":i=i.trim(),e1(t.transform)?i=t.transform(e,r?"":i):s&&r&&(i="none"),i}function c2(t,e,n,r,o,s,i,a){e===void 0&&(e=!0),n===void 0&&(n={}),r===void 0&&(r={}),o===void 0&&(o={}),s===void 0&&(s=[]),i===void 0&&(i=!1),a===void 0&&(a=!0);var l=!0,c=!1,u=!1;for(var d in t){var f=t[d],p=Kd(d),h=s2(f,p);jd(d)?(c=!0,r[d]=h,s.push(d),l&&(p.default&&f!==p.default||!p.default&&f!==0)&&(l=!1)):r2(d)?(o[d]=h,u=!0):(!i2.has(d)||!e1(h))&&(n[Zg(d,i)]=h)}return(c||typeof t.transform=="function")&&(n.transform=l2(t,r,s,l,e,a)),u&&(n.transformOrigin=(o.originX||"50%")+" "+(o.originY||"50%")+" "+(o.originZ||0)),n}function Yd(t){var e=t===void 0?{}:t,n=e.enableHardwareAcceleration,r=n===void 0?!0:n,o=e.isDashCase,s=o===void 0?!0:o,i=e.allowTransformNone,a=i===void 0?!0:i,l={},c={},u={},d=[];return function(f){return d.length=0,c2(f,r,l,c,u,d,s,a),l}}function u2(t,e){var n=e.element,r=e.preparseOutput,o=Kd(t);if(jd(t))return o&&o.default||0;if(Qg.has(t))return n[t];var s=window.getComputedStyle(n,null).getPropertyValue(Zg(t,!0))||0;return r&&o&&o.test(s)&&o.parse?o.parse(s):s}function d2(t,e,n){var r=e.element,o=e.buildStyles,s=e.hasCSSVariable;if(Object.assign(r.style,o(t)),s)for(var i=n.length,a=0;a<i;a++){var l=n[a];l.startsWith("--")&&r.style.setProperty(l,t[l])}n.indexOf(ti)!==-1&&(r[ti]=t[ti]),n.indexOf(ni)!==-1&&(r[ni]=t[ni])}var f2=Ud({onRead:u2,onRender:d2,uncachedValues:Qg});function h2(t,e){e===void 0&&(e={});var n=e.enableHardwareAcceleration,r=e.allowTransformNone,o=qd(e,["enableHardwareAcceleration","allowTransformNone"]);return f2(gi({element:t,buildStyles:Yd({enableHardwareAcceleration:n,allowTransformNone:r}),preparseOutput:!0},o))}var t1=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues"]),vp=.5,n1=function(){return{style:{}}},zc=function(t,e){return ge.transform(t*e)},p2={x:0,y:0,width:0,height:0};function yp(t,e,n){return typeof t=="string"?t:ge.transform(e+n*t)}function m2(t,e,n){return yp(e,t.x,t.width)+" "+yp(n,t.y,t.height)}var r1={enableHardwareAcceleration:!1,isDashCase:!1};function g2(t,e,n,r,o,s){e===void 0&&(e=p2),r===void 0&&(r=Yd(r1)),o===void 0&&(o=n1()),s===void 0&&(s=!0);var i=t.attrX,a=t.attrY,l=t.originX,c=t.originY,u=t.pathLength,d=t.pathSpacing,f=d===void 0?1:d,p=t.pathOffset,h=p===void 0?0:p,v=qd(t,["attrX","attrY","originX","originY","pathLength","pathSpacing","pathOffset"]),y=r(v);for(var w in y)if(w==="transform")o.style.transform=y[w];else{var x=s&&!t1.has(w)?jl(w):w;o[x]=y[w]}return(l!==void 0||c!==void 0||y.transform)&&(o.style.transformOrigin=m2(e,l!==void 0?l:vp,c!==void 0?c:vp)),i!==void 0&&(o.x=i),a!==void 0&&(o.y=a),n!==void 0&&u!==void 0&&(o[s?"stroke-dashoffset":"strokeDashoffset"]=zc(-h,n),o[s?"stroke-dasharray":"strokeDasharray"]=zc(u,n)+" "+zc(f,n)),o}function v2(t,e,n){n===void 0&&(n=!0);var r=n1(),o=Yd(r1);return function(s){return g2(s,t,e,o,r,n)}}var y2=function(t){return typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()},b2=function(t){try{return y2(t)}catch(e){return{x:0,y:0,width:0,height:0}}},w2=function(t){return t.tagName==="path"},k2=Ud({onRead:function(t,e){var n=e.element;if(t=t1.has(t)?t:jl(t),jd(t)){var r=Kd(t);return r&&r.default||0}else return n.getAttribute(t)},onRender:function(t,e){var n=e.element,r=e.buildAttrs,o=r(t);for(var s in o)s==="style"?Object.assign(n.style,o.style):n.setAttribute(s,o[s])}}),C2=function(t){var e=b2(t),n=w2(t)&&t.getTotalLength?t.getTotalLength():void 0;return k2({element:t,buildAttrs:v2(e,n)})},x2=Ud({useCache:!1,onRead:function(t){return t==="scrollTop"?window.pageYOffset:window.pageXOffset},onRender:function(t){var e=t.scrollTop,n=e===void 0?0:e,r=t.scrollLeft,o=r===void 0?0:r;return window.scrollTo(o,n)}}),Iu=new WeakMap,S2=function(t){return t instanceof HTMLElement||typeof t.click=="function"},_2=function(t){return t instanceof SVGElement||"ownerSVGElement"in t},T2=function(t,e){var n;return t===window?n=x2(t):S2(t)?n=h2(t,e):_2(t)&&(n=C2(t)),Iu.set(t,n),n},$2=function(t,e){return Iu.has(t)?Iu.get(t):T2(t,e)};function o1(t,e){var n=typeof t=="string"?document.querySelector(t):t;return $2(n,e)}function s1(t,e,n=0){if(t){const r=o1(t);e?(r.set({display:"block"}),r.render(!0),rl({from:{height:0,padding:0},to:{height:t.scrollHeight+2*n,padding:n},duration:300,ease:ol}).start({update:r.set,complete:()=>r.set({height:"auto"})})):rl({from:{height:t.scrollHeight,padding:n},to:{height:0,padding:0},duration:300,ease:ol}).start({update:r.set,complete:()=>r.set({height:0,display:"none"})})}}const al="public-service",Pu="association",Lu="company",ll="local-authority",Kl="other",i1="user";function Vo(t,e){return a1(t,e)}function a1(t,e){return Ke(t).badges.some(n=>n.kind===e)}function l1(){const{t}=be();return[{type:al,label:t("Public service"),icon:"ri-bank-line"},{type:ll,label:t("Local authority"),icon:"ri-government-line"},{type:Pu,label:t("Association"),icon:"ri-community-line"},{type:Lu,label:t("Company"),icon:"ri-building-2-line"},{type:Kl,label:t("Other"),icon:""},{type:i1,label:t("User"),icon:"ri-user-line"}]}function c1(t){return l1().find(e=>e.type===t)}function O2(t){const e=O(()=>Vo(t,al)),n=O(()=>Vo(t,Pu)),r=O(()=>Vo(t,ll)),o=O(()=>Vo(t,Lu));return{type:O(()=>r.value?ll:e.value?al:n.value?Pu:o.value?Lu:Kl)}}const bp=14,M2=L({__name:"OwnerTypeIcon",props:{type:{}},setup(t){zd(Aw,Rw,Lw,Vw,Hw);const e=t,n=O(()=>c1(e.type).icon);return(r,o)=>n.value?(b(),j(m(Uo),{key:0,height:bp,width:bp,name:n.value},null,8,["name"])):I("",!0)}}),Gd=ke(M2,[["__scopeId","data-v-7acefa45"]]),E2="certified";function N2(t){return{organizationCertified:O(()=>{const n=Ke(t);return n?a1(n,E2)&&(Vo(n,al)||Vo(n,ll)):!1})}}const D2=["title"],uo=L({__name:"OrganizationNameWithCertificate",props:{organization:{},showType:{type:Boolean,default:!0}},setup(t){const{t:e}=be(),n=t,{type:r}=O2(n.organization),{organizationCertified:o}=N2(n.organization);return(s,i)=>(b(),k("span",{class:ae(["inline-flex",m(r)!==m(Kl)||m(o)?"fr-grid-row--middle":"align-items-baseline"])},[g("span",null,[t.showType?(b(),j(Gd,{key:0,type:m(r)},null,8,["type"])):I("",!0)]),M(m(Nt),{class:"fr-mx-1v","auto-resize":!0,text:t.organization.name,"max-lines":1},null,8,["text"]),m(o)?(b(),k("span",{key:0,class:"fr-icon-success-line fr-icon--sm",title:m(e)("The identity of this public service is certified by {certifier}",{certifier:m(rt).title}),"aria-hidden":"true"},null,8,D2)):I("",!0)],2))}}),A2=(t,e)=>{const n=t[e];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((r,o)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(o.bind(null,new Error("Unknown variable dynamic import: "+e)))})};function R2(t){return fw()?(hw(t),!0):!1}function zu(t){return typeof t=="function"?t():m(t)}const I2=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Bu=()=>{};function u1(t,e){function n(...r){return new Promise((o,s)=>{Promise.resolve(t(()=>e.apply(this,r),{fn:e,thisArg:this,args:r})).then(o).catch(s)})}return n}const P2=t=>t();function L2(t,e={}){let n,r,o=Bu;const s=a=>{clearTimeout(a),o(),o=Bu};return a=>{const l=zu(t),c=zu(e.maxWait);return n&&s(n),l<=0||c!==void 0&&c<=0?(r&&(s(r),r=null),Promise.resolve(a())):new Promise((u,d)=>{o=e.rejectOnCancel?d:u,c&&!r&&(r=setTimeout(()=>{n&&s(n),r=null,u(a())},c)),n=setTimeout(()=>{r&&s(r),r=null,u(a())},l)})}}function z2(t){return t||_s()}function B2(t,e=200,n={}){return u1(L2(e,n),t)}function F2(t,e=200,n={}){const r=T(t.value),o=B2(()=>{r.value=t.value},e,n);return He(t,()=>o()),r}function d1(t,e=!0,n){z2()?De(t,n):e?t():mi(t)}function V2(t,e,n={}){const{eventFilter:r=P2,...o}=n,s=u1(r,e);let i,a,l;if(o.flush==="sync"){const c=T(!1);a=()=>{},i=u=>{c.value=!0,u(),c.value=!1},l=He(t,(...u)=>{c.value||s(...u)},o)}else{const c=[],u=T(0),d=T(0);a=()=>{u.value=d.value},c.push(He(t,()=>{d.value++},{...o,flush:"sync"})),i=f=>{const p=d.value;f(),u.value+=d.value-p},c.push(He(t,(...f)=>{const p=u.value>0&&u.value===d.value;u.value=0,d.value=0,!p&&s(...f)},o)),l=()=>{c.forEach(f=>f())}}return{stop:l,ignoreUpdates:i,ignorePrevAsyncUpdates:a}}function f1(t,e,n){let r;sl(n)?r={evaluating:n}:r=n||{};const{lazy:o=!1,evaluating:s=void 0,shallow:i=!0,onError:a=Bu}=r,l=T(!o),c=i?yr(e):T(e);let u=0;return bt(async d=>{if(!l.value)return;u++;const f=u;let p=!1;s&&Promise.resolve().then(()=>{s.value=!0});try{const h=await t(v=>{d(()=>{s&&(s.value=!1),p||v()})});f===u&&(c.value=h)}catch(h){a(h)}finally{s&&f===u&&(s.value=!1),p=!0}}),o?O(()=>(l.value=!0,c.value)):c}function jr(t){var e;const n=zu(t);return(e=n==null?void 0:n.$el)!=null?e:n}const h1=I2?window:void 0;function vi(t,e=null){const n=_s();let r=()=>{};const o=Vg((s,i)=>(r=i,{get(){var a,l;return s(),(l=(a=n==null?void 0:n.proxy)==null?void 0:a.$refs[t])!=null?l:e},set(){}}));return d1(r),Hg(r),o}function H2(){const t=T(!1),e=_s();return e&&De(()=>{t.value=!0},e),t}function q2(t){const e=H2();return O(()=>(e.value,!!t()))}function U2(t,e,n={}){const{window:r=h1,...o}=n;let s;const i=q2(()=>r&&"ResizeObserver"in r),a=()=>{s&&(s.disconnect(),s=void 0)},l=O(()=>Array.isArray(t)?t.map(d=>jr(d)):[jr(t)]),c=He(l,d=>{if(a(),i.value&&r){s=new ResizeObserver(e);for(const f of d)f&&s.observe(f,o)}},{immediate:!0,flush:"post"}),u=()=>{a(),c()};return R2(u),{isSupported:i,stop:u}}function W2(t,e={width:0,height:0},n={}){const{window:r=h1,box:o="content-box"}=n,s=O(()=>{var d,f;return(f=(d=jr(t))==null?void 0:d.namespaceURI)==null?void 0:f.includes("svg")}),i=T(e.width),a=T(e.height),{stop:l}=U2(t,([d])=>{const f=o==="border-box"?d.borderBoxSize:o==="content-box"?d.contentBoxSize:d.devicePixelContentBoxSize;if(r&&s.value){const p=jr(t);if(p){const h=p.getBoundingClientRect();i.value=h.width,a.value=h.height}}else if(f){const p=Array.isArray(f)?f:[f];i.value=p.reduce((h,{inlineSize:v})=>h+v,0),a.value=p.reduce((h,{blockSize:v})=>h+v,0)}else i.value=d.contentRect.width,a.value=d.contentRect.height},n);d1(()=>{const d=jr(t);d&&(i.value="offsetWidth"in d?d.offsetWidth:e.width,a.value="offsetHeight"in d?d.offsetHeight:e.height)});const c=He(()=>jr(t),d=>{i.value=d?e.width:0,a.value=d?e.height:0});function u(){l(),c()}return{width:i,height:a,stop:u}}const j2=["src","alt","width","height"],Fu=L({__name:"Placeholder",props:{type:{},src:{},alt:{},size:{}},setup(t){const e=t,n=async()=>{const s=await A2(Object.assign({"../../assets/img/placeholders/author.png":()=>dr(()=>import("./author.6.2.4.js"),[]),"../../assets/img/placeholders/dataset.png":()=>dr(()=>import("./dataset.6.2.4.js"),[]),"../../assets/img/placeholders/news.png":()=>dr(()=>import("./news.6.2.4.js"),[]),"../../assets/img/placeholders/organization.png":()=>dr(()=>import("./organization.6.2.4.js"),[]),"../../assets/img/placeholders/reuse.png":()=>dr(()=>import("./reuse.6.2.4.js"),[])}),"../../assets/img/placeholders/".concat(e.type,".png"));return e.src?e.src:s.default},r=O(()=>e.src?e.alt:""),o=f1(()=>n());return(s,i)=>(b(),k("img",Tn({loading:"lazy",src:m(o),alt:r.value,width:t.size,height:t.size},s.$attrs),null,16,j2))}}),K2=["value"],Bc=1,Y2=L({__name:"QualityScore",props:{score:{},class:{default:""}},setup(t){const e=t,n=Bc*2/3,{t:r,locale:o}=be(),s=O(()=>new Intl.NumberFormat(o.value,{style:"percent"}).format(e.score));return(i,a)=>(b(),k("meter",{class:ae(["quality-score",e.class]),min:"0",low:"0",high:n,max:Bc,optimum:Bc,value:t.score},[t.score>=n?(b(),k(K,{key:0},[U(C(m(r)("Good")),1)],64)):(b(),k(K,{key:1},[U(C(m(r)("To improve")),1)],64)),U("("+C(s.value)+") ",1)],10,K2))}}),G2={key:0,class:"fr-my-0"},J2={key:1,class:"fr-my-0 text-mention-grey"},or=L({__name:"QualityItem",props:{passed:{type:Boolean},messagePassed:{},messageFailed:{}},setup(t){return(e,n)=>(b(),k("li",null,[t.passed?(b(),k("p",G2,[n[0]||(n[0]=g("span",{class:"fr-icon-check-line","aria-hidden":"true"},null,-1)),U(" "+C(t.messagePassed),1)])):(b(),k("p",J2,[n[1]||(n[1]=g("span",{class:"fr-icon-warning-line","aria-hidden":"true"},null,-1)),U(" "+C(t.messageFailed),1)]))]))}});function X2(t){typeof queueMicrotask=="function"?queueMicrotask(t):Promise.resolve().then(t).catch(e=>setTimeout(()=>{throw e}))}var wp;let Z2=Symbol("headlessui.useid"),Q2=0;const Sr=(wp=hp.useId)!=null?wp:function(){return hp.inject(Z2,()=>"".concat(++Q2))()};function ee(t){var e;if(t==null||t.value==null)return null;let n=(e=t.value.$el)!=null?e:t.value;return n instanceof Node?n:null}function Ut(t,e,...n){if(t in e){let o=e[t];return typeof o=="function"?o(...n):o}let r=new Error('Tried to handle "'.concat(t,'" but there is no handler defined. Only defined handlers are: ').concat(Object.keys(e).map(o=>'"'.concat(o,'"')).join(", "),"."));throw Error.captureStackTrace&&Error.captureStackTrace(r,Ut),r}var ek=Object.defineProperty,tk=(t,e,n)=>e in t?ek(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,kp=(t,e,n)=>(tk(t,typeof e!="symbol"?e+"":e,n),n);let nk=class{constructor(){kp(this,"current",this.detect()),kp(this,"currentId",0)}set(e){this.current!==e&&(this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}},Yl=new nk;function Zn(t){if(Yl.isServer)return null;if(t instanceof Node)return t.ownerDocument;if(t!=null&&t.hasOwnProperty("value")){let e=ee(t);if(e)return e.ownerDocument}return document}let Vu=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(t=>"".concat(t,":not([tabindex='-1'])")).join(",");var it=(t=>(t[t.First=1]="First",t[t.Previous=2]="Previous",t[t.Next=4]="Next",t[t.Last=8]="Last",t[t.WrapAround=16]="WrapAround",t[t.NoScroll=32]="NoScroll",t))(it||{}),br=(t=>(t[t.Error=0]="Error",t[t.Overflow=1]="Overflow",t[t.Success=2]="Success",t[t.Underflow=3]="Underflow",t))(br||{}),rk=(t=>(t[t.Previous=-1]="Previous",t[t.Next=1]="Next",t))(rk||{});function Gl(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(Vu)).sort((e,n)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(n.tabIndex||Number.MAX_SAFE_INTEGER)))}var Jd=(t=>(t[t.Strict=0]="Strict",t[t.Loose=1]="Loose",t))(Jd||{});function p1(t,e=0){var n;return t===((n=Zn(t))==null?void 0:n.body)?!1:Ut(e,{0(){return t.matches(Vu)},1(){let r=t;for(;r!==null;){if(r.matches(Vu))return!0;r=r.parentElement}return!1}})}var ok=(t=>(t[t.Keyboard=0]="Keyboard",t[t.Mouse=1]="Mouse",t))(ok||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",t=>{t.metaKey||t.altKey||t.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",t=>{t.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:t.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));let sk=["textarea","input"].join(",");function ik(t){var e,n;return(n=(e=t==null?void 0:t.matches)==null?void 0:e.call(t,sk))!=null?n:!1}function Ro(t,e=n=>n){return t.slice().sort((n,r)=>{let o=e(n),s=e(r);if(o===null||s===null)return 0;let i=o.compareDocumentPosition(s);return i&Node.DOCUMENT_POSITION_FOLLOWING?-1:i&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function Ft(t,e,{sorted:n=!0,relativeTo:r=null,skipElements:o=[]}={}){var s;let i=(s=Array.isArray(t)?t.length>0?t[0].ownerDocument:document:t==null?void 0:t.ownerDocument)!=null?s:document,a=Array.isArray(t)?n?Ro(t):t:Gl(t);o.length>0&&a.length>1&&(a=a.filter(h=>!o.includes(h))),r=r!=null?r:i.activeElement;let l=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,a.indexOf(r))-1;if(e&4)return Math.max(0,a.indexOf(r))+1;if(e&8)return a.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=e&32?{preventScroll:!0}:{},d=0,f=a.length,p;do{if(d>=f||d+f<=0)return 0;let h=c+d;if(e&16)h=(h+f)%f;else{if(h<0)return 3;if(h>=f)return 1}p=a[h],p==null||p.focus(u),d+=l}while(p!==i.activeElement);return e&6&&ik(p)&&p.select(),2}function ak(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function lk(){return/Android/gi.test(window.navigator.userAgent)}function ck(){return ak()||lk()}function va(t,e,n){Yl.isServer||bt(r=>{document.addEventListener(t,e,n),r(()=>document.removeEventListener(t,e,n))})}function m1(t,e,n){Yl.isServer||bt(r=>{window.addEventListener(t,e,n),r(()=>window.removeEventListener(t,e,n))})}function uk(t,e,n=O(()=>!0)){function r(s,i){if(!n.value||s.defaultPrevented)return;let a=i(s);if(a===null||!a.getRootNode().contains(a))return;let l=function c(u){return typeof u=="function"?c(u()):Array.isArray(u)||u instanceof Set?u:[u]}(t);for(let c of l){if(c===null)continue;let u=c instanceof HTMLElement?c:ee(c);if(u!=null&&u.contains(a)||s.composed&&s.composedPath().includes(u))return}return!p1(a,Jd.Loose)&&a.tabIndex!==-1&&s.preventDefault(),e(s,a)}let o=T(null);va("pointerdown",s=>{var i,a;n.value&&(o.value=((a=(i=s.composedPath)==null?void 0:i.call(s))==null?void 0:a[0])||s.target)},!0),va("mousedown",s=>{var i,a;n.value&&(o.value=((a=(i=s.composedPath)==null?void 0:i.call(s))==null?void 0:a[0])||s.target)},!0),va("click",s=>{ck()||o.value&&(r(s,()=>o.value),o.value=null)},!0),va("touchend",s=>r(s,()=>s.target instanceof HTMLElement?s.target:null),!0),m1("blur",s=>r(s,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function Cp(t,e){if(t)return t;let n=e!=null?e:"button";if(typeof n=="string"&&n.toLowerCase()==="button")return"button"}function g1(t,e){let n=T(Cp(t.value.type,t.value.as));return De(()=>{n.value=Cp(t.value.type,t.value.as)}),bt(()=>{var r;n.value||ee(e)&&ee(e)instanceof HTMLButtonElement&&!((r=ee(e))!=null&&r.hasAttribute("type"))&&(n.value="button")}),n}var fo=(t=>(t[t.None=0]="None",t[t.RenderStrategy=1]="RenderStrategy",t[t.Static=2]="Static",t))(fo||{}),dk=(t=>(t[t.Unmount=0]="Unmount",t[t.Hidden=1]="Hidden",t))(dk||{});function Rt({visible:t=!0,features:e=0,ourProps:n,theirProps:r,...o}){var s;let i=y1(r,n),a=Object.assign(o,{props:i});if(t||e&2&&i.static)return Fc(a);if(e&1){let l=(s=i.unmount)==null||s?0:1;return Ut(l,{0(){return null},1(){return Fc({...o,props:{...i,hidden:!0,style:{display:"none"}}})}})}return Fc(a)}function Fc({props:t,attrs:e,slots:n,slot:r,name:o}){var s,i;let{as:a,...l}=b1(t,["unmount","static"]),c=(s=n.default)==null?void 0:s.call(n,r),u={};if(r){let d=!1,f=[];for(let[p,h]of Object.entries(r))typeof h=="boolean"&&(d=!0),h===!0&&f.push(p);d&&(u["data-headlessui-state"]=f.join(" "))}if(a==="template"){if(c=v1(c!=null?c:[]),Object.keys(l).length>0||Object.keys(e).length>0){let[d,...f]=c!=null?c:[];if(!fk(d)||f.length>0)throw new Error(['Passing props on "template"!',"","The current component <".concat(o,' /> is rendering a "template".'),"However we need to passthrough the following props:",Object.keys(l).concat(Object.keys(e)).map(v=>v.trim()).filter((v,y,w)=>w.indexOf(v)===y).sort((v,y)=>v.localeCompare(y)).map(v=>"  - ".concat(v)).join("\n"),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "template".',"Render a single element as the child so that we can forward the props onto that element."].map(v=>"  - ".concat(v)).join("\n")].join("\n"));let p=y1((i=d.props)!=null?i:{},l,u),h=pw(d,p,!0);for(let v in p)v.startsWith("on")&&(h.props||(h.props={}),h.props[v]=p[v]);return h}return Array.isArray(c)&&c.length===1?c[0]:c}return st(a,Object.assign({},l,u),{default:()=>c})}function v1(t){return t.flatMap(e=>e.type===K?v1(e.children):[e])}function y1(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},n={};for(let r of t)for(let o in r)o.startsWith("on")&&typeof r[o]=="function"?(n[o]!=null||(n[o]=[]),n[o].push(r[o])):e[o]=r[o];if(e.disabled||e["aria-disabled"])return Object.assign(e,Object.fromEntries(Object.keys(n).map(r=>[r,void 0])));for(let r in n)Object.assign(e,{[r](o,...s){let i=n[r];for(let a of i){if(o instanceof Event&&o.defaultPrevented)return;a(o,...s)}}});return e}function b1(t,e=[]){let n=Object.assign({},t);for(let r of e)r in n&&delete n[r];return n}function fk(t){return t==null?!1:typeof t.type=="string"||typeof t.type=="object"||typeof t.type=="function"}var ho=(t=>(t[t.None=1]="None",t[t.Focusable=2]="Focusable",t[t.Hidden=4]="Hidden",t))(ho||{});let po=L({name:"Hidden",props:{as:{type:[Object,String],default:"div"},features:{type:Number,default:1}},setup(t,{slots:e,attrs:n}){return()=>{var r;let{features:o,...s}=t,i={"aria-hidden":(o&2)===2?!0:(r=s["aria-hidden"])!=null?r:void 0,hidden:(o&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(o&4)===4&&(o&2)!==2&&{display:"none"}}};return Rt({ourProps:i,theirProps:s,slot:{},attrs:n,slots:e,name:"Hidden"})}}}),w1=Symbol("Context");var mo=(t=>(t[t.Open=1]="Open",t[t.Closed=2]="Closed",t[t.Closing=4]="Closing",t[t.Opening=8]="Opening",t))(mo||{});function k1(){return Ye(w1,null)}function hk(t){at(w1,t)}var dt=(t=>(t.Space=" ",t.Enter="Enter",t.Escape="Escape",t.Backspace="Backspace",t.Delete="Delete",t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown",t.Home="Home",t.End="End",t.PageUp="PageUp",t.PageDown="PageDown",t.Tab="Tab",t))(dt||{});function pk(t,e,n,r){Yl.isServer||bt(o=>{t=t!=null?t:window,t.addEventListener(e,n,r),o(()=>t.removeEventListener(e,n,r))})}var jn=(t=>(t[t.Forwards=0]="Forwards",t[t.Backwards=1]="Backwards",t))(jn||{});function C1(){let t=T(0);return m1("keydown",e=>{e.key==="Tab"&&(t.value=e.shiftKey?1:0)}),t}function mk({defaultContainers:t=[],portals:e,mainTreeNodeRef:n}={}){let r=T(null),o=Zn(r);function s(){var i,a,l;let c=[];for(let u of t)u!==null&&(u instanceof HTMLElement?c.push(u):"value"in u&&u.value instanceof HTMLElement&&c.push(u.value));if(e!=null&&e.value)for(let u of e.value)c.push(u);for(let u of(i=o==null?void 0:o.querySelectorAll("html > *, body > *"))!=null?i:[])u!==document.body&&u!==document.head&&u instanceof HTMLElement&&u.id!=="headlessui-portal-root"&&(u.contains(ee(r))||u.contains((l=(a=ee(r))==null?void 0:a.getRootNode())==null?void 0:l.host)||c.some(d=>u.contains(d))||c.push(u));return c}return{resolveContainers:s,contains(i){return s().some(a=>a.contains(i))},mainTreeNodeRef:r,MainTreeNode(){return n!=null?null:st(po,{features:ho.Hidden,ref:r})}}}function gk(){let t=T(null);return{mainTreeNodeRef:t,MainTreeNode(){return st(po,{features:ho.Hidden,ref:t})}}}let x1=Symbol("ForcePortalRootContext");function vk(){return Ye(x1,!1)}L({name:"ForcePortalRoot",props:{as:{type:[Object,String],default:"template"},force:{type:Boolean,default:!1}},setup(t,{slots:e,attrs:n}){return at(x1,t.force),()=>{let{force:r,...o}=t;return Rt({theirProps:o,ourProps:{},slot:{},slots:e,attrs:n,name:"ForcePortalRoot"})}}});function yk(t){let e=Zn(t);if(!e){if(t===null)return null;throw new Error("[Headless UI]: Cannot find ownerDocument for contextElement: ".concat(t))}let n=e.getElementById("headlessui-portal-root");if(n)return n;let r=e.createElement("div");return r.setAttribute("id","headlessui-portal-root"),e.body.appendChild(r)}const Hu=new WeakMap;function bk(t){var e;return(e=Hu.get(t))!=null?e:0}function xp(t,e){let n=e(bk(t));return n<=0?Hu.delete(t):Hu.set(t,n),n}L({name:"Portal",props:{as:{type:[Object,String],default:"div"}},setup(t,{slots:e,attrs:n}){let r=T(null),o=O(()=>Zn(r)),s=vk(),i=Ye(S1,null),a=T(s===!0||i==null?yk(r.value):i.resolveTarget());a.value&&xp(a.value,f=>f+1);let l=T(!1);De(()=>{l.value=!0}),bt(()=>{s||i!=null&&(a.value=i.resolveTarget())});let c=Ye(qu,null),u=!1,d=_s();return He(r,()=>{if(u||!c)return;let f=ee(r);f&&(fn(c.register(f),d),u=!0)}),fn(()=>{var f,p;let h=(f=o.value)==null?void 0:f.getElementById("headlessui-portal-root");!h||a.value!==h||xp(a.value,v=>v-1)||a.value.children.length>0||(p=a.value.parentElement)==null||p.removeChild(a.value)}),()=>{if(!l.value||a.value===null)return null;let f={ref:r,"data-headlessui-portal":""};return st(Pr,{to:a.value},Rt({ourProps:f,theirProps:t,slot:{},attrs:n,slots:e,name:"Portal"}))}}});let qu=Symbol("PortalParentContext");function wk(){let t=Ye(qu,null),e=T([]);function n(s){return e.value.push(s),t&&t.register(s),()=>r(s)}function r(s){let i=e.value.indexOf(s);i!==-1&&e.value.splice(i,1),t&&t.unregister(s)}let o={register:n,unregister:r,portals:e};return[e,L({name:"PortalWrapper",setup(s,{slots:i}){return at(qu,o),()=>{var a;return(a=i.default)==null?void 0:a.call(i)}}})]}let S1=Symbol("PortalGroupContext");L({name:"PortalGroup",props:{as:{type:[Object,String],default:"template"},target:{type:Object,default:null}},setup(t,{attrs:e,slots:n}){let r=So({resolveTarget(){return t.target}});return at(S1,r),()=>{let{target:o,...s}=t;return Rt({theirProps:s,ourProps:{},slot:{},attrs:e,slots:n,name:"PortalGroup"})}}});var kk=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(kk||{});let _1=Symbol("PopoverContext");function Jl(t){let e=Ye(_1,null);if(e===null){let n=new Error("<".concat(t," /> is missing a parent <").concat(M1.name," /> component."));throw Error.captureStackTrace&&Error.captureStackTrace(n,Jl),n}return e}let T1=Symbol("PopoverGroupContext");function $1(){return Ye(T1,null)}let O1=Symbol("PopoverPanelContext");function Ck(){return Ye(O1,null)}let M1=L({name:"Popover",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"}},setup(t,{slots:e,attrs:n,expose:r}){var o;let s=T(null);r({el:s,$el:s});let i=T(1),a=T(null),l=T(null),c=T(null),u=T(null),d=O(()=>Zn(s)),f=O(()=>{var _,E;if(!ee(a)||!ee(u))return!1;for(let Ue of document.querySelectorAll("body > *"))if(Number(Ue==null?void 0:Ue.contains(ee(a)))^Number(Ue==null?void 0:Ue.contains(ee(u))))return!0;let D=Gl(),N=D.indexOf(ee(a)),H=(N+D.length-1)%D.length,Y=(N+1)%D.length,re=D[H],ce=D[Y];return!((_=ee(u))!=null&&_.contains(re))&&!((E=ee(u))!=null&&E.contains(ce))}),p={popoverState:i,buttonId:T(null),panelId:T(null),panel:u,button:a,isPortalled:f,beforePanelSentinel:l,afterPanelSentinel:c,togglePopover(){i.value=Ut(i.value,{0:1,1:0})},closePopover(){i.value!==1&&(i.value=1)},close(_){p.closePopover();let E=(()=>_?_ instanceof HTMLElement?_:_.value instanceof HTMLElement?ee(_):ee(p.button):ee(p.button))();E==null||E.focus()}};at(_1,p),hk(O(()=>Ut(i.value,{0:mo.Open,1:mo.Closed})));let h={buttonId:p.buttonId,panelId:p.panelId,close(){p.closePopover()}},v=$1(),y=v==null?void 0:v.registerPopover,[w,x]=wk(),$=mk({mainTreeNodeRef:v==null?void 0:v.mainTreeNodeRef,portals:w,defaultContainers:[a,u]});function S(){var _,E,D,N;return(N=v==null?void 0:v.isFocusWithinPopoverGroup())!=null?N:((_=d.value)==null?void 0:_.activeElement)&&(((E=ee(a))==null?void 0:E.contains(d.value.activeElement))||((D=ee(u))==null?void 0:D.contains(d.value.activeElement)))}return bt(()=>y==null?void 0:y(h)),pk((o=d.value)==null?void 0:o.defaultView,"focus",_=>{var E,D;_.target!==window&&_.target instanceof HTMLElement&&i.value===0&&(S()||a&&u&&($.contains(_.target)||(E=ee(p.beforePanelSentinel))!=null&&E.contains(_.target)||(D=ee(p.afterPanelSentinel))!=null&&D.contains(_.target)||p.closePopover()))},!0),uk($.resolveContainers,(_,E)=>{var D;p.closePopover(),p1(E,Jd.Loose)||(_.preventDefault(),(D=ee(a))==null||D.focus())},O(()=>i.value===0)),()=>{let _={open:i.value===0,close:p.close};return st(K,[st(x,{},()=>Rt({theirProps:{...t,...n},ourProps:{ref:s},slot:_,slots:e,attrs:n,name:"Popover"})),st($.MainTreeNode)])}}}),xk=L({name:"PopoverButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(t,{attrs:e,slots:n,expose:r}){var o;let s=(o=t.id)!=null?o:"headlessui-popover-button-".concat(Sr()),i=Jl("PopoverButton"),a=O(()=>Zn(i.button));r({el:i.button,$el:i.button}),De(()=>{i.buttonId.value=s}),fn(()=>{i.buttonId.value=null});let l=$1(),c=l==null?void 0:l.closeOthers,u=Ck(),d=O(()=>u===null?!1:u.value===i.panelId.value),f=T(null),p="headlessui-focus-sentinel-".concat(Sr());d.value||bt(()=>{i.button.value=ee(f)});let h=g1(O(()=>({as:t.as,type:e.type})),f);function v(_){var E,D,N,H,Y;if(d.value){if(i.popoverState.value===1)return;switch(_.key){case dt.Space:case dt.Enter:_.preventDefault(),(D=(E=_.target).click)==null||D.call(E),i.closePopover(),(N=ee(i.button))==null||N.focus();break}}else switch(_.key){case dt.Space:case dt.Enter:_.preventDefault(),_.stopPropagation(),i.popoverState.value===1&&(c==null||c(i.buttonId.value)),i.togglePopover();break;case dt.Escape:if(i.popoverState.value!==0)return c==null?void 0:c(i.buttonId.value);if(!ee(i.button)||(H=a.value)!=null&&H.activeElement&&!((Y=ee(i.button))!=null&&Y.contains(a.value.activeElement)))return;_.preventDefault(),_.stopPropagation(),i.closePopover();break}}function y(_){d.value||_.key===dt.Space&&_.preventDefault()}function w(_){var E,D;t.disabled||(d.value?(i.closePopover(),(E=ee(i.button))==null||E.focus()):(_.preventDefault(),_.stopPropagation(),i.popoverState.value===1&&(c==null||c(i.buttonId.value)),i.togglePopover(),(D=ee(i.button))==null||D.focus()))}function x(_){_.preventDefault(),_.stopPropagation()}let $=C1();function S(){let _=ee(i.panel);if(!_)return;function E(){Ut($.value,{[jn.Forwards]:()=>Ft(_,it.First),[jn.Backwards]:()=>Ft(_,it.Last)})===br.Error&&Ft(Gl().filter(D=>D.dataset.headlessuiFocusGuard!=="true"),Ut($.value,{[jn.Forwards]:it.Next,[jn.Backwards]:it.Previous}),{relativeTo:ee(i.button)})}E()}return()=>{let _=i.popoverState.value===0,E={open:_},{...D}=t,N=d.value?{ref:f,type:h.value,onKeydown:v,onClick:w}:{ref:f,id:s,type:h.value,"aria-expanded":i.popoverState.value===0,"aria-controls":ee(i.panel)?i.panelId.value:void 0,disabled:t.disabled?!0:void 0,onKeydown:v,onKeyup:y,onClick:w,onMousedown:x};return st(K,[Rt({ourProps:N,theirProps:{...e,...D},slot:E,attrs:e,slots:n,name:"PopoverButton"}),_&&!d.value&&i.isPortalled.value&&st(po,{id:p,features:ho.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:S})])}}});L({name:"PopoverOverlay",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0}},setup(t,{attrs:e,slots:n}){let r=Jl("PopoverOverlay"),o="headlessui-popover-overlay-".concat(Sr()),s=k1(),i=O(()=>s!==null?(s.value&mo.Open)===mo.Open:r.popoverState.value===0);function a(){r.closePopover()}return()=>{let l={open:r.popoverState.value===0};return Rt({ourProps:{id:o,"aria-hidden":!0,onClick:a},theirProps:t,slot:l,attrs:e,slots:n,features:fo.RenderStrategy|fo.Static,visible:i.value,name:"PopoverOverlay"})}}});let Sk=L({name:"PopoverPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},focus:{type:Boolean,default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(t,{attrs:e,slots:n,expose:r}){var o;let s=(o=t.id)!=null?o:"headlessui-popover-panel-".concat(Sr()),{focus:i}=t,a=Jl("PopoverPanel"),l=O(()=>Zn(a.panel)),c="headlessui-focus-sentinel-before-".concat(Sr()),u="headlessui-focus-sentinel-after-".concat(Sr());r({el:a.panel,$el:a.panel}),De(()=>{a.panelId.value=s}),fn(()=>{a.panelId.value=null}),at(O1,a.panelId),bt(()=>{var x,$;if(!i||a.popoverState.value!==0||!a.panel)return;let S=(x=l.value)==null?void 0:x.activeElement;($=ee(a.panel))!=null&&$.contains(S)||Ft(ee(a.panel),it.First)});let d=k1(),f=O(()=>d!==null?(d.value&mo.Open)===mo.Open:a.popoverState.value===0);function p(x){var $,S;switch(x.key){case dt.Escape:if(a.popoverState.value!==0||!ee(a.panel)||l.value&&!(($=ee(a.panel))!=null&&$.contains(l.value.activeElement)))return;x.preventDefault(),x.stopPropagation(),a.closePopover(),(S=ee(a.button))==null||S.focus();break}}function h(x){var $,S,_,E,D;let N=x.relatedTarget;N&&ee(a.panel)&&(($=ee(a.panel))!=null&&$.contains(N)||(a.closePopover(),((_=(S=ee(a.beforePanelSentinel))==null?void 0:S.contains)!=null&&_.call(S,N)||(D=(E=ee(a.afterPanelSentinel))==null?void 0:E.contains)!=null&&D.call(E,N))&&N.focus({preventScroll:!0})))}let v=C1();function y(){let x=ee(a.panel);if(!x)return;function $(){Ut(v.value,{[jn.Forwards]:()=>{var S;Ft(x,it.First)===br.Error&&((S=ee(a.afterPanelSentinel))==null||S.focus())},[jn.Backwards]:()=>{var S;(S=ee(a.button))==null||S.focus({preventScroll:!0})}})}$()}function w(){let x=ee(a.panel);if(!x)return;function $(){Ut(v.value,{[jn.Forwards]:()=>{let S=ee(a.button),_=ee(a.panel);if(!S)return;let E=Gl(),D=E.indexOf(S),N=E.slice(0,D+1),H=[...E.slice(D+1),...N];for(let Y of H.slice())if(Y.dataset.headlessuiFocusGuard==="true"||_!=null&&_.contains(Y)){let re=H.indexOf(Y);re!==-1&&H.splice(re,1)}Ft(H,it.First,{sorted:!1})},[jn.Backwards]:()=>{var S;Ft(x,it.Previous)===br.Error&&((S=ee(a.button))==null||S.focus())}})}$()}return()=>{let x={open:a.popoverState.value===0,close:a.close},{focus:$,...S}=t,_={ref:a.panel,id:s,onKeydown:p,onFocusout:i&&a.popoverState.value===0?h:void 0,tabIndex:-1};return Rt({ourProps:_,theirProps:{...e,...S},attrs:e,slot:x,slots:{...n,default:(...E)=>{var D;return[st(K,[f.value&&a.isPortalled.value&&st(po,{id:c,ref:a.beforePanelSentinel,features:ho.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:y}),(D=n.default)==null?void 0:D.call(n,...E),f.value&&a.isPortalled.value&&st(po,{id:u,ref:a.afterPanelSentinel,features:ho.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:w})])]}},features:fo.RenderStrategy|fo.Static,visible:f.value,name:"PopoverPanel"})}}});L({name:"PopoverGroup",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"}},setup(t,{attrs:e,slots:n,expose:r}){let o=T(null),s=yr([]),i=O(()=>Zn(o)),a=gk();r({el:o,$el:o});function l(f){let p=s.value.indexOf(f);p!==-1&&s.value.splice(p,1)}function c(f){return s.value.push(f),()=>{l(f)}}function u(){var f;let p=i.value;if(!p)return!1;let h=p.activeElement;return(f=ee(o))!=null&&f.contains(h)?!0:s.value.some(v=>{var y,w;return((y=p.getElementById(v.buttonId.value))==null?void 0:y.contains(h))||((w=p.getElementById(v.panelId.value))==null?void 0:w.contains(h))})}function d(f){for(let p of s.value)p.buttonId.value!==f&&p.close()}return at(T1,{registerPopover:c,unregisterPopover:l,isFocusWithinPopoverGroup:u,closeOthers:d,mainTreeNodeRef:a.mainTreeNodeRef}),()=>st(K,[Rt({ourProps:{ref:o},theirProps:{...t,...e},slot:{},attrs:e,slots:n,name:"PopoverGroup"}),st(a.MainTreeNode)])}});let _k=L({props:{onFocus:{type:Function,required:!0}},setup(t){let e=T(!0);return()=>e.value?st(po,{as:"button",type:"button",features:ho.Focusable,onFocus(n){n.preventDefault();let r,o=50;function s(){var i;if(o--<=0){r&&cancelAnimationFrame(r);return}if((i=t.onFocus)!=null&&i.call(t)){e.value=!1,cancelAnimationFrame(r);return}r=requestAnimationFrame(s)}r=requestAnimationFrame(s)}}):null}});var Tk=(t=>(t[t.Forwards=0]="Forwards",t[t.Backwards=1]="Backwards",t))(Tk||{}),$k=(t=>(t[t.Less=-1]="Less",t[t.Equal=0]="Equal",t[t.Greater=1]="Greater",t))($k||{});let E1=Symbol("TabsContext");function Ji(t){let e=Ye(E1,null);if(e===null){let n=new Error("<".concat(t," /> is missing a parent <TabGroup /> component."));throw Error.captureStackTrace&&Error.captureStackTrace(n,Ji),n}return e}let Xd=Symbol("TabsSSRContext"),Ok=L({name:"TabGroup",emits:{change:t=>!0},props:{as:{type:[Object,String],default:"template"},selectedIndex:{type:[Number],default:null},defaultIndex:{type:[Number],default:0},vertical:{type:[Boolean],default:!1},manual:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(t,{slots:e,attrs:n,emit:r}){var o;let s=T((o=t.selectedIndex)!=null?o:t.defaultIndex),i=T([]),a=T([]),l=O(()=>t.selectedIndex!==null),c=O(()=>l.value?t.selectedIndex:s.value);function u(v){var y;let w=Ro(d.tabs.value,ee),x=Ro(d.panels.value,ee),$=w.filter(S=>{var _;return!((_=ee(S))!=null&&_.hasAttribute("disabled"))});if(v<0||v>w.length-1){let S=Ut(s.value===null?0:Math.sign(v-s.value),{[-1]:()=>1,0:()=>Ut(Math.sign(v),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0}),_=Ut(S,{0:()=>w.indexOf($[0]),1:()=>w.indexOf($[$.length-1])});_!==-1&&(s.value=_),d.tabs.value=w,d.panels.value=x}else{let S=w.slice(0,v),_=[...w.slice(v),...S].find(D=>$.includes(D));if(!_)return;let E=(y=w.indexOf(_))!=null?y:d.selectedIndex.value;E===-1&&(E=d.selectedIndex.value),s.value=E,d.tabs.value=w,d.panels.value=x}}let d={selectedIndex:O(()=>{var v,y;return(y=(v=s.value)!=null?v:t.defaultIndex)!=null?y:null}),orientation:O(()=>t.vertical?"vertical":"horizontal"),activation:O(()=>t.manual?"manual":"auto"),tabs:i,panels:a,setSelectedIndex(v){c.value!==v&&r("change",v),l.value||u(v)},registerTab(v){var y;if(i.value.includes(v))return;let w=i.value[s.value];if(i.value.push(v),i.value=Ro(i.value,ee),!l.value){let x=(y=i.value.indexOf(w))!=null?y:s.value;x!==-1&&(s.value=x)}},unregisterTab(v){let y=i.value.indexOf(v);y!==-1&&i.value.splice(y,1)},registerPanel(v){a.value.includes(v)||(a.value.push(v),a.value=Ro(a.value,ee))},unregisterPanel(v){let y=a.value.indexOf(v);y!==-1&&a.value.splice(y,1)}};at(E1,d);let f=T({tabs:[],panels:[]}),p=T(!1);De(()=>{p.value=!0}),at(Xd,O(()=>p.value?null:f.value));let h=O(()=>t.selectedIndex);return De(()=>{He([h],()=>{var v;return u((v=t.selectedIndex)!=null?v:t.defaultIndex)},{immediate:!0})}),bt(()=>{if(!l.value||c.value==null||d.tabs.value.length<=0)return;let v=Ro(d.tabs.value,ee);v.some((y,w)=>ee(d.tabs.value[w])!==ee(y))&&d.setSelectedIndex(v.findIndex(y=>ee(y)===ee(d.tabs.value[c.value])))}),()=>{let v={selectedIndex:s.value};return st(K,[i.value.length<=0&&st(_k,{onFocus:()=>{for(let y of i.value){let w=ee(y);if((w==null?void 0:w.tabIndex)===0)return w.focus(),!0}return!1}}),Rt({theirProps:{...n,...b1(t,["selectedIndex","defaultIndex","manual","vertical","onChange"])},ourProps:{},slot:v,slots:e,attrs:n,name:"TabGroup"})])}}}),Mk=L({name:"TabList",props:{as:{type:[Object,String],default:"div"}},setup(t,{attrs:e,slots:n}){let r=Ji("TabList");return()=>{let o={selectedIndex:r.selectedIndex.value},s={role:"tablist","aria-orientation":r.orientation.value};return Rt({ourProps:s,theirProps:t,slot:o,attrs:e,slots:n,name:"TabList"})}}}),Ek=L({name:"Tab",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},setup(t,{attrs:e,slots:n,expose:r}){var o;let s=(o=t.id)!=null?o:"headlessui-tabs-tab-".concat(Sr()),i=Ji("Tab"),a=T(null);r({el:a,$el:a}),De(()=>i.registerTab(a)),fn(()=>i.unregisterTab(a));let l=Ye(Xd),c=O(()=>{if(l.value){let x=l.value.tabs.indexOf(s);return x===-1?l.value.tabs.push(s)-1:x}return-1}),u=O(()=>{let x=i.tabs.value.indexOf(a);return x===-1?c.value:x}),d=O(()=>u.value===i.selectedIndex.value);function f(x){var $;let S=x();if(S===br.Success&&i.activation.value==="auto"){let _=($=Zn(a))==null?void 0:$.activeElement,E=i.tabs.value.findIndex(D=>ee(D)===_);E!==-1&&i.setSelectedIndex(E)}return S}function p(x){let $=i.tabs.value.map(S=>ee(S)).filter(Boolean);if(x.key===dt.Space||x.key===dt.Enter){x.preventDefault(),x.stopPropagation(),i.setSelectedIndex(u.value);return}switch(x.key){case dt.Home:case dt.PageUp:return x.preventDefault(),x.stopPropagation(),f(()=>Ft($,it.First));case dt.End:case dt.PageDown:return x.preventDefault(),x.stopPropagation(),f(()=>Ft($,it.Last))}if(f(()=>Ut(i.orientation.value,{vertical(){return x.key===dt.ArrowUp?Ft($,it.Previous|it.WrapAround):x.key===dt.ArrowDown?Ft($,it.Next|it.WrapAround):br.Error},horizontal(){return x.key===dt.ArrowLeft?Ft($,it.Previous|it.WrapAround):x.key===dt.ArrowRight?Ft($,it.Next|it.WrapAround):br.Error}}))===br.Success)return x.preventDefault()}let h=T(!1);function v(){var x;h.value||(h.value=!0,!t.disabled&&((x=ee(a))==null||x.focus({preventScroll:!0}),i.setSelectedIndex(u.value),X2(()=>{h.value=!1})))}function y(x){x.preventDefault()}let w=g1(O(()=>({as:t.as,type:e.type})),a);return()=>{var x,$;let S={selected:d.value,disabled:(x=t.disabled)!=null?x:!1},{..._}=t,E={ref:a,onKeydown:p,onMousedown:y,onClick:v,id:s,role:"tab",type:w.value,"aria-controls":($=ee(i.panels.value[u.value]))==null?void 0:$.id,"aria-selected":d.value,tabIndex:d.value?0:-1,disabled:t.disabled?!0:void 0};return Rt({ourProps:E,theirProps:_,slot:S,attrs:e,slots:n,name:"Tab"})}}}),Nk=L({name:"TabPanels",props:{as:{type:[Object,String],default:"div"}},setup(t,{slots:e,attrs:n}){let r=Ji("TabPanels");return()=>{let o={selectedIndex:r.selectedIndex.value};return Rt({theirProps:t,ourProps:{},slot:o,attrs:n,slots:e,name:"TabPanels"})}}}),Dk=L({name:"TabPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null},tabIndex:{type:Number,default:0}},setup(t,{attrs:e,slots:n,expose:r}){var o;let s=(o=t.id)!=null?o:"headlessui-tabs-panel-".concat(Sr()),i=Ji("TabPanel"),a=T(null);r({el:a,$el:a}),De(()=>i.registerPanel(a)),fn(()=>i.unregisterPanel(a));let l=Ye(Xd),c=O(()=>{if(l.value){let f=l.value.panels.indexOf(s);return f===-1?l.value.panels.push(s)-1:f}return-1}),u=O(()=>{let f=i.panels.value.indexOf(a);return f===-1?c.value:f}),d=O(()=>u.value===i.selectedIndex.value);return()=>{var f;let p={selected:d.value},{tabIndex:h,...v}=t,y={ref:a,id:s,role:"tabpanel","aria-labelledby":(f=ee(i.tabs.value[u.value]))==null?void 0:f.id,tabIndex:d.value?h:-1};return!d.value&&t.unmount&&!t.static?st(po,{as:"span","aria-hidden":!0,...y}):Rt({ourProps:y,theirProps:v,slot:p,attrs:e,slots:n,features:fo.Static|fo.RenderStrategy,visible:d.value,name:"TabPanel"})}}});const Ak=L({__name:"ToggletipButton",props:{size:{default:"xs"},icon:{default:"fr-icon-information-line"}},setup(t){const e=t,n=O(()=>e.size==="md"?"":e.size==="xs"?"fr-btn--".concat(e.size," fr-icon--sm"):"fr-btn--".concat(e.size));return(r,o)=>(b(),k("button",{class:ae("fr-btn fr-btn--tertiary-no-outline text-grey-380 fr-btn--darker-hover align-middle ".concat(n.value," ").concat(t.icon))},null,2))}}),Rk=L({inheritAttrs:!1,__name:"Toggletip",props:{noMargin:{type:Boolean,default:!1},position:{default:"left"}},setup(t){return(e,n)=>(b(),j(m(M1),{class:"relative text-grey-500",focus:!0},{default:W(()=>[M(m(xk),Tn(e.$attrs,{ref:"button",as:Ak}),{default:W(()=>[Le(e.$slots,"default",{},void 0,!0)]),_:3},16),M(m(Sk),{class:ae(["toggletip",{"fr-p-0":t.noMargin,"left-0":t.position==="right"}]),ref:"toggletip"},{default:W(({close:r})=>[Le(e.$slots,"toggletip",{close:r},void 0,!0)]),_:3},8,["class"])]),_:3}))}}),Zd=ke(Rk,[["__scopeId","data-v-3bf812ef"]]),Ik={class:"fr-m-0 fr-grid-row fr-grid-row--middle fr-text--sm text-mention-grey"},Pk={class:"fr-grid-row fr-grid-row--middle"},Lk={class:"fr-text--sm fr-my-0"},zk={class:"list-style-none fr-m-0 fr-p-0"},Bk={class:"fr-grid-row fr-grid-row--right not-enlarged"},Fk=["href","title"],Vk={class:"fr-my-0 fr-mr-1v text-mention-grey fr-text--sm"},Hk={class:"fr-grid-row fr-grid-row--middle fr-mr-1v"},qk=L({__name:"QualityComponentInline",props:{quality:{}},setup(t){return(e,n)=>(b(),k("div",Ik,[g("div",Pk,[M(m(Zd),{class:"relative z-2"},{toggletip:W(()=>[g("h5",Lk,C(e.$t("Metadata quality:")),1),g("ul",zk,[M(m(or),{passed:t.quality.dataset_description_quality,messagePassed:e.$t("Data description filled"),messageFailed:e.$t("Data description empty"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),M(m(or),{passed:t.quality.resources_documentation,messagePassed:e.$t("Files documented"),messageFailed:e.$t("Files documentation missing"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),M(m(or),{passed:t.quality.license,messagePassed:e.$t("License filled"),messageFailed:e.$t("No license set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),M(m(or),{passed:t.quality.update_frequency&&!!t.quality.update_fulfilled_in_time,messagePassed:e.$t("Update frequency followed"),messageFailed:t.quality.update_frequency?e.$t("Update frequency not followed"):e.$t("Update frequency not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),M(m(or),{passed:t.quality.has_open_format,messagePassed:e.$t("File formats are open"),messageFailed:e.$t("File formats are closed"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),M(m(or),{passed:t.quality.temporal_coverage,messagePassed:e.$t("Temporal coverage filled"),messageFailed:e.$t("Temporal coverage not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),M(m(or),{passed:t.quality.spatial,messagePassed:e.$t("Spatial coverage filled"),messageFailed:e.$t("Spatial coverage not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),M(m(or),{passed:t.quality.all_resources_available,messagePassed:e.$t("All files are available"),messageFailed:e.$t("Some files are unavailable"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"])]),g("div",Bk,[g("a",{href:m(rt).guides_quality_url,target:"_blank",rel:"noopener",title:e.$t("Learn more about this indicator - opens a new window")},C(e.$t("Learn more about this indicator")),9,Fk)])]),_:1}),g("p",Vk,C(e.$t("Metadata :")),1),g("div",Hk,[M(m(Y2),{score:t.quality.score},null,8,["score"])])])]))}});function Uk(t){const e=T(!1);function n(){e.value=!e.value;const r=document.getElementById(t);r&&s1(r,e.value)}return{expanded:e,expand:n}}const Wk=Ib({duration:!1,dismissible:!0});function jk(){return{toast:Wk}}function Xl(t){return O(()=>{const n=Ke(t);if(n)return n.organization?n.organization.name:n.owner.first_name+" "+n.owner.last_name})}const Kk={class:"fr-my-2w fr-p-2w border border-default-grey fr-enlarge-link"},Yk={key:0,class:"absolute top-0 fr-grid-row fr-grid-row--middle fr-mt-n3v fr-ml-n1v"},Gk={key:0,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},Jk={key:1,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},Xk={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--top"},Zk={class:"fr-col-auto"},Qk={class:"logo"},e3={class:"fr-col-12 fr-col-sm"},t3={class:"fr-text--md fr-mb-0 fr-grid-row"},n3={key:0,class:"fr-col-auto fr-ml-1w"},r3={key:0,class:"fr-text--sm fr-m-0 inline-flex"},o3={key:0,class:"not-enlarged fr-mr-1v"},s3={class:"text-mention-grey dash-before-sm whitespace-nowrap"},i3={class:"fr-mx-0 fr-mb-n1v fr-grid-row fr-grid-row--middle fr-text--sm text-mention-grey"},a3={class:"fr-hidden flex-sm dash-after-sm text-grey-500"},l3={class:"fr-grid-row fr-grid-row--middle fr-mr-1v"},c3=["aria-label"],u3=["aria-label"],d3=["aria-label"],f3=L({__name:"DatasetCard",props:{dataset:{},datasetUrl:{},organizationUrl:{},showDescription:{type:Boolean,default:!0}},setup(t){const e=t,{t:n}=be(),r=Xl(e.dataset);return(o,s)=>(b(),k("div",Kk,[t.dataset.private||t.dataset.archived?(b(),k("div",Yk,[t.dataset.private?(b(),k("p",Gk,[s[0]||(s[0]=g("span",{class:"fr-icon-lock-line fr-icon--sm","aria-hidden":"true"},null,-1)),U(" "+C(m(n)("Draft")),1)])):I("",!0),t.dataset.archived?(b(),k("p",Jk,[s[1]||(s[1]=g("span",{class:"fr-icon-archive-line fr-icon--sm","aria-hidden":"true"},null,-1)),U(" "+C(m(n)("Archived")),1)])):I("",!0)])):I("",!0),g("div",Xk,[g("div",Zk,[g("div",Qk,[t.dataset.organization?(b(),j(m(Fu),{key:0,type:"dataset",src:t.dataset.organization.logo_thumbnail,alt:"",size:40},null,8,["src"])):t.dataset.owner?(b(),j(Yg,{key:1,user:t.dataset.owner,size:40},null,8,["user"])):(b(),j(m(Fu),{key:2,type:"dataset",size:40}))])]),g("div",e3,[g("h4",t3,[Le(o.$slots,"datasetUrl",{dataset:t.dataset,datasetUrl:t.datasetUrl},()=>[M(ps,{to:t.datasetUrl,class:"text-grey-500 fr-grid-row"},{default:W(()=>[M(m(Nt),{class:"fr-col","auto-resize":!0,text:t.dataset.title,"max-lines":1},null,8,["text"]),t.dataset.acronym?(b(),k("small",n3,C(t.dataset.acronym),1)):I("",!0)]),_:1},8,["to"])])]),t.dataset.organization||t.dataset.owner?(b(),k("div",r3,[t.dataset.organization?(b(),k("span",o3,[t.organizationUrl?(b(),j(ps,{key:0,class:"fr-link fr-text--sm inline-flex items-center",to:t.organizationUrl},{default:W(()=>[M(uo,{organization:t.dataset.organization},null,8,["organization"])]),_:1},8,["to"])):(b(),j(uo,{key:1,organization:t.dataset.organization},null,8,["organization"]))])):(b(),j(m(Nt),{key:1,class:"not-enlarged fr-mr-1v","auto-resize":!0,text:m(r),"max-lines":1},null,8,["text"])),g("span",s3,C(o.$t("Updated {date}",{date:m(Fl)(t.dataset.last_update)})),1)])):I("",!0),g("div",i3,[g("div",a3,[M(m(qk),{quality:t.dataset.quality},null,8,["quality"])]),g("div",l3,[g("p",{class:"fr-text--sm fr-my-0","aria-label":m(n)("{n} resources downloads",t.dataset.metrics.resources_downloads)},[s[2]||(s[2]=g("span",{class:"fr-icon-download-line fr-icon--sm fr-px-1v","aria-hidden":"true"},null,-1)),U(C(m(Wo)(t.dataset.metrics.resources_downloads)),1)],8,c3),g("p",{class:"fr-text--sm fr-my-0","aria-label":m(n)("{n} followers",t.dataset.metrics.followers)},[s[3]||(s[3]=g("span",{class:"fr-icon-star-line fr-icon--sm fr-px-1v","aria-hidden":"true"},null,-1)),U(C(m(Wo)(t.dataset.metrics.followers)),1)],8,u3),g("p",{class:"fr-text--sm fr-my-0","aria-label":m(n)("{n} reuses",t.dataset.metrics.reuses)},[s[4]||(s[4]=g("span",{class:"fr-icon-line-chart-line fr-icon--sm fr-px-1v","aria-hidden":"true"},null,-1)),U(C(m(Wo)(t.dataset.metrics.reuses)),1)],8,d3)])]),t.showDescription?(b(),j(qg,{key:1},{default:W(()=>[M(Kg,{class:"fr-text--sm fr-mt-1w fr-mb-0 overflow-wrap-anywhere","auto-resize":!0,text:m(zg)(t.dataset.description),"max-lines":2},null,8,["text"])]),_:1})):I("",!0)])])]))}}),h3={key:0,class:"absolute top-0 fr-grid-row fr-grid-row--middle fr-mt-n3v fr-ml-n1v"},p3={key:0,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},m3={key:1,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},g3={key:2,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},v3={class:"fr-text--md fr-mb-0"},y3={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",class:"fr-mr-1v",style:{width:"1rem"}},b3={key:1,class:"fr-icon-terminal-line fr-icon--sm fr-mr-1v","aria-hidden":"true"},w3={key:1,class:"fr-text--sm text-mention-grey inline-flex fr-mt-1v fr-mb-0"},k3={key:0,class:"not-enlarged"},C3={class:"dash-before whitespace-nowrap"},x3={class:"fr-text--sm text-mention-grey fr-my-0 fr-mt-1v"},S3={class:"text-grey-400"},_3=L({__name:"DataserviceCard",props:{dataservice:{},dataserviceUrl:{},organizationUrl:{},showDescription:{type:Boolean,default:!0}},setup(t){const e=t,{t:n}=be(),r=Xl(e.dataservice),o=O(()=>rt.tabular_api_dataservice_id===e.dataservice.id);return(s,i)=>(b(),k("article",{class:ae(["fr-my-2w fr-p-2w border fr-enlarge-link",{"border-tabular-api":o.value}]),style:Ts(e.style)},[t.dataservice.access_type==="restricted"||t.dataservice.private||t.dataservice.archived_at?(b(),k("div",h3,[t.dataservice.access_type==="restricted"?(b(),k("p",p3,[i[0]||(i[0]=g("span",{class:"fr-icon-lock-line fr-icon--sm","aria-hidden":"true"},null,-1)),U(" "+C(m(n)("Restricted access")),1)])):I("",!0),t.dataservice.private?(b(),k("p",m3,[i[1]||(i[1]=g("span",{class:"fr-icon-lock-line fr-icon--sm","aria-hidden":"true"},null,-1)),U(" "+C(m(n)("Draft")),1)])):I("",!0),t.dataservice.archived_at?(b(),k("p",g3,[i[2]||(i[2]=g("span",{class:"fr-icon-lock-line fr-icon--sm","aria-hidden":"true"},null,-1)),U(" "+C(m(n)("Archived")),1)])):I("",!0)])):I("",!0),g("h4",v3,[Le(s.$slots,"dataserviceUrl",{dataservice:t.dataservice,dataserviceUrl:t.dataserviceUrl},()=>[o.value?(b(),k("svg",y3,[...i[3]||(i[3]=[g("path",{d:"M17.0007 1.20825 18.3195 3.68108 20.7923 4.99992 18.3195 6.31876 17.0007 8.79159 15.6818 6.31876 13.209 4.99992 15.6818 3.68108 17.0007 1.20825ZM10.6673 9.33325 15.6673 11.9999 10.6673 14.6666 8.00065 19.6666 5.33398 14.6666.333984 11.9999 5.33398 9.33325 8.00065 4.33325 10.6673 9.33325ZM11.4173 11.9999 9.18905 10.8115 8.00065 8.58325 6.81224 10.8115 4.58398 11.9999 6.81224 13.1883 8.00065 15.4166 9.18905 13.1883 11.4173 11.9999ZM19.6673 16.3333 18.0007 13.2083 16.334 16.3333 13.209 17.9999 16.334 19.6666 18.0007 22.7916 19.6673 19.6666 22.7923 17.9999 19.6673 16.3333Z"},null,-1)])])):(b(),k("span",b3)),M(ps,{class:"inline-flex",to:t.dataserviceUrl},{default:W(()=>[M(m(Nt),{"auto-resize":!0,text:t.dataservice.title,"max-lines":1},null,8,["text"])]),_:1},8,["to"])],!0)]),t.dataservice.organization||t.dataservice.owner?(b(),k("p",w3,[t.dataservice.organization?(b(),k("span",k3,[t.organizationUrl?(b(),j(ps,{key:0,class:"fr-link fr-text--sm",to:t.organizationUrl},{default:W(()=>[M(uo,{organization:t.dataservice.organization},null,8,["organization"])]),_:1},8,["to"])):(b(),j(uo,{key:1,organization:t.dataservice.organization},null,8,["organization"]))])):(b(),j(m(Nt),{key:1,class:"not-enlarged fr-mr-1v","auto-resize":!0,text:m(r),"max-lines":1},null,8,["text"])),g("span",C3,C(m(n)("Updated {date}",{date:m(Fl)(t.dataservice.metadata_modified_at)})),1)])):I("",!0),g("p",x3,[i[4]||(i[4]=g("span",{class:"fr-icon-information-line fr-icon--sm text-grey-380"},null,-1)),U(" "+C(m(n)("Availability :"))+" ",1),g("span",S3,[t.dataservice.availability?(b(),k(K,{key:0},[U(C(m(n)("{n}%",t.dataservice.availability)),1)],64)):(b(),k(K,{key:1},[U(C(m(n)("unknown")),1)],64))])]),t.showDescription?(b(),j(qg,{key:2},{default:W(()=>[M(Kg,{class:"fr-text--sm fr-mt-1w fr-mb-0 overflow-wrap-anywhere","auto-resize":!0,text:m(zg)(t.dataservice.description),"max-lines":2},null,8,["text"])]),_:1})):I("",!0)],6))}}),N1=ke(_3,[["__scopeId","data-v-47254e37"]]),T3={class:"fr-grid-row fr-grid-row--middle fr-pb-3w fr-mb-3w border-bottom border-default-grey"},$3={class:"fr-col"},O3={class:"fr-col-auto"},M3=["aria-expanded","aria-controls"],E3=["id"],N3={class:"fr-pb-3w fr-mb-3w border-bottom border-default-grey"},D3={class:"fr-grid-row fr-grid-row--gutters fr-text--sm fr-m-0","data-testid":"extra-list"},A3={class:"subtitle fr-mb-1v"},R3={class:"fr-text--sm fr-m-0 text-mention-grey overflow-wrap-anywhere"},I3=L({__name:"ExtraAccordion",props:{buttonText:{},titleText:{},extra:{},titleLevel:{}},setup(t){const e=xo("accordion"),{expanded:n,expand:r}=Uk(e);return(o,s)=>(b(),k("div",null,[g("header",T3,[g("div",$3,[(b(),j(to(t.titleLevel),{class:"subtitle subtitle--uppercase fr-m-0"},{default:W(()=>[U(C(t.titleText),1)]),_:1}))]),g("div",O3,[g("button",{onClick:s[0]||(s[0]=(...i)=>m(r)&&m(r)(...i)),role:"button","aria-expanded":m(n),"aria-controls":m(e),class:ae(["fr-btn fr-btn--tertiary-no-outline fr-btn--icon-left fr-btn--secondary-grey-500",{"fr-icon-arrow-up-s-line":m(n),"fr-icon-arrow-down-s-line":!m(n)}]),"data-testid":"button"},[m(n)?(b(),k(K,{key:0},[U(C(o.$t("Close details")),1)],64)):(b(),k(K,{key:1},[U(C(t.buttonText),1)],64))],10,M3)])]),g("div",{class:"accordion-content",id:m(e)},[g("div",N3,[g("div",D3,[(b(!0),k(K,null,Ne(t.extra,(i,a)=>(b(),k("div",{key:a,class:"fr-col-12 fr-col-sm-6 fr-col-md-4"},[g("h3",A3,C(a),1),g("p",R3,C(i),1)]))),128))])])],8,E3)]))}}),P3=L({__name:"OwnerType",props:{type:{},size:{default:"sm"},color:{default:"grey"}},setup(t){const e=t,n=O(()=>{switch(e.color){case"black":return"text-grey-500";case"grey":return"text-mention-grey"}}),r=O(()=>c1(e.type).label);return(o,s)=>(b(),k("p",{class:ae("".concat(n.value," fr-text--").concat(t.size," fr-my-0"))},[M(Gd,{type:t.type},null,8,["type"]),U(" "+C(r.value),1)],2))}}),Ma=3;function D1(t,e=1){return[...Array(t).keys()].map(n=>n+e)}function L3(t){return D1(t)}function z3(t,e){return Math.min(Ma*2+1,t.length-2,Ma+e-1,Ma+t.length-e)}function B3(t){return Math.max(t-Ma,2)}function F3(t,e){const n=L3(e),r=B3(t);if(e<=2)return[];let o=D1(z3(n,t),r);return o.includes(2)||o.unshift(null),o.includes(e-1)||o.push(null),o}const V3=["aria-label"],H3={class:"fr-pagination__list"},q3=["href"],U3=["href"],W3=["aria-current","href","title"],j3=["aria-current","href","title","onClick","data-testid"],K3={key:1,class:"fr-pagination__link fr-hidden fr-unhidden-lg"},Y3=["aria-current","href","title","data-testid"],G3=["href"],J3=["href"],_o=L({__name:"Pagination",props:{page:{default:1},pageSize:{default:20},totalResults:{}},emits:["change"],setup(t,{emit:e}){const n=e,r=t,{t:o}=be(),s=O(()=>Math.ceil(r.totalResults/r.pageSize)),i=O(()=>F3(r.page,s.value)),a=u=>{if(u!==r.page)return n("change",u)},l=()=>{const u=r.page+1;if(u<=s.value)return n("change",u)},c=()=>{const u=r.page-1;if(u>0)return n("change",u)};return(u,d)=>t.totalResults>t.pageSize?(b(),k("nav",{key:0,role:"navigation",class:"fr-pagination fr-pagination--centered","aria-label":m(o)("Pagination")},[g("ul",H3,[g("li",null,[g("a",{href:t.page===1?void 0:"#",class:"fr-pagination__link fr-pagination__link--first",onClick:d[0]||(d[0]=ye(f=>a(1),["prevent"])),"data-testid":"first-page"},C(m(o)("First page")),9,q3)]),g("li",null,[g("a",{href:t.page===1?void 0:"#",class:"fr-pagination__link fr-pagination__link--prev fr-pagination__link--lg-label",onClick:ye(c,["prevent"]),"data-testid":"previous-page"},C(m(o)("Previous page")),9,U3)]),g("li",null,[g("a",{"aria-current":t.page===1?"page":void 0,href:t.page===1?void 0:"#",class:ae(["fr-pagination__link",{"fr-hidden fr-unhidden-sm":t.page>1}]),title:m(o)("Page {nb}",{nb:1}),onClick:d[1]||(d[1]=ye(f=>a(1),["prevent"])),"data-testid":1}," 1 ",10,W3)]),(b(!0),k(K,null,Ne(i.value,f=>(b(),k("li",null,[f?(b(),k("a",{key:0,class:ae(["fr-pagination__link",{"fr-hidden fr-unhidden-lg":f<t.page-1||f>t.page+1}]),"aria-current":t.page===f?"page":void 0,href:t.page===f?void 0:"#",title:m(o)("Page {nb}",{nb:f}),onClick:ye(p=>a(f),["prevent"]),"data-testid":f},C(f),11,j3)):(b(),k("a",K3,"  "))]))),256)),g("li",null,[g("a",{class:"fr-pagination__link","aria-current":t.page===s.value?"page":void 0,href:t.page===s.value?void 0:"#",title:m(o)("Page {nb}",{nb:s.value}),onClick:d[2]||(d[2]=ye(f=>a(s.value),["prevent"])),"data-testid":s.value},C(s.value),9,Y3)]),g("li",null,[g("a",{class:"fr-pagination__link fr-pagination__link--next fr-pagination__link--lg-label",href:t.page===s.value?void 0:"#",onClick:ye(l,["prevent"]),"data-testid":"next-page"},C(m(o)("Next page")),9,G3)]),g("li",null,[g("a",{class:"fr-pagination__link fr-pagination__link--last",href:t.page===s.value?void 0:"#",onClick:d[3]||(d[3]=ye(f=>a(s.value),["prevent"])),"data-testid":"last-page"},C(m(o)("Last page")),9,J3)])])],8,V3)):I("",!0)}}),X3={class:"relative"},Sp=284,A1=L({__name:"ReadMore",props:{maxHeight:{default:""}},setup(t){const e=t,n=T(!1),r=T(!1),o=vi("containerRef"),s=vi("readMoreRef"),{height:i}=W2(o),a=T(Sp),l=f=>{const p=getComputedStyle(f);return parseFloat(p.getPropertyValue("height"))+parseFloat(p.getPropertyValue("margin-top"))+parseFloat(p.getPropertyValue("margin-bottom"))},c=()=>{const f=document.querySelector('[data-read-more-max-height="'.concat(e.maxHeight,'"]'));return f?Array.from(f.children).map(l).reduce((p,h)=>p+h,0):Sp},u=f=>{a.value=c(),r.value=f>a.value,r.value||(a.value=f)},d=()=>{if(!s.value)return;const f=o1(s.value);n.value?rl({from:{height:s.value.scrollHeight},to:{height:c()},duration:300,ease:ol}).start({update:f.set,complete:()=>{var p;return(p=s.value)==null?void 0:p.scrollIntoView({behavior:"smooth"})}}):rl({from:{height:c()},to:{height:s.value.scrollHeight},duration:300,ease:ol}).start({update:f.set,complete:()=>f.set({height:"auto"})}),n.value=!n.value};return He(i,u),(f,p)=>(b(),k("div",X3,[g("div",{class:ae(["read-more",{expand:n.value}]),ref_key:"readMoreRef",ref:s,style:Ts({height:a.value+"px"})},[g("div",{ref_key:"containerRef",ref:o},[Le(f.$slots,"default")],512)],6),r.value?(b(),k("div",{key:0,class:"read-more__bottom",onClick:ye(d,["prevent"])},[g("button",{role:"button",class:"fr-btn fr-btn--tertiary-no-outline",onClick:ye(d,["prevent","stop"])},[n.value?(b(),k(K,{key:0},[U(C(f.$t("Read less")),1)],64)):(b(),k(K,{key:1},[U(C(f.$t("Read more")),1)],64))])])):I("",!0)]))}}),Z3=["y"],Q3=["y"],eC=["y"],tC=["y"],nC=["y"],rC=["y"],oC=["y"],R1=L({__name:"Loader",setup(t){function e(n){return 16+4+n*(32+24)}return(n,r)=>(b(),j(m(Gi),{width:1124,height:300,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},{default:W(()=>[r[0]||(r[0]=g("rect",{x:"16",y:"16",rx:"4",ry:"4",width:"112",height:"24"},null,-1)),r[1]||(r[1]=g("rect",{x:"160",y:"16",rx:"4",ry:"4",width:"116",height:"24"},null,-1)),r[2]||(r[2]=g("rect",{x:"308",y:"16",rx:"4",ry:"4",width:"140",height:"24"},null,-1)),r[3]||(r[3]=g("rect",{x:"480",y:"16",rx:"4",ry:"4",width:"106",height:"24"},null,-1)),r[4]||(r[4]=g("rect",{x:"618",y:"16",rx:"4",ry:"4",width:"140",height:"24"},null,-1)),r[5]||(r[5]=g("rect",{x:"790",y:"16",rx:"4",ry:"4",width:"144",height:"24"},null,-1)),r[6]||(r[6]=g("rect",{x:"966",y:"16",rx:"4",ry:"4",width:"142",height:"24"},null,-1)),r[7]||(r[7]=g("rect",{x:"4",y:"56",rx:"4",ry:"4",width:"1116",height:"4"},null,-1)),(b(),k(K,null,Ne(5,o=>(b(),k(K,null,[g("rect",{x:"16",y:e(o),rx:"4",ry:"4",width:"112",height:"32"},null,8,Z3),g("rect",{x:"160",y:e(o),rx:"4",ry:"4",width:"116",height:"32"},null,8,Q3),g("rect",{x:"308",y:e(o),rx:"4",ry:"4",width:"140",height:"32"},null,8,eC),g("rect",{x:"480",y:e(o),rx:"4",ry:"4",width:"106",height:"32"},null,8,tC),g("rect",{x:"618",y:e(o),rx:"4",ry:"4",width:"140",height:"32"},null,8,nC),g("rect",{x:"790",y:e(o),rx:"4",ry:"4",width:"144",height:"32"},null,8,rC),g("rect",{x:"966",y:e(o),rx:"4",ry:"4",width:"142",height:"32"},null,8,oC)],64))),64))]),_:1}))}});function sC(t,e,n){let r="".concat(rt.tabular_api_url,"/api/resources/").concat(t,"/data/?page=").concat(e,"&page_size=").concat(rt.tabular_page_size);return n&&(r=r+"&".concat(n.column,"__sort=").concat(n.type)),xn.get(r)}function iC(t){const e="".concat(rt.tabular_api_url,"/api/resources/").concat(t,"/profile/");return xn.get(e)}const aC={key:0,class:"bg-alt-green-tilleul-verveine fr-p-3v fr-mb-2w"},lC={class:"fr-grid-row fr-m-0"},cC={key:2,class:"fr-grid-row fr-grid-row--gutters"},uC={key:0,class:"bg-alt-green-tilleul-verveine fr-p-3v fr-mb-2w"},dC={class:"fr-grid-row fr-m-0"},fC={class:"fr-col-12 fr-col-sm-6 fr-col-md-4 fr-col-lg-3"},hC={class:"fr-text--sm fr-text--bold fr-mt-0 fr-mb-1v"},pC={class:"code"},mC=L({__name:"DataStructure",props:{resource:{}},setup(t){const e=t,n=T([]),r=T({}),o=T(!0),s=T(!1),i=T(!1);return De(async()=>{try{const{data:a}=await iC(e.resource.id);"profile"in a&&a.profile?(n.value=Object.keys(a.profile.columns),r.value=a.profile.columns,i.value=!0,o.value=!1):(s.value=!0,o.value=!1)}catch(a){s.value=!0,o.value=!1}}),(a,l)=>s.value?(b(),k("div",aC,[g("p",lC,[l[0]||(l[0]=g("span",{class:"fr-icon-warning-line","aria-hidden":"true"},null,-1)),U(" "+C(a.$t("The data structure of this file failed to load.")),1)])])):o.value?(b(),j(R1,{key:1})):(b(),k("div",cC,[i.value?I("",!0):(b(),k("div",uC,[g("p",dC,[l[1]||(l[1]=g("span",{class:"fr-icon-warning-line","aria-hidden":"true"},null,-1)),U(" "+C(a.$t("No data structure found for this file.")),1)])])),i.value?(b(!0),k(K,{key:1},Ne(n.value,c=>(b(),k("div",fC,[g("h5",hC,C(c),1),g("code",pC,C(r.value[c].format),1)]))),256)):I("",!0)]))}}),gC='<svg width="64" height="64" viewBox="0 0 64 64" aria-hidden="true" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="path-1-inside-1_677_1834" fill="white"><path d="M47.6364 31.7323C47.8391 31.8153 48.0153 31.8812 48.1901 31.9556C49.3599 32.4569 50.0394 33.3352 50.1277 34.6162C50.1983 35.6647 50.2292 36.7158 50.2371 37.7685C50.2523 39.8635 51.2789 41.4763 52.6657 42.8981C53.5865 43.842 53.6661 44.3716 52.7286 45.2974C51.1332 46.8812 49.3827 48.2165 47.1329 48.7665C44.8819 49.3216 42.5083 49.0548 40.4357 48.0138C39.4892 47.5604 38.5265 47.3019 37.5309 47.7071C37.071 47.9103 36.6618 48.214 36.3331 48.596C36.0111 48.9977 35.7367 49.4357 35.5154 49.9011C35.0548 50.75 34.2981 51.2484 33.4773 51.6648C33.2122 51.7978 32.9196 51.8661 32.6233 51.8641C32.3271 51.862 32.0355 51.7897 31.7724 51.653C31.4776 51.521 31.2044 51.3451 30.9618 51.1313C29.8211 50.0656 28.445 49.7385 26.9352 49.6965C24.2186 49.5962 21.5474 48.9671 19.0698 47.8441C18.4504 47.5532 17.8641 47.1957 17.3213 46.7778C16.6911 46.3217 16.5988 45.9152 16.8344 45.1807C17.1056 44.3195 17.3992 43.4821 17.6453 42.6226C17.6638 42.5251 17.6598 42.4247 17.6338 42.329C17.6077 42.2333 17.5603 42.1449 17.495 42.0705C16.4777 41.1564 16.4698 41.1632 15.3346 41.8919C12.2675 43.8671 9.1983 45.8419 6.12697 47.816C5.39573 48.2874 5.04746 48.1891 4.61497 47.4308C4.33147 46.9348 4.052 46.4365 3.77656 45.9357C3.18563 44.8787 3.26602 44.5782 4.27115 43.9407C7.48797 41.9067 10.6834 39.8658 13.9015 37.8507C14.3035 37.5956 14.4007 37.3572 14.3108 36.8936C13.6776 33.714 14.5417 30.9795 16.8278 28.6954C16.9816 28.5764 17.0894 28.4073 17.1328 28.2171C17.1763 28.027 17.1526 27.8277 17.0658 27.6532C16.5668 26.2486 15.7792 25.1355 14.3525 24.5233C13.5227 24.1467 12.7175 23.7178 11.9416 23.2391C10.7864 22.5922 9.89092 21.5619 9.40841 20.3243C9.31335 20.0822 9.28169 19.8197 9.31644 19.5617C9.3512 19.3037 9.45121 19.059 9.60692 18.8509C10.6377 17.2552 12.2625 16.7311 13.9773 16.7337C15.3337 16.7378 16.6957 17.1374 18.0435 17.418C19.2594 17.6697 19.3451 17.666 19.9235 16.5752C20.1987 16.055 20.4163 15.4882 20.7251 14.9994C21.2758 14.1191 21.9105 13.926 22.8624 14.3348C23.2938 14.516 23.7286 14.7474 24.1486 14.9462C24.9684 15.324 25.7026 15.2084 26.3461 14.585C26.6077 14.3351 26.842 14.0578 27.045 13.7578C27.8829 12.5231 28.9904 11.4969 30.2827 10.7576C31.7264 9.85971 32.9011 8.58535 33.6818 7.07013C34.0043 6.47507 34.6284 6.37336 35.1547 6.87449C36.1787 7.85765 37.2353 8.82594 38.1708 9.8952C39.6137 11.5828 41.5324 12.7905 43.6733 13.3587C45.1679 13.7661 46.5788 14.4553 48.045 14.97C49.8289 15.5957 51.624 16.1995 53.4326 16.7561C54.4429 17.0682 54.7071 17.4125 54.4318 18.4614C53.8032 20.8525 53.1633 23.2416 52.512 25.6287C52.2313 26.6591 51.5044 27.3829 50.6757 27.9621C49.3363 28.9134 48.2845 30.2182 47.6364 31.7323ZM19.0829 43.0845C18.8621 43.7906 18.688 44.4745 18.4321 45.1261C18.2675 45.546 18.3981 45.7414 18.7452 45.9473C21.1132 47.3103 23.6962 47.8813 26.3813 48.163C27.5256 48.2847 28.6999 48.356 29.785 48.6883C30.5876 48.9346 31.287 49.5481 32.0035 50.0404C32.41 50.3202 32.7838 50.4547 33.176 50.0845C33.6071 49.6961 34.0124 49.2799 34.3896 48.8386C34.6545 48.4664 34.8964 48.0784 35.1142 47.6767C35.6541 46.8224 36.438 46.3537 37.4121 46.1269C38.6063 45.8473 39.8607 46.0113 40.9435 46.5887C43.5843 47.9246 46.236 47.8653 48.8 46.4721C49.8779 45.8886 50.796 44.9852 51.8339 44.1811C49.2935 41.8756 48.4762 39.073 48.724 35.8709C48.7321 35.4135 48.6838 34.9569 48.5801 34.5115C48.4556 33.8144 47.9893 33.425 47.3285 33.2617C47.0897 33.2022 46.8401 33.1982 46.5981 33.1537C45.8078 32.9971 45.5014 32.4304 45.8734 31.7287C46.8901 29.7991 47.9735 27.9259 49.8707 26.6837C50.2318 26.4528 50.5403 26.1477 50.7759 25.7885C51.0114 25.4292 51.1688 25.0241 51.2375 24.5995C51.4742 23.351 51.8317 22.1215 52.1618 20.8919C52.3982 20.012 52.6732 19.1464 52.9439 18.2473C52.0883 17.992 51.2364 17.7912 50.4176 17.4913C48.2143 16.6752 46.0306 15.8094 43.8326 14.9782C42.7874 14.5843 41.7022 14.2815 40.6869 13.8328C38.9215 13.0457 37.6898 11.5944 36.4238 10.1918C35.887 9.59656 35.273 9.06983 34.7665 8.58209C33.7652 9.61965 32.9772 10.7416 31.9168 11.4609C30.2571 12.5878 28.7721 13.8207 27.6019 15.4618C27.008 16.2924 26.1005 16.6368 25.0653 16.6718C24.1996 16.7016 23.4937 16.3034 22.7614 15.9491C22.0637 15.6113 22.0795 15.6271 21.7115 16.3264C21.3435 17.0257 20.9463 17.727 20.5177 18.3967C20.3427 18.6865 20.0779 18.9105 19.764 19.0344C19.45 19.1582 19.1044 19.1751 18.7801 19.0823C17.7876 18.8694 16.7939 18.6383 15.799 18.389C14.442 18.0468 13.0074 18.2086 11.7591 18.8447C10.8519 19.286 10.659 19.8764 11.3125 20.6174C11.7995 21.1706 12.3573 21.6566 12.9713 22.0626C13.7107 22.5281 14.4823 22.9399 15.2802 23.2949C16.2898 23.744 17.1328 24.5015 17.6895 25.4597C18.0248 26.0498 18.3157 26.6661 18.629 27.2724C23.4786 24.8338 27.9071 26.9763 29.9508 29.657C31.1027 31.1657 31.7438 33.0057 31.7801 34.9075C31.8164 36.8093 31.2461 38.6732 30.1526 40.2264C28.1536 43.0702 23.9809 45.1654 19.0829 43.0845ZM23.4376 42.3861C27.4778 42.1222 30.5404 38.6684 30.2798 34.6712C30.16 32.7164 29.2747 30.8892 27.8175 29.5894C26.3603 28.2897 24.4499 27.6232 22.5043 27.7359C21.536 27.7825 20.5865 28.0224 19.7111 28.4416C18.8358 28.8608 18.0522 29.4508 17.4059 30.1773C16.7596 30.9039 16.2636 31.7523 15.9469 32.6733C15.6301 33.5943 15.4988 34.5693 15.5608 35.5416C15.6227 36.5139 15.8766 37.4639 16.3076 38.3364C16.7387 39.2089 17.3382 39.9863 18.0714 40.6234C18.8045 41.2604 19.6566 41.7444 20.5779 42.047C21.4992 42.3497 22.4713 42.465 23.4376 42.3861ZM5.73574 46.2692L15.5443 39.9311L14.9626 38.9176L5.11278 45.1722L5.73574 46.2692Z"/></mask><path d="M47.6364 31.7323C47.8391 31.8153 48.0153 31.8812 48.1901 31.9556C49.3599 32.4569 50.0394 33.3352 50.1277 34.6162C50.1983 35.6647 50.2292 36.7158 50.2371 37.7685C50.2523 39.8635 51.2789 41.4763 52.6657 42.8981C53.5865 43.842 53.6661 44.3716 52.7286 45.2974C51.1332 46.8812 49.3827 48.2165 47.1329 48.7665C44.8819 49.3216 42.5083 49.0548 40.4357 48.0138C39.4892 47.5604 38.5265 47.3019 37.5309 47.7071C37.071 47.9103 36.6618 48.214 36.3331 48.596C36.0111 48.9977 35.7367 49.4357 35.5154 49.9011C35.0548 50.75 34.2981 51.2484 33.4773 51.6648C33.2122 51.7978 32.9196 51.8661 32.6233 51.8641C32.3271 51.862 32.0355 51.7897 31.7724 51.653C31.4776 51.521 31.2044 51.3451 30.9618 51.1313C29.8211 50.0656 28.445 49.7385 26.9352 49.6965C24.2186 49.5962 21.5474 48.9671 19.0698 47.8441C18.4504 47.5532 17.8641 47.1957 17.3213 46.7778C16.6911 46.3217 16.5988 45.9152 16.8344 45.1807C17.1056 44.3195 17.3992 43.4821 17.6453 42.6226C17.6638 42.5251 17.6598 42.4247 17.6338 42.329C17.6077 42.2333 17.5603 42.1449 17.495 42.0705C16.4777 41.1564 16.4698 41.1632 15.3346 41.8919C12.2675 43.8671 9.1983 45.8419 6.12697 47.816C5.39573 48.2874 5.04746 48.1891 4.61497 47.4308C4.33147 46.9348 4.052 46.4365 3.77656 45.9357C3.18563 44.8787 3.26602 44.5782 4.27115 43.9407C7.48797 41.9067 10.6834 39.8658 13.9015 37.8507C14.3035 37.5956 14.4007 37.3572 14.3108 36.8936C13.6776 33.714 14.5417 30.9795 16.8278 28.6954C16.9816 28.5764 17.0894 28.4073 17.1328 28.2171C17.1763 28.027 17.1526 27.8277 17.0658 27.6532C16.5668 26.2486 15.7792 25.1355 14.3525 24.5233C13.5227 24.1467 12.7175 23.7178 11.9416 23.2391C10.7864 22.5922 9.89092 21.5619 9.40841 20.3243C9.31335 20.0822 9.28169 19.8197 9.31644 19.5617C9.3512 19.3037 9.45121 19.059 9.60692 18.8509C10.6377 17.2552 12.2625 16.7311 13.9773 16.7337C15.3337 16.7378 16.6957 17.1374 18.0435 17.418C19.2594 17.6697 19.3451 17.666 19.9235 16.5752C20.1987 16.055 20.4163 15.4882 20.7251 14.9994C21.2758 14.1191 21.9105 13.926 22.8624 14.3348C23.2938 14.516 23.7286 14.7474 24.1486 14.9462C24.9684 15.324 25.7026 15.2084 26.3461 14.585C26.6077 14.3351 26.842 14.0578 27.045 13.7578C27.8829 12.5231 28.9904 11.4969 30.2827 10.7576C31.7264 9.85971 32.9011 8.58535 33.6818 7.07013C34.0043 6.47507 34.6284 6.37336 35.1547 6.87449C36.1787 7.85765 37.2353 8.82594 38.1708 9.8952C39.6137 11.5828 41.5324 12.7905 43.6733 13.3587C45.1679 13.7661 46.5788 14.4553 48.045 14.97C49.8289 15.5957 51.624 16.1995 53.4326 16.7561C54.4429 17.0682 54.7071 17.4125 54.4318 18.4614C53.8032 20.8525 53.1633 23.2416 52.512 25.6287C52.2313 26.6591 51.5044 27.3829 50.6757 27.9621C49.3363 28.9134 48.2845 30.2182 47.6364 31.7323ZM19.0829 43.0845C18.8621 43.7906 18.688 44.4745 18.4321 45.1261C18.2675 45.546 18.3981 45.7414 18.7452 45.9473C21.1132 47.3103 23.6962 47.8813 26.3813 48.163C27.5256 48.2847 28.6999 48.356 29.785 48.6883C30.5876 48.9346 31.287 49.5481 32.0035 50.0404C32.41 50.3202 32.7838 50.4547 33.176 50.0845C33.6071 49.6961 34.0124 49.2799 34.3896 48.8386C34.6545 48.4664 34.8964 48.0784 35.1142 47.6767C35.6541 46.8224 36.438 46.3537 37.4121 46.1269C38.6063 45.8473 39.8607 46.0113 40.9435 46.5887C43.5843 47.9246 46.236 47.8653 48.8 46.4721C49.8779 45.8886 50.796 44.9852 51.8339 44.1811C49.2935 41.8756 48.4762 39.073 48.724 35.8709C48.7321 35.4135 48.6838 34.9569 48.5801 34.5115C48.4556 33.8144 47.9893 33.425 47.3285 33.2617C47.0897 33.2022 46.8401 33.1982 46.5981 33.1537C45.8078 32.9971 45.5014 32.4304 45.8734 31.7287C46.8901 29.7991 47.9735 27.9259 49.8707 26.6837C50.2318 26.4528 50.5403 26.1477 50.7759 25.7885C51.0114 25.4292 51.1688 25.0241 51.2375 24.5995C51.4742 23.351 51.8317 22.1215 52.1618 20.8919C52.3982 20.012 52.6732 19.1464 52.9439 18.2473C52.0883 17.992 51.2364 17.7912 50.4176 17.4913C48.2143 16.6752 46.0306 15.8094 43.8326 14.9782C42.7874 14.5843 41.7022 14.2815 40.6869 13.8328C38.9215 13.0457 37.6898 11.5944 36.4238 10.1918C35.887 9.59656 35.273 9.06983 34.7665 8.58209C33.7652 9.61965 32.9772 10.7416 31.9168 11.4609C30.2571 12.5878 28.7721 13.8207 27.6019 15.4618C27.008 16.2924 26.1005 16.6368 25.0653 16.6718C24.1996 16.7016 23.4937 16.3034 22.7614 15.9491C22.0637 15.6113 22.0795 15.6271 21.7115 16.3264C21.3435 17.0257 20.9463 17.727 20.5177 18.3967C20.3427 18.6865 20.0779 18.9105 19.764 19.0344C19.45 19.1582 19.1044 19.1751 18.7801 19.0823C17.7876 18.8694 16.7939 18.6383 15.799 18.389C14.442 18.0468 13.0074 18.2086 11.7591 18.8447C10.8519 19.286 10.659 19.8764 11.3125 20.6174C11.7995 21.1706 12.3573 21.6566 12.9713 22.0626C13.7107 22.5281 14.4823 22.9399 15.2802 23.2949C16.2898 23.744 17.1328 24.5015 17.6895 25.4597C18.0248 26.0498 18.3157 26.6661 18.629 27.2724C23.4786 24.8338 27.9071 26.9763 29.9508 29.657C31.1027 31.1657 31.7438 33.0057 31.7801 34.9075C31.8164 36.8093 31.2461 38.6732 30.1526 40.2264C28.1536 43.0702 23.9809 45.1654 19.0829 43.0845ZM23.4376 42.3861C27.4778 42.1222 30.5404 38.6684 30.2798 34.6712C30.16 32.7164 29.2747 30.8892 27.8175 29.5894C26.3603 28.2897 24.4499 27.6232 22.5043 27.7359C21.536 27.7825 20.5865 28.0224 19.7111 28.4416C18.8358 28.8608 18.0522 29.4508 17.4059 30.1773C16.7596 30.9039 16.2636 31.7523 15.9469 32.6733C15.6301 33.5943 15.4988 34.5693 15.5608 35.5416C15.6227 36.5139 15.8766 37.4639 16.3076 38.3364C16.7387 39.2089 17.3382 39.9863 18.0714 40.6234C18.8045 41.2604 19.6566 41.7444 20.5779 42.047C21.4992 42.3497 22.4713 42.465 23.4376 42.3861ZM5.73574 46.2692L15.5443 39.9311L14.9626 38.9176L5.11278 45.1722L5.73574 46.2692Z" fill="#e4794a" stroke="#e4794a" stroke-width="1.47127" mask="url(#path-1-inside-1_677_1834)"/><path d="M55.8056 54.9357L55.8053 54.9356C53.9679 53.7622 53.1178 52.0475 53.3058 49.8972C53.3294 49.6381 53.4447 49.3591 53.6234 49.051C53.749 48.8346 53.8901 48.6287 54.0361 48.4157C54.1014 48.3203 54.1677 48.2235 54.2341 48.1238L54.2342 48.1235C54.8237 47.2354 55.4726 46.374 56.1353 45.5437C56.3434 45.2859 56.6122 45.0845 56.9172 44.9578L56.9172 44.9579L56.923 44.9553C56.9599 44.9393 57 44.9321 57.04 44.9343C57.0801 44.9366 57.1192 44.9482 57.1542 44.9684L57.3381 44.6496L57.1542 44.9684C57.1892 44.9885 57.2192 45.0168 57.2417 45.0509C57.2643 45.0851 57.2786 45.1242 57.2835 45.1651L57.2856 45.1826L57.2894 45.1999C57.6104 46.6687 57.9003 48.1378 58.1967 49.6402C58.2648 49.9854 58.3332 50.3324 58.4025 50.6815C58.3661 51.0327 58.3381 51.3785 58.3105 51.7205C58.2462 52.5158 58.1835 53.291 58.0196 54.0677C58.0039 54.1413 57.9855 54.2112 57.9646 54.2774L57.2274 53.9288C57.2588 53.8551 57.2859 53.7789 57.3096 53.7024C57.3862 53.4552 57.4388 53.1657 57.4739 52.8556C57.5443 52.235 57.5488 51.4924 57.5128 50.7585C57.4768 50.0228 57.3995 49.2844 57.3024 48.6685C57.2079 48.0695 57.0879 47.5396 56.9499 47.2536L56.7354 46.8089L56.3706 47.1425C56.2548 47.2485 56.1361 47.3593 56.0145 47.4728C55.7638 47.7069 55.5007 47.9526 55.2238 48.1917C54.6795 48.6593 54.3018 49.1965 54.1288 49.809C53.9559 50.4209 53.997 51.0746 54.2336 51.7594C54.4146 52.3383 54.7129 52.8734 55.1098 53.331C55.3952 53.66 55.7272 53.9438 56.0944 54.1737L55.7471 54.522L56.7235 54.4551L56.7277 54.4549L57.9319 54.3724C57.7731 54.799 57.5043 55.0583 57.2051 55.1753C56.8363 55.3195 56.3419 55.2789 55.8056 54.9357Z" fill="#e4794a" stroke="#e4794a" stroke-width="0.735634"/><path d="M32.0098 27.4033C31.8698 27.2844 31.5731 27.1425 31.4612 26.9121C31.1579 26.3001 30.8869 25.6725 30.6493 25.0318C30.3973 24.4023 29.9882 24.0238 29.3023 23.9844C29.1123 23.9917 28.9234 23.9526 28.7517 23.8704C28.5172 23.7179 28.2081 23.5158 28.1586 23.2791C28.1439 23.1349 28.1632 22.9893 28.2149 22.854C28.2666 22.7187 28.3493 22.5976 28.4562 22.5003C29.5039 21.7777 29.8084 20.7899 29.7264 19.5716C29.7065 19.276 29.9189 18.7875 30.1499 18.7C30.4334 18.5837 30.8707 18.7286 31.1946 18.8687C31.3888 18.9523 31.5044 19.2372 31.6316 19.4454C32.1339 20.2747 32.7479 20.9278 33.7881 21.0293C34.2101 21.07 34.6257 21.2037 34.763 21.6872C34.9004 22.1708 34.6307 22.4926 34.3129 22.7861C33.2433 23.7735 32.6731 24.9564 32.828 26.4478C32.8683 26.9232 32.6691 27.2634 32.0098 27.4033ZM30.4794 22.663L30.6854 22.453L31.8104 23.5978L32.5667 22.3769L31.0835 21.3304C30.8875 21.782 30.6846 22.2235 30.4795 22.6651L30.4794 22.663Z" fill="white"/><path d="M35.3139 40.5875C35.3348 40.8978 35.3563 41.2165 35.3777 41.5352C35.4082 41.9882 35.3326 42.3915 34.814 42.5028C34.3801 42.5957 34.023 42.3042 33.8949 41.7716C33.8565 41.6057 33.8531 41.4311 33.8311 41.2599C33.8091 41.0886 33.7922 40.9613 33.7682 40.7923C33.2267 40.6882 32.6052 40.6718 32.5854 39.9106C32.5739 39.4901 32.8465 39.305 33.5825 39.1535C33.56 38.818 33.5204 38.4794 33.5144 38.1407C33.5097 37.5722 33.777 37.2148 34.2023 37.1815C34.6277 37.1481 34.9354 37.4536 35.0143 38.0338C35.0584 38.3467 35.0566 38.6628 35.0807 39.0214C35.6566 38.982 36.1913 38.8927 36.3436 39.5669C36.4511 40.0125 36.158 40.2979 35.3139 40.5875Z" fill="white"/><path d="M21.4362 21.894C21.9395 21.8975 22.3991 21.9376 22.4815 22.5071C22.5739 23.1327 22.0685 23.2853 21.6171 23.4615C21.6054 23.6919 21.6696 23.9614 21.5678 24.1305C21.4188 24.3767 21.1636 24.6954 20.9321 24.7133C20.7847 24.6985 20.6431 24.6475 20.5199 24.5649C20.3966 24.4822 20.2955 24.3704 20.2253 24.2393C20.0438 23.8157 19.9873 23.413 19.4798 23.1592C19.0311 22.9392 19.1104 22.3418 19.5218 22.0082C19.6613 21.8997 19.8457 21.7754 19.8794 21.6214C19.9716 21.217 20.1775 20.9438 20.5923 20.9406C21.0443 20.9286 21.2544 21.2471 21.3591 21.6507C21.3761 21.7169 21.4017 21.7868 21.4362 21.894Z" fill="white"/><path d="M25.7339 38.1494L25.5118 38.0538L23.9878 37.3977L23.6345 37.2455L23.8028 36.8992C24.223 36.035 24.0136 35.2562 23.5068 34.3769L25.7339 38.1494ZM25.7339 38.1494L25.9099 37.9831M25.7339 38.1494L25.9099 37.9831M25.9099 37.9831C28.053 35.958 27.6901 32.4635 25.1777 31.0098L25.9099 37.9831ZM24.2421 30.9358L24.2421 30.9358C24.3489 30.8623 24.4644 30.8442 24.5434 30.8403C24.6273 30.8362 24.7094 30.8464 24.7803 30.8608C24.9203 30.8893 25.0655 30.9447 25.1776 31.0097L24.2421 30.9358ZM24.2421 30.9358L24.2401 30.9372M24.2421 30.9358L24.2401 30.9372M24.2401 30.9372C23.7609 31.2718 23.4531 31.907 23.3201 32.5212M24.2401 30.9372L23.3201 32.5212M23.3201 32.5212C23.1867 33.1377 23.2036 33.8514 23.5067 34.3768L23.3201 32.5212ZM23.0591 40.1014L23.0591 40.1013L23.0499 40.1021C22.3684 40.1591 21.6825 40.0799 21.0317 39.8689C20.381 39.6578 19.7782 39.3192 19.2584 38.8724C18.7385 38.4257 18.3119 37.8796 18.0032 37.2658C17.6946 36.6521 17.5101 35.9827 17.4603 35.2966L17.4603 35.2965C17.2504 32.4087 19.5441 29.8094 22.5065 29.6066C25.4646 29.4041 27.8677 31.4988 28.0702 34.4116C28.1146 35.1162 28.0201 35.8228 27.792 36.4907C27.5638 37.1589 27.2066 37.7751 26.7408 38.3039C26.275 38.8327 25.7099 39.2637 25.0781 39.5721C24.4462 39.8806 23.7601 40.0605 23.0591 40.1014ZM23.9612 38.251C23.9505 38.2473 23.9397 38.2436 23.9291 38.2399C23.7969 38.1945 23.6718 38.1514 23.5454 38.1032C23.2053 37.9729 23.0039 37.7713 22.9151 37.5596C22.8289 37.3541 22.8275 37.0893 22.9832 36.7792C23.1516 36.4926 23.2326 36.1628 23.2164 35.8306C23.2 35.4964 23.0859 35.1745 22.8883 34.9051C22.5891 34.4641 22.4159 33.9488 22.3879 33.4153C22.3597 32.8796 22.479 32.3466 22.7324 31.8747L22.7326 31.8747L22.7378 31.8643C22.8467 31.6451 22.9491 31.418 23.0581 31.1762C23.1023 31.0783 23.1475 30.9779 23.1948 30.8747L23.436 30.3474L22.8564 30.3542C21.7919 30.3667 20.7629 30.7392 19.935 31.4108C19.7356 31.5393 19.5844 31.7309 19.5054 31.9551C19.4256 32.1818 19.4243 32.4286 19.5012 32.6557C19.6015 33.0536 19.7317 33.4432 19.8905 33.8213L19.8952 33.8325L19.9006 33.8433C20.5091 35.0609 20.4616 36.3277 20.0864 37.6368C20.0145 37.8854 19.9917 38.1472 20.1124 38.3899C20.23 38.6262 20.4455 38.7653 20.6559 38.8634L20.6565 38.8637C21.7133 39.3545 22.8172 39.5094 23.9887 39.04L24.387 39.1796L24.3495 38.6228L24.3493 38.6186L24.314 38.0951L23.9612 38.251ZM19.11 34.067L18.7841 34.1721L18.7448 33.9013L18.5019 33.9369L18.1413 33.9898L18.1904 34.3509L18.514 36.7302L18.5633 37.0933L18.9267 37.0448L19.1531 37.0145L19.3869 36.9833L19.4563 36.7577C19.594 36.3104 19.6343 35.8386 19.5745 35.3744C19.5148 34.9102 19.3564 34.4643 19.11 34.067Z" fill="#e4794a" stroke="#e4794a" stroke-width="0.735634"/><path d="M25.6571 37.7115L24.1331 37.0554C24.6319 36.027 24.3565 35.1105 23.8249 34.1884C23.3498 33.3573 23.7072 31.7529 24.4499 31.2344C24.56 31.1574 24.8398 31.2351 24.9925 31.3237C27.2847 32.6497 27.6341 35.8488 25.6571 37.7115Z" fill="#F2F7FF"/><path d="M18.7969 34.2611C19.0149 34.6133 19.1551 35.0084 19.2081 35.4198C19.2611 35.8312 19.2256 36.2492 19.104 36.6457L18.8776 36.676L18.554 34.2967L18.7969 34.2611Z" fill="#F2F7FF"/></svg>\n',vC={key:0,class:"bg-alt-green-tilleul-verveine fr-p-3v fr-mt-4w fr-mx-4w fr-mb-3v"},yC={class:"fr-grid-row fr-m-0"},bC={class:"bg-blue-100 text-blue-400 fr-hidden fr-unhidden-md fr-p-2w"},wC={class:"fr-grid-row fr-grid-row--middle fr-grid-row--gutters"},kC=["innerHTML"],CC={class:"fr-col"},xC={class:"fr-text--bold fr-m-0"},SC={class:"fr-text--sm fr-m-0 f-italic"},_C={class:"fr-col-auto fr-my-0"},TC=["href"],$C={class:"fr-table fr-table--no-background fr-p-0 fr-pt-0-5v fr-m-0"},OC={class:"fr-mb-3w"},MC={class:"fr-sr-only"},EC={scope:"col"},NC={class:"fr-grid-row fr-grid-row--middle col-width"},DC=["onClick"],AC={class:"fr-sr-only"},RC={class:"cell-padding"},IC={class:"fr-grid-row fr-grid-row--middle fr-text--xs w-100 style-cell"},PC={class:"fr-my-auto"},LC={class:"fr-px-5v"},zC=L({__name:"Preview",props:{resource:{}},setup(t){const e=t,{t:n}=be(),r=T([]),o=T([]),s=T(!0),i=T(!1),a=T(null),l=T(0),c=rt.tabular_page_size,u=T(1);function d(y){var w;return y===((w=a.value)==null?void 0:w.column)}async function f(y,w){try{const{data:x}=await sC(e.resource.id,y,w);"data"in x&&x.data&&x.data.length>0?(r.value=x.data,o.value=Object.keys(x.data[0]).filter($=>$!=="__id"),l.value=x.meta.total,u.value=y,s.value=!1):(i.value=!0,s.value=!1)}catch(x){i.value=!0,s.value=!1}}function p(y){f(y,a.value)}function h(y){a.value&&a.value.column==y?a.value.type=="asc"?a.value.type="desc":a.value.type="asc":a.value?(a.value.column=y,a.value.type="asc"):a.value={column:y,type:"asc"},u.value=1,f(u.value,a.value)}const v=Er(e.resource.extras["analysis:parsing:finished_at"]);return De(()=>{f(u.value)}),(y,w)=>(b(),k("div",null,[i.value?(b(),k("div",vC,[g("p",yC,[w[0]||(w[0]=g("span",{class:"fr-icon-warning-line","aria-hidden":"true"},null,-1)),U(" "+C(m(n)("The preview of this file failed to load.")),1)])])):s.value?(b(),j(R1,{key:1})):(b(),k(K,{key:2},[g("div",bC,[g("div",wC,[g("div",{class:"fr-col-auto",innerHTML:m(gC)},null,8,kC),g("div",CC,[g("p",xC,C(m(n)("Explore data in detail")),1),g("p",SC,C(m(n)("Use our tool to get an overview of data, learn about different columns or perform filters and sorts.")),1)]),g("p",_C,[g("a",{href:t.resource.preview_url,class:"fr-btn",target:"_blank"},C(m(n)("Explore data")),9,TC)])])]),g("div",$C,[g("table",OC,[g("caption",MC,C(m(n)("Preview of {name}",{name:t.resource.title})),1),g("thead",null,[g("tr",null,[(b(!0),k(K,null,Ne(o.value,x=>(b(),k("th",EC,[g("div",NC,[g("button",{class:ae(["fr-btn fr-btn--sm fr-btn--tertiary-no-outline fr-my-n1w",{"fr-btn--secondary-grey-500":!d(x),"fr-btn--icon-right":d(x),"fr-icon-arrow-down-line":d(x)&&a.value&&a.value.type=="desc","fr-icon-arrow-up-line":d(x)&&a.value&&a.value.type=="asc"}]),onClick:$=>h(x)},[U(C(x)+" ",1),g("span",AC,C(a.value&&a.value.type=="desc"?m(n)("Sort ascending"):m(n)("Sort descending")),1)],10,DC)])]))),256))])]),g("tbody",null,[(b(!0),k(K,null,Ne(r.value,x=>(b(),k("tr",null,[(b(!0),k(K,null,Ne(o.value,$=>(b(),k("td",RC,[g("div",IC,[g("div",PC,C(x[$]),1)])]))),256))]))),256))])])]),M(m(_o),{class:"fr-mt-3w",page:u.value,pageSize:m(c),totalResults:l.value,onChange:p},null,8,["page","pageSize","totalResults"]),g("div",LC,C(m(n)("Preview updated on {date}",{date:m(v)}))+"  "+C(m(n)("{count} columns",o.value.length))+"  "+C(m(n)("{count} rows",l.value)),1)],64))]))}}),BC=ke(zC,[["__scopeId","data-v-90a6d6fe"]]),FC=["href"],VC=L({__name:"EditButton",props:{datasetId:{},isCommunityResource:{type:Boolean,default:!1},resource:{}},setup(t){const e=t,{t:n}=be(),r=O(()=>rt.new_admin?"owner"in e.resource&&e.resource.owner?"".concat(rt.admin_root,"users/").concat(e.resource.owner.id,"/community-resources/?resource_id=").concat(e.resource.id):"organization"in e.resource&&e.resource.organization?"".concat(rt.admin_root,"organization/").concat(e.resource.organization.id,"/community-resources/?resource_id=").concat(e.resource.id):"".concat(rt.admin_root,"datasets/").concat(e.datasetId,"/files/?resource_id=").concat(e.resource.id):"".concat(rt.admin_root,"dataset/").concat(e.datasetId,"/").concat(e.isCommunityResource?"community-resource":"resource","/").concat(e.resource.id));return(o,s)=>(b(),k("a",{href:r.value,class:"fr-btn fr-btn--secondary fr-btn--secondary-warning-425 fr-icon-pencil-line fr-icon--sm","data-testid":"edit-button"},C(m(n)("Edit file")),9,FC))}}),HC="/_themes/gouvfr/assets/file.svg",qC="/_themes/gouvfr/assets/code.svg",UC="/_themes/gouvfr/assets/archive.svg",WC="/_themes/gouvfr/assets/documentation.svg",jC="/_themes/gouvfr/assets/link2.svg",KC="/_themes/gouvfr/assets/table.svg",YC="/_themes/gouvfr/assets/map.svg",GC="/_themes/gouvfr/assets/globe.svg";function I1(t){var e,n;switch((n=(e=t.format)==null?void 0:e.trim())==null?void 0:n.toLowerCase()){case"txt":case"pdf":case"rtf":case"odt":case"doc":case"docx":case"epub":return WC;case"json":case"sql":case"xml":case"xsd":case"shp":case"kml":case"kmz":case"gpx":case"shx":case"ovr":case"gpkg":case"grib2":case"dbf":case"prj":case"sqlite":case"db":case"sbn":case"sbx":case"cpg":case"lyr":case"owl":case"dxf":case"ics":case"rdf":case"ttl":case"n3":return qC;case"tar":case"gz":case"tgz":case"rar":case"zip":case"7z":case"xz":case"bz2":return UC;case"url":return jC;case"csv":case"ods":case"xls":case"xlsx":case"parquet":case"csv.gz":return KC;case"geojson":return YC;case"ogc:wfs":case"ogc:wms":case"wfs":case"wms":return GC;default:return null}}function P1(t){return"resource-"+t.id+"-title"}const JC={class:"fr-icon-svg flex items-center"},XC=["src"],ZC=L({__name:"ResourceIcon",props:{resource:{}},setup(t){const e=t,n=O(()=>I1(e.resource)||HC);return(r,o)=>(b(),k("div",JC,[g("img",{src:n.value,alt:""},null,8,XC)]))}}),QC={key:0,class:"inline-flex fr-mb-0 align-items-baseline fr-text--xs"},e4={class:"flex justify-between border-bottom"},t4={class:"fr-text--sm fr-my-0 fr-p-2v"},n4=["onClick","title"],r4={class:"fr-p-3v"},o4={key:0},s4={key:1},i4={key:2},a4={key:3,class:"text-default-warning flex items-center fr-mt-4v"},l4={key:4,class:"text-default-warning flex items-center fr-mt-4v"},c4={key:5,class:"text-default-warning flex items-center fr-mt-4v"},u4={key:6,class:"w-100 text-align-right fr-mt-5v",target:"_blank"},d4=["href"],f4={class:"fr-mr-1v text-grey-380"},h4={class:"flex items-center bg-error-950 rounded-sm"},p4={class:"fr-tag fr-tag--sm"},m4={key:0,class:"flex items-center padding-sm"},g4={key:1,class:"flex items-center text-warning-425 padding-sm"},v4=L({__name:"SchemaBadge",props:{resource:{}},setup(t){const e=t,{t:n}=be(),r=T(null);De(async()=>{r.value=await jg()});const o=O(()=>r.value?$w(r.value,e.resource.schema):null),s=O(()=>o.value?Mw(e.resource,o.value):null),i=O(()=>o.value?Ow(o.value.name):null),a=O(()=>e.resource.schema?e.resource.schema.name||e.resource.schema.url:null),l=O(()=>e.resource.extras["validation-report:errors"]||[]),c=O(()=>l.value.filter(p=>[""].includes(p.code))),u=O(()=>l.value.filter(p=>["#body","#cell","#content","#row","#table"].some(h=>p.tags.includes(h)))),d=O(()=>l.value.filter(p=>["#head","#structure","#header"].some(h=>p.tags.includes(h)))),f=O(()=>l.value.length===0?"ok":l.value.length===c.value.length?"warnings":"ko");return(p,h)=>a.value?(b(),k("span",QC,[M(Zd,{position:"right",noMargin:"",class:"relative z-2"},{toggletip:W(({close:v})=>[g("div",e4,[g("h5",t4,C(p.$t("Data schema")),1),g("button",{type:"button",onClick:v,title:m(n)("Close"),class:"border-left close-button flex items-center justify-center"},"",8,n4)]),g("div",r4,[f.value==="ok"?(b(),k("div",o4,[U(C(m(n)("This file is valid for the shema:"))+" ",1),(b(),j(to(i.value?"a":"span"),{href:i.value,class:"fr-link fr-text--sm"},{default:W(()=>[U(C(a.value),1)]),_:1},8,["href"])),h[0]||(h[0]=U(". ",-1))])):I("",!0),f.value==="warnings"?(b(),k("div",s4,[U(C(m(n)("This file is valid for the shema:"))+" ",1),(b(),j(to(i.value?"a":"span"),{href:i.value,class:"fr-link fr-text--sm"},{default:W(()=>[U(C(a.value),1)]),_:1},8,["href"])),U(". "+C(m(n)("But its compliance could be improved.")),1)])):I("",!0),f.value==="ko"?(b(),k("div",i4,[U(C(m(n)("This file indicates to follow the schema:"))+" ",1),(b(),j(to(i.value?"a":"span"),{href:i.value,class:"fr-link fr-text--sm"},{default:W(()=>[U(C(a.value),1)]),_:1},8,["href"])),U(". "+C(m(n)("But is not compliant.")),1)])):I("",!0),c.value.length?(b(),k("div",a4,[h[1]||(h[1]=g("span",{class:"fr-icon-alert-line fr-icon--sm fr-mr-1v"},null,-1)),g("span",null,C(c.value.length)+" "+C(m(n)("advices")),1)])):I("",!0),d.value.length?(b(),k("div",l4,[h[2]||(h[2]=g("span",{class:"fr-icon-alert-line fr-icon--sm fr-mr-1v"},null,-1)),g("span",null,C(d.value.length)+" "+C(m(n)("structure errors")),1)])):I("",!0),u.value.length?(b(),k("div",c4,[h[3]||(h[3]=g("span",{class:"fr-icon-alert-line fr-icon--sm fr-mr-1v"},null,-1)),g("span",null,C(u.value.length)+" "+C(m(n)("body errors")),1)])):I("",!0),s.value?(b(),k("div",u4,[g("a",{href:s.value},C(m(n)("See validation report")),9,d4)])):I("",!0)])]),_:1}),g("span",f4,C(m(n)("Schema:")),1),g("span",h4,[g("span",p4,C(a.value),1),f.value==="warnings"?(b(),k("span",m4,[h[4]||(h[4]=g("span",{class:"fr-icon-alert-line fr-icon--sm fr-mr-1v"},null,-1)),g("span",null,C(m(n)("Invalid")),1)])):I("",!0),f.value==="ko"?(b(),k("span",g4,[h[5]||(h[5]=g("span",{class:"fr-icon-error-line fr-icon--sm fr-mr-1v"},null,-1)),g("span",null,C(m(n)("Invalid")),1)])):I("",!0)])])):I("",!0)}}),y4=ke(v4,[["__scopeId","data-v-bf96ce2f"]]),b4={class:"fr-text--sm fr-ml-0 fr-mt-0 fr-mb-2w text-mention-grey h-4w fr-grid-row fr-grid-row--middle"},w4={key:0,class:"text-overflow-ellipsis"},Dn=L({__name:"DescriptionDetails",props:{withEllipsis:{type:Boolean,default:!0}},setup(t){return(e,n)=>(b(),k("dd",b4,[t.withEllipsis?(b(),k("div",w4,[Le(e.$slots,"default")])):Le(e.$slots,"default",{key:1})]))}}),k4={},C4={class:"fr-my-0"};function x4(t,e){return b(),k("dl",C4,[Le(t.$slots,"default")])}const Vc=ke(k4,[["render",x4]]),S4={},_4={class:"fr-text--sm fr-my-0 fr-text--bold"};function T4(t,e){return b(),k("dt",_4,[Le(t.$slots,"default")])}const An=ke(S4,[["render",T4]]),$4={class:"flex gap-3rem flex-col-on-small"},O4={class:"code"},M4=["href"],E4={class:"code"},N4=["href"],D4={class:"code"},A4={class:"code"},R4={class:"code text-overflow-ellipsis"},I4=L({__name:"Metadata",props:{resource:{}},setup(t){const e=t,n=O(()=>Object.keys(e.resource.extras).length),r=O(()=>P1(e.resource)),{t:o}=be();return(s,i)=>(b(),k("div",null,[g("div",$4,[M(Vc,{class:"flex-1"},{default:W(()=>[M(An,null,{default:W(()=>[U(C(m(o)("URL"))+" ",1),M(Wr,{label:s.$t("Copy URL"),"copied-label":s.$t("URL copied!"),text:t.resource.url,"aria-describedby":r.value},null,8,["label","copied-label","text","aria-describedby"])]),_:1}),M(Dn,{"with-ellipsis":!1},{default:W(()=>[g("code",O4,[g("a",{href:t.resource.url},[M(m(Nt),{"max-lines":1,autoresize:!0,text:t.resource.url},null,8,["text"])],8,M4)])]),_:1}),M(An,null,{default:W(()=>[U(C(m(o)("Stable URL"))+" ",1),M(Wr,{label:s.$t("Copy stable URL"),"copied-label":s.$t("Stable URL copied!"),text:t.resource.latest,"aria-describedby":r.value},null,8,["label","copied-label","text","aria-describedby"])]),_:1}),M(Dn,{"with-ellipsis":!1},{default:W(()=>[g("code",E4,[g("a",{href:t.resource.latest},[M(m(Nt),{"max-lines":1,autoresize:!0,text:t.resource.latest},null,8,["text"])],8,N4)])]),_:1}),M(An,null,{default:W(()=>[U(C(m(o)("Identifier"))+" ",1),M(Wr,{label:s.$t("Copy ID"),"copied-label":s.$t("ID copied!"),text:t.resource.id,"aria-describedby":r.value},null,8,["label","copied-label","text","aria-describedby"])]),_:1}),M(Dn,{"with-ellipsis":!1},{default:W(()=>[g("code",D4,[M(m(Nt),{"max-lines":1,autoresize:!0,text:t.resource.id},null,8,["text"])])]),_:1}),t.resource.checksum?(b(),k(K,{key:0},[M(An,null,{default:W(()=>[U(C(t.resource.checksum.type)+" ",1),M(Wr,{label:s.$t("Copy checksum"),"copied-label":s.$t("Checksum copied!"),text:t.resource.checksum.value,"aria-describedby":r.value},null,8,["label","copied-label","text","aria-describedby"])]),_:1}),M(Dn,{"with-ellipsis":!1},{default:W(()=>[g("code",A4,[M(m(Nt),{"max-lines":1,autoresize:!0,text:t.resource.checksum.value},null,8,["text"])])]),_:1})],64)):I("",!0)]),_:1}),M(Vc,{style:{"flex-shrink":"0"}},{default:W(()=>[M(An,null,{default:W(()=>[U(C(m(o)("Created on")),1)]),_:1}),M(Dn,null,{default:W(()=>[U(C(m(Er)(t.resource.created_at)),1)]),_:1}),M(An,null,{default:W(()=>[U(C(m(o)("Modified on")),1)]),_:1}),M(Dn,null,{default:W(()=>[U(C(m(Er)(t.resource.last_modified)),1)]),_:1})]),_:1}),M(Vc,{style:{"flex-shrink":"0"}},{default:W(()=>[t.resource.filesize?(b(),k(K,{key:0},[M(An,null,{default:W(()=>[U(C(m(o)("Size")),1)]),_:1}),M(Dn,null,{default:W(()=>[U(C(m(Oa)(t.resource.filesize)),1)]),_:1})],64)):I("",!0),t.resource.mime?(b(),k(K,{key:1},[M(An,null,{default:W(()=>[U(C(m(o)("Type")),1)]),_:1}),M(Dn,null,{default:W(()=>[U(C(m(Pb)(t.resource.type)),1)]),_:1})],64)):I("",!0),t.resource.mime?(b(),k(K,{key:2},[M(An,null,{default:W(()=>[U(C(m(o)("MIME Type")),1)]),_:1}),M(Dn,null,{default:W(()=>[g("code",R4,C(t.resource.mime),1)]),_:1})],64)):I("",!0)]),_:1})]),g("div",null,[n.value?(b(),j(I3,{key:0,class:"fr-pt-3w fr-mt-3w border-top border-default-grey","button-text":m(o)("See extras"),"title-text":m(o)("Resource Extras"),"title-level":"h5",extra:t.resource.extras},null,8,["button-text","title-text","extra"])):I("",!0)])]))}}),P4=ke(I4,[["__scopeId","data-v-f2a0bf07"]]),L4=L({__name:"TabGroup",props:{size:{default:"md"}},setup(t){return(e,n)=>(b(),j(m(Ok),{as:"div",class:ae({"tabs-sm":t.size==="sm"})},{default:W(()=>[Le(e.$slots,"default")]),_:3},8,["class"]))}}),z4=L({__name:"TabList",setup(t){return(e,n)=>(b(),j(m(Mk),{class:"fr-segmented__elements"},{default:W(()=>[Le(e.$slots,"default",{},void 0,!0)]),_:3}))}}),B4=ke(z4,[["__scopeId","data-v-999cc2d0"]]),F4={class:"inner"},V4=L({__name:"Tab",setup(t){return(e,n)=>(b(),j(m(Ek),{as:"template"},{default:W(({selected:r})=>[g("button",{class:ae(["fr-segmented__element",{selected:r}])},[g("div",F4,[Le(e.$slots,"default",{},void 0,!0)])],2)]),_:3}))}}),H4=ke(V4,[["__scopeId","data-v-80aca752"]]),q4=L({__name:"TabPanels",setup(t){return(e,n)=>(b(),j(m(Nk),null,{default:W(()=>[Le(e.$slots,"default")]),_:3}))}}),U4=L({__name:"TabPanel",setup(t){return(e,n)=>(b(),j(m(Dk),null,{default:W(()=>[Le(e.$slots,"default")]),_:3}))}});function Bs(t){var e;(e=globalThis._paq)==null||e.push(["trackEvent",...t])}const W4={class:"flex items-center fr-mb-1v"},j4=["id"],K4=["aria-expanded"],Y4={class:"text-grey-380 subheaders-infos"},G4={class:"fr-text--xs fr-mb-0 dash-after"},J4={key:0,class:"fr-text--xs fr-mb-0 dash-after"},X4={class:"hidden show-on-small"},Z4={key:0},Q4=["aria-label"],ex={class:"hidden show-on-small"},tx={key:0,class:"fr-mb-0 fr-mt-1v fr-text--xs text-grey-380"},nx=["href"],rx={class:"flex items-center fr-ml-4v buttons"},ox={key:0,class:"fr-col-auto fr-ml-3v fr-m-0 z-2"},sx=["href","title","aria-describedby"],ix={key:1,class:"fr-col-auto fr-ml-3v fr-m-0 z-2"},ax=["id","data-clipboard-text","aria-describedby"],lx={key:2,class:"fr-col-auto fr-ml-3v fr-m-0"},cx=["href","title","aria-describedby"],ux={class:"fr-sr-only"},dx={key:3,class:"fr-col-auto fr-ml-3v fr-m-0 z-2"},fx=["aria-labelledby"],hx={class:"fr-pl-4v fr-pr-4v fr-pb-4v"},px={key:0},mx={key:1,class:"fr-pl-4v fr-pr-4v"},gx=["innerHTML"],vx={key:2,class:"fr-pl-4v fr-pr-4v"},yx={key:3,class:"fr-pl-4v fr-pr-4v"},bx={key:4,class:"fr-pl-4v fr-pr-4v"},wx={class:"fr-pl-0"},kx={key:0,class:"font-bold fr-text--sm fr-mb-0"},Cx={key:1,class:"font-bold fr-text--sm fr-mb-0"},xx={class:"fr-text--sm fr-ml-0 fr-mt-0 fr-mb-2w text-mention-grey h-4w fr-grid-row fr-grid-row--middle"},Sx={key:0},_x=["href"],Tx={key:1},$x=["href"],Ox={key:0},Mx={class:"font-bold fr-text--sm fr-mb-0"},Ex={class:"fr-text--sm fr-ml-0 fr-mt-0 fr-mb-2w text-mention-grey h-4w fr-grid-row fr-grid-row--middle"},Nx=["href"],Dx={key:0},Ax={key:5,class:"fr-pl-4v fr-pr-4v"},Rx=L({__name:"ResourceAccordion",props:{datasetId:{},expandedOnMount:{type:Boolean,default:!1},isCommunityResource:{type:Boolean,default:!1},resource:{},canEdit:{type:Boolean,default:!1}},setup(t){zd(Fw,zw);const e=["ogc:wfs","ogc:wms","wfs","wms"],n=t,r=Ug(()=>dr(()=>import("./Swagger.6.2.4.js"),["js/Swagger.6.2.4.js","js/_commonjsHelpers.6.2.4.js","js/i18n.6.2.4.js"])),{t:o}=be(),s=O(()=>rt.tabular_api_url&&n.resource.extras["analysis:parsing:finished_at"]&&!n.resource.extras["analysis:parsing:error"]&&(rt.tabular_allow_remote||n.resource.filetype==="file")),i=O(()=>I1(n.resource)?n.resource.format:o("File")),a=O(()=>e.includes(n.resource.format)),l=T(n.expandedOnMount),c=()=>{l.value=!l.value,l.value?Bs(["Open resource",n.resource.id]):Bs(["Close resource",n.resource.id])},u=O(()=>{let E=[];return s.value&&E.push({key:"data",label:o("Data")}),n.resource.description&&E.push({key:"description",label:o("Description")}),s.value&&E.push({key:"data-structure",label:o("Data structure")}),E.push({key:"metadata",label:o("Metadata")}),E.push({key:"downloads",label:o("Downloads")}),s.value&&E.push({key:"swagger",label:o("Swagger")}),E}),d=E=>{const D=u.value[E];Bs(["View resource tab",n.resource.id,D.label]),D.key==="data"&&Bs(["Show preview",n.resource.id]),D.key==="data-structure"&&Bs(["Show data structure",n.resource.id])},f=O(()=>n.isCommunityResource?n.resource:null),p=Xl(f.value),h=n.resource.last_modified,y=n.resource.extras&&"check:available"in n.resource.extras&&n.resource.extras["check:available"]===!1,w=y?o("The {certifier} robot failed to access this file - Download file as {format}",{certifier:rt.title,format:i.value}):o("Download file as {format}",{format:i.value}),x=O(()=>"".concat(window.location.origin).concat(window.location.pathname,"#/").concat(n.isCommunityResource?"community-resources":"resources","/").concat(n.resource.id)),$="resource-"+n.resource.id,S="resource-"+n.resource.id+"-header",_=P1(n.resource);return(E,D)=>(b(),k("div",{class:ae(["border border-default-grey",{"fr-pb-4v":l.value}])},[g("header",{class:"fr-p-4v flex items-center justify-between relative",id:S},[g("div",null,[g("div",W4,[g("h4",{class:"fr-m-0",id:m(_)},[g("button",{type:"button",onClick:c,class:"fr-p-0 flex items-center","data-testid":"expand-button","aria-expanded":l.value},[M(ZC,{resource:t.resource,class:"fr-icon--xs fr-mr-1v"},null,8,["resource"]),g("span",{class:ae({"font-bold":l.value})},[M(m(Nt),{"max-lines":1,text:t.resource.title||m(o)("Nameless file")},null,8,["text"])],2),D[0]||(D[0]=g("span",{class:"absolute inset-0 z-1"},null,-1))],8,K4)],8,j4),M(Wr,{label:E.$t("Copy link"),"copied-label":E.$t("Link copied!"),text:x.value,class:"z-2"},null,8,["label","copied-label","text"])]),g("div",Y4,[M(y4,{resource:t.resource,class:"dash-after"},null,8,["resource"]),g("span",G4,C(m(o)("Updated {date}",{date:m(Fl)(m(h))})),1),t.resource.format?(b(),k("span",J4,[g("span",X4,C(m(o)("Format")),1),U(" "+C(t.resource.format.trim().toLowerCase())+" ",1),t.resource.filesize?(b(),k("span",Z4,"("+C(m(Oa)(t.resource.filesize))+")",1)):I("",!0)])):I("",!0),g("span",{class:"inline-flex items-center fr-text--xs fr-mb-0","aria-label":m(o)("{n} downloads",t.resource.metrics.views)},[D[1]||(D[1]=g("span",{class:"fr-icon-download-line fr-icon--xs fr-mr-1v"},null,-1)),g("span",null,[U(C(m(Wo)(t.resource.metrics.views))+" ",1),g("span",ex,C(m(o)("downloads")),1)])],8,Q4)]),f.value?(b(),k("p",tx,[U(C(m(o)("From"))+" ",1),f.value.organization?(b(),k("a",{key:0,class:"fr-link fr-text--xs",href:f.value.organization.page},[M(uo,{organization:f.value.organization},null,8,["organization"])],8,nx)):m(p)?(b(),k(K,{key:1},[U(C(m(p)),1)],64)):I("",!0)])):I("",!0)]),g("div",rx,[t.resource.format==="url"?(b(),k("p",ox,[g("a",{href:t.resource.latest,title:m(o)("File link - opens a new window"),"aria-describedby":m(_),rel:"ugc nofollow noopener",target:"_blank",class:"fr-btn fr-btn--sm"},C(E.$t("Visit")),9,sx)])):a.value?(b(),k("p",ix,[g("button",{id:t.resource.id+"-copy","data-clipboard-text":t.resource.url,"aria-describedby":m(_),class:"fr-btn fr-btn--sm"},[g("span",null,[M(m(Uo),{height:16,width:16,name:"ri-file-copy-line",class:"copy-icon fr-mr-2v"})]),U(" "+C(m(o)("Copy link")),1)],8,ax)])):(b(),k("p",lx,[g("a",{href:t.resource.latest,rel:"ugc nofollow noopener",title:m(w),target:"_blank",download:"",class:"relative text-transform-uppercase fr-btn fr-btn--sm matomo_download z-2","aria-describedby":m(_)},[m(y)?(b(),j(m(Uo),{key:0,height:16,width:16,name:"ri-file-warning-line",class:"fr-mr-2v"})):(b(),j(m(Uo),{key:1,height:16,width:16,name:"ri-download-line",class:"fr-mr-2v"})),g("span",ux,C(m(o)("Download file as ")),1),U(C(i.value),1)],8,cx)])),t.canEdit?(b(),k("p",dx,[M(VC,{"dataset-id":t.datasetId,resource:t.resource,"is-community-resource":t.isCommunityResource},null,8,["dataset-id","resource","is-community-resource"])])):I("",!0),g("div",{class:ae(["fr-icon--sm fr-ml-4v",{"fr-icon-arrow-up-s-line":l.value,"fr-icon-arrow-down-s-line":!l.value}])},null,2)])]),l.value?(b(),k("section",{key:0,"aria-labelledby":m(_),id:$},[M(L4,{size:"sm",onChange:d},{default:W(()=>[g("div",hx,[M(B4,{style:{"max-width":"100%","overflow-y":"auto"}},{default:W(()=>[(b(!0),k(K,null,Ne(u.value,N=>(b(),j(H4,{key:N.key},{default:W(()=>[U(C(N.label),1)]),_:2},1024))),128))]),_:1})]),M(q4,null,{default:W(()=>[(b(!0),k(K,null,Ne(u.value,N=>(b(),j(U4,{key:N.key},{default:W(()=>[N.key==="data"?(b(),k("div",px,[M(BC,{resource:t.resource},null,8,["resource"])])):I("",!0),N.key==="description"?(b(),k("div",mx,[g("div",{class:"fr-mt-0 markdown fr-text--sm text-mention-grey",innerHTML:m(Lb)(t.resource.description||"")},null,8,gx)])):I("",!0),N.key==="data-structure"?(b(),k("div",vx,[s.value?(b(),j(mC,{key:0,resource:t.resource},null,8,["resource"])):I("",!0)])):I("",!0),N.key==="metadata"?(b(),k("div",yx,[M(P4,{resource:t.resource},null,8,["resource"])])):I("",!0),N.key==="downloads"?(b(),k("div",bx,[g("dl",wx,[t.resource.format==="url"?(b(),k("dt",kx,C(E.$t("Original URL")),1)):(b(),k("dt",Cx,C(E.$t("Original format")),1)),g("dd",xx,[t.resource.format==="url"?(b(),k("span",Sx,[g("a",{href:t.resource.latest,class:"fr-link no-icon-after",rel:"ugc nofollow noopener",target:"_blank"},[M(m(Nt),{"auto-resize":!0,"max-lines":1,text:t.resource.url},{after:W(()=>[...D[2]||(D[2]=[g("span",{class:"fr-ml-1v fr-icon-external-link-line fr-icon--sm"},null,-1)])]),_:1},8,["text"])],8,_x)])):(b(),k("span",Tx,[D[3]||(D[3]=g("span",{class:"text-blue-400 fr-icon-download-line fr-icon--sm fr-mr-1v fr-mt-1v"},null,-1)),g("a",{href:t.resource.latest,class:"fr-link",rel:"ugc nofollow noopener"},[g("span",null,[U(C(E.$t("Format {format}",{format:t.resource.format})),1),t.resource.filesize?(b(),k("span",Ox," - "+C(m(Oa)(t.resource.filesize)),1)):I("",!0)])],8,$x)])),M(Wr,{label:E.$t("Copy link"),"copied-label":E.$t("Link copied!"),text:t.resource.latest,class:"relative"},null,8,["label","copied-label","text"])]),t.resource.extras["analysis:parsing:parquet_url"]?(b(),k(K,{key:2},[g("dt",Mx,C(E.$t("Auto-generated formats from {platform}",{platform:m(rt).title})),1),g("dd",Ex,[g("span",null,[D[4]||(D[4]=g("span",{class:"text-blue-400 fr-icon-download-line fr-icon--sm fr-mr-1v fr-mt-1v"},null,-1)),g("a",{href:t.resource.extras["analysis:parsing:parquet_url"],class:"fr-link",rel:"ugc nofollow noopener"},[g("span",null,[U(C(E.$t("Format {format}",{format:"parquet"})),1),t.resource.extras["analysis:parsing:parquet_size"]?(b(),k("span",Dx," - "+C(m(Oa)(t.resource.extras["analysis:parsing:parquet_size"])),1)):I("",!0)])],8,Nx)]),M(Wr,{label:E.$t("Copy link"),"copied-label":E.$t("Link copied!"),text:t.resource.extras["analysis:parsing:parquet_url"],class:"relative"},null,8,["label","copied-label","text"])])],64)):I("",!0)])])):I("",!0),N.key==="swagger"?(b(),k("div",Ax,[g("div",null,C(m(o)("Swagger automatically generated by data.gouv.fr. This swagger allows you to query data by API by filtering it by column value.")),1),s.value?(b(),j(m(r),{key:0,url:"".concat(m(rt).tabular_api_url,"/api/resources/").concat(n.resource.id,"/swagger/")},null,8,["url"])):I("",!0)])):I("",!0)]),_:2},1024))),128))]),_:1})]),_:1})],8,fx)):I("",!0)],2))}}),L1=ke(Rx,[["__scopeId","data-v-2ffb3898"]]),Ix=88,z1=L({__name:"Loader",setup(t){return(e,n)=>(b(),j(m(Gi),{width:1200,height:Ix,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},{default:W(()=>[...n[0]||(n[0]=[g("rect",{x:"20",y:"24",rx:"4",ry:"4",width:"16",height:"16"},null,-1),g("rect",{x:"52",y:"20",rx:"4",ry:"4",width:"536",height:"22"},null,-1),g("rect",{x:"52",y:"52",rx:"4",ry:"4",width:"374",height:"16"},null,-1),g("rect",{x:"1052",y:"30",rx:"4",ry:"4",width:"80",height:"20"},null,-1),g("rect",{x:"1154",y:"20",rx:"20",ry:"20",width:"40",height:"40"},null,-1)])]),_:1}))}});function Px(t){return{label:f1(async()=>{const n=Ke(t),r=await _w();return Tw(r,n)},"")}}const Lx={class:"fr-card fr-card--no-icon fr-enlarge-link"},zx={class:"fr-card__body"},Bx={class:"fr-card__content fr-px-2w fr-py-1v"},Fx={class:"fr-card__title fr-text--md fr-mt-1v fr-mb-0"},Vx={class:"fr-card__desc fr-mt-0 text-mention-grey"},Hx={class:"fr-text--sm fr-mb-0 flex"},qx={key:0,class:"not-enlarged"},Ux={class:"dash-before-sm text-overflow-ellipsis"},Wx={class:"fr-grid-row fr-grid-row--middle"},jx={class:"fr-text--sm fr-my-0 dash-after-sm"},Kx=["aria-label"],Yx=["aria-label"],Gx={class:"fr-card__header"},Jx={class:"fr-card__img"},Xx={key:0,class:"fr-badges-group"},Zx={key:0},Qx={class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380"},eS={key:1},tS={class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380"},nS=L({__name:"ReuseCard",props:{reuse:{},reuseUrl:{},organizationUrl:{}},setup(t){const e=t,{t:n}=be(),r=Xl(e.reuse),{label:o}=Px(()=>e.reuse.type);return(s,i)=>(b(),k("article",Lx,[g("div",zx,[g("div",Bx,[g("h3",Fx,[M(ps,{class:"text-grey-500",to:t.reuseUrl},{default:W(()=>[M(m(Nt),{"auto-resize":!0,text:t.reuse.title,"max-lines":1},null,8,["text"])]),_:1},8,["to"])]),g("div",Vx,[g("p",Hx,[t.reuse.organization?(b(),k("span",qx,[t.organizationUrl?(b(),j(ps,{key:0,class:"fr-link",to:t.organizationUrl},{default:W(()=>[M(m(uo),{organization:t.reuse.organization},null,8,["organization"])]),_:1},8,["to"])):(b(),j(m(uo),{key:1,organization:t.reuse.organization},null,8,["organization"]))])):(b(),j(m(Nt),{key:1,class:"not-enlarged fr-mr-1v","auto-resize":!0,text:m(r),"max-lines":1},null,8,["text"])),g("span",Ux,C(m(n)("published {date}",{date:m(Fl)(t.reuse.created_at)})),1)]),g("div",Wx,[g("p",jx,C(m(o)),1),g("p",{class:"fr-text--sm fr-my-0","aria-label":m(n)("{n} views",t.reuse.metrics.views)},[i[0]||(i[0]=g("span",{class:"fr-icon-eye-line fr-icon--xs fr-px-1v","aria-hidden":"true"},null,-1)),U(C(m(Wo)(t.reuse.metrics.views)),1)],8,Kx),g("p",{class:"fr-text--sm fr-my-0","aria-label":m(n)("{n} followers",t.reuse.metrics.followers)},[i[1]||(i[1]=g("span",{class:"fr-icon-star-line fr-icon--xs fr-px-1v","aria-hidden":"true"},null,-1)),U(C(m(Wo)(t.reuse.metrics.followers)),1)],8,Yx)])])])]),g("div",Gx,[g("div",Jx,[M(Fu,{class:"fr-responsive-img reuse-ratio",alt:"",type:"reuse",src:t.reuse.image,size:320},null,8,["src"])]),t.reuse.private||t.reuse.archived?(b(),k("ul",Xx,[t.reuse.private?(b(),k("li",Zx,[g("p",Qx,[i[2]||(i[2]=g("span",{class:"fr-icon-lock-line fr-icon--xs"},null,-1)),U(" "+C(m(n)("Draft")),1)])])):I("",!0),t.reuse.archived?(b(),k("li",eS,[g("p",tS,[i[3]||(i[3]=g("span",{class:"fr-icon-lock-line fr-icon--xs"},null,-1)),U(" "+C(m(n)("Archived")),1)])])):I("",!0)])):I("",!0)])]))}}),rS=ke(nS,[["__scopeId","data-v-81c3bbfa"]]),cl=L({__name:"Well",props:{type:{default:"primary"},color:{default:"grey-100"},weight:{default:"semi-bold"}},setup(t){const e=t,n=O(()=>"well".concat(e.type==="primary"?"":"-"+e.type,"-").concat(e.color)),r=O(()=>"fr-text--".concat(e.weight)),o=O(()=>r.value+" "+n.value);return(s,i)=>(b(),k("div",{class:ae(["well",o.value])},[Le(s.$slots,"default")],2))}});let _p=0;function $s(t="id"){return _p++,ql({id:"".concat(t,"-").concat(_p)})}const oS=L({props:{data:{type:Object,required:!0},type:{type:String,default:"bar"}},setup(t){const{id:e}=$s("bar-chart"),n=Object.keys(t.data),r="MM/YY",o=Er(n.shift()||"",r),s=Er(n.pop()||"",r);return De(()=>{const i=document.getElementById(e),a=i==null?void 0:i.getContext("2d");if(!a)return;const l="#B6CFFB",c="#3558A2";let u={data:Object.values(t.data),type:t.type};if(t.type==="bar"){const d=u;d.barPercentage=1,d.categoryPercentage=.9,d.backgroundColor=d.data.map((f,p)=>p===d.data.length-1?c:l),u=d}new zb(a,{data:{labels:Object.keys(t.data),datasets:[u]},options:{animation:!1,responsive:!0,locale:Bd,plugins:{legend:{display:!1},tooltip:{enabled:!1}},elements:{bar:{backgroundColor:l,borderRadius:2,hoverBackgroundColor:c},line:{backgroundColor:c,borderColor:c,borderJoinStyle:"round",tension:.35},point:{radius:0}},scales:{x:{display:!1,grid:{display:!1},ticks:{display:!1}},y:{display:!1,grid:{display:!1},ticks:{display:!1}}},layout:{padding:{top:1.5}}}})}),{id:e,startDate:o,endDate:s}}}),sS=["id"],iS={class:"fr-grid-row justify-between"},aS={class:"text-xxs fr-m-0 text-mention-grey"},lS={class:"text-xxs fr-m-0 text-mention-grey"};function cS(t,e,n,r,o,s){return b(),k(K,null,[g("canvas",{id:t.id,width:"120",height:"30"},null,8,sS),g("div",iS,[g("p",aS,C(t.startDate),1),g("p",lS,C(t.endDate),1)])],64)}const uS=ke(oS,[["render",cS]]),dS=L({props:{author:{type:Object,required:!0},badge:Boolean}}),fS={class:"fr-text--sm fr-mb-0"},hS={key:0,class:"fr-badge fr-ml-3v"};function pS(t,e,n,r,o,s){return b(),k("span",fS,[U(C(t.author.first_name+" "+t.author.last_name)+" ",1),t.badge?(b(),k("span",hS,C(t.$t("Admin")),1)):I("",!0)])}const ul=ke(dS,[["render",pS]]),mS=L({emits:["click"],props:{primary:{type:Boolean,default:!1}}});function gS(t,e,n,r,o,s){return b(),k("button",{type:"button",class:ae(["fr-btn",{"fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 fr-icon-add-line fr-btn--icon-left":!t.primary}]),onClick:e[0]||(e[0]=ye(i=>t.$emit("click"),["prevent"]))},C(t.$t("Start a new discussion")),3)}const Uu=ke(mS,[["render",gS]]),vS={};function yS(t,e){const n=Je("i18n-t");return b(),j(n,{keypath:"Fields preceded by a star ({markup}) are required.",tag:"p",class:"fr-mt-0 fr-mb-1w fr-text--xs",scope:"global"},{markup:W(()=>[...e[0]||(e[0]=[g("span",{class:"required-field-star"},"*",-1)])]),_:1})}const Qd=ke(vS,[["render",yS]]),bS=L({expose:["displayForm"],components:{ThreadCreateButton:Uu,Author:ul,RequiredExplanation:Qd},props:{showCreateButton:{type:Boolean,default:!1},subjectId:{type:String,required:!0},subjectClass:{type:String,required:!0},onSubmit:{type:Function,required:!0}},setup(t){const e=T(!1),n=T(!1),r=T(""),o=T("");return{loading:e,showForm:n,title:r,comment:o,user:ei,displayForm:()=>{Wi(),n.value=!0},hideForm:()=>{n.value=!1},submit:()=>{e.value=!0;const l={title:r.value,comment:o.value,subject:{id:t.subjectId,class:t.subjectClass}};t.onSubmit(l).finally(()=>{var c;e.value=!1,n.value=!1,r.value=o.value="",(c=document.querySelector("[data-no-discussion]"))==null||c.remove()})}}}}),wS={class:"thread-create fr-mt-2w"},kS={key:1,class:"bg-contrast-grey"},CS={class:"fr-grid-row fr-grid-row--middle fr-py-2w fr-px-3w"},xS={class:"fr-col fr-h6 fr-mb-0"},SS={class:"thread-comment fr-pb-3w fr-px-3w"},_S={class:"fr-input-group"},TS={for:"thread-title",class:"fr-label required"},$S=["placeholder"],OS={class:"fr-input-group"},MS={for:"thread-comment",class:"fr-label required"},ES=["placeholder"],NS={class:"fr-grid-row justify-between fr-grid-row--middle"},DS={class:"text-mention-grey fr-text--sm fr-mb-0"},AS=["value"];function RS(t,e,n,r,o,s){const i=Je("ThreadCreateButton"),a=Je("RequiredExplanation"),l=Je("Author");return b(),k("div",wS,[t.showCreateButton&&!t.showForm?(b(),j(i,{key:0,onClick:t.displayForm},null,8,["onClick"])):I("",!0),t.showForm?(b(),k("div",kS,[g("div",CS,[g("div",xS,C(t.$t("New discussion")),1),g("div",null,[g("button",{class:"fr-btn--close fr-btn text-grey-500 fr-mr-0",onClick:e[0]||(e[0]=(...c)=>t.hideForm&&t.hideForm(...c))},C(t.$t("Close")),1)])]),g("div",SS,[g("form",{class:"form fr-p-0",onSubmit:e[3]||(e[3]=ye((...c)=>t.submit&&t.submit(...c),["prevent"]))},[M(a),g("div",_S,[g("label",TS,C(t.$t("Title")),1),nt(g("input",{class:"fr-input",type:"text",id:"thread-title","onUpdate:modelValue":e[1]||(e[1]=c=>t.title=c),placeholder:t.$t("Title"),required:!0},null,8,$S),[[Nr,t.title]])]),g("div",OS,[g("label",MS,C(t.$t("Message")),1),nt(g("textarea",{id:"thread-comment","onUpdate:modelValue":e[2]||(e[2]=c=>t.comment=c),placeholder:t.$t("Comment"),class:"fr-input",required:!0},null,8,ES),[[Nr,t.comment]])]),g("footer",NS,[g("span",DS,[U(C(t.$t("Reply as"))+" ",1),M(l,{author:t.user},null,8,["author"])]),g("input",{type:"submit",value:t.$t("Submit"),class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500"},null,8,AS)])],32)])])):I("",!0)])}const B1=ke(bS,[["render",RS]]);var IS=Object.defineProperty,PS=(t,e,n)=>e in t?IS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ya=(t,e,n)=>(PS(t,typeof e!="symbol"?e+"":e,n),n);const Fr={TOP_RIGHT:"top-right",TOP:"top",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",BOTTOM:"bottom",BOTTOM_LEFT:"bottom-left"};function Tp(t,e,n){let r=e;switch(t){case Fr.TOP:case Fr.TOP_RIGHT:case Fr.TOP_LEFT:r=e;break;case Fr.BOTTOM:case Fr.BOTTOM_RIGHT:case Fr.BOTTOM_LEFT:r=n;break}return r}const LS=t=>{typeof t.remove<"u"?t.remove():t.parentNode&&t.parentNode.removeChild(t)};class zS{constructor(e,n){ya(this,"startedAt"),ya(this,"callback"),ya(this,"delay"),ya(this,"timer"),this.startedAt=Date.now(),this.callback=e,this.delay=n,this.timer=setTimeout(e,n)}pause(){this.stop(),this.delay-=Date.now()-this.startedAt}resume(){this.stop(),this.startedAt=Date.now(),this.timer=setTimeout(this.callback,this.delay)}stop(){clearTimeout(this.timer)}}function BS(t){return{all:t=t||new Map,on:function(e,n){var r=t.get(e);r?r.push(n):t.set(e,[n])},off:function(e,n){var r=t.get(e);r&&(n?r.splice(r.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var r=t.get(e);r&&r.slice().map(function(o){o(n)}),(r=t.get("*"))&&r.slice().map(function(o){o(e,n)})}}}const Wu=BS(),FS=L({__name:"Toaster",props:{message:{},type:{default:"default"},position:{default:Fr.BOTTOM_RIGHT},maxToasts:{type:[Number,Boolean],default:!1},duration:{type:[Number,Boolean],default:4e3},dismissible:{type:Boolean,default:!0},queue:{type:Boolean,default:!1},props:{type:Boolean,default:!0},useDefaultCss:{type:Boolean,default:!0},onClose:{type:Function,default:()=>{}},onClick:{type:Function,default:()=>{}}},setup(t){const e=t;let n=null,r=null,o=null,s;const i=T(null),a=T(!1);Vd(()=>{l(),c(),u()}),De(()=>{f(),Wu.on("toast-clear",y)});function l(){n=document.querySelector(".c-toast-container--top"),r=document.querySelector(".c-toast-container--bottom"),!(n&&r)&&(n||(n=document.createElement("div"),n.className="c-toast-container c-toast-container--top"),r||(r=document.createElement("div"),r.className="c-toast-container c-toast-container--bottom"))}function c(){const S=e.useDefaultCss?"add":"remove";n&&n.classList[S]("v--default-css"),r&&r.classList[S]("v--default-css")}function u(){const S=document.body;n&&S.appendChild(n),r&&S.appendChild(r)}function d(){if(!e.queue&&e.maxToasts===!1)return!1;let S=0;n&&(S=n.childElementCount);let _=0;return r&&(_=r.childElementCount),e.maxToasts!==!1?e.maxToasts<=S+_:S>0||_>0}function f(){if(d()){s=window.setTimeout(f,250);return}const S=w();S&&i.value&&(S.insertAdjacentElement("afterbegin",i.value),a.value=!0,o=e.duration!==!1?new zS(y,e.duration):null)}function p(){e.onClick.apply(null,arguments),e.dismissible&&y()}function h(S){o&&(S?o.pause():o.resume())}function v(){o&&o.stop(),clearTimeout(s)}function y(){v(),a.value=!1,setTimeout(()=>{e.onClose.apply(null,arguments),i.value&&LS(i.value)},150)}function w(){return!n||!r?null:Tp(e.position,n,r)}const x=O(()=>Tp(e.position,{enter:"fadeInDown",leave:"fadeOut"},{enter:"fadeInUp",leave:"fadeOut"})),$=O(()=>e.dismissible?"button":"div");return Wg(()=>{Wu.off("toast-clear",y)}),(S,_)=>(b(),j(Yi,{"enter-active-class":x.value.enter,"leave-active-class":x.value.leave,ref_key:"el",ref:i},{default:W(()=>[nt((b(),j(to($.value),{class:ae(["c-toast","c-toast--".concat(S.type),"c-toast--".concat(S.position)]),onMouseover:_[0]||(_[0]=E=>h(!0)),onMouseleave:_[1]||(_[1]=E=>h(!1)),onClick:p,role:"alert"},{default:W(()=>[U(C(S.message),1)]),_:1},40,["class"])),[[fr,a.value]])]),_:1},8,["enter-active-class","leave-active-class"]))}}),VS=()=>typeof document<"u"?document.createElement("div"):null;function HS(t,{props:e}={}){let n=VS(),r=st(t,e);return n&&pp(r,n),{vNode:r,destroy:()=>{n&&pp(null,n),n=null,r=null},el:n}}function qS(t={}){return{show(e,n={}){let r={message:e,...n};return HS(FS,{props:{...t,...r}})},clear(){Wu.emit("toast-clear")},success(e,n={}){return n.type="success",this.show(e,n)},error(e,n={}){return n.type="error",this.show(e,n)},info(e,n={}){return n.type="info",this.show(e,n)},warning(e,n={}){return n.type="warning",this.show(e,n)}}}const US=qS({duration:!1,dismissible:!0});function sn(){return{toast:US}}const WS=L({components:{Author:ul,RequiredExplanation:Qd},emits:["close"],props:{onSubmit:{type:Function,required:!0}},setup(t){const{t:e}=be(),{toast:n}=sn(),r=T(!1),o=T("");return{comment:o,loading:r,submit:()=>{r.value=!0,t.onSubmit(o.value).catch(i=>{n.error(e("Error sending response"))}).finally(()=>{r.value=!1,o.value=""})},user:ei}}}),jS={class:"thread-reply"},KS={class:"fr-grid-row fr-grid-row--middle fr-mb-3v"},YS={class:"fr-col fr-text--bold fr-mb-0"},GS={class:"fr-col-auto"},JS={class:"fr-input-group"},XS={class:"fr-label required",for:"textarea"},ZS={class:"fr-grid-row justify-between fr-grid-row--middle"},QS={class:"text-mention-grey fr-text--sm fr-m-0"},e5=["value"];function t5(t,e,n,r,o,s){const i=Je("RequiredExplanation"),a=Je("Author");return b(),k("div",jS,[g("div",KS,[g("h4",YS,C(t.$t("Reply to the discussion")),1),g("div",GS,[g("button",{class:"fr-btn--close fr-btn text-grey-500 fr-mr-0",onClick:e[0]||(e[0]=l=>t.$emit("close"))},C(t.$t("Close")),1)])]),g("form",{class:"form fr-p-0",onSubmit:e[2]||(e[2]=ye((...l)=>t.submit&&t.submit(...l),["prevent"]))},[M(i),g("div",JS,[g("label",XS,C(t.$t("Comment")),1),nt(g("textarea",{"onUpdate:modelValue":e[1]||(e[1]=l=>t.comment=l),required:"",class:"fr-input",id:"textarea"},null,512),[[Nr,t.comment]])]),g("footer",ZS,[g("p",QS,[U(C(t.$t("Reply as"))+" ",1),M(a,{author:t.user},null,8,["author"])]),g("input",{type:"submit",value:t.$t("Submit"),class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500"},null,8,e5)])],32)])}const n5=ke(WS,[["render",t5]]),$p=L({__name:"MarkAsNoSpam",props:{url:{},spam:{}},setup(t){const e=t,n=()=>Qe.delete(e.url).then(()=>{window.location.reload()}),r=O(()=>e.spam&&e.spam.status&&e.spam.status==="potential_spam"&&ei&&ei.roles&&ei.roles.includes("admin"));return(o,s)=>r.value?(b(),k("button",{key:0,class:"fr-btn fr-btn--sm fr-btn--icon-right fr-icon-feedback-fill",onClick:n},C(o.$t("Mark as no spam")),1)):I("",!0)}}),r5=["id"],o5={class:"fr-grid-row fr-grid-row--middle justify-between fr-py-2w fr-px-3w no-wrap wrap-md"},s5={key:0,class:"fr-col-auto text-default-warning fr-text--bold fr-pr-2w fr-my-0"},i5={class:"fr-col fr-mx-3v fr-mx-md-0 fr-h6 fr-mb-0"},a5={class:"fr-col-auto text-align-right"},l5=["id","data-clipboard-text"],c5={class:"fr-grid-row fr-grid-row--gutters"},u5={class:"fr-col-auto"},d5={class:"fr-col"},f5={class:"fr-my-0"},h5={class:"fr-text--sm text-mention-grey fr-m-0"},p5={class:"white-space-pre-wrap overflow-wrap-anywhere"},m5={class:"fr-my-0"},g5={key:0,class:"fr-py-2w fr-px-3w"},v5={class:"fr-py-2w fr-px-3w"},y5={key:1,class:"text-grey-380"},b5={class:"fr-px-1v"},Op=L({__name:"Thread",props:{thread:{}},setup(t){const e=t,{t:n}=be(),r=T(!1),o=T([...e.thread.discussion]),s=T(!!e.thread.closed),i=O(()=>"discussions/"+e.thread.id),a=O(()=>{const u="#/"+i.value;return window.location.origin+window.location.pathname+u}),l=()=>{Wi(),r.value=!0},c=u=>Qe.post("/discussions/"+e.thread.id+"/",{comment:u}).then(d=>d.data).then(d=>{o.value=d.discussion,r.value=!1});return(u,d)=>(b(),k("div",{class:"bg-contrast-grey fr-mt-2w",id:i.value},[g("header",o5,[t.thread.closed?(b(),k("p",s5,[g("span",null,C(m(n)("Discussion closed")),1)])):I("",!0),g("h3",i5,C(t.thread.title),1),g("div",a5,[M($p,{url:"discussions/".concat(t.thread.id,"/spam"),spam:t.thread.spam,class:"fr-mr-3v"},null,8,["url","spam"]),g("button",{id:t.thread.id+"-copy","data-clipboard-text":a.value,class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 fr-btn--icon-right fr-icon-links-fill"},C(m(n)("Copy discussion permalink")),9,l5)])]),g("div",null,[M(mw,{name:"list"},{default:W(()=>[s.value?I("",!0):(b(!0),k(K,{key:0},Ne(o.value,(f,p)=>(b(),k("article",{class:"thread-comment fr-py-3w fr-px-3w fr-pr-5w",key:"comment-".concat(t.thread.id,"-").concat(p)},[g("div",c5,[g("div",u5,[M(m(Yg),{user:f.posted_by},null,8,["user"])]),g("div",d5,[g("p",f5,[M(ul,{author:f.posted_by,badge:!1},null,8,["author"])]),g("p",h5,C(m(Er)(f.posted_on)),1),M(m(A1),{class:"fr-mt-3v"},{default:W(()=>[g("div",p5,[g("p",m5,C(f.content),1)])]),_:2},1024),M($p,{url:"discussions/".concat(t.thread.id,"/comments/").concat(p,"/spam"),spam:f.spam,class:"fr-mt-3v"},null,8,["url","spam"])])])]))),128))]),_:1}),s.value?(b(),k("div",g5,[g("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500",onClick:d[0]||(d[0]=ye(f=>s.value=!1,["prevent"]))},C(m(n)("See {n} messages",o.value.length)),1)])):I("",!0)]),g("footer",v5,[!t.thread.closed&&!m(Vl)?(b(),k(K,{key:0},[r.value?(b(),j(n5,{key:1,subjectId:t.thread.id,onSubmit:c,onClose:d[1]||(d[1]=f=>r.value=!1)},null,8,["subjectId"])):(b(),k("button",{key:0,class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500 fr-btn--icon-right fr-icon-arrow-right-s-line",onClick:ye(l,["stop"])},C(m(n)("Reply")),1))],64)):I("",!0),t.thread.closed?(b(),k("div",y5,[U(C(m(n)("The discussion was closed by"))+" ",1),g("strong",b5,[M(ul,{author:t.thread.closed_by},null,8,["author"])]),U(" "+C(m(n)("on"))+" "+C(m(Er)(t.thread.closed)),1)])):I("",!0)])],8,r5))}}),w5={components:{ContentLoader:Gi}};function k5(t,e,n,r,o,s){const i=Je("ContentLoader");return b(),j(i,{width:280,height:180,speed:2,primaryColor:"#7c7c7c",secondaryColor:"#2d2d2d"},{default:W(()=>[...e[0]||(e[0]=[g("rect",{x:"104",y:"41",rx:"3",ry:"3",width:"162",height:"10"},null,-1),g("rect",{x:"105",y:"63",rx:"3",ry:"3",width:"139",height:"5"},null,-1),g("rect",{x:"26",y:"99",rx:"5",ry:"5",width:"60",height:"60"},null,-1),g("rect",{x:"104",y:"113",rx:"3",ry:"3",width:"162",height:"10"},null,-1),g("rect",{x:"105",y:"135",rx:"3",ry:"3",width:"139",height:"5"},null,-1),g("rect",{x:"26",y:"24",rx:"5",ry:"5",width:"60",height:"60"},null,-1)])]),_:1})}const C5=ke(w5,[["render",k5]]);function x5(t){const e=T(null),n=()=>{const o=window.location.hash;for(const s of t){let[i,a,l]=s.exec(o)||[];if(a)return e.value=a}e.value=null},r=()=>{history.pushState(null,""," "),window.dispatchEvent(new HashChangeEvent("hashchange"))};return De(()=>{n(),window.addEventListener("hashchange",()=>n())}),{id:ql(e),resetHash:r}}const S5={key:0,class:"fr-grid-row fr-grid-row--middle"},_5={class:"fr-col"},T5={id:"community-discussions",class:"subtitle subtitle--uppercase"},$5={key:0,class:"fr-col-12 fr-col-md-6 fr-grid-row fr-grid-row--gutters fr-grid-row--middle fr-grid-row--right"},O5={class:"fr-col-auto"},M5=["aria-label"],E5=["value","selected"],N5={class:"fr-col-auto"},D5={key:1,class:"fr-grid-row fr-grid-row--center"},A5={key:0},R5={class:"fr-grid-row fr-grid-row--middle justify-between"},I5={class:"text-decoration-underline"},P5={key:1},L5={class:"fr-mb-5v"},Hc=5,z5=L({__name:"Threads",props:{subjectId:{},subjectClass:{}},setup(t,{expose:e}){const n=t,{t:r}=be(),{toast:o}=sn(),s=T([]),i=/discussions\/([a-f0-9]{24})-?([0-9]+)?$/i,a=/discussion-([a-f0-9]{24})-?([0-9]+)?$/i,{id:l,resetHash:c}=x5([i,a]),u=T(null),d=T(1),f=T(0),p=T(!0),h=[{name:r("Discussion creation"),key:"-created"},{name:r("Last reply"),key:"-discussion.posted_on"}],v=T(h[0]),y=T(null),w=()=>{x(l.value)},x=Y=>{if(Y)return p.value=!0,setTimeout(()=>{y.value&&y.value.scrollIntoView({behavior:"smooth"})},500),Qe.get("/discussions/"+Y).then(re=>re.data).then(re=>{re&&(u.value=re,f.value=1)}).catch(()=>{o.error(r("An error occurred while fetching the discussion ")+Y),$(1)}).finally(()=>{p.value=!1})},$=(Y=1,re=!1)=>(Y=Ke(Y),p.value=!0,re&&setTimeout(()=>{y.value&&y.value.scrollIntoView({behavior:"smooth"})},500),Qe.get("/discussions/",{params:{page:Y,for:n.subjectId,sort:v.value.key,page_size:Hc}}).then(ce=>ce.data).then(ce=>{ce.data&&(s.value=ce.data,f.value=ce.total)}).catch(()=>{o.error(r("An error occurred while fetching discussions")),s.value=[]}).finally(()=>{p.value=!1})),S=T(null),_=()=>{E(),S.value&&S.value.$el.scrollIntoView()},E=()=>{S.value&&S.value.displayForm()},D=Y=>Qe.post("/discussions/",Y).then(()=>{d.value=1,$(1,!0)}).catch(re=>o.error(r("An error occurred while creating the discussion "),re)),N=(Y,re=!0)=>{d.value=Y,$(Y,re)},H=Y=>{v.value=Y,$(d)};return De(()=>{$()}),bt(()=>{l.value&&w()}),He(f,Y=>{const re=document.querySelectorAll(".discussions-count");re&&re.forEach(ce=>ce.innerHTML=Y.toFixed(0))}),e({startThread:_}),(Y,re)=>(b(),k("section",{class:"discussions-wrapper",ref_key:"top",ref:y},[f.value?(b(),k("div",S5,[g("div",_5,[g("h2",T5,C(m(r)("{n} discussions",f.value)),1)]),m(l)?I("",!0):(b(),k("div",$5,[g("div",O5,[nt(g("select",{name:"sortBy",id:"sortBy","aria-label":m(r)("Sort discussions by"),onChange:re[0]||(re[0]=ce=>H(v.value)),"onUpdate:modelValue":re[1]||(re[1]=ce=>v.value=ce),class:"fr-select fr-select--no-border fr-select--blue"},[(b(),k(K,null,Ne(h,ce=>g("option",{value:ce,selected:ce===v.value},C(ce.name),9,E5)),64))],40,M5),[[Ul,v.value]])]),g("div",N5,[M(Uu,{onClick:E})])]))])):(b(),k("div",D5,[M(Uu,{class:"fr-col--bottom",primary:!0,onClick:E})])),M(Yi,{mode:"out-in"},{default:W(()=>[p.value?(b(),j(C5,{key:0,class:"fr-mt-2w"})):(b(),k(K,{key:1},[m(l)?(b(),k("div",A5,[M(m(cl),{type:"secondary",color:"success",class:"fr-mt-2w","data-cy":"threadFromURL"},{default:W(()=>[g("div",R5,[U(C(m(r)("You are seeing a specific discussion about this dataset."))+" ",1),g("button",{class:"fr-btn--close fr-btn fr-mr-0",onClick:re[2]||(re[2]=ye((...ce)=>m(c)&&m(c)(...ce),["prevent"]))},C(m(r)("Close")),1)])]),_:1}),u.value?(b(),j(Op,{key:0,thread:u.value},null,8,["thread"])):(b(),j(m(cl),{key:1,type:"secondary",color:"warning",class:"fr-mt-2w"},{default:W(()=>[U(C(Y.$t("This discussion doesn't exist or was deleted.")),1)]),_:1})),g("button",{class:"nav-link nav-link--no-icon text-decoration-none fr-link fr-mt-9v fr-link--icon-left fr-icon-arrow-right-s-line",onClick:re[3]||(re[3]=ye((...ce)=>m(c)&&m(c)(...ce),["prevent"]))},[g("span",I5,C(m(r)("See all discussions about this dataset")),1)])])):(b(),k("div",P5,[m(Vl)?I("",!0):(b(),j(B1,{key:0,ref_key:"createThread",ref:S,onSubmit:D,subjectId:t.subjectId,subjectClass:t.subjectClass},null,8,["subjectId","subjectClass"])),g("ul",L5,[(b(!0),k(K,null,Ne(s.value,ce=>(b(),k("li",null,[M(Op,{thread:ce},null,8,["thread"])]))),256))]),f.value>Hc?(b(),j(m(_o),{key:1,page:d.value,"page-size":Hc,"total-results":f.value,onChange:N},null,8,["page","total-results"])):I("",!0)]))],64))]),_:1})],512))}}),B5=["href"],F5={class:"fr-grid-row fr-grid-row--middle"},V5=L({__name:"MenuSearchOption",props:{icon:{},query:{},link:{},type:{}},setup(t){return(e,n)=>{const r=Je("i18n-t");return b(),k("a",{class:"fr-nav__link unstyled",href:t.link},[g("div",F5,[g("span",{class:ae(["fr-icon--sm align-[-1px] fr-mr-1w",t.icon]),"aria-hidden":"true"},null,2),t.query?(b(),j(r,{key:0,keypath:"Search {query} in {type}",class:"fr-col",tag:"div",scope:"global"},{query:W(()=>[g("em",null,C(t.query),1)]),type:W(()=>[g("strong",null,C(t.type),1)]),_:1})):(b(),j(r,{key:1,keypath:"Start typing to search in X",class:"fr-col",tag:"div",scope:"global"},{type:W(()=>[g("strong",null,C(t.type),1)]),_:1})),n[0]||(n[0]=g("div",{"aria-hidden":"true",class:"fr-col-auto"},[g("span",{class:"fr-icon-arrow-right-s-line fr-icon--sm","aria-hidden":"true"})],-1))])],8,B5)}}});function F1(t){const e=O(()=>"".concat(Bb,"?q=").concat(Ke(t))),n=O(()=>"".concat(Fb,"?q=").concat(Ke(t))),r=O(()=>"".concat(Vb,"?q=").concat(Ke(t))),o=O(()=>"".concat(Hb,"?q=").concat(Ke(t)));return{dataserviceUrl:n,datasetUrl:e,organizationUrl:r,reuseUrl:o}}function H5(){const t=xo("collapse"),e=T(!1),n=()=>e.value=!0,r=()=>e.value=!1,o=()=>e.value=!e.value;let s=null;const i=(d,f,p)=>{const h=Ke(d),v=Ke(f),y=Ke(p);s=c(h,v,y),document.body.addEventListener("pointerup",s,!0)},a=()=>{s&&document.body.removeEventListener("pointerup",s,!0)},l=(d,f)=>d?!d.contains(f):!0,c=(d,f,p)=>h=>{const v=h.target;l(d,v)&&l(f,v)&&l(p,v)&&r()};return{expanded:e,uid:t,show:n,hide:r,toggle:o,registerBackgroundEvent:i,removeBackgroundEvent:a,handleKeyPressForCollapse:d=>{switch(d.key){case"Alt":case"Control":case"Shift":case"CapsLock":break;case"Escape":case"Tab":r();break;default:n()}}}}function q5(t){const e=T(),n=O(()=>Ke(t).find(f=>f.id===e.value)),r=f=>e.value===f,o=f=>{if(f===void 0)return i(0);e.value=f},s=()=>{e.value=void 0},i=f=>{let p=Ke(t);p[f]&&o(p[f].id)},a=()=>{let f=0;e.value&&(f=Ke(t).findIndex(p=>p.id===e.value),f++,f===Ke(t).length&&(f=0)),i(f)},l=()=>{const f=Ke(t).length-1;let p=f;e.value&&(p=Ke(t).findIndex(h=>h.id===e.value),p--,p<0&&(p=f)),i(p)};return{select:o,selected:e,selectedOption:n,isSelected:r,focusOut:s,handleKeyPressForActiveDescendant:(f,p=!1)=>{switch(f.key){case"ArrowDown":!p&&!f.altKey&&a();break;case"ArrowUp":l();break;case"ArrowLeft":case"ArrowRight":case"Home":case"End":case"Escape":s();break}},ALREADY_MOVED_DOWN:!0,NOT_MOVED_YET:!1}}function U5(t,e){const n=T(null),r=T(null),o=T(null),{expanded:s,handleKeyPressForCollapse:i,hide:a,registerBackgroundEvent:l,removeBackgroundEvent:c,show:u,uid:d}=H5(),{focusOut:f,handleKeyPressForActiveDescendant:p,isSelected:h,select:v,selected:y,selectedOption:w,NOT_MOVED_YET:x,ALREADY_MOVED_DOWN:$}=q5(t);function S(){Ke(e)&&(u(),v(y.value))}function _(){var H;s.value?E():((H=n.value)==null||H.focus(),S())}function E(){w.value&&(window.location.href=w.value.link)}function D(H){S();let Y=x;s.value||(Y=$),i(H),p(H,Y)}function N(){f(),a()}return De(()=>{l(n,r,o)}),fn(()=>{c()}),{buttonRef:o,expanded:s,focusOut:f,handleFocusOut:N,handleKeyDown:D,handleKeyPressForActiveDescendant:p,handleKeyPressForCollapse:i,hide:a,inputRef:n,isSelected:h,listRef:r,registerBackgroundEvent:l,removeBackgroundEvent:c,searchSelectedOption:E,select:v,selected:y,show:u,showAndFocus:_,showAndSelectIfQuery:S,uid:d,NOT_MOVED_YET:x,ALREADY_MOVED_DOWN:$}}const W5=["id"],j5=["for","id"],K5=["placeholder","aria-controls","aria-expanded","id","aria-activedescendant"],Y5=["aria-controls","aria-expanded"],G5=["id","aria-labelledby"],J5={class:"fr-menu__list",role:"listbox"},X5=["id","aria-selected"],Z5=L({__name:"MenuSearch",setup(t){const{t:e}=be(),n=T(""),{datasetUrl:r,dataserviceUrl:o,reuseUrl:s,organizationUrl:i}=F1(n),{id:a}=$s("search"),l=O(()=>"".concat(a,"-input")),c=O(()=>"".concat(a,"-label")),u=T([{id:"dataset-option",icon:"fr-icon-database-line",type:e("datasets"),link:r},{id:"dataservice-option",icon:"fr-icon-code-s-slash-line",type:e("dataservices"),link:o},{id:"reuse-option",icon:"fr-icon-line-chart-line",type:e("reuses"),link:s},{id:"organization-option",icon:"fr-icon-government-line",type:e("organizations"),link:i}]),{buttonRef:d,expanded:f,handleFocusOut:p,handleKeyDown:h,inputRef:v,isSelected:y,listRef:w,searchSelectedOption:x,selected:$,showAndFocus:S,showAndSelectIfQuery:_,uid:E}=U5(u,n);return(D,N)=>(b(),k("div",{id:m(a),class:"fr-col fr-search-bar wrap",role:"search"},[g("label",{class:"fr-label",for:l.value,id:c.value},C(m(e)("Search for data")),9,j5),nt(g("input",{class:"fr-input fr-col",placeholder:m(e)("Search"),ref_key:"inputRef",ref:v,autocomplete:"off",role:"combobox","aria-autocomplete":"list","aria-controls":m(E),"aria-expanded":m(f),id:l.value,"data-cy":"search-input","aria-activedescendant":m($),name:"q","onUpdate:modelValue":N[0]||(N[0]=H=>n.value=H),onClickCapture:N[1]||(N[1]=ye((...H)=>m(_)&&m(_)(...H),["stop"])),onKeydown:N[2]||(N[2]=(...H)=>m(h)&&m(h)(...H)),onKeypress:N[3]||(N[3]=Hd(ye((...H)=>m(x)&&m(x)(...H),["prevent"]),["enter"])),onBlur:N[4]||(N[4]=(...H)=>m(p)&&m(p)(...H))},null,40,K5),[[Nr,n.value]]),g("button",{type:"button",ref_key:"buttonRef",ref:d,class:"fr-btn",tabindex:"-1","aria-controls":m(E),"aria-expanded":m(f),onClickCapture:N[5]||(N[5]=ye((...H)=>m(S)&&m(S)(...H),["prevent","stop"]))},C(m(e)("Search")),41,Y5),g("div",{class:"fr-menu fr-collapse autocomplete",id:m(E),ref_key:"listRef",ref:w,role:"listbox","aria-labelledby":c.value,onMousedown:N[6]||(N[6]=ye(()=>{},["prevent"]))},[g("ul",J5,[(b(!0),k(K,null,Ne(u.value,H=>(b(),k("li",{key:H.id,id:H.id,role:"option","aria-selected":m(y)(H.id)},[M(V5,{icon:H.icon,query:n.value,type:H.type,link:H.link},null,8,["icon","query","type","link"])],8,X5))),128))])],40,G5)],8,W5))}}),Q5=L({emits:["change"],props:{value:{type:String,required:!0},placeholder:{type:String,required:!0}},setup(t,{emit:e}){const{id:n}=$s("search-input"),r=T(t.value),o=T(null),s=()=>{var l;(l=o.value)==null||l.focus({preventScroll:!0})},i=()=>{r.value===""&&e("change",r.value)},a=l=>{const c=l.target;e("change",c.value)};return De(async()=>{await mi(),s()}),bt(()=>{r.value=t.value}),{id:n,input:o,onDelete:i,onInput:a,queryString:r}}}),e_={class:"fr-search-bar fr-search-bar--lg w-100"},t_=["for"],n_=["id","value","aria-label","placeholder"],r_={class:"fr-btn",type:"submit"};function o_(t,e,n,r,o,s){return b(),k("section",e_,[g("label",{class:"fr-label",for:t.id},C(t.$t("Search")),9,t_),g("input",{id:t.id,type:"search",name:"q",value:t.queryString,onInput:e[0]||(e[0]=(...i)=>t.onInput&&t.onInput(...i)),onKeydown:e[1]||(e[1]=Hd((...i)=>t.onDelete&&t.onDelete(...i),["delete"])),ref:"input",class:"fr-input","aria-label":t.placeholder||t.$t("Search..."),placeholder:t.placeholder||t.$t("Search..."),"data-cy":"search-input","data-testid":"search-input"},null,40,n_),g("button",r_,C(t.$t("Search")),1)])}const s_=ke(Q5,[["render",o_]]),V1=L({__name:"card-lg",props:{dataset:{},style:{type:[Boolean,null,String,Object,Array]},showDescription:{type:Boolean,default:!0}},setup(t){return(e,n)=>{var r;return b(),j(m(f3),{dataset:t.dataset,style:Ts(t.style),showDescription:t.showDescription,"dataset-url":t.dataset.page,"organization-url":(r=t.dataset.organization)==null?void 0:r.page},null,8,["dataset","style","showDescription","dataset-url","organization-url"])}}}),i_=L({components:{ContentLoader:Gi},setup(t){const e=qr.resources_default_page_size,n=88;return{pageSize:e,height:n,getPosition:(o,s)=>(o-1)*n+s}}}),a_=["y"],l_=["y"],c_=["y"],u_=["y"],d_=["y"];function f_(t,e,n,r,o,s){const i=Je("ContentLoader");return b(),j(i,{width:1200,height:t.height*t.pageSize,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},{default:W(()=>[(b(!0),k(K,null,Ne(t.pageSize,a=>(b(),k(K,null,[g("rect",{x:"20",y:t.getPosition(a,24),rx:"4",ry:"4",width:"16",height:"16"},null,8,a_),g("rect",{x:"52",y:t.getPosition(a,20),rx:"4",ry:"4",width:"536",height:"22"},null,8,l_),g("rect",{x:"52",y:t.getPosition(a,52),rx:"4",ry:"4",width:"374",height:"16"},null,8,c_),g("rect",{x:"1052",y:t.getPosition(a,30),rx:"4",ry:"4",width:"80",height:"20"},null,8,u_),g("rect",{x:"1154",y:t.getPosition(a,20),rx:"20",ry:"20",width:"40",height:"40"},null,8,d_)],64))),256))]),_:1},8,["height"])}const ef=ke(i_,[["render",f_]]),h_={help:"Utilisez la tabulation (ou les touches flches) pour naviguer dans la liste des suggestions",placeholder:"Rechercher dans la liste",noResult:"Aucun rsultat",results:"{x} suggestion(s) disponibles",deleteItem:"Supprimer {t}",delete:"Supprimer",clear:"Vider"},p_=Element.prototype.matches;let Ho=Element.prototype.closest;Ho||(Ho=function(t){var e=this;do{if(p_.call(e,t))return e;e=e.parentElement||e.parentNode}while(e!==null&&e.nodeType===1);return null});const m_=!0,g_=!1;function Fs(t){return Array.from(t).map(e=>e.cloneNode(m_))}function v_(t){return t.parentNode.tagName==="OPTGROUP"&&(t.dataset.group=t.parentNode.label),t}class y_{constructor(e,n){var i;var r;this.el=e,this.label=document.querySelector("label[for=".concat(e.id,"]")),this.id=e.id,this.open=!1,this.multiple=this.el.multiple,this.search="",this.suggestions=[],this.focusIndex=null;const o=Object.assign({},n),s=Object.assign({},h_,o.text);if(delete o.text,this._defaultSearch=this._defaultSearch.bind(this),this._options=Object.assign({text:s,showSelected:!0,fillSuggestions:this._defaultSearch,useLabelAsButton:!1,clearable:!1},o),this._handleFocus=this._handleFocus.bind(this),this._handleInput=this._handleInput.bind(this),this._handleKeyboard=this._handleKeyboard.bind(this),this._handleOpener=this._handleOpener.bind(this),this._handleClear=this._handleClear.bind(this),this._handleReset=this._handleReset.bind(this),this._handleSuggestionClick=this._handleSuggestionClick.bind(this),this._positionCursor=this._positionCursor.bind(this),this._removeOption=this._removeOption.bind(this),this.setText=this.setText.bind(this),this._setButtonText=this._setButtonText.bind(this),!this.multiple){const a=Array.from(this.el.options).some(l=>l.selected);if(this._options.useLabelAsButton&&!a){const l=document.createElement("option");l.innerText=(i=(r=this.label)==null?void 0:r.innerText)!=null?i:"",l.setAttribute("value",""),l.setAttribute("selected","selected"),l.setAttribute("disabled","disabled"),l.setAttribute("hidden","hidden"),this.el.options.add(l,0)}}this.originalOptions=Fs(Array.from(this.el.options).map(v_)),this.updatedOriginalOptions=Fs(this.originalOptions),this.currentOptions=Fs(this.originalOptions),this._disable(),this.button=this._createButton(),this._setButtonText(),this.clearButton=this._createClearButton(),this.liveZone=this._createLiveZone(),this.overlay=this._createOverlay(),this.wrap=this._wrap(),this.multiple&&this._options.showSelected&&(this.selectedList=this._createSelectedList(),this._updateSelectedList(),this.selectedList.addEventListener("click",this._removeOption)),this.button.addEventListener("click",this._handleOpener),this.clearButton.addEventListener("click",this._handleClear),this.wrap.addEventListener("keydown",this._handleKeyboard),document.addEventListener("blur",this._handleFocus,!0),this.el.form&&this.el.form.addEventListener("reset",this._handleReset)}setText(e){Object.assign(this._options.text,e)}selectOption(e,n=!0){const r=this.currentOptions.findIndex(s=>s.value===e);if(r===-1)return;const o=!this.multiple;this._toggleSelection(r,o,n)}selectOptionSilently(e){this.selectOption(e,g_)}_createButton(){var e;const n=document.createElement("button");n.setAttribute("type","button"),n.setAttribute("aria-expanded",this.open?"true":"false"),n.className="select-a11y-button";const r=document.createElement("span");return r.className="select-a11y-button__text",this.label&&!this.label.id&&(this.label.id="".concat(this.el.id,"-label")),n.setAttribute("id",this.el.id+"-button"),n.setAttribute("aria-labelledby",((e=this.label)==null?void 0:e.id)+" "+n.id),r.innerHTML="&nbsp;",n.appendChild(r),n.insertAdjacentHTML("beforeend",'<span class="select-a11y-button__icon" aria-hidden="true"></span>'),n}_createClearButton(){const e=document.createElement("button");return e.setAttribute("type","button"),e.setAttribute("aria-label",this._options.text.clear),e.className="select-a11y-button__clear",e}_createLiveZone(){const e=document.createElement("p");return e.setAttribute("aria-live","polite"),e.classList.add("sr-only"),e}_createOverlay(){const e=document.createElement("div");e.classList.add("select-a11y__overlay");const n=document.createElement("div");return n.classList.add("select-a11y-suggestions"),n.id="a11y-".concat(this.id,"-suggestions"),e.innerHTML='\n      <p id="a11y-usage-'.concat(this.id,'-js" class="sr-only">').concat(this._options.text.help,'</p>\n      <label for="a11y-').concat(this.id,'-js" class="sr-only">').concat(this._options.text.placeholder,'</label>\n      <input type="search" id="a11y-').concat(this.id,'-js" class="select-a11y__input ').concat(this.el.className,'" autocomplete="off" autocapitalize="off" spellcheck="false" placeholder="').concat(this._options.text.placeholder,'" aria-describedby="a11y-usage-').concat(this.id,'-js">\n    '),e.appendChild(n),this.list=n,this.list.addEventListener("click",this._handleSuggestionClick),this.input=e.querySelector("input"),this.input&&(this.input.addEventListener("input",this._handleInput),this.input.addEventListener("focus",this._positionCursor,!0)),e}_createSelectedList(){const e=document.createElement("ul");return e.className="select-a11y__selected-list",e}_disable(){this.el.setAttribute("tabindex","-1")}_mapToSuggestion(e){return{hidden:e.hidden,disabled:e.disabled,selected:e.hasAttribute("selected"),label:e.label,value:e.value,image:e.dataset.image,alt:e.dataset.alt,helper:e.dataset.helper,description:e.dataset.description,showIcon:e.dataset.showIcon,group:e.dataset.group,link:e.dataset.link,linkText:e.dataset.linkText}}_mapToOption(e){const n=document.createElement("option");return n.label=e.label,n.value=e.value,e.hidden&&n.setAttribute("hidden","hidden"),e.disabled&&n.setAttribute("disabled","disabled"),e.selected&&n.setAttribute("selected","selected"),e.image&&(n.dataset.image=e.image),e.alt&&(n.dataset.alt=e.alt),e.description&&(n.dataset.description=e.description),e.helper&&(n.dataset.helper=e.helper),e.showIcon&&(n.dataset.showIcon=e.showIcon),e.group&&(n.dataset.group=e.group),e.link&&(n.dataset.link=e.link),e.linkText&&(n.dataset.linkText=e.linkText),n}_defaultSearch(e,n){const r=n.filter(o=>(o.label||o.value).toLocaleLowerCase().indexOf(e)!==-1).map(this._mapToSuggestion);return Promise.resolve(r)}async _fillSuggestions(){const e=this.search.toLowerCase(),n=await this._options.fillSuggestions(e,this.updatedOriginalOptions);this.currentOptions=n.map(this._mapToOption),this.el.replaceChildren(...this._fillSelect(this.currentOptions));const r=n.map((i,a)=>{const l=document.createElement("div");l.setAttribute("role","option"),l.setAttribute("tabindex","0"),l.setAttribute("data-index",a.toString()),i.hidden&&l.setAttribute("data-hidden","hidden"),i.disabled&&l.setAttribute("data-disabled","disabled"),l.classList.add("select-a11y-suggestion");const c=document.createElement("div");c.classList.add("select-a11y-column"),l.appendChild(c);const u=document.createElement("div");if(u.classList.add("select-a11y-suggestion__label"),u.innerText=i.label||i.value,c.appendChild(u),i.selected&&l.setAttribute("aria-selected","true"),i.description){const d=document.createElement("div");d.classList.add("select-a11y-suggestion__description"),i.showIcon&&d.setAttribute("data-show-icon","true"),d.innerText=i.description,c.appendChild(d)}if(i.helper){const d=document.createElement("div");d.classList.add("column--right"),l.appendChild(d);const f=document.createElement("code");f.classList.add("select-a11y-suggestion__helper"),f.innerText=i.helper,d.appendChild(f)}else if(i.link){const d=document.createElement("div");d.classList.add("column--right"),l.appendChild(d);const f=document.createElement("a");f.target="_blank",f.innerText=i.linkText,f.href=i.link,d.appendChild(f)}if(i.image){const d=document.createElement("img");d.setAttribute("src",i.image),d.setAttribute("alt",i.alt?i.alt:""),d.classList.add("select-a11y-suggestion__image"),l.prepend(d)}return{suggestionElement:l,group:i.group}}).filter(i=>!i.suggestionElement.dataset.disabled&&!i.suggestionElement.dataset.hidden),o=[],s={};if(r.forEach(({suggestionElement:i,group:a})=>{if(a){if(!s[a]){const l=document.createElement("div");l.setAttribute("role","group"),s[a]=l;const c=document.createElement("div");c.setAttribute("role","presentation"),c.innerHTML=a,l.appendChild(c)}s[a].appendChild(i)}else o.push(i)}),this.suggestions=r.map(({suggestionElement:i})=>i),this.list)if(!this.suggestions.length)this.list.innerHTML='<p class="select-a11y__no-suggestion">'.concat(this._options.text.noResult,"</p>");else{const i=document.createElement("div");i.setAttribute("role","listbox"),this.multiple&&i.setAttribute("aria-multiselectable","true"),Object.values(o).forEach(a=>{i.appendChild(a)}),Object.values(s).forEach(a=>{i.appendChild(a)}),this.list.innerHTML="",this.list.appendChild(i)}return this._setLiveZone(),n}_fillSelect(e){const n=[];return e.forEach(r=>{const o=r.dataset.group;if(o){if(!n.find(s=>s.tagName==="OPTGROUP"&&s.label===o)){const s=document.createElement("optgroup");s.label=o,n.push(s)}n[n.length-1].appendChild(r)}else n.push(r)}),n}_handleOpener(e){this._toggleOverlay()}_handleFocus(){this.open&&(clearTimeout(this._focusTimeout),this._focusTimeout=setTimeout(()=>{if(!this.overlay.contains(document.activeElement)&&this.button!==document.activeElement)this._toggleOverlay(!1,document.activeElement===document.body);else if(document.activeElement===this.input)this.focusIndex=null;else{const e=this.suggestions.indexOf(document.activeElement);e!==-1&&(this.focusIndex=e)}},10))}_handleClear(){this.el.value="",this._handleReset()}_handleReset(){clearTimeout(this._resetTimeout),this._resetTimeout=setTimeout(async()=>{this.search="",this.updatedOriginalOptions=Fs(this.originalOptions),this.currentOptions=Fs(this.originalOptions),this.el.dispatchEvent(new Event("reset")),await this._fillSuggestions(),this.el.dispatchEvent(new Event("change")),this._setButtonText(),this.multiple&&this._options.showSelected&&this._updateSelectedList()},10)}_handleSuggestionClick(e){const n=Ho.call(e.target,'[role="option"]');if(!n)return;const r=parseInt(n.getAttribute("data-index"),10),o=!(this.multiple&&e.metaKey);this._toggleSelection(r,o)}_handleInput(){var r;var e,n;this.search!==((e=this.input)==null?void 0:e.value)&&(this.search=(r=(n=this.input)==null?void 0:n.value)!=null?r:"",this._fillSuggestions())}_handleKeyboard(e){const n=Ho.call(e.target,'[role="option"]'),r=Ho.call(e.target,"input");if(e.keyCode===27){this._toggleOverlay();return}if(r&&e.keyCode===13){e.preventDefault();return}if(e.keyCode===40){e.preventDefault(),this._moveIndex(1);return}if(n){if(e.keyCode===39){e.preventDefault(),this._moveIndex(1);return}if(e.keyCode===37||e.keyCode===38){e.preventDefault(),this._moveIndex(-1);return}(!this.multiple&&e.keyCode===13||e.keyCode===32)&&(e.preventDefault(),this._toggleSelection(parseInt(n.getAttribute("data-index"),10),!this.multiple)),this.multiple&&e.keyCode===13&&this._toggleOverlay()}}_moveIndex(e){if(this.focusIndex===null)this.focusIndex=0;else{const n=this.focusIndex+e,r=this.suggestions.length-1;n>r?this.focusIndex=0:n<0?this.focusIndex=r:this.focusIndex=n}this.suggestions[this.focusIndex].focus()}_positionCursor(){setTimeout(()=>{var e;if(this.input){const n=(e=this.input.value.length)!=null?e:0;this.input.setSelectionRange(n,n)}})}_removeOption(e){var n,r;const o=Ho.call(e.target,"button");if(!o)return;const s=(n=this.selectedList)==null?void 0:n.querySelectorAll("button"),i=Array.prototype.indexOf.call(s,o)-1,a=parseInt(o.getAttribute("data-index"),10);if(this._toggleSelection(a),(r=this.selectedList)!=null&&r.parentElement){const l=this.selectedList.querySelectorAll("button");l[i]?l[i].focus():l[0].focus()}else this.button.focus()}_setButtonText(){var e;const n=this.el.item(this.el.selectedIndex),r=this.button.firstElementChild;n&&n.value?this.button.classList.remove("select-a11y-button--no-selected-option"):this.button.classList.add("select-a11y-button--no-selected-option"),this.multiple?this._options.useLabelAsButton?r.innerText=((e=this.label)==null?void 0:e.innerText)||"":r.innerHTML="&nbsp;":n&&(r.innerText=n.label||n.value)}_setLiveZone(){const e=this.suggestions.length;let n="";this.open&&(e?n=this._options.text.results.replace("{x}",e):n=this._options.text.noResult),this.liveZone.innerText=n}_toggleOverlay(e,n){var r;this.open=e!==void 0?e:!this.open,this.button.setAttribute("aria-expanded",this.open?"true":"false"),this.open?(this._fillSuggestions(),this.button.insertAdjacentElement("afterend",this.overlay),(r=this.input)==null||r.focus()):this.wrap.contains(this.overlay)&&(this.wrap.removeChild(this.overlay),this.focusIndex=null,this.input&&this._options.fillSuggestions===this._defaultSearch&&(this.input.value=""),this.search="",this._setLiveZone(),(e===void 0||n)&&setTimeout(()=>{this.button.focus()}))}_toggleSelection(e,n=!0,r=!0){const o=this.el.item(e);this.multiple?o!=null&&o.hasAttribute("selected")?o.removeAttribute("selected"):o==null||o.setAttribute("selected","selected"):(o==null||o.setAttribute("selected","selected"),this.el.selectedIndex=e),this.updatedOriginalOptions=this.updatedOriginalOptions.map(s=>(s.value===(o==null?void 0:o.value)&&(o.hasAttribute("selected")?s.setAttribute("selected","selected"):s.removeAttribute("selected")),!this.multiple&&s.value!==(o==null?void 0:o.value)&&s.removeAttribute("selected"),s)),this.currentOptions=this.currentOptions.map(s=>(s.value===(o==null?void 0:o.value)&&(o.hasAttribute("selected")?s.setAttribute("selected","selected"):s.removeAttribute("selected")),!this.multiple&&s.value!==(o==null?void 0:o.value)&&s.removeAttribute("selected"),s)),this.suggestions=this.suggestions.map(s=>{var l;const i=parseInt((l=s.getAttribute("data-index"))!=null?l:"",10),a=this.el.item(i);return a&&a.selected?s.setAttribute("aria-selected","true"):s.removeAttribute("aria-selected"),s}),r&&this.el.dispatchEvent(new Event("change")),this._setButtonText(),this.multiple&&this._options.showSelected&&this._updateSelectedList(),n&&this.open&&this._toggleOverlay()}_updateSelectedList(){var e;const n=this.currentOptions.map((r,o)=>{if(!r.selected||r.hidden)return;const s=r.label||r.value;return'\n        <li class="select-a11y__selected-item">\n          <span>'.concat(s,'</span>\n          <button class="select-a11y-delete" title="').concat(this._options.text.deleteItem.replace("{t}",s),'" type="button" data-index="').concat(o,'">\n            <span class="sr-only">').concat(this._options.text.delete,'</span>\n            <span class="select-a11y-delete__icon" aria-hidden="true"></span>\n          </button>\n        </li>')}).filter(Boolean);this.selectedList&&(this.selectedList.innerHTML=n.join(""),n.length?(e=this.selectedList)!=null&&e.parentElement||this.wrap.appendChild(this.selectedList):this.selectedList.parentElement&&this.wrap.removeChild(this.selectedList))}_wrap(){var e;const n=document.createElement("div");n.classList.add("select-a11y"),(e=this.el.parentElement)==null||e.appendChild(n);const r=document.createElement("div");return r.classList.add("select-a11y__hidden"),r.setAttribute("aria-hidden","true"),this._options.useLabelAsButton&&r.appendChild(this.label),r.appendChild(this.el),n.appendChild(r),n.appendChild(this.liveZone),n.appendChild(this.button),this._options.clearable&&n.appendChild(this.clearButton),n}}const b_=L({props:{required:{type:Boolean,required:!0}}}),w_={key:0,class:"required-field-star"};function k_(t,e,n,r,o,s){return t.required?(b(),k("span",w_,"*")):I("",!0)}const tf=ke(b_,[["render",k_]]);const C_=L({components:{Required:tf},emits:["change"],props:{addAllOption:{type:Boolean,default:!0},allOption:{type:String,default:""},emptyPlaceholder:{type:String},entityUrl:{type:String},errorText:{type:String,default:""},explanation:{type:String,default:""},hasError:{type:Boolean,default:!1},hasWarning:{type:Boolean,default:!1},hintText:{type:String,default:""},isBlue:{type:Boolean,default:!1},initialOptions:Promise,isValid:{type:Boolean,default:!1},listUrl:{type:String},minimumCharacterBeforeSuggest:{type:Number,default:1},placeholder:{type:String,required:!0},required:{type:Boolean,default:!1},searchPlaceholder:{type:String,required:!0},suggestUrl:{type:String},values:{type:[Array,String]},multiple:{type:Boolean,default:!1},addNewOption:{type:Boolean,default:!1},helperLabel:{type:String,default:""},groups:{type:Array,default:null},onSuggest:{type:Function,default:null},showDescription:{type:Boolean,default:!1},roundedImages:{type:Boolean,default:!1}},setup(t,{emit:e}){const{t:n}=be(),{toast:r}=sn(),{id:o}=$s("multiselect"),s=O(()=>o+"-desc-error"),i=O(()=>o+"-desc-valid"),a=O(()=>({"fr-select-group--error":t.hasError,"fr-select-group--warning":!t.hasError&&t.hasWarning,"fr-select-group--valid":t.isValid,"multiselect--rounded-images":t.roundedImages,"multiselect--align-center":!t.showDescription})),l=vi("selectRef"),c=T(null),u=T(0),d=350,f=20,p=T([]),h=T([]),v=O(()=>p.value.slice(0,f)),y=T(t.multiple?[]:null),w="",x=T(null),$=T(null),S=O(()=>t.emptyPlaceholder||n("No results found.")),_=So({help:n("Use tab (or arrow down) to move between suggestions"),placeholder:t.searchPlaceholder,noResult:S.value,results:n("{x} available suggestion"),deleteItem:n("Delete {t}"),delete:n("Delete")}),E=async()=>t.initialOptions?t.initialOptions:t.listUrl?Qe.get(t.listUrl).then(R=>{let Z=R.data;if(Array.isArray(Z)||(Z=Z.data),t.groups){const te=Z.map(ze=>{const ut=t.groups.find(kt=>kt.values.some(gn=>gn.value===ze.id));if(ut){const kt=ut.values.find(gn=>gn.value===ze.id);if(kt)return{...ze,group:ut.name,description:kt.description||null,recommended:kt.recommended,code:kt.code}}return ze});return D(te)}else return D(Z)}).catch(R=>(xn.isCancel(R)||r.error(n("Error getting {type}.",{type:t.placeholder})),[])):h.value,D=F=>F.map(R=>{var Z,te,ze,ut,kt,gn,zs,ep,tp,np,rp,op,sp,ip,ap;return{label:(gn=(kt=(ut=(te=(Z=R.name)!=null?Z:R.title)!=null?te:R.text)!=null?ut:(ze=R==null?void 0:R.properties)==null?void 0:ze.name)!=null?kt:R.label)!=null?gn:R,value:(tp=(ep=(zs=R.id)!=null?zs:R.text)!=null?ep:R.value)!=null?tp:R,image:(ip=(sp=(op=(rp=(np=R.logo_thumbnail)!=null?np:R.logo)!=null?rp:R.image_url)!=null?op:R.image)!=null?sp:R.avatar_thumbnail)!=null?ip:R.avatar,hidden:R.hidden,selected:!!R.selected,helper:R!=null&&R.code?t.helperLabel+R.code:R==null?void 0:R.helper,description:t.showDescription&&(ap=R==null?void 0:R.description)!=null?ap:"",group:R==null?void 0:R.group,recommended:R==null?void 0:R.recommended}}),N=async(F="")=>{const Z=p.value.filter(te=>(te.label||te.value).toLocaleLowerCase().indexOf(F)!==-1).slice(0,f);return D(Z)},H=F=>F.length<t.minimumCharacterBeforeSuggest?E():t.suggestUrl?(x.value&&x.value.cancel(),x.value=Hl(),Qe.get(t.suggestUrl,{params:{q:F,size:f},cancelToken:x.value.token}).then(R=>t.onSuggest?t.onSuggest(R.data):R.data).then(R=>(t.addNewOption&&!R.some(te=>te.text===F)&&R.push({text:F}),D(R))).catch(R=>(xn.isCancel(R)||r.error(n("Error getting {type}.",{type:t.placeholder})),[]))):N(F),Y=(F="")=>H(F).then(ce),re=(F="")=>Y(F).then(R=>(h.value=R,R.slice(0,f))),ce=F=>{const R=[...F].map(te=>(te.selected=!1,te));t.allOption&&(R.find(ze=>!ze.value)||R.unshift({label:t.allOption,value:"",hidden:!t.addAllOption}));let Z=[];Array.isArray(y.value)?Z=y.value:Z=[y.value];for(let te of Z)if(typeof te=="string"){const ze=R.findIndex(kt=>kt.value===te),ut=h.value.find(kt=>kt.value===te);ut&&(ut.selected=!0,ze===-1?R.unshift(ut):R[ze].selected=!0)}return D(R)},Ue=F=>(p.value=F,h.value=F,F),et=F=>{const R=T(null);return(typeof F=="string"||Array.isArray(F))&&(R.value=F),R},$e=()=>{let F=[],R=Ke(et(t.values));if(Array.isArray(R))for(let Z of R)F.push(Ae(Z));else F.push(Ae(R));return Promise.all(F).then(Z=>(t.multiple?y.value=Z.filter(te=>te!==null):y.value=Z[0],y.value)).catch(Z=>(xn.isCancel(Z)||r.error(n("Error getting {type}.",{type:t.placeholder})),[]))},Ae=F=>{var Z;let R=null;if(F&&t.entityUrl)R=Qe.get("".concat(t.entityUrl).concat(F,"/")).then(te=>te.data).then(te=>D([te])).then(te=>{var ze,ut;return(ut=(ze=te[0])==null?void 0:ze.label)!=null?ut:F}).then(te=>{h.value.every(ut=>ut.value!==F)&&h.value.push({label:te,value:F})}).then(()=>F);else{let te=h.value.find(ze=>ze.value===F);F&&!te&&(te={label:F,value:F},h.value.push(te)),R=Promise.resolve((Z=te==null?void 0:te.value)!=null?Z:null)}return R.then(te=>te!=null?te:w).catch(te=>(xn.isCancel(te)||r.error(n("Error getting {type}.",{type:t.placeholder})),""))},qe=()=>{if(l.value)if(t.multiple){const F=Array.from(l.value.selectedOptions).map(R=>R.value);y.value=F,e("change",F)}else y.value=l.value.value,e("change",l.value.value)},Fe=()=>{l.value&&(t.multiple?y.value=[]:y.value=null)},We=()=>{Oe(),ct(),q()},Oe=()=>{if(!c.value)return;let F=c.value.getBoundingClientRect(),R=d;window.innerWidth<R&&(R=Math.min(d,F.width));let te=window.innerWidth-F.x<R;u.value=te?R-F.width:0;const ze=c.value.style;ze.setProperty("--offset-select-a11y__overlay","-".concat(u.value,"px")),ze.setProperty("--min-width-select-a11y__overlay","".concat(R,"px"))},ct=()=>{if(!c.value)return;const F=c.value.querySelector(".select-a11y");F&&(F.classList.add("fr-select"),t.isBlue&&F.classList.add("fr-select--blue"));const R=c.value.querySelector("label");R&&R.classList.add("fr-label");const Z=c.value.querySelector(".select-a11y-button__text");Z&&!Z.innerHTML&&(Z.innerHTML="&nbsp;")},q=()=>{c.value&&l.value&&(l.value.removeEventListener("change",qe),l.value.addEventListener("change",qe),l.value.removeEventListener("reset",Fe),l.value.addEventListener("reset",Fe))},z=()=>{const F={text:_,clearable:!0};F.fillSuggestions=re;try{$.value=new y_(l.value,F),We()}catch(R){console.log(R)}};function B(F,R){return Array.isArray(F)&&Array.isArray(R)?[...F.filter(Z=>!R.includes(Z))]:F===R?[]:[F]}async function se(F){var R;await re(F),(R=$.value)==null||R.selectOptionSilently(F),y.value=F}He(()=>t.values,async()=>{var Z;const F=y.value;await $e();const R=B(y.value,F);for(const te of R)(Z=$.value)==null||Z.selectOptionSilently(te)});const ue=Y().then(Ue).then($e);return De(()=>ue.then(z)),Hg(We),{container:c,displayedOptions:v,errorTextId:s,id:o,offset:u,selected:y,selectGroupClass:a,selectOption:se,validTextId:i}}}),x_=["data-selected"],S_=["for","title"],__={key:0,class:"fr-icon-information-line","aria-hidden":"true"},T_={key:1,class:"fr-hint-text"},$_=["id","required","multiple"],O_=["label"],M_=["value","data-image","hidden","data-helper","data-description","data-show-icon"],E_=["value","data-image","hidden","data-helper","data-description","data-show-icon"],N_=["value","data-image","hidden","data-helper","data-description","data-show-icon"],D_=["id"],A_=["id"];function R_(t,e,n,r,o,s){const i=Je("Required");return b(),k("div",{class:ae(["multiselect w-100 fr-select-group",t.selectGroupClass]),ref:"container","data-selected":!!t.selected},[g("div",null,[g("label",{for:t.id,title:t.explanation},[U(C(t.placeholder)+" ",1),M(i,{required:t.required},null,8,["required"]),t.explanation?(b(),k("span",__)):I("",!0),t.hintText?(b(),k("span",T_,C(t.hintText),1)):I("",!0)],8,S_),nt(g("select",{class:"multiselect__input",id:t.id,ref:"selectRef","onUpdate:modelValue":e[0]||(e[0]=a=>t.selected=a),required:t.required,multiple:t.multiple},[t.groups?(b(),k(K,{key:0},[(b(!0),k(K,null,Ne(t.groups,a=>(b(),k("optgroup",{label:a.name},[(b(!0),k(K,null,Ne(t.displayedOptions,l=>(b(),k(K,{key:l.value},[a.name==l.group?(b(),k("option",{key:0,value:l.value,"data-image":l.image,hidden:l.hidden,"data-helper":l.helper,"data-description":l.description,"data-show-icon":l.recommended},C(l.label),9,M_)):I("",!0)],64))),128))],8,O_))),256)),(b(!0),k(K,null,Ne(t.displayedOptions,a=>(b(),k(K,{key:a.value},[a.group?I("",!0):(b(),k("option",{key:0,value:a.value,"data-image":a.image,hidden:a.hidden,"data-helper":a.helper,"data-description":a.description,"data-show-icon":a.recommended},C(a.label),9,E_))],64))),128))],64)):(b(!0),k(K,{key:1},Ne(t.displayedOptions,a=>(b(),k("option",{key:a.value,value:a.value,"data-image":a.image,hidden:a.hidden,"data-helper":a.helper,"data-description":a.description,"data-show-icon":a.recommended},C(a.label),9,N_))),128))],8,$_),[[Ul,t.selected]])]),t.isValid?(b(),k("p",{key:0,id:t.validTextId,class:"fr-valid-text"},C(t.validText),9,D_)):t.hasError?(b(),k("p",{key:1,id:t.errorTextId,class:"fr-error-text"},C(t.errorText),9,A_)):I("",!0)],10,x_)}const Ln=ke(C_,[["render",R_],["__scopeId","data-v-9b8f38b5"]]),I_=L({__name:"SchemaSelect",props:{allOption:{default:""},isBlue:{type:Boolean,default:!1},showExplanation:{type:Boolean,default:!0},values:{}},emits:["change"],setup(t,{emit:e}){const n=e,r=jg().then(s=>s.map(i=>({label:i.name,value:i.name}))),o=s=>n("change",s);return(s,i)=>(b(),j(Ln,{placeholder:s.$t("Schema"),explanation:t.showExplanation?s.$t("Data schemas describe data models: what are the fields, how are data shown, what are the available values, etc. See schema.data.gouv.fr"):"",searchPlaceholder:s.$t("Search a schema..."),allOption:t.allOption?t.allOption:s.$t("All schemas"),initialOptions:m(r),values:t.values,onChange:o,isBlue:t.isBlue},null,8,["placeholder","explanation","searchPlaceholder","allOption","initialOptions","values","isBlue"]))}});function rn(t){"@babel/helpers - typeof";return rn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rn(t)}function Pe(t){if(t===null||t===!0||t===!1)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function oe(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function ne(t){oe(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||rn(t)==="object"&&e==="[object Date]"?new Date(t.getTime()):typeof t=="number"||e==="[object Number]"?new Date(t):((typeof t=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function P_(t,e){oe(2,arguments);var n=ne(t),r=Pe(e);return isNaN(r)?new Date(NaN):(r&&n.setDate(n.getDate()+r),n)}function nf(t,e){oe(2,arguments);var n=ne(t),r=Pe(e);if(isNaN(r))return new Date(NaN);if(!r)return n;var o=n.getDate(),s=new Date(n.getTime());s.setMonth(n.getMonth()+r+1,0);var i=s.getDate();return o>=i?s:(n.setFullYear(s.getFullYear(),s.getMonth(),o),n)}function L_(t,e){oe(2,arguments);var n=ne(t).getTime(),r=Pe(e);return new Date(n+r)}var z_={};function Qn(){return z_}function B_(t,e){var n,r,o,s,i,a,l,c;oe(1,arguments);var u=Qn(),d=Pe((n=(r=(o=(s=e==null?void 0:e.weekStartsOn)!==null&&s!==void 0?s:e==null||(i=e.locale)===null||i===void 0||(a=i.options)===null||a===void 0?void 0:a.weekStartsOn)!==null&&o!==void 0?o:u.weekStartsOn)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&n!==void 0?n:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=ne(t),p=f.getDay(),h=(p<d?7:0)+p-d;return f.setDate(f.getDate()-h),f.setHours(0,0,0,0),f}function H1(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function ju(t){oe(1,arguments);var e=ne(t);return e.setHours(0,0,0,0),e}function rf(t,e){oe(2,arguments);var n=Pe(e);return nf(t,n*12)}function F_(t){oe(1,arguments);var e;if(t&&typeof t.forEach=="function")e=t;else if(rn(t)==="object"&&t!==null)e=Array.prototype.slice.call(t);else return new Date(NaN);var n;return e.forEach(function(r){var o=ne(r);(n===void 0||n<o||isNaN(Number(o)))&&(n=o)}),n||new Date(NaN)}function V_(t){oe(1,arguments);var e;if(t&&typeof t.forEach=="function")e=t;else if(rn(t)==="object"&&t!==null)e=Array.prototype.slice.call(t);else return new Date(NaN);var n;return e.forEach(function(r){var o=ne(r);(n===void 0||n>o||isNaN(o.getDate()))&&(n=o)}),n||new Date(NaN)}var H_=6e4,q_=36e5,U_=1e3;function qc(t,e){oe(2,arguments);var n=ju(t),r=ju(e);return n.getTime()===r.getTime()}function W_(t){return oe(1,arguments),t instanceof Date||rn(t)==="object"&&Object.prototype.toString.call(t)==="[object Date]"}function qt(t){if(oe(1,arguments),!W_(t)&&typeof t!="number")return!1;var e=ne(t);return!isNaN(Number(e))}function j_(t){oe(1,arguments);var e=ne(t);return e.setHours(23,59,59,999),e}function q1(t){oe(1,arguments);var e=ne(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}function K_(t,e){var n;oe(1,arguments);var r=t||{},o=ne(r.start),s=ne(r.end),i=s.getTime();if(!(o.getTime()<=i))throw new RangeError("Invalid interval");var a=[],l=o;l.setHours(0,0,0,0);var c=Number((n=e==null?void 0:e.step)!==null&&n!==void 0?n:1);if(c<1||isNaN(c))throw new RangeError("`options.step` must be a number greater than 1");for(;l.getTime()<=i;)a.push(ne(l)),l.setDate(l.getDate()+c),l.setHours(0,0,0,0);return a}function Mp(t){oe(1,arguments);var e=ne(t);return e.setSeconds(0,0),e}function Y_(t){oe(1,arguments);var e=t||{},n=ne(e.start),r=ne(e.end),o=r.getTime(),s=[];if(!(n.getTime()<=o))throw new RangeError("Invalid interval");var i=n;for(i.setHours(0,0,0,0),i.setDate(1);i.getTime()<=o;)s.push(ne(i)),i.setMonth(i.getMonth()+1);return s}function U1(t){oe(1,arguments);var e=ne(t);return e.setDate(1),e.setHours(0,0,0,0),e}function G_(t){oe(1,arguments);var e=ne(t),n=e.getFullYear();return e.setFullYear(n+1,0,0),e.setHours(23,59,59,999),e}function J_(t){oe(1,arguments);var e=ne(t),n=new Date(0);return n.setFullYear(e.getFullYear(),0,1),n.setHours(0,0,0,0),n}function X_(t){oe(1,arguments);var e=t||{},n=ne(e.start),r=ne(e.end),o=r.getTime();if(!(n.getTime()<=o))throw new RangeError("Invalid interval");var s=[],i=n;for(i.setHours(0,0,0,0),i.setMonth(0,1);i.getTime()<=o;)s.push(ne(i)),i.setFullYear(i.getFullYear()+1);return s}function Z_(t){oe(1,arguments);var e=ne(t),n=e.getFullYear(),r=9+Math.floor(n/10)*10;return e.setFullYear(r,11,31),e.setHours(23,59,59,999),e}function Q_(t,e){var n,r,o,s,i,a,l,c;oe(1,arguments);var u=Qn(),d=Pe((n=(r=(o=(s=e==null?void 0:e.weekStartsOn)!==null&&s!==void 0?s:e==null||(i=e.locale)===null||i===void 0||(a=i.options)===null||a===void 0?void 0:a.weekStartsOn)!==null&&o!==void 0?o:u.weekStartsOn)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&n!==void 0?n:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=ne(t),p=f.getDay(),h=(p<d?-7:0)+6-(p-d);return f.setDate(f.getDate()+h),f.setHours(23,59,59,999),f}function W1(t,e){oe(2,arguments);var n=Pe(e);return L_(t,-n)}var eT=864e5;function tT(t){oe(1,arguments);var e=ne(t),n=e.getTime();e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0);var r=e.getTime(),o=n-r;return Math.floor(o/eT)+1}function ms(t){oe(1,arguments);var e=1,n=ne(t),r=n.getUTCDay(),o=(r<e?7:0)+r-e;return n.setUTCDate(n.getUTCDate()-o),n.setUTCHours(0,0,0,0),n}function j1(t){oe(1,arguments);var e=ne(t),n=e.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(n+1,0,4),r.setUTCHours(0,0,0,0);var o=ms(r),s=new Date(0);s.setUTCFullYear(n,0,4),s.setUTCHours(0,0,0,0);var i=ms(s);return e.getTime()>=o.getTime()?n+1:e.getTime()>=i.getTime()?n:n-1}function nT(t){oe(1,arguments);var e=j1(t),n=new Date(0);n.setUTCFullYear(e,0,4),n.setUTCHours(0,0,0,0);var r=ms(n);return r}var rT=6048e5;function K1(t){oe(1,arguments);var e=ne(t),n=ms(e).getTime()-nT(e).getTime();return Math.round(n/rT)+1}function go(t,e){var n,r,o,s,i,a,l,c;oe(1,arguments);var u=Qn(),d=Pe((n=(r=(o=(s=e==null?void 0:e.weekStartsOn)!==null&&s!==void 0?s:e==null||(i=e.locale)===null||i===void 0||(a=i.options)===null||a===void 0?void 0:a.weekStartsOn)!==null&&o!==void 0?o:u.weekStartsOn)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&n!==void 0?n:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=ne(t),p=f.getUTCDay(),h=(p<d?7:0)+p-d;return f.setUTCDate(f.getUTCDate()-h),f.setUTCHours(0,0,0,0),f}function of(t,e){var n,r,o,s,i,a,l,c;oe(1,arguments);var u=ne(t),d=u.getUTCFullYear(),f=Qn(),p=Pe((n=(r=(o=(s=e==null?void 0:e.firstWeekContainsDate)!==null&&s!==void 0?s:e==null||(i=e.locale)===null||i===void 0||(a=i.options)===null||a===void 0?void 0:a.firstWeekContainsDate)!==null&&o!==void 0?o:f.firstWeekContainsDate)!==null&&r!==void 0?r:(l=f.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&n!==void 0?n:1);if(!(p>=1&&p<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var h=new Date(0);h.setUTCFullYear(d+1,0,p),h.setUTCHours(0,0,0,0);var v=go(h,e),y=new Date(0);y.setUTCFullYear(d,0,p),y.setUTCHours(0,0,0,0);var w=go(y,e);return u.getTime()>=v.getTime()?d+1:u.getTime()>=w.getTime()?d:d-1}function oT(t,e){var n,r,o,s,i,a,l,c;oe(1,arguments);var u=Qn(),d=Pe((n=(r=(o=(s=e==null?void 0:e.firstWeekContainsDate)!==null&&s!==void 0?s:e==null||(i=e.locale)===null||i===void 0||(a=i.options)===null||a===void 0?void 0:a.firstWeekContainsDate)!==null&&o!==void 0?o:u.firstWeekContainsDate)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&n!==void 0?n:1),f=of(t,e),p=new Date(0);p.setUTCFullYear(f,0,d),p.setUTCHours(0,0,0,0);var h=go(p,e);return h}var sT=6048e5;function Y1(t,e){oe(1,arguments);var n=ne(t),r=go(n,e).getTime()-oT(n,e).getTime();return Math.round(r/sT)+1}function Re(t,e){for(var n=t<0?"-":"",r=Math.abs(t).toString();r.length<e;)r="0"+r;return n+r}var iT={y:function(e,n){var r=e.getUTCFullYear(),o=r>0?r:1-r;return Re(n==="yy"?o%100:o,n.length)},M:function(e,n){var r=e.getUTCMonth();return n==="M"?String(r+1):Re(r+1,2)},d:function(e,n){return Re(e.getUTCDate(),n.length)},a:function(e,n){var r=e.getUTCHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h:function(e,n){return Re(e.getUTCHours()%12||12,n.length)},H:function(e,n){return Re(e.getUTCHours(),n.length)},m:function(e,n){return Re(e.getUTCMinutes(),n.length)},s:function(e,n){return Re(e.getUTCSeconds(),n.length)},S:function(e,n){var r=n.length,o=e.getUTCMilliseconds(),s=Math.floor(o*Math.pow(10,r-3));return Re(s,n.length)}};const sr=iT;var No={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},aT={G:function(e,n,r){var o=e.getUTCFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return r.era(o,{width:"abbreviated"});case"GGGGG":return r.era(o,{width:"narrow"});case"GGGG":default:return r.era(o,{width:"wide"})}},y:function(e,n,r){if(n==="yo"){var o=e.getUTCFullYear(),s=o>0?o:1-o;return r.ordinalNumber(s,{unit:"year"})}return sr.y(e,n)},Y:function(e,n,r,o){var s=of(e,o),i=s>0?s:1-s;if(n==="YY"){var a=i%100;return Re(a,2)}return n==="Yo"?r.ordinalNumber(i,{unit:"year"}):Re(i,n.length)},R:function(e,n){var r=j1(e);return Re(r,n.length)},u:function(e,n){var r=e.getUTCFullYear();return Re(r,n.length)},Q:function(e,n,r){var o=Math.ceil((e.getUTCMonth()+1)/3);switch(n){case"Q":return String(o);case"QQ":return Re(o,2);case"Qo":return r.ordinalNumber(o,{unit:"quarter"});case"QQQ":return r.quarter(o,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(o,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(o,{width:"wide",context:"formatting"})}},q:function(e,n,r){var o=Math.ceil((e.getUTCMonth()+1)/3);switch(n){case"q":return String(o);case"qq":return Re(o,2);case"qo":return r.ordinalNumber(o,{unit:"quarter"});case"qqq":return r.quarter(o,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(o,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(o,{width:"wide",context:"standalone"})}},M:function(e,n,r){var o=e.getUTCMonth();switch(n){case"M":case"MM":return sr.M(e,n);case"Mo":return r.ordinalNumber(o+1,{unit:"month"});case"MMM":return r.month(o,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(o,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(o,{width:"wide",context:"formatting"})}},L:function(e,n,r){var o=e.getUTCMonth();switch(n){case"L":return String(o+1);case"LL":return Re(o+1,2);case"Lo":return r.ordinalNumber(o+1,{unit:"month"});case"LLL":return r.month(o,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(o,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(o,{width:"wide",context:"standalone"})}},w:function(e,n,r,o){var s=Y1(e,o);return n==="wo"?r.ordinalNumber(s,{unit:"week"}):Re(s,n.length)},I:function(e,n,r){var o=K1(e);return n==="Io"?r.ordinalNumber(o,{unit:"week"}):Re(o,n.length)},d:function(e,n,r){return n==="do"?r.ordinalNumber(e.getUTCDate(),{unit:"date"}):sr.d(e,n)},D:function(e,n,r){var o=tT(e);return n==="Do"?r.ordinalNumber(o,{unit:"dayOfYear"}):Re(o,n.length)},E:function(e,n,r){var o=e.getUTCDay();switch(n){case"E":case"EE":case"EEE":return r.day(o,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(o,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(o,{width:"short",context:"formatting"});case"EEEE":default:return r.day(o,{width:"wide",context:"formatting"})}},e:function(e,n,r,o){var s=e.getUTCDay(),i=(s-o.weekStartsOn+8)%7||7;switch(n){case"e":return String(i);case"ee":return Re(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(e,n,r,o){var s=e.getUTCDay(),i=(s-o.weekStartsOn+8)%7||7;switch(n){case"c":return String(i);case"cc":return Re(i,n.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(e,n,r){var o=e.getUTCDay(),s=o===0?7:o;switch(n){case"i":return String(s);case"ii":return Re(s,n.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(o,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(o,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(o,{width:"short",context:"formatting"});case"iiii":default:return r.day(o,{width:"wide",context:"formatting"})}},a:function(e,n,r){var o=e.getUTCHours(),s=o/12>=1?"pm":"am";switch(n){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,n,r){var o=e.getUTCHours(),s;switch(o===12?s=No.noon:o===0?s=No.midnight:s=o/12>=1?"pm":"am",n){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,n,r){var o=e.getUTCHours(),s;switch(o>=17?s=No.evening:o>=12?s=No.afternoon:o>=4?s=No.morning:s=No.night,n){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,n,r){if(n==="ho"){var o=e.getUTCHours()%12;return o===0&&(o=12),r.ordinalNumber(o,{unit:"hour"})}return sr.h(e,n)},H:function(e,n,r){return n==="Ho"?r.ordinalNumber(e.getUTCHours(),{unit:"hour"}):sr.H(e,n)},K:function(e,n,r){var o=e.getUTCHours()%12;return n==="Ko"?r.ordinalNumber(o,{unit:"hour"}):Re(o,n.length)},k:function(e,n,r){var o=e.getUTCHours();return o===0&&(o=24),n==="ko"?r.ordinalNumber(o,{unit:"hour"}):Re(o,n.length)},m:function(e,n,r){return n==="mo"?r.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):sr.m(e,n)},s:function(e,n,r){return n==="so"?r.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):sr.s(e,n)},S:function(e,n){return sr.S(e,n)},X:function(e,n,r,o){var s=o._originalDate||e,i=s.getTimezoneOffset();if(i===0)return"Z";switch(n){case"X":return Np(i);case"XXXX":case"XX":return Vr(i);case"XXXXX":case"XXX":default:return Vr(i,":")}},x:function(e,n,r,o){var s=o._originalDate||e,i=s.getTimezoneOffset();switch(n){case"x":return Np(i);case"xxxx":case"xx":return Vr(i);case"xxxxx":case"xxx":default:return Vr(i,":")}},O:function(e,n,r,o){var s=o._originalDate||e,i=s.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+Ep(i,":");case"OOOO":default:return"GMT"+Vr(i,":")}},z:function(e,n,r,o){var s=o._originalDate||e,i=s.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+Ep(i,":");case"zzzz":default:return"GMT"+Vr(i,":")}},t:function(e,n,r,o){var s=o._originalDate||e,i=Math.floor(s.getTime()/1e3);return Re(i,n.length)},T:function(e,n,r,o){var s=o._originalDate||e,i=s.getTime();return Re(i,n.length)}};function Ep(t,e){var n=t>0?"-":"+",r=Math.abs(t),o=Math.floor(r/60),s=r%60;if(s===0)return n+String(o);var i=e||"";return n+String(o)+i+Re(s,2)}function Np(t,e){if(t%60===0){var n=t>0?"-":"+";return n+Re(Math.abs(t)/60,2)}return Vr(t,e)}function Vr(t,e){var n=e||"",r=t>0?"-":"+",o=Math.abs(t),s=Re(Math.floor(o/60),2),i=Re(o%60,2);return r+s+n+i}const lT=aT;var Dp=function(e,n){switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},G1=function(e,n){switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},cT=function(e,n){var r=e.match(/(P+)(p+)?/)||[],o=r[1],s=r[2];if(!s)return Dp(e,n);var i;switch(o){case"P":i=n.dateTime({width:"short"});break;case"PP":i=n.dateTime({width:"medium"});break;case"PPP":i=n.dateTime({width:"long"});break;case"PPPP":default:i=n.dateTime({width:"full"});break}return i.replace("{{date}}",Dp(o,n)).replace("{{time}}",G1(s,n))},uT={p:G1,P:cT};const Ku=uT;var dT=["D","DD"],fT=["YY","YYYY"];function J1(t){return dT.indexOf(t)!==-1}function X1(t){return fT.indexOf(t)!==-1}function dl(t,e,n){if(t==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(e,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(e,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(e,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(e,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var hT={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},pT={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},mT={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},gT={date:Pc({formats:hT,defaultWidth:"full"}),time:Pc({formats:pT,defaultWidth:"full"}),dateTime:Pc({formats:mT,defaultWidth:"full"})};const vT=gT;var yT={code:"en-US",formatDistance:qb,formatLong:vT,formatRelative:Ub,localize:Wb,match:jb,options:{weekStartsOn:0,firstWeekContainsDate:1}};const Z1=yT;var bT=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,wT=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,kT=/^'([^]*?)'?$/,CT=/''/g,xT=/[a-zA-Z]/;function gs(t,e,n){var r,o,s,i,a,l,c,u,d,f,p,h,v,y,w,x,$,S;oe(2,arguments);var _=String(e),E=Qn(),D=(r=(o=n==null?void 0:n.locale)!==null&&o!==void 0?o:E.locale)!==null&&r!==void 0?r:Z1,N=Pe((s=(i=(a=(l=n==null?void 0:n.firstWeekContainsDate)!==null&&l!==void 0?l:n==null||(c=n.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&a!==void 0?a:E.firstWeekContainsDate)!==null&&i!==void 0?i:(d=E.locale)===null||d===void 0||(f=d.options)===null||f===void 0?void 0:f.firstWeekContainsDate)!==null&&s!==void 0?s:1);if(!(N>=1&&N<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var H=Pe((p=(h=(v=(y=n==null?void 0:n.weekStartsOn)!==null&&y!==void 0?y:n==null||(w=n.locale)===null||w===void 0||(x=w.options)===null||x===void 0?void 0:x.weekStartsOn)!==null&&v!==void 0?v:E.weekStartsOn)!==null&&h!==void 0?h:($=E.locale)===null||$===void 0||(S=$.options)===null||S===void 0?void 0:S.weekStartsOn)!==null&&p!==void 0?p:0);if(!(H>=0&&H<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!D.localize)throw new RangeError("locale must contain localize property");if(!D.formatLong)throw new RangeError("locale must contain formatLong property");var Y=ne(t);if(!qt(Y))throw new RangeError("Invalid time value");var re=H1(Y),ce=W1(Y,re),Ue={firstWeekContainsDate:N,weekStartsOn:H,locale:D,_originalDate:Y},et=_.match(wT).map(function($e){var Ae=$e[0];if(Ae==="p"||Ae==="P"){var qe=Ku[Ae];return qe($e,D.formatLong)}return $e}).join("").match(bT).map(function($e){if($e==="''")return"'";var Ae=$e[0];if(Ae==="'")return ST($e);var qe=lT[Ae];if(qe)return!(n!=null&&n.useAdditionalWeekYearTokens)&&X1($e)&&dl($e,e,String(t)),!(n!=null&&n.useAdditionalDayOfYearTokens)&&J1($e)&&dl($e,e,String(t)),qe(ce,$e,D.localize,Ue);if(Ae.match(xT))throw new RangeError("Format string contains an unescaped latin alphabet character `"+Ae+"`");return $e}).join("");return et}function ST(t){var e=t.match(kT);return e?e[1].replace(CT,"'"):t}function _T(t,e){if(t==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function TT(t){oe(1,arguments);var e=ne(t),n=e.getFullYear(),r=e.getMonth(),o=new Date(0);return o.setFullYear(n,r+1,0),o.setHours(0,0,0,0),o.getDate()}function ba(t){oe(1,arguments);var e=ne(t),n=e.getFullYear(),r=Math.floor(n/10)*10;return r}function cn(t){return oe(1,arguments),ne(t).getFullYear()}function yi(t,e){oe(2,arguments);var n=ne(t),r=ne(e);return n.getTime()>r.getTime()}function bi(t,e){oe(2,arguments);var n=ne(t),r=ne(e);return n.getTime()<r.getTime()}function Ap(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function $T(t,e){if(t){if(typeof t=="string")return Ap(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ap(t,e):void 0}}function Rp(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=$T(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(c){throw c},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var c=n.next();return i=c.done,c},e:function(c){a=!0,s=c},f:function(){try{i||n.return==null||n.return()}finally{if(a)throw s}}}}function Q(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Yu(t,e){return Yu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Yu(t,e)}function _e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yu(t,e)}function fl(t){return fl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},fl(t)}function Q1(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Q1=function(){return!!t})()}function OT(t,e){if(e&&(rn(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Q(t)}function Te(t){var e=Q1();return function(){var n,r=fl(t);if(e){var o=fl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return OT(this,n)}}function Ce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function MT(t,e){if(rn(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(rn(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ev(t){var e=MT(t,"string");return rn(e)=="symbol"?e:e+""}function Ip(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ev(r.key),r)}}function xe(t,e,n){return e&&Ip(t.prototype,e),n&&Ip(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function X(t,e,n){return(e=ev(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ET=10,tv=function(){function t(){Ce(this,t),X(this,"priority",void 0),X(this,"subPriority",0)}return xe(t,[{key:"validate",value:function(n,r){return!0}}]),t}(),NT=function(t){_e(n,t);var e=Te(n);function n(r,o,s,i,a){var l;return Ce(this,n),l=e.call(this),l.value=r,l.validateValue=o,l.setValue=s,l.priority=i,a&&(l.subPriority=a),l}return xe(n,[{key:"validate",value:function(o,s){return this.validateValue(o,this.value,s)}},{key:"set",value:function(o,s,i){return this.setValue(o,s,this.value,i)}}]),n}(tv),DT=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",ET),X(Q(r),"subPriority",-1),r}return xe(n,[{key:"set",value:function(o,s){if(s.timestampIsSet)return o;var i=new Date(0);return i.setFullYear(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate()),i.setHours(o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds(),o.getUTCMilliseconds()),i}}]),n}(tv),Ee=function(){function t(){Ce(this,t),X(this,"incompatibleTokens",void 0),X(this,"priority",void 0),X(this,"subPriority",void 0)}return xe(t,[{key:"run",value:function(n,r,o,s){var i=this.parse(n,r,o,s);return i?{setter:new NT(i.value,this.validate,this.set,this.priority,this.subPriority),rest:i.rest}:null}},{key:"validate",value:function(n,r,o){return!0}}]),t}(),AT=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",140),X(Q(r),"incompatibleTokens",["R","u","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){switch(s){case"G":case"GG":case"GGG":return i.era(o,{width:"abbreviated"})||i.era(o,{width:"narrow"});case"GGGGG":return i.era(o,{width:"narrow"});case"GGGG":default:return i.era(o,{width:"wide"})||i.era(o,{width:"abbreviated"})||i.era(o,{width:"narrow"})}}},{key:"set",value:function(o,s,i){return s.era=i,o.setUTCFullYear(i,0,1),o.setUTCHours(0,0,0,0),o}}]),n}(Ee),Xe={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},kn={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Ze(t,e){return t&&{value:e(t.value),rest:t.rest}}function je(t,e){var n=e.match(t);return n?{value:parseInt(n[0],10),rest:e.slice(n[0].length)}:null}function Cn(t,e){var n=e.match(t);if(!n)return null;if(n[0]==="Z")return{value:0,rest:e.slice(1)};var r=n[1]==="+"?1:-1,o=n[2]?parseInt(n[2],10):0,s=n[3]?parseInt(n[3],10):0,i=n[5]?parseInt(n[5],10):0;return{value:r*(o*q_+s*H_+i*U_),rest:e.slice(n[0].length)}}function nv(t){return je(Xe.anyDigitsSigned,t)}function Ge(t,e){switch(t){case 1:return je(Xe.singleDigit,e);case 2:return je(Xe.twoDigits,e);case 3:return je(Xe.threeDigits,e);case 4:return je(Xe.fourDigits,e);default:return je(new RegExp("^\\d{1,"+t+"}"),e)}}function hl(t,e){switch(t){case 1:return je(Xe.singleDigitSigned,e);case 2:return je(Xe.twoDigitsSigned,e);case 3:return je(Xe.threeDigitsSigned,e);case 4:return je(Xe.fourDigitsSigned,e);default:return je(new RegExp("^-?\\d{1,"+t+"}"),e)}}function sf(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function rv(t,e){var n=e>0,r=n?e:1-e,o;if(r<=50)o=t||100;else{var s=r+50,i=Math.floor(s/100)*100,a=t>=s%100;o=t+i-(a?100:0)}return n?o:1-o}function ov(t){return t%400===0||t%4===0&&t%100!==0}var RT=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",130),X(Q(r),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){var a=function(c){return{year:c,isTwoDigitYear:s==="yy"}};switch(s){case"y":return Ze(Ge(4,o),a);case"yo":return Ze(i.ordinalNumber(o,{unit:"year"}),a);default:return Ze(Ge(s.length,o),a)}}},{key:"validate",value:function(o,s){return s.isTwoDigitYear||s.year>0}},{key:"set",value:function(o,s,i){var a=o.getUTCFullYear();if(i.isTwoDigitYear){var l=rv(i.year,a);return o.setUTCFullYear(l,0,1),o.setUTCHours(0,0,0,0),o}var c=!("era"in s)||s.era===1?i.year:1-i.year;return o.setUTCFullYear(c,0,1),o.setUTCHours(0,0,0,0),o}}]),n}(Ee),IT=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",130),X(Q(r),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){var a=function(c){return{year:c,isTwoDigitYear:s==="YY"}};switch(s){case"Y":return Ze(Ge(4,o),a);case"Yo":return Ze(i.ordinalNumber(o,{unit:"year"}),a);default:return Ze(Ge(s.length,o),a)}}},{key:"validate",value:function(o,s){return s.isTwoDigitYear||s.year>0}},{key:"set",value:function(o,s,i,a){var l=of(o,a);if(i.isTwoDigitYear){var c=rv(i.year,l);return o.setUTCFullYear(c,0,a.firstWeekContainsDate),o.setUTCHours(0,0,0,0),go(o,a)}var u=!("era"in s)||s.era===1?i.year:1-i.year;return o.setUTCFullYear(u,0,a.firstWeekContainsDate),o.setUTCHours(0,0,0,0),go(o,a)}}]),n}(Ee),PT=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",130),X(Q(r),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s){return hl(s==="R"?4:s.length,o)}},{key:"set",value:function(o,s,i){var a=new Date(0);return a.setUTCFullYear(i,0,4),a.setUTCHours(0,0,0,0),ms(a)}}]),n}(Ee),LT=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",130),X(Q(r),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s){return hl(s==="u"?4:s.length,o)}},{key:"set",value:function(o,s,i){return o.setUTCFullYear(i,0,1),o.setUTCHours(0,0,0,0),o}}]),n}(Ee),zT=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",120),X(Q(r),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){switch(s){case"Q":case"QQ":return Ge(s.length,o);case"Qo":return i.ordinalNumber(o,{unit:"quarter"});case"QQQ":return i.quarter(o,{width:"abbreviated",context:"formatting"})||i.quarter(o,{width:"narrow",context:"formatting"});case"QQQQQ":return i.quarter(o,{width:"narrow",context:"formatting"});case"QQQQ":default:return i.quarter(o,{width:"wide",context:"formatting"})||i.quarter(o,{width:"abbreviated",context:"formatting"})||i.quarter(o,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(o,s){return s>=1&&s<=4}},{key:"set",value:function(o,s,i){return o.setUTCMonth((i-1)*3,1),o.setUTCHours(0,0,0,0),o}}]),n}(Ee),BT=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",120),X(Q(r),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){switch(s){case"q":case"qq":return Ge(s.length,o);case"qo":return i.ordinalNumber(o,{unit:"quarter"});case"qqq":return i.quarter(o,{width:"abbreviated",context:"standalone"})||i.quarter(o,{width:"narrow",context:"standalone"});case"qqqqq":return i.quarter(o,{width:"narrow",context:"standalone"});case"qqqq":default:return i.quarter(o,{width:"wide",context:"standalone"})||i.quarter(o,{width:"abbreviated",context:"standalone"})||i.quarter(o,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(o,s){return s>=1&&s<=4}},{key:"set",value:function(o,s,i){return o.setUTCMonth((i-1)*3,1),o.setUTCHours(0,0,0,0),o}}]),n}(Ee),FT=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),X(Q(r),"priority",110),r}return xe(n,[{key:"parse",value:function(o,s,i){var a=function(c){return c-1};switch(s){case"M":return Ze(je(Xe.month,o),a);case"MM":return Ze(Ge(2,o),a);case"Mo":return Ze(i.ordinalNumber(o,{unit:"month"}),a);case"MMM":return i.month(o,{width:"abbreviated",context:"formatting"})||i.month(o,{width:"narrow",context:"formatting"});case"MMMMM":return i.month(o,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(o,{width:"wide",context:"formatting"})||i.month(o,{width:"abbreviated",context:"formatting"})||i.month(o,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(o,s){return s>=0&&s<=11}},{key:"set",value:function(o,s,i){return o.setUTCMonth(i,1),o.setUTCHours(0,0,0,0),o}}]),n}(Ee),VT=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",110),X(Q(r),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){var a=function(c){return c-1};switch(s){case"L":return Ze(je(Xe.month,o),a);case"LL":return Ze(Ge(2,o),a);case"Lo":return Ze(i.ordinalNumber(o,{unit:"month"}),a);case"LLL":return i.month(o,{width:"abbreviated",context:"standalone"})||i.month(o,{width:"narrow",context:"standalone"});case"LLLLL":return i.month(o,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(o,{width:"wide",context:"standalone"})||i.month(o,{width:"abbreviated",context:"standalone"})||i.month(o,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(o,s){return s>=0&&s<=11}},{key:"set",value:function(o,s,i){return o.setUTCMonth(i,1),o.setUTCHours(0,0,0,0),o}}]),n}(Ee);function HT(t,e,n){oe(2,arguments);var r=ne(t),o=Pe(e),s=Y1(r,n)-o;return r.setUTCDate(r.getUTCDate()-s*7),r}var qT=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",100),X(Q(r),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){switch(s){case"w":return je(Xe.week,o);case"wo":return i.ordinalNumber(o,{unit:"week"});default:return Ge(s.length,o)}}},{key:"validate",value:function(o,s){return s>=1&&s<=53}},{key:"set",value:function(o,s,i,a){return go(HT(o,i,a),a)}}]),n}(Ee);function UT(t,e){oe(2,arguments);var n=ne(t),r=Pe(e),o=K1(n)-r;return n.setUTCDate(n.getUTCDate()-o*7),n}var WT=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",100),X(Q(r),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){switch(s){case"I":return je(Xe.week,o);case"Io":return i.ordinalNumber(o,{unit:"week"});default:return Ge(s.length,o)}}},{key:"validate",value:function(o,s){return s>=1&&s<=53}},{key:"set",value:function(o,s,i){return ms(UT(o,i))}}]),n}(Ee),jT=[31,28,31,30,31,30,31,31,30,31,30,31],KT=[31,29,31,30,31,30,31,31,30,31,30,31],YT=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",90),X(Q(r),"subPriority",1),X(Q(r),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){switch(s){case"d":return je(Xe.date,o);case"do":return i.ordinalNumber(o,{unit:"date"});default:return Ge(s.length,o)}}},{key:"validate",value:function(o,s){var i=o.getUTCFullYear(),a=ov(i),l=o.getUTCMonth();return a?s>=1&&s<=KT[l]:s>=1&&s<=jT[l]}},{key:"set",value:function(o,s,i){return o.setUTCDate(i),o.setUTCHours(0,0,0,0),o}}]),n}(Ee),GT=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",90),X(Q(r),"subpriority",1),X(Q(r),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){switch(s){case"D":case"DD":return je(Xe.dayOfYear,o);case"Do":return i.ordinalNumber(o,{unit:"date"});default:return Ge(s.length,o)}}},{key:"validate",value:function(o,s){var i=o.getUTCFullYear(),a=ov(i);return a?s>=1&&s<=366:s>=1&&s<=365}},{key:"set",value:function(o,s,i){return o.setUTCMonth(0,i),o.setUTCHours(0,0,0,0),o}}]),n}(Ee);function af(t,e,n){var r,o,s,i,a,l,c,u;oe(2,arguments);var d=Qn(),f=Pe((r=(o=(s=(i=n==null?void 0:n.weekStartsOn)!==null&&i!==void 0?i:n==null||(a=n.locale)===null||a===void 0||(l=a.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&s!==void 0?s:d.weekStartsOn)!==null&&o!==void 0?o:(c=d.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var p=ne(t),h=Pe(e),v=p.getUTCDay(),y=h%7,w=(y+7)%7,x=(w<f?7:0)+h-v;return p.setUTCDate(p.getUTCDate()+x),p}var JT=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",90),X(Q(r),"incompatibleTokens",["D","i","e","c","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){switch(s){case"E":case"EE":case"EEE":return i.day(o,{width:"abbreviated",context:"formatting"})||i.day(o,{width:"short",context:"formatting"})||i.day(o,{width:"narrow",context:"formatting"});case"EEEEE":return i.day(o,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(o,{width:"short",context:"formatting"})||i.day(o,{width:"narrow",context:"formatting"});case"EEEE":default:return i.day(o,{width:"wide",context:"formatting"})||i.day(o,{width:"abbreviated",context:"formatting"})||i.day(o,{width:"short",context:"formatting"})||i.day(o,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(o,s){return s>=0&&s<=6}},{key:"set",value:function(o,s,i,a){return o=af(o,i,a),o.setUTCHours(0,0,0,0),o}}]),n}(Ee),XT=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",90),X(Q(r),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i,a){var l=function(u){var d=Math.floor((u-1)/7)*7;return(u+a.weekStartsOn+6)%7+d};switch(s){case"e":case"ee":return Ze(Ge(s.length,o),l);case"eo":return Ze(i.ordinalNumber(o,{unit:"day"}),l);case"eee":return i.day(o,{width:"abbreviated",context:"formatting"})||i.day(o,{width:"short",context:"formatting"})||i.day(o,{width:"narrow",context:"formatting"});case"eeeee":return i.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(o,{width:"short",context:"formatting"})||i.day(o,{width:"narrow",context:"formatting"});case"eeee":default:return i.day(o,{width:"wide",context:"formatting"})||i.day(o,{width:"abbreviated",context:"formatting"})||i.day(o,{width:"short",context:"formatting"})||i.day(o,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(o,s){return s>=0&&s<=6}},{key:"set",value:function(o,s,i,a){return o=af(o,i,a),o.setUTCHours(0,0,0,0),o}}]),n}(Ee),ZT=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",90),X(Q(r),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i,a){var l=function(u){var d=Math.floor((u-1)/7)*7;return(u+a.weekStartsOn+6)%7+d};switch(s){case"c":case"cc":return Ze(Ge(s.length,o),l);case"co":return Ze(i.ordinalNumber(o,{unit:"day"}),l);case"ccc":return i.day(o,{width:"abbreviated",context:"standalone"})||i.day(o,{width:"short",context:"standalone"})||i.day(o,{width:"narrow",context:"standalone"});case"ccccc":return i.day(o,{width:"narrow",context:"standalone"});case"cccccc":return i.day(o,{width:"short",context:"standalone"})||i.day(o,{width:"narrow",context:"standalone"});case"cccc":default:return i.day(o,{width:"wide",context:"standalone"})||i.day(o,{width:"abbreviated",context:"standalone"})||i.day(o,{width:"short",context:"standalone"})||i.day(o,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(o,s){return s>=0&&s<=6}},{key:"set",value:function(o,s,i,a){return o=af(o,i,a),o.setUTCHours(0,0,0,0),o}}]),n}(Ee);function QT(t,e){oe(2,arguments);var n=Pe(e);n%7===0&&(n=n-7);var r=1,o=ne(t),s=o.getUTCDay(),i=n%7,a=(i+7)%7,l=(a<r?7:0)+n-s;return o.setUTCDate(o.getUTCDate()+l),o}var e8=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",90),X(Q(r),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){var a=function(c){return c===0?7:c};switch(s){case"i":case"ii":return Ge(s.length,o);case"io":return i.ordinalNumber(o,{unit:"day"});case"iii":return Ze(i.day(o,{width:"abbreviated",context:"formatting"})||i.day(o,{width:"short",context:"formatting"})||i.day(o,{width:"narrow",context:"formatting"}),a);case"iiiii":return Ze(i.day(o,{width:"narrow",context:"formatting"}),a);case"iiiiii":return Ze(i.day(o,{width:"short",context:"formatting"})||i.day(o,{width:"narrow",context:"formatting"}),a);case"iiii":default:return Ze(i.day(o,{width:"wide",context:"formatting"})||i.day(o,{width:"abbreviated",context:"formatting"})||i.day(o,{width:"short",context:"formatting"})||i.day(o,{width:"narrow",context:"formatting"}),a)}}},{key:"validate",value:function(o,s){return s>=1&&s<=7}},{key:"set",value:function(o,s,i){return o=QT(o,i),o.setUTCHours(0,0,0,0),o}}]),n}(Ee),t8=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",80),X(Q(r),"incompatibleTokens",["b","B","H","k","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){switch(s){case"a":case"aa":case"aaa":return i.dayPeriod(o,{width:"abbreviated",context:"formatting"})||i.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaaa":return i.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return i.dayPeriod(o,{width:"wide",context:"formatting"})||i.dayPeriod(o,{width:"abbreviated",context:"formatting"})||i.dayPeriod(o,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(o,s,i){return o.setUTCHours(sf(i),0,0,0),o}}]),n}(Ee),n8=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",80),X(Q(r),"incompatibleTokens",["a","B","H","k","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){switch(s){case"b":case"bb":case"bbb":return i.dayPeriod(o,{width:"abbreviated",context:"formatting"})||i.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbbb":return i.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return i.dayPeriod(o,{width:"wide",context:"formatting"})||i.dayPeriod(o,{width:"abbreviated",context:"formatting"})||i.dayPeriod(o,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(o,s,i){return o.setUTCHours(sf(i),0,0,0),o}}]),n}(Ee),r8=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",80),X(Q(r),"incompatibleTokens",["a","b","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){switch(s){case"B":case"BB":case"BBB":return i.dayPeriod(o,{width:"abbreviated",context:"formatting"})||i.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBBB":return i.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return i.dayPeriod(o,{width:"wide",context:"formatting"})||i.dayPeriod(o,{width:"abbreviated",context:"formatting"})||i.dayPeriod(o,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(o,s,i){return o.setUTCHours(sf(i),0,0,0),o}}]),n}(Ee),o8=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",70),X(Q(r),"incompatibleTokens",["H","K","k","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){switch(s){case"h":return je(Xe.hour12h,o);case"ho":return i.ordinalNumber(o,{unit:"hour"});default:return Ge(s.length,o)}}},{key:"validate",value:function(o,s){return s>=1&&s<=12}},{key:"set",value:function(o,s,i){var a=o.getUTCHours()>=12;return a&&i<12?o.setUTCHours(i+12,0,0,0):!a&&i===12?o.setUTCHours(0,0,0,0):o.setUTCHours(i,0,0,0),o}}]),n}(Ee),s8=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",70),X(Q(r),"incompatibleTokens",["a","b","h","K","k","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){switch(s){case"H":return je(Xe.hour23h,o);case"Ho":return i.ordinalNumber(o,{unit:"hour"});default:return Ge(s.length,o)}}},{key:"validate",value:function(o,s){return s>=0&&s<=23}},{key:"set",value:function(o,s,i){return o.setUTCHours(i,0,0,0),o}}]),n}(Ee),i8=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",70),X(Q(r),"incompatibleTokens",["h","H","k","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){switch(s){case"K":return je(Xe.hour11h,o);case"Ko":return i.ordinalNumber(o,{unit:"hour"});default:return Ge(s.length,o)}}},{key:"validate",value:function(o,s){return s>=0&&s<=11}},{key:"set",value:function(o,s,i){var a=o.getUTCHours()>=12;return a&&i<12?o.setUTCHours(i+12,0,0,0):o.setUTCHours(i,0,0,0),o}}]),n}(Ee),a8=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",70),X(Q(r),"incompatibleTokens",["a","b","h","H","K","t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){switch(s){case"k":return je(Xe.hour24h,o);case"ko":return i.ordinalNumber(o,{unit:"hour"});default:return Ge(s.length,o)}}},{key:"validate",value:function(o,s){return s>=1&&s<=24}},{key:"set",value:function(o,s,i){var a=i<=24?i%24:i;return o.setUTCHours(a,0,0,0),o}}]),n}(Ee),l8=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",60),X(Q(r),"incompatibleTokens",["t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){switch(s){case"m":return je(Xe.minute,o);case"mo":return i.ordinalNumber(o,{unit:"minute"});default:return Ge(s.length,o)}}},{key:"validate",value:function(o,s){return s>=0&&s<=59}},{key:"set",value:function(o,s,i){return o.setUTCMinutes(i,0,0),o}}]),n}(Ee),c8=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",50),X(Q(r),"incompatibleTokens",["t","T"]),r}return xe(n,[{key:"parse",value:function(o,s,i){switch(s){case"s":return je(Xe.second,o);case"so":return i.ordinalNumber(o,{unit:"second"});default:return Ge(s.length,o)}}},{key:"validate",value:function(o,s){return s>=0&&s<=59}},{key:"set",value:function(o,s,i){return o.setUTCSeconds(i,0),o}}]),n}(Ee),u8=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",30),X(Q(r),"incompatibleTokens",["t","T"]),r}return xe(n,[{key:"parse",value:function(o,s){var i=function(l){return Math.floor(l*Math.pow(10,-s.length+3))};return Ze(Ge(s.length,o),i)}},{key:"set",value:function(o,s,i){return o.setUTCMilliseconds(i),o}}]),n}(Ee),d8=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",10),X(Q(r),"incompatibleTokens",["t","T","x"]),r}return xe(n,[{key:"parse",value:function(o,s){switch(s){case"X":return Cn(kn.basicOptionalMinutes,o);case"XX":return Cn(kn.basic,o);case"XXXX":return Cn(kn.basicOptionalSeconds,o);case"XXXXX":return Cn(kn.extendedOptionalSeconds,o);case"XXX":default:return Cn(kn.extended,o)}}},{key:"set",value:function(o,s,i){return s.timestampIsSet?o:new Date(o.getTime()-i)}}]),n}(Ee),f8=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",10),X(Q(r),"incompatibleTokens",["t","T","X"]),r}return xe(n,[{key:"parse",value:function(o,s){switch(s){case"x":return Cn(kn.basicOptionalMinutes,o);case"xx":return Cn(kn.basic,o);case"xxxx":return Cn(kn.basicOptionalSeconds,o);case"xxxxx":return Cn(kn.extendedOptionalSeconds,o);case"xxx":default:return Cn(kn.extended,o)}}},{key:"set",value:function(o,s,i){return s.timestampIsSet?o:new Date(o.getTime()-i)}}]),n}(Ee),h8=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",40),X(Q(r),"incompatibleTokens","*"),r}return xe(n,[{key:"parse",value:function(o){return nv(o)}},{key:"set",value:function(o,s,i){return[new Date(i*1e3),{timestampIsSet:!0}]}}]),n}(Ee),p8=function(t){_e(n,t);var e=Te(n);function n(){var r;Ce(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=e.call.apply(e,[this].concat(s)),X(Q(r),"priority",20),X(Q(r),"incompatibleTokens","*"),r}return xe(n,[{key:"parse",value:function(o){return nv(o)}},{key:"set",value:function(o,s,i){return[new Date(i),{timestampIsSet:!0}]}}]),n}(Ee),m8={G:new AT,y:new RT,Y:new IT,R:new PT,u:new LT,Q:new zT,q:new BT,M:new FT,L:new VT,w:new qT,I:new WT,d:new YT,D:new GT,E:new JT,e:new XT,c:new ZT,i:new e8,a:new t8,b:new n8,B:new r8,h:new o8,H:new s8,K:new i8,k:new a8,m:new l8,s:new c8,S:new u8,X:new d8,x:new f8,t:new h8,T:new p8},g8=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,v8=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,y8=/^'([^]*?)'?$/,b8=/''/g,w8=/\S/,k8=/[a-zA-Z]/;function Pp(t,e,n,r){var o,s,i,a,l,c,u,d,f,p,h,v,y,w,x,$,S,_;oe(3,arguments);var E=String(t),D=String(e),N=Qn(),H=(o=(s=r==null?void 0:r.locale)!==null&&s!==void 0?s:N.locale)!==null&&o!==void 0?o:Z1;if(!H.match)throw new RangeError("locale must contain match property");var Y=Pe((i=(a=(l=(c=r==null?void 0:r.firstWeekContainsDate)!==null&&c!==void 0?c:r==null||(u=r.locale)===null||u===void 0||(d=u.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&l!==void 0?l:N.firstWeekContainsDate)!==null&&a!==void 0?a:(f=N.locale)===null||f===void 0||(p=f.options)===null||p===void 0?void 0:p.firstWeekContainsDate)!==null&&i!==void 0?i:1);if(!(Y>=1&&Y<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var re=Pe((h=(v=(y=(w=r==null?void 0:r.weekStartsOn)!==null&&w!==void 0?w:r==null||(x=r.locale)===null||x===void 0||($=x.options)===null||$===void 0?void 0:$.weekStartsOn)!==null&&y!==void 0?y:N.weekStartsOn)!==null&&v!==void 0?v:(S=N.locale)===null||S===void 0||(_=S.options)===null||_===void 0?void 0:_.weekStartsOn)!==null&&h!==void 0?h:0);if(!(re>=0&&re<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(D==="")return E===""?ne(n):new Date(NaN);var ce={firstWeekContainsDate:Y,weekStartsOn:re,locale:H},Ue=[new DT],et=D.match(v8).map(function(R){var Z=R[0];if(Z in Ku){var te=Ku[Z];return te(R,H.formatLong)}return R}).join("").match(g8),$e=[],Ae=Rp(et),qe;try{var Fe=function(){var Z=qe.value;!(r!=null&&r.useAdditionalWeekYearTokens)&&X1(Z)&&dl(Z,D,t),!(r!=null&&r.useAdditionalDayOfYearTokens)&&J1(Z)&&dl(Z,D,t);var te=Z[0],ze=m8[te];if(ze){var ut=ze.incompatibleTokens;if(Array.isArray(ut)){var kt=$e.find(function(zs){return ut.includes(zs.token)||zs.token===te});if(kt)throw new RangeError("The format string mustn't contain `".concat(kt.fullToken,"` and `").concat(Z,"` at the same time"))}else if(ze.incompatibleTokens==="*"&&$e.length>0)throw new RangeError("The format string mustn't contain `".concat(Z,"` and any other token at the same time"));$e.push({token:te,fullToken:Z});var gn=ze.run(E,Z,H.match,ce);if(!gn)return{v:new Date(NaN)};Ue.push(gn.setter),E=gn.rest}else{if(te.match(k8))throw new RangeError("Format string contains an unescaped latin alphabet character `"+te+"`");if(Z==="''"?Z="'":te==="'"&&(Z=C8(Z)),E.indexOf(Z)===0)E=E.slice(Z.length);else return{v:new Date(NaN)}}};for(Ae.s();!(qe=Ae.n()).done;){var We=Fe();if(rn(We)==="object")return We.v}}catch(R){Ae.e(R)}finally{Ae.f()}if(E.length>0&&w8.test(E))return new Date(NaN);var Oe=Ue.map(function(R){return R.priority}).sort(function(R,Z){return Z-R}).filter(function(R,Z,te){return te.indexOf(R)===Z}).map(function(R){return Ue.filter(function(Z){return Z.priority===R}).sort(function(Z,te){return te.subPriority-Z.subPriority})}).map(function(R){return R[0]}),ct=ne(n);if(isNaN(ct.getTime()))return new Date(NaN);var q=W1(ct,H1(ct)),z={},B=Rp(Oe),se;try{for(B.s();!(se=B.n()).done;){var ue=se.value;if(!ue.validate(q,ce))return new Date(NaN);var F=ue.set(q,z,ce);Array.isArray(F)?(q=F[0],_T(z,F[1])):q=F}}catch(R){B.e(R)}finally{B.f()}return q}function C8(t){return t.match(y8)[1].replace(b8,"'")}function Lp(t){oe(1,arguments);var e=ne(t);return e.setMinutes(0,0,0),e}function x8(t,e){oe(2,arguments);var n=Lp(t),r=Lp(e);return n.getTime()===r.getTime()}function S8(t,e){oe(2,arguments);var n=Mp(t),r=Mp(e);return n.getTime()===r.getTime()}function Gu(t,e){oe(2,arguments);var n=ne(t),r=ne(e);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()}function zp(t,e){oe(2,arguments);var n=ne(t),r=ne(e);return n.getFullYear()===r.getFullYear()}function _8(t,e){oe(2,arguments);var n=ne(t).getTime(),r=ne(e.start).getTime(),o=ne(e.end).getTime();if(!(r<=o))throw new RangeError("Invalid interval");return n>=r&&n<=o}function T8(t,e){oe(2,arguments);var n=ne(t),r=Pe(e),o=n.getFullYear(),s=n.getDate(),i=new Date(0);i.setFullYear(o,r,15),i.setHours(0,0,0,0);var a=TT(i);return n.setMonth(r,Math.min(s,a)),n}function Bp(t,e){if(oe(2,arguments),rn(e)!=="object"||e===null)throw new RangeError("values parameter must be an object");var n=ne(t);return isNaN(n.getTime())?new Date(NaN):(e.year!=null&&n.setFullYear(e.year),e.month!=null&&(n=T8(n,e.month)),e.date!=null&&n.setDate(Pe(e.date)),e.hours!=null&&n.setHours(Pe(e.hours)),e.minutes!=null&&n.setMinutes(Pe(e.minutes)),e.seconds!=null&&n.setSeconds(Pe(e.seconds)),e.milliseconds!=null&&n.setMilliseconds(Pe(e.milliseconds)),n)}function $8(t,e,n){var r,o,s,i,a,l,c,u;oe(2,arguments);var d=Qn(),f=Pe((r=(o=(s=(i=n==null?void 0:n.weekStartsOn)!==null&&i!==void 0?i:n==null||(a=n.locale)===null||a===void 0||(l=a.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&s!==void 0?s:d.weekStartsOn)!==null&&o!==void 0?o:(c=d.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var p=ne(t),h=Pe(e),v=p.getDay(),y=h%7,w=(y+7)%7,x=7-f,$=h<0||h>6?h-(v+x)%7:(w+x)%7-(v+x)%7;return P_(p,$)}function O8(t){oe(1,arguments);var e=ne(t),n=e.getFullYear(),r=Math.floor(n/10)*10;return e.setFullYear(r,0,1),e.setHours(0,0,0,0),e}function M8(t,e){oe(2,arguments);var n=Pe(e);return nf(t,-n)}function sv(t,e){oe(2,arguments);var n=Pe(e);return rf(t,-n)}function E8(){return Fd("datasets/licenses/")}async function N8(t,e,n,r,o){return(await ji.get("/datasets/"+t+"/resources/",{params:{page:n,type:e,page_size:r,q:o}})).data}async function D8(t,e,n){return(await Qe.get("datasets/community_resources/",{params:{page:e,dataset:t,page_size:n}})).data}function A8(){return Fd("datasets/extensions/")}const Zl=(t,e=0,n=!1)=>{let r;return(...o)=>{n&&!r&&t(...o),clearTimeout(r),r=setTimeout(()=>{t(...o)},e)}};function R8(t,e=0,n=!1){const r=T(t);return Vg((o,s)=>({get(){return o(),r.value},set:Zl(i=>{r.value=i,s()},e,n)}))}const I8="/_themes/gouvfr/assets/magnifying_glass.svg",P8=L({props:{actionsAlignment:{type:String,default:""},heading:{type:String,default:"h2"},icon:{type:String,required:!0},stretchHeight:{type:Boolean,default:!1},title:{type:String,required:!0},content:{type:String},type:{type:String,default:"default"}},setup(t){const e=O(()=>"fr-grid-row--".concat(Kb(t.actionsAlignment))),n=O(()=>t.type==="primary"?"bg-contrast-blue-cumulus":"bg-white"),r=O(()=>t.type==="primary"),o=O(()=>t.type==="default");return{alignment:e,isDefault:o,isPrimary:r,type:n}}}),L8={class:"fr-col-auto"},z8=["src"],B8={class:"fr-col-12 fr-col-sm fr-grid-row flex-direction-column justify-between"},F8={class:"fr-mb-1w"},V8={key:0,class:"fr-my-1w"};function H8(t,e,n,r,o,s){return b(),k("div",{class:ae(["rounded-xxs fr-p-3w fr-grid-row flex-direction-column",{"h-100":t.stretchHeight,[t.type]:t.type,"border border-default-grey":!t.isPrimary}])},[g("div",{class:ae(["fr-col fr-grid-row fr-grid-row--gutters",{"text-blue-400":t.isPrimary}])},[g("div",L8,[g("img",{class:"w-100",src:t.icon,alt:""},null,8,z8)]),g("div",B8,[g("div",F8,[(b(),j(to(t.heading),{class:ae(["fr-m-0 fr-mb-1w",{"fr-text--bold fr-text--md":t.isPrimary,"fr--h5":!t.isPrimary}])},{default:W(()=>[U(C(t.title),1)]),_:1},8,["class"])),t.content?(b(),k("p",V8,C(t.content),1)):Le(t.$slots,"default",{key:1})]),g("div",{class:ae(["fr-grid-row",t.alignment])},[Le(t.$slots,"actions")],2)])],2)],2)}const q8=ke(P8,[["render",H8]]),U8={class:"fr-mt-1v fr-mb-3v"},W8=["href"],pl=L({__name:"NoSearchResults",emits:["resetFilters"],setup(t){const{t:e}=be();return(n,r)=>(b(),j(q8,{title:m(e)("Didn't find what you are looking for?"),icon:m(I8),type:"primary"},{actions:W(()=>[g("button",{onClick:r[0]||(r[0]=o=>n.$emit("resetFilters")),class:"fr-btn fr-btn--secondary"},C(m(e)("Reset filters")),1),m(up)?(b(),k("a",{key:0,href:m(up),class:"fr-btn fr-btn--tertiary-no-outline fr-btn--icon-left fr-icon-lightbulb-line fr-ml-1w"},C(m(e)("Check our forum")),9,W8)):I("",!0)]),default:W(()=>[g("p",U8,[U(C(m(e)("Try resetting the filters to broaden your search.")),1),r[1]||(r[1]=g("br",null,null,-1)),U(" "+C(m(e)("You can also check ongoing requests and submit your own on our forum dedicated to data discovery and openness.")),1)])]),_:1},8,["title","icon"]))}}),j8={class:"fr-grid-row fr-mt-1w fr-mt-md-5v"},K8={class:"fr-col-12 fr-col-md-4 fr-col-lg-3"},Y8={class:"fr-sidemenu","aria-labelledby":"fr-sidemenu-title"},G8={class:"fr-sidemenu__inner"},J8={class:"fr-sidemenu__btn fr-mt-1w",hidden:"","aria-controls":"fr-sidemenu-wrapper","aria-expanded":"false"},X8={class:"fr-collapse",id:"fr-sidemenu-wrapper"},Z8={class:"fr-sidemenu__title fr-mb-3v",id:"fr-sidemenu-title"},Q8={class:"fr-grid-row fr-grid-row--gutters"},e6={key:0,class:"fr-col-12"},t6={class:"fr-col-12"},n6={class:"fr-col-12"},r6={class:"fr-col-12"},o6={class:"fr-col-12"},s6={class:"fr-col-12"},i6={class:"fr-col-12"},a6={key:1,class:"fr-col-12 fr-mb-3w text-align-center"},l6=["href"],c6={key:0,class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle justify-between fr-pb-1w"},u6={class:"fr-col-auto fr-my-0",role:"status"},d6={class:"fr-col-auto fr-grid-row fr-grid-row--middle"},f6={for:"sort-search",class:"fr-col-auto fr-text--sm fr-m-0 fr-mr-1w"},h6={class:"fr-col"},p6={value:""},m6=["value"],g6={key:0},v6={key:1},y6={class:"fr-mt-1w border-default-grey border-top relative z-2"},b6={key:2,class:"fr-mt-2w"},Uc=20,wa=!0,w6=!1,k6=L({inheritAttrs:!1,__name:"Search",props:{downloadLink:{default:""},disableFirstSearch:{type:Boolean,default:!1},organization:{default:""},sorts:{default:()=>[]}},setup(t){const e=t,{t:n}=be(),{toast:r}=sn(),o=new URL(window.location.href),s=new URLSearchParams(o.search),i=A8(),a=E8(),l=l1().filter(q=>q.type!==Kl&&q.type!==i1).map(q=>({label:q.label,value:q.type})),c=Promise.resolve(l),u=T(""),{reuseUrl:d}=F1(u),f=T(""),p=T([]),h=T(0),v=T(1),y=T({organization:e.organization}),w=T(!1),x=T(null),$=T(null),S=T(null),_=(q=wa)=>{let z=new URL(window.location.href);const B={...Fe.value};e.organization&&(delete B.organization,delete B.organization_badge),z.search=new URLSearchParams(B).toString(),q&&window.history.pushState(null,"",z);let se=document.querySelectorAll("[data-q]");for(let ue of se)ue.href=d.value},E=Zl((q=wa)=>{w.value=!0,x.value&&x.value.cancel(),x.value=Hl(),ji.get("/datasets/search/",{cancelToken:x.value.token,params:{...Fe.value,page_size:Uc}}).then(z=>z.data).then(z=>{p.value=z.data,h.value=z.total,w.value=!1,_(q)}).catch(z=>{xn.isCancel(z)||(r.error(n("Error getting search results.")),w.value=!1)})},Ou),D=q=>{u.value=q,v.value=1,E()},N=(q,z)=>{z?y.value[q]=z:y.value[q]=void 0,e.organization&&(y.value.organization=e.organization,y.value.organization_badge=void 0),v.value=1,E()},H=()=>{v.value=1,E()},Y=q=>{v.value=q,E(),re()},re=()=>{S.value&&S.value.scrollIntoView({behavior:"smooth"})},ce=({page:q=1,sort:z="",...B},se=wa)=>{y.value={...B,organization:e.organization||B.organization},v.value=q,f.value=z,E(se)},Ue=()=>{ce({})},et=()=>{$e(),re()},$e=({q="",...z}={},B=wa)=>{u.value=q,ce(z,B)},Ae=O(()=>Object.keys(y.value).some(z=>{var B;return((B=y.value[z])==null?void 0:B.length)&&(e.organization?z!=="organization":!0)})),qe=O(()=>e.sorts.map(q=>({value:q.order=="asc"?q.value:"-"+q.value,label:q.label}))),Fe=O(()=>{let q={},z;for(z in y.value){const B=y.value[z];B&&(q[z]=B)}return v.value>1&&(q.page=v.value.toString()),u.value&&(q.q=u.value),f.value&&(q.sort=f.value),q}),We=s.get("q");We&&(u.value=We,s.delete("q"));const Oe=s.get("page");Oe&&(v.value=parseInt(Oe),s.delete("page"));const ct=s.get("sort");return ct&&(f.value=ct,s.delete("sort")),y.value={...Object.fromEntries(s),organization:e.organization||s.get("organization")||""},e.disableFirstSearch?w.value=!0:E(),De(()=>{if(e.disableFirstSearch&&$.value){let q=$.value.dataset.totalResults;if(q&&parseInt(q)>0){let z=$.value.dataset.results;z&&(p.value=JSON.parse(z)),h.value=JSON.parse(q)}w.value=!1}addEventListener("popstate",()=>{const q=new URL(window.location.href),z={};for(const[B,se]of q.searchParams)z[B]=se;$e(z,w6)})}),(q,z)=>(b(),k("form",{class:"fr-pt-3v",onSubmit:z[9]||(z[9]=ye((...B)=>m(E)&&m(E)(...B),["prevent"]))},[g("div",{class:"fr-grid-row fr-grid-row--middle justify-between",ref_key:"searchRef",ref:S,"data-cy":"search"},[M(s_,{onChange:D,value:u.value,placeholder:m(n)("Ex. 2022 presidential election")},null,8,["value","placeholder"])],512),g("div",j8,[g("div",K8,[g("nav",Y8,[g("div",G8,[g("button",J8,C(m(n)("Filter results")),1),g("div",X8,[g("div",Z8,C(m(n)("Filters")),1),g("div",Q8,[t.organization?I("",!0):(b(),k("div",e6,[M(Ln,{placeholder:m(n)("Organizations"),searchPlaceholder:m(n)("Search an organization..."),allOption:m(n)("All organizations"),listUrl:"/organizations/?sort=-followers",suggestUrl:"/organizations/suggest/",entityUrl:"/organizations/",values:y.value.organization,onChange:z[0]||(z[0]=B=>N("organization",B)),isBlue:!0},null,8,["placeholder","searchPlaceholder","allOption","values"]),M(Ln,{initialOptions:m(c),placeholder:m(n)("Organization type"),searchPlaceholder:m(n)("Search an organization type..."),allOption:m(n)("All types"),values:y.value.organization_badge,onChange:z[1]||(z[1]=B=>N("organization_badge",B)),isBlue:!0},null,8,["initialOptions","placeholder","searchPlaceholder","allOption","values"])])),g("div",t6,[M(Ln,{placeholder:m(n)("Tags"),searchPlaceholder:m(n)("Search a tag..."),allOption:m(n)("All tags"),suggestUrl:"/tags/suggest/",values:y.value.tag,onChange:z[2]||(z[2]=B=>N("tag",B)),minimumCharacterBeforeSuggest:2,isBlue:!0},null,8,["placeholder","searchPlaceholder","allOption","values"])]),g("div",n6,[M(Ln,{placeholder:m(n)("Formats"),searchPlaceholder:m(n)("Search a format..."),allOption:m(n)("All formats"),listUrl:m(i),values:y.value.format,onChange:z[3]||(z[3]=B=>N("format",B)),isBlue:!0},null,8,["placeholder","searchPlaceholder","allOption","listUrl","values"])]),g("div",r6,[M(Ln,{placeholder:m(n)("Licenses"),explanation:m(n)("Licenses define reuse rules for published datasets. See page data.gouv.fr/licences"),searchPlaceholder:m(n)("Search a license..."),allOption:m(n)("All licenses"),listUrl:m(a),values:y.value.license,onChange:z[4]||(z[4]=B=>N("license",B)),isBlue:!0},null,8,["placeholder","explanation","searchPlaceholder","allOption","listUrl","values"])]),g("div",o6,[M(I_,{values:y.value.schema||"",onChange:z[5]||(z[5]=B=>N("schema",B)),isBlue:!0},null,8,["values"])]),g("div",s6,[M(Ln,{placeholder:m(n)("Spatial coverage"),explanation:m(n)("Geographic areas covered by data and for which they are relevant."),searchPlaceholder:m(n)("Search a spatial coverage..."),allOption:m(n)("All coverages"),suggestUrl:"/spatial/zones/suggest/",entityUrl:"/spatial/zone/",values:y.value.geozone,onChange:z[6]||(z[6]=B=>N("geozone",B)),isBlue:!0},null,8,["placeholder","explanation","searchPlaceholder","allOption","values"])]),g("div",i6,[M(Ln,{placeholder:m(n)("Spatial granularity"),explanation:m(n)("Finest level of geographic detail covered by data."),searchPlaceholder:m(n)("Search a granularity..."),allOption:m(n)("All granularities"),listUrl:"/spatial/granularities/",values:y.value.granularity,onChange:z[7]||(z[7]=B=>N("granularity",B)),isBlue:!0},null,8,["placeholder","explanation","searchPlaceholder","allOption","values"])]),Ae.value||t.downloadLink?(b(),k("div",a6,[Ae.value?(b(),k("button",{key:0,class:"fr-btn fr-btn--secondary fr-icon-close-circle-line fr-btn--icon-left justify-center w-100",onClick:Ue},C(m(n)("Reset filters")),1)):t.downloadLink?(b(),k("a",{key:1,class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500 fr-icon-download-line fr-btn--icon-left justify-center w-100 matomo_download",href:t.downloadLink},C(m(n)("Download list as CSV")),9,l6)):I("",!0)])):I("",!0)])])])])]),g("section",Tn({class:"fr-col-12 fr-col-md-8 fr-col-lg-9 fr-mt-2w fr-mt-md-0 search-results",ref_key:"resultsRef",ref:$},q.$attrs),[h.value?(b(),k("div",c6,[g("p",u6,C(m(n)("{count} results",h.value)),1),g("div",d6,[g("label",f6,C(m(n)("Sort by:")),1),g("div",h6,[nt(g("select",{id:"sort-search",class:"fr-select fr-select--blue",name:"sort","onUpdate:modelValue":z[8]||(z[8]=B=>f.value=B),onChange:H},[g("option",p6,C(m(n)("Relevance")),1),(b(!0),k(K,null,Ne(qe.value,({value:B,label:se})=>(b(),k("option",{value:B},C(se),9,m6))),256))],544),[[Ul,f.value]])])])])):I("",!0),M(Yi,{mode:"out-in"},{default:W(()=>[w.value?(b(),k("div",g6,[M(ef)])):p.value.length?(b(),k("div",v6,[g("ul",y6,[(b(!0),k(K,null,Ne(p.value,B=>(b(),k("li",{key:B.id},[M(V1,{dataset:B},null,8,["dataset"])]))),128))]),h.value>Uc?(b(),j(m(_o),{key:0,page:v.value,pageSize:Uc,totalResults:h.value,onChange:Y,class:"fr-mt-2w"},null,8,["page","totalResults"])):(b(),j(pl,{key:1,onResetFilters:et}))])):(b(),k("div",b6,[M(pl,{onResetFilters:et})]))]),_:1})],16)])],32))}}),C6=["disabled","aria-controls"],x6=["id"],S6={class:"fr-container fr-container--fluid fr-container-md"},_6={class:"fr-grid-row fr-grid-row--center"},T6={class:"fr-col-12 fr-col-md-8 fr-col-lg-6"},$6={class:"fr-modal__body"},O6={class:"fr-modal__header"},M6=["aria-controls"],E6={class:"fr-modal__content"},N6={class:"fr-modal__footer"},D6={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-reverse fr-btns-group--inline-lg fr-btns-group--icon-left"},A6=L({__name:"DeleteButton",props:{url:{}},setup(t){const e=t,{t:n}=be(),{toast:r}=sn(),o=Vl,s=xo("delete-modal"),i=s+"-title";function a(){return Wi(),Qe.delete(e.url).then(()=>window.location.reload()).catch(()=>r.error(n("An error occured during the deletion.")))}return(l,c)=>(b(),k(K,null,[g("button",{type:"button",class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-warning-425 fr-btn--icon-left fr-icon-delete-line",disabled:m(o),"data-fr-opened":"false","aria-controls":m(s)},C(m(n)("Delete")),9,C6),(b(),j(Pr,{to:"body"},[g("dialog",{"aria-labelledby":i,id:m(s),class:"fr-modal",role:"dialog"},[g("div",S6,[g("div",_6,[g("div",T6,[g("div",$6,[g("div",O6,[g("button",{class:"fr-btn--close fr-btn","aria-controls":m(s)},C(m(n)("Close")),9,M6)]),g("div",E6,[g("h1",{id:i,class:"fr-modal__title"},[c[0]||(c[0]=g("span",{class:"fr-icon-delete-line fr-icon--lg"},null,-1)),U(" "+C(m(n)("Are you sure ?")),1)]),g("p",null,C(m(n)("The content will be permanently deleted.")),1)]),g("div",N6,[g("div",D6,[g("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-warning-425 fr-btn--icon-left fr-icon-delete-line",role:"button",onClick:a},C(m(n)("Delete")),1)])])])])])])],8,x6)]))],64))}});function R6(t){return Qe.delete("users/".concat(t,"/"))}function I6(t){return Qe.delete("users/".concat(t,"/?no_mail=true&delete_comments=true"))}const P6=["disabled","aria-controls"],L6=["id"],z6={class:"fr-container fr-container--fluid fr-container-md"},B6={class:"fr-grid-row fr-grid-row--center"},F6={class:"fr-col-12 fr-col-md-8 fr-col-lg-6"},V6={class:"fr-modal__body"},H6={class:"fr-modal__header"},q6=["aria-controls"],U6={class:"fr-modal__content"},W6={class:"fr-grid-row fr-grid-row--middle fr-mb-2w"},j6={class:"avatar fr-mr-1w"},K6=["src"],Y6={class:"fr-modal__footer"},G6={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-reverse fr-btns-group--inline-lg fr-btns-group--icon-left"},J6=L({__name:"DeleteUserButton",props:{id:{},full_name:{},avatar_thumbnail:{}},setup(t){const e=t,{t:n}=be(),{toast:r}=sn(),o=Vl,s=xo("delete-modal"),i=s+"-title";function a(){return R6(e.id).then(()=>window.location.reload()).catch(()=>r.error(n("An error occured during the deletion.")))}function l(){return I6(e.id).then(()=>window.location.reload()).catch(()=>r.error(n("An error occured during the deletion.")))}return(c,u)=>(b(),k(K,null,[g("button",{type:"button",class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-warning-425 fr-btn--icon-left fr-icon-delete-line",disabled:m(o),"data-fr-opened":"false","aria-controls":m(s)},C(m(n)("Delete")),9,P6),(b(),j(Pr,{to:"body"},[g("dialog",{"aria-labelledby":i,id:m(s),class:"fr-modal",role:"dialog"},[g("div",z6,[g("div",B6,[g("div",F6,[g("div",V6,[g("div",H6,[g("button",{class:"fr-btn--close fr-btn","aria-controls":m(s)},C(m(n)("Close")),9,q6)]),g("div",U6,[g("h1",{id:i,class:"fr-modal__title"},[u[0]||(u[0]=g("span",{class:"fr-icon-delete-line fr-icon--lg"},null,-1)),U(" "+C(m(n)("Are you sure ?")),1)]),g("p",W6,[g("div",j6,[g("img",{class:"rounded-circle border border-default-grey",src:e.avatar_thumbnail,width:"40",height:"40",loading:"lazy",alt:""},null,8,K6)]),U(" "+C(e.full_name)+" "+C(m(n)("will be permanently deleted.")),1)])]),g("div",Y6,[g("div",G6,[g("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-warning-425 fr-btn--icon-left fr-icon-delete-line",role:"button",onClick:l},C(m(n)("Delete without as spam (no mail sent and discussions are deleted)")),1),g("button",{class:"fr-btn bg-warning-425 fr-btn--icon-left fr-icon-delete-line",role:"button",onClick:a},C(m(n)("Delete")),1)])])])])])])],8,L6)]))],64))}}),X6=L({name:"featured-button",props:{subjectId:{type:String,required:!0},subjectType:{type:String,required:!0},featured:{type:Boolean,required:!0}},setup(t){const{t:e}=be(),{toast:n}=sn(),r=T(t.featured),o=T(null),s=()=>{const i=r.value?"delete":"post",a="".concat(t.subjectType.toLowerCase(),"s/").concat(t.subjectId,"/featured/");Qe[i](a).then(l=>{r.value=!r.value}).catch(()=>n.error(e("An error occurred while featuring this subject.")))};return De(()=>{var i;return(i=o.value)==null?void 0:i.toggleAttribute("checked",r.value)}),{isFeatured:r,t:e,toggleFeatured:s,toggleInput:o}}}),Z6={class:"fr-toggle fr-toggle--label-left"},Q6=["checked"],e$=["data-fr-checked-label","data-fr-unchecked-label"];function t$(t,e,n,r,o,s){return b(),k("div",Z6,[g("input",{ref:"toggleInput",onClick:e[0]||(e[0]=(...i)=>t.toggleFeatured&&t.toggleFeatured(...i)),type:"checkbox",class:"fr-toggle__input",id:"featured-toggle",checked:t.isFeatured},null,8,Q6),g("label",{class:"fr-toggle__label",for:"featured-toggle","data-fr-checked-label":t.t("Featured"),"data-fr-unchecked-label":t.t("Standard")},C(t.t("Feature this content")),9,e$)])}const n$=ke(X6,[["render",t$]]),r$=L({props:{followers:Number,url:{type:String,required:!0},following:Boolean},setup(t){const e=T(!1),n=T(t.following),r=qr.read_only_enabled;return{following:n,animating:e,readOnlyEnabled:r,toggleFollow:()=>{Wi();let s;n.value?s=Qe.delete(t.url):s=Qe.post(t.url),s.then(()=>{n.value=!n.value,n.value&&(e.value=!0,setTimeout(()=>e.value=!1,1300))})}}}}),o$=["disabled"],s$={class:"fr-ml-1w"};function i$(t,e,n,r,o,s){return b(),k("button",{onClick:e[0]||(e[0]=ye((...i)=>t.toggleFollow&&t.toggleFollow(...i),["prevent"])),type:"button",class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 follow-button",disabled:t.readOnlyEnabled},[g("span",{class:ae(["magic fr-grid-row",{active:t.animating}]),style:Ts({color:t.following?"inherit":"transparent"})},[...e[1]||(e[1]=[g("svg",{"aria-hidden":"true",width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},[g("path",{d:"M7.20703 1.24224L5.42968 4.87896L1.41015 5.45318C0.699214 5.56255 0.425776 6.43755 0.945308 6.95709L3.8164 9.77349L3.13281 13.7383C3.02343 14.4493 3.78906 14.9961 4.41796 14.668L8 12.7813L11.5547 14.668C12.1836 14.9961 12.9492 14.4493 12.8398 13.7383L12.1562 9.77349L15.0273 6.95709C15.5469 6.43755 15.2734 5.56255 14.5625 5.45318L10.5703 4.87896L8.76562 1.24224C8.46484 0.613336 7.53515 0.585992 7.20703 1.24224Z",stroke:"#161616"})],-1)])],6),g("span",s$,[t.following?(b(),k(K,{key:0},[U(C(t.$t("Remove from favourites")),1)],64)):(b(),k(K,{key:1},[U(C(t.$t("Add to favourites")),1)],64))])],8,o$)}const a$=ke(r$,[["render",i$]]),l$=L({props:{organization:{type:String,required:!0}},setup(t){const{t:e}=be(),n=T("");return{askToJoinOrganization:()=>{Wi(),n.value=prompt(e("You can add some details here for your membership request"))||"",Qe.post("organizations/"+t.organization+"/membership/",{comment:n.value}).then(o=>{alert(e("A request has been sent to the administrators")),window.location.reload()}).catch(o=>{alert(e("Error while requesting membership")),console.error(o)})},comment:n}}});function c$(t,e,n,r,o,s){return b(),k("button",{onClick:e[0]||(e[0]=ye((...i)=>t.askToJoinOrganization&&t.askToJoinOrganization(...i),["prevent"])),class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500 fr-btn--icon-left fr-icon-team-line"},C(t.$t("Ask to join the organization as a producer")),1)}const u$=ke(l$,[["render",c$]]);ql(["pdf","doc","docx","word","xls","excel","xlsx"]);const vs=/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/i,d$=new RegExp("/resources/("+vs.source+")?$",vs.flags),f$=new RegExp("/resource-("+vs.source+")?$",vs.flags),h$=new RegExp("/community-resources/("+vs.source+")?$",vs.flags),iv=(t,e)=>{for(const n of e?[h$]:[d$,f$]){let[r,o,s]=n.exec(t)||[];if(o)return o}return null};function av(){const t=T(window.location.hash),e=()=>t.value=window.location.hash;return De(()=>window.addEventListener("hashchange",e)),fn(()=>window.removeEventListener("hashchange",e)),{hash:t}}function Fp(){history.pushState(null,""," "),window.dispatchEvent(new HashChangeEvent("hashchange"))}const p$={key:0},m$={key:1},g$={class:"fr-grid-row fr-grid-row--middle justify-between"},v$={key:0},y$={key:1},b$=L({__name:"resourceFromHash",props:{canEdit:{type:Boolean},datasetId:{},communityResource:{type:Boolean,default:!1}},setup(t){const e=t,{t:n}=be(),{toast:r}=sn(),o=T(null),s=T(null),i=T(!1),{hash:a}=av(),l=O(()=>iv(a.value,e.communityResource)),c=O(()=>e.communityResource?"/datasets/community_resources/".concat(l.value):"/datasets/".concat(e.datasetId,"/resources/").concat(l.value));return bt(async()=>{if(l.value){i.value=!0;try{const d=await(await Qe.get(c.value)).data;d&&(s.value=d,o.value&&o.value.scrollIntoView())}catch(u){console.error(u),r.error(n("An error occurred while fetching the file ")+l.value)}finally{i.value=!1}}}),(u,d)=>l.value?(b(),k("section",{key:0,ref_key:"top",ref:o},[M(Yi,{mode:"out-in"},{default:W(()=>[i.value?(b(),k("div",p$,[M(m(z1))])):(b(),k("div",m$,[M(m(cl),{type:"secondary",color:"success",class:"fr-mb-2w"},{default:W(()=>[g("div",g$,[t.communityResource?(b(),k("span",v$,C(m(n)("You are seeing a specific community resource of this dataset")),1)):(b(),k("span",y$,C(m(n)("You are seeing a specific file of this dataset")),1)),g("button",{class:"fr-btn--close fr-btn fr-mr-0",onClick:d[0]||(d[0]=ye((...f)=>m(Fp)&&m(Fp)(...f),["prevent"]))},C(m(n)("Close")),1)])]),_:1}),s.value?(b(),j(m(L1),{key:0,id:"resource-"+l.value,datasetId:t.datasetId,expandedOnMount:!0,resource:s.value,canEdit:t.canEdit,isCommunityResource:t.communityResource},null,8,["id","datasetId","resource","canEdit","isCommunityResource"])):I("",!0)]))]),_:1})],512)):I("",!0)}}),lv=L({__name:"Reuse",props:{reuse:{}},setup(t){return(e,n)=>{var r;return b(),j(m(rS),{reuse:t.reuse,reuseUrl:t.reuse.page,organizationUrl:(r=t.reuse.organization)==null?void 0:r.page},null,8,["reuse","reuseUrl","organizationUrl"])}}});function w$(t){return{all:t=t||new Map,on:function(e,n){var r=t.get(e);r?r.push(n):t.set(e,[n])},off:function(e,n){var r=t.get(e);r&&(n?r.splice(r.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var r=t.get(e);r&&r.slice().map(function(o){o(n)}),(r=t.get("*"))&&r.slice().map(function(o){o(e,n)})}}}const Ju="resourcesSearch",lf=w$(),k$=t=>{t.config.globalProperties.$bus=lf},C$=L({props:{eventName:{type:String,default:Ju},type:{type:String}},setup(t){const e=R8("",Ou),n=()=>{lf.emit(t.eventName,{type:t.type,value:e.value})};Yb&&He(e,n);let r;const o=()=>{r=setTimeout(()=>{n()},Ou)};return fn(()=>clearTimeout(r)),{search:n,searchWithoutAutocomplete:o,searchValue:e}}}),x$=["aria-label"],S$=["for"],_$=["id"],T$={class:"fr-btn",type:"submit"};function $$(t,e,n,r,o,s){return b(),k("form",{onSubmit:e[1]||(e[1]=ye((...i)=>t.searchWithoutAutocomplete&&t.searchWithoutAutocomplete(...i),["prevent"]))},[g("div",{class:"fr-search-bar",role:"search","aria-label":t.$t("Search files")},[g("label",{class:"fr-label",for:t.eventName},C(t.$t("Search files")),9,S$),nt(g("input",{class:"fr-input",placeholder:"Rechercher",type:"search",id:t.eventName,"onUpdate:modelValue":e[0]||(e[0]=i=>t.searchValue=i)},null,8,_$),[[Nr,t.searchValue]]),g("button",T$,C(t.$t("Search")),1)],8,x$)],32)}const O$=ke(C$,[["render",$$]]),M$={class:"fr-grid-row"},E$={class:"fr-col"},N$={key:0,class:"fr-col-auto"},D$=["href"],A$={key:0,class:"fr-my-3v"},R$={key:0},I$={key:1,class:"flex flex-direction-column gap-10px"},P$={key:0,class:"fr-my-0 fr-text--sm border-bottom",role:"status"},L$={key:1},Vp=!1,z$=L({__name:"resources",props:{canEdit:{type:Boolean,default:!1},canEditResources:{default:()=>({})},datasetId:{},showTotal:{type:Boolean,default:!0},type:{},typeLabel:{},firstGroup:{type:Boolean,default:!0}},setup(t){var N;const e=t,{t:n}=be(),{toast:r}=sn(),o=T(1),{hash:s}=av(),i=O(()=>iv(s.value,e.type==="community")),a=T([]),l=qr.resources_default_page_size,c=new URL((N=qr.admin_root)!=null&&N.startsWith("http")?qr.admin_root:"".concat(document.location.origin).concat(qr.admin_root,"community-resource/new/")),u=new URLSearchParams({dataset_id:e.datasetId});c.search=u.toString();const d=c.toString(),f=T(0),p=T(0),h=T(!0),v=T(null),y=T(""),w=T(e.type==="community"),x=O(()=>!w.value&&f.value>qr.resources_min_count_to_show_search),$=O(()=>f.value!=p.value),S=(H=1,Y=!1)=>{h.value=!0,Y&&v.value&&v.value.scrollIntoView({behavior:"smooth"});let re;return w.value?re=D8(e.datasetId,H,l):re=N8(e.datasetId,e.type,H,l,y.value),re.then(ce=>(ce.data&&(a.value=ce.data,p.value=ce.total),ce.total||0)).catch(()=>(r.error(n("An error occurred while fetching resources")),a.value=[],0)).finally(()=>{h.value=!1})},_=(H,Y=!0)=>(o.value=H,S(H,Y)),E=H=>e.canEdit?e.canEdit:e.canEditResources[H.id];w.value||lf.on(Ju,({type:H,value:Y})=>{H===e.type&&(y.value=Y,_(1,Vp))});const D=()=>{_(1,Vp).then(H=>f.value=H)};return De(()=>D()),(H,Y)=>i.value?I("",!0):(b(),k("section",{key:0,class:"fr-mb-3v",ref_key:"top",ref:v},[g("div",M$,[g("div",E$,[g("h2",{class:ae([{"fr-mt-4w":!t.firstGroup},"fr-mb-0 subtitle subtitle--uppercase"])},C(t.typeLabel),3)]),w.value?(b(),k("div",N$,[g("a",{class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 fr-icon-add-line fr-btn--icon-left",href:m(d)},C(m(n)("Add a community resource")),9,D$)])):I("",!0)]),x.value?(b(),k("div",A$,[M(O$,{eventName:m(Ju),type:t.type},null,8,["eventName","type"])])):I("",!0),M(Yi,{mode:"out-in"},{default:W(()=>[h.value?(b(),k("div",R$,[(b(!0),k(K,null,Ne(m(l),re=>(b(),j(m(z1),{class:"fr-mt-2w"}))),256))])):(b(),k("div",I$,[$.value?(b(),k("p",P$,C(m(n)("{count} results",p.value)),1)):I("",!0),(b(!0),k(K,null,Ne(a.value,re=>(b(),j(m(L1),{id:"resource-"+re.id,datasetId:t.datasetId,isCommunityResource:w.value,resource:re,canEdit:E(re)},null,8,["id","datasetId","isCommunityResource","resource","canEdit"]))),256)),p.value?p.value>m(l)?(b(),j(m(_o),{key:2,class:"fr-mt-3w",page:o.value,"page-size":m(l),"total-results":p.value,onChange:_},null,8,["page","page-size","total-results"])):I("",!0):(b(),k("p",L$,C(m(n)("No files match your search.")),1))]))]),_:1})],512))}});const B$=ke(z$,[["__scopeId","data-v-4aa480fc"]]),F$={key:0},V$=20,H$=L({__name:"CardList",props:{datasets:{},loading:{type:Boolean,default:!1},totalResults:{},pageSize:{default:V$}},emits:["changePage"],setup(t,{emit:e}){const n=e,r=T(1),o=T();function s(){o.value&&o.value.scrollIntoView({behavior:"smooth"})}function i(a){r.value=a,n("changePage",a),s()}return(a,l)=>t.loading?(b(),k("div",F$,[M(ef)])):t.totalResults?(b(),k(K,{key:1},[g("ul",{ref_key:"listRef",ref:o},[(b(!0),k(K,null,Ne(t.datasets,c=>(b(),k("li",{key:c.id},[M(V1,{dataset:c},null,8,["dataset"])]))),128))],512),t.totalResults>t.pageSize?(b(),j(m(_o),{key:0,page:r.value,pageSize:t.pageSize,totalResults:t.totalResults,onChange:i,class:"fr-mt-2w"},null,8,["page","pageSize","totalResults"])):I("",!0)],64)):I("",!0)}}),q$={key:0,class:"subtitle subtitle--uppercase fr-mb-5v"},U$=L({__name:"UserDatasetList",props:{owner:{}},setup(t){const{t:e}=be(),{toast:n}=sn(),r=t,o=T([]),s=T(0),i=T(!1),a=T(null),l=3;function c(u){i.value=!0,a.value&&a.value.cancel(),a.value=Hl(),ji.get("/datasets/search/",{cancelToken:a.value.token,params:{page:u,owner:r.owner,page_size:l}}).then(d=>d.data).then(d=>{o.value=d.data,s.value=d.total,i.value=!1}).catch(d=>{xn.isCancel(d)||(n.error(e("Error getting search results.")),i.value=!1)})}return De(()=>{c(1)}),(u,d)=>(b(),k(K,null,[s.value?(b(),k("h2",q$,C(m(e)("{n} datasets",s.value)),1)):I("",!0),M(H$,{"page-size":l,datasets:o.value,loading:i.value,"total-results":s.value,onChangePage:c},null,8,["datasets","loading","total-results"])],64))}}),W$={components:{ContentLoader:Gi}};function j$(t,e,n,r,o,s){const i=Je("ContentLoader");return b(),j(i,{width:350,height:180,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},{default:W(()=>[...e[0]||(e[0]=[g("rect",{x:"43",y:"153",rx:"3",ry:"3",width:"97",height:"6"},null,-1),g("rect",{x:"44",y:"166",rx:"3",ry:"3",width:"97",height:"5"},null,-1),g("rect",{x:"184",y:"7",rx:"5",ry:"5",width:"130",height:"130"},null,-1),g("rect",{x:"198",y:"153",rx:"3",ry:"3",width:"97",height:"6"},null,-1),g("rect",{x:"199",y:"166",rx:"3",ry:"3",width:"97",height:"5"},null,-1),g("rect",{x:"27",y:"8",rx:"5",ry:"5",width:"130",height:"130"},null,-1)])]),_:1})}const K$=ke(W$,[["render",j$]]),Y$={key:0},G$=20,J$=L({__name:"ReuseList",props:{reuses:{},loading:{type:Boolean,default:!1},totalResults:{},pageSize:{default:G$}},emits:["changePage"],setup(t,{emit:e}){const n=e,r=T(1),o=T();function s(){o.value&&o.value.scrollIntoView({behavior:"smooth"})}function i(a){r.value=a,n("changePage",a),s()}return(a,l)=>t.loading?(b(),k("div",Y$,[M(K$)])):t.totalResults?(b(),k(K,{key:1},[g("ul",{ref_key:"listRef",ref:o,class:"fr-grid-row fr-grid-row--gutters"},[(b(!0),k(K,null,Ne(t.reuses,c=>(b(),k("li",{class:ae(["fr-col-12",{"fr-col-md-6":t.reuses.length<=2,"fr-col-md-4":t.reuses.length>=3}]),key:c.id},[M(lv,{reuse:c},null,8,["reuse"])],2))),128))],512),t.totalResults>t.pageSize?(b(),j(m(_o),{key:0,page:r.value,pageSize:t.pageSize,totalResults:t.totalResults,onChange:i,class:"fr-mt-2w"},null,8,["page","pageSize","totalResults"])):I("",!0)],64)):I("",!0)}}),X$={key:0,class:"subtitle subtitle--uppercase fr-mb-5v"},Z$=L({__name:"UserReuseList",props:{owner:{}},setup(t){const{t:e}=be(),{toast:n}=sn(),r=t,o=T([]),s=T(0),i=T(!1),a=T(null),l=6;function c(u){i.value=!0,a.value&&a.value.cancel(),a.value=Hl(),ji.get("/reuses/search/",{cancelToken:a.value.token,params:{page:u,owner:r.owner,page_size:l}}).then(d=>d.data).then(d=>{o.value=d.data,s.value=d.total,i.value=!1}).catch(d=>{xn.isCancel(d)||(n.error(e("Error getting search results.")),i.value=!1)})}return De(()=>{c(1)}),(u,d)=>(b(),k(K,null,[s.value?(b(),k("h2",X$,C(m(e)("{n} reuses",s.value)),1)):I("",!0),M(J$,{"page-size":l,reuses:o.value,loading:i.value,"total-results":s.value,onChangePage:c},null,8,["reuses","loading","total-results"])],64))}}),Q$={key:0,class:"border border-blue-400 fr-p-2w bg-alt-grey"},eO={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},tO={class:"fr-col-12 fr-col-sm"},nO={class:"fr-h6 fr-mb-0 text-blue-400"},rO={class:"fr-col-auto flex"},oO=["href"],sO=["href"],iO=["href"],aO={key:1,class:"border border-blue-400 fr-p-2w fr-dataservice__box fr-dataservice__swagger"},lO={class:"fr-h6 fr-mb-0 text-blue-400"},cO={class:"flex items-center fr-ml-4v"},uO={key:0},dO=L({__name:"DataserviceLinks",props:{dataservice:{}},setup(t){const e=t,{t:n}=be(),r=T(!1),o=T(!1),s=Ug(()=>dr(()=>import("./Swagger.6.2.4.js"),["js/Swagger.6.2.4.js","js/_commonjsHelpers.6.2.4.js","js/i18n.6.2.4.js"])),i=()=>{r.value=!r.value};function a(l){return l.endsWith(".json")||l.endsWith(".yaml")||l.endsWith(".yml")}return De(async()=>{e.dataservice.machine_documentation_url&&(o.value=a(e.dataservice.machine_documentation_url))}),(l,c)=>(b(),k("div",null,[!o.value&&t.dataservice.machine_documentation_url||t.dataservice.technical_documentation_url||t.dataservice.business_documentation_url?(b(),k("div",Q$,[g("div",eO,[g("div",tO,[g("h2",nO,C(m(n)("API documentation")),1)]),g("div",rO,[t.dataservice.technical_documentation_url?(b(),k("a",{key:0,class:"fr-btn fr-ml-3v",href:t.dataservice.technical_documentation_url,target:"_blank",rel:"ugc nofollow noopener"},C(m(n)("Technical documentation")),9,oO)):I("",!0),!o.value&&t.dataservice.machine_documentation_url?(b(),k("a",{key:1,class:"fr-btn fr-ml-3v",href:t.dataservice.machine_documentation_url,target:"_blank",rel:"ugc nofollow noopener"},C(m(n)("Machine readable documentation")),9,sO)):I("",!0),t.dataservice.business_documentation_url?(b(),k("a",{key:2,class:ae(["fr-btn fr-ml-3v",o.value?"":"fr-btn--secondary"]),href:t.dataservice.business_documentation_url,target:"_blank",rel:"ugc nofollow noopener"},C(m(n)("Business documentation")),11,iO)):I("",!0)])])])):I("",!0),c[0]||(c[0]=g("br",null,null,-1)),o.value?(b(),k("div",aO,[g("header",{class:"fr-p-2v flex items-center justify-between",onClick:i},[g("h2",lO,C(m(n)("Swagger")),1),g("div",cO,[g("div",{class:ae(["fr-icon--sm fr-ml-4v",{"fr-icon-arrow-up-s-line":r.value,"fr-icon-arrow-down-s-line":!r.value}])},null,2)])]),r.value&&t.dataservice.machine_documentation_url?(b(),k("div",uO,[M(m(s),{url:t.dataservice.machine_documentation_url},null,8,["url"])])):I("",!0)])):I("",!0)]))}});const fO=ke(dO,[["__scopeId","data-v-67dee39c"]]),hO=document.querySelectorAll("[data-tabs]");hO.forEach(t=>{const e=t.querySelectorAll("[role=tab]");e.forEach(n=>{n.addEventListener("click",r=>{var a,l,c;r.preventDefault();const o=r.target,s=Array.from(e).find(u=>u.getAttribute("aria-selected")==="true");if(s){s.setAttribute("aria-selected","false");const u=s.getAttribute("aria-controls")||"";(a=document.getElementById(u))==null||a.classList.remove("fr-unhidden")}const i=o.getAttribute("aria-controls")||"";o.setAttribute("aria-selected","true"),(l=document.getElementById(i))==null||l.classList.add("fr-unhidden"),(c=globalThis._paq)==null||c.push(["trackEvent","Move page to tab",window.location.pathname,n.textContent])})})});const pO=document.querySelectorAll("[data-accordion-button]");pO.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();const n=e.target;if(n instanceof HTMLElement){n.toggleAttribute("aria-expanded");const r=document.querySelector("#"+n.getAttribute("aria-controls"));r&&(r.classList.toggle("active"),s1(r,n.hasAttribute("aria-expanded")))}})});var cv={exports:{}};/*!
 * clipboard.js v2.0.11
 * https://clipboardjs.com/
 *
 * Licensed MIT  Zeno Rocha
 */(function(t,e){(function(r,o){t.exports=o()})(Cw,function(){return function(){var n={686:function(s,i,a){a.d(i,{default:function(){return ct}});var l=a(279),c=a.n(l),u=a(370),d=a.n(u),f=a(817),p=a.n(f);function h(q){try{return document.execCommand(q)}catch(z){return!1}}var v=function(z){var B=p()(z);return h("cut"),B},y=v;function w(q){var z=document.documentElement.getAttribute("dir")==="rtl",B=document.createElement("textarea");B.style.fontSize="12pt",B.style.border="0",B.style.padding="0",B.style.margin="0",B.style.position="absolute",B.style[z?"right":"left"]="-9999px";var se=window.pageYOffset||document.documentElement.scrollTop;return B.style.top="".concat(se,"px"),B.setAttribute("readonly",""),B.value=q,B}var x=function(z,B){var se=w(z);B.container.appendChild(se);var ue=p()(se);return h("copy"),se.remove(),ue},$=function(z){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body},se="";return typeof z=="string"?se=x(z,B):z instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(z==null?void 0:z.type)?se=x(z.value,B):(se=p()(z),h("copy")),se},S=$;function _(q){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_=function(B){return typeof B}:_=function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},_(q)}var E=function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},B=z.action,se=B===void 0?"copy":B,ue=z.container,F=z.target,R=z.text;if(se!=="copy"&&se!=="cut")throw new Error('Invalid "action" value, use either "copy" or "cut"');if(F!==void 0)if(F&&_(F)==="object"&&F.nodeType===1){if(se==="copy"&&F.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if(se==="cut"&&(F.hasAttribute("readonly")||F.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes')}else throw new Error('Invalid "target" value, use a valid Element');if(R)return S(R,{container:ue});if(F)return se==="cut"?y(F):S(F,{container:ue})},D=E;function N(q){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?N=function(B){return typeof B}:N=function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},N(q)}function H(q,z){if(!(q instanceof z))throw new TypeError("Cannot call a class as a function")}function Y(q,z){for(var B=0;B<z.length;B++){var se=z[B];se.enumerable=se.enumerable||!1,se.configurable=!0,"value"in se&&(se.writable=!0),Object.defineProperty(q,se.key,se)}}function re(q,z,B){return z&&Y(q.prototype,z),B&&Y(q,B),q}function ce(q,z){if(typeof z!="function"&&z!==null)throw new TypeError("Super expression must either be null or a function");q.prototype=Object.create(z&&z.prototype,{constructor:{value:q,writable:!0,configurable:!0}}),z&&Ue(q,z)}function Ue(q,z){return Ue=Object.setPrototypeOf||function(se,ue){return se.__proto__=ue,se},Ue(q,z)}function et(q){var z=qe();return function(){var se=Fe(q),ue;if(z){var F=Fe(this).constructor;ue=Reflect.construct(se,arguments,F)}else ue=se.apply(this,arguments);return $e(this,ue)}}function $e(q,z){return z&&(N(z)==="object"||typeof z=="function")?z:Ae(q)}function Ae(q){if(q===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return q}function qe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(q){return!1}}function Fe(q){return Fe=Object.setPrototypeOf?Object.getPrototypeOf:function(B){return B.__proto__||Object.getPrototypeOf(B)},Fe(q)}function We(q,z){var B="data-clipboard-".concat(q);if(z.hasAttribute(B))return z.getAttribute(B)}var Oe=function(q){ce(B,q);var z=et(B);function B(se,ue){var F;return H(this,B),F=z.call(this),F.resolveOptions(ue),F.listenClick(se),F}return re(B,[{key:"resolveOptions",value:function(){var ue=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.action=typeof ue.action=="function"?ue.action:this.defaultAction,this.target=typeof ue.target=="function"?ue.target:this.defaultTarget,this.text=typeof ue.text=="function"?ue.text:this.defaultText,this.container=N(ue.container)==="object"?ue.container:document.body}},{key:"listenClick",value:function(ue){var F=this;this.listener=d()(ue,"click",function(R){return F.onClick(R)})}},{key:"onClick",value:function(ue){var F=ue.delegateTarget||ue.currentTarget,R=this.action(F)||"copy",Z=D({action:R,container:this.container,target:this.target(F),text:this.text(F)});this.emit(Z?"success":"error",{action:R,text:Z,trigger:F,clearSelection:function(){F&&F.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(ue){return We("action",ue)}},{key:"defaultTarget",value:function(ue){var F=We("target",ue);if(F)return document.querySelector(F)}},{key:"defaultText",value:function(ue){return We("text",ue)}},{key:"destroy",value:function(){this.listener.destroy()}}],[{key:"copy",value:function(ue){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body};return S(ue,F)}},{key:"cut",value:function(ue){return y(ue)}},{key:"isSupported",value:function(){var ue=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["copy","cut"],F=typeof ue=="string"?[ue]:ue,R=!!document.queryCommandSupported;return F.forEach(function(Z){R=R&&!!document.queryCommandSupported(Z)}),R}}]),B}(c()),ct=Oe},828:function(s){var i=9;if(typeof Element<"u"&&!Element.prototype.matches){var a=Element.prototype;a.matches=a.matchesSelector||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector||a.webkitMatchesSelector}function l(c,u){for(;c&&c.nodeType!==i;){if(typeof c.matches=="function"&&c.matches(u))return c;c=c.parentNode}}s.exports=l},438:function(s,i,a){var l=a(828);function c(f,p,h,v,y){var w=d.apply(this,arguments);return f.addEventListener(h,w,y),{destroy:function(){f.removeEventListener(h,w,y)}}}function u(f,p,h,v,y){return typeof f.addEventListener=="function"?c.apply(null,arguments):typeof h=="function"?c.bind(null,document).apply(null,arguments):(typeof f=="string"&&(f=document.querySelectorAll(f)),Array.prototype.map.call(f,function(w){return c(w,p,h,v,y)}))}function d(f,p,h,v){return function(y){y.delegateTarget=l(y.target,p),y.delegateTarget&&v.call(f,y)}}s.exports=u},879:function(s,i){i.node=function(a){return a!==void 0&&a instanceof HTMLElement&&a.nodeType===1},i.nodeList=function(a){var l=Object.prototype.toString.call(a);return a!==void 0&&(l==="[object NodeList]"||l==="[object HTMLCollection]")&&"length"in a&&(a.length===0||i.node(a[0]))},i.string=function(a){return typeof a=="string"||a instanceof String},i.fn=function(a){var l=Object.prototype.toString.call(a);return l==="[object Function]"}},370:function(s,i,a){var l=a(879),c=a(438);function u(h,v,y){if(!h&&!v&&!y)throw new Error("Missing required arguments");if(!l.string(v))throw new TypeError("Second argument must be a String");if(!l.fn(y))throw new TypeError("Third argument must be a Function");if(l.node(h))return d(h,v,y);if(l.nodeList(h))return f(h,v,y);if(l.string(h))return p(h,v,y);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function d(h,v,y){return h.addEventListener(v,y),{destroy:function(){h.removeEventListener(v,y)}}}function f(h,v,y){return Array.prototype.forEach.call(h,function(w){w.addEventListener(v,y)}),{destroy:function(){Array.prototype.forEach.call(h,function(w){w.removeEventListener(v,y)})}}}function p(h,v,y){return c(document.body,h,v,y)}s.exports=u},817:function(s){function i(a){var l;if(a.nodeName==="SELECT")a.focus(),l=a.value;else if(a.nodeName==="INPUT"||a.nodeName==="TEXTAREA"){var c=a.hasAttribute("readonly");c||a.setAttribute("readonly",""),a.select(),a.setSelectionRange(0,a.value.length),c||a.removeAttribute("readonly"),l=a.value}else{a.hasAttribute("contenteditable")&&a.focus();var u=window.getSelection(),d=document.createRange();d.selectNodeContents(a),u.removeAllRanges(),u.addRange(d),l=u.toString()}return l}s.exports=i},279:function(s){function i(){}i.prototype={on:function(a,l,c){var u=this.e||(this.e={});return(u[a]||(u[a]=[])).push({fn:l,ctx:c}),this},once:function(a,l,c){var u=this;function d(){u.off(a,d),l.apply(c,arguments)}return d._=l,this.on(a,d,c)},emit:function(a){var l=[].slice.call(arguments,1),c=((this.e||(this.e={}))[a]||[]).slice(),u=0,d=c.length;for(u;u<d;u++)c[u].fn.apply(c[u].ctx,l);return this},off:function(a,l){var c=this.e||(this.e={}),u=c[a],d=[];if(u&&l)for(var f=0,p=u.length;f<p;f++)u[f].fn!==l&&u[f].fn._!==l&&d.push(u[f]);return d.length?c[a]=d:delete c[a],this}},s.exports=i,s.exports.TinyEmitter=i}},r={};function o(s){if(r[s])return r[s].exports;var i=r[s]={exports:{}};return n[s](i,i.exports,o),i.exports}return function(){o.n=function(s){var i=s&&s.__esModule?function(){return s.default}:function(){return s};return o.d(i,{a:i}),i}}(),function(){o.d=function(s,i){for(var a in i)o.o(i,a)&&!o.o(s,a)&&Object.defineProperty(s,a,{enumerable:!0,get:i[a]})}}(),function(){o.o=function(s,i){return Object.prototype.hasOwnProperty.call(s,i)}}(),o(686)}().default})})(cv);var mO=cv.exports;const gO=xw(mO);new gO('[id$="-copy"]');function vO(t){t&&t.classList.remove("fr-hidden")}function yO(t){t&&t.classList.add("fr-hidden"),window.localStorage.setItem(t.id,"true")}function bO(t,e=3,n="/"){const r=window.location.pathname,o=t.id;if(window.localStorage.getItem(o)||!1||r.indexOf(n)===-1)return;const i="pv-"+o;let a=parseInt(window.sessionStorage.getItem(i)||"0",10);a>=e&&vO(t),a++,window.sessionStorage.setItem(i,a.toFixed(0))}const wO=document.querySelectorAll("[data-dialogs]");wO.forEach(t=>{bO(t),t.querySelectorAll("[data-dialogs-close]").forEach(n=>{n instanceof HTMLElement&&n.addEventListener("click",()=>yO(t))})});const kO=document.querySelectorAll("[data-select-sort]");kO.forEach(t=>{t.querySelectorAll("option").forEach(n=>{n.disabled=!1}),t.form&&(t.addEventListener("change",n=>{var r;(r=t.form)==null||r.dispatchEvent(new Event("submit"))}),t.form.addEventListener("submit",n=>{var r,o;n.preventDefault(),t.value||(t.disabled=!0),(r=t.form)==null||r.submit(),(o=globalThis._paq)==null||o.push(["trackEvent","Search","Sort",t.value])}))});function uv(t){return"#/".concat(t.dataset.updateUrl||t.getAttribute("aria-controls"))}function Hp(t){t.forEach(e=>{const n=uv(e),r="#".concat(e.dataset.previousUrl);if(r&&window.location.hash.startsWith(r)){const o=window.location.hash.slice(r.length);window.location.hash="".concat(n,"/").concat(o)}if(window.location.hash.includes(n)){const o=e.getAttribute("aria-controls");o||console.error("TabButton without `aria-controls` ID.",e);const s=document.getElementById(o);s||console.error("Unknown TabPanel with id '".concat(o,"'."),e),dsfr(s).tabPanel.disclose()}})}function CO(){const t=document.querySelectorAll("[data-update-url]");window.addEventListener("hashchange",()=>{Hp(t)}),t.forEach(e=>{const n=uv(e);e.addEventListener("click",()=>{var r;if(!window.location.hash.includes(n)){let o=new URL(window.location.href);o.hash=n,window.history.pushState(null,"",o),(r=globalThis._paq)==null||r.push(["trackEvent","Move page to hash",window.location.pathname,n])}})}),setTimeout(()=>{Hp(t)},100)}async function xO(){return(await Qe.get(Fd("reports/reasons/"))).data}async function SO(t,e,n,r){return(await Qe.post("/reports/",{subject:{id:e,class:t},reason:n,message:r})).data}function qp(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function lr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?qp(Object(n),!0).forEach(function(r){_O(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qp(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function _O(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Up(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Object.keys(t).reduce((n,r)=>(e.includes(r)||(n[r]=m(t[r])),n),{})}function ml(t){return typeof t=="function"}function TO(t){return gw(t)||vw(t)}function dv(t,e,n){let r=t;const o=e.split(".");for(let s=0;s<o.length;s++){if(!r[o[s]])return n;r=r[o[s]]}return r}function Wc(t,e,n){return O(()=>t.some(r=>dv(e,r,{[n]:!1})[n]))}function Wp(t,e,n){return O(()=>t.reduce((r,o)=>{const s=dv(e,o,{[n]:!1})[n]||[];return r.concat(s)},[]))}function fv(t,e,n,r){return t.call(r,m(e),m(n),r)}function hv(t){return t.$valid!==void 0?!t.$valid:!t}function $O(t,e,n,r,o,s,i){let{$lazy:a,$rewardEarly:l}=o,c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:[],u=arguments.length>8?arguments[8]:void 0,d=arguments.length>9?arguments[9]:void 0,f=arguments.length>10?arguments[10]:void 0;const p=T(!!r.value),h=T(0);n.value=!1;const v=He([e,r].concat(c,f),()=>{if(a&&!r.value||l&&!d.value&&!n.value)return;let y;try{y=fv(t,e,u,i)}catch(w){y=Promise.reject(w)}h.value++,n.value=!!h.value,p.value=!1,Promise.resolve(y).then(w=>{h.value--,n.value=!!h.value,s.value=w,p.value=hv(w)}).catch(w=>{h.value--,n.value=!!h.value,s.value=w,p.value=!0})},{immediate:!0,deep:typeof e=="object"});return{$invalid:p,$unwatch:v}}function OO(t,e,n,r,o,s,i,a){let{$lazy:l,$rewardEarly:c}=r;const u=()=>({}),d=O(()=>{if(l&&!n.value||c&&!a.value)return!1;let f=!0;try{const p=fv(t,e,i,s);o.value=p,f=hv(p)}catch(p){o.value=p}return f});return{$unwatch:u,$invalid:d}}function MO(t,e,n,r,o,s,i,a,l,c,u){const d=T(!1),f=t.$params||{},p=T(null);let h,v;t.$async?{$invalid:h,$unwatch:v}=$O(t.$validator,e,d,n,r,p,o,t.$watchTargets,l,c,u):{$invalid:h,$unwatch:v}=OO(t.$validator,e,n,r,p,o,l,c);const y=t.$message;return{$message:ml(y)?O(()=>y(Up({$pending:d,$invalid:h,$params:Up(f),$model:e,$response:p,$validator:s,$propertyPath:a,$property:i}))):y||"",$params:f,$pending:d,$invalid:h,$response:p,$unwatch:v}}function EO(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=m(t),n=Object.keys(e),r={},o={},s={};let i=null;return n.forEach(a=>{const l=e[a];switch(!0){case ml(l.$validator):r[a]=l;break;case ml(l):r[a]={$validator:l};break;case a==="$validationGroups":i=l;break;case a.startsWith("$"):s[a]=l;break;default:o[a]=l}}),{rules:r,nestedValidators:o,config:s,validationGroups:i}}const NO="__root";function DO(t,e,n,r,o,s,i,a,l){const c=Object.keys(t),u=r.get(o,t),d=T(!1),f=T(!1),p=T(0);if(u){if(!u.$partial)return u;u.$unwatch(),d.value=u.$dirty.value}const h={$dirty:d,$path:o,$touch:()=>{d.value||(d.value=!0)},$reset:()=>{d.value&&(d.value=!1)},$commit:()=>{}};return c.length?(c.forEach(v=>{h[v]=MO(t[v],e,h.$dirty,s,i,v,n,o,l,f,p)}),h.$externalResults=O(()=>a.value?[].concat(a.value).map((v,y)=>({$propertyPath:o,$property:n,$validator:"$externalResults",$uid:"".concat(o,"-externalResult-").concat(y),$message:v,$params:{},$response:null,$pending:!1})):[]),h.$invalid=O(()=>{const v=c.some(y=>m(h[y].$invalid));return f.value=v,!!h.$externalResults.value.length||v}),h.$pending=O(()=>c.some(v=>m(h[v].$pending))),h.$error=O(()=>h.$dirty.value?h.$pending.value||h.$invalid.value:!1),h.$silentErrors=O(()=>c.filter(v=>m(h[v].$invalid)).map(v=>{const y=h[v];return So({$propertyPath:o,$property:n,$validator:v,$uid:"".concat(o,"-").concat(v),$message:y.$message,$params:y.$params,$response:y.$response,$pending:y.$pending})}).concat(h.$externalResults.value)),h.$errors=O(()=>h.$dirty.value?h.$silentErrors.value:[]),h.$unwatch=()=>c.forEach(v=>{h[v].$unwatch()}),h.$commit=()=>{f.value=!0,p.value=Date.now()},r.set(o,t,h),h):(u&&r.set(o,t,h),h)}function AO(t,e,n,r,o,s,i){const a=Object.keys(t);return a.length?a.reduce((l,c)=>(l[c]=Xu({validations:t[c],state:e,key:c,parentKey:n,resultsCache:r,globalConfig:o,instance:s,externalResults:i}),l),{}):{}}function RO(t,e,n){const r=O(()=>[e,n].filter(h=>h).reduce((h,v)=>h.concat(Object.values(m(v))),[])),o=O({get(){return t.$dirty.value||(r.value.length?r.value.every(h=>h.$dirty):!1)},set(h){t.$dirty.value=h}}),s=O(()=>{const h=m(t.$silentErrors)||[],v=r.value.filter(y=>(m(y).$silentErrors||[]).length).reduce((y,w)=>y.concat(...w.$silentErrors),[]);return h.concat(v)}),i=O(()=>{const h=m(t.$errors)||[],v=r.value.filter(y=>(m(y).$errors||[]).length).reduce((y,w)=>y.concat(...w.$errors),[]);return h.concat(v)}),a=O(()=>r.value.some(h=>h.$invalid)||m(t.$invalid)||!1),l=O(()=>r.value.some(h=>m(h.$pending))||m(t.$pending)||!1),c=O(()=>r.value.some(h=>h.$dirty)||r.value.some(h=>h.$anyDirty)||o.value),u=O(()=>o.value?l.value||a.value:!1),d=()=>{t.$touch(),r.value.forEach(h=>{h.$touch()})},f=()=>{t.$commit(),r.value.forEach(h=>{h.$commit()})},p=()=>{t.$reset(),r.value.forEach(h=>{h.$reset()})};return r.value.length&&r.value.every(h=>h.$dirty)&&d(),{$dirty:o,$errors:i,$invalid:a,$anyDirty:c,$error:u,$pending:l,$touch:d,$reset:p,$silentErrors:s,$commit:f}}function Xu(t){let{validations:e,state:n,key:r,parentKey:o,childResults:s,resultsCache:i,globalConfig:a={},instance:l,externalResults:c}=t;const u=o?"".concat(o,".").concat(r):r,{rules:d,nestedValidators:f,config:p,validationGroups:h}=EO(e),v=lr(lr({},a),p),y=r?O(()=>{const Oe=m(n);return Oe?m(Oe[r]):void 0}):n,w=lr({},m(c)||{}),x=O(()=>{const Oe=m(c);return r?Oe?m(Oe[r]):void 0:Oe}),$=DO(d,y,r,i,u,v,l,x,n),S=AO(f,y,u,i,v,l,x),_={};h&&Object.entries(h).forEach(Oe=>{let[ct,q]=Oe;_[ct]={$invalid:Wc(q,S,"$invalid"),$error:Wc(q,S,"$error"),$pending:Wc(q,S,"$pending"),$errors:Wp(q,S,"$errors"),$silentErrors:Wp(q,S,"$silentErrors")}});const{$dirty:E,$errors:D,$invalid:N,$anyDirty:H,$error:Y,$pending:re,$touch:ce,$reset:Ue,$silentErrors:et,$commit:$e}=RO($,S,s),Ae=r?O({get:()=>m(y),set:Oe=>{E.value=!0;const ct=m(n),q=m(c);q&&(q[r]=w[r]),sl(ct[r])?ct[r].value=Oe:ct[r]=Oe}}):null;r&&v.$autoDirty&&He(y,()=>{E.value||ce();const Oe=m(c);Oe&&(Oe[r]=w[r])},{flush:"sync"});async function qe(){return ce(),v.$rewardEarly&&($e(),await mi()),await mi(),new Promise(Oe=>{if(!re.value)return Oe(!N.value);const ct=He(re,()=>{Oe(!N.value),ct()})})}function Fe(Oe){return(s.value||{})[Oe]}function We(){sl(c)?c.value=w:Object.keys(w).length===0?Object.keys(c).forEach(Oe=>{delete c[Oe]}):Object.assign(c,w)}return So(lr(lr(lr({},$),{},{$model:Ae,$dirty:E,$error:Y,$errors:D,$invalid:N,$anyDirty:H,$pending:re,$touch:ce,$reset:Ue,$path:u||NO,$silentErrors:et,$validate:qe,$commit:$e},s&&{$getResultsForChild:Fe,$clearExternalResults:We,$validationGroups:_}),S))}class IO{constructor(){this.storage=new Map}set(e,n,r){this.storage.set(e,{rules:n,result:r})}checkRulesValidity(e,n,r){const o=Object.keys(r),s=Object.keys(n);return s.length!==o.length||!s.every(a=>o.includes(a))?!1:s.every(a=>n[a].$params?Object.keys(n[a].$params).every(l=>m(r[a].$params[l])===m(n[a].$params[l])):!0)}get(e,n){const r=this.storage.get(e);if(!r)return;const{rules:o,result:s}=r,i=this.checkRulesValidity(e,n,o),a=s.$unwatch?s.$unwatch:()=>({});return i?s:{$dirty:s.$dirty,$partial:!0,$unwatch:a}}}const Ea={COLLECT_ALL:!0,COLLECT_NONE:!1},jp=Symbol("vuelidate#injectChildResults"),Kp=Symbol("vuelidate#removeChildResults");function PO(t){let{$scope:e,instance:n}=t;const r={},o=T([]),s=O(()=>o.value.reduce((u,d)=>(u[d]=m(r[d]),u),{}));function i(u,d){let{$registerAs:f,$scope:p,$stopPropagation:h}=d;h||e===Ea.COLLECT_NONE||p===Ea.COLLECT_NONE||e!==Ea.COLLECT_ALL&&e!==p||(r[f]=u,o.value.push(f))}n.__vuelidateInjectInstances=[].concat(n.__vuelidateInjectInstances||[],i);function a(u){o.value=o.value.filter(d=>d!==u),delete r[u]}n.__vuelidateRemoveInstances=[].concat(n.__vuelidateRemoveInstances||[],a);const l=Ye(jp,[]);at(jp,n.__vuelidateInjectInstances);const c=Ye(Kp,[]);return at(Kp,n.__vuelidateRemoveInstances),{childResults:s,sendValidationResultsToParent:l,removeValidationResultsFromParent:c}}function pv(t){return new Proxy(t,{get(e,n){return typeof e[n]=="object"?pv(e[n]):O(()=>e[n])}})}let Yp=0;function Gp(t,e){var n;let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};arguments.length===1&&(r=t,t=void 0,e=void 0);let{$registerAs:o,$scope:s=Ea.COLLECT_ALL,$stopPropagation:i,$externalResults:a,currentVueInstance:l}=r;const c=l||((n=_s())===null||n===void 0?void 0:n.proxy),u=c?c.$options:{};o||(Yp+=1,o="_vuelidate_".concat(Yp));const d=T({}),f=new IO,{childResults:p,sendValidationResultsToParent:h,removeValidationResultsFromParent:v}=c?PO({$scope:s,instance:c}):{childResults:T({})};if(!t&&u.validations){const y=u.validations;e=T({}),Vd(()=>{e.value=c,He(()=>ml(y)?y.call(e.value,new pv(e.value)):y,w=>{d.value=Xu({validations:w,state:e,childResults:p,resultsCache:f,globalConfig:r,instance:c,externalResults:a||c.vuelidateExternalResults})},{immediate:!0})}),r=u.validationsConfig||r}else{const y=sl(t)||TO(t)?t:So(t||{});He(y,w=>{d.value=Xu({validations:w,state:e,childResults:p,resultsCache:f,globalConfig:r,instance:c!=null?c:{},externalResults:a})},{immediate:!0})}return c&&(h.forEach(y=>y(d,{$registerAs:o,$scope:s,$stopPropagation:i})),Wg(()=>v.forEach(y=>y(o)))),O(()=>lr(lr({},m(d.value)),p.value))}function mv(t,e,n,r=!1){const o=Gp(e,t,{$scope:r}),s=Gp(n,t,{$scope:"warning"});return{getErrorText:u=>(s.value[u].$dirty&&o.value[u].$touch(),o.value[u].$errors.map(d=>d.$message).join("\n")),getFunctionalState:LO,getWarningText:u=>s.value[u].$errors.map(d=>d.$message).join("\n"),hasError:zO,hasWarning:Zu,reset:()=>{s.value.$reset(),o.value.$reset()},validateRequiredRules:()=>(s.value.$validate(),o.value.$validate(),o.value.$validate()),v$:o,vWarning$:s}}const LO=(t,e,n)=>t?e?"error":n?"warning":"success":"disabled",zO=(t,e)=>Ke(t)[e]==="error",Zu=(t,e)=>Ke(t)[e]==="warning",BO=["for"],FO={key:0,class:"fr-hint-text"},VO=["aria-describedby","id","required","disabled"],HO=["selected"],qO=["value","selected","disabled","hidden"],UO=["id"],WO=["id"],jO=L({__name:"SelectGroup",props:{disabled:{type:Boolean,default:!1},errorText:{default:""},hasError:{type:Boolean,default:!1},hintText:{default:""},isValid:{type:Boolean,default:!1},label:{},modelValue:{default:void 0},options:{},required:{type:Boolean,default:!1},validText:{default:""}},emits:["update:modelValue"],setup(t,{emit:e}){const n=e,r=t,{id:o}=$s("select"),s=O(()=>o+"-desc-error"),i=O(()=>o+"-desc-valid"),a=O(()=>{let u="";return r.isValid?u+=" "+i:r.hasError&&(u+=" "+s),u}),l=O(()=>({"fr-select-group--disabled":r.disabled,"fr-select-group--error":r.hasError,"fr-select-group--valid":r.isValid})),c=u=>{var f;const d=u.target;n("update:modelValue",(f=d==null?void 0:d.value)!=null?f:"")};return(u,d)=>(b(),k("div",{class:ae(["fr-select-group",l.value])},[g("label",{class:"fr-label",for:m(o)},[U(C(t.label)+" ",1),M(tf,{required:t.required},null,8,["required"]),t.hintText?(b(),k("span",FO,C(t.hintText),1)):I("",!0)],8,BO),g("select",{class:ae(["fr-select",{"fr-select--error":t.hasError,"fr-select--valid":t.isValid}]),"aria-describedby":a.value,id:m(o),required:t.required,disabled:t.disabled,onChange:c},[g("option",{value:"",selected:!t.modelValue,disabled:"",hidden:""},C(u.$t("Select an option")),9,HO),(b(!0),k(K,null,Ne(t.options,f=>(b(),k("option",{value:f.value,selected:f.selected,disabled:f.disabled,hidden:f.hidden},C(f.label),9,qO))),256))],42,VO),t.isValid?(b(),k("p",{key:0,id:i.value,class:"fr-valid-text"},C(t.validText),9,UO)):t.hasError?(b(),k("p",{key:1,id:s.value,class:"fr-error-text"},C(t.errorText),9,WO)):I("",!0)],2))}});(function(){try{if(typeof document<"u"){var t=document.createElement("style");t.appendChild(document.createTextNode(".v3dp__popout[data-v-65eb861b]{z-index:10;position:absolute;text-align:center;width:17.5em;background-color:var(--popout-bg-color);box-shadow:var(--box-shadow);border-radius:var(--border-radius);padding:8px 0 1em;color:var(--text-color)}.v3dp__popout *[data-v-65eb861b]{color:inherit;font-size:inherit;font-weight:inherit}.v3dp__popout[data-v-65eb861b] button{background:none;border:none;outline:none}.v3dp__popout[data-v-65eb861b] button:not(:disabled){cursor:pointer}.v3dp__heading[data-v-65eb861b]{width:100%;display:flex;height:var(--heading-size);line-height:var(--heading-size);font-weight:var(--heading-weight)}.v3dp__heading__button[data-v-65eb861b]{background:none;border:none;padding:0;display:flex;justify-content:center;align-items:center;width:var(--heading-size)}button.v3dp__heading__center[data-v-65eb861b]:hover,.v3dp__heading__button[data-v-65eb861b]:not(:disabled):hover{background-color:var(--heading-hover-color)}.v3dp__heading__center[data-v-65eb861b]{flex:1}.v3dp__heading__icon[data-v-65eb861b]{height:12px;stroke:var(--arrow-color)}.v3dp__heading__button:disabled .v3dp__heading__icon[data-v-65eb861b]{stroke:var(--elem-disabled-color)}.v3dp__subheading[data-v-65eb861b],.v3dp__elements[data-v-65eb861b]{display:grid;grid-template-columns:var(--popout-column-definition);font-size:var(--elem-font-size)}.v3dp__subheading[data-v-65eb861b]{margin-top:1em}.v3dp__divider[data-v-65eb861b]{border:1px solid var(--divider-color);border-radius:3px}.v3dp__elements[data-v-65eb861b] button:disabled{color:var(--elem-disabled-color)}.v3dp__elements[data-v-65eb861b] button{padding:.3em .6em}.v3dp__elements[data-v-65eb861b] button span{display:block;line-height:1.9em;height:1.8em;border-radius:var(--elem-border-radius)}.v3dp__elements[data-v-65eb861b] button:not(:disabled):hover span{background-color:var(--elem-hover-bg-color);color:var(--elem-hover-color)}.v3dp__elements[data-v-65eb861b] button.selected span{background-color:var(--elem-selected-bg-color);color:var(--elem-selected-color)}.v3dp__elements[data-v-65eb861b] button.current span{font-weight:var(--elem-current-font-weight);outline:1px solid var(--elem-current-outline-color)}.v3dp__column[data-v-81ac698d]{display:flex;flex-direction:column;overflow-y:auto;height:190px}.v3dp__datepicker{--popout-bg-color: var(--vdp-bg-color, #fff);--box-shadow: var( --vdp-box-shadow, 0 4px 10px 0 rgba(128, 144, 160, .1), 0 0 1px 0 rgba(128, 144, 160, .81) );--text-color: var(--vdp-text-color, #000000);--border-radius: var(--vdp-border-radius, 3px);--heading-size: var(--vdp-heading-size, 2.5em);--heading-weight: var(--vdp-heading-weight, bold);--heading-hover-color: var(--vdp-heading-hover-color, #eeeeee);--arrow-color: var(--vdp-arrow-color, currentColor);--elem-color: var(--vdp-elem-color, currentColor);--elem-disabled-color: var(--vdp-disabled-color, #d5d9e0);--elem-hover-color: var(--vdp-hover-color, #fff);--elem-hover-bg-color: var(--vdp-hover-bg-color, #0baf74);--elem-selected-color: var(--vdp-selected-color, #fff);--elem-selected-bg-color: var(--vdp-selected-bg-color, #0baf74);--elem-current-outline-color: var(--vdp-current-date-outline-color, #888);--elem-current-font-weight: var(--vdp-current-date-font-weight, bold);--elem-font-size: var(--vdp-elem-font-size, .8em);--elem-border-radius: var(--vdp-elem-border-radius, 3px);--divider-color: var(--vdp-divider-color, var(--elem-disabled-color));position:relative}.v3dp__clearable{display:inline;position:relative;left:-15px;cursor:pointer}")),document.head.appendChild(t)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();const KO=["year","month","day","time","custom"],YO=L({emits:{elementClick:t=>qt(t),left:()=>!0,right:()=>!0,heading:()=>!0},props:{headingClickable:{type:Boolean,default:!1},leftDisabled:{type:Boolean,default:!1},rightDisabled:{type:Boolean,default:!1},columnCount:{type:Number,default:7},items:{type:Array,default:()=>[]},viewMode:{type:String,required:!0,validate:t=>typeof t=="string"&&KO.includes(t)}}}),Os=(t,e)=>{const n=t.__vccOpts||t;for(const[r,o]of e)n[r]=o;return n},cf=t=>(yw("data-v-65eb861b"),t=t(),bw(),t),GO={class:"v3dp__heading"},JO=["disabled"],XO=cf(()=>g("svg",{class:"v3dp__heading__icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 6 8"},[g("g",{fill:"none","fill-rule":"evenodd"},[g("path",{stroke:"none",d:"M-9 16V-8h24v24z"}),g("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 0L1 4l4 4"})])],-1)),ZO=["disabled"],QO=cf(()=>g("svg",{class:"v3dp__heading__icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 6 8"},[g("g",{fill:"none","fill-rule":"evenodd"},[g("path",{stroke:"none",d:"M15-8v24H-9V-8z"}),g("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M1 8l4-4-4-4"})])],-1)),e7={class:"v3dp__body"},t7={class:"v3dp__subheading"},n7=cf(()=>g("hr",{class:"v3dp__divider"},null,-1)),r7={class:"v3dp__elements"},o7=["disabled","onClick"];function s7(t,e,n,r,o,s){return b(),k("div",{class:ae(["v3dp__popout","v3dp__popout-".concat(t.viewMode)]),style:Ts({"--popout-column-definition":"repeat(".concat(t.columnCount,", 1fr)")}),onMousedown:e[3]||(e[3]=ye(()=>{},["prevent"]))},[g("div",GO,[g("button",{class:"v3dp__heading__button v3dp__heading__button__left",disabled:t.leftDisabled,onClick:e[0]||(e[0]=ye(i=>t.$emit("left"),["stop","prevent"]))},[Le(t.$slots,"arrow-left",{},()=>[XO],!0)],8,JO),(b(),j(to(t.headingClickable?"button":"span"),{class:"v3dp__heading__center",onClick:e[1]||(e[1]=ye(i=>t.$emit("heading"),["stop","prevent"]))},{default:W(()=>[Le(t.$slots,"heading",{},void 0,!0)]),_:3})),g("button",{class:"v3dp__heading__button v3dp__heading__button__right",disabled:t.rightDisabled,onClick:e[2]||(e[2]=ye(i=>t.$emit("right"),["stop","prevent"]))},[Le(t.$slots,"arrow-right",{},()=>[QO],!0)],8,ZO)]),g("div",e7,["subheading"in t.$slots?(b(),k(K,{key:0},[g("div",t7,[Le(t.$slots,"subheading",{},void 0,!0)]),n7],64)):I("",!0),g("div",r7,[Le(t.$slots,"body",{},()=>[(b(!0),k(K,null,Ne(t.items,i=>(b(),k("button",{key:i.key,disabled:i.disabled,class:ae([{selected:i.selected,current:i.current},"v3dp__element__button__".concat(t.viewMode)]),onClick:ye(a=>t.$emit("elementClick",i.value),["stop","prevent"])},[g("span",null,C(i.display),1)],10,o7))),128))],!0)])])],38)}const Ql=Os(YO,[["render",s7],["__scopeId","data-v-65eb861b"]]),i7=L({components:{PickerPopup:Ql},emits:{"update:pageDate":t=>qt(t),select:t=>qt(t)},props:{selected:{type:Date,required:!1},pageDate:{type:Date,required:!0},lowerLimit:{type:Date,required:!1},upperLimit:{type:Date,required:!1}},setup(t,{emit:e}){const n=O(()=>O8(t.pageDate)),r=O(()=>Z_(t.pageDate)),o=(c,u,d)=>!u&&!d?!0:!(u&&cn(c)<cn(u)||d&&cn(c)>cn(d)),s=O(()=>X_({start:n.value,end:r.value}).map(c=>({value:c,key:String(cn(c)),display:cn(c),selected:!!t.selected&&cn(c)===cn(t.selected),disabled:!o(c,t.lowerLimit,t.upperLimit)}))),i=O(()=>{const c=cn(n.value),u=cn(r.value);return"".concat(c," - ").concat(u)}),a=O(()=>t.lowerLimit&&(ba(t.lowerLimit)===ba(t.pageDate)||bi(t.pageDate,t.lowerLimit))),l=O(()=>t.upperLimit&&(ba(t.upperLimit)===ba(t.pageDate)||yi(t.pageDate,t.upperLimit)));return{years:s,heading:i,leftDisabled:a,rightDisabled:l,previousPage:()=>e("update:pageDate",sv(t.pageDate,10)),nextPage:()=>e("update:pageDate",rf(t.pageDate,10))}}});function a7(t,e,n,r,o,s){const i=Je("picker-popup");return b(),j(i,{columnCount:3,leftDisabled:t.leftDisabled,rightDisabled:t.rightDisabled,items:t.years,viewMode:"year",onLeft:t.previousPage,onRight:t.nextPage,onElementClick:e[0]||(e[0]=a=>t.$emit("select",a))},{heading:W(()=>[U(C(t.heading),1)]),_:1},8,["leftDisabled","rightDisabled","items","onLeft","onRight"])}const l7=Os(i7,[["render",a7]]),c7=L({components:{PickerPopup:Ql},emits:{"update:pageDate":t=>qt(t),select:t=>qt(t),back:()=>!0},props:{selected:{type:Date,required:!1},pageDate:{type:Date,required:!0},format:{type:String,required:!1,default:"LLL"},locale:{type:Object,required:!1},lowerLimit:{type:Date,required:!1},upperLimit:{type:Date,required:!1}},setup(t,{emit:e}){const n=O(()=>J_(t.pageDate)),r=O(()=>G_(t.pageDate)),o=O(()=>u=>gs(u,t.format,{locale:t.locale})),s=(u,d,f)=>!d&&!f?!0:!(d&&bi(u,U1(d))||f&&yi(u,q1(f))),i=O(()=>Y_({start:n.value,end:r.value}).map(u=>({value:u,display:o.value(u),key:o.value(u),selected:!!t.selected&&Gu(t.selected,u),disabled:!s(u,t.lowerLimit,t.upperLimit)}))),a=O(()=>cn(n.value)),l=O(()=>t.lowerLimit&&(zp(t.lowerLimit,t.pageDate)||bi(t.pageDate,t.lowerLimit))),c=O(()=>t.upperLimit&&(zp(t.upperLimit,t.pageDate)||yi(t.pageDate,t.upperLimit)));return{months:i,heading:a,leftDisabled:l,rightDisabled:c,previousPage:()=>e("update:pageDate",sv(t.pageDate,1)),nextPage:()=>e("update:pageDate",rf(t.pageDate,1))}}});function u7(t,e,n,r,o,s){const i=Je("picker-popup");return b(),j(i,{headingClickable:"",columnCount:3,items:t.months,leftDisabled:t.leftDisabled,rightDisabled:t.rightDisabled,viewMode:"month",onLeft:t.previousPage,onRight:t.nextPage,onHeading:e[0]||(e[0]=a=>t.$emit("back")),onElementClick:e[1]||(e[1]=a=>t.$emit("select",a))},{heading:W(()=>[U(C(t.heading),1)]),_:1},8,["items","leftDisabled","rightDisabled","onLeft","onRight"])}const d7=Os(c7,[["render",u7]]),f7=L({components:{PickerPopup:Ql},emits:{"update:pageDate":t=>qt(t),select:t=>qt(t),back:()=>!0},props:{selected:{type:Date,required:!1},pageDate:{type:Date,required:!0},format:{type:String,required:!1,default:"dd"},headingFormat:{type:String,required:!1,default:"LLLL yyyy"},weekdayFormat:{type:String,required:!1,default:"EE"},locale:{type:Object,required:!1},weekStartsOn:{type:Number,required:!1,default:1,validator:t=>typeof t=="number"&&Number.isInteger(t)&&t>=0&&t<=6},lowerLimit:{type:Date,required:!1},upperLimit:{type:Date,required:!1},disabledDates:{type:Object,required:!1},allowOutsideInterval:{type:Boolean,required:!1,default:!1}},setup(t,{emit:e}){const n=O(()=>p=>h=>gs(h,p,{locale:t.locale,weekStartsOn:t.weekStartsOn})),r=O(()=>U1(t.pageDate)),o=O(()=>q1(t.pageDate)),s=O(()=>({start:r.value,end:o.value})),i=O(()=>({start:B_(r.value,{weekStartsOn:t.weekStartsOn}),end:Q_(o.value,{weekStartsOn:t.weekStartsOn})})),a=O(()=>{const p=t.weekStartsOn,h=n.value(t.weekdayFormat);return Array.from(Array(7)).map((v,y)=>(p+y)%7).map(v=>$8(new Date,v,{weekStartsOn:t.weekStartsOn})).map(h)}),l=(p,h,v,y)=>{var w,x;return(w=y==null?void 0:y.dates)!=null&&w.some($=>qc(p,$))||(x=y==null?void 0:y.predicate)!=null&&x.call(y,p)?!1:!h&&!v?!0:!(h&&bi(p,ju(h))||v&&yi(p,j_(v)))},c=O(()=>{const p=new Date,h=n.value(t.format);return K_(i.value).map(v=>({value:v,display:h(v),selected:!!t.selected&&qc(t.selected,v),current:qc(p,v),disabled:!t.allowOutsideInterval&&!_8(v,s.value)||!l(v,t.lowerLimit,t.upperLimit,t.disabledDates),key:n.value("yyyy-MM-dd")(v)}))}),u=O(()=>n.value(t.headingFormat)(t.pageDate)),d=O(()=>t.lowerLimit&&(Gu(t.lowerLimit,t.pageDate)||bi(t.pageDate,t.lowerLimit))),f=O(()=>t.upperLimit&&(Gu(t.upperLimit,t.pageDate)||yi(t.pageDate,t.upperLimit)));return{weekDays:a,days:c,heading:u,leftDisabled:d,rightDisabled:f,previousPage:()=>e("update:pageDate",M8(t.pageDate,1)),nextPage:()=>e("update:pageDate",nf(t.pageDate,1))}}});function h7(t,e,n,r,o,s){const i=Je("picker-popup");return b(),j(i,{headingClickable:"",leftDisabled:t.leftDisabled,rightDisabled:t.rightDisabled,items:t.days,viewMode:"day",onLeft:t.previousPage,onRight:t.nextPage,onHeading:e[0]||(e[0]=a=>t.$emit("back")),onElementClick:e[1]||(e[1]=a=>t.$emit("select",a))},{heading:W(()=>[U(C(t.heading),1)]),subheading:W(()=>[(b(!0),k(K,null,Ne(t.weekDays,(a,l)=>(b(),k("span",{key:a,class:ae("v3dp__subheading__weekday__".concat(l))},C(a),3))),128))]),_:1},8,["leftDisabled","rightDisabled","items","onLeft","onRight"])}const p7=Os(f7,[["render",h7]]);function Jp(t,e){const n=t.getBoundingClientRect(),r={height:t.clientHeight,width:t.clientWidth},o=e.getBoundingClientRect();if(!(o.top>=n.top&&o.bottom<=n.top+r.height)){const s=o.top-n.top,i=o.bottom-n.bottom;Math.abs(s)<Math.abs(i)?t.scrollTop+=s:t.scrollTop+=i}}const m7=L({components:{PickerPopup:Ql},emits:{select:t=>qt(t),back:()=>!0},props:{selected:{type:Date,required:!1},pageDate:{type:Date,required:!0},visible:{type:Boolean,required:!0},disabledTime:{type:Object,required:!1}},setup(t,{emit:e}){const n=T(null),r=T(null),o=O(()=>{var d;return(d=t.pageDate)!=null?d:t.selected}),s=T(o.value.getHours()),i=T(o.value.getMinutes());He(()=>t.selected,d=>{let f=0,p=0;d&&(f=d.getHours(),p=d.getMinutes()),s.value=f,i.value=p});const a=O(()=>[...Array(24).keys()].map(d=>({value:d,date:Bp(new Date(o.value.getTime()),{hours:d,minutes:i.value,seconds:0}),selected:s.value===d,ref:T(null)}))),l=O(()=>[...Array(60).keys()].map(d=>({value:d,date:Bp(new Date(o.value.getTime()),{hours:s.value,minutes:d,seconds:0}),selected:i.value===d,ref:T(null)}))),c=d=>{i.value=d.value,e("select",d.date)},u=()=>{const d=a.value.find(p=>{var y;var h,v;return(y=(v=(h=p.ref.value)==null?void 0:h.classList)==null?void 0:v.contains("selected"))!=null?y:!1}),f=l.value.find(p=>{var y;var h,v;return(y=(v=(h=p.ref.value)==null?void 0:h.classList)==null?void 0:v.contains("selected"))!=null?y:!1});d&&f&&(Jp(n.value,d.ref.value),Jp(r.value,f.ref.value))};return He(()=>t.visible,d=>{d&&mi(u)}),{hoursListRef:n,minutesListRef:r,hours:s,minutes:i,hoursList:a,minutesList:l,padStartZero:d=>"0".concat(d).substr(-2),selectMinutes:c,isEnabled:d=>{var f,p,h,v;return!((p=(f=t.disabledTime)==null?void 0:f.dates)!=null&&p.some(y=>x8(d,y)&&S8(d,y))||(v=(h=t.disabledTime)==null?void 0:h.predicate)!=null&&v.call(h,d))},scroll:u}}}),g7={ref:"hoursListRef",class:"v3dp__column"},v7=["disabled","onClick"],y7={ref:"minutesListRef",class:"v3dp__column"},b7=["disabled","onClick"];function w7(t,e,n,r,o,s){const i=Je("picker-popup");return b(),j(i,{headingClickable:"",columnCount:2,leftDisabled:!0,rightDisabled:!0,viewMode:"time",onHeading:e[0]||(e[0]=a=>t.$emit("back"))},{heading:W(()=>[U(C(t.padStartZero(t.hours))+":"+C(t.padStartZero(t.minutes)),1)]),body:W(()=>[g("div",g7,[(b(!0),k(K,null,Ne(t.hoursList,a=>(b(),k("button",{key:a.value,ref_for:!0,ref:a.ref,class:ae([{selected:a.selected},"v3dp__element_button__hour"]),disabled:!t.isEnabled(a.date),onClick:ye(l=>t.hours=a.value,["stop","prevent"])},[g("span",null,C(t.padStartZero(a.value)),1)],10,v7))),128))],512),g("div",y7,[(b(!0),k(K,null,Ne(t.minutesList,a=>(b(),k("button",{key:a.value,ref_for:!0,ref:a.ref,class:ae([{selected:a.selected},"v3dp__element_button__minute"]),disabled:!t.isEnabled(a.date),onClick:ye(l=>t.selectMinutes(a),["stop","prevent"])},[g("span",null,C(t.padStartZero(a.value)),1)],10,b7))),128))],512)]),_:1})}const k7=Os(m7,[["render",w7],["__scopeId","data-v-81ac698d"]]),ka=["time","day","month","year"],C7=(t,e,n=void 0)=>{let r=n||new Date;return t&&(r=F_([t,r])),e&&(r=V_([e,r])),r},x7=L({components:{YearPicker:l7,MonthPicker:d7,DayPicker:p7,TimePicker:k7},inheritAttrs:!1,props:{placeholder:{type:String,default:""},modelValue:{type:Date,required:!1},disabledDates:{type:Object,required:!1},allowOutsideInterval:{type:Boolean,required:!1,default:!1},disabledTime:{type:Object,required:!1},upperLimit:{type:Date,required:!1},lowerLimit:{type:Date,required:!1},startingView:{type:String,required:!1,default:"day",validate:t=>typeof t=="string"&&ka.includes(t)},startingViewDate:{type:Date,required:!1,default:()=>new Date},dayPickerHeadingFormat:{type:String,required:!1,default:"LLLL yyyy"},monthListFormat:{type:String,required:!1,default:"LLL"},weekdayFormat:{type:String,required:!1,default:"EE"},dayFormat:{type:String,required:!1,default:"dd"},inputFormat:{type:String,required:!1,default:"yyyy-MM-dd"},locale:{type:Object,required:!1},weekStartsOn:{type:Number,required:!1,default:1,validator:t=>[0,1,2,3,4,5,6].includes(t)},disabled:{type:Boolean,required:!1,default:!1},clearable:{type:Boolean,required:!1,default:!1},typeable:{type:Boolean,required:!1,default:!1},minimumView:{type:String,required:!1,default:"day",validate:t=>typeof t=="string"&&ka.includes(t)}},emits:{"update:modelValue":t=>t==null||qt(t),decadePageChanged:t=>!0,yearPageChanged:t=>!0,monthPageChanged:t=>!0,opened:()=>!0,closed:()=>!0},setup(t,{emit:e,attrs:n}){const r=T("none"),o=T(t.startingViewDate),s=T(null),i=T(!1),a=T("");bt(()=>{const S=Pp(a.value,t.inputFormat,new Date,{locale:t.locale});qt(S)&&(o.value=S)}),bt(()=>a.value=t.modelValue&&qt(t.modelValue)?gs(t.modelValue,t.inputFormat,{locale:t.locale}):"");const l=(S="none")=>{t.disabled||(S!=="none"&&r.value==="none"&&(o.value=t.modelValue||C7(t.lowerLimit,t.upperLimit,o.value)),r.value=S,e(S!=="none"?"opened":"closed"))};bt(()=>{t.disabled&&(r.value="none")});const c=(S,_)=>{o.value=_,S==="year"?e("decadePageChanged",_):S==="month"?e("yearPageChanged",_):S==="day"&&e("monthPageChanged",_)},u=S=>{o.value=S,t.minimumView==="year"?(l("none"),e("update:modelValue",S)):r.value="month"},d=S=>{o.value=S,t.minimumView==="month"?(l("none"),e("update:modelValue",S)):r.value="day"},f=S=>{o.value=S,t.minimumView==="day"?(l("none"),e("update:modelValue",S)):r.value="time"},p=S=>{l("none"),e("update:modelValue",S)},h=()=>{t.clearable&&(l("none"),e("update:modelValue",null),o.value=t.startingViewDate)},v=()=>i.value=!0,y=()=>l($.value),w=()=>{i.value=!1,l()},x=S=>{const _=S.keyCode?S.keyCode:S.which;if([27,13].includes(_)&&s.value.blur(),t.typeable){const E=Pp(s.value.value,t.inputFormat,new Date,{locale:t.locale});qt(E)&&a.value===gs(E,t.inputFormat,{locale:t.locale})&&(a.value=s.value.value,e("update:modelValue",E))}},$=O(()=>{const S=ka.indexOf(t.startingView),_=ka.indexOf(t.minimumView);return S<_?t.minimumView:t.startingView});return{blur:w,focus:y,click:v,input:a,inputRef:s,pageDate:o,renderView:l,updatePageDate:c,selectYear:u,selectMonth:d,selectDay:f,selectTime:p,keyUp:x,viewShown:r,goBackFromTimepicker:()=>t.startingView==="time"&&t.minimumView==="time"?null:r.value="day",clearModelValue:h,initialView:$,log:S=>console.log(S),variables:S=>Object.fromEntries(Object.entries(S!=null?S:{}).filter(([_,E])=>_.startsWith("--")))}}}),S7={class:"v3dp__input_wrapper"},_7=["readonly","placeholder","disabled","tabindex"],T7={class:"v3dp__clearable"};function $7(t,e,n,r,o,s){const i=Je("year-picker"),a=Je("month-picker"),l=Je("day-picker"),c=Je("time-picker");return b(),k("div",{class:"v3dp__datepicker",style:Ts(t.variables(t.$attrs.style))},[g("div",S7,[nt(g("input",Tn({type:"text",ref:"inputRef",readonly:!t.typeable,"onUpdate:modelValue":e[0]||(e[0]=u=>t.input=u)},t.$attrs,{placeholder:t.placeholder,disabled:t.disabled,tabindex:t.disabled?-1:0,onKeyup:e[1]||(e[1]=(...u)=>t.keyUp&&t.keyUp(...u)),onBlur:e[2]||(e[2]=(...u)=>t.blur&&t.blur(...u)),onFocus:e[3]||(e[3]=(...u)=>t.focus&&t.focus(...u)),onClick:e[4]||(e[4]=(...u)=>t.click&&t.click(...u))}),null,16,_7),[[Nr,t.input]]),nt(g("div",T7,[Le(t.$slots,"clear",{onClear:t.clearModelValue},()=>[g("i",{onClick:e[5]||(e[5]=u=>t.clearModelValue())},"x")])],512),[[fr,t.clearable&&t.modelValue]])]),nt(M(i,{pageDate:t.pageDate,"onUpdate:pageDate":e[6]||(e[6]=u=>t.updatePageDate("year",u)),selected:t.modelValue,lowerLimit:t.lowerLimit,upperLimit:t.upperLimit,onSelect:t.selectYear},null,8,["pageDate","selected","lowerLimit","upperLimit","onSelect"]),[[fr,t.viewShown==="year"]]),nt(M(a,{pageDate:t.pageDate,"onUpdate:pageDate":e[7]||(e[7]=u=>t.updatePageDate("month",u)),selected:t.modelValue,onSelect:t.selectMonth,lowerLimit:t.lowerLimit,upperLimit:t.upperLimit,format:t.monthListFormat,locale:t.locale,onBack:e[8]||(e[8]=u=>t.viewShown="year")},null,8,["pageDate","selected","onSelect","lowerLimit","upperLimit","format","locale"]),[[fr,t.viewShown==="month"]]),nt(M(l,{pageDate:t.pageDate,"onUpdate:pageDate":e[9]||(e[9]=u=>t.updatePageDate("day",u)),selected:t.modelValue,weekStartsOn:t.weekStartsOn,lowerLimit:t.lowerLimit,upperLimit:t.upperLimit,headingFormat:t.dayPickerHeadingFormat,disabledDates:t.disabledDates,locale:t.locale,weekdayFormat:t.weekdayFormat,"allow-outside-interval":t.allowOutsideInterval,format:t.dayFormat,onSelect:t.selectDay,onBack:e[10]||(e[10]=u=>t.viewShown="month")},null,8,["pageDate","selected","weekStartsOn","lowerLimit","upperLimit","headingFormat","disabledDates","locale","weekdayFormat","allow-outside-interval","format","onSelect"]),[[fr,t.viewShown==="day"]]),nt(M(c,{pageDate:t.pageDate,visible:t.viewShown==="time",selected:t.modelValue,disabledTime:t.disabledTime,onSelect:t.selectTime,onBack:t.goBackFromTimepicker},null,8,["pageDate","visible","selected","disabledTime","onSelect","onBack"]),[[fr,t.viewShown==="time"]])],4)}const gv=Os(x7,[["render",$7]]),O7=L({components:{Datepicker:gv},emits:["change","update:modelValue"],props:{modelValue:{type:Object,default:()=>({start:null,end:null})}},setup(t,{emit:e}){const n=T(t.modelValue.start),r=T(t.modelValue.end),o=vi("startRef"),s=vi("endRef"),i=T(null),a="START",l="END",c="L";He([n,r],()=>{let v={start:null,end:null};n.value&&r.value&&(v={start:gs(n.value,"yyyy-MM-dd"),end:gs(r.value,"yyyy-MM-dd")}),e("update:modelValue",v),e("change",v)});const u=()=>{n.value=null,r.value=null},d=v=>{v.value&&v.value.renderView(v.value.initialView)};return{start:n,end:r,showStartSelector:()=>{i.value=a,d(o)},showEndSelector:()=>{i.value=l,d(s)},hideSelector:()=>{i.value=null},selectorShown:i,selectorShownStart:a,selectorShownEnd:l,locale:Bg(Bd),clear:u,formatDate:Er,formatTemplate:c}}}),M7={class:"rangepicker__hint fr-m-0"},E7={class:"rangepicker__hint fr-m-0"};function N7(t,e,n,r,o,s){const i=Je("Datepicker");return b(),k("div",{class:ae(["rangepicker fr-select",{"rangepicker--selected":t.start}])},[nt(g("div",null,[g("p",M7,C(t.$t("Select lower bound:")),1),M(i,{modelValue:t.start,"onUpdate:modelValue":[e[0]||(e[0]=a=>t.start=a),t.showEndSelector],upperLimit:t.end,locale:t.locale,ref:"startRef"},null,8,["modelValue","upperLimit","locale","onUpdate:modelValue"])],512),[[fr,t.selectorShown===t.selectorShownStart]]),nt(g("div",null,[g("p",E7,C(t.$t("Select upper bound:")),1),M(i,{modelValue:t.end,"onUpdate:modelValue":[e[1]||(e[1]=a=>t.end=a),t.hideSelector],lowerLimit:t.start,locale:t.locale,ref:"endRef"},null,8,["modelValue","lowerLimit","locale","onUpdate:modelValue"])],512),[[fr,t.selectorShown===t.selectorShownEnd]]),t.selectorShown===null?(b(),k("button",{key:0,class:"rangepicker__button w-100 text-align-left",onClick:e[3]||(e[3]=ye((...a)=>t.showStartSelector&&t.showStartSelector(...a),["prevent"]))},[t.start?(b(),k(K,{key:1},[U(C(t.formatDate(t.start,t.formatTemplate)),1),t.end?(b(),k(K,{key:0},[U(""+C(t.formatDate(t.end,t.formatTemplate)),1)],64)):I("",!0),t.start?(b(),k("button",{key:1,class:"fr-fi-close-line clear",onClick:e[2]||(e[2]=ye((...a)=>t.clear&&t.clear(...a),["stop"]))})):I("",!0)],64)):(b(),k(K,{key:0},[U(C(t.$t("from dd/mm/yyyy to dd/mm/yyyy")),1)],64))])):I("",!0)],2)}const D7=ke(O7,[["render",N7]]),ec=Symbol("editorInfoCtxKey");function A7(){const{dom:t,loading:e,editor:n,editorFactory:r}=Ye(ec,{}),o=T();return De(()=>{if(!t.value)return;const s=r.value(t.value);s&&(e.value=!0,o.value=s,s.create().then(i=>{n.value=i}).finally(()=>{e.value=!1}).catch(console.error))}),fn(()=>{var s;(s=o.value)==null||s.destroy().catch(console.error)}),t}const R7=L({name:"Milkdown",setup:()=>{const t=A7();return()=>M("div",{"data-milkdown-root":!0,ref:t},null)}}),I7=L({name:"MilkdownProvider",setup:(t,{slots:e})=>{const n=T(null),r=T(void 0),o=T(void 0),s=T(!0);return at(ec,{loading:s,dom:n,editor:o,editorFactory:r}),()=>{var i;return M(K,null,[(i=e.default)==null?void 0:i.call(e)])}}});function P7(t){const{editorFactory:e,loading:n,editor:r}=Ye(ec);return e.value=t,{loading:n,get:()=>r.value}}function Xi(){const t=Ye(ec);return[t.loading,()=>t.editor.value]}var L7=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},vv=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Qu=(t,e,n)=>(L7(t,e,"access private method"),n),Na,ed;let z7=class{constructor({node:e,view:n,getPos:r,decorations:o,innerDecorations:s,options:i}){vv(this,Na),this.selected=!1,this.selectNode=()=>{var a,l;this.selected=!0,(l=(a=this.options).selectNode)==null||l.call(a)},this.deselectNode=()=>{var a,l;this.selected=!1,(l=(a=this.options).deselectNode)==null||l.call(a)},this.shouldUpdate=a=>!(a.type!==this.node.type||a.sameMarkup(this.node)&&a.content.eq(this.node.content)),this.update=(a,l,c)=>{var u,d;const f=this.options.update;let p;return f&&(p=f(a,l,c)),typeof p!="boolean"&&(p=this.shouldUpdate(a)),this.node=a,this.decorations=l,this.innerDecorations=c,p&&((d=(u=this.options).onUpdate)==null||d.call(u)),p},this.shouldIgnoreMutation=a=>!this.dom||!this.contentDOM||this.node.isLeaf||this.node.isAtom?!0:a.type==="selection"?!1:this.contentDOM===a.target&&a.type==="attributes"?!0:!this.contentDOM.contains(a.target),this.ignoreMutation=a=>{if(!this.dom||!this.contentDOM)return!0;let l;const c=this.options.ignoreMutation;return c&&(l=c(a)),typeof l!="boolean"&&(l=this.shouldIgnoreMutation(a)),l},this.destroy=()=>{var a,l,c;(l=(a=this.options).destroy)==null||l.call(a),this.dom.remove(),(c=this.contentDOM)==null||c.remove()},this.setAttrs=a=>{const{dispatch:l,state:c}=this.view,u=this.getPos();if(typeof u=="number")return l(c.tr.setNodeMarkup(u,void 0,{...this.node.attrs,...a}))},this.node=e,this.view=n,this.getPos=r,this.decorations=o,this.innerDecorations=s,this.options=i,this.dom=this.createDOM(i.as),this.contentDOM=e.isLeaf?null:this.createContentDOM(i.contentAs),this.dom.setAttribute("data-node-view-root","true"),this.contentDOM&&(this.contentDOM.setAttribute("data-node-view-content","true"),this.contentDOM.style.whiteSpace="inherit"),this.setSelection=i.setSelection,this.stopEvent=i.stopEvent}createDOM(e){return Qu(this,Na,ed).call(this,e)}createContentDOM(e){return Qu(this,Na,ed).call(this,e)}get component(){return this.options.component}};Na=new WeakSet,ed=function(t){const{node:e}=this;return t==null?document.createElement(e.isInline?"span":"div"):t instanceof HTMLElement?t:t instanceof Function?t(e):document.createElement(t)};class B7{constructor(e){this.view=e.view,this.options=e.options}get component(){return this.options.component}get root(){var o;var e,n;let r=(n=(e=this.options).root)==null?void 0:n.call(e,this.view.dom);return r||(r=(o=this.view.dom.parentElement)!=null?o:document.body),r}update(e,n){var r,o;this.view=e,this.prevState=n,(o=(r=this.options).update)==null||o.call(r,e,n)}destroy(){var e,n;(n=(e=this.options).destroy)==null||n.call(e)}}var td,yv;let F7=class{constructor({pos:e,spec:n,options:r}){vv(this,td),this.pos=e,this.options=r,this.spec=n,this.dom=Qu(this,td,yv).call(this,r.as),this.dom.setAttribute("data-widget-view-root","true")}bind(e,n){this.view=e,this.getPos=n}get component(){return this.options.component}};td=new WeakSet,yv=function(t){return t instanceof HTMLElement?t:document.createElement(t)};let uf=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");function gt(t){this.content=t}gt.prototype={constructor:gt,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,o=r.find(t),s=r.content.slice();return o==-1?s.push(n||t,e):(s[o+1]=e,n&&(s[o]=n)),new gt(s)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new gt(n)},addToStart:function(t,e){return new gt([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new gt(n)},addBefore:function(t,e,n){var r=this.remove(e),o=r.content.slice(),s=r.find(t);return o.splice(s==-1?o.length:s,0,e,n),new gt(o)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=gt.from(t),t.size?new gt(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=gt.from(t),t.size?new gt(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=gt.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};gt.from=function(t){if(t instanceof gt)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new gt(e)};function bv(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let o=t.child(r),s=e.child(r);if(o==s){n+=o.nodeSize;continue}if(!o.sameMarkup(s))return n;if(o.isText&&o.text!=s.text){for(let i=0;o.text[i]==s.text[i];i++)n++;return n}if(o.content.size||s.content.size){let i=bv(o.content,s.content,n+1);if(i!=null)return i}n+=o.nodeSize}}function wv(t,e,n,r){for(let o=t.childCount,s=e.childCount;;){if(o==0||s==0)return o==s?null:{a:n,b:r};let i=t.child(--o),a=e.child(--s),l=i.nodeSize;if(i==a){n-=l,r-=l;continue}if(!i.sameMarkup(a))return{a:n,b:r};if(i.isText&&i.text!=a.text){let c=0,u=Math.min(i.text.length,a.text.length);for(;c<u&&i.text[i.text.length-c-1]==a.text[a.text.length-c-1];)c++,n--,r--;return{a:n,b:r}}if(i.content.size||a.content.size){let c=wv(i.content,a.content,n-1,r-1);if(c)return c}n-=l,r-=l}}class V{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,o=0,s){for(let i=0,a=0;a<n;i++){let l=this.content[i],c=a+l.nodeSize;if(c>e&&r(l,o+a,s||null,i)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,n-u),r,o+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,o){let s="",i=!0;return this.nodesBetween(e,n,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,n-l):a.isLeaf?o?typeof o=="function"?o(a):o:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(i?i=!1:s+=r),s+=c},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,o=this.content.slice(),s=0;for(n.isText&&n.sameMarkup(r)&&(o[o.length-1]=n.withText(n.text+r.text),s=1);s<e.content.length;s++)o.push(e.content[s]);return new V(o,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],o=0;if(n>e)for(let s=0,i=0;i<n;s++){let a=this.content[s],l=i+a.nodeSize;l>e&&((i<e||l>n)&&(a.isText?a=a.cut(Math.max(0,e-i),Math.min(a.text.length,n-i)):a=a.cut(Math.max(0,e-i-1),Math.min(a.content.size,n-i-1))),r.push(a),o+=a.nodeSize),i=l}return new V(r,o)}cutByIndex(e,n){return e==n?V.empty:e==0&&n==this.content.length?this:new V(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let o=this.content.slice(),s=this.size+n.nodeSize-r.nodeSize;return o[e]=n,new V(o,s)}addToStart(e){return new V([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new V(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let o=this.content[n];e(o,r,n),r+=o.nodeSize}}findDiffStart(e,n=0){return bv(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return wv(this,e,n,r)}findIndex(e){if(e==0)return Ca(0,e);if(e==this.size)return Ca(this.content.length,e);if(e>this.size||e<0)throw new RangeError("Position ".concat(e," outside of fragment (").concat(this,")"));for(let n=0,r=0;;n++){let o=this.child(n),s=r+o.nodeSize;if(s>=e)return s==e?Ca(n+1,s):Ca(n,r);r=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return V.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new V(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return V.empty;let n,r=0;for(let o=0;o<e.length;o++){let s=e[o];r+=s.nodeSize,o&&s.isText&&e[o-1].sameMarkup(s)?(n||(n=e.slice(0,o)),n[n.length-1]=s.withText(n[n.length-1].text+s.text)):n&&n.push(s)}return new V(n||e,r)}static from(e){if(!e)return V.empty;if(e instanceof V)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new V([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}V.empty=new V([],0);const jc={index:0,offset:0};function Ca(t,e){return jc.index=t,jc.offset=e,jc}function gl(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!gl(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!gl(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}class Se{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let o=0;o<e.length;o++){let s=e[o];if(this.eq(s))return e;if(this.type.excludes(s.type))n||(n=e.slice(0,o));else{if(s.type.excludes(this.type))return e;!r&&s.type.rank>this.type.rank&&(n||(n=e.slice(0,o)),n.push(this),r=!0),n&&n.push(s)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&gl(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError("There is no mark type ".concat(n.type," in this schema"));let o=r.create(n.attrs);return r.checkAttrs(o.attrs),o}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Se.none;if(e instanceof Se)return[e];let n=e.slice();return n.sort((r,o)=>r.type.rank-o.type.rank),n}}Se.none=[];class vl extends Error{}let J=class Io{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=Cv(this.content,e+this.openStart,n);return r&&new Io(r,this.openStart,this.openEnd)}removeBetween(e,n){return new Io(kv(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return Io.empty;let r=n.openStart||0,o=n.openEnd||0;if(typeof r!="number"||typeof o!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Io(V.fromJSON(e,n.content),r,o)}static maxOpen(e,n=!0){let r=0,o=0;for(let s=e.firstChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=e.lastChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.lastChild)o++;return new Io(e,r,o)}};J.empty=new J(V.empty,0,0);function kv(t,e,n){let{index:r,offset:o}=t.findIndex(e),s=t.maybeChild(r),{index:i,offset:a}=t.findIndex(n);if(o==e||s.isText){if(a!=n&&!t.child(i).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=i)throw new RangeError("Removing non-flat range");return t.replaceChild(r,s.copy(kv(s.content,e-o-1,n-o-1)))}function Cv(t,e,n,r){let{index:o,offset:s}=t.findIndex(e),i=t.maybeChild(o);if(s==e||i.isText)return r&&!r.canReplace(o,o,n)?null:t.cut(0,e).append(n).append(t.cut(e));let a=Cv(i.content,e-s-1,n,i);return a&&t.replaceChild(o,i.copy(a))}function V7(t,e,n){if(n.openStart>t.depth)throw new vl("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new vl("Inconsistent open depths");return xv(t,e,n,0)}function xv(t,e,n,r){let o=t.index(r),s=t.node(r);if(o==e.index(r)&&r<t.depth-n.openStart){let i=xv(t,e,n,r+1);return s.copy(s.content.replaceChild(o,i))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let i=t.parent,a=i.content;return ro(i,a.cut(0,t.parentOffset).append(n.content).append(a.cut(e.parentOffset)))}else{let{start:i,end:a}=H7(n,t);return ro(s,_v(t,i,a,e,r))}else return ro(s,yl(t,e,r))}function Sv(t,e){if(!e.type.compatibleContent(t.type))throw new vl("Cannot join "+e.type.name+" onto "+t.type.name)}function nd(t,e,n){let r=t.node(n);return Sv(r,e.node(n)),r}function no(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function ri(t,e,n,r){let o=(e||t).node(n),s=0,i=e?e.index(n):o.childCount;t&&(s=t.index(n),t.depth>n?s++:t.textOffset&&(no(t.nodeAfter,r),s++));for(let a=s;a<i;a++)no(o.child(a),r);e&&e.depth==n&&e.textOffset&&no(e.nodeBefore,r)}function ro(t,e){return t.type.checkContent(e),t.copy(e)}function _v(t,e,n,r,o){let s=t.depth>o&&nd(t,e,o+1),i=r.depth>o&&nd(n,r,o+1),a=[];return ri(null,t,o,a),s&&i&&e.index(o)==n.index(o)?(Sv(s,i),no(ro(s,_v(t,e,n,r,o+1)),a)):(s&&no(ro(s,yl(t,e,o+1)),a),ri(e,n,o,a),i&&no(ro(i,yl(n,r,o+1)),a)),ri(r,null,o,a),new V(a)}function yl(t,e,n){let r=[];if(ri(null,t,n,r),t.depth>n){let o=nd(t,e,n+1);no(ro(o,yl(t,e,n+1)),r)}return ri(e,null,n,r),new V(r)}function H7(t,e){let n=e.depth-t.openStart,o=e.node(n).copy(t.content);for(let s=n-1;s>=0;s--)o=e.node(s).copy(V.from(o));return{start:o.resolveNoCache(t.openStart+n),end:o.resolveNoCache(o.content.size-t.openEnd-n)}}class wi{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],o=e.child(n);return r?e.child(n).cut(r):o}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],o=n==0?0:this.path[n*3-1]+1;for(let s=0;s<e;s++)o+=r.child(s).nodeSize;return o}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return Se.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),o=e.maybeChild(n);if(!r){let a=r;r=o,o=a}let s=r.marks;for(var i=0;i<s.length;i++)s[i].type.spec.inclusive===!1&&(!o||!s[i].isInSet(o.marks))&&(s=s[i--].removeFromSet(s));return s}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,o=e.parent.maybeChild(e.index());for(var s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!o||!r[s].isInSet(o.marks))&&(r=r[s--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new Tv(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],o=0,s=n;for(let i=e;;){let{index:a,offset:l}=i.content.findIndex(s),c=s-l;if(r.push(i,a,o+l),!c||(i=i.child(a),i.isText))break;s=c-1,o+=l+1}return new wi(n,r,s)}static resolveCached(e,n){let r=Xp.get(e);if(r)for(let s=0;s<r.elts.length;s++){let i=r.elts[s];if(i.pos==n)return i}else Xp.set(e,r=new q7);let o=r.elts[r.i]=wi.resolve(e,n);return r.i=(r.i+1)%U7,o}}class q7{constructor(){this.elts=[],this.i=0}}const U7=12,Xp=new WeakMap;class Tv{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const W7=Object.create(null);let Gn=class rd{constructor(e,n,r,o=Se.none){this.type=e,this.attrs=n,this.marks=o,this.content=r||V.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,o=0){this.content.nodesBetween(e,n,r,o,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,o){return this.content.textBetween(e,n,r,o)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&gl(this.attrs,n||e.defaultAttrs||W7)&&Se.sameSet(this.marks,r||Se.none)}copy(e=null){return e==this.content?this:new rd(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new rd(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return J.empty;let o=this.resolve(e),s=this.resolve(n),i=r?0:o.sharedDepth(n),a=o.start(i),c=o.node(i).content.cut(o.pos-a,s.pos-a);return new J(c,o.depth-i,s.depth-i)}replace(e,n,r){return V7(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:o}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(o==e||n.isText)return n;e-=o+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}}resolve(e){return wi.resolveCached(this,e)}resolveNoCache(e){return wi.resolve(this,e)}rangeHasMark(e,n,r){let o=!1;return n>e&&this.nodesBetween(e,n,s=>(r.isInSet(s.marks)&&(o=!0),!o)),o}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),$v(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=V.empty,o=0,s=r.childCount){let i=this.contentMatchAt(e).matchFragment(r,o,s),a=i&&i.matchFragment(this.content,n);if(!a||!a.validEnd)return!1;for(let l=o;l<s;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,n,r,o){if(o&&!this.type.allowsMarks(o))return!1;let s=this.contentMatchAt(e).matchType(r),i=s&&s.matchFragment(this.content,n);return i?i.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Se.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Se.sameSet(e,this.marks))throw new RangeError("Invalid collection of marks for node ".concat(this.type.name,": ").concat(this.marks.map(n=>n.type.name)));this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let o=V.fromJSON(e,n.content),s=e.nodeType(n.type).create(n.attrs,o,r);return s.type.checkAttrs(s.attrs),s}};Gn.prototype.text=void 0;class bl extends Gn{constructor(e,n,r,o){if(super(e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):$v(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new bl(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new bl(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function $v(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class vo{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new j7(e,n);if(r.next==null)return vo.empty;let o=Ov(r);r.next&&r.err("Unexpected trailing text");let s=Q7(Z7(o));return eM(s,r),s}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let o=this;for(let s=n;o&&s<r;s++)o=o.matchType(e.child(s).type);return o}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let o=[this];function s(i,a){let l=i.matchFragment(e,r);if(l&&(!n||l.validEnd))return V.from(a.map(c=>c.createAndFill()));for(let c=0;c<i.next.length;c++){let{type:u,next:d}=i.next[c];if(!(u.isText||u.hasRequiredAttrs())&&o.indexOf(d)==-1){o.push(d);let f=s(d,a.concat(u));if(f)return f}}return null}return s(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let o=r.shift(),s=o.match;if(s.matchType(e)){let i=[];for(let a=o;a.type;a=a.via)i.push(a.type);return i.reverse()}for(let i=0;i<s.next.length;i++){let{type:a,next:l}=s.next[i];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in n)&&(!o.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:o}),n[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError("There's no ".concat(e,"th edge in this content match"));return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let o=0;o<r.next.length;o++)e.indexOf(r.next[o].next)==-1&&n(r.next[o].next)}return n(this),e.map((r,o)=>{let s=o+(r.validEnd?"*":" ")+" ";for(let i=0;i<r.next.length;i++)s+=(i?", ":"")+r.next[i].type.name+"->"+e.indexOf(r.next[i].next);return s}).join("\n")}}vo.empty=new vo(!0);class j7{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function Ov(t){let e=[];do e.push(K7(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function K7(t){let e=[];do e.push(Y7(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function Y7(t){let e=X7(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=G7(t,e);else break;return e}function Zp(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function G7(t,e){let n=Zp(t),r=n;return t.eat(",")&&(t.next!="}"?r=Zp(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function J7(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let o=[];for(let s in n){let i=n[s];i.isInGroup(e)&&o.push(i)}return o.length==0&&t.err("No node type or group '"+e+"' found"),o}function X7(t){if(t.eat("(")){let e=Ov(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=J7(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function Z7(t){let e=[[]];return o(s(t,0),n()),e;function n(){return e.push([])-1}function r(i,a,l){let c={term:l,to:a};return e[i].push(c),c}function o(i,a){i.forEach(l=>l.to=a)}function s(i,a){if(i.type=="choice")return i.exprs.reduce((l,c)=>l.concat(s(c,a)),[]);if(i.type=="seq")for(let l=0;;l++){let c=s(i.exprs[l],a);if(l==i.exprs.length-1)return c;o(c,a=n())}else if(i.type=="star"){let l=n();return r(a,l),o(s(i.expr,l),l),[r(l)]}else if(i.type=="plus"){let l=n();return o(s(i.expr,a),l),o(s(i.expr,l),l),[r(l)]}else{if(i.type=="opt")return[r(a)].concat(s(i.expr,a));if(i.type=="range"){let l=a;for(let c=0;c<i.min;c++){let u=n();o(s(i.expr,l),u),l=u}if(i.max==-1)o(s(i.expr,l),l);else for(let c=i.min;c<i.max;c++){let u=n();r(l,u),o(s(i.expr,l),u),l=u}return[r(l)]}else{if(i.type=="name")return[r(a,void 0,i.value)];throw new Error("Unknown expr type")}}}}function Mv(t,e){return e-t}function Qp(t,e){let n=[];return r(e),n.sort(Mv);function r(o){let s=t[o];if(s.length==1&&!s[0].term)return r(s[0].to);n.push(o);for(let i=0;i<s.length;i++){let{term:a,to:l}=s[i];!a&&n.indexOf(l)==-1&&r(l)}}}function Q7(t){let e=Object.create(null);return n(Qp(t,0));function n(r){let o=[];r.forEach(i=>{t[i].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<o.length;u++)o[u][0]==a&&(c=o[u][1]);Qp(t,l).forEach(u=>{c||o.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let s=e[r.join(",")]=new vo(r.indexOf(t.length-1)>-1);for(let i=0;i<o.length;i++){let a=o[i][1].sort(Mv);s.next.push({type:o[i][0],next:e[a.join(",")]||n(a)})}return s}}function eM(t,e){for(let n=0,r=[t];n<r.length;n++){let o=r[n],s=!o.validEnd,i=[];for(let a=0;a<o.next.length;a++){let{type:l,next:c}=o.next[a];i.push(l.name),s&&!(l.isText||l.hasRequiredAttrs())&&(s=!1),r.indexOf(c)==-1&&r.push(c)}s&&e.err("Only non-generatable nodes ("+i.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Ev(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function Nv(t,e){let n=Object.create(null);for(let r in t){let o=e&&e[r];if(o===void 0){let s=t[r];if(s.hasDefault)o=s.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=o}return n}function Dv(t,e,n,r){for(let o in e)if(!(o in t))throw new RangeError("Unsupported attribute ".concat(o," for ").concat(n," of type ").concat(o));for(let o in t){let s=t[o];s.validate&&s.validate(e[o])}}function Av(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new nM(t,r,e[r]);return n}let em=class Rv{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=Av(e,r.attrs),this.defaultAttrs=Ev(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==vo.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:Nv(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Gn(this,this.computeAttrs(e),V.from(n),Se.setFrom(r))}createChecked(e=null,n,r){return n=V.from(n),this.checkContent(n),new Gn(this,this.computeAttrs(e),n,Se.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=V.from(n),n.size){let i=this.contentMatch.fillBefore(n);if(!i)return null;n=i.append(n)}let o=this.contentMatch.matchFragment(n),s=o&&o.fillBefore(V.empty,!0);return s?new Gn(this,e,n.append(s),Se.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError("Invalid content for node ".concat(this.name,": ").concat(e.toString().slice(0,50)))}checkAttrs(e){Dv(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:Se.none:e}static compile(e,n){let r=Object.create(null);e.forEach((s,i)=>r[s]=new Rv(s,n,i));let o=n.spec.topNode||"doc";if(!r[o])throw new RangeError("Schema is missing its top node type ('"+o+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let s in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function tM(t,e,n){let r=n.split("|");return o=>{let s=o===null?"null":typeof o;if(r.indexOf(s)<0)throw new RangeError("Expected value of type ".concat(r," for attribute ").concat(e," on type ").concat(t,", got ").concat(s))}}class nM{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?tM(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class tc{constructor(e,n,r,o){this.name=e,this.rank=n,this.schema=r,this.spec=o,this.attrs=Av(e,o.attrs),this.excluded=null;let s=Ev(this.attrs);this.instance=s?new Se(this,s):null}create(e=null){return!e&&this.instance?this.instance:new Se(this,Nv(this.attrs,e))}static compile(e,n){let r=Object.create(null),o=0;return e.forEach((s,i)=>r[s]=new tc(s,o++,n,i)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){Dv(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class rM{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let o in e)n[o]=e[o];n.nodes=gt.from(e.nodes),n.marks=gt.from(e.marks||{}),this.nodes=em.compile(this.spec.nodes,this),this.marks=tc.compile(this.spec.marks,this);let r=Object.create(null);for(let o in this.nodes){if(o in this.marks)throw new RangeError(o+" can not be both a node and a mark");let s=this.nodes[o],i=s.spec.content||"",a=s.spec.marks;if(s.contentMatch=r[i]||(r[i]=vo.parse(i,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=a=="_"?null:a?tm(this,a.split(" ")):a==""||!s.inlineContent?[]:null}for(let o in this.marks){let s=this.marks[o],i=s.spec.excludes;s.excluded=i==null?[s]:i==""?[]:tm(this,i.split(" "))}this.nodeFromJSON=o=>Gn.fromJSON(this,o),this.markFromJSON=o=>Se.fromJSON(this,o),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,o){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof em){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,o)}text(e,n){let r=this.nodes.text;return new bl(r,r.defaultAttrs,e,Se.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function tm(t,e){let n=[];for(let r=0;r<e.length;r++){let o=e[r],s=t.marks[o],i=s;if(s)n.push(s);else for(let a in t.marks){let l=t.marks[a];(o=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(o)>-1)&&n.push(i=l)}if(!i)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function oM(t){return t.tag!=null}function sM(t){return t.style!=null}class ys{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(o=>{if(oM(o))this.tags.push(o);else if(sM(o)){let s=/[^=]*/.exec(o.style)[0];r.indexOf(s)<0&&r.push(s),this.styles.push(o)}}),this.normalizeLists=!this.tags.some(o=>{if(!/^(ul|ol)\b/.test(o.tag)||!o.node)return!1;let s=e.nodes[o.node];return s.contentMatch.matchType(s)})}parse(e,n={}){let r=new rm(this,n,!1);return r.addAll(e,Se.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new rm(this,n,!0);return r.addAll(e,Se.none,n.from,n.to),J.maxOpen(r.finish())}matchTag(e,n,r){for(let o=r?this.tags.indexOf(r)+1:0;o<this.tags.length;o++){let s=this.tags[o];if(lM(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||n.matchesContext(s.context))){if(s.getAttrs){let i=s.getAttrs(e);if(i===!1)continue;s.attrs=i||void 0}return s}}}matchStyle(e,n,r,o){for(let s=o?this.styles.indexOf(o)+1:0;s<this.styles.length;s++){let i=this.styles[s],a=i.style;if(!(a.indexOf(e)!=0||i.context&&!r.matchesContext(i.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=n))){if(i.getAttrs){let l=i.getAttrs(n);if(l===!1)continue;i.attrs=l||void 0}return i}}}static schemaRules(e){let n=[];function r(o){let s=o.priority==null?50:o.priority,i=0;for(;i<n.length;i++){let a=n[i];if((a.priority==null?50:a.priority)<s)break}n.splice(i,0,o)}for(let o in e.marks){let s=e.marks[o].spec.parseDOM;s&&s.forEach(i=>{r(i=om(i)),i.mark||i.ignore||i.clearMark||(i.mark=o)})}for(let o in e.nodes){let s=e.nodes[o].spec.parseDOM;s&&s.forEach(i=>{r(i=om(i)),i.node||i.ignore||i.mark||(i.node=o)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new ys(e,ys.schemaRules(e)))}}const Iv={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},iM={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Pv={ol:!0,ul:!0},ki=1,od=2,oi=4;function nm(t,e,n){return e!=null?(e?ki:0)|(e==="full"?od:0):t&&t.whitespace=="pre"?ki|od:n&~oi}class xa{constructor(e,n,r,o,s,i){this.type=e,this.attrs=n,this.marks=r,this.solid=o,this.options=i,this.content=[],this.activeMarks=Se.none,this.match=s||(i&oi?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(V.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,o;return(o=r.findWrapping(e.type))?(this.match=r,o):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&ki)){let r=this.content[this.content.length-1],o;if(r&&r.isText&&(o=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==o[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-o[0].length))}}let n=V.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(V.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Iv.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class rm{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let o=n.topNode,s,i=nm(null,n.preserveWhitespace,0)|(r?oi:0);o?s=new xa(o.type,o.attrs,Se.none,!0,n.topMatch||o.type.contentMatch,i):r?s=new xa(null,null,Se.none,!0,null,i):s=new xa(e.schema.topNodeType,null,Se.none,!0,null,i),this.nodes=[s],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,o=this.top,s=o.options&od?"full":this.localPreserveWS||(o.options&ki)>0;if(s==="full"||o.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(s)s!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,"\n");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let i=o.content[o.content.length-1],a=e.previousSibling;(!i||a&&a.nodeName=="BR"||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),n,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let o=this.localPreserveWS,s=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let i=e.nodeName.toLowerCase(),a;Pv.hasOwnProperty(i)&&this.parser.normalizeLists&&aM(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,r));e:if(l?l.ignore:iM.hasOwnProperty(i))this.findInside(e),this.ignoreFallback(e,n);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let c,u=this.needsBlock;if(Iv.hasOwnProperty(i))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),c=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let d=l&&l.skip?n:this.readStyles(e,n);d&&this.addAll(e,d),c&&this.sync(s),this.needsBlock=u}else{let c=this.readStyles(e,n);c&&this.addElementByRule(e,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=o}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let o=0;o<this.parser.matchedStyles.length;o++){let s=this.parser.matchedStyles[o],i=r.getPropertyValue(s);if(i)for(let a=void 0;;){let l=this.parser.matchStyle(s,i,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?n=n.filter(c=>!l.clearMark(c)):n=n.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return n}addElementByRule(e,n,r,o){let s,i;if(n.node)if(i=this.parser.schema.nodes[n.node],i.isLeaf)this.insertNode(i.create(n.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let l=this.enter(i,n.attrs||null,r,n.preserveWhitespace);l&&(s=!0,r=l)}else{let l=this.parser.schema.marks[n.mark];r=r.concat(l.create(n.attrs))}let a=this.top;if(i&&i.isLeaf)this.findInside(e);else if(o)this.addElement(e,r,o);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r,!1));else{let l=e;typeof n.contentElement=="string"?l=e.querySelector(n.contentElement):typeof n.contentElement=="function"?l=n.contentElement(e):n.contentElement&&(l=n.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}s&&this.sync(a)&&this.open--}addAll(e,n,r,o){let s=r||0;for(let i=r?e.childNodes[r]:e.firstChild,a=o==null?null:e.childNodes[o];i!=a;i=i.nextSibling,++s)this.findAtPoint(e,s),this.addDOM(i,n);this.findAtPoint(e,s)}findPlace(e,n,r){let o,s;for(let i=this.open,a=0;i>=0;i--){let l=this.nodes[i],c=l.findWrapping(e);if(c&&(!o||o.length>c.length+a)&&(o=c,s=l,!c.length))break;if(l.solid){if(r)break;a+=2}}if(!o)return null;this.sync(s);for(let i=0;i<o.length;i++)n=this.enterInner(o[i],null,n,!1);return n}insertNode(e,n,r){if(e.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&(n=this.enterInner(s,null,n))}let o=this.findPlace(e,n,r);if(o){this.closeExtra();let s=this.top;s.match&&(s.match=s.match.matchType(e.type));let i=Se.none;for(let a of o.concat(e.marks))(s.type?s.type.allowsMarkType(a.type):sm(a.type,e.type))&&(i=a.addToSet(i));return s.content.push(e.mark(i)),!0}return!1}enter(e,n,r,o){let s=this.findPlace(e.create(n),r,!1);return s&&(s=this.enterInner(e,n,r,!0,o)),s}enterInner(e,n,r,o=!1,s){this.closeExtra();let i=this.top;i.match=i.match&&i.match.matchType(e);let a=nm(e,s,i.options);i.options&oi&&i.content.length==0&&(a|=oi);let l=Se.none;return r=r.filter(c=>(i.type?i.type.allowsMarkType(c.type):sm(c.type,e))?(l=c.addToSet(l),!1):!0),this.nodes.push(new xa(e,n,l,o,null,a)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=ki)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let o=r.length-1;o>=0;o--)e+=r[o].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let o=0;o<this.find.length;o++)this.find[o].pos==null&&e.nodeType==1&&e.contains(this.find[o].node)&&n.compareDocumentPosition(this.find[o].node)&(r?2:4)&&(this.find[o].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,o=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),s=-(r?r.depth+1:0)+(o?0:1),i=(a,l)=>{for(;a>=0;a--){let c=n[a];if(c==""){if(a==n.length-1||a==0)continue;for(;l>=s;l--)if(i(a-1,l))return!0;return!1}else{let u=l>0||l==0&&o?this.nodes[l].type:r&&l>=s?r.node(l-s).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;l--}}return!0};return i(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function aM(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&Pv.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function lM(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function om(t){let e={};for(let n in t)e[n]=t[n];return e}function sm(t,e){let n=e.schema.nodes;for(let r in n){let o=n[r];if(!o.allowsMarkType(t))continue;let s=[],i=a=>{s.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||s.indexOf(u)<0&&i(u))return!0}};if(i(o.contentMatch))return!0}}class Ms{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=Kc(n).createDocumentFragment());let o=r,s=[];return e.forEach(i=>{if(s.length||i.marks.length){let a=0,l=0;for(;a<s.length&&l<i.marks.length;){let c=i.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(s[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<s.length;)o=s.pop()[1];for(;l<i.marks.length;){let c=i.marks[l++],u=this.serializeMark(c,i.isInline,n);u&&(s.push([c,o]),o.appendChild(u.dom),o=u.contentDOM||u.dom)}}o.appendChild(this.serializeNodeInner(i,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:o}=Da(Kc(n),this.nodes[e.type.name](e),null,e.attrs);if(o){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,o)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let o=e.marks.length-1;o>=0;o--){let s=this.serializeMark(e.marks[o],e.isInline,n);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(e,n,r={}){let o=this.marks[e.type.name];return o&&Da(Kc(r),o(e,n),null,e.attrs)}static renderSpec(e,n,r=null,o){return Da(e,n,r,o)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Ms(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=im(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return im(e.marks)}}function im(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function Kc(t){return t.document||window.document}const am=new WeakMap;function cM(t){let e=am.get(t);return e===void 0&&am.set(t,e=uM(t)),e}function uM(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let o=0;o<r.length;o++)n(r[o]);else for(let o in r)n(r[o])}return n(t),e}function Da(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let o=e[0],s;if(typeof o!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(s=cM(r))&&s.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let i=o.indexOf(" ");i>0&&(n=o.slice(0,i),o=o.slice(i+1));let a,l=n?t.createElementNS(n,o):t.createElement(o),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let d in c)if(c[d]!=null){let f=d.indexOf(" ");f>0?l.setAttributeNS(d.slice(0,f),d.slice(f+1),c[d]):d=="style"&&l.style?l.style.cssText=c[d]:l.setAttribute(d,c[d])}}for(let d=u;d<e.length;d++){let f=e[d];if(f===0){if(d<e.length-1||d>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:p,contentDOM:h}=Da(t,f,n,r);if(l.appendChild(p),h){if(a)throw new RangeError("Multiple content holes");a=h}}}return{dom:l,contentDOM:a}}const Lv=65535,zv=Math.pow(2,16);function dM(t,e){return t+e*zv}function lm(t){return t&Lv}function fM(t){return(t-(t&Lv))/zv}const Bv=1,Fv=2,Aa=4,Vv=8;class sd{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&Vv)>0}get deletedBefore(){return(this.delInfo&(Bv|Aa))>0}get deletedAfter(){return(this.delInfo&(Fv|Aa))>0}get deletedAcross(){return(this.delInfo&Aa)>0}}class Vt{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&Vt.empty)return Vt.empty}recover(e){let n=0,r=lm(e);if(!this.inverted)for(let o=0;o<r;o++)n+=this.ranges[o*3+2]-this.ranges[o*3+1];return this.ranges[r*3]+n+fM(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let o=0,s=this.inverted?2:1,i=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?o:0);if(l>e)break;let c=this.ranges[a+s],u=this.ranges[a+i],d=l+c;if(e<=d){let f=c?e==l?-1:e==d?1:n:n,p=l+o+(f<0?0:u);if(r)return p;let h=e==(n<0?l:d)?null:dM(a/3,e-l),v=e==l?Fv:e==d?Bv:Aa;return(n<0?e!=l:e!=d)&&(v|=Vv),new sd(p,v,h)}o+=u-c}return r?e+o:new sd(e+o,0,null)}touches(e,n){let r=0,o=lm(n),s=this.inverted?2:1,i=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+s],u=l+c;if(e<=u&&a==o*3)return!0;r+=this.ranges[a+i]-c}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let o=0,s=0;o<this.ranges.length;o+=3){let i=this.ranges[o],a=i-(this.inverted?s:0),l=i+(this.inverted?0:s),c=this.ranges[o+n],u=this.ranges[o+r];e(a,a+c,l,l+u),s+=u-c}}invert(){return new Vt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Vt.empty:new Vt(e<0?[0,-e,0]:[0,0,e])}}Vt.empty=new Vt([]);class Ci{constructor(e,n,r=0,o=e?e.length:0){this.mirror=n,this.from=r,this.to=o,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new Ci(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let o=e.getMirror(n);this.appendMap(e._maps[n],o!=null&&o<n?r+o:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let o=e.getMirror(n);this.appendMap(e._maps[n].invert(),o!=null&&o>n?r-o-1:void 0)}}invert(){let e=new Ci;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let o=0;for(let s=this.from;s<this.to;s++){let i=this._maps[s],a=i.mapResult(e,n);if(a.recover!=null){let l=this.getMirror(s);if(l!=null&&l>s&&l<this.to){s=l,e=this._maps[l].recover(a.recover);continue}}o|=a.delInfo,e=a.pos}return r?e:new sd(e,o,null)}}const Yc=Object.create(null);class _t{getMap(){return Vt.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Yc[n.stepType];if(!r)throw new RangeError("No step type ".concat(n.stepType," defined"));return r.fromJSON(e,n)}static jsonID(e,n){if(e in Yc)throw new RangeError("Duplicate use of step JSON ID "+e);return Yc[e]=n,n.prototype.jsonID=e,n}}class ot{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new ot(e,null)}static fail(e){return new ot(null,e)}static fromReplace(e,n,r,o){try{return ot.ok(e.replace(n,r,o))}catch(s){if(s instanceof vl)return ot.fail(s.message);throw s}}}function df(t,e,n){let r=[];for(let o=0;o<t.childCount;o++){let s=t.child(o);s.content.size&&(s=s.copy(df(s.content,e,s))),s.isInline&&(s=e(s,n,o)),r.push(s)}return V.fromArray(r)}class Kn extends _t{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),o=r.node(r.sharedDepth(this.to)),s=new J(df(n.content,(i,a)=>!i.isAtom||!a.type.allowsMarkType(this.mark.type)?i:i.mark(this.mark.addToSet(i.marks)),o),n.openStart,n.openEnd);return ot.fromReplace(e,this.from,this.to,s)}invert(){return new Sn(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Kn(n.pos,r.pos,this.mark)}merge(e){return e instanceof Kn&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Kn(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Kn(n.from,n.to,e.markFromJSON(n.mark))}}_t.jsonID("addMark",Kn);class Sn extends _t{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new J(df(n.content,o=>o.mark(this.mark.removeFromSet(o.marks)),e),n.openStart,n.openEnd);return ot.fromReplace(e,this.from,this.to,r)}invert(){return new Kn(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Sn(n.pos,r.pos,this.mark)}merge(e){return e instanceof Sn&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Sn(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Sn(n.from,n.to,e.markFromJSON(n.mark))}}_t.jsonID("removeMark",Sn);class wr extends _t{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return ot.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return ot.fromReplace(e,this.pos,this.pos+1,new J(V.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let o=0;o<n.marks.length;o++)if(!n.marks[o].isInSet(r))return new wr(this.pos,n.marks[o]);return new wr(this.pos,this.mark)}}return new yo(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new wr(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new wr(n.pos,e.markFromJSON(n.mark))}}_t.jsonID("addNodeMark",wr);class yo extends _t{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return ot.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return ot.fromReplace(e,this.pos,this.pos+1,new J(V.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new wr(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new yo(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new yo(n.pos,e.markFromJSON(n.mark))}}_t.jsonID("removeNodeMark",yo);class ft extends _t{constructor(e,n,r,o=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=o}apply(e){return this.structure&&id(e,this.from,this.to)?ot.fail("Structure replace would overwrite content"):ot.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Vt([this.from,this.to-this.from,this.slice.size])}invert(e){return new ft(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new ft(n.pos,Math.max(n.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof ft)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?J.empty:new J(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new ft(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?J.empty:new J(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new ft(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ft(n.from,n.to,J.fromJSON(e,n.slice),!!n.structure)}}_t.jsonID("replace",ft);class St extends _t{constructor(e,n,r,o,s,i,a=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=o,this.slice=s,this.insert=i,this.structure=a}apply(e){if(this.structure&&(id(e,this.from,this.gapFrom)||id(e,this.gapTo,this.to)))return ot.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return ot.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?ot.fromReplace(e,this.from,this.to,r):ot.fail("Content does not fit in gap")}getMap(){return new Vt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new St(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),o=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),s=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||o<n.pos||s>r.pos?null:new St(n.pos,r.pos,o,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new St(n.from,n.to,n.gapFrom,n.gapTo,J.fromJSON(e,n.slice),n.insert,!!n.structure)}}_t.jsonID("replaceAround",St);function id(t,e,n){let r=t.resolve(e),o=n-e,s=r.depth;for(;o>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,o--;if(o>0){let i=r.node(s).maybeChild(r.indexAfter(s));for(;o>0;){if(!i||i.isLeaf)return!0;i=i.firstChild,o--}}return!1}function hM(t,e,n,r){let o=[],s=[],i,a;t.doc.nodesBetween(e,n,(l,c,u)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let f=Math.max(c,e),p=Math.min(c+l.nodeSize,n),h=r.addToSet(d);for(let v=0;v<d.length;v++)d[v].isInSet(h)||(i&&i.to==f&&i.mark.eq(d[v])?i.to=p:o.push(i=new Sn(f,p,d[v])));a&&a.to==f?a.to=p:s.push(a=new Kn(f,p,r))}}),o.forEach(l=>t.step(l)),s.forEach(l=>t.step(l))}function pM(t,e,n,r){let o=[],s=0;t.doc.nodesBetween(e,n,(i,a)=>{if(!i.isInline)return;s++;let l=null;if(r instanceof tc){let c=i.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(i.marks)&&(l=[r]):l=i.marks;if(l&&l.length){let c=Math.min(a+i.nodeSize,n);for(let u=0;u<l.length;u++){let d=l[u],f;for(let p=0;p<o.length;p++){let h=o[p];h.step==s-1&&d.eq(o[p].style)&&(f=h)}f?(f.to=c,f.step=s):o.push({style:d,from:Math.max(a,e),to:c,step:s})}}}),o.forEach(i=>t.step(new Sn(i.from,i.to,i.style)))}function ff(t,e,n,r=n.contentMatch,o=!0){let s=t.doc.nodeAt(e),i=[],a=e+1;for(let l=0;l<s.childCount;l++){let c=s.child(l),u=a+c.nodeSize,d=r.matchType(c.type);if(!d)i.push(new ft(a,u,J.empty));else{r=d;for(let f=0;f<c.marks.length;f++)n.allowsMarkType(c.marks[f].type)||t.step(new Sn(a,u,c.marks[f]));if(o&&c.isText&&n.whitespace!="pre"){let f,p=/\r?\n|\r/g,h;for(;f=p.exec(c.text);)h||(h=new J(V.from(n.schema.text(" ",n.allowedMarks(c.marks))),0,0)),i.push(new ft(a+f.index,a+f.index+f[0].length,h))}}a=u}if(!r.validEnd){let l=r.fillBefore(V.empty,!0);t.replace(a,a,new J(l,0,0))}for(let l=i.length-1;l>=0;l--)t.step(i[l])}function mM(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function nc(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth;;--r){let o=t.$from.node(r),s=t.$from.index(r),i=t.$to.indexAfter(r);if(r<t.depth&&o.canReplace(s,i,n))return r;if(r==0||o.type.spec.isolating||!mM(o,s,i))break}return null}function gM(t,e,n){let{$from:r,$to:o,depth:s}=e,i=r.before(s+1),a=o.after(s+1),l=i,c=a,u=V.empty,d=0;for(let h=s,v=!1;h>n;h--)v||r.index(h)>0?(v=!0,u=V.from(r.node(h).copy(u)),d++):l--;let f=V.empty,p=0;for(let h=s,v=!1;h>n;h--)v||o.after(h+1)<o.end(h)?(v=!0,f=V.from(o.node(h).copy(f)),p++):c++;t.step(new St(l,c,i,a,new J(u.append(f),d,p),u.size-d,!0))}function hf(t,e,n=null,r=t){let o=vM(t,e),s=o&&yM(r,e);return s?o.map(cm).concat({type:e,attrs:n}).concat(s.map(cm)):null}function cm(t){return{type:t,attrs:null}}function vM(t,e){let{parent:n,startIndex:r,endIndex:o}=t,s=n.contentMatchAt(r).findWrapping(e);if(!s)return null;let i=s.length?s[0]:e;return n.canReplaceWith(r,o,i)?s:null}function yM(t,e){let{parent:n,startIndex:r,endIndex:o}=t,s=n.child(r),i=e.contentMatch.findWrapping(s.type);if(!i)return null;let l=(i.length?i[i.length-1]:e).contentMatch;for(let c=r;l&&c<o;c++)l=l.matchType(n.child(c).type);return!l||!l.validEnd?null:i}function bM(t,e,n){let r=V.empty;for(let i=n.length-1;i>=0;i--){if(r.size){let a=n[i].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=V.from(n[i].type.create(n[i].attrs,r))}let o=e.start,s=e.end;t.step(new St(o,s,o,s,new J(r,0,0),n.length,!0))}function wM(t,e,n,r,o){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=t.steps.length;t.doc.nodesBetween(e,n,(i,a)=>{let l=typeof o=="function"?o(i):o;if(i.isTextblock&&!i.hasMarkup(r,l)&&kM(t.doc,t.mapping.slice(s).map(a),r)){let c=null;if(r.schema.linebreakReplacement){let p=r.whitespace=="pre",h=!!r.contentMatch.matchType(r.schema.linebreakReplacement);p&&!h?c=!1:!p&&h&&(c=!0)}c===!1&&qv(t,i,a,s),ff(t,t.mapping.slice(s).map(a,1),r,void 0,c===null);let u=t.mapping.slice(s),d=u.map(a,1),f=u.map(a+i.nodeSize,1);return t.step(new St(d,f,d+1,f-1,new J(V.from(r.create(l,null,i.marks)),0,0),1,!0)),c===!0&&Hv(t,i,a,s),!1}})}function Hv(t,e,n,r){e.forEach((o,s)=>{if(o.isText){let i,a=/\r?\n|\r/g;for(;i=a.exec(o.text);){let l=t.mapping.slice(r).map(n+1+s+i.index);t.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function qv(t,e,n,r){e.forEach((o,s)=>{if(o.type==o.type.schema.linebreakReplacement){let i=t.mapping.slice(r).map(n+1+s);t.replaceWith(i,i+1,e.type.schema.text("\n"))}})}function kM(t,e,n){let r=t.resolve(e),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}function CM(t,e,n,r,o){let s=t.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");n||(n=s.type);let i=n.create(r,null,o||s.marks);if(s.isLeaf)return t.replaceWith(e,e+s.nodeSize,i);if(!n.validContent(s.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new St(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new J(V.from(i),0,0),1,!0))}function si(t,e,n=1,r){let o=t.resolve(e),s=o.depth-n,i=r&&r[r.length-1]||o.parent;if(s<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!i.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(let c=o.depth-1,u=n-2;c>s;c--,u--){let d=o.node(c),f=o.index(c);if(d.type.spec.isolating)return!1;let p=d.content.cutByIndex(f,d.childCount),h=r&&r[u+1];h&&(p=p.replaceChild(0,h.type.create(h.attrs)));let v=r&&r[u]||d;if(!d.canReplace(f+1,d.childCount)||!v.type.validContent(p))return!1}let a=o.indexAfter(s),l=r&&r[0];return o.node(s).canReplaceWith(a,a,l?l.type:o.node(s+1).type)}function xM(t,e,n=1,r){let o=t.doc.resolve(e),s=V.empty,i=V.empty;for(let a=o.depth,l=o.depth-n,c=n-1;a>l;a--,c--){s=V.from(o.node(a).copy(s));let u=r&&r[c];i=V.from(u?u.type.create(u.attrs,i):o.node(a).copy(i))}t.step(new ft(e,e,new J(s.append(i),n,n),!0))}function rc(t,e){let n=t.resolve(e),r=n.index();return _M(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function SM(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let o=0;o<e.childCount;o++){let s=e.child(o),i=s.type==r?t.type.schema.nodes.text:s.type;if(n=n.matchType(i),!n||!t.type.allowsMarks(s.marks))return!1}return n.validEnd}function _M(t,e){return!!(t&&e&&!t.isLeaf&&SM(t,e))}function TM(t,e,n){let r=null,{linebreakReplacement:o}=t.doc.type.schema,s=t.doc.resolve(e-n),i=s.node().type;if(o&&i.inlineContent){let u=i.whitespace=="pre",d=!!i.contentMatch.matchType(o);u&&!d?r=!1:!u&&d&&(r=!0)}let a=t.steps.length;if(r===!1){let u=t.doc.resolve(e+n);qv(t,u.node(),u.before(),a)}i.inlineContent&&ff(t,e+n-1,i,s.node().contentMatchAt(s.index()),r==null);let l=t.mapping.slice(a),c=l.map(e-n);if(t.step(new ft(c,l.map(e+n,-1),J.empty,!0)),r===!0){let u=t.doc.resolve(c);Hv(t,u.node(),u.before(),t.steps.length)}return t}function $M(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let o=r.depth-1;o>=0;o--){let s=r.index(o);if(r.node(o).canReplaceWith(s,s,n))return r.before(o+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let o=r.depth-1;o>=0;o--){let s=r.indexAfter(o);if(r.node(o).canReplaceWith(s,s,n))return r.after(o+1);if(s<r.node(o).childCount)return null}return null}function OM(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let o=n.content;for(let s=0;s<n.openStart;s++)o=o.firstChild.content;for(let s=1;s<=(n.openStart==0&&n.size?2:1);s++)for(let i=r.depth;i>=0;i--){let a=i==r.depth?0:r.pos<=(r.start(i+1)+r.end(i+1))/2?-1:1,l=r.index(i)+(a>0?1:0),c=r.node(i),u=!1;if(s==1)u=c.canReplace(l,l,o);else{let d=c.contentMatchAt(l).findWrapping(o.firstChild.type);u=d&&c.canReplaceWith(l,l,d[0])}if(u)return a==0?r.pos:a<0?r.before(i+1):r.after(i+1)}return null}function oc(t,e,n=e,r=J.empty){if(e==n&&!r.size)return null;let o=t.resolve(e),s=t.resolve(n);return Uv(o,s,r)?new ft(e,n,r):new MM(o,s,r).fit()}function Uv(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class MM{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=V.empty;for(let o=0;o<=e.depth;o++){let s=e.node(o);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(o))})}for(let o=e.depth;o>0;o--)this.placed=V.from(e.node(o).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,o=this.close(e<0?this.$to:r.doc.resolve(e));if(!o)return null;let s=this.placed,i=r.depth,a=o.depth;for(;i&&a&&s.childCount==1;)s=s.firstChild.content,i--,a--;let l=new J(s,i,a);return e>-1?new St(r.pos,e,this.$to.pos,this.$to.end(),l,n):l.size||r.pos!=this.$to.pos?new ft(r.pos,o.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,o=this.unplaced.openEnd;r<e;r++){let s=n.firstChild;if(n.childCount>1&&(o=0),s.type.spec.isolating&&o<=r){e=r;break}n=s.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let o,s=null;r?(s=Gc(this.unplaced.content,r-1).firstChild,o=s.content):o=this.unplaced.content;let i=o.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,d=null;if(n==1&&(i?c.matchType(i.type)||(d=c.fillBefore(V.from(i),!1)):s&&l.compatibleContent(s.type)))return{sliceDepth:r,frontierDepth:a,parent:s,inject:d};if(n==2&&i&&(u=c.findWrapping(i.type)))return{sliceDepth:r,frontierDepth:a,parent:s,wrap:u};if(s&&c.matchType(s.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,o=Gc(e,n);return!o.childCount||o.firstChild.isLeaf?!1:(this.unplaced=new J(e,n+1,Math.max(r,o.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,o=Gc(e,n);if(o.childCount<=1&&n>0){let s=e.size-n<=n+o.size;this.unplaced=new J(qs(e,n-1,1),n-1,s?n-1:r)}else this.unplaced=new J(qs(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:o,wrap:s}){for(;this.depth>n;)this.closeFrontierNode();if(s)for(let v=0;v<s.length;v++)this.openFrontierNode(s[v]);let i=this.unplaced,a=r?r.content:i.content,l=i.openStart-e,c=0,u=[],{match:d,type:f}=this.frontier[n];if(o){for(let v=0;v<o.childCount;v++)u.push(o.child(v));d=d.matchFragment(o)}let p=a.size+e-(i.content.size-i.openEnd);for(;c<a.childCount;){let v=a.child(c),y=d.matchType(v.type);if(!y)break;c++,(c>1||l==0||v.content.size)&&(d=y,u.push(Wv(v.mark(f.allowedMarks(v.marks)),c==1?l:0,c==a.childCount?p:-1)))}let h=c==a.childCount;h||(p=-1),this.placed=Us(this.placed,n,V.from(u)),this.frontier[n].match=d,h&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let v=0,y=a;v<p;v++){let w=y.lastChild;this.frontier.push({type:w.type,match:w.contentMatchAt(w.childCount)}),y=w.content}this.unplaced=h?e==0?J.empty:new J(qs(i.content,e-1,1),e-1,p<0?i.openEnd:e-1):new J(qs(i.content,e,c),i.openStart,i.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!Jc(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,o=this.$to.after(r);for(;r>1&&o==this.$to.end(--r);)++o;return o}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:o}=this.frontier[n],s=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),i=Jc(e,n,o,r,s);if(i){for(let a=n-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=Jc(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:n,fit:i,move:s?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=Us(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let o=e.node(r),s=o.type.contentMatch.fillBefore(o.content,!0,e.index(r));this.openFrontierNode(o.type,o.attrs,s)}return e}openFrontierNode(e,n=null,r){let o=this.frontier[this.depth];o.match=o.match.matchType(e),this.placed=Us(this.placed,this.depth,V.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(V.empty,!0);n.childCount&&(this.placed=Us(this.placed,this.frontier.length,n))}}function qs(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(qs(t.firstChild.content,e-1,n)))}function Us(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Us(t.lastChild.content,e-1,n)))}function Gc(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function Wv(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,Wv(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(V.empty,!0)))),t.copy(r)}function Jc(t,e,n,r,o){let s=t.node(e),i=o?t.indexAfter(e):t.index(e);if(i==s.childCount&&!n.compatibleContent(s.type))return null;let a=r.fillBefore(s.content,!0,i);return a&&!EM(n,s.content,i)?a:null}function EM(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function NM(t){return t.spec.defining||t.spec.definingForContent}function DM(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let o=t.doc.resolve(e),s=t.doc.resolve(n);if(Uv(o,s,r))return t.step(new ft(e,n,r));let i=Kv(o,t.doc.resolve(n));i[i.length-1]==0&&i.pop();let a=-(o.depth+1);i.unshift(a);for(let f=o.depth,p=o.pos-1;f>0;f--,p--){let h=o.node(f).type.spec;if(h.defining||h.definingAsContext||h.isolating)break;i.indexOf(f)>-1?a=f:o.before(f)==p&&i.splice(1,0,-f)}let l=i.indexOf(a),c=[],u=r.openStart;for(let f=r.content,p=0;;p++){let h=f.firstChild;if(c.push(h),p==r.openStart)break;f=h.content}for(let f=u-1;f>=0;f--){let p=c[f],h=NM(p.type);if(h&&!p.sameMarkup(o.node(Math.abs(a)-1)))u=f;else if(h||!p.type.isTextblock)break}for(let f=r.openStart;f>=0;f--){let p=(f+u+1)%(r.openStart+1),h=c[p];if(h)for(let v=0;v<i.length;v++){let y=i[(v+l)%i.length],w=!0;y<0&&(w=!1,y=-y);let x=o.node(y-1),$=o.index(y-1);if(x.canReplaceWith($,$,h.type,h.marks))return t.replace(o.before(y),w?s.after(y):n,new J(jv(r.content,0,r.openStart,p),p,r.openEnd))}}let d=t.steps.length;for(let f=i.length-1;f>=0&&(t.replace(e,n,r),!(t.steps.length>d));f--){let p=i[f];p<0||(e=o.before(p),n=s.after(p))}}function jv(t,e,n,r,o){if(e<n){let s=t.firstChild;t=t.replaceChild(0,s.copy(jv(s.content,e+1,n,r,s)))}if(e>r){let s=o.contentMatchAt(0),i=s.fillBefore(t).append(t);t=i.append(s.matchFragment(i).fillBefore(V.empty,!0))}return t}function AM(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let o=$M(t.doc,e,r.type);o!=null&&(e=n=o)}t.replaceRange(e,n,new J(V.from(r),0,0))}function RM(t,e,n){let r=t.doc.resolve(e),o=t.doc.resolve(n),s=Kv(r,o);for(let i=0;i<s.length;i++){let a=s[i],l=i==s.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return t.delete(r.start(a),o.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),o.indexAfter(a-1))))return t.delete(r.before(a),o.after(a))}for(let i=1;i<=r.depth&&i<=o.depth;i++)if(e-r.start(i)==r.depth-i&&n>r.end(i)&&o.end(i)-n!=o.depth-i&&r.start(i-1)==o.start(i-1)&&r.node(i-1).canReplace(r.index(i-1),o.index(i-1)))return t.delete(r.before(i),n);t.delete(e,n)}function Kv(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let o=r;o>=0;o--){let s=t.start(o);if(s<t.pos-(t.depth-o)||e.end(o)>e.pos+(e.depth-o)||t.node(o).type.spec.isolating||e.node(o).type.spec.isolating)break;(s==e.start(o)||o==t.depth&&o==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&o&&e.start(o-1)==s-1)&&n.push(o)}return n}class jo extends _t{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return ot.fail("No node at attribute step's position");let r=Object.create(null);for(let s in n.attrs)r[s]=n.attrs[s];r[this.attr]=this.value;let o=n.type.create(r,null,n.marks);return ot.fromReplace(e,this.pos,this.pos+1,new J(V.from(o),0,n.isLeaf?0:1))}getMap(){return Vt.empty}invert(e){return new jo(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new jo(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new jo(n.pos,n.attr,n.value)}}_t.jsonID("attr",jo);class xi extends _t{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let o in e.attrs)n[o]=e.attrs[o];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return ot.ok(r)}getMap(){return Vt.empty}invert(e){return new xi(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new xi(n.attr,n.value)}}_t.jsonID("docAttr",xi);let bs=class extends Error{};bs=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};bs.prototype=Object.create(Error.prototype);bs.prototype.constructor=bs;bs.prototype.name="TransformError";class Yv{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Ci}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new bs(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=J.empty){let o=oc(this.doc,e,n,r);return o&&this.step(o),this}replaceWith(e,n,r){return this.replace(e,n,new J(V.from(r),0,0))}delete(e,n){return this.replace(e,n,J.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return DM(this,e,n,r),this}replaceRangeWith(e,n,r){return AM(this,e,n,r),this}deleteRange(e,n){return RM(this,e,n),this}lift(e,n){return gM(this,e,n),this}join(e,n=1){return TM(this,e,n),this}wrap(e,n){return bM(this,e,n),this}setBlockType(e,n=e,r,o=null){return wM(this,e,n,r,o),this}setNodeMarkup(e,n,r=null,o){return CM(this,e,n,r,o),this}setNodeAttribute(e,n,r){return this.step(new jo(e,n,r)),this}setDocAttribute(e,n){return this.step(new xi(e,n)),this}addNodeMark(e,n){return this.step(new wr(e,n)),this}removeNodeMark(e,n){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n instanceof Se)n.isInSet(r.marks)&&this.step(new yo(e,n));else{let o=r.marks,s,i=[];for(;s=n.isInSet(o);)i.push(new yo(e,s)),o=s.removeFromSet(o);for(let a=i.length-1;a>=0;a--)this.step(i[a])}return this}split(e,n=1,r){return xM(this,e,n,r),this}addMark(e,n,r){return hM(this,e,n,r),this}removeMark(e,n,r){return pM(this,e,n,r),this}clearIncompatible(e,n,r){return ff(this,e,n,r),this}}const Xc=Object.create(null);class pe{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new wl(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=J.empty){let r=n.content.lastChild,o=null;for(let a=0;a<n.openEnd;a++)o=r,r=r.lastChild;let s=e.steps.length,i=this.ranges;for(let a=0;a<i.length;a++){let{$from:l,$to:c}=i[a],u=e.mapping.slice(s);e.replaceRange(u.map(l.pos),u.map(c.pos),a?J.empty:n),a==0&&fm(e,s,(r?r.isInline:o&&o.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,o=this.ranges;for(let s=0;s<o.length;s++){let{$from:i,$to:a}=o[s],l=e.mapping.slice(r),c=l.map(i.pos),u=l.map(a.pos);s?e.deleteRange(c,u):(e.replaceRangeWith(c,u,n),fm(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let o=e.parent.inlineContent?new he(e):Po(e.node(0),e.parent,e.pos,e.index(),n,r);if(o)return o;for(let s=e.depth-1;s>=0;s--){let i=n<0?Po(e.node(0),e.node(s),e.before(s+1),e.index(s),n,r):Po(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,n,r);if(i)return i}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new Wt(e.node(0))}static atStart(e){return Po(e,e,0,0,1)||new Wt(e)}static atEnd(e){return Po(e,e,e.content.size,e.childCount,-1)||new Wt(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Xc[n.type];if(!r)throw new RangeError("No selection type ".concat(n.type," defined"));return r.fromJSON(e,n)}static jsonID(e,n){if(e in Xc)throw new RangeError("Duplicate use of selection JSON ID "+e);return Xc[e]=n,n.prototype.jsonID=e,n}getBookmark(){return he.between(this.$anchor,this.$head).getBookmark()}}pe.prototype.visible=!0;class wl{constructor(e,n){this.$from=e,this.$to=n}}let um=!1;function dm(t){!um&&!t.parent.inlineContent&&(um=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class he extends pe{constructor(e,n=e){dm(e),dm(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return pe.near(r);let o=e.resolve(n.map(this.anchor));return new he(o.parent.inlineContent?o:r,r)}replace(e,n=J.empty){if(super.replace(e,n),n==J.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof he&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new sc(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new he(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let o=e.resolve(n);return new this(o,r==n?o:e.resolve(r))}static between(e,n,r){let o=e.pos-n.pos;if((!r||o)&&(r=o>=0?1:-1),!n.parent.inlineContent){let s=pe.findFrom(n,r,!0)||pe.findFrom(n,-r,!0);if(s)n=s.$head;else return pe.near(n,r)}return e.parent.inlineContent||(o==0?e=n:(e=(pe.findFrom(e,-r,!0)||pe.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=o<0&&(e=n))),new he(e,n)}}pe.jsonID("text",he);class sc{constructor(e,n){this.anchor=e,this.head=n}map(e){return new sc(e.map(this.anchor),e.map(this.head))}resolve(e){return he.between(e.resolve(this.anchor),e.resolve(this.head))}}class fe extends pe{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:o}=n.mapResult(this.anchor),s=e.resolve(o);return r?pe.near(s):new fe(s)}content(){return new J(V.from(this.node),0,0)}eq(e){return e instanceof fe&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new pf(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new fe(e.resolve(n.anchor))}static create(e,n){return new fe(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}fe.prototype.visible=!1;pe.jsonID("node",fe);class pf{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new sc(r,r):new pf(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&fe.isSelectable(r)?new fe(n):pe.near(n)}}class Wt extends pe{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=J.empty){if(n==J.empty){e.delete(0,e.doc.content.size);let r=pe.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new Wt(e)}map(e){return new Wt(e)}eq(e){return e instanceof Wt}getBookmark(){return IM}}pe.jsonID("all",Wt);const IM={map(){return this},resolve(t){return new Wt(t)}};function Po(t,e,n,r,o,s=!1){if(e.inlineContent)return he.create(t,n);for(let i=r-(o>0?0:1);o>0?i<e.childCount:i>=0;i+=o){let a=e.child(i);if(a.isAtom){if(!s&&fe.isSelectable(a))return fe.create(t,n-(o<0?a.nodeSize:0))}else{let l=Po(t,a,n+o,o<0?a.childCount:0,o,s);if(l)return l}n+=a.nodeSize*o}return null}function fm(t,e,n){let r=t.steps.length-1;if(r<e)return;let o=t.steps[r];if(!(o instanceof ft||o instanceof St))return;let s=t.mapping.maps[r],i;s.forEach((a,l,c,u)=>{i==null&&(i=u)}),t.setSelection(pe.near(t.doc.resolve(i),n))}const hm=1,Sa=2,pm=4;class PM extends Yv{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|hm)&~Sa,this.storedMarks=null,this}get selectionSet(){return(this.updated&hm)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Sa,this}ensureMarks(e){return Se.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Sa)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~Sa,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Se.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let o=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(o.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),r=r==null?n:r,!e)return this.deleteRange(n,r);let s=this.storedMarks;if(!s){let i=this.doc.resolve(n);s=r==n?i.marks():i.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,o.text(e,s)),this.selection.empty||this.setSelection(pe.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=pm,this}get scrolledIntoView(){return(this.updated&pm)>0}}function mm(t,e){return!e||!t?t:t.bind(e)}class Ws{constructor(e,n,r){this.name=e,this.init=mm(n.init,r),this.apply=mm(n.apply,r)}}const LM=[new Ws("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new Ws("selection",{init(t,e){return t.selection||pe.atStart(e.doc)},apply(t){return t.selection}}),new Ws("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Ws("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class Zc{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=LM.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Ws(r.key,r.spec.state,r))})}}class qo{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let o=this.config.plugins[r];if(o.spec.filterTransaction&&!o.spec.filterTransaction.call(o,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),o=null;for(;;){let s=!1;for(let i=0;i<this.config.plugins.length;i++){let a=this.config.plugins[i];if(a.spec.appendTransaction){let l=o?o[i].n:0,c=o?o[i].state:this,u=l<n.length&&a.spec.appendTransaction.call(a,l?n.slice(l):n,c,r);if(u&&r.filterTransaction(u,i)){if(u.setMeta("appendedTransaction",e),!o){o=[];for(let d=0;d<this.config.plugins.length;d++)o.push(d<i?{state:r,n:n.length}:{state:this,n:0})}n.push(u),r=r.applyInner(u),s=!0}o&&(o[i]={state:r,n:n.length})}}if(!s)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new qo(this.config),r=this.config.fields;for(let o=0;o<r.length;o++){let s=r[o];n[s.name]=s.apply(e,this[s.name],this,n)}return n}get tr(){return new PM(this)}static create(e){let n=new Zc(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new qo(n);for(let o=0;o<n.fields.length;o++)r[n.fields[o].name]=n.fields[o].init(e,r);return r}reconfigure(e){let n=new Zc(this.schema,e.plugins),r=n.fields,o=new qo(n);for(let s=0;s<r.length;s++){let i=r[s].name;o[i]=this.hasOwnProperty(i)?this[i]:r[s].init(e,o)}return o}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let o=e[r],s=o.spec.state;s&&s.toJSON&&(n[r]=s.toJSON.call(o,this[o.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let o=new Zc(e.schema,e.plugins),s=new qo(o);return o.fields.forEach(i=>{if(i.name=="doc")s.doc=Gn.fromJSON(e.schema,n.doc);else if(i.name=="selection")s.selection=pe.fromJSON(s.doc,n.selection);else if(i.name=="storedMarks")n.storedMarks&&(s.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==i.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(n,a)){s[i.name]=c.fromJSON.call(l,e,n[a],s);return}}s[i.name]=i.init(e,s)}}),s}}function Gv(t,e,n){for(let r in t){let o=t[r];o instanceof Function?o=o.bind(e):r=="handleDOMEvents"&&(o=Gv(o,e,{})),n[r]=o}return n}class wt{constructor(e){this.spec=e,this.props={},e.props&&Gv(e.props,this,this.props),this.key=e.key?e.key.key:Jv("plugin")}getState(e){return e[this.key]}}const Qc=Object.create(null);function Jv(t){return t in Qc?t+"$"+ ++Qc[t]:(Qc[t]=0,t+"$")}class mt{constructor(e="key"){this.key=Jv(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const vt=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},ws=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let ad=null;const zn=function(t,e,n){let r=ad||(ad=document.createRange());return r.setEnd(t,n==null?t.nodeValue.length:n),r.setStart(t,e||0),r},zM=function(){ad=null},bo=function(t,e,n,r){return n&&(gm(t,e,n,r,-1)||gm(t,e,n,r,1))},BM=/^(img|br|input|textarea|hr)$/i;function gm(t,e,n,r,o){for(var s;;){if(t==n&&e==r)return!0;if(e==(o<0?0:Qt(t))){let i=t.parentNode;if(!i||i.nodeType!=1||Zi(t)||BM.test(t.nodeName)||t.contentEditable=="false")return!1;e=vt(t)+(o<0?0:1),t=i}else if(t.nodeType==1){let i=t.childNodes[e+(o<0?-1:0)];if(i.nodeType==1&&i.contentEditable=="false")if(!((s=i.pmViewDesc)===null||s===void 0)&&s.ignoreForSelection)e+=o;else return!1;else t=i,e=o<0?Qt(t):0}else return!1}}function Qt(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function FM(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=Qt(t)}else if(t.parentNode&&!Zi(t))e=vt(t),t=t.parentNode;else return null}}function VM(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!Zi(t))e=vt(t)+1,t=t.parentNode;else return null}}function HM(t,e,n){for(let r=e==0,o=e==Qt(t);r||o;){if(t==n)return!0;let s=vt(t);if(t=t.parentNode,!t)return!1;r=r&&s==0,o=o&&s==Qt(t)}}function Zi(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const ic=function(t){return t.focusNode&&bo(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Ur(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function qM(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function UM(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(Qt(r.offsetNode),r.offset)}}catch(r){}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(Qt(r.startContainer),r.startOffset)}}}const $n=typeof navigator<"u"?navigator:null,vm=typeof document<"u"?document:null,Lr=$n&&$n.userAgent||"",ld=/Edge\/(\d+)/.exec(Lr),Xv=/MSIE \d/.exec(Lr),cd=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Lr),Dt=!!(Xv||cd||ld),_r=Xv?document.documentMode:cd?+cd[1]:ld?+ld[1]:0,tn=!Dt&&/gecko\/(\d+)/i.test(Lr);tn&&+(/Firefox\/(\d+)/.exec(Lr)||[0,0])[1];const ud=!Dt&&/Chrome\/(\d+)/.exec(Lr),xt=!!ud,Zv=ud?+ud[1]:0,Tt=!Dt&&!!$n&&/Apple Computer/.test($n.vendor),ks=Tt&&(/Mobile\/\w+/.test(Lr)||!!$n&&$n.maxTouchPoints>2),Zt=ks||($n?/Mac/.test($n.platform):!1),WM=$n?/Win/.test($n.platform):!1,Yn=/Android \d/.test(Lr),Qi=!!vm&&"webkitFontSmoothing"in vm.documentElement.style,jM=Qi?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function KM(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Rn(t,e){return typeof t=="number"?t:t[e]}function YM(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function ym(t,e,n){let r=t.someProp("scrollThreshold")||0,o=t.someProp("scrollMargin")||5,s=t.dom.ownerDocument;for(let i=n||t.dom;i;){if(i.nodeType!=1){i=ws(i);continue}let a=i,l=a==s.body,c=l?KM(s):YM(a),u=0,d=0;if(e.top<c.top+Rn(r,"top")?d=-(c.top-e.top+Rn(o,"top")):e.bottom>c.bottom-Rn(r,"bottom")&&(d=e.bottom-e.top>c.bottom-c.top?e.top+Rn(o,"top")-c.top:e.bottom-c.bottom+Rn(o,"bottom")),e.left<c.left+Rn(r,"left")?u=-(c.left-e.left+Rn(o,"left")):e.right>c.right-Rn(r,"right")&&(u=e.right-c.right+Rn(o,"right")),u||d)if(l)s.defaultView.scrollBy(u,d);else{let p=a.scrollLeft,h=a.scrollTop;d&&(a.scrollTop+=d),u&&(a.scrollLeft+=u);let v=a.scrollLeft-p,y=a.scrollTop-h;e={left:e.left-v,top:e.top-y,right:e.right-v,bottom:e.bottom-y}}let f=l?"fixed":getComputedStyle(i).position;if(/^(fixed|sticky)$/.test(f))break;i=f=="absolute"?i.offsetParent:ws(i)}}function GM(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,o;for(let s=(e.left+e.right)/2,i=n+1;i<Math.min(innerHeight,e.bottom);i+=5){let a=t.root.elementFromPoint(s,i);if(!a||a==t.dom||!t.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=n-20){r=a,o=l.top;break}}return{refDOM:r,refTop:o,stack:Qv(t.dom)}}function Qv(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=ws(r));return e}function JM({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;ey(n,r==0?0:r-e)}function ey(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:o,left:s}=t[n];r.scrollTop!=o+e&&(r.scrollTop=o+e),r.scrollLeft!=s&&(r.scrollLeft=s)}}let Do=null;function XM(t){if(t.setActive)return t.setActive();if(Do)return t.focus(Do);let e=Qv(t);t.focus(Do==null?{get preventScroll(){return Do={preventScroll:!0},!0}}:void 0),Do||(Do=!1,ey(e,0))}function ty(t,e){let n,r=2e8,o,s=0,i=e.top,a=e.top,l,c;for(let u=t.firstChild,d=0;u;u=u.nextSibling,d++){let f;if(u.nodeType==1)f=u.getClientRects();else if(u.nodeType==3)f=zn(u).getClientRects();else continue;for(let p=0;p<f.length;p++){let h=f[p];if(h.top<=i&&h.bottom>=a){i=Math.max(h.bottom,i),a=Math.min(h.top,a);let v=h.left>e.left?h.left-e.left:h.right<e.left?e.left-h.right:0;if(v<r){n=u,r=v,o=v&&n.nodeType==3?{left:h.right<e.left?h.right:h.left,top:e.top}:e,u.nodeType==1&&v&&(s=d+(e.left>=(h.left+h.right)/2?1:0));continue}}else h.top>e.top&&!l&&h.left<=e.left&&h.right>=e.left&&(l=u,c={left:Math.max(h.left,Math.min(h.right,e.left)),top:h.top});!n&&(e.left>=h.right&&e.top>=h.top||e.left>=h.left&&e.top>=h.bottom)&&(s=d+1)}}return!n&&l&&(n=l,o=c,r=0),n&&n.nodeType==3?ZM(n,o):!n||r&&n.nodeType==1?{node:t,offset:s}:ty(n,o)}function ZM(t,e){let n=t.nodeValue.length,r=document.createRange();for(let o=0;o<n;o++){r.setEnd(t,o+1),r.setStart(t,o);let s=ar(r,1);if(s.top!=s.bottom&&mf(e,s))return{node:t,offset:o+(e.left>=(s.left+s.right)/2?1:0)}}return{node:t,offset:0}}function mf(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function QM(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function e9(t,e,n){let{node:r,offset:o}=ty(e,n),s=-1;if(r.nodeType==1&&!r.firstChild){let i=r.getBoundingClientRect();s=i.left!=i.right&&n.left>(i.left+i.right)/2?1:-1}return t.docView.posFromDOM(r,o,s)}function t9(t,e,n,r){let o=-1;for(let s=e,i=!1;s!=t.dom;){let a=t.docView.nearestDesc(s,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(a.dom.nodeName)&&(!i&&l.left>r.left||l.top>r.top?o=a.posBefore:(!i&&l.right<r.left||l.bottom<r.top)&&(o=a.posAfter),i=!0),!a.contentDOM&&o<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;s=a.dom.parentNode}return o>-1?o:t.docView.posFromDOM(e,n,-1)}function ny(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let o=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),s=o;;){let i=t.childNodes[s];if(i.nodeType==1){let a=i.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(mf(e,c))return ny(i,e,c)}}if((s=(s+1)%r)==o)break}return t}function n9(t,e){let n=t.dom.ownerDocument,r,o=0,s=UM(n,e.left,e.top);s&&({node:r,offset:o}=s);let i=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),a;if(!i||!t.dom.contains(i.nodeType!=1?i.parentNode:i)){let c=t.dom.getBoundingClientRect();if(!mf(e,c)||(i=ny(t.dom,e,c),!i))return null}if(Tt)for(let c=i;r&&c;c=ws(c))c.draggable&&(r=void 0);if(i=QM(i,e),r){if(tn&&r.nodeType==1&&(o=Math.min(o,r.childNodes.length),o<r.childNodes.length)){let u=r.childNodes[o],d;u.nodeName=="IMG"&&(d=u.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&o++}let c;Qi&&o&&r.nodeType==1&&(c=r.childNodes[o-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&o--,r==t.dom&&o==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=t.state.doc.content.size:(o==0||r.nodeType!=1||r.childNodes[o-1].nodeName!="BR")&&(a=t9(t,r,o,e))}a==null&&(a=e9(t,i,e));let l=t.docView.nearestDesc(i,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function bm(t){return t.top<t.bottom||t.left<t.right}function ar(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(bm(r))return r}return Array.prototype.find.call(n,bm)||t.getBoundingClientRect()}const r9=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function ry(t,e,n){let{node:r,offset:o,atom:s}=t.docView.domFromPos(e,n<0?-1:1),i=Qi||tn;if(r.nodeType==3)if(i&&(r9.test(r.nodeValue)||(n<0?!o:o==r.nodeValue.length))){let l=ar(zn(r,o,o),n);if(tn&&o&&/\s/.test(r.nodeValue[o-1])&&o<r.nodeValue.length){let c=ar(zn(r,o-1,o-1),-1);if(c.top==l.top){let u=ar(zn(r,o,o+1),-1);if(u.top!=l.top)return Vs(u,u.left<c.left)}}return l}else{let l=o,c=o,u=n<0?1:-1;return n<0&&!o?(c++,u=-1):n>=0&&o==r.nodeValue.length?(l--,u=1):n<0?l--:c++,Vs(ar(zn(r,l,c),u),u<0)}if(!t.state.doc.resolve(e-(s||0)).parent.inlineContent){if(s==null&&o&&(n<0||o==Qt(r))){let l=r.childNodes[o-1];if(l.nodeType==1)return eu(l.getBoundingClientRect(),!1)}if(s==null&&o<Qt(r)){let l=r.childNodes[o];if(l.nodeType==1)return eu(l.getBoundingClientRect(),!0)}return eu(r.getBoundingClientRect(),n>=0)}if(s==null&&o&&(n<0||o==Qt(r))){let l=r.childNodes[o-1],c=l.nodeType==3?zn(l,Qt(l)-(i?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return Vs(ar(c,1),!1)}if(s==null&&o<Qt(r)){let l=r.childNodes[o];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?zn(l,0,i?0:1):l.nodeType==1?l:null:null;if(c)return Vs(ar(c,-1),!0)}return Vs(ar(r.nodeType==3?zn(r):r,-n),n>=0)}function Vs(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function eu(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function oy(t,e,n){let r=t.state,o=t.root.activeElement;r!=e&&t.updateState(e),o!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),o!=t.dom&&o&&o.focus()}}function o9(t,e,n){let r=e.selection,o=n=="up"?r.$from:r.$to;return oy(t,e,()=>{let{node:s}=t.docView.domFromPos(o.pos,n=="up"?-1:1);for(;;){let a=t.docView.nearestDesc(s,!0);if(!a)break;if(a.node.isBlock){s=a.contentDOM||a.dom;break}s=a.dom.parentNode}let i=ry(t,o.pos,1);for(let a=s.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=zn(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(n=="up"?i.top-u.top>(u.bottom-i.top)*2:u.bottom-i.bottom>(i.bottom-u.top)*2))return!1}}return!0})}const s9=/[\u0590-\u08ac]/;function i9(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let o=r.parentOffset,s=!o,i=o==r.parent.content.size,a=t.domSelection();return a?!s9.test(r.parent.textContent)||!a.modify?n=="left"||n=="backward"?s:i:oy(t,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:d}=t.domSelectionRange(),f=a.caretBidiLevel;a.modify("move",n,"character");let p=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:h,focusOffset:v}=t.domSelectionRange(),y=h&&!p.contains(h.nodeType==1?h:h.parentNode)||l==h&&c==v;try{a.collapse(u,d),l&&(l!=u||c!=d)&&a.extend&&a.extend(l,c)}catch(w){}return f!=null&&(a.caretBidiLevel=f),y}):r.pos==r.start()||r.pos==r.end()}let wm=null,km=null,Cm=!1;function a9(t,e,n){return wm==e&&km==n?Cm:(wm=e,km=n,Cm=n=="up"||n=="down"?o9(t,e,n):i9(t,e,n))}const nn=0,xm=1,Kr=2,On=3;class ea{constructor(e,n,r,o){this.parent=e,this.children=n,this.dom=r,this.contentDOM=o,this.dirty=nn,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let o=this.children[n];if(o==e)return r;r+=o.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let s,i;if(e==this.contentDOM)s=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.previousSibling}for(;s&&!((i=s.pmViewDesc)&&i.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(i)+i.size:this.posAtStart}else{let s,i;if(e==this.contentDOM)s=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&!((i=s.pmViewDesc)&&i.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(i):this.posAtEnd}let o;if(e==this.dom&&this.contentDOM)o=n>vt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))o=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let s=e;;s=s.parentNode){if(s==this.dom){o=!1;break}if(s.previousSibling)break}if(o==null&&n==e.childNodes.length)for(let s=e;;s=s.parentNode){if(s==this.dom){o=!0;break}if(s.nextSibling)break}}return(o==null?r>0:o)?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,o=e;o;o=o.parentNode){let s=this.getDesc(o),i;if(s&&(!n||s.node))if(r&&(i=s.nodeDOM)&&!(i.nodeType==1?i.contains(e.nodeType==1?e:e.parentNode):i==e))r=!1;else return s}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let o=e;o;o=o.parentNode){let s=this.getDesc(o);if(s)return s.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let o=this.children[n],s=r+o.size;if(r==e&&s!=r){for(;!o.border&&o.children.length;)for(let i=0;i<o.children.length;i++){let a=o.children[i];if(a.size){o=a;break}}return o}if(e<s)return o.descAt(e-r-o.border);r=s}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,o=0;for(let s=0;r<this.children.length;r++){let i=this.children[r],a=s+i.size;if(a>e||i instanceof iy){o=e-s;break}s=a}if(o)return this.children[r].domFromPos(o-this.children[r].border,n);for(let s;r&&!(s=this.children[r-1]).size&&s instanceof sy&&s.side>=0;r--);if(n<=0){let s,i=!0;for(;s=r?this.children[r-1]:null,!(!s||s.dom.parentNode==this.contentDOM);r--,i=!1);return s&&n&&i&&!s.border&&!s.domAtom?s.domFromPos(s.size,n):{node:this.contentDOM,offset:s?vt(s.dom)+1:0}}else{let s,i=!0;for(;s=r<this.children.length?this.children[r]:null,!(!s||s.dom.parentNode==this.contentDOM);r++,i=!1);return s&&i&&!s.border&&!s.domAtom?s.domFromPos(0,n):{node:this.contentDOM,offset:s?vt(s.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let o=-1,s=-1;for(let i=r,a=0;;a++){let l=this.children[a],c=i+l.size;if(o==-1&&e<=c){let u=i+l.border;if(e>=u&&n<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,n,u);e=i;for(let d=a;d>0;d--){let f=this.children[d-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){o=vt(f.dom)+1;break}e-=f.size}o==-1&&(o=0)}if(o>-1&&(c>n||a==this.children.length-1)){n=c;for(let u=a+1;u<this.children.length;u++){let d=this.children[u];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){s=vt(d.dom);break}n+=d.size}s==-1&&(s=this.contentDOM.childNodes.length);break}i=c}return{node:this.contentDOM,from:e,to:n,fromOffset:o,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,o=!1){let s=Math.min(e,n),i=Math.max(e,n);for(let p=0,h=0;p<this.children.length;p++){let v=this.children[p],y=h+v.size;if(s>h&&i<y)return v.setSelection(e-h-v.border,n-h-v.border,r,o);h=y}let a=this.domFromPos(e,e?-1:1),l=n==e?a:this.domFromPos(n,n?-1:1),c=r.root.getSelection(),u=r.domSelectionRange(),d=!1;if((tn||Tt)&&e==n){let{node:p,offset:h}=a;if(p.nodeType==3){if(d=!!(h&&p.nodeValue[h-1]=="\n"),d&&h==p.nodeValue.length)for(let v=p,y;v;v=v.parentNode){if(y=v.nextSibling){y.nodeName=="BR"&&(a=l={node:y.parentNode,offset:vt(y)+1});break}let w=v.pmViewDesc;if(w&&w.node&&w.node.isBlock)break}}else{let v=p.childNodes[h-1];d=v&&(v.nodeName=="BR"||v.contentEditable=="false")}}if(tn&&u.focusNode&&u.focusNode!=l.node&&u.focusNode.nodeType==1){let p=u.focusNode.childNodes[u.focusOffset];p&&p.contentEditable=="false"&&(o=!0)}if(!(o||d&&Tt)&&bo(a.node,a.offset,u.anchorNode,u.anchorOffset)&&bo(l.node,l.offset,u.focusNode,u.focusOffset))return;let f=!1;if((c.extend||e==n)&&!(d&&tn)){c.collapse(a.node,a.offset);try{e!=n&&c.extend(l.node,l.offset),f=!0}catch(p){}}if(!f){if(e>n){let h=a;a=l,l=h}let p=document.createRange();p.setEnd(l.node,l.offset),p.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(p)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,o=0;o<this.children.length;o++){let s=this.children[o],i=r+s.size;if(r==i?e<=i&&n>=r:e<i&&n>r){let a=r+s.border,l=i-s.border;if(e>=a&&n<=l){this.dirty=e==r||n==i?Kr:xm,e==a&&n==l&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=On:s.markDirty(e-a,n-a);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?Kr:On}r=i}this.dirty=Kr}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?Kr:xm;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class sy extends ea{constructor(e,n,r,o){let s,i=n.type.toDOM;if(typeof i=="function"&&(i=i(r,()=>{if(!s)return o;if(s.parent)return s.parent.posBeforeChild(s)})),!n.type.spec.raw){if(i.nodeType!=1){let a=document.createElement("span");a.appendChild(i),i=a}i.contentEditable="false",i.classList.add("ProseMirror-widget")}super(e,[],i,null),this.widget=n,this.widget=n,s=this}matchesWidget(e){return this.dirty==nn&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class l9 extends ea{constructor(e,n,r,o){super(e,[],n,null),this.textDOM=r,this.text=o}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class wo extends ea{constructor(e,n,r,o,s){super(e,[],r,o),this.mark=n,this.spec=s}static create(e,n,r,o){let s=o.nodeViews[n.type.name],i=s&&s(n,o,r);return(!i||!i.dom)&&(i=Ms.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new wo(e,n,i.dom,i.contentDOM||i.dom,i)}parseRule(){return this.dirty&On||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=On&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=nn){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=nn}}slice(e,n,r){let o=wo.create(this.parent,this.mark,!0,r),s=this.children,i=this.size;n<i&&(s=fd(s,n,i,r)),e>0&&(s=fd(s,0,e,r));for(let a=0;a<s.length;a++)s[a].parent=o;return o.children=s,o}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Tr extends ea{constructor(e,n,r,o,s,i,a,l,c){super(e,[],s,i),this.node=n,this.outerDeco=r,this.innerDeco=o,this.nodeDOM=a}static create(e,n,r,o,s,i){let a=s.nodeViews[n.type.name],l,c=a&&a(n,s,()=>{if(!l)return i;if(l.parent)return l.parent.posBeforeChild(l)},r,o),u=c&&c.dom,d=c&&c.contentDOM;if(n.isText){if(!u)u=document.createTextNode(n.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:d}=Ms.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!d&&!n.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),n.type.spec.draggable&&(u.draggable=!0));let f=u;return u=cy(u,r,n),c?l=new c9(e,n,r,o,u,d||null,f,c,s,i+1):n.isText?new ac(e,n,r,o,u,f,s):new Tr(e,n,r,o,u,d||null,f,s,i+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>V.empty)}return e}matchesNode(e,n,r){return this.dirty==nn&&e.eq(this.node)&&kl(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,o=n,s=e.composing?this.localCompositionInfo(e,n):null,i=s&&s.pos>-1?s:null,a=s&&s.pos<0,l=new d9(this,i&&i.node,e);p9(this.node,this.innerDeco,(c,u,d)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!d&&l.syncToMarks(u==this.node.childCount?Se.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,o)},(c,u,d,f)=>{l.syncToMarks(c.marks,r,e);let p;l.findNodeMatch(c,u,d,f)||a&&e.state.selection.from>o&&e.state.selection.to<o+c.nodeSize&&(p=l.findIndexWithChild(s.node))>-1&&l.updateNodeAt(c,u,d,p,e)||l.updateNextNode(c,u,d,e,f,o)||l.addNode(c,u,d,e,o),o+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Kr)&&(i&&this.protectLocalComposition(e,i),ay(this.contentDOM,this.children,e),ks&&m9(this.dom))}localCompositionInfo(e,n){let{from:r,to:o}=e.state.selection;if(!(e.state.selection instanceof he)||r<n||o>n+this.node.content.size)return null;let s=e.input.compositionNode;if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let i=s.nodeValue,a=g9(this.node.content,i,r-n,o-n);return a<0?null:{node:s,pos:a,text:i}}else return{node:s,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:o}){if(this.getDesc(n))return;let s=n;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let i=new l9(this,s,n,o);e.input.compositionNodes.push(i),this.children=fd(this.children,r,r+o.length,e,i)}update(e,n,r,o){return this.dirty==On||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,o),!0)}updateInner(e,n,r,o){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(o,this.posAtStart),this.dirty=nn}updateOuterDeco(e){if(kl(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=ly(this.dom,this.nodeDOM,dd(this.outerDeco,this.node,n),dd(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function Sm(t,e,n,r,o){cy(r,e,t);let s=new Tr(void 0,t,e,n,r,r,r,o,0);return s.contentDOM&&s.updateChildren(o,0),s}class ac extends Tr{constructor(e,n,r,o,s,i,a){super(e,n,r,o,s,null,i,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,o){return this.dirty==On||this.dirty!=nn&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=nn||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,o.trackWrites==this.nodeDOM&&(o.trackWrites=null)),this.node=e,this.dirty=nn,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let o=this.node.cut(e,n),s=document.createTextNode(o.text);return new ac(this.parent,o,this.outerDeco,this.innerDeco,s,s,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=On)}get domAtom(){return!1}isText(e){return this.node.text==e}}class iy extends ea{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==nn&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class c9 extends Tr{constructor(e,n,r,o,s,i,a,l,c,u){super(e,n,r,o,s,i,a,c,u),this.spec=l}update(e,n,r,o){if(this.dirty==On)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let s=this.spec.update(e,n,r);return s&&this.updateInner(e,n,r,o),s}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,o)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,o){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,o)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function ay(t,e,n){let r=t.firstChild,o=!1;for(let s=0;s<e.length;s++){let i=e[s],a=i.dom;if(a.parentNode==t){for(;a!=r;)r=_m(r),o=!0;r=r.nextSibling}else o=!0,t.insertBefore(a,r);if(i instanceof wo){let l=r?r.previousSibling:t.lastChild;ay(i.contentDOM,i.children,n),r=l?l.nextSibling:t.firstChild}}for(;r;)r=_m(r),o=!0;o&&n.trackWrites==t&&(n.trackWrites=null)}const ii=function(t){t&&(this.nodeName=t)};ii.prototype=Object.create(null);const Yr=[new ii];function dd(t,e,n){if(t.length==0)return Yr;let r=n?Yr[0]:new ii,o=[r];for(let s=0;s<t.length;s++){let i=t[s].type.attrs;if(i){i.nodeName&&o.push(r=new ii(i.nodeName));for(let a in i){let l=i[a];l!=null&&(n&&o.length==1&&o.push(r=new ii(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return o}function ly(t,e,n,r){if(n==Yr&&r==Yr)return e;let o=e;for(let s=0;s<r.length;s++){let i=r[s],a=n[s];if(s){let l;a&&a.nodeName==i.nodeName&&o!=t&&(l=o.parentNode)&&l.nodeName.toLowerCase()==i.nodeName||(l=document.createElement(i.nodeName),l.pmIsDeco=!0,l.appendChild(o),a=Yr[0]),o=l}u9(o,a||Yr[0],i)}return o}function u9(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],o=n.class?n.class.split(" ").filter(Boolean):[];for(let s=0;s<r.length;s++)o.indexOf(r[s])==-1&&t.classList.remove(r[s]);for(let s=0;s<o.length;s++)r.indexOf(o[s])==-1&&t.classList.add(o[s]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,o;for(;o=r.exec(e.style);)t.style.removeProperty(o[1])}n.style&&(t.style.cssText+=n.style)}}function cy(t,e,n){return ly(t,t,Yr,dd(e,n,t.nodeType!=1))}function kl(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function _m(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class d9{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=f9(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let o=0,s=this.stack.length>>1,i=Math.min(s,e.length);for(;o<i&&(o==s-1?this.top:this.stack[o+1<<1]).matchesMark(e[o])&&e[o].type.spec.spanning!==!1;)o++;for(;o<s;)this.destroyRest(),this.top.dirty=nn,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[s])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=wo.create(this.top,e[s],n,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,s++}}findNodeMatch(e,n,r,o){let s=-1,i;if(o>=this.preMatch.index&&(i=this.preMatch.matches[o-this.preMatch.index]).parent==this.top&&i.matchesNode(e,n,r))s=this.top.children.indexOf(i,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,n,r)&&!this.preMatch.matched.has(c)){s=a;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,n,r,o,s){let i=this.top.children[o];return i.dirty==On&&i.dom==i.contentDOM&&(i.dirty=Kr),i.update(e,n,r,s)?(this.destroyBetween(this.index,o),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let o=this.index;o<this.top.children.length;o++)if(this.top.children[o]==r)return o}return-1}e=n}}updateNextNode(e,n,r,o,s,i){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof Tr){let c=this.preMatch.matched.get(l);if(c!=null&&c!=s)return!1;let u=l.dom,d,f=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=On&&kl(n,l.outerDeco));if(!f&&l.update(e,n,r,o))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!f&&(d=this.recreateWrapper(l,e,n,r,o,i)))return this.destroyBetween(this.index,a),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=Kr,d.updateChildren(o,i+1),d.dirty=nn),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,o,s,i){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!kl(r,e.outerDeco)||!o.eq(e.innerDeco))return null;let a=Tr.create(this.top,n,r,o,s,i);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,n,r,o,s){let i=Tr.create(this.top,e,n,r,o,s);i.contentDOM&&i.updateChildren(o,s+1),this.top.children.splice(this.index++,0,i),this.changed=!0}placeWidget(e,n,r){let o=this.index<this.top.children.length?this.top.children[this.index]:null;if(o&&o.matchesWidget(e)&&(e==o.widget||!o.widget.type.toDOM.parentNode))this.index++;else{let s=new sy(this.top,e,n,r);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof wo;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof ac)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Tt||xt)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let o=new iy(this.top,[],r,null);n!=this.top?n.children.push(o):n.children.splice(this.index++,0,o),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function f9(t,e){let n=e,r=n.children.length,o=t.childCount,s=new Map,i=[];e:for(;o>0;){let a;for(;;)if(r){let c=n.children[r-1];if(c instanceof wo)n=c,r=c.children.length;else{a=c,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=t.child(o-1))break;--o,s.set(a,o),i.push(a)}}return{index:o,matched:s,matches:i.reverse()}}function h9(t,e){return t.type.side-e.type.side}function p9(t,e,n,r){let o=e.locals(t),s=0;if(o.length==0){for(let c=0;c<t.childCount;c++){let u=t.child(c);r(u,o,e.forChild(s,u),c),s+=u.nodeSize}return}let i=0,a=[],l=null;for(let c=0;;){let u,d;for(;i<o.length&&o[i].to==s;){let y=o[i++];y.widget&&(u?(d||(d=[u])).push(y):u=y)}if(u)if(d){d.sort(h9);for(let y=0;y<d.length;y++)n(d[y],c,!!l)}else n(u,c,!!l);let f,p;if(l)p=-1,f=l,l=null;else if(c<t.childCount)p=c,f=t.child(c++);else break;for(let y=0;y<a.length;y++)a[y].to<=s&&a.splice(y--,1);for(;i<o.length&&o[i].from<=s&&o[i].to>s;)a.push(o[i++]);let h=s+f.nodeSize;if(f.isText){let y=h;i<o.length&&o[i].from<y&&(y=o[i].from);for(let w=0;w<a.length;w++)a[w].to<y&&(y=a[w].to);y<h&&(l=f.cut(y-s),f=f.cut(0,y-s),h=y,p=-1)}else for(;i<o.length&&o[i].to<h;)i++;let v=f.isInline&&!f.isLeaf?a.filter(y=>!y.inline):a.slice();r(f,v,e.forChild(s,f),p),s=h}}function m9(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function g9(t,e,n,r){for(let o=0,s=0;o<t.childCount&&s<=r;){let i=t.child(o++),a=s;if(s+=i.nodeSize,!i.isText)continue;let l=i.text;for(;o<t.childCount;){let c=t.child(o++);if(s+=c.nodeSize,!c.isText)break;l+=c.text}if(s>=n){if(s>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=n)return a+c;if(n==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function fd(t,e,n,r,o){let s=[];for(let i=0,a=0;i<t.length;i++){let l=t[i],c=a,u=a+=l.size;c>=n||u<=e?s.push(l):(c<e&&s.push(l.slice(0,e-c,r)),o&&(s.push(o),o=void 0),u>n&&s.push(l.slice(n-c,l.size,r)))}return s}function gf(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let o=t.docView.nearestDesc(n.focusNode),s=o&&o.size==0,i=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(i<0)return null;let a=r.resolve(i),l,c;if(ic(n)){for(l=i;o&&!o.node;)o=o.parent;let d=o.node;if(o&&d.isAtom&&fe.isSelectable(d)&&o.parent&&!(d.isInline&&HM(n.focusNode,n.focusOffset,o.dom))){let f=o.posBefore;c=new fe(i==f?a:r.resolve(f))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let d=i,f=i;for(let p=0;p<n.rangeCount;p++){let h=n.getRangeAt(p);d=Math.min(d,t.docView.posFromDOM(h.startContainer,h.startOffset,1)),f=Math.max(f,t.docView.posFromDOM(h.endContainer,h.endOffset,-1))}if(d<0)return null;[l,i]=f==t.state.selection.anchor?[f,d]:[d,f],a=r.resolve(i)}else l=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(l<0)return null}let u=r.resolve(l);if(!c){let d=e=="pointer"||t.state.selection.head<a.pos&&!s?1:-1;c=vf(t,u,a,d)}return c}function uy(t){return t.editable?t.hasFocus():fy(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Jn(t,e=!1){let n=t.state.selection;if(dy(t,n),!!uy(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&xt){let r=t.domSelectionRange(),o=t.domObserver.currentSelection;if(r.anchorNode&&o.anchorNode&&bo(r.anchorNode,r.anchorOffset,o.anchorNode,o.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)y9(t);else{let{anchor:r,head:o}=n,s,i;Tm&&!(n instanceof he)&&(n.$from.parent.inlineContent||(s=$m(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(i=$m(t,n.to))),t.docView.setSelection(r,o,t,e),Tm&&(s&&Om(s),i&&Om(i)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&v9(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const Tm=Tt||xt&&Zv<63;function $m(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),o=r<n.childNodes.length?n.childNodes[r]:null,s=r?n.childNodes[r-1]:null;if(Tt&&o&&o.contentEditable=="false")return tu(o);if((!o||o.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(o)return tu(o);if(s)return tu(s)}}function tu(t){return t.contentEditable="true",Tt&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Om(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function v9(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,o=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=o)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!uy(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function y9(t){let e=t.domSelection();if(!e)return;let n=t.cursorWrapper.dom,r=n.nodeName=="IMG";r?e.collapse(n.parentNode,vt(n)+1):e.collapse(n,0),!r&&!t.state.selection.visible&&Dt&&_r<=11&&(n.disabled=!0,n.disabled=!1)}function dy(t,e){if(e instanceof fe){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(Mm(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else Mm(t)}function Mm(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function vf(t,e,n,r){return t.someProp("createSelectionBetween",o=>o(t,e,n))||he.between(e,n,r)}function Em(t){return t.editable&&!t.hasFocus()?!1:fy(t)}function fy(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch(n){return!1}}function b9(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return bo(e.node,e.offset,n.anchorNode,n.anchorOffset)}function hd(t,e){let{$anchor:n,$head:r}=t.selection,o=e>0?n.max(r):n.min(r),s=o.parent.inlineContent?o.depth?t.doc.resolve(e>0?o.after():o.before()):null:o;return s&&pe.findFrom(s,e)}function cr(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function Nm(t,e,n){let r=t.state.selection;if(r instanceof he)if(n.indexOf("s")>-1){let{$head:o}=r,s=o.textOffset?null:e<0?o.nodeBefore:o.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let i=t.state.doc.resolve(o.pos+s.nodeSize*(e<0?-1:1));return cr(t,new he(r.$anchor,i))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let o=hd(t.state,e);return o&&o instanceof fe?cr(t,o):!1}else if(!(Zt&&n.indexOf("m")>-1)){let o=r.$head,s=o.textOffset?null:e<0?o.nodeBefore:o.nodeAfter,i;if(!s||s.isText)return!1;let a=e<0?o.pos-s.nodeSize:o.pos;return s.isAtom||(i=t.docView.descAt(a))&&!i.contentDOM?fe.isSelectable(s)?cr(t,new fe(e<0?t.state.doc.resolve(o.pos-s.nodeSize):o)):Qi?cr(t,new he(t.state.doc.resolve(e<0?a:a+s.nodeSize))):!1:!1}}else return!1;else{if(r instanceof fe&&r.node.isInline)return cr(t,new he(e>0?r.$to:r.$from));{let o=hd(t.state,e);return o?cr(t,o):!1}}}function Cl(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function ai(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function Ao(t,e){return e<0?w9(t):k9(t)}function w9(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let o,s,i=!1;for(tn&&n.nodeType==1&&r<Cl(n)&&ai(n.childNodes[r],-1)&&(i=!0);;)if(r>0){if(n.nodeType!=1)break;{let a=n.childNodes[r-1];if(ai(a,-1))o=n,s=--r;else if(a.nodeType==3)n=a,r=n.nodeValue.length;else break}}else{if(hy(n))break;{let a=n.previousSibling;for(;a&&ai(a,-1);)o=n.parentNode,s=vt(a),a=a.previousSibling;if(a)n=a,r=Cl(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}i?pd(t,n,r):o&&pd(t,o,s)}function k9(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let o=Cl(n),s,i;for(;;)if(r<o){if(n.nodeType!=1)break;let a=n.childNodes[r];if(ai(a,1))s=n,i=++r;else break}else{if(hy(n))break;{let a=n.nextSibling;for(;a&&ai(a,1);)s=a.parentNode,i=vt(a)+1,a=a.nextSibling;if(a)n=a,r=0,o=Cl(n);else{if(n=n.parentNode,n==t.dom)break;r=o=0}}}s&&pd(t,s,i)}function hy(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function C9(t,e){for(;t&&e==t.childNodes.length&&!Zi(t);)e=vt(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function x9(t,e){for(;t&&!e&&!Zi(t);)e=vt(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function pd(t,e,n){if(e.nodeType!=3){let s,i;(i=C9(e,n))?(e=i,n=0):(s=x9(e,n))&&(e=s,n=s.nodeValue.length)}let r=t.domSelection();if(!r)return;if(ic(r)){let s=document.createRange();s.setEnd(e,n),s.setStart(e,n),r.removeAllRanges(),r.addRange(s)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:o}=t;setTimeout(()=>{t.state==o&&Jn(t)},50)}function Dm(t,e){let n=t.state.doc.resolve(e);if(!(xt||WM)&&n.parent.inlineContent){let o=t.coordsAtPos(e);if(e>n.start()){let s=t.coordsAtPos(e-1),i=(s.top+s.bottom)/2;if(i>o.top&&i<o.bottom&&Math.abs(s.left-o.left)>1)return s.left<o.left?"ltr":"rtl"}if(e<n.end()){let s=t.coordsAtPos(e+1),i=(s.top+s.bottom)/2;if(i>o.top&&i<o.bottom&&Math.abs(s.left-o.left)>1)return s.left>o.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function Am(t,e,n){let r=t.state.selection;if(r instanceof he&&!r.empty||n.indexOf("s")>-1||Zt&&n.indexOf("m")>-1)return!1;let{$from:o,$to:s}=r;if(!o.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let i=hd(t.state,e);if(i&&i instanceof fe)return cr(t,i)}if(!o.parent.inlineContent){let i=e<0?o:s,a=r instanceof Wt?pe.near(i,e):pe.findFrom(i,e);return a?cr(t,a):!1}return!1}function Rm(t,e){if(!(t.state.selection instanceof he))return!0;let{$head:n,$anchor:r,empty:o}=t.state.selection;if(!n.sameParent(r))return!0;if(!o)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(s&&!s.isText){let i=t.state.tr;return e<0?i.delete(n.pos-s.nodeSize,n.pos):i.delete(n.pos,n.pos+s.nodeSize),t.dispatch(i),!0}return!1}function Im(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function S9(t){if(!Tt||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;Im(t,r,"true"),setTimeout(()=>Im(t,r,"false"),20)}return!1}function _9(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function T9(t,e){let n=e.keyCode,r=_9(e);if(n==8||Zt&&n==72&&r=="c")return Rm(t,-1)||Ao(t,-1);if(n==46&&!e.shiftKey||Zt&&n==68&&r=="c")return Rm(t,1)||Ao(t,1);if(n==13||n==27)return!0;if(n==37||Zt&&n==66&&r=="c"){let o=n==37?Dm(t,t.state.selection.from)=="ltr"?-1:1:-1;return Nm(t,o,r)||Ao(t,o)}else if(n==39||Zt&&n==70&&r=="c"){let o=n==39?Dm(t,t.state.selection.from)=="ltr"?1:-1:1;return Nm(t,o,r)||Ao(t,o)}else{if(n==38||Zt&&n==80&&r=="c")return Am(t,-1,r)||Ao(t,-1);if(n==40||Zt&&n==78&&r=="c")return S9(t)||Am(t,1,r)||Ao(t,1);if(r==(Zt?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function yf(t,e){t.someProp("transformCopied",p=>{e=p(e,t)});let n=[],{content:r,openStart:o,openEnd:s}=e;for(;o>1&&s>1&&r.childCount==1&&r.firstChild.childCount==1;){o--,s--;let p=r.firstChild;n.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),r=p.content}let i=t.someProp("clipboardSerializer")||Ms.fromSchema(t.state.schema),a=by(),l=a.createElement("div");l.appendChild(i.serializeFragment(r,{document:a}));let c=l.firstChild,u,d=0;for(;c&&c.nodeType==1&&(u=yy[c.nodeName.toLowerCase()]);){for(let p=u.length-1;p>=0;p--){let h=a.createElement(u[p]);for(;l.firstChild;)h.appendChild(l.firstChild);l.appendChild(h),d++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice","".concat(o," ").concat(s).concat(d?" -".concat(d):""," ").concat(JSON.stringify(n)));let f=t.someProp("clipboardTextSerializer",p=>p(e,t))||e.content.textBetween(0,e.content.size,"\n\n");return{dom:l,text:f,slice:e}}function py(t,e,n,r,o){let s=o.parent.type.spec.code,i,a;if(!n&&!e)return null;let l=!!e&&(r||s||!n);if(l){if(t.someProp("transformPastedText",f=>{e=f(e,s||r,t)}),s)return a=new J(V.from(t.state.schema.text(e.replace(/\r\n?/g,"\n"))),0,0),t.someProp("transformPasted",f=>{a=f(a,t,!0)}),a;let d=t.someProp("clipboardTextParser",f=>f(e,o,r,t));if(d)a=d;else{let f=o.marks(),{schema:p}=t.state,h=Ms.fromSchema(p);i=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(v=>{let y=i.appendChild(document.createElement("p"));v&&y.appendChild(h.serializeNode(p.text(v,f)))})}}else t.someProp("transformPastedHTML",d=>{n=d(n,t)}),i=E9(n),Qi&&N9(i);let c=i&&i.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let f=i.firstChild;for(;f&&f.nodeType!=1;)f=f.nextSibling;if(!f)break;i=f}if(a||(a=(t.someProp("clipboardParser")||t.someProp("domParser")||ys.fromSchema(t.state.schema)).parseSlice(i,{preserveWhitespace:!!(l||u),context:o,ruleFromNode(f){return f.nodeName=="BR"&&!f.nextSibling&&f.parentNode&&!$9.test(f.parentNode.nodeName)?{ignore:!0}:null}})),u)a=D9(Pm(a,+u[1],+u[2]),u[4]);else if(a=J.maxOpen(O9(a.content,o),!0),a.openStart||a.openEnd){let d=0,f=0;for(let p=a.content.firstChild;d<a.openStart&&!p.type.spec.isolating;d++,p=p.firstChild);for(let p=a.content.lastChild;f<a.openEnd&&!p.type.spec.isolating;f++,p=p.lastChild);a=Pm(a,d,f)}return t.someProp("transformPasted",d=>{a=d(a,t,l)}),a}const $9=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function O9(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let o=e.node(n).contentMatchAt(e.index(n)),s,i=[];if(t.forEach(a=>{if(!i)return;let l=o.findWrapping(a.type),c;if(!l)return i=null;if(c=i.length&&s.length&&gy(l,s,a,i[i.length-1],0))i[i.length-1]=c;else{i.length&&(i[i.length-1]=vy(i[i.length-1],s.length));let u=my(a,l);i.push(u),o=o.matchType(u.type),s=l}}),i)return V.from(i)}return t}function my(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,V.from(t));return t}function gy(t,e,n,r,o){if(o<t.length&&o<e.length&&t[o]==e[o]){let s=gy(t,e,n,r.lastChild,o+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(o==t.length-1?n.type:t[o+1]))return r.copy(r.content.append(V.from(my(n,t,o+1))))}}function vy(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,vy(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(V.empty,!0);return t.copy(n.append(r))}function md(t,e,n,r,o,s){let i=e<0?t.firstChild:t.lastChild,a=i.content;return t.childCount>1&&(s=0),o<r-1&&(a=md(a,e,n,r,o+1,s)),o>=n&&(a=e<0?i.contentMatchAt(0).fillBefore(a,s<=o).append(a):a.append(i.contentMatchAt(i.childCount).fillBefore(V.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,i.copy(a))}function Pm(t,e,n){return e<t.openStart&&(t=new J(md(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new J(md(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const yy={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Lm=null;function by(){return Lm||(Lm=document.implementation.createHTMLDocument("title"))}let nu=null;function M9(t){let e=window.trustedTypes;return e?(nu||(nu=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),nu.createHTML(t)):t}function E9(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=by().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),o;if((o=r&&yy[r[1].toLowerCase()])&&(t=o.map(s=>"<"+s+">").join("")+t+o.map(s=>"</"+s+">").reverse().join("")),n.innerHTML=M9(t),o)for(let s=0;s<o.length;s++)n=n.querySelector(o[s])||n;return n}function N9(t){let e=t.querySelectorAll(xt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function D9(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch(a){return t}let{content:o,openStart:s,openEnd:i}=t;for(let a=r.length-2;a>=0;a-=2){let l=n.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;o=V.from(l.create(r[a+1],o)),s++,i++}return new J(o,s,i)}const $t={},Ot={},A9={touchstart:!0,touchmove:!0};class R9{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function I9(t){for(let e in $t){let n=$t[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{L9(t,r)&&!bf(t,r)&&(t.editable||!(r.type in Ot))&&n(t,r)},A9[e]?{passive:!0}:void 0)}Tt&&t.dom.addEventListener("input",()=>null),gd(t)}function kr(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function P9(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function gd(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>bf(t,r))})}function bf(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function L9(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function z9(t,e){!bf(t,e)&&$t[e.type]&&(t.editable||!(e.type in Ot))&&$t[e.type](t,e)}Ot.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!ky(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(Yn&&xt&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),ks&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",o=>o(t,Ur(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||T9(t,n)?n.preventDefault():kr(t,"key")};Ot.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};Ot.keypress=(t,e)=>{let n=e;if(ky(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||Zt&&n.metaKey)return;if(t.someProp("handleKeyPress",o=>o(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof he)||!r.$from.sameParent(r.$to)){let o=String.fromCharCode(n.charCode),s=()=>t.state.tr.insertText(o).scrollIntoView();!/[\r\n]/.test(o)&&!t.someProp("handleTextInput",i=>i(t,r.$from.pos,r.$to.pos,o,s))&&t.dispatch(s()),n.preventDefault()}};function lc(t){return{left:t.clientX,top:t.clientY}}function B9(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function wf(t,e,n,r,o){if(r==-1)return!1;let s=t.state.doc.resolve(r);for(let i=s.depth+1;i>0;i--)if(t.someProp(e,a=>i>s.depth?a(t,n,s.nodeAfter,s.before(i),o,!0):a(t,n,s.node(i),s.before(i),o,!1)))return!0;return!1}function Ko(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);n=="pointer"&&r.setMeta("pointer",!0),t.dispatch(r)}function F9(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&fe.isSelectable(r)?(Ko(t,new fe(n),"pointer"),!0):!1}function V9(t,e){if(e==-1)return!1;let n=t.state.selection,r,o;n instanceof fe&&(r=n.node);let s=t.state.doc.resolve(e);for(let i=s.depth+1;i>0;i--){let a=i>s.depth?s.nodeAfter:s.node(i);if(fe.isSelectable(a)){r&&n.$from.depth>0&&i>=n.$from.depth&&s.before(n.$from.depth+1)==n.$from.pos?o=s.before(n.$from.depth):o=s.before(i);break}}return o!=null?(Ko(t,fe.create(t.state.doc,o),"pointer"),!0):!1}function H9(t,e,n,r,o){return wf(t,"handleClickOn",e,n,r)||t.someProp("handleClick",s=>s(t,e,r))||(o?V9(t,n):F9(t,n))}function q9(t,e,n,r){return wf(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",o=>o(t,e,r))}function U9(t,e,n,r){return wf(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",o=>o(t,e,r))||W9(t,n,r)}function W9(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(Ko(t,he.create(r,0,r.content.size),"pointer"),!0):!1;let o=r.resolve(e);for(let s=o.depth+1;s>0;s--){let i=s>o.depth?o.nodeAfter:o.node(s),a=o.before(s);if(i.inlineContent)Ko(t,he.create(r,a+1,a+1+i.content.size),"pointer");else if(fe.isSelectable(i))Ko(t,fe.create(r,a),"pointer");else continue;return!0}}function kf(t){return xl(t)}const wy=Zt?"metaKey":"ctrlKey";$t.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=kf(t),o=Date.now(),s="singleClick";o-t.input.lastClick.time<500&&B9(n,t.input.lastClick)&&!n[wy]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?s="doubleClick":t.input.lastClick.type=="doubleClick"&&(s="tripleClick")),t.input.lastClick={time:o,x:n.clientX,y:n.clientY,type:s,button:n.button};let i=t.posAtCoords(lc(n));i&&(s=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new j9(t,i,n,!!r)):(s=="doubleClick"?q9:U9)(t,i.pos,i.inside,n)?n.preventDefault():kr(t,"pointer"))};class j9{constructor(e,n,r,o){this.view=e,this.pos=n,this.event=r,this.flushed=o,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[wy],this.allowDefault=r.shiftKey;let s,i;if(n.inside>-1)s=e.state.doc.nodeAt(n.inside),i=n.inside;else{let u=e.state.doc.resolve(n.pos);s=u.parent,i=u.depth?u.before():0}const a=o?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:c}=e.state;(r.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||c instanceof fe&&c.from<=i&&c.to>i)&&(this.mightDrag={node:s,pos:i,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&tn&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),kr(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Jn(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(lc(e))),this.updateAllowDefault(e),this.allowDefault||!n?kr(this.view,"pointer"):H9(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Tt&&this.mightDrag&&!this.mightDrag.node.isAtom||xt&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Ko(this.view,pe.near(this.view.state.doc.resolve(n.pos)),"pointer"),e.preventDefault()):kr(this.view,"pointer")}move(e){this.updateAllowDefault(e),kr(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}$t.touchstart=t=>{t.input.lastTouch=Date.now(),kf(t),kr(t,"pointer")};$t.touchmove=t=>{t.input.lastTouch=Date.now(),kr(t,"pointer")};$t.contextmenu=t=>kf(t);function ky(t,e){return t.composing?!0:Tt&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const K9=Yn?5e3:-1;Ot.compositionstart=Ot.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof he&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||n.marks(),xl(t,!0),t.markCursor=null;else if(xl(t,!e.selection.empty),tn&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let o=r.focusNode,s=r.focusOffset;o&&o.nodeType==1&&s!=0;){let i=s<0?o.lastChild:o.childNodes[s-1];if(!i)break;if(i.nodeType==3){let a=t.domSelection();a&&a.collapse(i,i.nodeValue.length);break}else o=i,s=-1}}t.input.composing=!0}Cy(t,K9)};Ot.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,Cy(t,20))};function Cy(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>xl(t),e))}function xy(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=G9());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function Y9(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=FM(e.focusNode,e.focusOffset),r=VM(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let o=r.pmViewDesc,s=t.domObserver.lastChangedTextNode;if(n==s||r==s)return s;if(!o||!o.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let i=n.pmViewDesc;if(!(!i||!i.isText(n.nodeValue)))return r}}return n||r}function G9(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function xl(t,e=!1){if(!(Yn&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),xy(t),e||t.docView&&t.docView.dirty){let n=gf(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function J9(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),o=document.createRange();o.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const Si=Dt&&_r<15||ks&&jM<604;$t.copy=Ot.cut=(t,e)=>{let n=e,r=t.state.selection,o=n.type=="cut";if(r.empty)return;let s=Si?null:n.clipboardData,i=r.content(),{dom:a,text:l}=yf(t,i);s?(n.preventDefault(),s.clearData(),s.setData("text/html",a.innerHTML),s.setData("text/plain",l)):J9(t,a),o&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function X9(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function Z9(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let o=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?_i(t,r.value,null,o,e):_i(t,r.textContent,r.innerHTML,o,e)},50)}function _i(t,e,n,r,o){let s=py(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",l=>l(t,o,s||J.empty)))return!0;if(!s)return!1;let i=X9(s),a=i?t.state.tr.replaceSelectionWith(i,r):t.state.tr.replaceSelection(s);return t.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Sy(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}Ot.paste=(t,e)=>{let n=e;if(t.composing&&!Yn)return;let r=Si?null:n.clipboardData,o=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&_i(t,Sy(r),r.getData("text/html"),o,n)?n.preventDefault():Z9(t,n)};class _y{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const Q9=Zt?"altKey":"ctrlKey";function Ty(t,e){let n=t.someProp("dragCopies",r=>!r(e));return n!=null?n:!e[Q9]}$t.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let o=t.state.selection,s=o.empty?null:t.posAtCoords(lc(n)),i;if(!(s&&s.pos>=o.from&&s.pos<=(o instanceof fe?o.to-1:o.to))){if(r&&r.mightDrag)i=fe.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let d=t.docView.nearestDesc(n.target,!0);d&&d.node.type.spec.draggable&&d!=t.docView&&(i=fe.create(t.state.doc,d.posBefore))}}let a=(i||t.state.selection).content(),{dom:l,text:c,slice:u}=yf(t,a);(!n.dataTransfer.files.length||!xt||Zv>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(Si?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",Si||n.dataTransfer.setData("text/plain",c),t.dragging=new _y(u,Ty(t,n),i)};$t.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};Ot.dragover=Ot.dragenter=(t,e)=>e.preventDefault();Ot.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let o=t.posAtCoords(lc(n));if(!o)return;let s=t.state.doc.resolve(o.pos),i=r&&r.slice;i?t.someProp("transformPasted",h=>{i=h(i,t,!1)}):i=py(t,Sy(n.dataTransfer),Si?null:n.dataTransfer.getData("text/html"),!1,s);let a=!!(r&&Ty(t,n));if(t.someProp("handleDrop",h=>h(t,n,i||J.empty,a))){n.preventDefault();return}if(!i)return;n.preventDefault();let l=i?OM(t.state.doc,s.pos,i):s.pos;l==null&&(l=s.pos);let c=t.state.tr;if(a){let{node:h}=r;h?h.replace(c):c.deleteSelection()}let u=c.mapping.map(l),d=i.openStart==0&&i.openEnd==0&&i.content.childCount==1,f=c.doc;if(d?c.replaceRangeWith(u,u,i.content.firstChild):c.replaceRange(u,u,i),c.doc.eq(f))return;let p=c.doc.resolve(u);if(d&&fe.isSelectable(i.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(i.content.firstChild))c.setSelection(new fe(p));else{let h=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((v,y,w,x)=>h=x),c.setSelection(vf(t,p,c.doc.resolve(h)))}t.focus(),t.dispatch(c.setMeta("uiEvent","drop"))};$t.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Jn(t)},20))};$t.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};$t.beforeinput=(t,e)=>{if(xt&&Yn&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",s=>s(t,Ur(8,"Backspace")))))return;let{$cursor:o}=t.state.selection;o&&o.pos>0&&t.dispatch(t.state.tr.delete(o.pos-1,o.pos).scrollIntoView())},50)}};for(let t in Ot)$t[t]=Ot[t];function Ti(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Sl{constructor(e,n){this.toDOM=e,this.spec=n||oo,this.side=this.spec.side||0}map(e,n,r,o){let{pos:s,deleted:i}=e.mapResult(n.from+o,this.side<0?-1:1);return i?null:new ht(s-r,s-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Sl&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Ti(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class $r{constructor(e,n){this.attrs=e,this.spec=n||oo}map(e,n,r,o){let s=e.map(n.from+o,this.spec.inclusiveStart?-1:1)-r,i=e.map(n.to+o,this.spec.inclusiveEnd?1:-1)-r;return s>=i?null:new ht(s,i,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof $r&&Ti(this.attrs,e.attrs)&&Ti(this.spec,e.spec)}static is(e){return e.type instanceof $r}destroy(){}}class Cf{constructor(e,n){this.attrs=e,this.spec=n||oo}map(e,n,r,o){let s=e.mapResult(n.from+o,1);if(s.deleted)return null;let i=e.mapResult(n.to+o,-1);return i.deleted||i.pos<=s.pos?null:new ht(s.pos-r,i.pos-r,this)}valid(e,n){let{index:r,offset:o}=e.content.findIndex(n.from),s;return o==n.from&&!(s=e.child(r)).isText&&o+s.nodeSize==n.to}eq(e){return this==e||e instanceof Cf&&Ti(this.attrs,e.attrs)&&Ti(this.spec,e.spec)}destroy(){}}class ht{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new ht(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new ht(e,e,new Sl(n,r))}static inline(e,n,r,o){return new ht(e,n,new $r(r,o))}static node(e,n,r,o){return new ht(e,n,new Cf(r,o))}get spec(){return this.type.spec}get inline(){return this.type instanceof $r}get widget(){return this.type instanceof Sl}}const Lo=[],oo={};class Ie{constructor(e,n){this.local=e.length?e:Lo,this.children=n.length?n:Lo}static create(e,n){return n.length?_l(n,e,0,oo):Ct}find(e,n,r){let o=[];return this.findInner(e==null?0:e,n==null?1e9:n,o,0,r),o}findInner(e,n,r,o,s){for(let i=0;i<this.local.length;i++){let a=this.local[i];a.from<=n&&a.to>=e&&(!s||s(a.spec))&&r.push(a.copy(a.from+o,a.to+o))}for(let i=0;i<this.children.length;i+=3)if(this.children[i]<n&&this.children[i+1]>e){let a=this.children[i]+1;this.children[i+2].findInner(e-a,n-a,r,o+a,s)}}map(e,n,r){return this==Ct||e.maps.length==0?this:this.mapInner(e,n,0,0,r||oo)}mapInner(e,n,r,o,s){let i;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,o);l&&l.type.valid(n,l)?(i||(i=[])).push(l):s.onRemove&&s.onRemove(this.local[a].spec)}return this.children.length?eE(this.children,i||[],e,n,r,o,s):i?new Ie(i.sort(so),Lo):Ct}add(e,n){return n.length?this==Ct?Ie.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let o,s=0;e.forEach((a,l)=>{let c=l+r,u;if(u=Oy(n,a,c)){for(o||(o=this.children.slice());s<o.length&&o[s]<l;)s+=3;o[s]==l?o[s+2]=o[s+2].addInner(a,u,c+1):o.splice(s,0,l,l+a.nodeSize,_l(u,a,c+1,oo)),s+=3}});let i=$y(s?My(n):n,-r);for(let a=0;a<i.length;a++)i[a].type.valid(e,i[a])||i.splice(a--,1);return new Ie(i.length?this.local.concat(i).sort(so):this.local,o||this.children)}remove(e){return e.length==0||this==Ct?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,o=this.local;for(let s=0;s<r.length;s+=3){let i,a=r[s]+n,l=r[s+1]+n;for(let u=0,d;u<e.length;u++)(d=e[u])&&d.from>a&&d.to<l&&(e[u]=null,(i||(i=[])).push(d));if(!i)continue;r==this.children&&(r=this.children.slice());let c=r[s+2].removeInner(i,a+1);c!=Ct?r[s+2]=c:(r.splice(s,3),s-=3)}if(o.length){for(let s=0,i;s<e.length;s++)if(i=e[s])for(let a=0;a<o.length;a++)o[a].eq(i,n)&&(o==this.local&&(o=this.local.slice()),o.splice(a--,1))}return r==this.children&&o==this.local?this:o.length||r.length?new Ie(o,r):Ct}forChild(e,n){if(this==Ct)return this;if(n.isLeaf)return Ie.empty;let r,o;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let s=e+1,i=s+n.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<i&&l.to>s&&l.type instanceof $r){let c=Math.max(s,l.from)-s,u=Math.min(i,l.to)-s;c<u&&(o||(o=[])).push(l.copy(c,u))}}if(o){let a=new Ie(o.sort(so),Lo);return r?new hr([a,r]):a}return r||Ct}eq(e){if(this==e)return!0;if(!(e instanceof Ie)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return xf(this.localsInner(e))}localsInner(e){if(this==Ct)return Lo;if(e.inlineContent||!this.local.some($r.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof $r||n.push(this.local[r]);return n}forEachSet(e){e(this)}}Ie.empty=new Ie([],[]);Ie.removeOverlap=xf;const Ct=Ie.empty;class hr{constructor(e){this.members=e}map(e,n){const r=this.members.map(o=>o.map(e,n,oo));return hr.from(r)}forChild(e,n){if(n.isLeaf)return Ie.empty;let r=[];for(let o=0;o<this.members.length;o++){let s=this.members[o].forChild(e,n);s!=Ct&&(s instanceof hr?r=r.concat(s.members):r.push(s))}return hr.from(r)}eq(e){if(!(e instanceof hr)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let o=0;o<this.members.length;o++){let s=this.members[o].localsInner(e);if(s.length)if(!n)n=s;else{r&&(n=n.slice(),r=!1);for(let i=0;i<s.length;i++)n.push(s[i])}}return n?xf(r?n:n.sort(so)):Lo}static from(e){switch(e.length){case 0:return Ct;case 1:return e[0];default:return new hr(e.every(n=>n instanceof Ie)?e:e.reduce((n,r)=>n.concat(r instanceof Ie?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function eE(t,e,n,r,o,s,i){let a=t.slice();for(let c=0,u=s;c<n.maps.length;c++){let d=0;n.maps[c].forEach((f,p,h,v)=>{let y=v-h-(p-f);for(let w=0;w<a.length;w+=3){let x=a[w+1];if(x<0||f>x+u-d)continue;let $=a[w]+u-d;p>=$?a[w+1]=f<=$?-2:-1:f>=u&&y&&(a[w]+=y,a[w+1]+=y)}d+=y}),u=n.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=n.map(t[c]+s),d=u-o;if(d<0||d>=r.content.size){l=!0;continue}let f=n.map(t[c+1]+s,-1),p=f-o,{index:h,offset:v}=r.content.findIndex(d),y=r.maybeChild(h);if(y&&v==d&&v+y.nodeSize==p){let w=a[c+2].mapInner(n,y,u+1,t[c]+s+1,i);w!=Ct?(a[c]=d,a[c+1]=p,a[c+2]=w):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=tE(a,t,e,n,o,s,i),u=_l(c,r,0,i);e=u.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,f=0;d<u.children.length;d+=3){let p=u.children[d];for(;f<a.length&&a[f]<p;)f+=3;a.splice(f,0,u.children[d],u.children[d+1],u.children[d+2])}}return new Ie(e.sort(so),a)}function $y(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let o=t[r];n.push(new ht(o.from+e,o.to+e,o.type))}return n}function tE(t,e,n,r,o,s,i){function a(l,c){for(let u=0;u<l.local.length;u++){let d=l.local[u].map(r,o,c);d?n.push(d):i.onRemove&&i.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<t.length;l+=3)t[l+1]==-1&&a(t[l+2],e[l]+s+1);return n}function Oy(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,o=null;for(let s=0,i;s<t.length;s++)(i=t[s])&&i.from>n&&i.to<r&&((o||(o=[])).push(i),t[s]=null);return o}function My(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function _l(t,e,n,r){let o=[],s=!1;e.forEach((a,l)=>{let c=Oy(t,a,l+n);if(c){s=!0;let u=_l(c,a,n+l+1,r);u!=Ct&&o.push(l,l+a.nodeSize,u)}});let i=$y(s?My(t):t,-n).sort(so);for(let a=0;a<i.length;a++)i[a].type.valid(e,i[a])||(r.onRemove&&r.onRemove(i[a].spec),i.splice(a--,1));return i.length||o.length?new Ie(i,o):Ct}function so(t,e){return t.from-e.from||t.to-e.to}function xf(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let o=n+1;o<e.length;o++){let s=e[o];if(s.from==r.from){s.to!=r.to&&(e==t&&(e=t.slice()),e[o]=s.copy(s.from,r.to),zm(e,o+1,s.copy(r.to,s.to)));continue}else{s.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,s.from),zm(e,o,r.copy(s.from,r.to)));break}}}return e}function zm(t,e,n){for(;e<t.length&&so(n,t[e])>0;)e++;t.splice(e,0,n)}function ru(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=Ct&&e.push(r)}),t.cursorWrapper&&e.push(Ie.create(t.state.doc,[t.cursorWrapper.deco])),hr.from(e)}const nE={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},rE=Dt&&_r<=11;class oE{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class sE{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new oE,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let o=0;o<r.length;o++)this.queue.push(r[o]);Dt&&_r<=11&&r.some(o=>o.type=="childList"&&o.removedNodes.length||o.type=="characterData"&&o.oldValue.length>o.target.nodeValue.length)?this.flushSoon():this.flush()}),rE&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,nE)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Em(this.view)){if(this.suppressingSelectionUpdates)return Jn(this.view);if(Dt&&_r<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&bo(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let s=e.focusNode;s;s=ws(s))n.add(s);for(let s=e.anchorNode;s;s=ws(s))if(n.has(s)){r=s;break}let o=r&&this.view.docView.nearestDesc(r);if(o&&o.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),o=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&Em(e)&&!this.ignoreSelectionChange(r),s=-1,i=-1,a=!1,l=[];if(e.editable)for(let u=0;u<n.length;u++){let d=this.registerMutation(n[u],l);d&&(s=s<0?d.from:Math.min(d.from,s),i=i<0?d.to:Math.max(d.to,i),d.typeOver&&(a=!0))}if(tn&&l.length){let u=l.filter(d=>d.nodeName=="BR");if(u.length==2){let[d,f]=u;d.parentNode&&d.parentNode.parentNode==f.parentNode?f.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let f of u){let p=f.parentNode;p&&p.nodeName=="LI"&&(!d||lE(e,d)!=p)&&f.remove()}}}let c=null;s<0&&o&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&ic(r)&&(c=gf(e))&&c.eq(pe.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Jn(e),this.currentSelection.set(r),e.scrollToSelection()):(s>-1||o)&&(s>-1&&(e.docView.markDirty(s,i),iE(e)),this.handleDOMChange(s,i,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Jn(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let d=e.addedNodes[u];n.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let o=e.previousSibling,s=e.nextSibling;if(Dt&&_r<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:d,nextSibling:f}=e.addedNodes[u];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(o=d),(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(s=f)}let i=o&&o.parentNode==e.target?vt(o)+1:0,a=r.localPosFromDOM(e.target,i,-1),l=s&&s.parentNode==e.target?vt(s):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let Bm=new WeakMap,Fm=!1;function iE(t){if(!Bm.has(t)&&(Bm.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=tn,Fm)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Fm=!0}}function Vm(t,e){let n=e.startContainer,r=e.startOffset,o=e.endContainer,s=e.endOffset,i=t.domAtPos(t.state.selection.anchor);return bo(i.node,i.offset,o,s)&&([n,r,o,s]=[o,s,n,r]),{anchorNode:n,anchorOffset:r,focusNode:o,focusOffset:s}}function aE(t,e){if(e.getComposedRanges){let o=e.getComposedRanges(t.root)[0];if(o)return Vm(t,o)}let n;function r(o){o.preventDefault(),o.stopImmediatePropagation(),n=o.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?Vm(t,n):null}function lE(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function cE(t,e,n){let{node:r,fromOffset:o,toOffset:s,from:i,to:a}=t.docView.parseRange(e,n),l=t.domSelectionRange(),c,u=l.anchorNode;if(u&&t.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],ic(l)||c.push({node:l.focusNode,offset:l.focusOffset})),xt&&t.input.lastKeyCode===8)for(let y=s;y>o;y--){let w=r.childNodes[y-1],x=w.pmViewDesc;if(w.nodeName=="BR"&&!x){s=y;break}if(!x||x.size)break}let d=t.state.doc,f=t.someProp("domParser")||ys.fromSchema(t.state.schema),p=d.resolve(i),h=null,v=f.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:o,to:s,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:uE,context:p});if(c&&c[0].pos!=null){let y=c[0].pos,w=c[1]&&c[1].pos;w==null&&(w=y),h={anchor:y+i,head:w+i}}return{doc:v,sel:h,from:i,to:a}}function uE(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Tt&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||Tt&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const dE=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function fE(t,e,n,r,o){let s=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let D=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,N=gf(t,D);if(N&&!t.state.selection.eq(N)){if(xt&&Yn&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",Y=>Y(t,Ur(13,"Enter"))))return;let H=t.state.tr.setSelection(N);D=="pointer"?H.setMeta("pointer",!0):D=="key"&&H.scrollIntoView(),s&&H.setMeta("composition",s),t.dispatch(H)}return}let i=t.state.doc.resolve(e),a=i.sharedDepth(n);e=i.before(a+1),n=t.state.doc.resolve(n).after(a+1);let l=t.state.selection,c=cE(t,e,n),u=t.state.doc,d=u.slice(c.from,c.to),f,p;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(f=t.state.selection.to,p="end"):(f=t.state.selection.from,p="start"),t.input.lastKeyCode=null;let h=mE(d.content,c.doc.content,c.from,f,p);if(h&&t.input.domChangeCount++,(ks&&t.input.lastIOSEnter>Date.now()-225||Yn)&&o.some(D=>D.nodeType==1&&!dE.test(D.nodeName))&&(!h||h.endA>=h.endB)&&t.someProp("handleKeyDown",D=>D(t,Ur(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!h)if(r&&l instanceof he&&!l.empty&&l.$head.sameParent(l.$anchor)&&!t.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))h={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let D=Hm(t,t.state.doc,c.sel);if(D&&!D.eq(t.state.selection)){let N=t.state.tr.setSelection(D);s&&N.setMeta("composition",s),t.dispatch(N)}}return}t.state.selection.from<t.state.selection.to&&h.start==h.endB&&t.state.selection instanceof he&&(h.start>t.state.selection.from&&h.start<=t.state.selection.from+2&&t.state.selection.from>=c.from?h.start=t.state.selection.from:h.endA<t.state.selection.to&&h.endA>=t.state.selection.to-2&&t.state.selection.to<=c.to&&(h.endB+=t.state.selection.to-h.endA,h.endA=t.state.selection.to)),Dt&&_r<=11&&h.endB==h.start+1&&h.endA==h.start&&h.start>c.from&&c.doc.textBetween(h.start-c.from-1,h.start-c.from+1)==" "&&(h.start--,h.endA--,h.endB--);let v=c.doc.resolveNoCache(h.start-c.from),y=c.doc.resolveNoCache(h.endB-c.from),w=u.resolve(h.start),x=v.sameParent(y)&&v.parent.inlineContent&&w.end()>=h.endA;if((ks&&t.input.lastIOSEnter>Date.now()-225&&(!x||o.some(D=>D.nodeName=="DIV"||D.nodeName=="P"))||!x&&v.pos<c.doc.content.size&&(!v.sameParent(y)||!v.parent.inlineContent)&&v.pos<y.pos&&!/\S/.test(c.doc.textBetween(v.pos,y.pos,"","")))&&t.someProp("handleKeyDown",D=>D(t,Ur(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>h.start&&pE(u,h.start,h.endA,v,y)&&t.someProp("handleKeyDown",D=>D(t,Ur(8,"Backspace")))){Yn&&xt&&t.domObserver.suppressSelectionUpdates();return}xt&&h.endB==h.start&&(t.input.lastChromeDelete=Date.now()),Yn&&!x&&v.start()!=y.start()&&y.parentOffset==0&&v.depth==y.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==h.endA&&(h.endB-=2,y=c.doc.resolveNoCache(h.endB-c.from),setTimeout(()=>{t.someProp("handleKeyDown",function(D){return D(t,Ur(13,"Enter"))})},20));let $=h.start,S=h.endA,_=D=>{let N=D||t.state.tr.replace($,S,c.doc.slice(h.start-c.from,h.endB-c.from));if(c.sel){let H=Hm(t,N.doc,c.sel);H&&!(xt&&t.composing&&H.empty&&(h.start!=h.endB||t.input.lastChromeDelete<Date.now()-100)&&(H.head==$||H.head==N.mapping.map(S)-1)||Dt&&H.empty&&H.head==$)&&N.setSelection(H)}return s&&N.setMeta("composition",s),N.scrollIntoView()},E;if(x)if(v.pos==y.pos){Dt&&_r<=11&&v.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Jn(t),20));let D=_(t.state.tr.delete($,S)),N=u.resolve(h.start).marksAcross(u.resolve(h.endA));N&&D.ensureMarks(N),t.dispatch(D)}else if(h.endA==h.endB&&(E=hE(v.parent.content.cut(v.parentOffset,y.parentOffset),w.parent.content.cut(w.parentOffset,h.endA-w.start())))){let D=_(t.state.tr);E.type=="add"?D.addMark($,S,E.mark):D.removeMark($,S,E.mark),t.dispatch(D)}else if(v.parent.child(v.index()).isText&&v.index()==y.index()-(y.textOffset?0:1)){let D=v.parent.textBetween(v.parentOffset,y.parentOffset),N=()=>_(t.state.tr.insertText(D,$,S));t.someProp("handleTextInput",H=>H(t,$,S,D,N))||t.dispatch(N())}else t.dispatch(_());else t.dispatch(_())}function Hm(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:vf(t,e.resolve(n.anchor),e.resolve(n.head))}function hE(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,o=n,s=r,i,a,l;for(let u=0;u<r.length;u++)o=r[u].removeFromSet(o);for(let u=0;u<n.length;u++)s=n[u].removeFromSet(s);if(o.length==1&&s.length==0)a=o[0],i="add",l=u=>u.mark(a.addToSet(u.marks));else if(o.length==0&&s.length==1)a=s[0],i="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(V.from(c).eq(t))return{mark:a,type:i}}function pE(t,e,n,r,o){if(n-e<=o.pos-r.pos||ou(r,!0,!1)<o.pos)return!1;let s=t.resolve(e);if(!r.parent.isTextblock){let a=s.nodeAfter;return a!=null&&n==e+a.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let i=t.resolve(ou(s,!0,!0));return!i.parent.isTextblock||i.pos>n||ou(i,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(i.parent.content)}function ou(t,e,n){let r=t.depth,o=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,o++,e=!1;if(n){let s=t.node(r).maybeChild(t.indexAfter(r));for(;s&&!s.isLeaf;)s=s.firstChild,o++}return o}function mE(t,e,n,r,o){let s=t.findDiffStart(e,n);if(s==null)return null;let{a:i,b:a}=t.findDiffEnd(e,n+t.size,n+e.size);if(o=="end"){let l=Math.max(0,s-Math.min(i,a));r-=i+l-s}if(i<s&&t.size<e.size){let l=r<=s&&r>=i?s-r:0;s-=l,s&&s<e.size&&qm(e.textBetween(s-1,s+1))&&(s+=l?1:-1),a=s+(a-i),i=s}else if(a<s){let l=r<=s&&r>=a?s-r:0;s-=l,s&&s<t.size&&qm(t.textBetween(s-1,s+1))&&(s+=l?1:-1),i=s+(i-a),a=s}return{start:s,endA:i,endB:a}}function qm(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class Ey{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new R9,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(Ym),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=jm(this),Wm(this),this.nodeViews=Km(this),this.docView=Sm(this.state.doc,Um(this),ru(this),this.dom,this),this.domObserver=new sE(this,(r,o,s,i)=>fE(this,r,o,s,i)),this.domObserver.start(),I9(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&gd(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Ym),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let o=this.state,s=!1,i=!1;e.storedMarks&&this.composing&&(xy(this),i=!0),this.state=e;let a=o.plugins!=e.plugins||this._props.plugins!=n.plugins;if(a||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let p=Km(this);vE(p,this.nodeViews)&&(this.nodeViews=p,s=!0)}(a||n.handleDOMEvents!=this._props.handleDOMEvents)&&gd(this),this.editable=jm(this),Wm(this);let l=ru(this),c=Um(this),u=o.plugins!=e.plugins&&!o.doc.eq(e.doc)?"reset":e.scrollToSelection>o.scrollToSelection?"to selection":"preserve",d=s||!this.docView.matchesNode(e.doc,c,l);(d||!e.selection.eq(o.selection))&&(i=!0);let f=u=="preserve"&&i&&this.dom.style.overflowAnchor==null&&GM(this);if(i){this.domObserver.stop();let p=d&&(Dt||xt)&&!this.composing&&!o.selection.empty&&!e.selection.empty&&gE(o.selection,e.selection);if(d){let h=xt?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=Y9(this)),(s||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=Sm(e.doc,c,l,this.dom,this)),h&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&b9(this))?Jn(this,p):(dy(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(o),!((r=this.dragging)===null||r===void 0)&&r.node&&!o.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,o),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():f&&JM(f)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof fe){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&ym(this,n.getBoundingClientRect(),e)}else ym(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,o=-1;if(this.state.doc.nodeAt(r.from)==r.node)o=r.from;else{let s=r.from+(this.state.doc.content.size-n.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==r.node&&(o=s)}this.dragging=new _y(e.slice,e.move,o<0?void 0:fe.create(this.state.doc,o))}someProp(e,n){let r=this._props&&this._props[e],o;if(r!=null&&(o=n?n(r):r))return o;for(let i=0;i<this.directPlugins.length;i++){let a=this.directPlugins[i].props[e];if(a!=null&&(o=n?n(a):a))return o}let s=this.state.plugins;if(s)for(let i=0;i<s.length;i++){let a=s[i].props[e];if(a!=null&&(o=n?n(a):a))return o}}hasFocus(){if(Dt){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&XM(this.dom),Jn(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return n9(this,e)}coordsAtPos(e,n=1){return ry(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let o=this.docView.posFromDOM(e,n,r);if(o==null)throw new RangeError("DOM position not inside the editor");return o}endOfTextblock(e,n){return a9(this,n||this.state,e)}pasteHTML(e,n){return _i(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return _i(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return yf(this,e)}destroy(){this.docView&&(P9(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ru(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,zM())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return z9(this,e)}domSelectionRange(){let e=this.domSelection();return e?Tt&&this.root.nodeType===11&&qM(this.dom.ownerDocument)==this.dom&&aE(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}Ey.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function Um(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[ht.node(0,t.state.doc.content.size,e)]}function Wm(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:ht.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function jm(t){return!t.someProp("editable",e=>e(t.state)===!1)}function gE(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function Km(t){let e=Object.create(null);function n(r){for(let o in r)Object.prototype.hasOwnProperty.call(e,o)||(e[o]=r[o])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function vE(t,e){let n=0,r=0;for(let o in t){if(t[o]!=e[o])return!0;n++}for(let o in e)r++;return n!=r}function Ym(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var yE=Object.defineProperty,bE=(t,e,n)=>e in t?yE(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,en=(t,e,n)=>(bE(t,typeof e!="symbol"?e+"":e,n),n);const wE=Symbol("[ProsemirrorAdapter]nodeViewContext"),kE=Symbol("[ProsemirrorAdapter]useNodeViewFactory");class CE extends z7{constructor(){super(...arguments),en(this,"key",uf()),en(this,"context",{contentRef:e=>{e&&e instanceof HTMLElement&&this.contentDOM&&e.firstChild!==this.contentDOM&&e.appendChild(this.contentDOM)},view:this.view,getPos:this.getPos,setAttrs:this.setAttrs,node:yr(this.node),selected:yr(this.selected),decorations:yr(this.decorations),innerDecorations:yr(this.innerDecorations)}),en(this,"updateContext",()=>{Object.entries({node:this.node,selected:this.selected,decorations:this.decorations,innerDecorations:this.innerDecorations}).forEach(([e,n])=>{const r=this.context[e];r.value!==n&&(r.value=n)})}),en(this,"render",()=>{const e=this.component;return Wl(L({name:"ProsemirrorNodeView",setup:()=>(at(wE,this.context),()=>M(Pr,{key:this.key,to:this.dom},{default:()=>[M(e,null,null)]}))}))})}}const xE=(t,e)=>n=>(r,o,s,i,a)=>{const l=new CE({node:r,view:o,getPos:s,decorations:i,innerDecorations:a,options:{...n,onUpdate(){var c;(c=n.onUpdate)==null||c.call(n),l.updateContext()},selectNode(){var c;(c=n.selectNode)==null||c.call(n),l.updateContext()},deselectNode(){var c;(c=n.deselectNode)==null||c.call(n),l.updateContext()},destroy(){var c;(c=n.destroy)==null||c.call(n),e(l)}}});return t(l),l},Ny=Symbol("[ProsemirrorAdapter]nodeViewContext"),cc=()=>Ye(Ny),Dy=Symbol("[ProsemirrorAdapter]usePluginViewFactory"),Sf=()=>Ye(Dy);class SE extends B7{constructor(){super(...arguments),en(this,"key",uf()),en(this,"context",{view:yr(this.view),prevState:yr(this.prevState)}),en(this,"updateContext",()=>{Object.entries({view:this.view,prevState:this.prevState}).forEach(([e,n])=>{const r=this.context[e];if(e==="view"){const o=Object.assign(Object.create(Object.getPrototypeOf(n)),n);r.value=o;return}r.value=n})}),en(this,"render",()=>{const e=this.component;return Wl(L({name:"ProsemirrorNodeView",setup:()=>(at(Ny,this.context),()=>M(Pr,{key:this.key,to:this.root},{default:()=>[M(e,null,null)]}))}))})}}const _E=(t,e)=>n=>r=>{const o=new SE({view:r,options:{...n,update:(s,i)=>{var a;(a=n.update)==null||a.call(n,s,i),o.updateContext()},destroy:()=>{var s;(s=n.destroy)==null||s.call(n),e(o)}}});return t(o),o},TE=()=>{const t=T({}),e=_s(),n=Wl({});return Vd(()=>{n.updater=()=>{e==null||e.update()}}),fn(()=>{n.updater=void 0}),{portals:t,renderVueRenderer:r=>{var o;t.value[r.key]=r.render(),(o=n.updater)==null||o.call(n)},removeVueRenderer:r=>{delete t.value[r.key]}}},Ay=Symbol("[ProsemirrorAdapter]widgetViewContext"),$E=()=>Ye(Ay),Ry=Symbol("[ProsemirrorAdapter]useWidgetViewFactory"),OE=()=>Ye(Ry);class ME extends F7{constructor(){super(...arguments),en(this,"key",uf()),en(this,"context",{view:this.view,getPos:this.getPos,spec:this.spec}),en(this,"updateContext",()=>{Object.assign(this.context,{view:this.view,getPos:this.getPos,spec:this.spec})}),en(this,"render",()=>{const e=this.component;return Wl(L({name:"ProsemirrorWidgetView",setup:()=>(at(Ay,this.context),()=>M(Pr,{key:this.key,to:this.dom},{default:()=>[M(e,null,null)]}))}))})}}const EE=(t,e)=>n=>(r,o={})=>{const s=new ME({pos:r,options:n}),i={...o,destroy:a=>{var l;(l=o.destroy)==null||l.call(o,a),e(s)}};return s.spec=i,ht.widget(r,(a,l)=>(s.bind(a,l),s.updateContext(),t(s),s.dom),i)},NE=L({name:"ProsemirrorAdapterProvider",setup:(t,{slots:e})=>{const{portals:n,renderVueRenderer:r,removeVueRenderer:o}=TE(),s=xE(r,o),i=_E(r,o),a=EE(r,o);return at(kE,s),at(Dy,i),at(Ry,a),()=>{var l;return M(K,null,[(l=e.default)==null?void 0:l.call(e),Object.values(n.value).map(c=>st(c))])}}});var Kt=(t=>(t.docTypeError="docTypeError",t.contextNotFound="contextNotFound",t.timerNotFound="timerNotFound",t.ctxCallOutOfScope="ctxCallOutOfScope",t.createNodeInParserFail="createNodeInParserFail",t.stackOverFlow="stackOverFlow",t.parserMatchError="parserMatchError",t.serializerMatchError="serializerMatchError",t.getAtomFromSchemaFail="getAtomFromSchemaFail",t.expectDomTypeError="expectDomTypeError",t.callCommandBeforeEditorView="callCommandBeforeEditorView",t.missingRootElement="missingRootElement",t.missingNodeInSchema="missingNodeInSchema",t.missingMarkInSchema="missingMarkInSchema",t.ctxNotBind="ctxNotBind",t.missingYjsDoc="missingYjsDoc",t))(Kt||{});class an extends Error{constructor(e,n){super(n),this.name="MilkdownError",this.code=e}}const DE=(t,e)=>typeof e=="function"?"[Function]":e,uc=t=>JSON.stringify(t,DE);function AE(t){return new an(Kt.docTypeError,"Doc type error, unsupported type: ".concat(uc(t)))}function RE(t){return new an(Kt.contextNotFound,'Context "'.concat(t,'" not found, do you forget to inject it?'))}function IE(t){return new an(Kt.timerNotFound,'Timer "'.concat(t,'" not found, do you forget to record it?'))}function dc(){return new an(Kt.ctxCallOutOfScope,"Should not call a context out of the plugin.")}function PE(t,e,n){const r="name"in t?t.name:t,o="Cannot create node for ".concat(r),s=u=>{if(u==null)return"null";if(Array.isArray(u))return"[".concat(u.map(s).join(", "),"]");if(typeof u=="object")return"toJSON"in u&&typeof u.toJSON=="function"?JSON.stringify(u.toJSON()):"spec"in u?JSON.stringify(u.spec):JSON.stringify(u);if(typeof u=="string"||typeof u=="number"||typeof u=="boolean")return JSON.stringify(u);if(typeof u=="function")return"[Function: ".concat(u.name||"anonymous","]");try{return String(u)}catch(d){return"[Unserializable]"}},i=["[Description]",o],a=["[Attributes]",e],l=["[Content]",(n!=null?n:[]).map(u=>u?typeof u=="object"&&"type"in u?"".concat(u):s(u):"null")],c=[i,a,l].reduce((u,[d,f])=>{const p="".concat(d,": ").concat(s(f),".");return u.concat(p)},[]);return new an(Kt.createNodeInParserFail,c.join("\n"))}function Iy(){return new an(Kt.stackOverFlow,"Stack over flow, cannot pop on an empty stack.")}function LE(t){return new an(Kt.parserMatchError,"Cannot match target parser for node: ".concat(uc(t),"."))}function zE(t){return new an(Kt.serializerMatchError,"Cannot match target serializer for node: ".concat(uc(t),"."))}function En(t){return new an(Kt.expectDomTypeError,"Expect to be a dom, but get: ".concat(uc(t),"."))}function su(){return new an(Kt.callCommandBeforeEditorView,"You're trying to call a command before editor view initialized, make sure to get commandManager from ctx after editor view has been initialized")}function BE(t){return new an(Kt.missingNodeInSchema,'Missing node in schema, milkdown cannot find "'.concat(t,'" in schema.'))}function FE(t){return new an(Kt.missingMarkInSchema,'Missing mark in schema, milkdown cannot find "'.concat(t,'" in schema.'))}class Py{constructor(){this.sliceMap=new Map,this.get=e=>{const n=typeof e=="string"?[...this.sliceMap.values()].find(r=>r.type.name===e):this.sliceMap.get(e.id);if(!n){const r=typeof e=="string"?e:e.name;throw RE(r)}return n},this.remove=e=>{const n=typeof e=="string"?[...this.sliceMap.values()].find(r=>r.type.name===e):this.sliceMap.get(e.id);n&&this.sliceMap.delete(n.type.id)},this.has=e=>typeof e=="string"?[...this.sliceMap.values()].some(n=>n.type.name===e):this.sliceMap.has(e.id)}}var un,Fn,Jo;class VE{constructor(e,n,r){ie(this,un,void 0);ie(this,Fn,void 0);ie(this,Jo,void 0);G(this,un,[]),G(this,Jo,()=>{A(this,un).forEach(o=>o(A(this,Fn)))}),this.set=o=>{G(this,Fn,o),A(this,Jo).call(this)},this.get=()=>A(this,Fn),this.update=o=>{G(this,Fn,o(A(this,Fn))),A(this,Jo).call(this)},this.type=r,G(this,Fn,n),e.set(r.id,this)}on(e){return A(this,un).push(e),()=>{G(this,un,A(this,un).filter(n=>n!==e))}}once(e){const n=this.on(r=>{e(r),n()});return n}off(e){G(this,un,A(this,un).filter(n=>n!==e))}offAll(){G(this,un,[])}}un=new WeakMap,Fn=new WeakMap,Jo=new WeakMap;class HE{constructor(e,n){this.id=Symbol("Context-".concat(n)),this.name=n,this._defaultValue=e,this._typeInfo=()=>{throw dc()}}create(e,n=this._defaultValue){return new VE(e,n,this)}}const we=(t,e)=>new HE(t,e);var Di,Ai,Ri,Gr,Xo,mr,Zo,Qo,es;class qE{constructor(e,n,r){ie(this,Di,void 0);ie(this,Ai,void 0);ie(this,Ri,void 0);ie(this,Gr,void 0);ie(this,Xo,void 0);ie(this,mr,void 0);ie(this,Zo,void 0);ie(this,Qo,void 0);ie(this,es,void 0);G(this,Gr,new Set),G(this,Xo,new Set),G(this,mr,new Map),G(this,Zo,new Map),this.read=()=>({metadata:A(this,Di),injectedSlices:[...A(this,Gr)].map(o=>({name:typeof o=="string"?o:o.name,value:A(this,Qo).call(this,o)})),consumedSlices:[...A(this,Xo)].map(o=>({name:typeof o=="string"?o:o.name,value:A(this,Qo).call(this,o)})),recordedTimers:[...A(this,mr)].map(([o,{duration:s}])=>({name:o.name,duration:s,status:A(this,es).call(this,o)})),waitTimers:[...A(this,Zo)].map(([o,{duration:s}])=>({name:o.name,duration:s,status:A(this,es).call(this,o)}))}),this.onRecord=o=>{A(this,mr).set(o,{start:Date.now(),duration:0})},this.onClear=o=>{A(this,mr).delete(o)},this.onDone=o=>{const s=A(this,mr).get(o);s&&(s.duration=Date.now()-s.start)},this.onWait=(o,s)=>{const i=Date.now();s.finally(()=>{A(this,Zo).set(o,{duration:Date.now()-i})}).catch(console.error)},this.onInject=o=>{A(this,Gr).add(o)},this.onRemove=o=>{A(this,Gr).delete(o)},this.onUse=o=>{A(this,Xo).add(o)},G(this,Qo,o=>A(this,Ai).get(o).get()),G(this,es,o=>A(this,Ri).get(o).status),G(this,Ai,e),G(this,Ri,n),G(this,Di,r)}}Di=new WeakMap,Ai=new WeakMap,Ri=new WeakMap,Gr=new WeakMap,Xo=new WeakMap,mr=new WeakMap,Zo=new WeakMap,Qo=new WeakMap,es=new WeakMap;var Vn,Hn,Ii,Jt;const Zh=class Zh{constructor(e,n,r){ie(this,Vn,void 0);ie(this,Hn,void 0);ie(this,Ii,void 0);ie(this,Jt,void 0);this.produce=o=>o&&Object.keys(o).length?new Zh(A(this,Vn),A(this,Hn),{...o}):this,this.inject=(o,s)=>{var a;const i=o.create(A(this,Vn).sliceMap);return s!=null&&i.set(s),(a=A(this,Jt))==null||a.onInject(o),this},this.remove=o=>{var s;return A(this,Vn).remove(o),(s=A(this,Jt))==null||s.onRemove(o),this},this.record=o=>{var s;return o.create(A(this,Hn).store),(s=A(this,Jt))==null||s.onRecord(o),this},this.clearTimer=o=>{var s;return A(this,Hn).remove(o),(s=A(this,Jt))==null||s.onClear(o),this},this.isInjected=o=>A(this,Vn).has(o),this.isRecorded=o=>A(this,Hn).has(o),this.use=o=>{var s;return(s=A(this,Jt))==null||s.onUse(o),A(this,Vn).get(o)},this.get=o=>this.use(o).get(),this.set=(o,s)=>this.use(o).set(s),this.update=(o,s)=>this.use(o).update(s),this.timer=o=>A(this,Hn).get(o),this.done=o=>{var s;this.timer(o).done(),(s=A(this,Jt))==null||s.onDone(o)},this.wait=o=>{var i;const s=this.timer(o).start();return(i=A(this,Jt))==null||i.onWait(o,s),s},this.waitTimers=async o=>{await Promise.all(this.get(o).map(s=>this.wait(s)))},G(this,Vn,e),G(this,Hn,n),G(this,Ii,r),r&&G(this,Jt,new qE(e,n,r))}get meta(){return A(this,Ii)}get inspector(){return A(this,Jt)}};Vn=new WeakMap,Hn=new WeakMap,Ii=new WeakMap,Jt=new WeakMap;let vd=Zh;class UE{constructor(){this.store=new Map,this.get=e=>{const n=this.store.get(e.id);if(!n)throw IE(e.name);return n},this.remove=e=>{this.store.delete(e.id)},this.has=e=>this.store.has(e.id)}}var ts,gr,ns,qn,rs,Pi;class WE{constructor(e,n){ie(this,ts,void 0);ie(this,gr,void 0);ie(this,ns,void 0);ie(this,qn,void 0);ie(this,rs,void 0);ie(this,Pi,void 0);G(this,ts,null),G(this,gr,null),G(this,qn,"pending"),this.start=()=>{var r;return(r=A(this,ts))!=null||G(this,ts,new Promise((o,s)=>{G(this,gr,i=>{i instanceof CustomEvent&&i.detail.id===A(this,ns)&&(G(this,qn,"resolved"),A(this,rs).call(this),i.stopImmediatePropagation(),o())}),A(this,Pi).call(this,()=>{A(this,qn)==="pending"&&G(this,qn,"rejected"),A(this,rs).call(this),s(new Error("Timing ".concat(this.type.name," timeout.")))}),G(this,qn,"pending"),addEventListener(this.type.name,A(this,gr))})),A(this,ts)},this.done=()=>{const r=new CustomEvent(this.type.name,{detail:{id:A(this,ns)}});dispatchEvent(r)},G(this,rs,()=>{A(this,gr)&&removeEventListener(this.type.name,A(this,gr))}),G(this,Pi,r=>{setTimeout(()=>{r()},this.type.timeout)}),G(this,ns,Symbol(n.name)),this.type=n,e.set(n.id,this)}get status(){return A(this,qn)}}ts=new WeakMap,gr=new WeakMap,ns=new WeakMap,qn=new WeakMap,rs=new WeakMap,Pi=new WeakMap;class jE{constructor(e,n=3e3){this.create=r=>new WE(r,this),this.id=Symbol("Timer-".concat(e)),this.name=e,this.timeout=n}}const Nn=(t,e=3e3)=>new jE(t,e);var Ly=t=>{throw TypeError(t)},zy=(t,e,n)=>e.has(t)||Ly("Cannot "+n),ve=(t,e,n)=>(zy(t,e,"read from private field"),n?n.call(t):e.get(t)),tt=(t,e,n)=>e.has(t)?Ly("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Ve=(t,e,n,r)=>(zy(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),yn,js,Ra,Ia,Pa,Ks,Ys,In,Gs,La,za,Js,Ba,Xs,Fa,Va,zo,Hr,Ha,Zs;class By{}class Fy{constructor(){this.elements=[],this.size=()=>this.elements.length,this.top=()=>this.elements.at(-1),this.push=e=>{var n;(n=this.top())==null||n.push(e)},this.open=e=>{this.elements.push(e)},this.close=()=>{const e=this.elements.pop();if(!e)throw Iy();return e}}}class _f extends By{constructor(e,n,r){super(),this.type=e,this.content=n,this.attrs=r}push(e,...n){this.content.push(e,...n)}pop(){return this.content.pop()}static create(e,n,r){return new _f(e,n,r)}}const yd=class extends Fy{constructor(e){super(),tt(this,yn),tt(this,js),tt(this,Ra),tt(this,Ia),tt(this,Pa),tt(this,Ks),tt(this,Ys),Ve(this,yn,Se.none),Ve(this,js,n=>n.isText),Ve(this,Ra,(n,r)=>{if(ve(this,js).call(this,n)&&ve(this,js).call(this,r)&&Se.sameSet(n.marks,r.marks))return this.schema.text(n.text+r.text,n.marks)}),Ve(this,Ia,n=>{const r=Object.values({...this.schema.nodes,...this.schema.marks}).find(o=>o.spec.parseMarkdown.match(n));if(!r)throw LE(n);return r}),Ve(this,Pa,n=>{const r=ve(this,Ia).call(this,n);r.spec.parseMarkdown.runner(this,n,r)}),this.injectRoot=(n,r,o)=>(this.openNode(r,o),this.next(n.children),this),this.openNode=(n,r)=>(this.open(_f.create(n,[],r)),this),Ve(this,Ks,()=>{Ve(this,yn,Se.none);const n=this.close();return ve(this,Ys).call(this,n.type,n.attrs,n.content)}),this.closeNode=()=>{try{ve(this,Ks).call(this)}catch(n){console.error(n)}return this},Ve(this,Ys,(n,r,o)=>{const s=n.createAndFill(r,o,ve(this,yn));if(!s)throw PE(n,r,o);return this.push(s),s}),this.addNode=(n,r,o)=>{try{ve(this,Ys).call(this,n,r,o)}catch(s){console.error(s)}return this},this.openMark=(n,r)=>{const o=n.create(r);return Ve(this,yn,o.addToSet(ve(this,yn))),this},this.closeMark=n=>(Ve(this,yn,n.removeFromSet(ve(this,yn))),this),this.addText=n=>{try{const r=this.top();if(!r)throw Iy();const o=r.pop(),s=this.schema.text(n,ve(this,yn));if(!o)return r.push(s),this;const i=ve(this,Ra).call(this,o,s);return i?(r.push(i),this):(r.push(o,s),this)}catch(r){return console.error(r),this}},this.build=()=>{let n;do n=ve(this,Ks).call(this);while(this.size());return n},this.next=(n=[])=>([n].flat().forEach(r=>ve(this,Pa).call(this,r)),this),this.toDoc=()=>this.build(),this.run=(n,r)=>{const o=n.runSync(n.parse(r),r);return this.next(o),this},this.schema=e}};yn=new WeakMap;js=new WeakMap;Ra=new WeakMap;Ia=new WeakMap;Pa=new WeakMap;Ks=new WeakMap;Ys=new WeakMap;yd.create=(t,e)=>{const n=new yd(t);return r=>(n.run(e,r),n.toDoc())};let KE=yd;const bd=class extends By{constructor(e,n,r,o={}){super(),this.type=e,this.children=n,this.value=r,this.props=o,this.push=(s,...i)=>{this.children||(this.children=[]),this.children.push(s,...i)},this.pop=()=>{var s;return(s=this.children)==null?void 0:s.pop()}}};bd.create=(t,e,n,r={})=>new bd(t,e,n,r);let Gm=bd;const YE=t=>Object.prototype.hasOwnProperty.call(t,"size"),wd=class extends Fy{constructor(e){super(),tt(this,In),tt(this,Gs),tt(this,La),tt(this,za),tt(this,Js),tt(this,Ba),tt(this,Xs),tt(this,Fa),tt(this,Va),tt(this,zo),tt(this,Hr),tt(this,Ha),tt(this,Zs),Ve(this,In,Se.none),Ve(this,Gs,n=>{const r=Object.values({...this.schema.nodes,...this.schema.marks}).find(o=>o.spec.toMarkdown.match(n));if(!r)throw zE(n.type);return r}),Ve(this,La,n=>ve(this,Gs).call(this,n).spec.toMarkdown.runner(this,n)),Ve(this,za,(n,r)=>ve(this,Gs).call(this,n).spec.toMarkdown.runner(this,n,r)),Ve(this,Js,n=>{const{marks:r}=n,o=a=>{var l;return(l=a.type.spec.priority)!=null?l:50};[...r].sort((a,l)=>o(a)-o(l)).every(a=>!ve(this,za).call(this,a,n))&&ve(this,La).call(this,n),r.forEach(a=>ve(this,Zs).call(this,a))}),Ve(this,Ba,(n,r)=>{var l;if(n.type===r||((l=n.children)==null?void 0:l.length)!==1)return n;const o=c=>{var d;if(c.type===r)return c;if(((d=c.children)==null?void 0:d.length)!==1)return null;const[u]=c.children;return u?o(u):null},s=o(n);if(!s)return n;const i=s.children?[...s.children]:void 0,a={...n,children:i};return a.children=i,s.children=[a],s}),Ve(this,Xs,n=>{const{children:r}=n;return r&&(n.children=r.reduce((o,s,i)=>{if(i===0)return[s];const a=o.at(-1);if(a&&a.isMark&&s.isMark){s=ve(this,Ba).call(this,s,a.type);const{children:l,...c}=s,{children:u,...d}=a;if(s.type===a.type&&l&&u&&JSON.stringify(c)===JSON.stringify(d)){const f={...d,children:[...u,...l]};return o.slice(0,-1).concat(ve(this,Xs).call(this,f))}}return o.concat(s)},[])),n}),Ve(this,Fa,n=>{const r={...n.props,type:n.type};return n.children&&(r.children=n.children),n.value&&(r.value=n.value),r}),this.openNode=(n,r,o)=>(this.open(Gm.create(n,void 0,r,o)),this),Ve(this,Va,(n,r)=>{let o="",s="";const i=n.children;let a=-1,l=-1;const c=d=>{d&&d.forEach((f,p)=>{f.type==="text"&&f.value&&(a<0&&(a=p),l=p)})};if(i){c(i);const d=i==null?void 0:i[l],f=i==null?void 0:i[a];if(d&&d.value.endsWith(" ")){const p=d.value,h=p.trimEnd();s=p.slice(h.length),d.value=h}if(f&&f.value.startsWith(" ")){const p=f.value,h=p.trimStart();o=p.slice(0,p.length-h.length),f.value=h}}o.length&&ve(this,Hr).call(this,"text",void 0,o);const u=r();return s.length&&ve(this,Hr).call(this,"text",void 0,s),u}),Ve(this,zo,(n=!1)=>{const r=this.close(),o=()=>ve(this,Hr).call(this,r.type,r.children,r.value,r.props);return n?ve(this,Va).call(this,r,o):o()}),this.closeNode=()=>(ve(this,zo).call(this),this),Ve(this,Hr,(n,r,o,s)=>{const i=Gm.create(n,r,o,s),a=ve(this,Xs).call(this,ve(this,Fa).call(this,i));return this.push(a),a}),this.addNode=(n,r,o,s)=>(ve(this,Hr).call(this,n,r,o,s),this),Ve(this,Ha,(n,r,o,s)=>n.isInSet(ve(this,In))?this:(Ve(this,In,n.addToSet(ve(this,In))),this.openNode(r,o,{...s,isMark:!0}))),Ve(this,Zs,n=>{n.isInSet(ve(this,In))&&(Ve(this,In,n.type.removeFromSet(ve(this,In))),ve(this,zo).call(this,!0))}),this.withMark=(n,r,o,s)=>(ve(this,Ha).call(this,n,r,o,s),this),this.closeMark=n=>(ve(this,Zs).call(this,n),this),this.build=()=>{let n=null;do n=ve(this,zo).call(this);while(this.size());return n},this.next=n=>YE(n)?(n.forEach(r=>{ve(this,Js).call(this,r)}),this):(ve(this,Js).call(this,n),this),this.toString=n=>n.stringify(this.build()),this.run=n=>(this.next(n),this),this.schema=e}};In=new WeakMap;Gs=new WeakMap;La=new WeakMap;za=new WeakMap;Js=new WeakMap;Ba=new WeakMap;Xs=new WeakMap;Fa=new WeakMap;Va=new WeakMap;zo=new WeakMap;Hr=new WeakMap;Ha=new WeakMap;Zs=new WeakMap;wd.create=(t,e)=>{const n=new wd(t);return r=>(n.run(r),n.toString(e))};let GE=wd;const Tf=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function Vy(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const Hy=(t,e,n)=>{let r=Vy(t,n);if(!r)return!1;let o=$f(r);if(!o){let i=r.blockRange(),a=i&&nc(i);return a==null?!1:(e&&e(t.tr.lift(i,a).scrollIntoView()),!0)}let s=o.nodeBefore;if(Wy(t,o,e,-1))return!0;if(r.parent.content.size==0&&(Cs(s,"end")||fe.isSelectable(s)))for(let i=r.depth;;i--){let a=oc(t.doc,r.before(i),r.after(i),J.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=t.tr.step(a);l.setSelection(Cs(s,"end")?pe.findFrom(l.doc.resolve(l.mapping.map(o.pos,-1)),-1):fe.create(l.doc,o.pos-s.nodeSize)),e(l.scrollIntoView())}return!0}if(i==1||r.node(i-1).childCount>1)break}return s.isAtom&&o.depth==r.depth-1?(e&&e(t.tr.delete(o.pos-s.nodeSize,o.pos).scrollIntoView()),!0):!1},JE=(t,e,n)=>{let r=Vy(t,n);if(!r)return!1;let o=$f(r);return o?XE(t,o,e):!1};function XE(t,e,n){let r=e.nodeBefore,o=r,s=e.pos-1;for(;!o.isTextblock;s--){if(o.type.spec.isolating)return!1;let u=o.lastChild;if(!u)return!1;o=u}let i=e.nodeAfter,a=i,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=oc(t.doc,s,l,J.empty);if(!c||c.from!=s||c instanceof ft&&c.slice.size>=l-s)return!1;if(n){let u=t.tr.step(c);u.setSelection(he.create(u.doc,s)),n(u.scrollIntoView())}return!0}function Cs(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const qy=(t,e,n)=>{let{$head:r,empty:o}=t.selection,s=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;s=$f(r)}let i=s&&s.nodeBefore;return!i||!fe.isSelectable(i)?!1:(e&&e(t.tr.setSelection(fe.create(t.doc,s.pos-i.nodeSize)).scrollIntoView()),!0)};function $f(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function ZE(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const QE=(t,e,n)=>{let r=ZE(t,n);if(!r)return!1;let o=Uy(r);if(!o)return!1;let s=o.nodeAfter;if(Wy(t,o,e,1))return!0;if(r.parent.content.size==0&&(Cs(s,"start")||fe.isSelectable(s))){let i=oc(t.doc,r.before(),r.after(),J.empty);if(i&&i.slice.size<i.to-i.from){if(e){let a=t.tr.step(i);a.setSelection(Cs(s,"start")?pe.findFrom(a.doc.resolve(a.mapping.map(o.pos)),1):fe.create(a.doc,a.mapping.map(o.pos))),e(a.scrollIntoView())}return!0}}return s.isAtom&&o.depth==r.depth-1?(e&&e(t.tr.delete(o.pos,o.pos+s.nodeSize).scrollIntoView()),!0):!1},eN=(t,e,n)=>{let{$head:r,empty:o}=t.selection,s=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;s=Uy(r)}let i=s&&s.nodeAfter;return!i||!fe.isSelectable(i)?!1:(e&&e(t.tr.setSelection(fe.create(t.doc,s.pos)).scrollIntoView()),!0)};function Uy(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const tN=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText("\n").scrollIntoView()),!0)};function Of(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const nN=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let o=n.node(-1),s=n.indexAfter(-1),i=Of(o.contentMatchAt(s));if(!i||!o.canReplaceWith(s,s,i))return!1;if(e){let a=n.after(),l=t.tr.replaceWith(a,a,i.createAndFill());l.setSelection(pe.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},rN=(t,e)=>{let n=t.selection,{$from:r,$to:o}=n;if(n instanceof Wt||r.parent.inlineContent||o.parent.inlineContent)return!1;let s=Of(o.parent.contentMatchAt(o.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let i=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,a=t.tr.insert(i,s.createAndFill());a.setSelection(he.create(a.doc,i+1)),e(a.scrollIntoView())}return!0},oN=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let s=n.before();if(si(t.doc,s))return e&&e(t.tr.split(s).scrollIntoView()),!0}let r=n.blockRange(),o=r&&nc(r);return o==null?!1:(e&&e(t.tr.lift(r,o).scrollIntoView()),!0)};function sN(t){return(e,n)=>{let{$from:r,$to:o}=e.selection;if(e.selection instanceof fe&&e.selection.node.isBlock)return!r.parentOffset||!si(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let s=[],i,a,l=!1,c=!1;for(let p=r.depth;;p--)if(r.node(p).isBlock){l=r.end(p)==r.pos+(r.depth-p),c=r.start(p)==r.pos-(r.depth-p),a=Of(r.node(p-1).contentMatchAt(r.indexAfter(p-1)));let v=t&&t(o.parent,l,r);s.unshift(v||(l&&a?{type:a}:null)),i=p;break}else{if(p==1)return!1;s.unshift(null)}let u=e.tr;(e.selection instanceof he||e.selection instanceof Wt)&&u.deleteSelection();let d=u.mapping.map(r.pos),f=si(u.doc,d,s.length,s);if(f||(s[0]=a?{type:a}:null,f=si(u.doc,d,s.length,s)),!f)return!1;if(u.split(d,s.length,s),!l&&c&&r.node(i).type!=a){let p=u.mapping.map(r.before(i)),h=u.doc.resolve(p);a&&r.node(i-1).canReplaceWith(h.index(),h.index()+1,a)&&u.setNodeMarkup(u.mapping.map(r.before(i)),a)}return n&&n(u.scrollIntoView()),!0}}const iN=sN(),aN=(t,e)=>(e&&e(t.tr.setSelection(new Wt(t.doc))),!0);function lN(t,e,n){let r=e.nodeBefore,o=e.nodeAfter,s=e.index();return!r||!o||!r.type.compatibleContent(o.type)?!1:!r.content.size&&e.parent.canReplace(s-1,s)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(o.isTextblock||rc(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function Wy(t,e,n,r){let o=e.nodeBefore,s=e.nodeAfter,i,a,l=o.type.spec.isolating||s.type.spec.isolating;if(!l&&lN(t,e,n))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(i=(a=o.contentMatchAt(o.childCount)).findWrapping(s.type))&&a.matchType(i[0]||s.type).validEnd){if(n){let p=e.pos+s.nodeSize,h=V.empty;for(let w=i.length-1;w>=0;w--)h=V.from(i[w].create(null,h));h=V.from(o.copy(h));let v=t.tr.step(new St(e.pos-1,p,e.pos,p,new J(h,1,0),i.length,!0)),y=v.doc.resolve(p+2*i.length);y.nodeAfter&&y.nodeAfter.type==o.type&&rc(v.doc,y.pos)&&v.join(y.pos),n(v.scrollIntoView())}return!0}let u=s.type.spec.isolating||r>0&&l?null:pe.findFrom(e,1),d=u&&u.$from.blockRange(u.$to),f=d&&nc(d);if(f!=null&&f>=e.depth)return n&&n(t.tr.lift(d,f).scrollIntoView()),!0;if(c&&Cs(s,"start",!0)&&Cs(o,"end")){let p=o,h=[];for(;h.push(p),!p.isTextblock;)p=p.lastChild;let v=s,y=1;for(;!v.isTextblock;v=v.firstChild)y++;if(p.canReplace(p.childCount,p.childCount,v.content)){if(n){let w=V.empty;for(let $=h.length-1;$>=0;$--)w=V.from(h[$].copy(w));let x=t.tr.step(new St(e.pos-h.length,e.pos+s.nodeSize,e.pos+y,e.pos+s.nodeSize-y,new J(w,h.length,0),0,!0));n(x.scrollIntoView())}return!0}}return!1}function jy(t){return function(e,n){let r=e.selection,o=t<0?r.$from:r.$to,s=o.depth;for(;o.node(s).isInline;){if(!s)return!1;s--}return o.node(s).isTextblock?(n&&n(e.tr.setSelection(he.create(e.doc,t<0?o.start(s):o.end(s)))),!0):!1}}const cN=jy(-1),uN=jy(1);function Mf(t,e=null){return function(n,r){let{$from:o,$to:s}=n.selection,i=o.blockRange(s),a=i&&hf(i,t,e);return a?(r&&r(n.tr.wrap(i,a).scrollIntoView()),!0):!1}}function $i(t,e=null){return function(n,r){let o=!1;for(let s=0;s<n.selection.ranges.length&&!o;s++){let{$from:{pos:i},$to:{pos:a}}=n.selection.ranges[s];n.doc.nodesBetween(i,a,(l,c)=>{if(o)return!1;if(!(!l.isTextblock||l.hasMarkup(t,e)))if(l.type==t)o=!0;else{let u=n.doc.resolve(c),d=u.index();o=u.parent.canReplaceWith(d,d+1,t)}})}if(!o)return!1;if(r){let s=n.tr;for(let i=0;i<n.selection.ranges.length;i++){let{$from:{pos:a},$to:{pos:l}}=n.selection.ranges[i];s.setBlockType(a,l,t,e)}r(s.scrollIntoView())}return!0}}function dN(t,e,n,r){for(let o=0;o<e.length;o++){let{$from:s,$to:i}=e[o],a=s.depth==0?t.inlineContent&&t.type.allowsMarkType(n):!1;if(t.nodesBetween(s.pos,i.pos,(l,c)=>{if(a||!r&&l.isAtom&&l.isInline&&c>=s.pos&&c+l.nodeSize<=i.pos)return!1;a=l.inlineContent&&l.type.allowsMarkType(n)}),a)return!0}return!1}function fN(t){let e=[];for(let n=0;n<t.length;n++){let{$from:r,$to:o}=t[n];r.doc.nodesBetween(r.pos,o.pos,(s,i)=>{if(s.isAtom&&s.content.size&&s.isInline&&i>=r.pos&&i+s.nodeSize<=o.pos)return i+1>r.pos&&e.push(new wl(r,r.doc.resolve(i+1))),r=r.doc.resolve(i+1+s.content.size),!1}),r.pos<o.pos&&e.push(new wl(r,o))}return e}function fc(t,e=null,n){let r=(n&&n.removeWhenPresent)!==!1,o=(n&&n.enterInlineAtoms)!==!1,s=!(n&&n.includeWhitespace);return function(i,a){let{empty:l,$cursor:c,ranges:u}=i.selection;if(l&&!c||!dN(i.doc,u,t,o))return!1;if(a)if(c)t.isInSet(i.storedMarks||c.marks())?a(i.tr.removeStoredMark(t)):a(i.tr.addStoredMark(t.create(e)));else{let d,f=i.tr;o||(u=fN(u)),r?d=!u.some(p=>i.doc.rangeHasMark(p.$from.pos,p.$to.pos,t)):d=!u.every(p=>{let h=!1;return f.doc.nodesBetween(p.$from.pos,p.$to.pos,(v,y,w)=>{if(h)return!1;h=!t.isInSet(v.marks)&&!!w&&w.type.allowsMarkType(t)&&!(v.isText&&/^\s*$/.test(v.textBetween(Math.max(0,p.$from.pos-y),Math.min(v.nodeSize,p.$to.pos-y))))}),!h});for(let p=0;p<u.length;p++){let{$from:h,$to:v}=u[p];if(!d)f.removeMark(h.pos,v.pos,t);else{let y=h.pos,w=v.pos,x=h.nodeAfter,$=v.nodeBefore,S=s&&x&&x.isText?/^\s*/.exec(x.text)[0].length:0,_=s&&$&&$.isText?/\s*$/.exec($.text)[0].length:0;y+S<w&&(y+=S,w-=_),f.addMark(y,w,t.create(e))}}a(f.scrollIntoView())}return!0}}function Es(...t){return function(e,n,r){for(let o=0;o<t.length;o++)if(t[o](e,n,r))return!0;return!1}}let iu=Es(Tf,Hy,qy),Jm=Es(Tf,QE,eN);const Bn={Enter:Es(tN,rN,oN,iN),"Mod-Enter":nN,Backspace:iu,"Mod-Backspace":iu,"Shift-Backspace":iu,Delete:Jm,"Mod-Delete":Jm,"Mod-a":aN},Ky={"Ctrl-h":Bn.Backspace,"Alt-Backspace":Bn["Mod-Backspace"],"Ctrl-d":Bn.Delete,"Ctrl-Alt-Backspace":Bn["Mod-Delete"],"Alt-Delete":Bn["Mod-Delete"],"Alt-d":Bn["Mod-Delete"],"Ctrl-a":cN,"Ctrl-e":uN};for(let t in Bn)Ky[t]=Bn[t];const hN=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1,pN=hN?Ky:Bn;class Yt{constructor(e,n,r={}){this.match=e,this.match=e,this.handler=typeof n=="string"?mN(n):n,this.undoable=r.undoable!==!1,this.inCode=r.inCode||!1,this.inCodeMark=r.inCodeMark!==!1}}function mN(t){return function(e,n,r,o){let s=t;if(n[1]){let i=n[0].lastIndexOf(n[1]);s+=n[0].slice(i+n[1].length),r+=i;let a=r-o;a>0&&(s=n[0].slice(i-a,i)+s,r=o)}return e.tr.insertText(s,r,o)}}const gN=(t,e)=>{let n=t.plugins;for(let r=0;r<n.length;r++){let o=n[r],s;if(o.spec.isInputRules&&(s=o.getState(t))){if(e){let i=t.tr,a=s.transform;for(let l=a.steps.length-1;l>=0;l--)i.step(a.steps[l].invert(a.docs[l]));if(s.text){let l=i.doc.resolve(s.from).marks();i.replaceWith(s.from,s.to,t.schema.text(s.text,l))}else i.delete(s.from,s.to);e(i)}return!0}}return!1};new Yt(/--$/,"",{inCodeMark:!1});new Yt(/\.\.\.$/,"",{inCodeMark:!1});new Yt(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"",{inCodeMark:!1});new Yt(/"$/,"",{inCodeMark:!1});new Yt(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"",{inCodeMark:!1});new Yt(/'$/,"",{inCodeMark:!1});function Ef(t,e,n=null,r){return new Yt(t,(o,s,i,a)=>{let l=n instanceof Function?n(s):n,c=o.tr.delete(i,a),u=c.doc.resolve(i),d=u.blockRange(),f=d&&hf(d,e,l);if(!f)return null;c.wrap(d,f);let p=c.doc.resolve(i-1).nodeBefore;return p&&p.type==e&&rc(c.doc,i-1)&&(!r||r(s,p))&&c.join(i-1),c})}function Yy(t,e,n=null){return new Yt(t,(r,o,s,i)=>{let a=r.doc.resolve(s),l=n instanceof Function?n(o):n;return a.node(-1).canReplaceWith(a.index(-1),a.indexAfter(-1),e)?r.tr.delete(s,i).setBlockType(s,s,e,l):null})}const Dr=typeof navigator<"u"?navigator:null,Xm=typeof document<"u"?document:null,To=Dr&&Dr.userAgent||"",kd=/Edge\/(\d+)/.exec(To),Gy=/MSIE \d/.exec(To),Cd=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(To),Nf=!!(Gy||Cd||kd);Gy?document.documentMode:Cd?+Cd[1]:kd&&+kd[1];const vN=!Nf&&/gecko\/(\d+)/i.test(To);vN&&+(/Firefox\/(\d+)/.exec(To)||[0,0])[1];const Zm=!Nf&&/Chrome\/(\d+)/.exec(To);Zm&&+Zm[1];const yN=!Nf&&!!Dr&&/Apple Computer/.test(Dr.vendor),bN=yN&&(/Mobile\/\w+/.test(To)||!!Dr&&Dr.maxTouchPoints>2);bN||Dr&&/Mac/.test(Dr.platform);const wN=!!Xm&&"webkitFontSmoothing"in Xm.documentElement.style;wN&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];function au(t,e,n,r,o,s){if(t.composing)return!1;const i=t.state,a=i.doc.resolve(e);if(a.parent.type.spec.code)return!1;const l=a.parent.textBetween(Math.max(0,a.parentOffset-500),a.parentOffset,void 0,"")+r;for(let c of o){const u=c,d=u.match.exec(l),f=d&&d[0]&&u.handler(i,d,e-(d[0].length-r.length),n);if(f)return u.undoable!==!1&&f.setMeta(s,{transform:f,from:e,to:n,text:r}),t.dispatch(f),!0}return!1}const kN=new mt("MILKDOWN_CUSTOM_INPUTRULES");function CN({rules:t}){const e=new wt({key:kN,isInputRules:!0,state:{init(){return null},apply(n,r){const o=n.getMeta(this);return o||(n.selectionSet||n.docChanged?null:r)}},props:{handleTextInput(n,r,o,s){return au(n,r,o,s,t,e)},handleDOMEvents:{compositionend:n=>(setTimeout(()=>{const{$cursor:r}=n.state.selection;r&&au(n,r.pos,r.pos,"",t,e)}),!1)},handleKeyDown(n,r){if(r.key!=="Enter")return!1;const{$cursor:o}=n.state.selection;return o?au(n,o.pos,o.pos,"\n",t,e):!1}}});return e}function ta(t,e,n={}){return new Yt(t,(r,o,s,i)=>{var a,l,c,u;const{tr:d}=r,f=o.length;let p=o[f-1],h=o[0],v=[],y=i;const w={group:p,fullMatch:h,start:s,end:i},x=(a=n.updateCaptured)==null?void 0:a.call(n,w);if(Object.assign(w,x),{group:p,fullMatch:h,start:s,end:i}=w,h===null||(p==null?void 0:p.trim())==="")return null;if(p){const $=h.search(/\S/),S=s+h.indexOf(p),_=S+p.length;v=(l=d.storedMarks)!=null?l:[],_<i&&d.delete(_,i),S>s&&d.delete(s+$,S),y=s+$+p.length;const E=(c=n.getAttr)==null?void 0:c.call(n,o);d.addMark(s,y,e.create(E)),d.setStoredMarks(v),(u=n.beforeDispatch)==null||u.call(n,{match:o,start:s,end:i,tr:d})}return d})}var xN=Object.defineProperty,SN=Object.defineProperties,_N=Object.getOwnPropertyDescriptors,Qm=Object.getOwnPropertySymbols,TN=Object.prototype.hasOwnProperty,$N=Object.prototype.propertyIsEnumerable,eg=(t,e,n)=>e in t?xN(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ON=(t,e)=>{for(var n in e||(e={}))TN.call(e,n)&&eg(t,n,e[n]);if(Qm)for(var n of Qm(e))$N.call(e,n)&&eg(t,n,e[n]);return t},MN=(t,e)=>SN(t,_N(e));function tg(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function Df(t,e,n){const o=t.state.doc.content.size,s=tg(e,0,o),i=tg(n,0,o),a=t.coordsAtPos(s),l=t.coordsAtPos(i,-1),c=Math.min(a.top,l.top),u=Math.max(a.bottom,l.bottom),d=Math.min(a.left,l.left),f=Math.max(a.right,l.right),p=f-d,h=u-c,w={top:c,bottom:u,left:d,right:f,width:p,height:h,x:d,y:c};return MN(ON({},w),{toJSON:()=>w})}function Jy(t){return Object.assign(Object.create(t),t).setTime(Date.now())}function EN(t,e){return Array.isArray(t)&&t.includes(e.type)||e.type===t}function NN(t){return e=>{for(let n=e.depth;n>0;n-=1){const r=e.node(n);if(t(r)){const o=e.before(n),s=e.after(n);return{from:o,to:s,node:r}}}}}function DN(t,e){return NN(n=>n.type===e)(t)}function AN(t){return e=>{for(let n=e.depth;n>0;n--){const r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}}}function RN(t,e){if(!(t instanceof fe))return;const{node:n,$from:r}=t;if(EN(e,n))return{node:n,pos:r.pos,start:r.start(r.depth),depth:r.depth}}const IN=(t,e)=>{const{selection:n,doc:r}=t;if(n instanceof fe)return{hasNode:n.node.type===e,pos:n.from,target:n.node};const{from:o,to:s}=n;let i=!1,a=-1,l=null;return r.nodesBetween(o,s,(c,u)=>l?!1:c.type===e?(i=!0,a=u,l=c,!1):!0),{hasNode:i,pos:a,target:l}};var Ar={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Tl={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},PN=typeof navigator<"u"&&/Mac/.test(navigator.platform),LN=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var yt=0;yt<10;yt++)Ar[48+yt]=Ar[96+yt]=String(yt);for(var yt=1;yt<=24;yt++)Ar[yt+111]="F"+yt;for(var yt=65;yt<=90;yt++)Ar[yt]=String.fromCharCode(yt+32),Tl[yt]=String.fromCharCode(yt);for(var lu in Ar)Tl.hasOwnProperty(lu)||(Tl[lu]=Ar[lu]);function zN(t){var e=PN&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||LN&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Tl:Ar)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const BN=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),FN=typeof navigator<"u"&&/Win/.test(navigator.platform);function VN(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,o,s,i;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))i=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))o=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))BN?i=!0:o=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(n="Alt-"+n),o&&(n="Ctrl-"+n),i&&(n="Meta-"+n),s&&(n="Shift-"+n),n}function HN(t){let e=Object.create(null);for(let n in t)e[VN(n)]=t[n];return e}function cu(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function qN(t){return new wt({props:{handleKeyDown:Xy(t)}})}function Xy(t){let e=HN(t);return function(n,r){let o=zN(r),s,i=e[cu(o,r)];if(i&&i(n.state,n.dispatch,n))return!0;if(o.length==1&&o!=" "){if(r.shiftKey){let a=e[cu(o,r,!1)];if(a&&a(n.state,n.dispatch,n))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(FN&&r.ctrlKey&&r.altKey)&&(s=Ar[r.keyCode])&&s!=o){let a=e[cu(s,r)];if(a&&a(n.state,n.dispatch,n))return!0}}return!1}}function er(t,e){return t.meta={package:"@milkdown/core",group:"System",...e},t}const Zy={text:(t,e,n,r)=>{const o=t.value;return/^[^*_\\]*\s+$/.test(o)?o:n.safe(o,{...r,encode:[]})},strong:(t,e,n,r)=>{const o=t.marker||n.options.strong||"*",s=n.enter("strong"),i=n.createTracker(r);let a=i.move(o+o);return a+=i.move(n.containerPhrasing(t,{before:a,after:o,...i.current()})),a+=i.move(o+o),s(),a},emphasis:(t,e,n,r)=>{const o=t.marker||n.options.emphasis||"*",s=n.enter("emphasis"),i=n.createTracker(r);let a=i.move(o);return a+=i.move(n.containerPhrasing(t,{before:a,after:o,...i.current()})),a+=i.move(o),s(),a}},Xn=we({},"editorView"),Qs=we({},"editorState"),uu=we([],"initTimer"),ng=we({},"editor"),Oi=we([],"inputRules"),Rr=we([],"prosePlugins"),Mi=we([],"remarkPlugins"),xd=we([],"nodeView"),Sd=we([],"markView"),io=we(Mu().use(Eu).use(Nu),"remark"),li=we({handlers:Zy,encode:[]},"remarkStringifyOptions"),qa=Nn("ConfigReady");function UN(t){const e=n=>(n.record(qa),async()=>(await t(n),n.done(qa),()=>{n.clearTimer(qa)}));return er(e,{displayName:"Config"}),e}const ao=Nn("InitReady");function WN(t){const e=n=>(n.inject(ng,t).inject(Rr,[]).inject(Mi,[]).inject(Oi,[]).inject(xd,[]).inject(Sd,[]).inject(li,{handlers:Zy,encode:[]}).inject(io,Mu().use(Eu).use(Nu)).inject(uu,[qa]).record(ao),async()=>{await n.waitTimers(uu);const r=n.get(li);return n.set(io,Mu().use(Eu).use(Nu,r)),n.done(ao),()=>{n.remove(ng).remove(Rr).remove(Mi).remove(Oi).remove(xd).remove(Sd).remove(li).remove(io).remove(uu).clearTimer(ao)}});return er(e,{displayName:"Init"}),e}const At=Nn("SchemaReady"),du=we([],"schemaTimer"),Or=we({},"schema"),ci=we([],"nodes"),ui=we([],"marks");function rg(t){var e;return{...t,parseDOM:(e=t.parseDOM)==null?void 0:e.map(n=>({priority:t.priority,...n}))}}const Qy=t=>(t.inject(Or,{}).inject(ci,[]).inject(ui,[]).inject(du,[ao]).record(At),async()=>{await t.waitTimers(du);const e=t.get(io),r=t.get(Mi).reduce((a,l)=>a.use(l.plugin,l.options),e);t.set(io,r);const o=Object.fromEntries(t.get(ci).map(([a,l])=>[a,rg(l)])),s=Object.fromEntries(t.get(ui).map(([a,l])=>[a,rg(l)])),i=new rM({nodes:o,marks:s});return t.set(Or,i),t.done(At),()=>{t.remove(Or).remove(ci).remove(ui).remove(du).clearTimer(At)}});er(Qy,{displayName:"Schema"});var Jr,Xt;class e0{constructor(){ie(this,Jr,void 0);ie(this,Xt,void 0);G(this,Jr,new Py),G(this,Xt,null),this.setCtx=e=>{G(this,Xt,e)},this.chain=()=>{if(A(this,Xt)==null)throw su();const e=A(this,Xt),n=[],r=this.get.bind(this),o={run:()=>{const i=Es(...n),a=e.get(Xn);return i(a.state,a.dispatch,a)},inline:i=>(n.push(i),o),pipe:s.bind(this)};function s(i,a){const l=r(i);return n.push(l(a)),o}return o}}get ctx(){return A(this,Xt)}create(e,n){const r=e.create(A(this,Jr).sliceMap);return r.set(n),r}get(e){return A(this,Jr).get(e).get()}remove(e){return A(this,Jr).remove(e)}call(e,n){if(A(this,Xt)==null)throw su();const o=this.get(e)(n),s=A(this,Xt).get(Xn);return o(s.state,s.dispatch,s)}inline(e){if(A(this,Xt)==null)throw su();const n=A(this,Xt).get(Xn);return e(n.state,n.dispatch,n)}}Jr=new WeakMap,Xt=new WeakMap;function jN(t="cmdKey"){return we(()=>()=>!1,t)}const me=we(new e0,"commands"),fu=we([At],"commandsTimer"),di=Nn("CommandsReady"),t0=t=>{const e=new e0;return e.setCtx(t),t.inject(me,e).inject(fu,[At]).record(di),async()=>(await t.waitTimers(fu),t.done(di),()=>{t.remove(me).remove(fu).clearTimer(di)})};er(t0,{displayName:"Commands"});function KN(t){const e=Es(gN,Tf,JE,qy);return t.Backspace=e,t}var Xr,Mt;class n0{constructor(){ie(this,Xr,void 0);ie(this,Mt,void 0);G(this,Xr,null),G(this,Mt,[]),this.setCtx=e=>{G(this,Xr,e)},this.add=e=>(A(this,Mt).push(e),()=>{G(this,Mt,A(this,Mt).filter(n=>n!==e))}),this.addObjectKeymap=e=>{const n=[];return Object.entries(e).forEach(([r,o])=>{if(typeof o=="function"){const s={key:r,onRun:()=>o};A(this,Mt).push(s),n.push(()=>{G(this,Mt,A(this,Mt).filter(i=>i!==s))})}else A(this,Mt).push(o),n.push(()=>{G(this,Mt,A(this,Mt).filter(s=>s!==o))})}),()=>{n.forEach(r=>r())}},this.addBaseKeymap=()=>{const e=KN(pN);return this.addObjectKeymap(e)},this.build=()=>{const e={};return A(this,Mt).forEach(r=>{e[r.key]=[...e[r.key]||[],r]}),Object.fromEntries(Object.entries(e).map(([r,o])=>{const s=o.sort((a,l)=>{var c,u;return((c=l.priority)!=null?c:50)-((u=a.priority)!=null?u:50)});return[r,(a,l,c)=>{const u=A(this,Xr);if(u==null)throw dc();const d=s.map(p=>p.onRun(u));return Es(...d)(a,l,c)}]}))}}get ctx(){return A(this,Xr)}}Xr=new WeakMap,Mt=new WeakMap;const $l=we(new n0,"keymap"),hu=we([At],"keymapTimer"),fi=Nn("KeymapReady"),YN=t=>{const e=new n0;return e.setCtx(t),t.inject($l,e).inject(hu,[At]).record(fi),async()=>(await t.waitTimers(hu),t.done(fi),()=>{t.remove($l).remove(hu).clearTimer(fi)})},Ua=Nn("ParserReady"),r0=()=>{throw dc()},Wa=we(r0,"parser"),pu=we([],"parserTimer"),o0=t=>(t.inject(Wa,r0).inject(pu,[At]).record(Ua),async()=>{await t.waitTimers(pu);const e=t.get(io),n=t.get(Or);return t.set(Wa,KE.create(n,e)),t.done(Ua),()=>{t.remove(Wa).remove(pu).clearTimer(Ua)}});er(o0,{displayName:"Parser"});const hi=Nn("SerializerReady"),mu=we([],"serializerTimer"),s0=()=>{throw dc()},ja=we(s0,"serializer"),i0=t=>(t.inject(ja,s0).inject(mu,[At]).record(hi),async()=>{await t.waitTimers(mu);const e=t.get(io),n=t.get(Or);return t.set(ja,GE.create(n,e)),t.done(hi),()=>{t.remove(ja).remove(mu).clearTimer(hi)}});er(i0,{displayName:"Serializer"});const Ka=we("","defaultValue"),gu=we(t=>t,"stateOptions"),vu=we([],"editorStateTimer"),Ya=Nn("EditorStateReady");function GN(t,e,n){if(typeof t=="string")return e(t);if(t.type==="html")return ys.fromSchema(n).parse(t.dom);if(t.type==="json")return Gn.fromJSON(n,t.value);throw AE(t)}const JN=new mt("MILKDOWN_STATE_TRACKER"),a0=t=>(t.inject(Ka,"").inject(Qs,{}).inject(gu,e=>e).inject(vu,[Ua,hi,di,fi]).record(Ya),async()=>{await t.waitTimers(vu);const e=t.get(Or),n=t.get(Wa),r=t.get(Oi),o=t.get(gu),s=t.get(Rr),i=t.get(Ka),a=GN(i,n,e),l=t.get($l),c=l.addBaseKeymap(),u=[...s,new wt({key:JN,state:{init:()=>{},apply:(p,h,v,y)=>{t.set(Qs,y)}}}),CN({rules:r}),qN(l.build())];t.set(Rr,u);const d=o({schema:e,doc:a,plugins:u}),f=qo.create(d);return t.set(Qs,f),t.done(Ya),()=>{c(),t.remove(Ka).remove(Qs).remove(gu).remove(vu).clearTimer(Ya)}});er(a0,{displayName:"EditorState"});const Ei=we([],"pasteRule"),yu=we([At],"pasteRuleTimer"),Ga=Nn("PasteRuleReady"),l0=t=>(t.inject(Ei,[]).inject(yu,[At]).record(Ga),async()=>(await t.waitTimers(yu),t.done(Ga),()=>{t.remove(Ei).remove(yu).clearTimer(Ga)}));er(l0,{displayName:"PasteRule"});const Ja=Nn("EditorViewReady"),bu=we([],"editorViewTimer"),Xa=we({},"editorViewOptions"),Za=we(null,"root"),_d=we(null,"rootDOM"),Td=we({},"rootAttrs");function XN(t,e){const n=document.createElement("div");n.className="milkdown",t.appendChild(n),e.set(_d,n);const r=e.get(Td);return Object.entries(r).forEach(([o,s])=>n.setAttribute(o,s)),n}function ZN(t){t.classList.add("editor"),t.setAttribute("role","textbox")}const QN=new mt("MILKDOWN_VIEW_CLEAR"),c0=t=>(t.inject(Za,document.body).inject(Xn,{}).inject(Xa,{}).inject(_d,null).inject(Td,{}).inject(bu,[Ya,Ga]).record(Ja),async()=>{await t.wait(ao);const e=t.get(Za)||document.body,n=typeof e=="string"?document.querySelector(e):e;t.update(Rr,l=>[new wt({key:QN,view:c=>{const u=n?XN(n,t):void 0;return(()=>{if(u&&n){const f=c.dom;n.replaceChild(u,f),u.appendChild(f)}})(),{destroy:()=>{u!=null&&u.parentNode&&(u==null||u.parentNode.replaceChild(c.dom,u)),u==null||u.remove()}}}}),...l]),await t.waitTimers(bu);const r=t.get(Qs),o=t.get(Xa),s=Object.fromEntries(t.get(xd)),i=Object.fromEntries(t.get(Sd)),a=new Ey(n,{state:r,nodeViews:s,markViews:i,transformPasted:(l,c,u)=>(t.get(Ei).sort((d,f)=>{var p,h;return((p=f.priority)!=null?p:50)-((h=d.priority)!=null?h:50)}).map(d=>d.run).forEach(d=>{l=d(l,c,u)}),l),...o});return ZN(a.dom),t.set(Xn,a),t.done(Ja),()=>{a==null||a.destroy(),t.remove(Za).remove(Xn).remove(Xa).remove(_d).remove(Td).remove(bu).clearTimer(Ja)}});er(c0,{displayName:"EditorView"});var Zr,Bt,Un,ss,Li,zi,Et,Wn,Qr,Bi,eo,is,Fi,vr,as;const Qh=class Qh{constructor(){ie(this,Zr,void 0);ie(this,Bt,void 0);ie(this,Un,void 0);ie(this,ss,void 0);ie(this,Li,void 0);ie(this,zi,void 0);ie(this,Et,void 0);ie(this,Wn,void 0);ie(this,Qr,void 0);ie(this,Bi,void 0);ie(this,eo,void 0);ie(this,is,void 0);ie(this,Fi,void 0);ie(this,vr,void 0);ie(this,as,void 0);G(this,Zr,!1),G(this,Bt,"Idle"),G(this,Un,[]),G(this,ss,()=>{}),G(this,Li,new Py),G(this,zi,new UE),G(this,Et,new Map),G(this,Wn,new Map),G(this,Qr,new vd(A(this,Li),A(this,zi))),G(this,Bi,()=>{const e=UN(async r=>{await Promise.all(A(this,Un).map(o=>Promise.resolve(o(r))))}),n=[Qy,o0,i0,t0,YN,l0,a0,c0,WN(this),e];A(this,eo).call(this,n,A(this,Wn))}),G(this,eo,(e,n)=>{e.forEach(r=>{const o=A(this,Qr).produce(A(this,Zr)?r.meta:void 0),s=r(o);n.set(r,{ctx:o,handler:s,cleanup:void 0})})}),G(this,is,(e,n=!1)=>Promise.all([e].flat().map(async r=>{const o=A(this,Et).get(r),s=o==null?void 0:o.cleanup;return n?A(this,Et).delete(r):A(this,Et).set(r,{ctx:void 0,handler:void 0,cleanup:void 0}),typeof s=="function"?s():s}))),G(this,Fi,async()=>{await Promise.all([...A(this,Wn).entries()].map(async([e,{cleanup:n}])=>typeof n=="function"?n():n)),A(this,Wn).clear()}),G(this,vr,e=>{G(this,Bt,e),A(this,ss).call(this,e)}),G(this,as,e=>[...e.entries()].map(async([n,r])=>{const{ctx:o,handler:s}=r;if(!s)return;const i=await s();e.set(n,{ctx:o,handler:s,cleanup:i})})),this.enableInspector=(e=!0)=>(G(this,Zr,e),this),this.onStatusChange=e=>(G(this,ss,e),this),this.config=e=>(A(this,Un).push(e),this),this.removeConfig=e=>(G(this,Un,A(this,Un).filter(n=>n!==e)),this),this.use=e=>{const n=[e].flat();return n.flat().forEach(r=>{A(this,Et).set(r,{ctx:void 0,handler:void 0,cleanup:void 0})}),A(this,Bt)==="Created"&&A(this,eo).call(this,n,A(this,Et)),this},this.remove=async e=>A(this,Bt)==="OnCreate"?(console.warn("[Milkdown]: You are trying to remove plugins when the editor is creating, this is not recommended, please check your code."),new Promise(n=>{setTimeout(()=>{n(this.remove(e))},50)})):(await A(this,is).call(this,[e].flat(),!0),this),this.create=async()=>A(this,Bt)==="OnCreate"?this:(A(this,Bt)==="Created"&&await this.destroy(),A(this,vr).call(this,"OnCreate"),A(this,Bi).call(this),A(this,eo).call(this,[...A(this,Et).keys()],A(this,Et)),await Promise.all([A(this,as).call(this,A(this,Wn)),A(this,as).call(this,A(this,Et))].flat()),A(this,vr).call(this,"Created"),this),this.destroy=async(e=!1)=>A(this,Bt)==="Destroyed"||A(this,Bt)==="OnDestroy"?this:A(this,Bt)==="OnCreate"?new Promise(n=>{setTimeout(()=>{n(this.destroy(e))},50)}):(e&&G(this,Un,[]),A(this,vr).call(this,"OnDestroy"),await A(this,is).call(this,[...A(this,Et).keys()],e),await A(this,Fi).call(this),A(this,vr).call(this,"Destroyed"),this),this.action=e=>e(A(this,Qr)),this.inspect=()=>A(this,Zr)?[...A(this,Wn).values(),...A(this,Et).values()].map(({ctx:e})=>{var n;return(n=e==null?void 0:e.inspector)==null?void 0:n.read()}).filter(e=>!!e):(console.warn("[Milkdown]: You are trying to collect inspection when inspector is disabled, please enable inspector by `editor.enableInspector()` first."),[])}static make(){return new Qh}get ctx(){return A(this,Qr)}get status(){return A(this,Bt)}};Zr=new WeakMap,Bt=new WeakMap,Un=new WeakMap,ss=new WeakMap,Li=new WeakMap,zi=new WeakMap,Et=new WeakMap,Wn=new WeakMap,Qr=new WeakMap,Bi=new WeakMap,eo=new WeakMap,is=new WeakMap,Fi=new WeakMap,vr=new WeakMap,as=new WeakMap;let $d=Qh;var Ol=200,pt=function(){};pt.prototype.append=function(e){return e.length?(e=pt.from(e),!this.length&&e||e.length<Ol&&this.leafAppend(e)||this.length<Ol&&e.leafPrepend(this)||this.appendInner(e)):this};pt.prototype.prepend=function(e){return e.length?pt.from(e).append(this):this};pt.prototype.appendInner=function(e){return new eD(this,e)};pt.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?pt.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};pt.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};pt.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};pt.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var o=[];return this.forEach(function(s,i){return o.push(e(s,i))},n,r),o};pt.from=function(e){return e instanceof pt?e:e&&e.length?new u0(e):pt.empty};var u0=function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(o,s){return o==0&&s==this.length?this:new e(this.values.slice(o,s))},e.prototype.getInner=function(o){return this.values[o]},e.prototype.forEachInner=function(o,s,i,a){for(var l=s;l<i;l++)if(o(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(o,s,i,a){for(var l=s-1;l>=i;l--)if(o(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(o){if(this.length+o.length<=Ol)return new e(this.values.concat(o.flatten()))},e.prototype.leafPrepend=function(o){if(this.length+o.length<=Ol)return new e(o.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(pt);pt.empty=new u0([]);var eD=function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,o,s,i){var a=this.left.length;if(o<a&&this.left.forEachInner(r,o,Math.min(s,a),i)===!1||s>a&&this.right.forEachInner(r,Math.max(o-a,0),Math.min(this.length,s)-a,i+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,o,s,i){var a=this.left.length;if(o>a&&this.right.forEachInvertedInner(r,o-a,Math.max(s,a)-a,i+a)===!1||s<a&&this.left.forEachInvertedInner(r,Math.min(o,a),s,i)===!1)return!1},e.prototype.sliceInner=function(r,o){if(r==0&&o==this.length)return this;var s=this.left.length;return o<=s?this.left.slice(r,o):r>=s?this.right.slice(r-s,o-s):this.left.slice(r,s).append(this.right.slice(0,o-s))},e.prototype.leafAppend=function(r){var o=this.right.leafAppend(r);if(o)return new e(this.left,o)},e.prototype.leafPrepend=function(r){var o=this.left.leafPrepend(r);if(o)return new e(o,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(pt);const tD=500;class dn{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let o,s;n&&(o=this.remapping(r,this.items.length),s=o.maps.length);let i=e.tr,a,l,c=[],u=[];return this.items.forEach((d,f)=>{if(!d.step){o||(o=this.remapping(r,f+1),s=o.maps.length),s--,u.push(d);return}if(o){u.push(new bn(d.map));let p=d.step.map(o.slice(s)),h;p&&i.maybeStep(p).doc&&(h=i.mapping.maps[i.mapping.maps.length-1],c.push(new bn(h,void 0,void 0,c.length+u.length))),s--,h&&o.appendMap(h,s)}else i.maybeStep(d.step);if(d.selection)return a=o?d.selection.map(o.slice(s)):d.selection,l=new dn(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:i,selection:a}}addTransform(e,n,r,o){let s=[],i=this.eventCount,a=this.items,l=!o&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let d=e.steps[u].invert(e.docs[u]),f=new bn(e.mapping.maps[u],d,n),p;(p=l&&l.merge(f))&&(f=p,u?s.pop():a=a.slice(0,a.length-1)),s.push(f),n&&(i++,n=void 0),o||(l=f)}let c=i-r.depth;return c>rD&&(a=nD(a,c),i-=c),new dn(a.append(s),i)}remapping(e,n){let r=new Ci;return this.items.forEach((o,s)=>{let i=o.mirrorOffset!=null&&s-o.mirrorOffset>=e?r.maps.length-o.mirrorOffset:void 0;r.appendMap(o.map,i)},e,n),r}addMaps(e){return this.eventCount==0?this:new dn(this.items.append(e.map(n=>new bn(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],o=Math.max(0,this.items.length-n),s=e.mapping,i=e.steps.length,a=this.eventCount;this.items.forEach(f=>{f.selection&&a--},o);let l=n;this.items.forEach(f=>{let p=s.getMirror(--l);if(p==null)return;i=Math.min(i,p);let h=s.maps[p];if(f.step){let v=e.steps[p].invert(e.docs[p]),y=f.selection&&f.selection.map(s.slice(l+1,p));y&&a++,r.push(new bn(h,v,y))}else r.push(new bn(h))},o);let c=[];for(let f=n;f<i;f++)c.push(new bn(s.maps[f]));let u=this.items.slice(0,o).append(c).append(r),d=new dn(u,a);return d.emptyItemCount()>tD&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,o=[],s=0;return this.items.forEach((i,a)=>{if(a>=e)o.push(i),i.selection&&s++;else if(i.step){let l=i.step.map(n.slice(r)),c=l&&l.getMap();if(r--,c&&n.appendMap(c,r),l){let u=i.selection&&i.selection.map(n.slice(r));u&&s++;let d=new bn(c.invert(),l,u),f,p=o.length-1;(f=o.length&&o[p].merge(d))?o[p]=f:o.push(d)}}else i.map&&r--},this.items.length,0),new dn(pt.from(o.reverse()),s)}}dn.empty=new dn(pt.empty,0);function nD(t,e){let n;return t.forEach((r,o)=>{if(r.selection&&e--==0)return n=o,!1}),t.slice(n)}class bn{constructor(e,n,r,o){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=o}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new bn(n.getMap().invert(),n,this.selection)}}}class ur{constructor(e,n,r,o,s){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=o,this.prevComposition=s}}const rD=20;function oD(t,e,n,r){let o=n.getMeta(lo),s;if(o)return o.historyState;n.getMeta(aD)&&(t=new ur(t.done,t.undone,null,0,-1));let i=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(i&&i.getMeta(lo))return i.getMeta(lo).redo?new ur(t.done.addTransform(n,void 0,r,Qa(e)),t.undone,og(n.mapping.maps),t.prevTime,t.prevComposition):new ur(t.done,t.undone.addTransform(n,void 0,r,Qa(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(i&&i.getMeta("addToHistory")===!1)){let a=n.getMeta("composition"),l=t.prevTime==0||!i&&t.prevComposition!=a&&(t.prevTime<(n.time||0)-r.newGroupDelay||!sD(n,t.prevRanges)),c=i?wu(t.prevRanges,n.mapping):og(n.mapping.maps);return new ur(t.done.addTransform(n,l?e.selection.getBookmark():void 0,r,Qa(e)),dn.empty,c,n.time,a==null?t.prevComposition:a)}else return(s=n.getMeta("rebased"))?new ur(t.done.rebased(n,s),t.undone.rebased(n,s),wu(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new ur(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),wu(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function sD(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,o)=>{for(let s=0;s<e.length;s+=2)r<=e[s+1]&&o>=e[s]&&(n=!0)}),n}function og(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,o,s,i)=>e.push(s,i));return e}function wu(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let o=e.map(t[r],1),s=e.map(t[r+1],-1);o<=s&&n.push(o,s)}return n}function iD(t,e,n){let r=Qa(e),o=lo.get(e).spec.config,s=(n?t.undone:t.done).popEvent(e,r);if(!s)return null;let i=s.selection.resolve(s.transform.doc),a=(n?t.done:t.undone).addTransform(s.transform,e.selection.getBookmark(),o,r),l=new ur(n?a:s.remaining,n?s.remaining:a,null,0,-1);return s.transform.setSelection(i).setMeta(lo,{redo:n,historyState:l})}let ku=!1,sg=null;function Qa(t){let e=t.plugins;if(sg!=e){ku=!1,sg=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){ku=!0;break}}return ku}const lo=new mt("history"),aD=new mt("closeHistory");function lD(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new wt({key:lo,state:{init(){return new ur(dn.empty,dn.empty,null,0,-1)},apply(e,n,r){return oD(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,o=r=="historyUndo"?f0:r=="historyRedo"?h0:null;return o?(n.preventDefault(),o(e.state,e.dispatch)):!1}}}})}function d0(t,e){return(n,r)=>{let o=lo.getState(n);if(!o||(t?o.undone:o.done).eventCount==0)return!1;if(r){let s=iD(o,n,t);s&&r(e?s.scrollIntoView():s)}return!0}}const f0=d0(!1,!0),h0=d0(!0,!0);let cD=t=>crypto.getRandomValues(new Uint8Array(t)),uD=(t,e,n)=>{let r=(2<<Math.log2(t.length-1))-1,o=-~(1.6*r*e/t.length);return(s=e)=>{let i="";for(;;){let a=n(o),l=o|0;for(;l--;)if(i+=t[a[l]&r]||"",i.length>=s)return i}}},dD=(t,e=21)=>uD(t,e|0,cD);dD("abcedfghicklmn",10);function de(t,e){const n=jN(t),r=o=>async()=>{r.key=n,await o.wait(di);const s=e(o);return o.get(me).create(n,s),r.run=i=>o.get(me).call(t,i),()=>{o.get(me).remove(n)}};return r}function It(t){const e=n=>async()=>{await n.wait(At);const r=t(n);return n.update(Oi,o=>[...o,r]),e.inputRule=r,()=>{n.update(Oi,o=>o.filter(s=>s!==r))}};return e}function fD(t){const e=n=>async()=>{await n.wait(At);const r=t(n);return n.update(Ei,o=>[...o,r]),e.pasteRule=r,()=>{n.update(Ei,o=>o.filter(s=>s!==r))}};return e}function hD(t,e){const n=r=>async()=>{const o=e(r);return r.update(ui,s=>[...s.filter(i=>i[0]!==t),[t,o]]),n.id=t,n.schema=o,()=>{r.update(ui,s=>s.filter(([i])=>i!==t))}};return n.type=r=>{const o=r.get(Or).marks[t];if(!o)throw FE(t);return o},n}function Af(t,e){const n=r=>async()=>{const o=e(r);return r.update(ci,s=>[...s.filter(i=>i[0]!==t),[t,o]]),n.id=t,n.schema=o,()=>{r.update(ci,s=>s.filter(([i])=>i!==t))}};return n.type=r=>{const o=r.get(Or).nodes[t];if(!o)throw BE(t);return o},n}function Gt(t){let e;const n=r=>async()=>(await r.wait(At),e=t(r),r.update(Rr,o=>[...o,e]),()=>{r.update(Rr,o=>o.filter(s=>s!==e))});return n.plugin=()=>e,n.key=()=>e.spec.key,n}function pD(t){const e=n=>async()=>{await n.wait(fi);const r=n.get($l),o=t(n),s=r.addObjectKeymap(o);return e.keymap=o,()=>{s()}};return e}function Pt(t,e){const n=we(t,e),r=o=>(o.inject(n),()=>()=>{o.remove(n)});return r.key=n,r}function lt(t,e){const n=Pt(e,t),r=Af(t,s=>s.get(n.key)(s)),o=[n,r];return o.id=r.id,o.node=r,o.type=s=>r.type(s),o.ctx=n,o.key=n.key,o.extendSchema=s=>{const i=s(e);return lt(t,i)},o}function Ns(t,e){const n=Pt(e,t),r=hD(t,s=>s.get(n.key)(s)),o=[n,r];return o.id=r.id,o.mark=r,o.type=s=>r.type(s),o.ctx=n,o.key=n.key,o.extendSchema=s=>{const i=s(e);return Ns(t,i)},o}function Lt(t,e){const n=Object.fromEntries(Object.entries(e).map(([i,{shortcuts:a,priority:l}])=>[i,{shortcuts:a,priority:l}])),r=Pt(n,"".concat(t,"Keymap")),o=pD(i=>{const a=i.get(r.key),l=Object.entries(e).flatMap(([c,{command:u}])=>{const d=a[c],f=[d.shortcuts].flat(),p=d.priority;return f.map(h=>[h,{key:h,onRun:u,priority:p}])});return Object.fromEntries(l)}),s=[r,o];return s.ctx=r,s.shortcuts=o,s.key=r.key,s.keymap=o.keymap,s}const mn=(t,e=()=>({}))=>Pt(e,"".concat(t,"Attr")),na=(t,e=()=>({}))=>Pt(e,"".concat(t,"Attr"));function $o(t,e,n){const r=Pt(n!=null?n:{},t),o=i=>async()=>{await i.wait(ao);const l={plugin:e(i),options:i.get(r.key)};return i.update(Mi,c=>[...c,l]),()=>{i.update(Mi,c=>c.filter(u=>u!==l))}},s=[r,o];return s.id=t,s.plugin=o,s.options=r,s}function mD(t,e){return n=>n.get(me).call(t,e)}function Ds(t,e){return Object.assign(t,{meta:{package:"@milkdown/plugin-history",...e}}),t}const hc=de("Undo",()=>()=>f0);Ds(hc,{displayName:"Command<undo>"});const pc=de("Redo",()=>()=>h0);Ds(pc,{displayName:"Command<redo>"});const Rf=Pt({},"historyProviderConfig");Ds(Rf,{displayName:"Ctx<historyProviderConfig>"});const p0=Gt(t=>lD(t.get(Rf.key)));Ds(p0,{displayName:"Ctx<historyProviderPlugin>"});const If=Lt("historyKeymap",{Undo:{shortcuts:"Mod-z",command:t=>{const e=t.get(me);return()=>e.call(hc.key)}},Redo:{shortcuts:["Mod-y","Shift-Mod-z"],command:t=>{const e=t.get(me);return()=>e.call(pc.key)}}});Ds(If.ctx,{displayName:"KeymapCtx<history>"});Ds(If.shortcuts,{displayName:"Keymap<history>"});const gD=[Rf,p0,If,hc,pc].flat();var vD=typeof global=="object"&&global&&global.Object===Object&&global;const yD=vD;var bD=typeof self=="object"&&self&&self.Object===Object&&self,wD=yD||bD||Function("return this")();const m0=wD;var kD=m0.Symbol;const Ml=kD;var g0=Object.prototype,CD=g0.hasOwnProperty,xD=g0.toString,Hs=Ml?Ml.toStringTag:void 0;function SD(t){var e=CD.call(t,Hs),n=t[Hs];try{t[Hs]=void 0;var r=!0}catch(s){}var o=xD.call(t);return r&&(e?t[Hs]=n:delete t[Hs]),o}var _D=Object.prototype,TD=_D.toString;function $D(t){return TD.call(t)}var OD="[object Null]",MD="[object Undefined]",ig=Ml?Ml.toStringTag:void 0;function ED(t){return t==null?t===void 0?MD:OD:ig&&ig in Object(t)?SD(t):$D(t)}function ND(t){return t!=null&&typeof t=="object"}var DD="[object Symbol]";function AD(t){return typeof t=="symbol"||ND(t)&&ED(t)==DD}var RD=/\s/;function ID(t){for(var e=t.length;e--&&RD.test(t.charAt(e)););return e}var PD=/^\s+/;function LD(t){return t&&t.slice(0,ID(t)+1).replace(PD,"")}function El(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var ag=0/0,zD=/^[-+]0x[0-9a-f]+$/i,BD=/^0b[01]+$/i,FD=/^0o[0-7]+$/i,VD=parseInt;function lg(t){if(typeof t=="number")return t;if(AD(t))return ag;if(El(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=El(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=LD(t);var n=BD.test(t);return n||FD.test(t)?VD(t.slice(2),n?2:8):zD.test(t)?ag:+t}var HD=function(){return m0.Date.now()};const Cu=HD;var qD="Expected a function",UD=Math.max,WD=Math.min;function v0(t,e,n){var r,o,s,i,a,l,c=0,u=!1,d=!1,f=!0;if(typeof t!="function")throw new TypeError(qD);e=lg(e)||0,El(n)&&(u=!!n.leading,d="maxWait"in n,s=d?UD(lg(n.maxWait)||0,e):s,f="trailing"in n?!!n.trailing:f);function p(E){var D=r,N=o;return r=o=void 0,c=E,i=t.apply(N,D),i}function h(E){return c=E,a=setTimeout(w,e),u?p(E):i}function v(E){var D=E-l,N=E-c,H=e-D;return d?WD(H,s-N):H}function y(E){var D=E-l,N=E-c;return l===void 0||D>=e||D<0||d&&N>=s}function w(){var E=Cu();if(y(E))return x(E);a=setTimeout(w,v(E))}function x(E){return a=void 0,f&&r?p(E):(r=o=void 0,i)}function $(){a!==void 0&&clearTimeout(a),c=0,r=l=o=a=void 0}function S(){return a===void 0?i:x(Cu())}function _(){var E=Cu(),D=y(E);if(r=arguments,o=this,l=E,D){if(a===void 0)return h(l);if(d)return clearTimeout(a),a=setTimeout(w,e),p(l)}return a===void 0&&(a=setTimeout(w,e)),i}return _.cancel=$,_.flush=S,_}var jD="Expected a function";function KD(t,e,n){var r=!0,o=!0;if(typeof t!="function")throw new TypeError(jD);return El(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),v0(t,e,{leading:r,maxWait:e,trailing:o})}class y0{constructor(){this.beforeMountedListeners=[],this.mountedListeners=[],this.updatedListeners=[],this.selectionUpdatedListeners=[],this.markdownUpdatedListeners=[],this.blurListeners=[],this.focusListeners=[],this.destroyListeners=[],this.beforeMount=e=>(this.beforeMountedListeners.push(e),this),this.mounted=e=>(this.mountedListeners.push(e),this),this.updated=e=>(this.updatedListeners.push(e),this)}get listeners(){return{beforeMount:this.beforeMountedListeners,mounted:this.mountedListeners,updated:this.updatedListeners,markdownUpdated:this.markdownUpdatedListeners,blur:this.blurListeners,focus:this.focusListeners,destroy:this.destroyListeners,selectionUpdated:this.selectionUpdatedListeners}}markdownUpdated(e){return this.markdownUpdatedListeners.push(e),this}blur(e){return this.blurListeners.push(e),this}focus(e){return this.focusListeners.push(e),this}destroy(e){return this.destroyListeners.push(e),this}selectionUpdated(e){return this.selectionUpdatedListeners.push(e),this}}const Nl=we(new y0,"listener"),YD=new mt("MILKDOWN_LISTENER"),b0=t=>(t.inject(Nl,new y0),async()=>{await t.wait(ao);const e=t.get(Nl),{listeners:n}=e;n.beforeMount.forEach(l=>l(t)),await t.wait(hi);const r=t.get(ja);let o=null,s=null,i=null;const a=new wt({key:YD,view:()=>({destroy:()=>{n.destroy.forEach(l=>l(t))}}),props:{handleDOMEvents:{focus:()=>(n.focus.forEach(l=>l(t)),!1),blur:()=>(n.blur.forEach(l=>l(t)),!1)}},state:{init:(l,c)=>{o=c.doc,s=r(c.doc)},apply:l=>{const c=l.selection;return(!i&&c||i&&!c.eq(i))&&(n.selectionUpdated.forEach(d=>{d(t,c,i)}),i=c),!l.docChanged||l.getMeta("addToHistory")===!1?void 0:v0(()=>{const{doc:d}=l;if(n.updated.length>0&&o&&!o.eq(d)&&n.updated.forEach(f=>{f(t,d,o)}),n.markdownUpdated.length>0&&o&&!o.eq(d)){const f=r(d);n.markdownUpdated.forEach(p=>{p(t,f,s)}),s=f}o=d},200)()}}});t.update(Rr,l=>l.concat(a)),await t.wait(Ja),n.mounted.forEach(l=>l(t))});b0.meta={package:"@milkdown/plugin-listener",displayName:"Listener"};function GD(t,e){return function(n,r){let{$from:o,$to:s,node:i}=n.selection;if(i&&i.isBlock||o.depth<2||!o.sameParent(s))return!1;let a=o.node(-1);if(a.type!=t)return!1;if(o.parent.content.size==0&&o.node(-1).childCount==o.indexAfter(-1)){if(o.depth==3||o.node(-3).type!=t||o.index(-2)!=o.node(-2).childCount-1)return!1;if(r){let d=V.empty,f=o.index(-1)?1:o.index(-2)?2:3;for(let w=o.depth-f;w>=o.depth-3;w--)d=V.from(o.node(w).copy(d));let p=o.indexAfter(-1)<o.node(-2).childCount?1:o.indexAfter(-2)<o.node(-3).childCount?2:3;d=d.append(V.from(t.createAndFill()));let h=o.before(o.depth-(f-1)),v=n.tr.replace(h,o.after(-p),new J(d,4-f,0)),y=-1;v.doc.nodesBetween(h,v.doc.content.size,(w,x)=>{if(y>-1)return!1;w.isTextblock&&w.content.size==0&&(y=x+1)}),y>-1&&v.setSelection(pe.near(v.doc.resolve(y))),r(v.scrollIntoView())}return!0}let l=s.pos==o.end()?a.contentMatchAt(0).defaultType:null,c=n.tr.delete(o.pos,s.pos),u=l?[e?{type:t,attrs:e}:null,{type:l}]:void 0;return si(c.doc,o.pos,2,u)?(r&&r(c.split(o.pos,2,u).scrollIntoView()),!0):!1}}function JD(t){return function(e,n){let{$from:r,$to:o}=e.selection,s=r.blockRange(o,i=>i.childCount>0&&i.firstChild.type==t);return s?n?r.node(s.depth-1).type==t?XD(e,n,t,s):ZD(e,n,s):!0:!1}}function XD(t,e,n,r){let o=t.tr,s=r.end,i=r.$to.end(r.depth);s<i&&(o.step(new St(s-1,i,s,i,new J(V.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Tv(o.doc.resolve(r.$from.pos),o.doc.resolve(i),r.depth));const a=nc(r);if(a==null)return!1;o.lift(r,a);let l=o.doc.resolve(o.mapping.map(s,-1)-1);return rc(o.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&o.join(l.pos),e(o.scrollIntoView()),!0}function ZD(t,e,n){let r=t.tr,o=n.parent;for(let p=n.end,h=n.endIndex-1,v=n.startIndex;h>v;h--)p-=o.child(h).nodeSize,r.delete(p-1,p+1);let s=r.doc.resolve(n.start),i=s.nodeAfter;if(r.mapping.map(n.end)!=n.start+s.nodeAfter.nodeSize)return!1;let a=n.startIndex==0,l=n.endIndex==o.childCount,c=s.node(-1),u=s.index(-1);if(!c.canReplace(u+(a?0:1),u+1,i.content.append(l?V.empty:V.from(o))))return!1;let d=s.pos,f=d+i.nodeSize;return r.step(new St(d-(a?1:0),f+(l?1:0),d+1,f-1,new J((a?V.empty:V.from(o.copy(V.empty))).append(l?V.empty:V.from(o.copy(V.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function QD(t){return function(e,n){let{$from:r,$to:o}=e.selection,s=r.blockRange(o,c=>c.childCount>0&&c.firstChild.type==t);if(!s)return!1;let i=s.startIndex;if(i==0)return!1;let a=s.parent,l=a.child(i-1);if(l.type!=t)return!1;if(n){let c=l.lastChild&&l.lastChild.type==a.type,u=V.from(c?t.create():null),d=new J(V.from(t.create(null,V.from(a.type.create(null,u)))),c?3:1,0),f=s.start,p=s.end;n(e.tr.step(new St(f-(c?3:1),p,f,p,d,1,!0)).scrollIntoView())}return!0}}function eA(t){const e=new Map;if(!t||!t.type)throw new Error("mdast-util-definitions expected node");return Ki(t,"definition",function(r){const o=cg(r.identifier);o&&!e.get(o)&&e.set(o,r)}),n;function n(r){const o=cg(r);return e.get(o)}}function cg(t){return String(t||"").toUpperCase()}function tA(){return function(t){const e=eA(t);Ki(t,function(n,r,o){if(n.type==="definition"&&o!==void 0&&typeof r=="number")return o.children.splice(r,1),[dp,r];if(n.type==="imageReference"||n.type==="linkReference"){const s=e(n.identifier);if(s&&o&&typeof r=="number")return o.children[r]=n.type==="imageReference"?{type:"image",url:s.url,title:s.title,alt:n.alt}:{type:"link",url:s.url,title:s.title,children:n.children},[dp,r]}})}}function w0(t,e){var o;if(!(e.childCount>=1&&((o=e.lastChild)==null?void 0:o.type.name)==="hardbreak")){t.next(e.content);return}const r=[];e.content.forEach((s,i,a)=>{a!==e.childCount-1&&r.push(s)}),t.next(V.fromArray(r))}function P(t,e){return Object.assign(t,{meta:{package:"@milkdown/preset-commonmark",...e}}),t}const Pf=na("emphasis");P(Pf,{displayName:"Attr<emphasis>",group:"Emphasis"});const As=Ns("emphasis",t=>({attrs:{marker:{default:t.get(li).emphasis||"*",validate:"string"}},parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:e=>e==="italic"}],toDOM:e=>["em",t.get(Pf.key)(e)],parseMarkdown:{match:e=>e.type==="emphasis",runner:(e,n,r)=>{e.openMark(r,{marker:n.marker}),e.next(n.children),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="emphasis",runner:(e,n)=>{e.withMark(n,"emphasis",void 0,{marker:n.attrs.marker})}}}));P(As.mark,{displayName:"MarkSchema<emphasis>",group:"Emphasis"});P(As.ctx,{displayName:"MarkSchemaCtx<emphasis>",group:"Emphasis"});const mc=de("ToggleEmphasis",t=>()=>fc(As.type(t)));P(mc,{displayName:"Command<toggleEmphasisCommand>",group:"Emphasis"});const k0=It(t=>ta(/(?:^|[^*])\*([^*]+)\*$/,As.type(t),{getAttr:()=>({marker:"*"}),updateCaptured:({fullMatch:e,start:n})=>e.startsWith("*")?{}:{fullMatch:e.slice(1),start:n+1}}));P(k0,{displayName:"InputRule<emphasis>|Star",group:"Emphasis"});const C0=It(t=>ta(/\b_(?![_\s])(.*?[^_\s])_\b/,As.type(t),{getAttr:()=>({marker:"_"}),updateCaptured:({fullMatch:e,start:n})=>e.startsWith("_")?{}:{fullMatch:e.slice(1),start:n+1}}));P(C0,{displayName:"InputRule<emphasis>|Underscore",group:"Emphasis"});const Lf=Lt("emphasisKeymap",{ToggleEmphasis:{shortcuts:"Mod-i",command:t=>{const e=t.get(me);return()=>e.call(mc.key)}}});P(Lf.ctx,{displayName:"KeymapCtx<emphasis>",group:"Emphasis"});P(Lf.shortcuts,{displayName:"Keymap<emphasis>",group:"Emphasis"});const zf=na("strong");P(zf,{displayName:"Attr<strong>",group:"Strong"});const ra=Ns("strong",t=>({attrs:{marker:{default:t.get(li).strong||"*",validate:"string"}},parseDOM:[{tag:"b",getAttrs:e=>e.style.fontWeight!="normal"&&null},{tag:"strong"},{style:"font-style",getAttrs:e=>e==="bold"},{style:"font-weight=400",clearMark:e=>e.type.name=="strong"},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],toDOM:e=>["strong",t.get(zf.key)(e)],parseMarkdown:{match:e=>e.type==="strong",runner:(e,n,r)=>{e.openMark(r,{marker:n.marker}),e.next(n.children),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="strong",runner:(e,n)=>{e.withMark(n,"strong",void 0,{marker:n.attrs.marker})}}}));P(ra.mark,{displayName:"MarkSchema<strong>",group:"Strong"});P(ra.ctx,{displayName:"MarkSchemaCtx<strong>",group:"Strong"});const gc=de("ToggleStrong",t=>()=>fc(ra.type(t)));P(gc,{displayName:"Command<toggleStrongCommand>",group:"Strong"});const x0=It(t=>ta(new RegExp("(?<![\\w:/])(?:\\*\\*|__)([^*_]+?)(?:\\*\\*|__)(?![\\w/])$"),ra.type(t),{getAttr:e=>({marker:e[0].startsWith("*")?"*":"_"})}));P(x0,{displayName:"InputRule<strong>",group:"Strong"});const Bf=Lt("strongKeymap",{ToggleBold:{shortcuts:["Mod-b"],command:t=>{const e=t.get(me);return()=>e.call(gc.key)}}});P(Bf.ctx,{displayName:"KeymapCtx<strong>",group:"Strong"});P(Bf.shortcuts,{displayName:"Keymap<strong>",group:"Strong"});const Ff=na("inlineCode");P(Ff,{displayName:"Attr<inlineCode>",group:"InlineCode"});const Cr=Ns("inlineCode",t=>({priority:100,code:!0,parseDOM:[{tag:"code"}],toDOM:e=>["code",t.get(Ff.key)(e)],parseMarkdown:{match:e=>e.type==="inlineCode",runner:(e,n,r)=>{e.openMark(r),e.addText(n.value),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="inlineCode",runner:(e,n,r)=>{e.withMark(n,"inlineCode",r.text||"")}}}));P(Cr.mark,{displayName:"MarkSchema<inlineCode>",group:"InlineCode"});P(Cr.ctx,{displayName:"MarkSchemaCtx<inlineCode>",group:"InlineCode"});const Vf=de("ToggleInlineCode",t=>()=>(e,n)=>{const{selection:r,tr:o}=e;if(r.empty)return!1;const{from:s,to:i}=r;return e.doc.rangeHasMark(s,i,Cr.type(t))?(n==null||n(o.removeMark(s,i,Cr.type(t))),!0):(Object.keys(e.schema.marks).filter(c=>c!==Cr.type.name).map(c=>e.schema.marks[c]).forEach(c=>{o.removeMark(s,i,c)}),n==null||n(o.addMark(s,i,Cr.type(t).create())),!0)});P(Vf,{displayName:"Command<toggleInlineCodeCommand>",group:"InlineCode"});const S0=It(t=>ta(/(?:`)([^`]+)(?:`)$/,Cr.type(t)));P(S0,{displayName:"InputRule<inlineCodeInputRule>",group:"InlineCode"});const Hf=Lt("inlineCodeKeymap",{ToggleInlineCode:{shortcuts:"Mod-e",command:t=>{const e=t.get(me);return()=>e.call(Vf.key)}}});P(Hf.ctx,{displayName:"KeymapCtx<inlineCode>",group:"InlineCode"});P(Hf.shortcuts,{displayName:"Keymap<inlineCode>",group:"InlineCode"});const qf=na("link");P(qf,{displayName:"Attr<link>",group:"Link"});const Mr=Ns("link",t=>({attrs:{href:{validate:"string"},title:{default:null,validate:"string|null"}},parseDOM:[{tag:"a[href]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw En(e);return{href:e.getAttribute("href"),title:e.getAttribute("title")}}}],toDOM:e=>["a",{...t.get(qf.key)(e),...e.attrs}],parseMarkdown:{match:e=>e.type==="link",runner:(e,n,r)=>{const o=n.url,s=n.title;e.openMark(r,{href:o,title:s}),e.next(n.children),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="link",runner:(e,n)=>{e.withMark(n,"link",void 0,{title:n.attrs.title,url:n.attrs.href})}}}));P(Mr.mark,{displayName:"MarkSchema<link>",group:"Link"});const _0=de("ToggleLink",t=>(e={})=>fc(Mr.type(t),e));P(_0,{displayName:"Command<toggleLinkCommand>",group:"Link"});const T0=de("UpdateLink",t=>(e={})=>(n,r)=>{if(!r)return!1;let o,s=-1;const{selection:i}=n,{from:a,to:l}=i;if(n.doc.nodesBetween(a,a===l?l+1:l,(h,v)=>{if(Mr.type(t).isInSet(h.marks))return o=h,s=v,!1}),!o)return!1;const c=o.marks.find(({type:h})=>h===Mr.type(t));if(!c)return!1;const u=s,d=s+o.nodeSize,{tr:f}=n,p=Mr.type(t).create({...c.attrs,...e});return p?(r(f.removeMark(u,d,c).addMark(u,d,p).setSelection(new he(f.selection.$anchor)).scrollIntoView()),!0):!1});P(T0,{displayName:"Command<updateLinkCommand>",group:"Link"});const $0=Af("doc",()=>({content:"block+",parseMarkdown:{match:({type:t})=>t==="root",runner:(t,e,n)=>{t.injectRoot(e,n)}},toMarkdown:{match:t=>t.type.name==="doc",runner:(t,e)=>{t.openNode("root"),t.next(e.content)}}}));P($0,{displayName:"NodeSchema<doc>",group:"Doc"});function nA(t){return Gb(t,e=>{var n;return e.type==="html"&&["<br />","<br>","<br >","<br/>"].includes((n=e.value)==null?void 0:n.trim())},(e,n)=>{if(!n.length)return;const r=n[n.length-1];if(!r)return;const o=r.children.indexOf(e);o!==-1&&r.children.splice(o,1)},!0)}const vc=$o("remark-preserve-empty-line",()=>()=>nA);P(vc.plugin,{displayName:"Remark<remarkPreserveEmptyLine>",group:"Remark"});P(vc.options,{displayName:"RemarkConfig<remarkPreserveEmptyLine>",group:"Remark"});const yc=mn("paragraph");P(yc,{displayName:"Attr<paragraph>",group:"Paragraph"});const tr=lt("paragraph",t=>({content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:e=>["p",t.get(yc.key)(e),0],parseMarkdown:{match:e=>e.type==="paragraph",runner:(e,n,r)=>{e.openNode(r),n.children?e.next(n.children):e.addText(n.value||""),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="paragraph",runner:(e,n)=>{var s;const o=(s=t.get(Xn).state)==null?void 0:s.doc.lastChild;e.openNode("paragraph"),(!n.content||n.content.size===0)&&n!==o&&rA(t)?e.addNode("html",void 0,"<br />"):w0(e,n),e.closeNode()}}}));function rA(t){let e=!1;try{t.get(vc.id),e=!0}catch(n){e=!1}return e}P(tr.node,{displayName:"NodeSchema<paragraph>",group:"Paragraph"});P(tr.ctx,{displayName:"NodeSchemaCtx<paragraph>",group:"Paragraph"});const Uf=de("TurnIntoText",t=>()=>$i(tr.type(t)));P(Uf,{displayName:"Command<turnIntoTextCommand>",group:"Paragraph"});const Wf=Lt("paragraphKeymap",{TurnIntoText:{shortcuts:"Mod-Alt-0",command:t=>{const e=t.get(me);return()=>e.call(Uf.key)}}});P(Wf.ctx,{displayName:"KeymapCtx<paragraph>",group:"Paragraph"});P(Wf.shortcuts,{displayName:"Keymap<paragraph>",group:"Paragraph"});const oA=Array(6).fill(0).map((t,e)=>e+1);function sA(t){return t.textContent.toLowerCase().trim().replace(/\s+/g,"-")}const bc=Pt(sA,"headingIdGenerator");P(bc,{displayName:"Ctx<HeadingIdGenerator>",group:"Heading"});const wc=mn("heading");P(wc,{displayName:"Attr<heading>",group:"Heading"});const Oo=lt("heading",t=>{const e=t.get(bc.key);return{content:"inline*",group:"block",defining:!0,attrs:{id:{default:"",validate:"string"},level:{default:1,validate:"number"}},parseDOM:oA.map(n=>({tag:"h".concat(n),getAttrs:r=>{if(!(r instanceof HTMLElement))throw En(r);return{level:n,id:r.id}}})),toDOM:n=>["h".concat(n.attrs.level),{...t.get(wc.key)(n),id:n.attrs.id||e(n)},0],parseMarkdown:{match:({type:n})=>n==="heading",runner:(n,r,o)=>{const s=r.depth;n.openNode(o,{level:s}),n.next(r.children),n.closeNode()}},toMarkdown:{match:n=>n.type.name==="heading",runner:(n,r)=>{n.openNode("heading",void 0,{depth:r.attrs.level}),w0(n,r),n.closeNode()}}}});P(Oo.node,{displayName:"NodeSchema<heading>",group:"Heading"});P(Oo.ctx,{displayName:"NodeSchemaCtx<heading>",group:"Heading"});const O0=It(t=>Yy(new RegExp("^(?<hashes>#+)\\s$"),Oo.type(t),e=>{var i,a;const n=((a=(i=e.groups)==null?void 0:i.hashes)==null?void 0:a.length)||0,r=t.get(Xn),{$from:o}=r.state.selection,s=o.node();if(s.type.name==="heading"){let l=Number(s.attrs.level)+Number(n);return l>6&&(l=6),{level:l}}return{level:n}}));P(O0,{displayName:"InputRule<wrapInHeadingInputRule>",group:"Heading"});const wn=de("WrapInHeading",t=>e=>(e!=null||(e=1),e<1?$i(tr.type(t)):$i(Oo.type(t),{level:e})));P(wn,{displayName:"Command<wrapInHeadingCommand>",group:"Heading"});const jf=de("DowngradeHeading",t=>()=>(e,n,r)=>{const{$from:o}=e.selection,s=o.node();if(s.type!==Oo.type(t)||!e.selection.empty||o.parentOffset!==0)return!1;const i=s.attrs.level-1;return i?(n==null||n(e.tr.setNodeMarkup(e.selection.$from.before(),void 0,{...s.attrs,level:i})),!0):$i(tr.type(t))(e,n,r)});P(jf,{displayName:"Command<downgradeHeadingCommand>",group:"Heading"});const Kf=Lt("headingKeymap",{TurnIntoH1:{shortcuts:"Mod-Alt-1",command:t=>{const e=t.get(me);return()=>e.call(wn.key,1)}},TurnIntoH2:{shortcuts:"Mod-Alt-2",command:t=>{const e=t.get(me);return()=>e.call(wn.key,2)}},TurnIntoH3:{shortcuts:"Mod-Alt-3",command:t=>{const e=t.get(me);return()=>e.call(wn.key,3)}},TurnIntoH4:{shortcuts:"Mod-Alt-4",command:t=>{const e=t.get(me);return()=>e.call(wn.key,4)}},TurnIntoH5:{shortcuts:"Mod-Alt-5",command:t=>{const e=t.get(me);return()=>e.call(wn.key,5)}},TurnIntoH6:{shortcuts:"Mod-Alt-6",command:t=>{const e=t.get(me);return()=>e.call(wn.key,6)}},DowngradeHeading:{shortcuts:["Delete","Backspace"],command:t=>{const e=t.get(me);return()=>e.call(jf.key)}}});P(Kf.ctx,{displayName:"KeymapCtx<heading>",group:"Heading"});P(Kf.shortcuts,{displayName:"Keymap<heading>",group:"Heading"});const Yf=mn("blockquote");P(Yf,{displayName:"Attr<blockquote>",group:"Blockquote"});const oa=lt("blockquote",t=>({content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:e=>["blockquote",t.get(Yf.key)(e),0],parseMarkdown:{match:({type:e})=>e==="blockquote",runner:(e,n,r)=>{e.openNode(r).next(n.children).closeNode()}},toMarkdown:{match:e=>e.type.name==="blockquote",runner:(e,n)=>{e.openNode("blockquote").next(n.content).closeNode()}}}));P(oa.node,{displayName:"NodeSchema<blockquote>",group:"Blockquote"});P(oa.ctx,{displayName:"NodeSchemaCtx<blockquote>",group:"Blockquote"});const M0=It(t=>Ef(/^\s*>\s$/,oa.type(t)));P(M0,{displayName:"InputRule<wrapInBlockquoteInputRule>",group:"Blockquote"});const kc=de("WrapInBlockquote",t=>()=>Mf(oa.type(t)));P(kc,{displayName:"Command<wrapInBlockquoteCommand>",group:"Blockquote"});const Gf=Lt("blockquoteKeymap",{WrapInBlockquote:{shortcuts:"Mod-Shift-b",command:t=>{const e=t.get(me);return()=>e.call(kc.key)}}});P(Gf.ctx,{displayName:"KeymapCtx<blockquote>",group:"Blockquote"});P(Gf.shortcuts,{displayName:"Keymap<blockquote>",group:"Blockquote"});const Jf=mn("codeBlock",()=>({pre:{},code:{}}));P(Jf,{displayName:"Attr<codeBlock>",group:"CodeBlock"});const sa=lt("code_block",t=>({content:"text*",group:"block",marks:"",defining:!0,code:!0,attrs:{language:{default:"",validate:"string"}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:e=>{if(!(e instanceof HTMLElement))throw En(e);return{language:e.dataset.language}}}],toDOM:e=>{const n=t.get(Jf.key)(e),r=e.attrs.language,o=r&&r.length>0?{"data-language":r}:void 0;return["pre",{...n.pre,...o},["code",n.code,0]]},parseMarkdown:{match:({type:e})=>e==="code",runner:(e,n,r)=>{var i;const o=(i=n.lang)!=null?i:"",s=n.value;e.openNode(r,{language:o}),s&&e.addText(s),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="code_block",runner:(e,n)=>{var r;e.addNode("code",void 0,((r=n.content.firstChild)==null?void 0:r.text)||"",{lang:n.attrs.language})}}}));P(sa.node,{displayName:"NodeSchema<codeBlock>",group:"CodeBlock"});P(sa.ctx,{displayName:"NodeSchemaCtx<codeBlock>",group:"CodeBlock"});const E0=It(t=>Yy(new RegExp("^```(?<language>[a-z]*)?[\\s\\n]$"),sa.type(t),e=>{var n,r;return{language:(r=(n=e.groups)==null?void 0:n.language)!=null?r:""}}));P(E0,{displayName:"InputRule<createCodeBlockInputRule>",group:"CodeBlock"});const Cc=de("CreateCodeBlock",t=>(e="")=>$i(sa.type(t),{language:e}));P(Cc,{displayName:"Command<createCodeBlockCommand>",group:"CodeBlock"});const iA=de("UpdateCodeBlockLanguage",()=>({pos:t,language:e}={pos:-1,language:""})=>(n,r)=>t>=0?(r==null||r(n.tr.setNodeAttribute(t,"language",e)),!0):!1);P(iA,{displayName:"Command<updateCodeBlockLanguageCommand>",group:"CodeBlock"});const Xf=Lt("codeBlockKeymap",{CreateCodeBlock:{shortcuts:"Mod-Alt-c",command:t=>{const e=t.get(me);return()=>e.call(Cc.key)}}});P(Xf.ctx,{displayName:"KeymapCtx<codeBlock>",group:"CodeBlock"});P(Xf.shortcuts,{displayName:"Keymap<codeBlock>",group:"CodeBlock"});const Zf=mn("image");P(Zf,{displayName:"Attr<image>",group:"Image"});const Rs=lt("image",t=>({inline:!0,group:"inline",selectable:!0,draggable:!0,marks:"",atom:!0,defining:!0,isolating:!0,attrs:{src:{default:"",validate:"string"},alt:{default:"",validate:"string"},title:{default:"",validate:"string"}},parseDOM:[{tag:"img[src]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw En(e);return{src:e.getAttribute("src")||"",alt:e.getAttribute("alt")||"",title:e.getAttribute("title")||e.getAttribute("alt")||""}}}],toDOM:e=>["img",{...t.get(Zf.key)(e),...e.attrs}],parseMarkdown:{match:({type:e})=>e==="image",runner:(e,n,r)=>{const o=n.url,s=n.alt,i=n.title;e.addNode(r,{src:o,alt:s,title:i})}},toMarkdown:{match:e=>e.type.name==="image",runner:(e,n)=>{e.addNode("image",void 0,void 0,{title:n.attrs.title,url:n.attrs.src,alt:n.attrs.alt})}}}));P(Rs.node,{displayName:"NodeSchema<image>",group:"Image"});P(Rs.ctx,{displayName:"NodeSchemaCtx<image>",group:"Image"});const Qf=de("InsertImage",t=>(e={})=>(n,r)=>{if(!r)return!0;const{src:o="",alt:s="",title:i=""}=e,a=Rs.type(t).create({src:o,alt:s,title:i});return a&&r(n.tr.replaceSelectionWith(a).scrollIntoView()),!0});P(Qf,{displayName:"Command<insertImageCommand>",group:"Image"});const N0=de("UpdateImage",t=>(e={})=>(n,r)=>{const o=RN(n.selection,Rs.type(t));if(!o)return!1;const{node:s,pos:i}=o,a={...s.attrs},{src:l,alt:c,title:u}=e;return l!==void 0&&(a.src=l),c!==void 0&&(a.alt=c),u!==void 0&&(a.title=u),r==null||r(n.tr.setNodeMarkup(i,void 0,a).scrollIntoView()),!0});P(N0,{displayName:"Command<updateImageCommand>",group:"Image"});const aA=It(t=>new Yt(new RegExp('!\\[(?<alt>.*?)]\\((?<filename>.*?)\\s*(?="|\\))"?(?<title>[^"]+)?"?\\)'),(e,n,r,o)=>{const[s,i,a="",l]=n;return s?e.tr.replaceWith(r,o,Rs.type(t).create({src:a,alt:i,title:l})):null}));P(aA,{displayName:"InputRule<insertImageInputRule>",group:"Image"});const Dl=mn("hardbreak",t=>({"data-type":"hardbreak","data-is-inline":t.attrs.isInline}));P(Dl,{displayName:"Attr<hardbreak>",group:"Hardbreak"});const co=lt("hardbreak",t=>({inline:!0,group:"inline",attrs:{isInline:{default:!1,validate:"boolean"}},selectable:!1,parseDOM:[{tag:"br"},{tag:'span[data-type="hardbreak"]',getAttrs:()=>({isInline:!0})}],toDOM:e=>e.attrs.isInline?["span",t.get(Dl.key)(e)," "]:["br",t.get(Dl.key)(e)],parseMarkdown:{match:({type:e})=>e==="break",runner:(e,n,r)=>{var o;e.addNode(r,{isInline:!!((o=n.data)!=null&&o.isInline)})}},leafText:()=>"\n",toMarkdown:{match:e=>e.type.name==="hardbreak",runner:(e,n)=>{n.attrs.isInline?e.addNode("text",void 0,"\n"):e.addNode("break")}}}));P(co.node,{displayName:"NodeSchema<hardbreak>",group:"Hardbreak"});P(co.ctx,{displayName:"NodeSchemaCtx<hardbreak>",group:"Hardbreak"});const eh=de("InsertHardbreak",t=>()=>(e,n)=>{var s;const{selection:r,tr:o}=e;if(!(r instanceof he))return!1;if(r.empty){const i=r.$from.node();if(i.childCount>0&&((s=i.lastChild)==null?void 0:s.type.name)==="hardbreak")return n==null||n(o.replaceRangeWith(r.to-1,r.to,e.schema.node("paragraph")).setSelection(pe.near(o.doc.resolve(r.to))).scrollIntoView()),!0}return n==null||n(o.setMeta("hardbreak",!0).replaceSelectionWith(co.type(t).create()).scrollIntoView()),!0});P(eh,{displayName:"Command<insertHardbreakCommand>",group:"Hardbreak"});const th=Lt("hardbreakKeymap",{InsertHardbreak:{shortcuts:"Shift-Enter",command:t=>{const e=t.get(me);return()=>e.call(eh.key)}}});P(th.ctx,{displayName:"KeymapCtx<hardbreak>",group:"Hardbreak"});P(th.shortcuts,{displayName:"Keymap<hardbreak>",group:"Hardbreak"});const nh=mn("hr");P(nh,{displayName:"Attr<hr>",group:"Hr"});const ia=lt("hr",t=>({group:"block",parseDOM:[{tag:"hr"}],toDOM:e=>["hr",t.get(nh.key)(e)],parseMarkdown:{match:({type:e})=>e==="thematicBreak",runner:(e,n,r)=>{e.addNode(r)}},toMarkdown:{match:e=>e.type.name==="hr",runner:e=>{e.addNode("thematicBreak")}}}));P(ia.node,{displayName:"NodeSchema<hr>",group:"Hr"});P(ia.ctx,{displayName:"NodeSchemaCtx<hr>",group:"Hr"});const D0=It(t=>new Yt(/^(?:---|___\s|\*\*\*\s)$/,(e,n,r,o)=>{const{tr:s}=e;return n[0]&&s.replaceWith(r-1,o,ia.type(t).create()),s}));P(D0,{displayName:"InputRule<insertHrInputRule>",group:"Hr"});const A0=de("InsertHr",t=>()=>(e,n)=>{if(!n)return!0;const r=tr.node.type(t).create(),{tr:o,selection:s}=e,{from:i}=s,a=ia.type(t).create();if(!a)return!0;const l=o.replaceSelectionWith(a).insert(i,r),c=pe.findFrom(l.doc.resolve(i),1,!0);return c&&n(l.setSelection(c).scrollIntoView()),!0});P(A0,{displayName:"Command<insertHrCommand>",group:"Hr"});const rh=mn("bulletList");P(rh,{displayName:"Attr<bulletList>",group:"BulletList"});const Is=lt("bullet_list",t=>({content:"listItem+",group:"block",attrs:{spread:{default:!1,validate:"boolean"}},parseDOM:[{tag:"ul",getAttrs:e=>{if(!(e instanceof HTMLElement))throw En(e);return{spread:e.dataset.spread==="true"}}}],toDOM:e=>["ul",{...t.get(rh.key)(e),"data-spread":e.attrs.spread},0],parseMarkdown:{match:({type:e,ordered:n})=>e==="list"&&!n,runner:(e,n,r)=>{const o=n.spread!=null?"".concat(n.spread):"false";e.openNode(r,{spread:o}).next(n.children).closeNode()}},toMarkdown:{match:e=>e.type.name==="bullet_list",runner:(e,n)=>{e.openNode("list",void 0,{ordered:!1,spread:n.attrs.spread}).next(n.content).closeNode()}}}));P(Is.node,{displayName:"NodeSchema<bulletList>",group:"BulletList"});P(Is.ctx,{displayName:"NodeSchemaCtx<bulletList>",group:"BulletList"});const R0=It(t=>Ef(/^\s*([-+*])\s$/,Is.type(t)));P(R0,{displayName:"InputRule<wrapInBulletListInputRule>",group:"BulletList"});const xc=de("WrapInBulletList",t=>()=>Mf(Is.type(t)));P(xc,{displayName:"Command<wrapInBulletListCommand>",group:"BulletList"});const oh=Lt("bulletListKeymap",{WrapInBulletList:{shortcuts:"Mod-Alt-8",command:t=>{const e=t.get(me);return()=>e.call(xc.key)}}});P(oh.ctx,{displayName:"KeymapCtx<bulletListKeymap>",group:"BulletList"});P(oh.shortcuts,{displayName:"Keymap<bulletListKeymap>",group:"BulletList"});const sh=mn("orderedList");P(sh,{displayName:"Attr<orderedList>",group:"OrderedList"});const Ps=lt("ordered_list",t=>({content:"listItem+",group:"block",attrs:{order:{default:1,validate:"number"},spread:{default:!1,validate:"boolean"}},parseDOM:[{tag:"ol",getAttrs:e=>{if(!(e instanceof HTMLElement))throw En(e);return{spread:e.dataset.spread,order:e.hasAttribute("start")?Number(e.getAttribute("start")):1}}}],toDOM:e=>["ol",{...t.get(sh.key)(e),...e.attrs.order===1?{}:e.attrs.order,"data-spread":e.attrs.spread},0],parseMarkdown:{match:({type:e,ordered:n})=>e==="list"&&!!n,runner:(e,n,r)=>{const o=n.spread!=null?"".concat(n.spread):"true";e.openNode(r,{spread:o}).next(n.children).closeNode()}},toMarkdown:{match:e=>e.type.name==="ordered_list",runner:(e,n)=>{e.openNode("list",void 0,{ordered:!0,start:1,spread:n.attrs.spread==="true"}),e.next(n.content),e.closeNode()}}}));P(Ps.node,{displayName:"NodeSchema<orderedList>",group:"OrderedList"});P(Ps.ctx,{displayName:"NodeSchemaCtx<orderedList>",group:"OrderedList"});const I0=It(t=>Ef(/^\s*(\d+)\.\s$/,Ps.type(t),e=>({order:Number(e[1])}),(e,n)=>n.childCount+n.attrs.order===Number(e[1])));P(I0,{displayName:"InputRule<wrapInOrderedListInputRule>",group:"OrderedList"});const Sc=de("WrapInOrderedList",t=>()=>Mf(Ps.type(t)));P(Sc,{displayName:"Command<wrapInOrderedListCommand>",group:"OrderedList"});const ih=Lt("orderedListKeymap",{WrapInOrderedList:{shortcuts:"Mod-Alt-7",command:t=>{const e=t.get(me);return()=>e.call(Sc.key)}}});P(ih.ctx,{displayName:"KeymapCtx<orderedList>",group:"OrderedList"});P(ih.shortcuts,{displayName:"Keymap<orderedList>",group:"OrderedList"});const ah=mn("listItem");P(ah,{displayName:"Attr<listItem>",group:"ListItem"});const nr=lt("list_item",t=>({group:"listItem",content:"paragraph block*",attrs:{label:{default:"",validate:"string"},listType:{default:"bullet",validate:"string"},spread:{default:!0,validate:"boolean"}},defining:!0,parseDOM:[{tag:"li",getAttrs:e=>{if(!(e instanceof HTMLElement))throw En(e);return{label:e.dataset.label,listType:e.dataset.listType,spread:e.dataset.spread==="true"}}}],toDOM:e=>["li",{...t.get(ah.key)(e),"data-label":e.attrs.label,"data-list-type":e.attrs.listType,"data-spread":e.attrs.spread},0],parseMarkdown:{match:({type:e})=>e==="listItem",runner:(e,n,r)=>{const o=n.label!=null?"".concat(n.label,"."):"",s=n.label!=null?"ordered":"bullet",i=n.spread!=null?"".concat(n.spread):"true";e.openNode(r,{label:o,listType:s,spread:i}),e.next(n.children),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="list_item",runner:(e,n)=>{e.openNode("listItem",void 0,{spread:n.attrs.spread}),e.next(n.content),e.closeNode()}}}));P(nr.node,{displayName:"NodeSchema<listItem>",group:"ListItem"});P(nr.ctx,{displayName:"NodeSchemaCtx<listItem>",group:"ListItem"});const lh=de("SinkListItem",t=>()=>QD(nr.type(t)));P(lh,{displayName:"Command<sinkListItemCommand>",group:"ListItem"});const ch=de("LiftListItem",t=>()=>JD(nr.type(t)));P(ch,{displayName:"Command<liftListItemCommand>",group:"ListItem"});const uh=de("SplitListItem",t=>()=>GD(nr.type(t)));P(uh,{displayName:"Command<splitListItemCommand>",group:"ListItem"});function lA(t){return(e,n,r)=>{const{selection:o}=e;if(!(o instanceof he))return!1;const{empty:s,$from:i}=o;return!s||i.parentOffset!==0||i.node(-1).type!==nr.type(t)?!1:Hy(e,n,r)}}const dh=de("LiftFirstListItem",t=>()=>lA(t));P(dh,{displayName:"Command<liftFirstListItemCommand>",group:"ListItem"});const fh=Lt("listItemKeymap",{NextListItem:{shortcuts:"Enter",command:t=>{const e=t.get(me);return()=>e.call(uh.key)}},SinkListItem:{shortcuts:["Tab","Mod-]"],command:t=>{const e=t.get(me);return()=>e.call(lh.key)}},LiftListItem:{shortcuts:["Shift-Tab","Mod-["],command:t=>{const e=t.get(me);return()=>e.call(ch.key)}},LiftFirstListItem:{shortcuts:["Backspace","Delete"],command:t=>{const e=t.get(me);return()=>e.call(dh.key)}}});P(fh.ctx,{displayName:"KeymapCtx<listItem>",group:"ListItem"});P(fh.shortcuts,{displayName:"Keymap<listItem>",group:"ListItem"});const P0=Af("text",()=>({group:"inline",parseMarkdown:{match:({type:t})=>t==="text",runner:(t,e)=>{t.addText(e.value)}},toMarkdown:{match:t=>t.type.name==="text",runner:(t,e)=>{t.addNode("text",void 0,e.text)}}}));P(P0,{displayName:"NodeSchema<text>",group:"Text"});const hh=mn("html");P(hh,{displayName:"Attr<html>",group:"Html"});const ph=lt("html",t=>({atom:!0,group:"inline",inline:!0,attrs:{value:{default:"",validate:"string"}},toDOM:e=>{const n=document.createElement("span"),r={...t.get(hh.key)(e),"data-value":e.attrs.value,"data-type":"html"};return n.textContent=e.attrs.value,["span",r,e.attrs.value]},parseDOM:[{tag:'span[data-type="html"]',getAttrs:e=>{var n;return{value:(n=e.dataset.value)!=null?n:""}}}],parseMarkdown:{match:({type:e})=>e==="html",runner:(e,n,r)=>{e.addNode(r,{value:n.value})}},toMarkdown:{match:e=>e.type.name==="html",runner:(e,n)=>{e.addNode("html",void 0,n.attrs.value)}}}));P(ph.node,{displayName:"NodeSchema<html>",group:"Html"});P(ph.ctx,{displayName:"NodeSchemaCtx<html>",group:"Html"});const cA=[$0,yc,tr,bc,wc,Oo,Dl,co,Yf,oa,Jf,sa,nh,ia,Zf,Rs,rh,Is,sh,Ps,ah,nr,Pf,As,zf,ra,Ff,Cr,qf,Mr,hh,ph,P0].flat(),uA=[M0,R0,I0,E0,D0,O0].flat(),dA=[k0,C0,S0,x0],fA=de("IsMarkSelected",()=>t=>e=>{if(!t)return!1;const{doc:n,selection:r}=e;return n.rangeHasMark(r.from,r.to,t)}),hA=de("IsNoteSelected",()=>t=>e=>t?IN(e,t).hasNode:!1),pA=de("ClearTextInCurrentBlock",()=>()=>(t,e)=>{let n=t.tr;const{$from:r,$to:o}=n.selection,{pos:s}=r,{pos:i}=o,a=s-r.node().content.size;return a<0?!1:(n=n.deleteRange(a,i),e==null||e(n),!0)}),mA=de("SetBlockType",()=>t=>(e,n)=>{const{nodeType:r,attrs:o=null}=t!=null?t:{};if(!r)return!1;const s=e.tr,{from:i,to:a}=s.selection;try{s.setBlockType(i,a,r,o)}catch(l){return!1}return n==null||n(s),!0}),gA=de("WrapInBlockType",()=>t=>(e,n)=>{const{nodeType:r,attrs:o=null}=t!=null?t:{};if(!r)return!1;let s=e.tr;try{const{$from:i,$to:a}=s.selection,l=i.blockRange(a),c=l&&hf(l,r,o);if(!c)return!1;s=s.wrap(l,c)}catch(i){return!1}return n==null||n(s),!0}),vA=de("AddBlockType",()=>t=>(e,n)=>{const{nodeType:r,attrs:o=null}=t!=null?t:{};if(!r)return!1;const s=e.tr;try{const i=r instanceof Gn?r:r.createAndFill(o);if(!i)return!1;s.replaceSelectionWith(i)}catch(i){return!1}return n==null||n(s),!0}),yA=de("SelectTextNearPos",()=>t=>(e,n)=>{const{pos:r}=t!=null?t:{};if(r==null)return!1;const o=(i,a,l)=>Math.min(Math.max(i,a),l),s=e.tr;try{const i=e.doc.resolve(o(r,0,e.doc.content.size));s.setSelection(he.near(i))}catch(i){return!1}return n==null||n(s.scrollIntoView()),!0}),bA=[Uf,kc,wn,jf,Cc,eh,A0,Qf,N0,Sc,xc,lh,uh,ch,dh,mc,Vf,gc,_0,T0,fA,hA,pA,mA,gA,vA,yA],wA=[Gf,Xf,th,Kf,fh,ih,oh,Wf,Lf,Hf,Bf].flat(),mh=$o("remarkAddOrderInList",()=>()=>t=>{Ki(t,"list",e=>{var n;if(e.ordered){const r=(n=e.start)!=null?n:1;e.children.forEach((o,s)=>{o.label=s+r})}})});P(mh.plugin,{displayName:"Remark<remarkAddOrderInListPlugin>",group:"Remark"});P(mh.options,{displayName:"RemarkConfig<remarkAddOrderInListPlugin>",group:"Remark"});const gh=$o("remarkLineBreak",()=>()=>t=>{const e=/[\t ]*(?:\r?\n|\r)/g;Ki(t,"text",(n,r,o)=>{if(!n.value||typeof n.value!="string")return;const s=[];let i=0;e.lastIndex=0;let a=e.exec(n.value);for(;a;){const c=a.index;i!==c&&s.push({type:"text",value:n.value.slice(i,c)}),s.push({type:"break",data:{isInline:!0}}),i=c+a[0].length,a=e.exec(n.value)}if(s.length>0&&o&&typeof r=="number")return i<n.value.length&&s.push({type:"text",value:n.value.slice(i)}),o.children.splice(r,1,...s),r+s.length})});P(gh.plugin,{displayName:"Remark<remarkLineBreak>",group:"Remark"});P(gh.options,{displayName:"RemarkConfig<remarkLineBreak>",group:"Remark"});const vh=$o("remarkInlineLink",()=>tA);P(vh.plugin,{displayName:"Remark<remarkInlineLinkPlugin>",group:"Remark"});P(vh.options,{displayName:"RemarkConfig<remarkInlineLinkPlugin>",group:"Remark"});const kA=t=>!!t.children,CA=t=>t.type==="html";function xA(t,e){return n(t,0,null)[0];function n(r,o,s){if(kA(r)){const i=[];for(let a=0,l=r.children.length;a<l;a++){const c=r.children[a];if(c){const u=n(c,a,r);if(u)for(let d=0,f=u.length;d<f;d++){const p=u[d];p&&i.push(p)}}}r.children=i}return e(r,o,s)}}const SA=["root","blockquote","listItem"],yh=$o("remarkHTMLTransformer",()=>()=>t=>{xA(t,(e,n,r)=>CA(e)?(r&&SA.includes(r.type)&&(e.children=[{...e}],delete e.value,e.type="paragraph"),[e]):[e])});P(yh.plugin,{displayName:"Remark<remarkHtmlTransformer>",group:"Remark"});P(yh.options,{displayName:"RemarkConfig<remarkHtmlTransformer>",group:"Remark"});const bh=$o("remarkMarker",()=>()=>(t,e)=>{const n=r=>e.value.charAt(r.position.start.offset);Ki(t,r=>["strong","emphasis"].includes(r.type),r=>{r.marker=n(r)})});P(bh.plugin,{displayName:"Remark<remarkMarker>",group:"Remark"});P(bh.options,{displayName:"RemarkConfig<remarkMarker>",group:"Remark"});const L0=Gt(()=>{let t=!1;const e=new mt("MILKDOWN_INLINE_NODES_CURSOR"),n=new wt({key:e,state:{init(){return!1},apply(r){if(!r.selection.empty)return!1;const o=r.selection.$from,s=o.nodeBefore,i=o.nodeAfter;return!!(s&&i&&s.isInline&&!s.isText&&i.isInline&&!i.isText)}},props:{handleDOMEvents:{compositionend:(r,o)=>t?(t=!1,requestAnimationFrame(()=>{if(n.getState(r.state)){const i=r.state.selection.from;o.preventDefault(),r.dispatch(r.state.tr.insertText(o.data||"",i))}}),!0):!1,compositionstart:r=>(n.getState(r.state)&&(t=!0),!1),beforeinput:(r,o)=>{if(n.getState(r.state)&&o instanceof InputEvent&&o.data&&!t){const i=r.state.selection.from;return o.preventDefault(),r.dispatch(r.state.tr.insertText(o.data||"",i)),!0}return!1}},decorations(r){if(n.getState(r)){const i=r.selection.$from.pos,a=document.createElement("span"),l=ht.widget(i,a,{side:-1}),c=document.createElement("span"),u=ht.widget(i,c);return setTimeout(()=>{a.contentEditable="true",c.contentEditable="true"}),Ie.create(r.doc,[l,u])}return Ie.empty}}});return n});P(L0,{displayName:"Prose<inlineNodesCursorPlugin>",group:"Prose"});const z0=Gt(t=>new wt({key:new mt("MILKDOWN_HARDBREAK_MARKS"),appendTransaction:(e,n,r)=>{if(!e.length)return;const[o]=e;if(!o)return;const[s]=o.steps;if(o.getMeta("hardbreak")){if(!(s instanceof ft))return;const{from:l}=s;return r.tr.setNodeMarkup(l,co.type(t),void 0,[])}if(s instanceof Kn){let l=r.tr;const{from:c,to:u}=s;return r.doc.nodesBetween(c,u,(d,f)=>{d.type===co.type(t)&&(l=l.setNodeMarkup(f,co.type(t),void 0,[]))}),l}}}));P(z0,{displayName:"Prose<hardbreakClearMarkPlugin>",group:"Prose"});const wh=Pt(["table","code_block"],"hardbreakFilterNodes");P(wh,{displayName:"Ctx<hardbreakFilterNodes>",group:"Prose"});const B0=Gt(t=>{const e=t.get(wh.key);return new wt({key:new mt("MILKDOWN_HARDBREAK_FILTER"),filterTransaction:(n,r)=>{const o=n.getMeta("hardbreak"),[s]=n.steps;if(o&&s){const{from:i}=s,a=r.doc.resolve(i);let l=a.depth,c=!0;for(;l>0;)e.includes(a.node(l).type.name)&&(c=!1),l--;return c}return!0}})});P(B0,{displayName:"Prose<hardbreakFilterPlugin>",group:"Prose"});const F0=Gt(t=>{const e=new mt("MILKDOWN_HEADING_ID"),n=r=>{if(r.composing)return;const o=t.get(bc.key),s=r.state.tr.setMeta("addToHistory",!1);let i=!1;const a={};r.state.doc.descendants((l,c)=>{if(l.type===Oo.type(t)){if(l.textContent.trim().length===0)return;const u=l.attrs;let d=o(l);a[d]?(a[d]+=1,d+="-#".concat(a[d])):a[d]=1,u.id!==d&&(i=!0,s.setMeta(e,!0).setNodeMarkup(c,void 0,{...u,id:d}))}}),i&&r.dispatch(s)};return new wt({key:e,view:r=>(n(r),{update:(o,s)=>{o.state.doc.eq(s.doc)||n(o)}})})});P(F0,{displayName:"Prose<syncHeadingIdPlugin>",group:"Prose"});const V0=Gt(t=>{const e=(n,r,o)=>{if(!o.selection||n.some(d=>d.getMeta("addToHistory")===!1||!d.isGeneric))return null;const s=Ps.type(t),i=Is.type(t),a=nr.type(t),l=(d,f)=>{let p=!1;const h="".concat(f+1,".");return d.label!==h&&(d.label=h,p=!0),p};let c=o.tr,u=!1;return o.doc.descendants((d,f,p,h)=>{if(d.type===i){const v=d.maybeChild(0);(v==null?void 0:v.type)===a&&v.attrs.listType==="ordered"&&(u=!0,c.setNodeMarkup(f,s,{spread:"true"}),d.descendants((y,w,x,$)=>{if(y.type===a){const S={...y.attrs};l(S,$)&&(c=c.setNodeMarkup(w,void 0,S))}return!1}))}else if(d.type===a&&(p==null?void 0:p.type)===s){const v={...d.attrs};let y=!1;v.listType!=="ordered"&&(v.listType="ordered",y=!0),(p==null?void 0:p.maybeChild(0))&&(y=l(v,h)),y&&(c=c.setNodeMarkup(f,void 0,v),u=!0)}}),u?c.setMeta("addToHistory",!1):null};return new wt({key:new mt("MILKDOWN_KEEP_LIST_ORDER"),appendTransaction:e})});P(V0,{displayName:"Prose<syncListOrderPlugin>",group:"Prose"});const _A=[z0,wh,B0,L0,mh,vh,gh,yh,bh,vc,F0,V0].flat(),TA=[cA,uA,dA,bA,wA,_A].flat();var Od,Md;if(typeof WeakMap<"u"){let t=new WeakMap;Od=e=>t.get(e),Md=(e,n)=>(t.set(e,n),n)}else{const t=[];let n=0;Od=r=>{for(let o=0;o<t.length;o+=2)if(t[o]==r)return t[o+1]},Md=(r,o)=>(n==10&&(n=0),t[n++]=r,t[n++]=o)}var Me=class{constructor(t,e,n,r){this.width=t,this.height=e,this.map=n,this.problems=r}findCell(t){for(let e=0;e<this.map.length;e++){const n=this.map[e];if(n!=t)continue;const r=e%this.width,o=e/this.width|0;let s=r+1,i=o+1;for(let a=1;s<this.width&&this.map[e+a]==n;a++)s++;for(let a=1;i<this.height&&this.map[e+this.width*a]==n;a++)i++;return{left:r,top:o,right:s,bottom:i}}throw new RangeError("No cell with offset ".concat(t," found"))}colCount(t){for(let e=0;e<this.map.length;e++)if(this.map[e]==t)return e%this.width;throw new RangeError("No cell with offset ".concat(t," found"))}nextCell(t,e,n){const{left:r,right:o,top:s,bottom:i}=this.findCell(t);return e=="horiz"?(n<0?r==0:o==this.width)?null:this.map[s*this.width+(n<0?r-1:o)]:(n<0?s==0:i==this.height)?null:this.map[r+this.width*(n<0?s-1:i)]}rectBetween(t,e){const{left:n,right:r,top:o,bottom:s}=this.findCell(t),{left:i,right:a,top:l,bottom:c}=this.findCell(e);return{left:Math.min(n,i),top:Math.min(o,l),right:Math.max(r,a),bottom:Math.max(s,c)}}cellsInRect(t){const e=[],n={};for(let r=t.top;r<t.bottom;r++)for(let o=t.left;o<t.right;o++){const s=r*this.width+o,i=this.map[s];n[i]||(n[i]=!0,!(o==t.left&&o&&this.map[s-1]==i||r==t.top&&r&&this.map[s-this.width]==i)&&e.push(i))}return e}positionAt(t,e,n){for(let r=0,o=0;;r++){const s=o+n.child(r).nodeSize;if(r==t){let i=e+t*this.width;const a=(t+1)*this.width;for(;i<a&&this.map[i]<o;)i++;return i==a?s-1:this.map[i]}o=s}}static get(t){return Od(t)||Md(t,$A(t))}};function $A(t){if(t.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+t.type.name);const e=OA(t),n=t.childCount,r=[];let o=0,s=null;const i=[];for(let c=0,u=e*n;c<u;c++)r[c]=0;for(let c=0,u=0;c<n;c++){const d=t.child(c);u++;for(let h=0;;h++){for(;o<r.length&&r[o]!=0;)o++;if(h==d.childCount)break;const v=d.child(h),{colspan:y,rowspan:w,colwidth:x}=v.attrs;for(let $=0;$<w;$++){if($+c>=n){(s||(s=[])).push({type:"overlong_rowspan",pos:u,n:w-$});break}const S=o+$*e;for(let _=0;_<y;_++){r[S+_]==0?r[S+_]=u:(s||(s=[])).push({type:"collision",row:c,pos:u,n:y-_});const E=x&&x[_];if(E){const D=(S+_)%e*2,N=i[D];N==null||N!=E&&i[D+1]==1?(i[D]=E,i[D+1]=1):N==E&&i[D+1]++}}}o+=y,u+=v.nodeSize}const f=(c+1)*e;let p=0;for(;o<f;)r[o++]==0&&p++;p&&(s||(s=[])).push({type:"missing",row:c,n:p}),u++}(e===0||n===0)&&(s||(s=[])).push({type:"zero_sized"});const a=new Me(e,n,r,s);let l=!1;for(let c=0;!l&&c<i.length;c+=2)i[c]!=null&&i[c+1]<n&&(l=!0);return l&&MA(a,i,t),a}function OA(t){let e=-1,n=!1;for(let r=0;r<t.childCount;r++){const o=t.child(r);let s=0;if(n)for(let i=0;i<r;i++){const a=t.child(i);for(let l=0;l<a.childCount;l++){const c=a.child(l);i+c.attrs.rowspan>r&&(s+=c.attrs.colspan)}}for(let i=0;i<o.childCount;i++){const a=o.child(i);s+=a.attrs.colspan,a.attrs.rowspan>1&&(n=!0)}e==-1?e=s:e!=s&&(e=Math.max(e,s))}return e}function MA(t,e,n){t.problems||(t.problems=[]);const r={};for(let o=0;o<t.map.length;o++){const s=t.map[o];if(r[s])continue;r[s]=!0;const i=n.nodeAt(s);if(!i)throw new RangeError("No cell with offset ".concat(s," found"));let a=null;const l=i.attrs;for(let c=0;c<l.colspan;c++){const u=(o+c)%t.width,d=e[u*2];d!=null&&(!l.colwidth||l.colwidth[c]!=d)&&((a||(a=EA(l)))[c]=d)}a&&t.problems.unshift({type:"colwidth mismatch",pos:s,colwidth:a})}}function EA(t){if(t.colwidth)return t.colwidth.slice();const e=[];for(let n=0;n<t.colspan;n++)e.push(0);return e}function ug(t,e){if(typeof t=="string")return{};const n=t.getAttribute("data-colwidth"),r=n&&/^\d+(,\d+)*$/.test(n)?n.split(",").map(i=>Number(i)):null,o=Number(t.getAttribute("colspan")||1),s={colspan:o,rowspan:Number(t.getAttribute("rowspan")||1),colwidth:r&&r.length==o?r:null};for(const i in e){const a=e[i].getFromDOM,l=a&&a(t);l!=null&&(s[i]=l)}return s}function dg(t,e){const n={};t.attrs.colspan!=1&&(n.colspan=t.attrs.colspan),t.attrs.rowspan!=1&&(n.rowspan=t.attrs.rowspan),t.attrs.colwidth&&(n["data-colwidth"]=t.attrs.colwidth.join(","));for(const r in e){const o=e[r].setDOMAttr;o&&o(t.attrs[r],n)}return n}function NA(t){if(t!==null){if(!Array.isArray(t))throw new TypeError("colwidth must be null or an array");for(const e of t)if(typeof e!="number")throw new TypeError("colwidth must be null or an array of numbers")}}function DA(t){const e=t.cellAttributes||{},n={colspan:{default:1,validate:"number"},rowspan:{default:1,validate:"number"},colwidth:{default:null,validate:NA}};for(const r in e)n[r]={default:e[r].default,validate:e[r].validate};return{table:{content:"table_row+",tableRole:"table",isolating:!0,group:t.tableGroup,parseDOM:[{tag:"table"}],toDOM(){return["table",["tbody",0]]}},table_row:{content:"(table_cell | table_header)*",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM(){return["tr",0]}},table_cell:{content:t.cellContent,attrs:n,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs:r=>ug(r,e)}],toDOM(r){return["td",dg(r,e),0]}},table_header:{content:t.cellContent,attrs:n,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs:r=>ug(r,e)}],toDOM(r){return["th",dg(r,e),0]}}}}function on(t){let e=t.cached.tableNodeTypes;if(!e){e=t.cached.tableNodeTypes={};for(const n in t.nodes){const r=t.nodes[n],o=r.spec.tableRole;o&&(e[o]=r)}}return e}var pr=new mt("selectingCells");function aa(t){for(let e=t.depth-1;e>0;e--)if(t.node(e).type.spec.tableRole=="row")return t.node(0).resolve(t.before(e+1));return null}function ln(t){const e=t.selection.$head;for(let n=e.depth;n>0;n--)if(e.node(n).type.spec.tableRole=="row")return!0;return!1}function _c(t){const e=t.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&e.node.type.spec.tableRole=="cell")return e.$anchor;const n=aa(e.$head)||AA(e.$head);if(n)return n;throw new RangeError("No cell found around position ".concat(e.head))}function AA(t){for(let e=t.nodeAfter,n=t.pos;e;e=e.firstChild,n++){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return t.doc.resolve(n)}for(let e=t.nodeBefore,n=t.pos;e;e=e.lastChild,n--){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return t.doc.resolve(n-e.nodeSize)}}function Ed(t){return t.parent.type.spec.tableRole=="row"&&!!t.nodeAfter}function RA(t){return t.node(0).resolve(t.pos+t.nodeAfter.nodeSize)}function kh(t,e){return t.depth==e.depth&&t.pos>=e.start(-1)&&t.pos<=e.end(-1)}function H0(t,e,n){const r=t.node(-1),o=Me.get(r),s=t.start(-1),i=o.nextCell(t.pos-s,e,n);return i==null?null:t.node(0).resolve(s+i)}function ko(t,e,n=1){const r={...t,colspan:t.colspan-n};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,n),r.colwidth.some(o=>o>0)||(r.colwidth=null)),r}function IA(t,e,n=1){const r={...t,colspan:t.colspan+n};if(r.colwidth){r.colwidth=r.colwidth.slice();for(let o=0;o<n;o++)r.colwidth.splice(e,0,0)}return r}function PA(t,e,n){const r=on(e.type.schema).header_cell;for(let o=0;o<t.height;o++)if(e.nodeAt(t.map[n+o*t.width]).type!=r)return!1;return!0}var Be=class Pn extends pe{constructor(e,n=e){const r=e.node(-1),o=Me.get(r),s=e.start(-1),i=o.rectBetween(e.pos-s,n.pos-s),a=e.node(0),l=o.cellsInRect(i).filter(u=>u!=n.pos-s);l.unshift(n.pos-s);const c=l.map(u=>{const d=r.nodeAt(u);if(!d)throw RangeError("No cell with offset ".concat(u," found"));const f=s+u+1;return new wl(a.resolve(f),a.resolve(f+d.content.size))});super(c[0].$from,c[0].$to,c),this.$anchorCell=e,this.$headCell=n}map(e,n){const r=e.resolve(n.map(this.$anchorCell.pos)),o=e.resolve(n.map(this.$headCell.pos));if(Ed(r)&&Ed(o)&&kh(r,o)){const s=this.$anchorCell.node(-1)!=r.node(-1);return s&&this.isRowSelection()?Pn.rowSelection(r,o):s&&this.isColSelection()?Pn.colSelection(r,o):new Pn(r,o)}return he.between(r,o)}content(){const e=this.$anchorCell.node(-1),n=Me.get(e),r=this.$anchorCell.start(-1),o=n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),s={},i=[];for(let l=o.top;l<o.bottom;l++){const c=[];for(let u=l*n.width+o.left,d=o.left;d<o.right;d++,u++){const f=n.map[u];if(s[f])continue;s[f]=!0;const p=n.findCell(f);let h=e.nodeAt(f);if(!h)throw RangeError("No cell with offset ".concat(f," found"));const v=o.left-p.left,y=p.right-o.right;if(v>0||y>0){let w=h.attrs;if(v>0&&(w=ko(w,0,v)),y>0&&(w=ko(w,w.colspan-y,y)),p.left<o.left){if(h=h.type.createAndFill(w),!h)throw RangeError("Could not create cell with attrs ".concat(JSON.stringify(w)))}else h=h.type.create(w,h.content)}if(p.top<o.top||p.bottom>o.bottom){const w={...h.attrs,rowspan:Math.min(p.bottom,o.bottom)-Math.max(p.top,o.top)};p.top<o.top?h=h.type.createAndFill(w):h=h.type.create(w,h.content)}c.push(h)}i.push(e.child(l).copy(V.from(c)))}const a=this.isColSelection()&&this.isRowSelection()?e:i;return new J(V.from(a),1,1)}replace(e,n=J.empty){const r=e.steps.length,o=this.ranges;for(let i=0;i<o.length;i++){const{$from:a,$to:l}=o[i],c=e.mapping.slice(r);e.replace(c.map(a.pos),c.map(l.pos),i?J.empty:n)}const s=pe.findFrom(e.doc.resolve(e.mapping.slice(r).map(this.to)),-1);s&&e.setSelection(s)}replaceWith(e,n){this.replace(e,new J(V.from(n),0,0))}forEachCell(e){const n=this.$anchorCell.node(-1),r=Me.get(n),o=this.$anchorCell.start(-1),s=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-o,this.$headCell.pos-o));for(let i=0;i<s.length;i++)e(n.nodeAt(s[i]),o+s[i])}isColSelection(){const e=this.$anchorCell.index(-1),n=this.$headCell.index(-1);if(Math.min(e,n)>0)return!1;const r=e+this.$anchorCell.nodeAfter.attrs.rowspan,o=n+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,o)==this.$headCell.node(-1).childCount}static colSelection(e,n=e){const r=e.node(-1),o=Me.get(r),s=e.start(-1),i=o.findCell(e.pos-s),a=o.findCell(n.pos-s),l=e.node(0);return i.top<=a.top?(i.top>0&&(e=l.resolve(s+o.map[i.left])),a.bottom<o.height&&(n=l.resolve(s+o.map[o.width*(o.height-1)+a.right-1]))):(a.top>0&&(n=l.resolve(s+o.map[a.left])),i.bottom<o.height&&(e=l.resolve(s+o.map[o.width*(o.height-1)+i.right-1]))),new Pn(e,n)}isRowSelection(){const e=this.$anchorCell.node(-1),n=Me.get(e),r=this.$anchorCell.start(-1),o=n.colCount(this.$anchorCell.pos-r),s=n.colCount(this.$headCell.pos-r);if(Math.min(o,s)>0)return!1;const i=o+this.$anchorCell.nodeAfter.attrs.colspan,a=s+this.$headCell.nodeAfter.attrs.colspan;return Math.max(i,a)==n.width}eq(e){return e instanceof Pn&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,n=e){const r=e.node(-1),o=Me.get(r),s=e.start(-1),i=o.findCell(e.pos-s),a=o.findCell(n.pos-s),l=e.node(0);return i.left<=a.left?(i.left>0&&(e=l.resolve(s+o.map[i.top*o.width])),a.right<o.width&&(n=l.resolve(s+o.map[o.width*(a.top+1)-1]))):(a.left>0&&(n=l.resolve(s+o.map[a.top*o.width])),i.right<o.width&&(e=l.resolve(s+o.map[o.width*(i.top+1)-1]))),new Pn(e,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,n){return new Pn(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){return new Pn(e.resolve(n),e.resolve(r))}getBookmark(){return new LA(this.$anchorCell.pos,this.$headCell.pos)}};Be.prototype.visible=!1;pe.jsonID("cell",Be);var LA=class q0{constructor(e,n){this.anchor=e,this.head=n}map(e){return new q0(e.map(this.anchor),e.map(this.head))}resolve(e){const n=e.resolve(this.anchor),r=e.resolve(this.head);return n.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&n.index()<n.parent.childCount&&r.index()<r.parent.childCount&&kh(n,r)?new Be(n,r):pe.near(r,1)}};function zA(t){if(!(t.selection instanceof Be))return null;const e=[];return t.selection.forEachCell((n,r)=>{e.push(ht.node(r,r+n.nodeSize,{class:"selectedCell"}))}),Ie.create(t.doc,e)}function BA({$from:t,$to:e}){if(t.pos==e.pos||t.pos<e.pos-6)return!1;let n=t.pos,r=e.pos,o=t.depth;for(;o>=0&&!(t.after(o+1)<t.end(o));o--,n++);for(let s=e.depth;s>=0&&!(e.before(s+1)>e.start(s));s--,r--);return n==r&&/row|table/.test(t.node(o).type.spec.tableRole)}function FA({$from:t,$to:e}){let n,r;for(let o=t.depth;o>0;o--){const s=t.node(o);if(s.type.spec.tableRole==="cell"||s.type.spec.tableRole==="header_cell"){n=s;break}}for(let o=e.depth;o>0;o--){const s=e.node(o);if(s.type.spec.tableRole==="cell"||s.type.spec.tableRole==="header_cell"){r=s;break}}return n!==r&&e.parentOffset===0}function VA(t,e,n){const r=(e||t).selection,o=(e||t).doc;let s,i;if(r instanceof fe&&(i=r.node.type.spec.tableRole)){if(i=="cell"||i=="header_cell")s=Be.create(o,r.from);else if(i=="row"){const a=o.resolve(r.from+1);s=Be.rowSelection(a,a)}else if(!n){const a=Me.get(r.node),l=r.from+1,c=l+a.map[a.width*a.height-1];s=Be.create(o,l+1,c)}}else r instanceof he&&BA(r)?s=he.create(o,r.from):r instanceof he&&FA(r)&&(s=he.create(o,r.$from.start(),r.$from.end()));return s&&(e||(e=t.tr)).setSelection(s),e}var HA=new mt("fix-tables");function U0(t,e,n,r){const o=t.childCount,s=e.childCount;e:for(let i=0,a=0;i<s;i++){const l=e.child(i);for(let c=a,u=Math.min(o,i+3);c<u;c++)if(t.child(c)==l){a=c+1,n+=l.nodeSize;continue e}r(l,n),a<o&&t.child(a).sameMarkup(l)?U0(t.child(a),l,n+1,r):l.nodesBetween(0,l.content.size,r,n+1),n+=l.nodeSize}}function qA(t,e){let n;const r=(o,s)=>{o.type.spec.tableRole=="table"&&(n=UA(t,o,s,n))};return e?e.doc!=t.doc&&U0(e.doc,t.doc,0,r):t.doc.descendants(r),n}function UA(t,e,n,r){const o=Me.get(e);if(!o.problems)return r;r||(r=t.tr);const s=[];for(let l=0;l<o.height;l++)s.push(0);for(let l=0;l<o.problems.length;l++){const c=o.problems[l];if(c.type=="collision"){const u=e.nodeAt(c.pos);if(!u)continue;const d=u.attrs;for(let f=0;f<d.rowspan;f++)s[c.row+f]+=c.n;r.setNodeMarkup(r.mapping.map(n+1+c.pos),null,ko(d,d.colspan-c.n,c.n))}else if(c.type=="missing")s[c.row]+=c.n;else if(c.type=="overlong_rowspan"){const u=e.nodeAt(c.pos);if(!u)continue;r.setNodeMarkup(r.mapping.map(n+1+c.pos),null,{...u.attrs,rowspan:u.attrs.rowspan-c.n})}else if(c.type=="colwidth mismatch"){const u=e.nodeAt(c.pos);if(!u)continue;r.setNodeMarkup(r.mapping.map(n+1+c.pos),null,{...u.attrs,colwidth:c.colwidth})}else if(c.type=="zero_sized"){const u=r.mapping.map(n);r.delete(u,u+e.nodeSize)}}let i,a;for(let l=0;l<s.length;l++)s[l]&&(i==null&&(i=l),a=l);for(let l=0,c=n+1;l<o.height;l++){const u=e.child(l),d=c+u.nodeSize,f=s[l];if(f>0){let p="cell";u.firstChild&&(p=u.firstChild.type.spec.tableRole);const h=[];for(let y=0;y<f;y++){const w=on(t.schema)[p].createAndFill();w&&h.push(w)}const v=(l==0||i==l-1)&&a==l?c+1:d-1;r.insert(r.mapping.map(v),h)}c=d}return r.setMeta(HA,{fixTables:!0})}function W0(t){const e=Me.get(t),n=[],r=e.height,o=e.width;for(let s=0;s<r;s++){const i=[];for(let a=0;a<o;a++){const l=s*o+a,c=e.map[l];if(s>0){const u=l-o,d=e.map[u];if(c===d){i.push(null);continue}}if(a>0){const u=l-1,d=e.map[u];if(c===d){i.push(null);continue}}i.push(t.nodeAt(c))}n.push(i)}return n}function j0(t,e){const n=[],r=Me.get(t),o=r.height,s=r.width;for(let a=0;a<o;a++){const l=t.child(a),c=[];for(let d=0;d<s;d++){const f=e[a][d];if(!f)continue;const p=r.map[a*r.width+d],h=t.nodeAt(p);if(!h)continue;const v=h.type.createChecked(f.attrs,f.content,f.marks);c.push(v)}const u=l.type.createChecked(l.attrs,c,l.marks);n.push(u)}return t.type.createChecked(t.attrs,n,t.marks)}function Mo(t){return WA(e=>e.type.spec.tableRole==="table",t)}function WA(t,e){for(let n=e.depth;n>=0;n-=1){const r=e.node(n);if(t(r)){const o=n===0?0:e.before(n),s=e.start(n);return{node:r,pos:o,start:s,depth:n}}}return null}function Bo(t,e){const n=Mo(e.$from);if(!n)return;const r=Me.get(n.node);return t<0||t>r.width-1?void 0:r.cellsInRect({left:t,right:t+1,top:0,bottom:r.height}).map(s=>{const i=n.node.nodeAt(s),a=s+n.start;return{pos:a,start:a+1,node:i,depth:n.depth+2}})}function Fo(t,e){const n=Mo(e.$from);if(!n)return;const r=Me.get(n.node);return t<0||t>r.height-1?void 0:r.cellsInRect({left:0,right:r.width,top:t,bottom:t+1}).map(s=>{const i=n.node.nodeAt(s),a=s+n.start;return{pos:a,start:a+1,node:i,depth:n.depth+2}})}function fg(t,e,n=e){let r=e,o=n;for(let d=e;d>=0;d--){const f=Bo(d,t.selection);f&&f.forEach(p=>{const h=p.node.attrs.colspan+d-1;h>=r&&(r=d),h>o&&(o=h)})}for(let d=e;d<=o;d++){const f=Bo(d,t.selection);f&&f.forEach(p=>{const h=p.node.attrs.colspan+d-1;p.node.attrs.colspan>1&&h>o&&(o=h)})}const s=[];for(let d=r;d<=o;d++){const f=Bo(d,t.selection);f&&f.length>0&&s.push(d)}r=s[0],o=s[s.length-1];const i=Bo(r,t.selection),a=Fo(0,t.selection);if(!i||!a)return;const l=t.doc.resolve(i[i.length-1].pos);let c;for(let d=o;d>=r;d--){const f=Bo(d,t.selection);if(f&&f.length>0){for(let p=a.length-1;p>=0;p--)if(a[p].pos===f[0].pos){c=f[0];break}if(c)break}}if(!c)return;const u=t.doc.resolve(c.pos);return{$anchor:l,$head:u,indexes:s}}function hg(t,e,n=e){let r=e,o=n;for(let d=e;d>=0;d--){const f=Fo(d,t.selection);f&&f.forEach(p=>{const h=p.node.attrs.rowspan+d-1;h>=r&&(r=d),h>o&&(o=h)})}for(let d=e;d<=o;d++){const f=Fo(d,t.selection);f&&f.forEach(p=>{const h=p.node.attrs.rowspan+d-1;p.node.attrs.rowspan>1&&h>o&&(o=h)})}const s=[];for(let d=r;d<=o;d++){const f=Fo(d,t.selection);f&&f.length>0&&s.push(d)}r=s[0],o=s[s.length-1];const i=Fo(r,t.selection),a=Bo(0,t.selection);if(!i||!a)return;const l=t.doc.resolve(i[i.length-1].pos);let c;for(let d=o;d>=r;d--){const f=Fo(d,t.selection);if(f&&f.length>0){for(let p=a.length-1;p>=0;p--)if(a[p].pos===f[0].pos){c=f[0];break}if(c)break}}if(!c)return;const u=t.doc.resolve(c.pos);return{$anchor:l,$head:u,indexes:s}}function K0(t,e,n,r){const o=e[0]>n[0]?-1:1,s=t.splice(e[0],e.length),i=s.length%2===0?1:0;let a;return r===-1&&o===1?a=n[0]-1:r===1&&o===-1?a=n[n.length-1]-i+1:a=o===-1?n[0]:n[n.length-1]-i,t.splice(a,0,...s),t}function pg(t){return t[0].map((e,n)=>t.map(r=>r[n]))}function jA(t){var e,n;const{tr:r,originIndex:o,targetIndex:s,select:i,pos:a}=t,l=r.doc.resolve(a),c=Mo(l);if(!c)return!1;const u=(e=fg(r,o))==null?void 0:e.indexes,d=(n=fg(r,s))==null?void 0:n.indexes;if(!u||!d||u.includes(s))return!1;const f=KA(c.node,u,d,0);if(r.replaceWith(c.pos,c.pos+c.node.nodeSize,f),!i)return!0;const p=Me.get(f),h=c.start,v=s,y=p.positionAt(p.height-1,v,f),w=r.doc.resolve(h+y),x=p.positionAt(0,v,f),$=r.doc.resolve(h+x);return r.setSelection(Be.colSelection(w,$)),!0}function KA(t,e,n,r){let o=pg(W0(t));return o=K0(o,e,n,r),o=pg(o),j0(t,o)}function YA(t){var e,n;const{tr:r,originIndex:o,targetIndex:s,select:i,pos:a}=t,l=r.doc.resolve(a),c=Mo(l);if(!c)return!1;const u=(e=hg(r,o))==null?void 0:e.indexes,d=(n=hg(r,s))==null?void 0:n.indexes;if(!u||!d||u.includes(s))return!1;const f=GA(c.node,u,d,0);if(r.replaceWith(c.pos,c.pos+c.node.nodeSize,f),!i)return!0;const p=Me.get(f),h=c.start,v=s,y=p.positionAt(v,p.width-1,f),w=r.doc.resolve(h+y),x=p.positionAt(v,0,f),$=r.doc.resolve(h+x);return r.setSelection(Be.rowSelection(w,$)),!0}function GA(t,e,n,r){let o=W0(t);return o=K0(o,e,n,r),j0(t,o)}function zr(t){const e=t.selection,n=_c(t),r=n.node(-1),o=n.start(-1),s=Me.get(r);return{...e instanceof Be?s.rectBetween(e.$anchorCell.pos-o,e.$headCell.pos-o):s.findCell(n.pos-o),tableStart:o,map:s,table:r}}function Y0(t,{map:e,tableStart:n,table:r},o){let s=o>0?-1:0;PA(e,r,o+s)&&(s=o==0||o==e.width?null:0);for(let i=0;i<e.height;i++){const a=i*e.width+o;if(o>0&&o<e.width&&e.map[a-1]==e.map[a]){const l=e.map[a],c=r.nodeAt(l);t.setNodeMarkup(t.mapping.map(n+l),null,IA(c.attrs,o-e.colCount(l))),i+=c.attrs.rowspan-1}else{const l=s==null?on(r.type.schema).cell:r.nodeAt(e.map[a+s]).type,c=e.positionAt(i,o,r);t.insert(t.mapping.map(n+c),l.createAndFill())}}return t}function JA(t,e){if(!ln(t))return!1;if(e){const n=zr(t);e(Y0(t.tr,n,n.left))}return!0}function XA(t,e){if(!ln(t))return!1;if(e){const n=zr(t);e(Y0(t.tr,n,n.right))}return!0}function ZA(t,{map:e,table:n,tableStart:r},o){const s=t.mapping.maps.length;for(let i=0;i<e.height;){const a=i*e.width+o,l=e.map[a],c=n.nodeAt(l),u=c.attrs;if(o>0&&e.map[a-1]==l||o<e.width-1&&e.map[a+1]==l)t.setNodeMarkup(t.mapping.slice(s).map(r+l),null,ko(u,o-e.colCount(l)));else{const d=t.mapping.slice(s).map(r+l);t.delete(d,d+c.nodeSize)}i+=u.rowspan}}function QA(t,e){if(!ln(t))return!1;if(e){const n=zr(t),r=t.tr;if(n.left==0&&n.right==n.map.width)return!1;for(let o=n.right-1;ZA(r,n,o),o!=n.left;o--){const s=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!s)throw RangeError("No table found");n.table=s,n.map=Me.get(s)}e(r)}return!0}function eR(t,{map:e,table:n,tableStart:r},o){let s=0;for(let c=0;c<o;c++)s+=n.child(c).nodeSize;const i=s+n.child(o).nodeSize,a=t.mapping.maps.length;t.delete(s+r,i+r);const l=new Set;for(let c=0,u=o*e.width;c<e.width;c++,u++){const d=e.map[u];if(!l.has(d)){if(l.add(d),o>0&&d==e.map[u-e.width]){const f=n.nodeAt(d).attrs;t.setNodeMarkup(t.mapping.slice(a).map(d+r),null,{...f,rowspan:f.rowspan-1}),c+=f.colspan-1}else if(o<e.height&&d==e.map[u+e.width]){const f=n.nodeAt(d),p=f.attrs,h=f.type.create({...p,rowspan:f.attrs.rowspan-1},f.content),v=e.positionAt(o+1,c,n);t.insert(t.mapping.slice(a).map(r+v),h),c+=p.colspan-1}}}}function tR(t,e){if(!ln(t))return!1;if(e){const n=zr(t),r=t.tr;if(n.top==0&&n.bottom==n.map.height)return!1;for(let o=n.bottom-1;eR(r,n,o),o!=n.top;o--){const s=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!s)throw RangeError("No table found");n.table=s,n.map=Me.get(n.table)}e(r)}return!0}function nR(t,e){return function(n,r){if(!ln(n))return!1;const o=_c(n);if(o.nodeAfter.attrs[t]===e)return!1;if(r){const s=n.tr;n.selection instanceof Be?n.selection.forEachCell((i,a)=>{i.attrs[t]!==e&&s.setNodeMarkup(a,null,{...i.attrs,[t]:e})}):s.setNodeMarkup(o.pos,null,{...o.nodeAfter.attrs,[t]:e}),r(s)}return!0}}function rR(t){return function(e,n){if(!ln(e))return!1;if(n){const r=on(e.schema),o=zr(e),s=e.tr,i=o.map.cellsInRect(t=="column"?{left:o.left,top:0,right:o.right,bottom:o.map.height}:t=="row"?{left:0,top:o.top,right:o.map.width,bottom:o.bottom}:o),a=i.map(l=>o.table.nodeAt(l));for(let l=0;l<i.length;l++)a[l].type==r.header_cell&&s.setNodeMarkup(o.tableStart+i[l],r.cell,a[l].attrs);if(s.steps.length==0)for(let l=0;l<i.length;l++)s.setNodeMarkup(o.tableStart+i[l],r.header_cell,a[l].attrs);n(s)}return!0}}function mg(t,e,n){const r=e.map.cellsInRect({left:0,top:0,right:t=="row"?e.map.width:1,bottom:t=="column"?e.map.height:1});for(let o=0;o<r.length;o++){const s=e.table.nodeAt(r[o]);if(s&&s.type!==n.header_cell)return!1}return!0}function Ch(t,e){return e=e||{useDeprecatedLogic:!1},e.useDeprecatedLogic?rR(t):function(n,r){if(!ln(n))return!1;if(r){const o=on(n.schema),s=zr(n),i=n.tr,a=mg("row",s,o),l=mg("column",s,o),u=(t==="column"?a:t==="row"?l:!1)?1:0,d=t=="column"?{left:0,top:u,right:1,bottom:s.map.height}:t=="row"?{left:u,top:0,right:s.map.width,bottom:1}:s,f=t=="column"?l?o.cell:o.header_cell:t=="row"?a?o.cell:o.header_cell:o.cell;s.map.cellsInRect(d).forEach(p=>{const h=p+s.tableStart,v=i.doc.nodeAt(h);v&&i.setNodeMarkup(h,f,v.attrs)}),r(i)}return!0}}Ch("row",{useDeprecatedLogic:!0});Ch("column",{useDeprecatedLogic:!0});Ch("cell",{useDeprecatedLogic:!0});function oR(t,e){if(e<0){const n=t.nodeBefore;if(n)return t.pos-n.nodeSize;for(let r=t.index(-1)-1,o=t.before();r>=0;r--){const s=t.node(-1).child(r),i=s.lastChild;if(i)return o-1-i.nodeSize;o-=s.nodeSize}}else{if(t.index()<t.parent.childCount-1)return t.pos+t.nodeAfter.nodeSize;const n=t.node(-1);for(let r=t.indexAfter(-1),o=t.after();r<n.childCount;r++){const s=n.child(r);if(s.childCount)return o+1;o+=s.nodeSize}}return null}function G0(t){return function(e,n){if(!ln(e))return!1;const r=oR(_c(e),t);if(r==null)return!1;if(n){const o=e.doc.resolve(r);n(e.tr.setSelection(he.between(o,RA(o))).scrollIntoView())}return!0}}function sR(t,e){const n=t.selection.$anchor;for(let r=n.depth;r>0;r--)if(n.node(r).type.spec.tableRole=="table")return e&&e(t.tr.delete(n.before(r),n.after(r)).scrollIntoView()),!0;return!1}function _a(t,e){const n=t.selection;if(!(n instanceof Be))return!1;if(e){const r=t.tr,o=on(t.schema).cell.createAndFill().content;n.forEachCell((s,i)=>{s.content.eq(o)||r.replace(r.mapping.map(i+1),r.mapping.map(i+s.nodeSize-1),new J(o,0,0))}),r.docChanged&&e(r)}return!0}function iR(t){return(e,n)=>{const{from:r,to:o,select:s=!0,pos:i=e.selection.from}=t,a=e.tr;return YA({tr:a,originIndex:r,targetIndex:o,select:s,pos:i})?(n==null||n(a),!0):!1}}function aR(t){return(e,n)=>{const{from:r,to:o,select:s=!0,pos:i=e.selection.from}=t,a=e.tr;return jA({tr:a,originIndex:r,targetIndex:o,select:s,pos:i})?(n==null||n(a),!0):!1}}function lR(t){if(!t.size)return null;let{content:e,openStart:n,openEnd:r}=t;for(;e.childCount==1&&(n>0&&r>0||e.child(0).type.spec.tableRole=="table");)n--,r--,e=e.child(0).content;const o=e.child(0),s=o.type.spec.tableRole,i=o.type.schema,a=[];if(s=="row")for(let l=0;l<e.childCount;l++){let c=e.child(l).content;const u=l?0:Math.max(0,n-1),d=l<e.childCount-1?0:Math.max(0,r-1);(u||d)&&(c=Nd(on(i).row,new J(c,u,d)).content),a.push(c)}else if(s=="cell"||s=="header_cell")a.push(n||r?Nd(on(i).row,new J(e,n,r)).content:e);else return null;return cR(i,a)}function cR(t,e){const n=[];for(let o=0;o<e.length;o++){const s=e[o];for(let i=s.childCount-1;i>=0;i--){const{rowspan:a,colspan:l}=s.child(i).attrs;for(let c=o;c<o+a;c++)n[c]=(n[c]||0)+l}}let r=0;for(let o=0;o<n.length;o++)r=Math.max(r,n[o]);for(let o=0;o<n.length;o++)if(o>=e.length&&e.push(V.empty),n[o]<r){const s=on(t).cell.createAndFill(),i=[];for(let a=n[o];a<r;a++)i.push(s);e[o]=e[o].append(V.from(i))}return{height:e.length,width:r,rows:e}}function Nd(t,e){const n=t.createAndFill();return new Yv(n).replace(0,n.content.size,e).doc}function uR({width:t,height:e,rows:n},r,o){if(t!=r){const s=[],i=[];for(let a=0;a<n.length;a++){const l=n[a],c=[];for(let u=s[a]||0,d=0;u<r;d++){let f=l.child(d%l.childCount);u+f.attrs.colspan>r&&(f=f.type.createChecked(ko(f.attrs,f.attrs.colspan,u+f.attrs.colspan-r),f.content)),c.push(f),u+=f.attrs.colspan;for(let p=1;p<f.attrs.rowspan;p++)s[a+p]=(s[a+p]||0)+f.attrs.colspan}i.push(V.from(c))}n=i,t=r}if(e!=o){const s=[];for(let i=0,a=0;i<o;i++,a++){const l=[],c=n[a%e];for(let u=0;u<c.childCount;u++){let d=c.child(u);i+d.attrs.rowspan>o&&(d=d.type.create({...d.attrs,rowspan:Math.max(1,o-d.attrs.rowspan)},d.content)),l.push(d)}s.push(V.from(l))}n=s,e=o}return{width:t,height:e,rows:n}}function dR(t,e,n,r,o,s,i){const a=t.doc.type.schema,l=on(a);let c,u;if(o>e.width)for(let d=0,f=0;d<e.height;d++){const p=n.child(d);f+=p.nodeSize;const h=[];let v;p.lastChild==null||p.lastChild.type==l.cell?v=c||(c=l.cell.createAndFill()):v=u||(u=l.header_cell.createAndFill());for(let y=e.width;y<o;y++)h.push(v);t.insert(t.mapping.slice(i).map(f-1+r),h)}if(s>e.height){const d=[];for(let h=0,v=(e.height-1)*e.width;h<Math.max(e.width,o);h++){const y=h>=e.width?!1:n.nodeAt(e.map[v+h]).type==l.header_cell;d.push(y?u||(u=l.header_cell.createAndFill()):c||(c=l.cell.createAndFill()))}const f=l.row.create(null,V.from(d)),p=[];for(let h=e.height;h<s;h++)p.push(f);t.insert(t.mapping.slice(i).map(r+n.nodeSize-2),p)}return!!(c||u)}function gg(t,e,n,r,o,s,i,a){if(i==0||i==e.height)return!1;let l=!1;for(let c=o;c<s;c++){const u=i*e.width+c,d=e.map[u];if(e.map[u-e.width]==d){l=!0;const f=n.nodeAt(d),{top:p,left:h}=e.findCell(d);t.setNodeMarkup(t.mapping.slice(a).map(d+r),null,{...f.attrs,rowspan:i-p}),t.insert(t.mapping.slice(a).map(e.positionAt(i,h,n)),f.type.createAndFill({...f.attrs,rowspan:p+f.attrs.rowspan-i})),c+=f.attrs.colspan-1}}return l}function vg(t,e,n,r,o,s,i,a){if(i==0||i==e.width)return!1;let l=!1;for(let c=o;c<s;c++){const u=c*e.width+i,d=e.map[u];if(e.map[u-1]==d){l=!0;const f=n.nodeAt(d),p=e.colCount(d),h=t.mapping.slice(a).map(d+r);t.setNodeMarkup(h,null,ko(f.attrs,i-p,f.attrs.colspan-(i-p))),t.insert(h+f.nodeSize,f.type.createAndFill(ko(f.attrs,0,i-p))),c+=f.attrs.rowspan-1}}return l}function yg(t,e,n,r,o){let s=n?t.doc.nodeAt(n-1):t.doc;if(!s)throw new Error("No table found");let i=Me.get(s);const{top:a,left:l}=r,c=l+o.width,u=a+o.height,d=t.tr;let f=0;function p(){if(s=n?d.doc.nodeAt(n-1):d.doc,!s)throw new Error("No table found");i=Me.get(s),f=d.mapping.maps.length}dR(d,i,s,n,c,u,f)&&p(),gg(d,i,s,n,l,c,a,f)&&p(),gg(d,i,s,n,l,c,u,f)&&p(),vg(d,i,s,n,a,u,l,f)&&p(),vg(d,i,s,n,a,u,c,f)&&p();for(let h=a;h<u;h++){const v=i.positionAt(h,l,s),y=i.positionAt(h,c,s);d.replace(d.mapping.slice(f).map(v+n),d.mapping.slice(f).map(y+n),new J(o.rows[h-a],0,0))}p(),d.setSelection(new Be(d.doc.resolve(n+i.positionAt(a,l,s)),d.doc.resolve(n+i.positionAt(u-1,c-1,s)))),e(d)}var fR=Xy({ArrowLeft:Ta("horiz",-1),ArrowRight:Ta("horiz",1),ArrowUp:Ta("vert",-1),ArrowDown:Ta("vert",1),"Shift-ArrowLeft":$a("horiz",-1),"Shift-ArrowRight":$a("horiz",1),"Shift-ArrowUp":$a("vert",-1),"Shift-ArrowDown":$a("vert",1),Backspace:_a,"Mod-Backspace":_a,Delete:_a,"Mod-Delete":_a});function el(t,e,n){return n.eq(t.selection)?!1:(e&&e(t.tr.setSelection(n).scrollIntoView()),!0)}function Ta(t,e){return(n,r,o)=>{if(!o)return!1;const s=n.selection;if(s instanceof Be)return el(n,r,pe.near(s.$headCell,e));if(t!="horiz"&&!s.empty)return!1;const i=J0(o,t,e);if(i==null)return!1;if(t=="horiz")return el(n,r,pe.near(n.doc.resolve(s.head+e),e));{const a=n.doc.resolve(i),l=H0(a,t,e);let c;return l?c=pe.near(l,1):e<0?c=pe.near(n.doc.resolve(a.before(-1)),-1):c=pe.near(n.doc.resolve(a.after(-1)),1),el(n,r,c)}}}function $a(t,e){return(n,r,o)=>{if(!o)return!1;const s=n.selection;let i;if(s instanceof Be)i=s;else{const l=J0(o,t,e);if(l==null)return!1;i=new Be(n.doc.resolve(l))}const a=H0(i.$headCell,t,e);return a?el(n,r,new Be(i.$anchorCell,a)):!1}}function hR(t,e){const n=t.state.doc,r=aa(n.resolve(e));return r?(t.dispatch(t.state.tr.setSelection(new Be(r))),!0):!1}function pR(t,e,n){if(!ln(t.state))return!1;let r=lR(n);const o=t.state.selection;if(o instanceof Be){r||(r={width:1,height:1,rows:[V.from(Nd(on(t.state.schema).cell,n))]});const s=o.$anchorCell.node(-1),i=o.$anchorCell.start(-1),a=Me.get(s).rectBetween(o.$anchorCell.pos-i,o.$headCell.pos-i);return r=uR(r,a.right-a.left,a.bottom-a.top),yg(t.state,t.dispatch,i,a,r),!0}else if(r){const s=_c(t.state),i=s.start(-1);return yg(t.state,t.dispatch,i,Me.get(s.node(-1)).findCell(s.pos-i),r),!0}else return!1}function mR(t,e){var n;if(e.ctrlKey||e.metaKey)return;const r=bg(t,e.target);let o;if(e.shiftKey&&t.state.selection instanceof Be)s(t.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&r&&(o=aa(t.state.selection.$anchor))!=null&&((n=xu(t,e))==null?void 0:n.pos)!=o.pos)s(o,e),e.preventDefault();else if(!r)return;function s(l,c){let u=xu(t,c);const d=pr.getState(t.state)==null;if(!u||!kh(l,u))if(d)u=l;else return;const f=new Be(l,u);if(d||!t.state.selection.eq(f)){const p=t.state.tr.setSelection(f);d&&p.setMeta(pr,l.pos),t.dispatch(p)}}function i(){t.root.removeEventListener("mouseup",i),t.root.removeEventListener("dragstart",i),t.root.removeEventListener("mousemove",a),pr.getState(t.state)!=null&&t.dispatch(t.state.tr.setMeta(pr,-1))}function a(l){const c=l,u=pr.getState(t.state);let d;if(u!=null)d=t.state.doc.resolve(u);else if(bg(t,c.target)!=r&&(d=xu(t,e),!d))return i();d&&s(d,c)}t.root.addEventListener("mouseup",i),t.root.addEventListener("dragstart",i),t.root.addEventListener("mousemove",a)}function J0(t,e,n){if(!(t.state.selection instanceof he))return null;const{$head:r}=t.state.selection;for(let o=r.depth-1;o>=0;o--){const s=r.node(o);if((n<0?r.index(o):r.indexAfter(o))!=(n<0?0:s.childCount))return null;if(s.type.spec.tableRole=="cell"||s.type.spec.tableRole=="header_cell"){const a=r.before(o),l=e=="vert"?n>0?"down":"up":n>0?"right":"left";return t.endOfTextblock(l)?a:null}}return null}function bg(t,e){for(;e&&e!=t.dom;e=e.parentNode)if(e.nodeName=="TD"||e.nodeName=="TH")return e;return null}function xu(t,e){const n=t.posAtCoords({left:e.clientX,top:e.clientY});return n&&n?aa(t.state.doc.resolve(n.pos)):null}var X0=class{constructor(e,n){this.node=e,this.defaultCellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width","".concat(n,"px")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Dd(e,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!=this.node.type?!1:(this.node=e,Dd(e,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(e){return e.type=="attributes"&&(e.target==this.table||this.colgroup.contains(e.target))}};function Dd(t,e,n,r,o,s){var i;let a=0,l=!0,c=e.firstChild;const u=t.firstChild;if(u){for(let d=0,f=0;d<u.childCount;d++){const{colspan:p,colwidth:h}=u.child(d).attrs;for(let v=0;v<p;v++,f++){const y=o==f?s:h&&h[v],w=y?y+"px":"";if(a+=y||r,y||(l=!1),c)c.style.width!=w&&(c.style.width=w),c=c.nextSibling;else{const x=document.createElement("col");x.style.width=w,e.appendChild(x)}}}for(;c;){const d=c.nextSibling;(i=c.parentNode)==null||i.removeChild(c),c=d}l?(n.style.width=a+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=a+"px")}}var Ht=new mt("tableColumnResizing");function Z0({handleWidth:t=5,cellMinWidth:e=25,defaultCellMinWidth:n=100,View:r=X0,lastColumnResizable:o=!0}={}){const s=new wt({key:Ht,state:{init(i,a){var l,c;const u=(c=(l=s.spec)==null?void 0:l.props)==null?void 0:c.nodeViews,d=on(a.schema).table.name;return r&&u&&(u[d]=(f,p)=>new r(f,n,p)),new gR(-1,!1)},apply(i,a){return a.apply(i)}},props:{attributes:i=>{const a=Ht.getState(i);return a&&a.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(i,a)=>{vR(i,a,t,o)},mouseleave:i=>{yR(i)},mousedown:(i,a)=>{bR(i,a,e,n)}},decorations:i=>{const a=Ht.getState(i);if(a&&a.activeHandle>-1)return SR(i,a.activeHandle)},nodeViews:{}}});return s}var gR=class tl{constructor(e,n){this.activeHandle=e,this.dragging=n}apply(e){const n=this,r=e.getMeta(Ht);if(r&&r.setHandle!=null)return new tl(r.setHandle,!1);if(r&&r.setDragging!==void 0)return new tl(n.activeHandle,r.setDragging);if(n.activeHandle>-1&&e.docChanged){let o=e.mapping.map(n.activeHandle,-1);return Ed(e.doc.resolve(o))||(o=-1),new tl(o,n.dragging)}return n}};function vR(t,e,n,r){if(!t.editable)return;const o=Ht.getState(t.state);if(o&&!o.dragging){const s=kR(e.target);let i=-1;if(s){const{left:a,right:l}=s.getBoundingClientRect();e.clientX-a<=n?i=wg(t,e,"left",n):l-e.clientX<=n&&(i=wg(t,e,"right",n))}if(i!=o.activeHandle){if(!r&&i!==-1){const a=t.state.doc.resolve(i),l=a.node(-1),c=Me.get(l),u=a.start(-1);if(c.colCount(a.pos-u)+a.nodeAfter.attrs.colspan-1==c.width-1)return}Q0(t,i)}}}function yR(t){if(!t.editable)return;const e=Ht.getState(t.state);e&&e.activeHandle>-1&&!e.dragging&&Q0(t,-1)}function bR(t,e,n,r){var o;if(!t.editable)return!1;const s=(o=t.dom.ownerDocument.defaultView)!=null?o:window,i=Ht.getState(t.state);if(!i||i.activeHandle==-1||i.dragging)return!1;const a=t.state.doc.nodeAt(i.activeHandle),l=wR(t,i.activeHandle,a.attrs);t.dispatch(t.state.tr.setMeta(Ht,{setDragging:{startX:e.clientX,startWidth:l}}));function c(d){s.removeEventListener("mouseup",c),s.removeEventListener("mousemove",u);const f=Ht.getState(t.state);f!=null&&f.dragging&&(CR(t,f.activeHandle,kg(f.dragging,d,n)),t.dispatch(t.state.tr.setMeta(Ht,{setDragging:null})))}function u(d){if(!d.which)return c(d);const f=Ht.getState(t.state);if(f&&f.dragging){const p=kg(f.dragging,d,n);Cg(t,f.activeHandle,p,r)}}return Cg(t,i.activeHandle,l,r),s.addEventListener("mouseup",c),s.addEventListener("mousemove",u),e.preventDefault(),!0}function wR(t,e,{colspan:n,colwidth:r}){const o=r&&r[r.length-1];if(o)return o;const s=t.domAtPos(e);let a=s.node.childNodes[s.offset].offsetWidth,l=n;if(r)for(let c=0;c<n;c++)r[c]&&(a-=r[c],l--);return a/l}function kR(t){for(;t&&t.nodeName!="TD"&&t.nodeName!="TH";)t=t.classList&&t.classList.contains("ProseMirror")?null:t.parentNode;return t}function wg(t,e,n,r){const o=n=="right"?-r:r,s=t.posAtCoords({left:e.clientX+o,top:e.clientY});if(!s)return-1;const{pos:i}=s,a=aa(t.state.doc.resolve(i));if(!a)return-1;if(n=="right")return a.pos;const l=Me.get(a.node(-1)),c=a.start(-1),u=l.map.indexOf(a.pos-c);return u%l.width==0?-1:c+l.map[u-1]}function kg(t,e,n){const r=e.clientX-t.startX;return Math.max(n,t.startWidth+r)}function Q0(t,e){t.dispatch(t.state.tr.setMeta(Ht,{setHandle:e}))}function CR(t,e,n){const r=t.state.doc.resolve(e),o=r.node(-1),s=Me.get(o),i=r.start(-1),a=s.colCount(r.pos-i)+r.nodeAfter.attrs.colspan-1,l=t.state.tr;for(let c=0;c<s.height;c++){const u=c*s.width+a;if(c&&s.map[u]==s.map[u-s.width])continue;const d=s.map[u],f=o.nodeAt(d).attrs,p=f.colspan==1?0:a-s.colCount(d);if(f.colwidth&&f.colwidth[p]==n)continue;const h=f.colwidth?f.colwidth.slice():xR(f.colspan);h[p]=n,l.setNodeMarkup(i+d,null,{...f,colwidth:h})}l.docChanged&&t.dispatch(l)}function Cg(t,e,n,r){const o=t.state.doc.resolve(e),s=o.node(-1),i=o.start(-1),a=Me.get(s).colCount(o.pos-i)+o.nodeAfter.attrs.colspan-1;let l=t.domAtPos(o.start(-1)).node;for(;l&&l.nodeName!="TABLE";)l=l.parentNode;l&&Dd(s,l.firstChild,l,r,a,n)}function xR(t){return Array(t).fill(0)}function SR(t,e){var n;const r=[],o=t.doc.resolve(e),s=o.node(-1);if(!s)return Ie.empty;const i=Me.get(s),a=o.start(-1),l=i.colCount(o.pos-a)+o.nodeAfter.attrs.colspan-1;for(let c=0;c<i.height;c++){const u=l+c*i.width;if((l==i.width-1||i.map[u]!=i.map[u+1])&&(c==0||i.map[u]!=i.map[u-i.width])){const d=i.map[u],f=a+d+s.nodeAt(d).nodeSize-1,p=document.createElement("div");p.className="column-resize-handle",(n=Ht.getState(t))!=null&&n.dragging&&r.push(ht.node(a+d,a+d+s.nodeAt(d).nodeSize,{class:"column-resize-dragging"})),r.push(ht.widget(f,p))}}return Ie.create(t.doc,r)}function _R({allowTableNodeSelection:t=!1}={}){return new wt({key:pr,state:{init(){return null},apply(e,n){const r=e.getMeta(pr);if(r!=null)return r==-1?null:r;if(n==null||!e.docChanged)return n;const{deleted:o,pos:s}=e.mapping.mapResult(n);return o?null:s}},props:{decorations:zA,handleDOMEvents:{mousedown:mR},createSelectionBetween(e){return pr.getState(e.state)!=null?e.state.selection:null},handleTripleClick:hR,handleKeyDown:fR,handlePaste:pR},appendTransaction(e,n,r){return VA(r,qA(r,n),t)}})}var Al=typeof navigator<"u"?navigator:null,xh=Al&&Al.userAgent||"",TR=/Edge\/(\d+)/.exec(xh),$R=/MSIE \d/.exec(xh),OR=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(xh),MR=!!($R||OR||TR),ER=!MR&&!!Al&&/Apple Computer/.test(Al.vendor),eb=new mt("safari-ime-span"),Ad=!1,NR={key:eb,props:{decorations:DR,handleDOMEvents:{compositionstart:()=>{Ad=!0},compositionend:()=>{Ad=!1}}}};function DR(t){const{$from:e,$to:n,to:r}=t.selection;if(Ad&&e.sameParent(n)){const o=ht.widget(r,AR,{ignoreSelection:!0,key:"safari-ime-span"});return Ie.create(t.doc,[o])}}function AR(t){const e=t.dom.ownerDocument.createElement("span");return e.className="ProseMirror-safari-ime-span",e}var RR=new wt(ER?NR:{key:eb});function le(t,e){return Object.assign(t,{meta:{package:"@milkdown/preset-gfm",...e}}),t}const Sh=na("strike_through");le(Sh,{displayName:"Attr<strikethrough>",group:"Strikethrough"});const la=Ns("strike_through",t=>({parseDOM:[{tag:"del"},{style:"text-decoration",getAttrs:e=>e==="line-through"}],toDOM:e=>["del",t.get(Sh.key)(e)],parseMarkdown:{match:e=>e.type==="delete",runner:(e,n,r)=>{e.openMark(r),e.next(n.children),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="strike_through",runner:(e,n)=>{e.withMark(n,"delete")}}}));le(la.mark,{displayName:"MarkSchema<strikethrough>",group:"Strikethrough"});le(la.ctx,{displayName:"MarkSchemaCtx<strikethrough>",group:"Strikethrough"});const _h=de("ToggleStrikeThrough",t=>()=>fc(la.type(t)));le(_h,{displayName:"Command<ToggleStrikethrough>",group:"Strikethrough"});const tb=It(t=>ta(new RegExp("(?<![\\w:/])(~{1,2})(.+?)\\1(?!\\w|\\/)"),la.type(t)));le(tb,{displayName:"InputRule<strikethrough>",group:"Strikethrough"});const Th=Lt("strikeThroughKeymap",{ToggleStrikethrough:{shortcuts:"Mod-Alt-x",command:t=>{const e=t.get(me);return()=>e.call(_h.key)}}});le(Th.ctx,{displayName:"KeymapCtx<strikethrough>",group:"Strikethrough"});le(Th.shortcuts,{displayName:"Keymap<strikethrough>",group:"Strikethrough"});const ca=DA({tableGroup:"block",cellContent:"paragraph",cellAttributes:{alignment:{default:"left",getFromDOM:t=>t.style.textAlign||"left",setDOMAttr:(t,e)=>{e.style="text-align: ".concat(t||"left")}}}}),Eo=lt("table",()=>({...ca.table,content:"table_header_row table_row+",disableDropCursor:!0,parseMarkdown:{match:t=>t.type==="table",runner:(t,e,n)=>{const r=e.align,o=e.children.map((s,i)=>({...s,align:r,isHeader:i===0}));t.openNode(n),t.next(o),t.closeNode()}},toMarkdown:{match:t=>t.type.name==="table",runner:(t,e)=>{var o;const n=(o=e.content.firstChild)==null?void 0:o.content;if(!n)return;const r=[];n.forEach(s=>{r.push(s.attrs.alignment)}),t.openNode("table",void 0,{align:r}),t.next(e.content),t.closeNode()}}}));le(Eo.node,{displayName:"NodeSchema<table>",group:"Table"});le(Eo.ctx,{displayName:"NodeSchemaCtx<table>",group:"Table"});const Tc=lt("table_header_row",()=>({...ca.table_row,disableDropCursor:!0,content:"(table_header)*",parseDOM:[{tag:"tr[data-is-header]"}],toDOM(){return["tr",{"data-is-header":!0},0]},parseMarkdown:{match:t=>!!(t.type==="tableRow"&&t.isHeader),runner:(t,e,n)=>{const r=e.align,o=e.children.map((s,i)=>({...s,align:r[i],isHeader:e.isHeader}));t.openNode(n),t.next(o),t.closeNode()}},toMarkdown:{match:t=>t.type.name==="table_header_row",runner:(t,e)=>{t.openNode("tableRow",void 0,{isHeader:!0}),t.next(e.content),t.closeNode()}}}));le(Tc.node,{displayName:"NodeSchema<tableHeaderRow>",group:"Table"});le(Tc.ctx,{displayName:"NodeSchemaCtx<tableHeaderRow>",group:"Table"});const ua=lt("table_row",()=>({...ca.table_row,disableDropCursor:!0,content:"(table_cell)*",parseMarkdown:{match:t=>t.type==="tableRow",runner:(t,e,n)=>{const r=e.align,o=e.children.map((s,i)=>({...s,align:r[i]}));t.openNode(n),t.next(o),t.closeNode()}},toMarkdown:{match:t=>t.type.name==="table_row",runner:(t,e)=>{e.content.size!==0&&(t.openNode("tableRow"),t.next(e.content),t.closeNode())}}}));le(ua.node,{displayName:"NodeSchema<tableRow>",group:"Table"});le(ua.ctx,{displayName:"NodeSchemaCtx<tableRow>",group:"Table"});const da=lt("table_cell",()=>({...ca.table_cell,disableDropCursor:!0,parseMarkdown:{match:t=>t.type==="tableCell"&&!t.isHeader,runner:(t,e,n)=>{const r=e.align;t.openNode(n,{alignment:r}).openNode(t.schema.nodes.paragraph).next(e.children).closeNode().closeNode()}},toMarkdown:{match:t=>t.type.name==="table_cell",runner:(t,e)=>{t.openNode("tableCell").next(e.content).closeNode()}}}));le(da.node,{displayName:"NodeSchema<tableCell>",group:"Table"});le(da.ctx,{displayName:"NodeSchemaCtx<tableCell>",group:"Table"});const fa=lt("table_header",()=>({...ca.table_header,disableDropCursor:!0,parseMarkdown:{match:t=>t.type==="tableCell"&&!!t.isHeader,runner:(t,e,n)=>{const r=e.align;t.openNode(n,{alignment:r}),t.openNode(t.schema.nodes.paragraph),t.next(e.children),t.closeNode(),t.closeNode()}},toMarkdown:{match:t=>t.type.name==="table_header",runner:(t,e)=>{t.openNode("tableCell"),t.next(e.content),t.closeNode()}}}));le(fa.node,{displayName:"NodeSchema<tableHeader>",group:"Table"});le(fa.ctx,{displayName:"NodeSchemaCtx<tableHeader>",group:"Table"});function nb(t,e=3,n=3){const r=Array(n).fill(0).map(()=>da.type(t).createAndFill()),o=Array(n).fill(0).map(()=>fa.type(t).createAndFill()),s=Array(e).fill(0).map((i,a)=>a===0?Tc.type(t).create(null,o):ua.type(t).create(null,r));return Eo.type(t).create(null,s)}function IR(t,e){const n=Mo(e.$from);if(!n)return;const r=Me.get(n.node);return(Array.isArray(t)?t:[t]).filter(s=>s>=0&&s<=r.width-1).flatMap(s=>r.cellsInRect({left:s,right:s+1,top:0,bottom:r.height}).map(a=>{const l=n.node.nodeAt(a),c=a+n.start;return{pos:c,start:c+1,node:l,depth:n.depth+2}}))}function PR(t,e){const n=Mo(e.$from);if(!n)return;const r=Me.get(n.node);return(Array.isArray(t)?t:[t]).filter(s=>s>=0&&s<=r.height-1).flatMap(s=>r.cellsInRect({left:0,right:r.width,top:s,bottom:s+1}).map(a=>{const l=n.node.nodeAt(a),c=a+n.start;return{pos:c,start:c+1,node:l,depth:n.depth+2}}))}function rb(t){return(e,n)=>r=>{n=n!=null?n:r.selection.from;const o=r.doc.resolve(n),s=AN(l=>l.type.name==="table")(o),i=s?{node:s.node,from:s.start}:void 0,a=t==="row";if(i){const l=Me.get(i.node);if(e>=0&&e<(a?l.height:l.width)){const c=l.positionAt(a?e:l.height-1,a?l.width-1:e,i.node),u=r.doc.resolve(i.from+c),d=a?Be.rowSelection:Be.colSelection,f=l.positionAt(a?e:0,a?0:e,i.node),p=r.doc.resolve(i.from+f);return Jy(r.setSelection(d(u,p)))}}return r}}const LR=rb("row"),zR=rb("col");function ob(t,e,{map:n,tableStart:r,table:o},s){const i=Array(s).fill(0).reduce((l,c,u)=>l+o.child(u).nodeSize,r),a=Array(n.width).fill(0).map((l,c)=>{const u=o.nodeAt(n.map[c]);return da.type(t).createAndFill({alignment:u==null?void 0:u.attrs.alignment})});return e.insert(i,ua.type(t).create(null,a)),e}function BR(t){const e=Mo(t.$from);if(!e)return;const n=Me.get(e.node);return n.cellsInRect({left:0,right:n.width,top:0,bottom:n.height}).map(o=>{const s=e.node.nodeAt(o),i=o+e.start;return{pos:i,start:i+1,node:s}})}function FR(t){const e=BR(t.selection);if(e&&e[0]){const n=t.doc.resolve(e[0].pos),r=e[e.length-1];if(r){const o=t.doc.resolve(r.pos);return Jy(t.setSelection(new Be(o,n)))}}return t}const $h=de("GoToPrevTableCell",()=>()=>G0(-1));le($h,{displayName:"Command<goToPrevTableCellCommand>",group:"Table"});const Oh=de("GoToNextTableCell",()=>()=>G0(1));le(Oh,{displayName:"Command<goToNextTableCellCommand>",group:"Table"});const Mh=de("ExitTable",t=>()=>(e,n)=>{if(!ln(e))return!1;const{$head:r}=e.selection,o=DN(r,Eo.type(t));if(!o)return!1;const{to:s}=o,i=e.tr.replaceWith(s,s,tr.type(t).createAndFill());return i.setSelection(pe.near(i.doc.resolve(s),1)).scrollIntoView(),n==null||n(i),!0});le(Mh,{displayName:"Command<breakTableCommand>",group:"Table"});const Eh=de("InsertTable",t=>({row:e,col:n}={})=>(r,o)=>{const{selection:s,tr:i}=r,{from:a}=s,l=nb(t,e,n),c=i.replaceSelectionWith(l),u=pe.findFrom(c.doc.resolve(a),1,!0);return u&&c.setSelection(u),o==null||o(c),!0});le(Eh,{displayName:"Command<insertTableCommand>",group:"Table"});const Nh=de("MoveRow",()=>({from:t,to:e,pos:n}={})=>iR({from:t!=null?t:0,to:e!=null?e:0,pos:n}));le(Nh,{displayName:"Command<moveRowCommand>",group:"Table"});const Dh=de("MoveCol",()=>({from:t,to:e,pos:n}={})=>aR({from:t!=null?t:0,to:e!=null?e:0,pos:n}));le(Dh,{displayName:"Command<moveColCommand>",group:"Table"});const Ah=de("SelectRow",()=>(t={index:0})=>(e,n)=>{const{tr:r}=e;return!!(n==null?void 0:n(LR(t.index,t.pos)(r)))});le(Ah,{displayName:"Command<selectRowCommand>",group:"Table"});const Rh=de("SelectCol",()=>(t={index:0})=>(e,n)=>{const{tr:r}=e;return!!(n==null?void 0:n(zR(t.index,t.pos)(r)))});le(Rh,{displayName:"Command<selectColCommand>",group:"Table"});const Ih=de("SelectTable",()=>()=>(t,e)=>{const{tr:n}=t;return!!(e==null?void 0:e(FR(n)))});le(Ih,{displayName:"Command<selectTableCommand>",group:"Table"});const Ph=de("DeleteSelectedCells",()=>()=>(t,e)=>{const{selection:n}=t;if(!(n instanceof Be))return!1;const r=n.isRowSelection(),o=n.isColSelection();return r&&o?sR(t,e):o?QA(t,e):tR(t,e)});le(Ph,{displayName:"Command<deleteSelectedCellsCommand>",group:"Table"});const Lh=de("AddColBefore",()=>()=>JA);le(Lh,{displayName:"Command<addColBeforeCommand>",group:"Table"});const zh=de("AddColAfter",()=>()=>XA);le(zh,{displayName:"Command<addColAfterCommand>",group:"Table"});const Bh=de("AddRowBefore",t=>()=>(e,n)=>{if(!ln(e))return!1;if(n){const r=zr(e);n(ob(t,e.tr,r,r.top))}return!0});le(Bh,{displayName:"Command<addRowBeforeCommand>",group:"Table"});const Fh=de("AddRowAfter",t=>()=>(e,n)=>{if(!ln(e))return!1;if(n){const r=zr(e);n(ob(t,e.tr,r,r.bottom))}return!0});le(Fh,{displayName:"Command<addRowAfterCommand>",group:"Table"});const pi=de("SetAlign",()=>(t="left")=>nR("alignment",t));le(pi,{displayName:"Command<setAlignCommand>",group:"Table"});const sb=It(t=>new Yt(new RegExp("^\\|(?<col>\\d+)[xX](?<row>\\d+)\\|\\s$"),(e,n,r,o)=>{var c,u,d;const s=e.doc.resolve(r);if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),Eo.type(t)))return null;const i=Math.max(Number((u=(c=n.groups)==null?void 0:c.row)!=null?u:0),2),a=nb(t,i,Number((d=n.groups)==null?void 0:d.col)),l=e.tr.replaceRangeWith(r,o,a);return l.setSelection(he.create(l.doc,r+3)).scrollIntoView()}));le(sb,{displayName:"InputRule<insertTableInputRule>",group:"Table"});const ib=fD(t=>({run:(e,n,r)=>{if(r)return e;let o=e.content;return e.content.forEach((s,i,a)=>{var y,w;if((s==null?void 0:s.type)!==Eo.type(t))return;const l=s.childCount,c=(w=(y=s.lastChild)==null?void 0:y.childCount)!=null?w:0;if(l===0||c===0){o=o.replaceChild(a,tr.type(t).create());return}const u=s.firstChild;if(!(c>0&&u&&u.childCount===0))return;const f=Array(c).fill(0).map(()=>fa.type(t).createAndFill()),p=new J(V.from(f),0,0),h=u.replace(0,0,p),v=s.replace(0,u.nodeSize,new J(V.from(h),0,0));o=o.replaceChild(a,v)}),new J(V.from(o),e.openStart,e.openEnd)}}));le(ib,{displayName:"PasteRule<table>",group:"Table"});const Vh=Lt("tableKeymap",{NextCell:{priority:100,shortcuts:["Mod-]","Tab"],command:t=>{const e=t.get(me);return()=>e.call(Oh.key)}},PrevCell:{shortcuts:["Mod-[","Shift-Tab"],command:t=>{const e=t.get(me);return()=>e.call($h.key)}},ExitTable:{shortcuts:["Mod-Enter","Enter"],command:t=>{const e=t.get(me);return()=>e.call(Mh.key)}}});le(Vh.ctx,{displayName:"KeymapCtx<table>",group:"Table"});le(Vh.shortcuts,{displayName:"Keymap<table>",group:"Table"});const Su="footnote_definition",xg="footnoteDefinition",Hh=lt("footnote_definition",()=>({group:"block",content:"block+",defining:!0,attrs:{label:{default:"",validate:"string"}},parseDOM:[{tag:'dl[data-type="'.concat(Su,'"]'),getAttrs:t=>{if(!(t instanceof HTMLElement))throw En(t);return{label:t.dataset.label}},contentElement:"dd"}],toDOM:t=>{const e=t.attrs.label;return["dl",{"data-label":e,"data-type":Su},["dt",e],["dd",0]]},parseMarkdown:{match:({type:t})=>t===xg,runner:(t,e,n)=>{t.openNode(n,{label:e.label}).next(e.children).closeNode()}},toMarkdown:{match:t=>t.type.name===Su,runner:(t,e)=>{t.openNode(xg,void 0,{label:e.attrs.label,identifier:e.attrs.label}).next(e.content).closeNode()}}}));le(Hh.ctx,{displayName:"NodeSchemaCtx<footnodeDef>",group:"footnote"});le(Hh.node,{displayName:"NodeSchema<footnodeDef>",group:"footnote"});const _u="footnote_reference",qh=lt("footnote_reference",()=>({group:"inline",inline:!0,atom:!0,attrs:{label:{default:"",validate:"string"}},parseDOM:[{tag:'sup[data-type="'.concat(_u,'"]'),getAttrs:t=>{if(!(t instanceof HTMLElement))throw En(t);return{label:t.dataset.label}}}],toDOM:t=>{const e=t.attrs.label;return["sup",{"data-label":e,"data-type":_u},e]},parseMarkdown:{match:({type:t})=>t==="footnoteReference",runner:(t,e,n)=>{t.addNode(n,{label:e.label})}},toMarkdown:{match:t=>t.type.name===_u,runner:(t,e)=>{t.addNode("footnoteReference",void 0,void 0,{label:e.attrs.label,identifier:e.attrs.label})}}}));le(qh.ctx,{displayName:"NodeSchemaCtx<footnodeRef>",group:"footnote"});le(qh.node,{displayName:"NodeSchema<footnodeRef>",group:"footnote"});const Uh=nr.extendSchema(t=>e=>{const n=t(e);return{...n,attrs:{...n.attrs,checked:{default:null,validate:"boolean|null"}},parseDOM:[{tag:'li[data-item-type="task"]',getAttrs:r=>{if(!(r instanceof HTMLElement))throw En(r);return{label:r.dataset.label,listType:r.dataset.listType,spread:r.dataset.spread,checked:r.dataset.checked?r.dataset.checked==="true":null}}},...(n==null?void 0:n.parseDOM)||[]],toDOM:r=>n.toDOM&&r.attrs.checked==null?n.toDOM(r):["li",{"data-item-type":"task","data-label":r.attrs.label,"data-list-type":r.attrs.listType,"data-spread":r.attrs.spread,"data-checked":r.attrs.checked},0],parseMarkdown:{match:({type:r})=>r==="listItem",runner:(r,o,s)=>{if(o.checked==null){n.parseMarkdown.runner(r,o,s);return}const i=o.label!=null?"".concat(o.label,"."):"",a=o.checked!=null?!!o.checked:null,l=o.label!=null?"ordered":"bullet",c=o.spread!=null?"".concat(o.spread):"true";r.openNode(s,{label:i,listType:l,spread:c,checked:a}),r.next(o.children),r.closeNode()}},toMarkdown:{match:r=>r.type.name==="list_item",runner:(r,o)=>{if(o.attrs.checked==null){n.toMarkdown.runner(r,o);return}const s=o.attrs.label,i=o.attrs.listType,a=o.attrs.spread==="true",l=o.attrs.checked;r.openNode("listItem",void 0,{label:s,listType:i,spread:a,checked:l}),r.next(o.content),r.closeNode()}}}});le(Uh.node,{displayName:"NodeSchema<taskListItem>",group:"ListItem"});le(Uh.ctx,{displayName:"NodeSchemaCtx<taskListItem>",group:"ListItem"});const ab=It(()=>new Yt(new RegExp("^\\[(?<checked>\\s|x)\\]\\s$"),(t,e,n,r)=>{var u;const o=t.doc.resolve(n);let s=0,i=o.node(s);for(;i&&i.type.name!=="list_item";)s--,i=o.node(s);if(!i||i.attrs.checked!=null)return null;const a=((u=e.groups)==null?void 0:u.checked)==="x",l=o.before(s),c=t.tr;return c.deleteRange(n,r).setNodeMarkup(l,void 0,{...i.attrs,checked:a}),c}));le(ab,{displayName:"InputRule<wrapInTaskListInputRule>",group:"ListItem"});const VR=[Th,Vh].flat(),HR=[sb,ab],qR=[tb],UR=[ib],lb=Gt(()=>RR);le(lb,{displayName:"Prose<autoInsertSpanPlugin>",group:"Prose"});const cb=Gt(()=>Z0({}));le(cb,{displayName:"Prose<columnResizingPlugin>",group:"Prose"});const ub=Gt(()=>_R({allowTableNodeSelection:!0}));le(ub,{displayName:"Prose<tableEditingPlugin>",group:"Prose"});const Wh=$o("remarkGFM",()=>Jb);le(Wh.plugin,{displayName:"Remark<remarkGFMPlugin>",group:"Remark"});le(Wh.options,{displayName:"RemarkConfig<remarkGFMPlugin>",group:"Remark"});const WR=new mt("MILKDOWN_KEEP_TABLE_ALIGN_PLUGIN");function jR(t,e){let n=0;return e.forEach((r,o,s)=>{r===t&&(n=s)}),n}const db=Gt(()=>new wt({key:WR,appendTransaction:(t,e,n)=>{let r;const o=(s,i)=>{if(r||(r=n.tr),s.type.name!=="table_cell")return;const a=n.doc.resolve(i),l=a.node(a.depth),u=a.node(a.depth-1).firstChild;if(!u)return;const d=jR(s,l),f=u.maybeChild(d);if(!f)return;const p=f.attrs.alignment,h=s.attrs.alignment;p!==h&&r.setNodeMarkup(i,void 0,{...s.attrs,alignment:p})};return e.doc!==n.doc&&n.doc.descendants(o),r}}));le(db,{displayName:"Prose<keepTableAlignPlugin>",group:"Prose"});const KR=[db,lb,Wh,ub].flat(),YR=[Uh,Eo,Tc,ua,fa,da,Hh,qh,Sh,la].flat(),GR=[Oh,$h,Mh,Eh,Nh,Dh,Ah,Rh,Ih,Ph,Bh,Fh,Lh,zh,pi,_h],Tu=[YR,HR,UR,qR,VR,GR,KR].flat(),zt=L({__name:"EditorButton",props:{icon:{}},setup(t){return(e,n)=>(b(),k("button",{class:ae(["fr-btn fr-btn--secondary-grey-400 fr-btn--sm fr-btn--tertiary-no-outline",t.icon]),role:"menuitem"},[Le(e.$slots,"default")],2))}}),JR=["aria-labelledby","id"],XR={class:"fr-container fr-container--fluid fr-container-md"},ZR={class:"fr-grid-row fr-grid-row--center"},QR={class:"fr-col-12 fr-col-md-8 fr-col-lg-6"},eI={class:"fr-modal__body"},tI={class:"fr-modal__header"},nI={class:"fr-modal__content"},rI=["id"],oI={"data-testid":"summary"},sI={class:"fr-my-1w"},iI={class:"fr-modal__footer"},aI={class:"fr-btns-group fr-btns-group--right"},lI=L({inheritAttrs:!1,__name:"ImageModal",props:{id:{}},emits:["sendModal"],setup(t,{emit:e}){const n=t,r=e,{t:o}=be(),s=O(()=>n.id+"-title"),i=T(),a={src:"",title:"",alt:""},l=So({...a}),c={src:{required:Du}},{getErrorText:u,getFunctionalState:d,hasError:f,reset:p,validateRequiredRules:h,v$:v}=mv(l,c,c),y=O(()=>({src:d(v.value.src.$dirty,v.value.src.$error,!1)}));function w(S){return f(y,S)}function x(){globalThis.dsfr(i.value).modal.conceal(),l.src=a.src,l.title=a.title,l.alt=a.alt,p()}function $(){h().then(S=>{S&&(r("sendModal",{...l}),x())})}return(S,_)=>(b(),j(Pr,{to:"body"},[g("dialog",Tn(S.$attrs,{"aria-labelledby":s.value,id:t.id,role:"dialog",class:"fr-modal",ref_key:"modalRef",ref:i}),[g("div",XR,[g("div",ZR,[g("div",QR,[g("div",eI,[g("div",tI,[g("button",{class:"fr-btn--close fr-btn","aria-controls":"fr-modal-2",onClick:x},C(m(o)("Close")),1)]),g("div",nI,[g("h1",{id:s.value,class:"fr-mb-2w fr-modal__title"},[_[3]||(_[3]=g("span",{class:"fr-icon-image-line fr-icon--lg"},null,-1)),U(" "+C(m(o)("Add an image")),1)],8,rI),g("p",null,C(m(o)("Paste a link of your image to add it to your description. It is recommended to also provide a textual alternative for an informative image and a title.")),1),M(Qd),M(nl,{label:m(o)("Image link"),placeholder:m(o)("Paste your link..."),required:!0,modelValue:l.src,"onUpdate:modelValue":_[0]||(_[0]=E=>l.src=E),type:"url",hasError:w("src"),errorText:m(u)("src")},null,8,["label","placeholder","modelValue","hasError","errorText"]),g("details",null,[g("summary",oI,C(m(o)("Customize accessibility options")),1),g("div",sI,[M(nl,{label:m(o)("Image alternative text"),modelValue:l.alt,"onUpdate:modelValue":_[1]||(_[1]=E=>l.alt=E)},null,8,["label","modelValue"]),M(nl,{label:m(o)("Image title"),modelValue:l.title,"onUpdate:modelValue":_[2]||(_[2]=E=>l.title=E)},null,8,["label","modelValue"])])])]),g("div",iI,[g("div",aI,[g("button",{class:"fr-btn",onClick:$,"data-testid":"add-image-button"},C(m(o)("Add image")),1)])])])])])])],16,JR)]))}}),cI=L({__name:"ImageModalButton",emits:["send"],setup(t,{emit:e}){const n=e,{t:r}=be(),o=xo("image-modal");function s(i){n("send",i)}return(i,a)=>(b(),k(K,null,[M(zt,{"data-fr-opened":"false","aria-controls":m(o),icon:"fr-icon-image-add-fill",title:m(r)("Image"),"data-testid":"image-modal-button"},null,8,["aria-controls","title"]),M(lI,{id:m(o),multiple:!0,onSendModal:s},null,8,["id"])],64))}});class uI extends X0{constructor(e,n){super(e,n),this.dom.className="fr-table fr-table--no-caption fr-table--layout-fixed"}ignoreMutation(e){return super.ignoreMutation(e)||e.type==="attributes"&&e.target===this.dom}}const dI=Gt(()=>Z0({View:uI})),Rd=Math.min,Yo=Math.max,Rl=Math.round,_n=t=>({x:t,y:t}),fI={left:"right",right:"left",bottom:"top",top:"bottom"},hI={start:"end",end:"start"};function Sg(t,e,n){return Yo(t,Rd(e,n))}function $c(t,e){return typeof t=="function"?t(e):t}function Co(t){return t.split("-")[0]}function Oc(t){return t.split("-")[1]}function fb(t){return t==="x"?"y":"x"}function hb(t){return t==="y"?"height":"width"}const pI=new Set(["top","bottom"]);function xr(t){return pI.has(Co(t))?"y":"x"}function pb(t){return fb(xr(t))}function mI(t,e,n){n===void 0&&(n=!1);const r=Oc(t),o=pb(t),s=hb(o);let i=o==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(i=Il(i)),[i,Il(i)]}function gI(t){const e=Il(t);return[Id(t),e,Id(e)]}function Id(t){return t.replace(/start|end/g,e=>hI[e])}const _g=["left","right"],Tg=["right","left"],vI=["top","bottom"],yI=["bottom","top"];function bI(t,e,n){switch(t){case"top":case"bottom":return n?e?Tg:_g:e?_g:Tg;case"left":case"right":return e?vI:yI;default:return[]}}function wI(t,e,n,r){const o=Oc(t);let s=bI(Co(t),n==="start",r);return o&&(s=s.map(i=>i+"-"+o),e&&(s=s.concat(s.map(Id)))),s}function Il(t){return t.replace(/left|right|bottom|top/g,e=>fI[e])}function kI(t){return{top:0,right:0,bottom:0,left:0,...t}}function CI(t){return typeof t!="number"?kI(t):{top:t,right:t,bottom:t,left:t}}function Pl(t){const{x:e,y:n,width:r,height:o}=t;return{width:r,height:o,top:n,left:e,right:e+r,bottom:n+o,x:e,y:n}}function $g(t,e,n){let{reference:r,floating:o}=t;const s=xr(e),i=pb(e),a=hb(i),l=Co(e),c=s==="y",u=r.x+r.width/2-o.width/2,d=r.y+r.height/2-o.height/2,f=r[a]/2-o[a]/2;let p;switch(l){case"top":p={x:u,y:r.y-o.height};break;case"bottom":p={x:u,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:d};break;case"left":p={x:r.x-o.width,y:d};break;default:p={x:r.x,y:r.y}}switch(Oc(e)){case"start":p[i]-=f*(n&&c?-1:1);break;case"end":p[i]+=f*(n&&c?-1:1);break}return p}const xI=async(t,e,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:s=[],platform:i}=n,a=s.filter(Boolean),l=await(i.isRTL==null?void 0:i.isRTL(e));let c=await i.getElementRects({reference:t,floating:e,strategy:o}),{x:u,y:d}=$g(c,r,l),f=r,p={},h=0;for(let v=0;v<a.length;v++){const{name:y,fn:w}=a[v],{x,y:$,data:S,reset:_}=await w({x:u,y:d,initialPlacement:r,placement:f,strategy:o,middlewareData:p,rects:c,platform:i,elements:{reference:t,floating:e}});u=x!=null?x:u,d=$!=null?$:d,p={...p,[y]:{...p[y],...S}},_&&h<=50&&(h++,typeof _=="object"&&(_.placement&&(f=_.placement),_.rects&&(c=_.rects===!0?await i.getElementRects({reference:t,floating:e,strategy:o}):_.rects),{x:u,y:d}=$g(c,f,l)),v=-1)}return{x:u,y:d,placement:f,strategy:o,middlewareData:p}};async function mb(t,e){var n;e===void 0&&(e={});const{x:r,y:o,platform:s,rects:i,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:p=0}=$c(e,t),h=CI(p),y=a[f?d==="floating"?"reference":"floating":d],w=Pl(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(y)))==null||n?y:y.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),x=d==="floating"?{x:r,y:o,width:i.floating.width,height:i.floating.height}:i.reference,$=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),S=await(s.isElement==null?void 0:s.isElement($))?await(s.getScale==null?void 0:s.getScale($))||{x:1,y:1}:{x:1,y:1},_=Pl(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:x,offsetParent:$,strategy:l}):x);return{top:(w.top-_.top+h.top)/S.y,bottom:(_.bottom-w.bottom+h.bottom)/S.y,left:(w.left-_.left+h.left)/S.x,right:(_.right-w.right+h.right)/S.x}}const SI=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:o,middlewareData:s,rects:i,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:h="none",flipAlignment:v=!0,...y}=$c(t,e);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const w=Co(o),x=xr(a),$=Co(a)===a,S=await(l.isRTL==null?void 0:l.isRTL(c.floating)),_=f||($||!v?[Il(a)]:gI(a)),E=h!=="none";!f&&E&&_.push(...wI(a,v,h,S));const D=[a,..._],N=await mb(e,y),H=[];let Y=((r=s.flip)==null?void 0:r.overflows)||[];if(u&&H.push(N[w]),d){const et=mI(o,i,S);H.push(N[et[0]],N[et[1]])}if(Y=[...Y,{placement:o,overflows:H}],!H.every(et=>et<=0)){var re,ce;const et=(((re=s.flip)==null?void 0:re.index)||0)+1,$e=D[et];if($e&&(!(d==="alignment"?x!==xr($e):!1)||Y.every(Fe=>xr(Fe.placement)===x?Fe.overflows[0]>0:!0)))return{data:{index:et,overflows:Y},reset:{placement:$e}};let Ae=(ce=Y.filter(qe=>qe.overflows[0]<=0).sort((qe,Fe)=>qe.overflows[1]-Fe.overflows[1])[0])==null?void 0:ce.placement;if(!Ae)switch(p){case"bestFit":{var Ue;const qe=(Ue=Y.filter(Fe=>{if(E){const We=xr(Fe.placement);return We===x||We==="y"}return!0}).map(Fe=>[Fe.placement,Fe.overflows.filter(We=>We>0).reduce((We,Oe)=>We+Oe,0)]).sort((Fe,We)=>Fe[1]-We[1])[0])==null?void 0:Ue[0];qe&&(Ae=qe);break}case"initialPlacement":Ae=a;break}if(o!==Ae)return{reset:{placement:Ae}}}return{}}}},_I=new Set(["left","top"]);async function TI(t,e){const{placement:n,platform:r,elements:o}=t,s=await(r.isRTL==null?void 0:r.isRTL(o.floating)),i=Co(n),a=Oc(n),l=xr(n)==="y",c=_I.has(i)?-1:1,u=s&&l?-1:1,d=$c(e,t);let{mainAxis:f,crossAxis:p,alignmentAxis:h}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof h=="number"&&(p=a==="end"?h*-1:h),l?{x:p*u,y:f*c}:{x:f*c,y:p*u}}const $I=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:o,y:s,placement:i,middlewareData:a}=e,l=await TI(e,t);return i===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:o+l.x,y:s+l.y,data:{...l,placement:i}}}}},OI=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:o}=e,{mainAxis:s=!0,crossAxis:i=!1,limiter:a={fn:y=>{let{x:w,y:x}=y;return{x:w,y:x}}},...l}=$c(t,e),c={x:n,y:r},u=await mb(e,l),d=xr(Co(o)),f=fb(d);let p=c[f],h=c[d];if(s){const y=f==="y"?"top":"left",w=f==="y"?"bottom":"right",x=p+u[y],$=p-u[w];p=Sg(x,p,$)}if(i){const y=d==="y"?"top":"left",w=d==="y"?"bottom":"right",x=h+u[y],$=h-u[w];h=Sg(x,h,$)}const v=a.fn({...e,[f]:p,[d]:h});return{...v,data:{x:v.x-n,y:v.y-r,enabled:{[f]:s,[d]:i}}}}}};function Mc(){return typeof window<"u"}function Ls(t){return gb(t)?(t.nodeName||"").toLowerCase():"#document"}function jt(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function rr(t){var e;return(e=(gb(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function gb(t){return Mc()?t instanceof Node||t instanceof jt(t).Node:!1}function hn(t){return Mc()?t instanceof Element||t instanceof jt(t).Element:!1}function Mn(t){return Mc()?t instanceof HTMLElement||t instanceof jt(t).HTMLElement:!1}function Og(t){return!Mc()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof jt(t).ShadowRoot}const MI=new Set(["inline","contents"]);function ha(t){const{overflow:e,overflowX:n,overflowY:r,display:o}=pn(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!MI.has(o)}const EI=new Set(["table","td","th"]);function NI(t){return EI.has(Ls(t))}const DI=[":popover-open",":modal"];function Ec(t){return DI.some(e=>{try{return t.matches(e)}catch(n){return!1}})}const AI=["transform","translate","scale","rotate","perspective"],RI=["transform","translate","scale","rotate","perspective","filter"],II=["paint","layout","strict","content"];function jh(t){const e=Kh(),n=hn(t)?pn(t):t;return AI.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||RI.some(r=>(n.willChange||"").includes(r))||II.some(r=>(n.contain||"").includes(r))}function PI(t){let e=Ir(t);for(;Mn(e)&&!xs(e);){if(jh(e))return e;if(Ec(e))return null;e=Ir(e)}return null}function Kh(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const LI=new Set(["html","body","#document"]);function xs(t){return LI.has(Ls(t))}function pn(t){return jt(t).getComputedStyle(t)}function Nc(t){return hn(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Ir(t){if(Ls(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Og(t)&&t.host||rr(t);return Og(e)?e.host:e}function vb(t){const e=Ir(t);return xs(e)?t.ownerDocument?t.ownerDocument.body:t.body:Mn(e)&&ha(e)?e:vb(e)}function Pd(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const o=vb(t),s=o===((r=t.ownerDocument)==null?void 0:r.body),i=jt(o);if(s){const a=Ld(i);return e.concat(i,i.visualViewport||[],ha(o)?o:[],a&&n?Pd(a):[])}return e.concat(o,Pd(o,[],n))}function Ld(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function yb(t){const e=pn(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const o=Mn(t),s=o?t.offsetWidth:n,i=o?t.offsetHeight:r,a=Rl(n)!==s||Rl(r)!==i;return a&&(n=s,r=i),{width:n,height:r,$:a}}function bb(t){return hn(t)?t:t.contextElement}function Go(t){const e=bb(t);if(!Mn(e))return _n(1);const n=e.getBoundingClientRect(),{width:r,height:o,$:s}=yb(e);let i=(s?Rl(n.width):n.width)/r,a=(s?Rl(n.height):n.height)/o;return(!i||!Number.isFinite(i))&&(i=1),(!a||!Number.isFinite(a))&&(a=1),{x:i,y:a}}const zI=_n(0);function wb(t){const e=jt(t);return!Kh()||!e.visualViewport?zI:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function BI(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==jt(t)?!1:e}function Ni(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const o=t.getBoundingClientRect(),s=bb(t);let i=_n(1);e&&(r?hn(r)&&(i=Go(r)):i=Go(t));const a=BI(s,n,r)?wb(s):_n(0);let l=(o.left+a.x)/i.x,c=(o.top+a.y)/i.y,u=o.width/i.x,d=o.height/i.y;if(s){const f=jt(s),p=r&&hn(r)?jt(r):r;let h=f,v=Ld(h);for(;v&&r&&p!==h;){const y=Go(v),w=v.getBoundingClientRect(),x=pn(v),$=w.left+(v.clientLeft+parseFloat(x.paddingLeft))*y.x,S=w.top+(v.clientTop+parseFloat(x.paddingTop))*y.y;l*=y.x,c*=y.y,u*=y.x,d*=y.y,l+=$,c+=S,h=jt(v),v=Ld(h)}}return Pl({width:u,height:d,x:l,y:c})}function Dc(t,e){const n=Nc(t).scrollLeft;return e?e.left+n:Ni(rr(t)).left+n}function kb(t,e){const n=t.getBoundingClientRect(),r=n.left+e.scrollLeft-Dc(t,n),o=n.top+e.scrollTop;return{x:r,y:o}}function FI(t){let{elements:e,rect:n,offsetParent:r,strategy:o}=t;const s=o==="fixed",i=rr(r),a=e?Ec(e.floating):!1;if(r===i||a&&s)return n;let l={scrollLeft:0,scrollTop:0},c=_n(1);const u=_n(0),d=Mn(r);if((d||!d&&!s)&&((Ls(r)!=="body"||ha(i))&&(l=Nc(r)),Mn(r))){const p=Ni(r);c=Go(r),u.x=p.x+r.clientLeft,u.y=p.y+r.clientTop}const f=i&&!d&&!s?kb(i,l):_n(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+f.x,y:n.y*c.y-l.scrollTop*c.y+u.y+f.y}}function VI(t){return Array.from(t.getClientRects())}function HI(t){const e=rr(t),n=Nc(t),r=t.ownerDocument.body,o=Yo(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),s=Yo(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let i=-n.scrollLeft+Dc(t);const a=-n.scrollTop;return pn(r).direction==="rtl"&&(i+=Yo(e.clientWidth,r.clientWidth)-o),{width:o,height:s,x:i,y:a}}const Mg=25;function qI(t,e){const n=jt(t),r=rr(t),o=n.visualViewport;let s=r.clientWidth,i=r.clientHeight,a=0,l=0;if(o){s=o.width,i=o.height;const u=Kh();(!u||u&&e==="fixed")&&(a=o.offsetLeft,l=o.offsetTop)}const c=Dc(r);if(c<=0){const u=r.ownerDocument,d=u.body,f=getComputedStyle(d),p=u.compatMode==="CSS1Compat"&&parseFloat(f.marginLeft)+parseFloat(f.marginRight)||0,h=Math.abs(r.clientWidth-d.clientWidth-p);h<=Mg&&(s-=h)}else c<=Mg&&(s+=c);return{width:s,height:i,x:a,y:l}}const UI=new Set(["absolute","fixed"]);function WI(t,e){const n=Ni(t,!0,e==="fixed"),r=n.top+t.clientTop,o=n.left+t.clientLeft,s=Mn(t)?Go(t):_n(1),i=t.clientWidth*s.x,a=t.clientHeight*s.y,l=o*s.x,c=r*s.y;return{width:i,height:a,x:l,y:c}}function Eg(t,e,n){let r;if(e==="viewport")r=qI(t,n);else if(e==="document")r=HI(rr(t));else if(hn(e))r=WI(e,n);else{const o=wb(t);r={x:e.x-o.x,y:e.y-o.y,width:e.width,height:e.height}}return Pl(r)}function Cb(t,e){const n=Ir(t);return n===e||!hn(n)||xs(n)?!1:pn(n).position==="fixed"||Cb(n,e)}function jI(t,e){const n=e.get(t);if(n)return n;let r=Pd(t,[],!1).filter(a=>hn(a)&&Ls(a)!=="body"),o=null;const s=pn(t).position==="fixed";let i=s?Ir(t):t;for(;hn(i)&&!xs(i);){const a=pn(i),l=jh(i);!l&&a.position==="fixed"&&(o=null),(s?!l&&!o:!l&&a.position==="static"&&!!o&&UI.has(o.position)||ha(i)&&!l&&Cb(t,i))?r=r.filter(u=>u!==i):o=a,i=Ir(i)}return e.set(t,r),r}function KI(t){let{element:e,boundary:n,rootBoundary:r,strategy:o}=t;const i=[...n==="clippingAncestors"?Ec(e)?[]:jI(e,this._c):[].concat(n),r],a=i[0],l=i.reduce((c,u)=>{const d=Eg(e,u,o);return c.top=Yo(d.top,c.top),c.right=Rd(d.right,c.right),c.bottom=Rd(d.bottom,c.bottom),c.left=Yo(d.left,c.left),c},Eg(e,a,o));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function YI(t){const{width:e,height:n}=yb(t);return{width:e,height:n}}function GI(t,e,n){const r=Mn(e),o=rr(e),s=n==="fixed",i=Ni(t,!0,s,e);let a={scrollLeft:0,scrollTop:0};const l=_n(0);function c(){l.x=Dc(o)}if(r||!r&&!s)if((Ls(e)!=="body"||ha(o))&&(a=Nc(e)),r){const p=Ni(e,!0,s,e);l.x=p.x+e.clientLeft,l.y=p.y+e.clientTop}else o&&c();s&&!r&&o&&c();const u=o&&!r&&!s?kb(o,a):_n(0),d=i.left+a.scrollLeft-l.x-u.x,f=i.top+a.scrollTop-l.y-u.y;return{x:d,y:f,width:i.width,height:i.height}}function $u(t){return pn(t).position==="static"}function Ng(t,e){if(!Mn(t)||pn(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return rr(t)===n&&(n=n.ownerDocument.body),n}function xb(t,e){const n=jt(t);if(Ec(t))return n;if(!Mn(t)){let o=Ir(t);for(;o&&!xs(o);){if(hn(o)&&!$u(o))return o;o=Ir(o)}return n}let r=Ng(t,e);for(;r&&NI(r)&&$u(r);)r=Ng(r,e);return r&&xs(r)&&$u(r)&&!jh(r)?n:r||PI(t)||n}const JI=async function(t){const e=this.getOffsetParent||xb,n=this.getDimensions,r=await n(t.floating);return{reference:GI(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function XI(t){return pn(t).direction==="rtl"}const ZI={convertOffsetParentRelativeRectToViewportRelativeRect:FI,getDocumentElement:rr,getClippingRect:KI,getOffsetParent:xb,getElementRects:JI,getClientRects:VI,getDimensions:YI,getScale:Go,isElement:hn,isRTL:XI},Dg=$I,Ag=OI,Rg=SI,Ig=(t,e,n)=>{const r=new Map,o={platform:ZI,...n},s={...o.platform,_c:r};return xI(t,e,{...o,platform:s})};var Vi,Hi,ls,cs,qi,us,ds,fs,hs,Ui,Bl,Sb;class QI{constructor(e){ie(this,Bl);ie(this,Vi,void 0);ie(this,Hi,void 0);ie(this,ls,void 0);ie(this,cs,void 0);ie(this,qi,void 0);ie(this,us,void 0);ie(this,ds,void 0);ie(this,fs,void 0);ie(this,hs,void 0);ie(this,Ui,void 0);var n,r,o,s;G(this,us,!1),this.onShow=()=>{},this.onHide=()=>{},G(this,Ui,(i,a)=>{var w,x,$;const{state:l,composing:c}=i,{selection:u,doc:d}=l,{ranges:f}=u,p=Math.min(...f.map(S=>S.$from.pos)),h=Math.max(...f.map(S=>S.$to.pos)),v=a&&a.doc.eq(d)&&a.selection.eq(u);if(A(this,us)||(((x=(w=A(this,qi))!=null?w:i.dom.parentElement)!=null?x:document.body).appendChild(this.element),G(this,us,!0)),c||v)return;if(!A(this,Hi).call(this,i,a)){this.hide();return}Ig({getBoundingClientRect:()=>Df(i,p,h)},this.element,{placement:($=A(this,cs).placement)!=null?$:"top",middleware:[Rg(),Dg(A(this,ds)),Ag(A(this,fs)),...A(this,ls)]}).then(({x:S,y:_})=>{Object.assign(this.element.style,{left:"".concat(S,"px"),top:"".concat(_,"px")})}).catch(console.error),this.show()}),this.update=(i,a)=>{A(this,hs).call(this,i,a)},this.destroy=()=>{A(this,hs).cancel()},this.show=i=>{this.element.dataset.show="true",i&&Ig(i,this.element,{placement:"top",middleware:[Rg(),Dg(A(this,ds)),Ag(A(this,fs)),...A(this,ls)],...A(this,cs)}).then(({x:a,y:l})=>{Object.assign(this.element.style,{left:"".concat(a,"px"),top:"".concat(l,"px")})}).catch(console.error),this.onShow()},this.hide=()=>{this.element.dataset.show!=="false"&&(this.element.dataset.show="false",this.onHide())},this.element=e.content,G(this,Vi,(n=e.debounce)!=null?n:200),G(this,Hi,(r=e.shouldShow)!=null?r:lp(this,Bl,Sb)),G(this,ds,e.offset),G(this,fs,e.shift),G(this,ls,(o=e.middleware)!=null?o:[]),G(this,cs,(s=e.floatingUIOptions)!=null?s:{}),G(this,qi,e.root),this.element.dataset.show="false",G(this,hs,KD(A(this,Ui),A(this,Vi)))}}Vi=new WeakMap,Hi=new WeakMap,ls=new WeakMap,cs=new WeakMap,qi=new WeakMap,us=new WeakMap,ds=new WeakMap,fs=new WeakMap,hs=new WeakMap,Ui=new WeakMap,Bl=new WeakSet,Sb=function(e){const{doc:n,selection:r}=e.state,{empty:o,from:s,to:i}=r,a=!n.textBetween(s,i).length&&e.state.selection instanceof he,l=this.element.contains(document.activeElement),c=!e.hasFocus()&&!l,u=!e.editable;return!(c||o||a||u)};function Yh(t){const e=Pt({},"".concat(t,"_TOOLTIP_SPEC")),n=Gt(o=>{const s=o.get(e.key);return new wt({key:new mt("".concat(t,"_TOOLTIP")),...s})}),r=[e,n];return r.key=e.key,r.pluginKey=n.key,e.meta={package:"@milkdown/plugin-tooltip",displayName:"Ctx<tooltipSpec>|".concat(t)},n.meta={package:"@milkdown/plugin-tooltip",displayName:"Prose<tooltip>|".concat(t)},r}const Gh=Pt(null,"tableTooltip"),Pg=Yh("TABLE"),eP=["draggable"],tP=L({__name:"TableSelectorWidget",setup(t){var v;const{spec:e}=$E(),n=e==null?void 0:e.type,r=(v=e==null?void 0:e.index)!=null?v:0,[o,s]=Xi(),i=T(null),a=T(!1),l=O(()=>"absolute bg-grey-200 "+(a.value?"border border-blue-400 border-2":"")),c=O(()=>n==="left"?"w-1w h-100 left-n3-5v top-0 fr-py-1v":n==="top"?"right-px h-1w w-100 left-0 top-n3-5v":"h-3v w-3v left-n2w top-n2w rounded-circle");function u(y){y.stopPropagation();const w=i.value;if(!w||o.value)return;s().action($=>{var E;const S=$.get(Gh.key);(E=S==null?void 0:S.getInstance())==null||E.setProps({getReferenceClientRect:()=>w.getBoundingClientRect()}),S==null||S.show();const _=$.get(me);n==="left"?_.call(Ah.key,r):n==="top"?_.call(Rh.key,r):_.call(Ih.key)})}function d(y){y.stopPropagation();const w={index:e==null?void 0:e.index,type:e==null?void 0:e.type};y.dataTransfer&&(y.dataTransfer.setData("application/milkdown-table-sort",JSON.stringify(w)),y.dataTransfer.effectAllowed="move")}function f(y){a.value=!0,y.stopPropagation(),y.preventDefault(),y.dataTransfer&&(y.dataTransfer.dropEffect="move")}function p(){a.value=!1}function h(y){var $,S;if(a.value=!1,n==="top-left")return;const w=e==null?void 0:e.index;if(o.value||w==null)return;const x=(S=($=y.dataTransfer)==null?void 0:$.getData("application/milkdown-table-sort"))!=null?S:"";try{const{index:_,type:E}=JSON.parse(x);s().action(N=>{const H=N.get(me),Y={from:Number(_),to:w};H.call(E==="left"?Nh.key:Dh.key,Y)})}catch(_){}}return(y,w)=>(b(),k("button",{ref_key:"containerRef",ref:i,draggable:m(n)!=="top-left",class:ae(["table-selector block fr-p-0",c.value+" "+l.value]),onClick:u,onDragstart:d,onDragover:f,onDragleave:p,onDrop:h},null,42,eP))}});const nP=ke(tP,[["__scopeId","data-v-e26c3559"]]);function rP(t){return Gt(()=>{const e=new mt("MILKDOWN_TABLE_SELECTOR");return new wt({key:e,state:{init(){return{decorations:Ie.empty,pos:0}},apply(n,r,o,s){const i=IR(0,n.selection);if(!i)return{decorations:Ie.empty,pos:0};const a=PR(0,n.selection);if(!a)return{decorations:Ie.empty,pos:0};const l=t({as:"div",component:nP}),[c]=i;if(!c)return{decorations:Ie.empty,pos:0};const u=[];return u.push(l(c.pos+1,{type:"top-left"})),i.forEach((d,f)=>{u.push(l(d.pos+1,{type:"left",index:f}))}),a.forEach((d,f)=>{u.push(l(d.pos+1,{type:"top",index:f}))}),r.pos===c.pos&&o.doc.eq(s.doc)?r:{decorations:Ie.create(n.doc,u),pos:c.pos}}},props:{decorations(n){return e.getState(n).decorations}}})})}const Ac=Pt(null,"linkEditTooltip"),Ss=Pt({from:-1,to:-1,mark:null},"linkTooltipStateCtx"),_b=Yh("LINK_EDIT"),Tb=de("InsertLink",t=>()=>()=>$b(t));function $b(t){var o;const e=t.get(Xn),{selection:n}=e.state;if(n.empty)return!1;t.update(Ss.key,()=>({from:n.from,to:n.to,mark:null})),e.dispatch(e.state.tr.setSelection(he.create(e.state.doc,n.from,n.to)));const r=t.get(Ac.key);return(o=r==null?void 0:r.getInstance())==null||o.setProps({getReferenceClientRect:()=>Df(e,n.from,n.to)}),r==null||r.show(),!0}const oP=[Ac,_b,Ss,Tb].flat();function sP(t,e){const n=()=>il(t()),r=T(null);return{tooltipProvider:r,setTooltipProvider:s=>{r.value=s;const i=n();i!=null&&i.ctx&&i.ctx.isInjected(e)&&(i.ctx.set(e,s),r.value=s)}}}function Jh(t,e){const{view:n}=cc(),[r,o]=Xi(),{tooltipProvider:s,setTooltipProvider:i}=sP(o,t);return He([e,r,s,n],([a,l,c,u],[d,f,p,h],v)=>{if(a&&!l&&!c&&u&&u.state){const y=jr(a);if(y instanceof HTMLElement){const w=new QI({content:y,tippyOptions:{zIndex:30},shouldShow:()=>!1});w.update(u),i(w)}v(()=>p==null?void 0:p.destroy())}}),{tooltipProvider:s}}const iP={},aP={class:"bg-white border border-default-grey fr-py-1w fr-px-3v rounded-xxs drop-shadow fr-grid-row fr-grid-row--middle no-wrap"};function lP(t,e){return b(),k("div",aP,[Le(t.$slots,"default")])}const Ob=ke(iP,[["render",lP]]);function cP(t,e,n){const r=t.state.tr;n&&r.removeMark(t.state.selection.from,t.state.selection.to,n),r.addMark(t.state.selection.from,t.state.selection.to,e),t.dispatch(r)}function uP(t,e,n,r){const o=t.state.tr;r&&o.removeMark(e,n,r),t.dispatch(o)}function dP(){const t=T("");at(Mb,t)}function Xh(){const t=Ye(Mb);return{link:ql(t),updateLink(e){t.value=e}}}const Mb=Symbol(),fP=["placeholder","onKeydown"],hP=L({__name:"LinkEditTooltip",setup(t){const{t:e}=be(),n=T(null),{link:r,updateLink:o}=Xh(),s=T("");bt(()=>{s.value=r.value});const{view:i}=cc(),[a,l]=Xi(),{tooltipProvider:c}=Jh(Ac.key,n);function u(){var p;o(""),(p=c.value)==null||p.hide()}function d(){const p=il(l());if(!p)return;const{mark:h}=p.ctx.get(Ss.key),v=Mr.type(p.ctx);if(h&&h.attrs.href===s.value){u();return}cP(i.value,v.create({href:s.value}),h),u()}function f(p){p.key==="Escape"&&u()}return(p,h)=>(b(),j(Ob,{ref_key:"toolTipRef",ref:n},{default:W(()=>[nt(g("input",{class:"input-area",placeholder:m(e)("Paste link..."),ref:"linkInput",onKeydown:[Hd(ye(d,["stop","prevent"]),["enter"]),f],"onUpdate:modelValue":h[0]||(h[0]=v=>s.value=v)},null,40,fP),[[Nr,s.value]]),g("button",{class:ae(["fr-ml-1w fr-button fr-btn--sm fr-btn--tertiary-no-outline",{"fr-hidden":s.value.length===0}]),onClick:d},C(m(e)("Confirm ")),3)]),_:1},512))}});function pP(t){const e=Sf();t.set(_b.key,{view:e({component:hP})})}const Ll=Pt(null,"linkPreviewTooltip"),zl=Yh("LINK_PREVIEW"),mP=[Ll,zl].flat(),gP={class:"text-overflow-ellipsis"},vP=["href"],yP=["title"],bP=L({__name:"LinkPreviewTooltip",setup(t){const{t:e}=be(),n=T(null),{tooltipProvider:r}=Jh(Ll.key,n),{view:o}=cc(),[s,i]=Xi(),{link:a}=Xh();function l(){var p;const u=il(i());if(!u)return;const{from:d,to:f}=u.ctx.get(Ss.key);(p=r.value)==null||p.hide(),o.value.dispatch(o.value.state.tr.setSelection(he.create(o.value.state.doc,d,f))),$b(u.ctx)}function c(){var h;const u=il(i());if(!u)return;const{from:d,to:f,mark:p}=u.ctx.get(Ss.key);p&&uP(o.value,d,f,p),(h=r.value)==null||h.hide()}return(u,d)=>(b(),j(Ob,{ref_key:"toolTipRef",ref:n,class:ae({"fr-hidden":m(a).length===0})},{default:W(()=>[d[0]||(d[0]=g("span",{"aria-hidden":"true",class:"fr-icon-link fr-mr-1w"},null,-1)),g("div",gP,[g("a",{class:"fr-link",href:m(a)},C(m(a)),9,vP)]),g("button",{class:"fr-btn fr-btn--secondary fr-btn--sm fr-icon-pencil-line fr-mx-1w",onClick:l},C(m(e)("Edit link")),1),g("button",{class:"fr-btn fr-btn--tertiary fr-btn--sm fr-icon-link-unlink",title:m(e)("Remove link"),onClick:c},C(m(e)("Remove link")),9,yP)]),_:1},8,["class"]))}});function wP(t,e,n,r){let o={start:-1,end:-1};return e.nodesBetween(n,r,(s,i)=>{if(o.start>-1)return!1;o.start===-1&&t.isInSet(s.marks)&&(o={start:i,end:i+Math.max(s.textContent.length,1)})}),o}function kP(t,e){return t.marks.find(n=>n.type===e)}function CP(t,e){const n=e.posAtCoords(t);if(!n)return{node:null,pos:null};const{pos:r}=n;return{node:e.state.doc.nodeAt(r),pos:r}}function xP(t,e,n){const{node:r,pos:o}=CP({left:n.clientX,top:n.clientY},e);if(!r)return;const s=kP(r,Mr.mark.type(t));if(!(!s||!zl.pluginKey()))return{show:!0,pos:o,node:r,mark:s}}const Lg=200;function SP(t,e){const n=Sf(),r=T(!1),o=()=>{r.value=!0},s=()=>{r.value=!1},i=Zl((l,c)=>{var f,p,h;if(!l.hasFocus())return;const u=xP(t,l,c),d=t.get(Ll.key);if(u){const v=l.state.doc.resolve(u.pos),y=wP(u.mark,l.state.doc,v.before(),v.after()),w=t.get(zl.key);if(!w||!w.view)return;(f=d==null?void 0:d.getInstance())==null||f.setProps({getReferenceClientRect:()=>Df(l,y.start,y.end)}),t.update(Ss.key,()=>({from:y.start,to:y.end,mark:u.mark})),e(u.mark.attrs.href),d==null||d.show(),(p=d==null?void 0:d.getInstance())==null||p.popper.addEventListener("mouseenter",o),(h=d==null?void 0:d.getInstance())==null||h.popper.addEventListener("mouseleave",s);return}a()},Lg),a=()=>{setTimeout(()=>{var u,d,f;if(r.value)return;const l=t.get(Ll.key),c=t.get(Ac.key);l==null||l.hide(),(u=c==null?void 0:c.getInstance())!=null&&u.state.isVisible||e(""),(d=l==null?void 0:l.getInstance())==null||d.popper.removeEventListener("mouseenter",o),(f=l==null?void 0:l.getInstance())==null||f.popper.removeEventListener("mouseleave",s)},Lg)};t.set(zl.key,{props:{handleDOMEvents:{mousemove:i,mouseleave:a}},view:n({component:bP})})}const _P='<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M3 6H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 14H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M6 10L18 10" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M6 18L18 18" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',TP='<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M3 10L17 10" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 6H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 18L17 18" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 14H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',$P='<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M7 10L21 10" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 6H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M7 18L21 18" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 14H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',OP=["innerHTML"],ir=L({__name:"TooltipButton",props:{icon:{},svg:{}},emits:["click"],setup(t,{emit:e}){const n=t,r=n.icon?n.icon:"fr-icon-svg",o=e;return(s,i)=>(b(),k("button",{class:ae(["fr-btn fr-btn--secondary fr-btn--sm bg-white",m(r)]),onClick:i[0]||(i[0]=a=>o("click"))},[t.svg?(b(),k("div",{key:0,innerHTML:t.svg},null,8,OP)):I("",!0),Le(s.$slots,"default")],2))}}),MP={class:"fr-hidden"},EP=L({__name:"TableTooltip",setup(t){const{t:e}=be(),n=T(null),{view:r}=cc(),[o,s]=Xi(),{tooltipProvider:i}=Jh(Gh.key,n),a=O(()=>r.value.state.selection instanceof Be&&r.value.state.selection.isRowSelection()),l=O(()=>r.value.state.selection instanceof Be&&r.value.state.selection.isColSelection()),c=O(()=>a.value&&l.value),u=O(()=>a.value||l.value),d=O(()=>{var f;return a.value&&((f=r.value.state.doc.nodeAt(r.value.state.selection.$headCell.pos))==null?void 0:f.type.name)==="table_header"});return(f,p)=>(b(),k("div",MP,[g("div",{class:"fr-grid-row",ref_key:"toolTipRef",ref:n},[!c.value&&!d.value&&a.value?(b(),j(ir,{key:0,icon:"fr-icon-arrow-up-line",class:"fr-mr-1v",title:m(e)("Add row before"),onClick:p[0]||(p[0]=()=>{var h,v;m(o)||((h=m(s)())==null||h.action(y=>{y.get(m(me)).call(m(Bh).key)}),(v=m(i))==null||v.hide())})},null,8,["title"])):I("",!0),!c.value&&l.value?(b(),j(ir,{key:1,icon:"fr-icon-arrow-left-line",class:"fr-mr-1v",title:m(e)("Add column before"),onClick:p[1]||(p[1]=()=>{var h,v;m(o)||((h=m(s)())==null||h.action(y=>{y.get(m(me)).call(m(Lh).key)}),(v=m(i))==null||v.hide())})},null,8,["title"])):I("",!0),c.value||!d.value&&u.value?(b(),j(ir,{key:2,icon:"fr-icon-delete-line",class:"fr-mr-1v",title:m(e)("Delete selected cells"),onClick:p[2]||(p[2]=()=>{var h,v;m(o)||((h=m(s)())==null||h.action(y=>{y.get(m(me)).call(m(Ph).key)}),(v=m(i))==null||v.hide())})},null,8,["title"])):I("",!0),!c.value&&a.value?(b(),j(ir,{key:3,icon:"fr-icon-arrow-down-line",class:"fr-mr-1v",title:m(e)("Add row after"),onClick:p[3]||(p[3]=()=>{var h,v;m(o)||((h=m(s)())==null||h.action(y=>{y.get(m(me)).call(m(Fh).key)}),(v=m(i))==null||v.hide())})},null,8,["title"])):I("",!0),!c.value&&l.value?(b(),k(K,{key:4},[M(ir,{icon:"fr-icon-arrow-right-line",class:"fr-mr-1v",title:m(e)("Add column after"),onClick:p[4]||(p[4]=()=>{var h,v;m(o)||((h=m(s)())==null||h.action(y=>{y.get(m(me)).call(m(zh).key)}),(v=m(i))==null||v.hide())})},null,8,["title"]),M(ir,{svg:m(TP),class:"fr-mr-1v",title:m(e)("Align left"),onClick:p[5]||(p[5]=()=>{var h;m(o)||(h=m(s)())==null||h.action(v=>{v.get(m(me)).call(m(pi).key,"left")})})},null,8,["svg","title"]),M(ir,{class:"fr-mr-1v",svg:m(_P),title:m(e)("Align center"),onClick:p[6]||(p[6]=()=>{var h;m(o)||(h=m(s)())==null||h.action(v=>{v.get(m(me)).call(m(pi).key,"center")})})},null,8,["svg","title"]),M(ir,{class:"fr-mr-1v",svg:m($P),title:m(e)("Align right"),onClick:p[7]||(p[7]=()=>{var h;m(o)||(h=m(s)())==null||h.action(v=>{v.get(m(me)).call(m(pi).key,"right")})})},null,8,["svg","title"])],64)):I("",!0)],512)]))}});const NP={class:"editor__container"},DP={class:"fr-mx-auto fr-grid-row fr-pb-1v",role:"menubar"},AP={role:"group",class:"fr-pr-1w"},RP={role:"group",class:"fr-pr-1w"},IP={role:"group",class:"fr-px-1w"},PP={role:"group",class:"fr-pl-1w"},LP={class:"fr-p-1v"},zP=L({__name:"InternalEditor",props:{ariaLabel:{},ariaLabelledBy:{},id:{},disabled:{type:Boolean,default:!1},value:{default:""}},emits:["change","editorMounted"],setup(t,{emit:e}){const n=t,r=e,o=Zl(p=>r("change",p),300),{t:s}=be(),i=Sf(),a=OE(),{updateLink:l}=Xh(),c=Tu.findIndex(p=>p===cb);Tu[c]=dI;const u=[Tu,Pg,Gh,p=>async()=>{p.set(Pg.key,{view:i({component:EP})})},rP(a)].flat(),d=P7(p=>$d.make().config(h=>{h.set(Za,p),pP(h),SP(h,l),h.set(Ka,n.value),h.set(wc.key,v=>{const y=v.attrs.level;return y===1?{class:"fr-h1"}:y===2?{class:"fr-h2"}:y===3?{class:"fr-h3"}:y===4?{class:"fr-h4"}:y===5?{class:"fr-h5"}:y===6?{class:"fr-h6"}:{}}),h.update(Xa,v=>{const y=v.attributes;return{...v,attributes:w=>{const x=typeof y=="function"?y(w):y!=null?y:{};return x.id=n.id,x["data-testid"]="markdown-editor",n.ariaLabelledBy?x["aria-labelledby"]=n.ariaLabelledBy:n.ariaLabel&&(x.ariaLabel=n.ariaLabel),{...x}},editable:()=>!n.disabled}}),h.set(yc.key,()=>({class:"text-lg"})),h.get(Nl).markdownUpdated((v,y,w)=>o(y)),h.get(Nl).mounted(v=>{r("editorMounted")})}).use(TA).use(u).use(gD).use(oP).use(mP).use(b0));function f(p,h){var v;return(v=d.get())==null?void 0:v.action(mD(p,h))}return(p,h)=>(b(),k("div",NP,[g("div",DP,[g("div",AP,[M(zt,{icon:"fr-icon-arrow-go-back-line",onClick:h[0]||(h[0]=()=>f(m(hc).key)),title:m(s)("Undo")},null,8,["title"]),M(zt,{icon:"fr-icon-arrow-go-forward-line",onClick:h[1]||(h[1]=()=>f(m(pc).key)),title:m(s)("Redo")},null,8,["title"])]),h[13]||(h[13]=g("div",{role:"separator",class:"w-1px bg-grey-125 fr-my-1v"},null,-1)),g("div",RP,[M(zt,{icon:"fr-icon-bold",onClick:h[2]||(h[2]=()=>f(m(gc).key)),title:m(s)("Bold")},null,8,["title"]),M(zt,{icon:"fr-icon-italic",onClick:h[3]||(h[3]=()=>f(m(mc).key)),title:m(s)("Italic")},null,8,["title"]),M(zt,{icon:"fr-icon-h-1",onClick:h[4]||(h[4]=()=>f(m(wn).key,3)),title:m(s)("Title")},null,8,["title"]),M(zt,{icon:"fr-icon-h-2",onClick:h[5]||(h[5]=()=>f(m(wn).key,4)),title:m(s)("Subtitle")},null,8,["title"])]),h[14]||(h[14]=g("div",{role:"separator",class:"w-1px bg-grey-125 fr-my-1v"},null,-1)),g("div",IP,[M(zt,{icon:"fr-icon-table-2",onClick:h[6]||(h[6]=()=>f(m(Eh).key)),title:m(s)("Table")},null,8,["title"]),M(zt,{icon:"fr-icon-link",onClick:h[7]||(h[7]=()=>f(m(Tb).key)),title:m(s)("Link")},null,8,["title"]),M(cI,{onSend:h[8]||(h[8]=v=>f(m(Qf).key,v))})]),h[15]||(h[15]=g("div",{role:"separator",class:"w-1px bg-grey-125 fr-my-1v"},null,-1)),g("div",PP,[M(zt,{icon:"fr-icon-list-unordered",onClick:h[9]||(h[9]=()=>f(m(xc).key)),title:m(s)("List unordered")},null,8,["title"]),M(zt,{icon:"fr-icon-list-ordered",onClick:h[10]||(h[10]=()=>f(m(Sc).key)),title:m(s)("List ordered")},null,8,["title"]),M(zt,{icon:"fr-icon-code-s-slash-line",onClick:h[11]||(h[11]=()=>f(m(Cc).key)),title:m(s)("Code block")},null,8,["title"]),M(zt,{icon:"fr-icon-quote-line",onClick:h[12]||(h[12]=()=>f(m(kc).key)),title:m(s)("Quote")},null,8,["title"])])]),g("div",LP,[M(m(R7))])]))}}),BP=L({__name:"MarkdownEditor",props:{ariaLabel:{},ariaLabelledBy:{},id:{},disabled:{type:Boolean},value:{}},emits:["change","editorMounted"],setup(t){const e=t;return dP(),(n,r)=>(b(),j(m(I7),null,{default:W(()=>[M(m(NE),null,{default:W(()=>[M(zP,Tn(e,{onChange:r[0]||(r[0]=o=>n.$emit("change",o)),onEditorMounted:r[1]||(r[1]=o=>n.$emit("editorMounted"))}),null,16)]),_:1})]),_:1}))}}),FP=["for"],VP={key:0,class:"fr-hint-text"},HP=["aria-describedby","id","disabled","type","value","placeholder","required"],qP={key:1,class:"fr-mt-1w"},UP=["aria-describedby","id","disabled","type","placeholder","value","required"],WP=["id"],jP=["id"],nl=L({__name:"InputGroup",props:{ariaDescribedby:{default:""},disabled:{type:Boolean,default:!1},errorText:{default:""},hasError:{type:Boolean,default:!1},hasWarning:{type:Boolean,default:!1},hintText:{default:""},isValid:{type:Boolean,default:!1},label:{},modelValue:{default:void 0},placeholder:{default:""},required:{type:Boolean,default:!1},type:{default:"text"},validText:{default:""}},emits:["change","update:modelValue"],setup(t,{expose:e,emit:n}){const r=n,o=t,{id:s}=$s("input");e({id:s});const i=O(()=>s+"-desc-error"),a=O(()=>s+"-desc-valid"),l=O(()=>{let f=o.ariaDescribedby?o.ariaDescribedby+" ":"";return o.isValid?f+=a.value:o.hasError&&(f+=i.value),f}),c=O(()=>({"fr-input-group--disabled":o.disabled,"fr-input-group--error":o.hasError,"fr-input-group--warning":!o.hasError&&o.hasWarning,"fr-input-group--valid":o.isValid})),u=Bg(Bd);function d(f){let p;if(f instanceof Event){const h=f.target;p=h==null?void 0:h.value}else p=f;r("update:modelValue",p),r("change",p)}return(f,p)=>(b(),k("div",{class:ae(["fr-input-group",c.value])},[g("label",{class:"fr-label",for:m(s)},[U(C(t.label)+" ",1),M(tf,{required:t.required},null,8,["required"]),t.hintText?(b(),k("span",VP,C(t.hintText),1)):I("",!0)],8,FP),t.type==="textarea"?(b(),k("textarea",{key:0,class:ae(["fr-input",{"fr-input--error":t.hasError,"fr-input--warning":!t.hasError&&m(Zu),"fr-input--valid":t.isValid}]),"aria-describedby":l.value,id:m(s),disabled:t.disabled,type:t.type,value:t.modelValue,placeholder:t.placeholder,onChange:d,required:t.required},null,42,HP)):t.type==="date"?(b(),k("div",qP,[M(m(gv),{class:ae(["fr-input",{"fr-input--error":t.hasError,"fr-input--valid":t.isValid}]),"aria-describedby":l.value,id:m(s),disabled:t.disabled,modelValue:t.modelValue,onChange:d,locale:m(u),inputFormat:"P"},null,8,["class","aria-describedby","id","disabled","modelValue","locale"])])):t.type==="range"?(b(),j(D7,{key:2,modelValue:t.modelValue,onChange:d},null,8,["modelValue"])):t.type==="markdown"?(b(),j(BP,{key:3,class:ae(["fr-mt-1w",{"fr-input--error":t.hasError,"fr-input--warning":!t.hasError&&m(Zu),"fr-input--valid":t.isValid}]),"aria-describedby":l.value,id:m(s),disabled:t.disabled,value:t.modelValue,placeholder:t.placeholder,onChange:d,required:t.required},null,8,["class","aria-describedby","id","disabled","value","placeholder","required"])):(b(),k("input",{key:4,class:ae(["fr-input",{"fr-input--error":t.hasError,"fr-input--valid":t.isValid}]),"aria-describedby":l.value,id:m(s),disabled:t.disabled,type:t.type,placeholder:t.placeholder,value:t.modelValue,onChange:d,required:t.required},null,42,UP)),t.isValid?(b(),k("p",{key:5,id:a.value,class:"fr-valid-text"},C(t.validText),9,WP)):t.hasError?(b(),k("p",{key:6,id:i.value,class:"fr-error-text"},C(t.errorText),9,jP)):I("",!0)],2))}}),KP=["aria-labelledby","id"],YP={class:"fr-container fr-container--fluid fr-container-md"},GP={class:"fr-grid-row fr-grid-row--center"},JP={class:"fr-col-12 fr-col-md-8"},XP={class:"fr-modal__body"},ZP={class:"fr-modal__header"},QP=["title","aria-controls","disabled"],eL={class:"fr-modal__content"},tL=["id"],nL=["href"],rL={class:"fr-modal__footer"},oL={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-lg fr-btns-group--icon-left"},sL=["aria-controls"],iL={class:"fr-modal__content"},aL=["id"],lL=["href"],cL={class:"fr-modal__footer"},uL={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-lg fr-btns-group--icon-left"},dL=["aria-controls","disabled"],fL=L({__name:"ReportModal",props:{id:{},loading:{type:Boolean},succeeded:{type:Boolean}},emits:["send"],setup(t,{emit:e}){const n=e,{t:r}=be(),o=xo("modal-title"),s=T(),i={reason:"",message:""},a=So({...i}),l=T([]),c={reason:{required:Du},message:{required:Du}},{getErrorText:u,getFunctionalState:d,hasError:f,reset:p,validateRequiredRules:h,v$:v}=mv(a,c,c),y=S=>f(w,S),w=O(()=>({reason:d(v.value.reason.$dirty,v.value.reason.$error,!1),message:d(v.value.message.$dirty,v.value.message.$error,!1)}));function x(){globalThis.dsfr(s.value).modal.conceal(),a.message=i.message,a.reason=i.reason,p()}function $(){h().then(S=>{S&&n("send",{...a})})}return De(async()=>{l.value=await xO()}),(S,_)=>{const E=Je("i18n-t");return b(),j(Pr,{to:"body"},[g("dialog",Tn(S.$attrs,{"aria-labelledby":m(o),id:t.id,role:"dialog",class:"fr-modal",ref_key:"modalRef",ref:s}),[g("div",YP,[g("div",GP,[g("div",JP,[g("div",XP,[g("div",ZP,[g("button",{class:"fr-btn--close fr-btn",title:m(r)("Close the modal dialog"),"aria-controls":t.id,target:"_self",disabled:t.loading,onClick:x},C(m(r)("Close")),9,QP)]),t.succeeded?(b(),k(K,{key:0},[g("div",eL,[g("h2",{id:m(o),class:"fr-mb-2w"},[_[2]||(_[2]=g("span",{class:"fr-icon-success-line fr-icon--lg"},null,-1)),U(C(m(r)("Thanks for reporting this content")),1)],8,tL),M(E,{keypath:"{site} team will examine the content to check if it breaks our {markup}. Thanks for your help.",tag:"p",class:"fr-mt-0 fr-mb-1w fr-text--xs",scope:"global"},{site:W(()=>[U(C(m(Fg)),1)]),markup:W(()=>[g("a",{href:m(fp)},C(m(r)("usage policy")),9,nL)]),_:1})]),g("div",rL,[g("div",oL,[g("button",{class:"fr-btn","aria-controls":t.id,target:"_self",onClickCapture:ye(x,["prevent","stop"])},C(m(r)("Close")),41,sL)])])],64)):(b(),k(K,{key:1},[g("div",iL,[g("h2",{id:m(o),class:"fr-mb-2w"},C(m(r)("Report this content")),9,aL),M(m(cl),{class:"fr-mb-2w",color:"warning",weight:"regular"},{default:W(()=>[_[3]||(_[3]=g("span",{class:"fr-icon-warning-line fr-mr-1v","aria-hidden":"true"},null,-1)),U(" "+C(m(r)("Please only report in case of serious concern."))+" ",1),g("a",{href:m(fp)},C(m(r)("See our usage policy")),9,lL)]),_:1}),M(jO,{label:m(r)("Report reason"),required:!0,modelValue:a.reason,"onUpdate:modelValue":_[0]||(_[0]=D=>a.reason=D),hasError:y("reason"),errorText:m(u)("reason"),options:l.value},null,8,["label","modelValue","hasError","errorText","options"]),M(nl,{type:"textarea",label:m(r)("Message"),required:!0,hasError:y("message"),errorText:m(u)("message"),modelValue:a.message,"onUpdate:modelValue":_[1]||(_[1]=D=>a.message=D),placeholder:m(r)("Reason of your report.{newline}Don't include any personal data.")},null,8,["label","hasError","errorText","modelValue","placeholder"])]),g("div",cL,[g("div",uL,[g("button",{class:"fr-btn","aria-controls":t.id,target:"_self",disabled:t.loading,onClickCapture:ye($,["prevent","stop"])},C(m(r)("Send")),41,dL)])])],64))])])])])],16,KP)])}}}),hL=["aria-controls","disabled","title"],pL=L({__name:"ReportModalButton",props:{objectType:{},objectId:{}},setup(t){const e=t,{t:n}=be(),{toast:r}=sn(),o=T(!1),s=T(!1),i=xo();async function a(l){try{o.value=!0,await SO(e.objectType,e.objectId,l.reason,l.message),s.value=!0}catch(c){r.error(n("An unexpected error occured while reporting this content."))}finally{o.value=!1}}return(l,c)=>(b(),k(K,null,[g("button",Tn({class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 fr-icon-flag-line","data-fr-opened":"false","aria-controls":m(i)},l.$attrs,{disabled:o.value,title:m(n)("Make a report")}),C(m(n)("Make a report")),17,hL),M(fL,{id:m(i),loading:o.value,succeeded:s.value,onSend:a},null,8,["id","loading","succeeded"])],64))}}),mL={class:"fr-grid-row fr-grid-row--middle justify-between","data-cy":"search"},gL={class:"fr-search-bar fr-search-bar--lg w-100"},vL=["for"],yL=["id","aria-label","placeholder"],bL={class:"fr-btn",type:"submit"},wL={class:"fr-grid-row fr-mt-1w fr-mt-md-5v"},kL={class:"fr-col-12 fr-col-md-4 fr-col-lg-3"},CL={class:"fr-sidemenu","aria-labelledby":"fr-sidemenu-title"},xL={class:"fr-sidemenu__inner"},SL={class:"fr-sidemenu__btn fr-mt-1w",hidden:"","aria-controls":"fr-sidemenu-wrapper","aria-expanded":"false"},_L={class:"fr-collapse",id:"fr-sidemenu-wrapper"},TL={class:"fr-sidemenu__title fr-mb-3v",id:"fr-sidemenu-title"},$L={class:"fr-grid-row fr-grid-row--gutters"},OL={key:0,class:"fr-col-12"},ML={class:"fr-col-12"},EL={class:"fr-select-group"},NL=["for"],DL=["id"],AL={value:null},RL={value:!1},IL={value:!0},PL={key:1,class:"fr-col-12 fr-mb-3w text-align-center"},LL={class:"fr-col-12 fr-col-md-8 fr-col-lg-9 fr-mt-2w fr-mt-md-0 search-results"},zL={key:0},BL={key:1,class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle justify-between fr-pb-1w"},FL={class:"fr-col-auto fr-my-0",role:"status"},VL={key:2},HL={class:"fr-mt-1w border-default-grey border-top relative z-2"},qL={key:3,class:"fr-mt-2w"},UL=L({__name:"DataservicesSearch",props:{organization:{default:""}},setup(t){const e=t,{t:n}=be(),{toast:r}=jk(),o=T(null);He(o,()=>a.value=1);const s=T(null);He(s,()=>a.value=1);const i=mp(),a=T(1),l=O(()=>o.value||s.value!==null),c=()=>{o.value="",s.value=null},u=()=>{f.value="",c(),v()},d=mp(),f=T(""),p=F2(f,500),h=ww("searchInputRef"),v=()=>{h.value&&h.value.scrollIntoView({behavior:"smooth"})},y=O(()=>{const N={};return o.value&&(N.organization=o.value),p.value&&(N.q=p.value),s.value!==null&&(N.is_restricted=s.value.toString()),e.organization&&(N.organization=e.organization),a.value&&a.value!==1&&(N.page=a.value.toString()),new URLSearchParams(N)}),{ignoreUpdates:w}=V2(y,()=>{let N=new URL(window.location.href);N.search=y.value.toString(),window.history.pushState(null,"",N)}),x=O(()=>"/dataservices/search/?".concat(y.value)),$=T(null),S=T(null);He(f,()=>{S.value&&S.value.abort(),a.value=1});const _=async()=>{$.value=null,S.value=new AbortController;try{const N=await ji.get(x.value,{signal:S.value.signal});S.value=null,$.value=N.data}catch(N){xn.isCancel(N)||r.error(n("Error getting search results."))}},E=()=>{const N=new URL(window.location.href);o.value=N.searchParams.get("organization"),f.value=N.searchParams.get("q")||"",N.searchParams.get("is_restricted")==="true"?s.value=!0:N.searchParams.get("is_restricted")==="false"?s.value=!1:s.value=null,a.value=parseInt(N.searchParams.get("page")||"1")};De(()=>{var N;E(),_(),(N=h.value)==null||N.focus(),window.addEventListener("popstate",()=>{w(()=>{E()})})}),He(x,()=>{_()});const D=N=>{a.value=N};return(N,H)=>(b(),k("form",{class:"fr-pt-3v",onSubmit:ye(_,["prevent"])},[g("div",mL,[g("section",gL,[g("label",{class:"fr-label",for:m(d)},C(m(n)("Search")),9,vL),nt(g("input",{id:m(d),type:"search","onUpdate:modelValue":H[0]||(H[0]=Y=>f.value=Y),ref:"searchInputRef",class:"fr-input","aria-label":m(n)("Search..."),placeholder:m(n)("Search..."),"data-cy":"search-input","data-testid":"search-input"},null,8,yL),[[Nr,f.value]]),g("button",bL,C(m(n)("Search")),1)])]),g("div",wL,[g("div",kL,[g("nav",CL,[g("div",xL,[g("button",SL,C(m(n)("Filter results")),1),g("div",_L,[g("div",TL,C(m(n)("Filters")),1),g("div",$L,[e.organization?I("",!0):(b(),k("div",OL,[M(Ln,{placeholder:m(n)("Organizations"),searchPlaceholder:m(n)("Search an organization..."),allOption:m(n)("All organizations"),listUrl:"/organizations/?sort=-followers",suggestUrl:"/organizations/suggest/",entityUrl:"/organizations/",values:o.value,onChange:H[1]||(H[1]=Y=>o.value=Y),isBlue:!0},null,8,["placeholder","searchPlaceholder","allOption","values"])])),g("div",ML,[g("div",EL,[g("label",{class:"fr-label",for:m(i)},C(m(n)("Access terms")),9,NL),nt(g("select",{class:ae(["fr-select",{"text-mention-grey":s.value===null}]),id:m(i),"onUpdate:modelValue":H[2]||(H[2]=Y=>s.value=Y)},[g("option",AL,C(m(n)("All access terms")),1),g("option",RL,C(m(n)("Open APIs to everyone")),1),g("option",IL,C(m(n)("Restricted access APIs")),1)],10,DL),[[Ul,s.value]])])]),l.value?(b(),k("div",PL,[g("button",{class:"fr-btn fr-btn--secondary fr-icon-close-circle-line fr-btn--icon-left justify-center w-100",onClick:c},C(m(n)("Reset filters")),1)])):I("",!0)])])])])]),g("section",LL,[$.value===null?(b(),k("div",zL,[M(ef)])):I("",!0),$.value!==null?(b(),k("div",BL,[g("p",FL,C(m(n)("{count} API",$.value.total)),1)])):I("",!0),$.value!==null&&$.value.data.length?(b(),k("div",VL,[g("ul",HL,[(b(!0),k(K,null,Ne($.value.data,Y=>(b(),k("li",{key:Y.id},[M(m(N1),{dataservice:Y,dataserviceUrl:Y.self_web_url},null,8,["dataservice","dataserviceUrl"])]))),128))]),$.value!==null&&$.value.total>$.value.page_size?(b(),j(m(_o),{key:0,page:a.value,pageSize:$.value.page_size,totalResults:$.value.total,onChange:D,class:"fr-mt-2w"},null,8,["page","pageSize","totalResults"])):(b(),j(pl,{key:1,onResetFilters:u}))])):I("",!0),$.value!==null&&$.value.data.length===0?(b(),k("div",qL,[M(pl,{onResetFilters:u})])):I("",!0)])])],32))}});Xb({admin_root:Zb,api_root:Qb,api_2_root:ew,default_lang:Au.global.locale.value,only_locales:Au.global.locale.value,schema_documentation_url:tw,schema_validata_url:nw,show_copy_resource_permalink:!0,tabular_api_dataservice_id:rw,tabular_api_url:ow,tabular_page_size:sw,title:Fg});const WL=async t=>{const e=kw({});if(iw.dsn)try{const{default:n}=await dr(()=>import("./sentry.6.2.4.js"),["js/sentry.6.2.4.js","js/i18n.6.2.4.js","js/_commonjsHelpers.6.2.4.js"]);await n(e)}catch(n){console.warn("Failed to load Sentry:",n)}e.use(aw),e.use(k$),e.use(lw),e.use(Au),e.component("chart",uS),e.component("dataset-resources",B$),e.component("dataset-resource-from-hash",b$),e.component("dataservice-card",N1),e.component("dataservice-links",fO),e.component("delete-button",A6),e.component("delete-user-button",J6),e.component("discussion-threads",z5),e.component("discussion-create",B1),e.component("featured-button",n$),e.component("follow-button",a$),e.component("menu-search",Z5),e.component("owner-type",P3),e.component("owner-type-icon",Gd),e.component("read-more",A1),e.component("report-button",pL),e.component("request-membership",u$),e.component("reuse-card",lv),e.component("search",k6),e.component("dataservices-search",UL),e.component("toggletip",Zd),e.component("user-dataset-list",U$),e.component("user-reuse-list",Z$),e.config.compilerOptions.delimiters=["",""],e.mount(t)},jL=document.querySelectorAll(".vuejs");jL.forEach(t=>{const e=t.innerHTML;try{WL(t)}catch(n){throw t.innerHTML=e,console.log("VueJS template compilation failed for element ".concat(t.className,".\n      Aborted the process and rolled back the HTML.\n      See error(s) above and below (probably won't help you tho) :")),console.log(t),console.error(n),n}});globalThis.dsfr.start();console.log("JS is injected !");CO();export{Ap as _,YL as __vite_legacy_guard,$T as a,X as b};
