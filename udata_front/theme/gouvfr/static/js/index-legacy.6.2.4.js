!function(){const e=["eventFilter"],t=["window"],n=["visible","features","ourProps","theirProps"],r=["as"],o=["features"],i=["force"],a=["target"],s=["focus"],l=["tabIndex"],c=["page","sort"],u=["q"],d=["children"],p=["children"],h=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"],f=["mainAxis","crossAxis","limiter"];function m(){m=function(e,t){return new n(e,void 0,t)};var e=RegExp.prototype,t=new WeakMap;function n(e,r,o){var i=RegExp(e,r);return t.set(i,o||t.get(e)),g(i,n.prototype)}function r(e,n){var r=t.get(n);return Object.keys(r).reduce(function(t,n){var o=r[n];if("number"==typeof o)t[n]=e[o];else{for(var i=0;void 0===e[o[i]]&&i+1<o.length;)i++;t[n]=e[o[i]]}return t},Object.create(null))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(n,RegExp),n.prototype.exec=function(t){var n=e.exec.call(this,t);if(n){n.groups=r(n,this);var o=n.indices;o&&(o.groups=r(o,this))}return n},n.prototype[Symbol.replace]=function(n,o){if("string"==typeof o){var i=t.get(this);return e[Symbol.replace].call(this,n,o.replace(/\$<([^>]+)(>|$)/g,function(e,t,n){if(""===n)return e;var r=i[t];return Array.isArray(r)?"$"+r.join("$"):"number"==typeof r?"$"+r:""}))}if("function"==typeof o){var a=this;return e[Symbol.replace].call(this,n,function(){var e=arguments;return"object"!=typeof e[e.length-1]&&(e=[].slice.call(e)).push(r(e,a)),o.apply(this,e)})}return e[Symbol.replace].call(this,n,o)},m.apply(this,arguments)}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}function v(e,t,n){y(e,t),t.set(e,n)}function y(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function w(e,t){return e.get(k(e,t))}function b(e,t,n){return e.set(k(e,t),n),n}function k(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function x(e){if(null==e)throw new TypeError("Cannot destructure "+e)}function C(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach(function(t){T(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function T(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}System.register(["./i18n-legacy.6.2.4.js","vue","vue-content-loader","./_commonjsHelpers-legacy.6.2.4.js"],function(g,S){"use strict";var T,O,_,N,E,D,A,$,R,L,I,P,z,B,F,j,V,q,H,U,W,K,Y,J,G,X,Z,Q,ee,te,ne,re,oe,ie,ae,se,le,ce,ue,de,pe,he,fe,me,ge,ve,ye,we,be,ke,xe,Ce,Se,Me,Te,Oe,_e,Ne,Ee,De,Ae,$e,Re,Le,Ie,Pe,ze,Be,Fe,je,Ve,qe,He,Ue,We,Ke,Ye,Je,Ge,Xe,Ze,Qe,et,tt,nt,rt,ot,it,at,st,lt,ct,ut,dt,pt,ht,ft,mt,gt,vt,yt,wt,bt,kt,xt,Ct,St,Mt,Tt,Ot,_t,Nt,Et,Dt,At,$t,Rt,Lt,It,Pt,zt,Bt,Ft,jt,Vt,qt,Ht,Ut,Wt,Kt,Yt,Jt,Gt,Xt,Zt,Qt,en,tn,nn,rn,on,an,sn,ln,cn;return{setters:[e=>{T=e.a,O=e.g,_=e.c,N=e.r,E=e.R,D=e.y,A=e.b,$=e.d,R=e.s,L=e.p,I=e.e,P=e.f,z=e.h,B=e.i,F=e.j,j=e.n,V=e.t,q=e.k,H=e.u,U=e._,W=e.Z,K=e.l,Y=e.m,J=e.o,G=e.q,X=e.v,Z=e.w,Q=e.x,ee=e.z,te=e.A,ne=e.C,re=e.B,oe=e.D,ie=e.E,ae=e.F,se=e.G,le=e.H,ce=e.I,ue=e.J,de=e.K,pe=e.L,he=e.M,fe=e.N,me=e.O,ge=e.P,ve=e.Q,ye=e.S,we=e.T,be=e.U,ke=e.V,xe=e.W,Ce=e.X,Se=e.Y,Me=e.$,Te=e.a0,Oe=e.a1,_e=e.a2,Ne=e.a3,Ee=e.a4,De=e.a5,Ae=e.a6,$e=e.a7,Re=e.a8,Le=e.a9,Ie=e.aa,Pe=e.ab,ze=e.ac,Be=e.ad,Fe=e.ae,je=e.af,Ve=e.ag,qe=e.ah,He=e.ai,Ue=e.aj,We=e.ak,Ke=e.al},e=>{Ye=e.defineComponent,Je=e.inject,Ge=e.useAttrs,Xe=e.computed,Ze=e.openBlock,Qe=e.createElementBlock,et=e.mergeProps,tt=e.renderSlot,nt=e.createBlock,rt=e.unref,ot=e.normalizeProps,it=e.withCtx,at=e.withAsyncContext,st=e.createCommentVNode,lt=e.normalizeClass,ct=e.ref,ut=e.createVNode,dt=e.createElementVNode,pt=e.toDisplayString,ht=e.toValue,ft=e.watch,mt=e.onMounted,gt=e.nextTick,vt=e.getCurrentInstance,yt=e.getCurrentScope,wt=e.onScopeDispose,bt=e.customRef,kt=e.onUpdated,xt=e.isRef,Ct=e.shallowRef,St=e.watchEffect,Mt=e.Fragment,Tt=e.createTextVNode,Ot=e,_t=e.cloneVNode,Nt=e.h,Et=e.provide,Dt=e.onUnmounted,At=e.Teleport,$t=e.reactive,Rt=e.Suspense,Lt=e.normalizeStyle,It=e.resolveDynamicComponent,Pt=e.renderList,zt=e.withModifiers,Bt=e.defineAsyncComponent,Ft=e.readonly,jt=e.resolveComponent,Vt=e.withDirectives,qt=e.vModelText,Ht=e.onBeforeMount,Ut=e.onBeforeUnmount,Wt=e.Transition,Kt=e.vShow,Yt=e.render,Jt=e.TransitionGroup,Gt=e.vModelSelect,Xt=e.withKeys,Zt=e.isReactive,Qt=e.isReadonly,en=e.pushScopeId,tn=e.popScopeId,nn=e.markRaw,rn=e.toRaw,on=e.useId,an=e.useTemplateRef,sn=e.createApp},e=>{ln=e.ContentLoader},e=>{e.c,cn=e.g}],execute:function(){g({_:Ch,a:Sh,b:Ih});let un=null;async function dn(){if(un)return un;const e=T.get(O("reuses/types/")),t=await e;return un=t.data,un}let pn=null;async function hn(){return pn||(pn=T.get("datasets/schemas/").then(e=>e.data),pn)}const fn=["href"],mn=Ye({__name:"AppLink",props:{to:{},custom:{type:Boolean},activeClass:{},exactActiveClass:{},ariaCurrentValue:{default:"page"},viewTransition:{type:Boolean},replace:{type:Boolean}},setup(e){const t=Je(N,null),n=Ge(),r=Xe(()=>M(M({},n),{},{target:t?"_blank":n.target}));return(n,o)=>function(e){return!t||"string"==typeof e&&e.startsWith("http")}(e.to)?(Ze(),Qe("a",et({key:0},r.value,{href:e.to}),[tt(n.$slots,"default")],16,fn)):(Ze(),nt(rt(E),ot(et({key:1},n.$props)),{default:it(()=>[tt(n.$slots,"default")]),_:3},16))}}),gn=Ye({__name:"AsyncTextClamp",props:{maxLines:{},text:{}},async setup(e){let t,n;const r=e,o=([t,n]=at(()=>r.text),t=await t,n(),t);return(t,n)=>rt(o)?(Ze(),nt(rt(D),{key:0,text:rt(o),"max-lines":e.maxLines},null,8,["text","max-lines"])):st("",!0)}});const vn=["src","width","height"],yn=Ye({__name:"Avatar",props:{rounded:{type:Boolean,default:!1},size:{default:40},user:{}},setup(e){const t=e,n=Xe(()=>function(e,t){return e.avatar_thumbnail||((e,t)=>`${_.api_root}avatars/${e}/${t}`)(e.id,t)}(t.user,t.size));return(t,r)=>(Ze(),Qe("img",{class:lt({"rounded-circle border border-default-grey":e.rounded}),src:n.value,width:e.size,height:e.size,loading:"lazy",alt:""},null,10,vn))}}),wn={name:"ri-bank-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M2 20h20v2H2v-2zm2-8h2v7H4v-7zm5 0h2v7H9v-7zm4 0h2v7h-2v-7zm5 0h2v7h-2v-7zM2 7l10-5 10 5v4H2V7zm2 1.236V9h16v-.764l-8-4-8 4zM12 8a1 1 0 110-2 1 1 0 010 2z"/>'},bn={name:"ri-building-2-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M3 19V5.7a1 1 0 01.658-.94l9.671-3.516a.5.5 0 01.671.47v4.953l6.316 2.105a1 1 0 01.684.949V19h2v2H1v-2h2zm2 0h7V3.855L5 6.401V19zm14 0v-8.558l-5-1.667V19h5z"/>'},kn={name:"ri-check-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"/>'},xn={name:"ri-clipboard-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M7 4V2h10v2h3.007c.548 0 .993.445.993.993v16.014a.994.994 0 01-.993.993H3.993A.994.994 0 013 21.007V4.993C3 4.445 3.445 4 3.993 4H7zm0 2H5v14h14V6h-2v2H7V6zm2-2v2h6V4H9z"/>'},Cn={name:"ri-community-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M21 21H3a1 1 0 01-1-1v-7.513a1 1 0 01.343-.754L6 8.544V4a1 1 0 011-1h14a1 1 0 011 1v16a1 1 0 01-1 1zM9 19h3v-6.058L8 9.454l-4 3.488V19h3v-4h2v4zm5 0h6V5H8v2.127c.234 0 .469.082.657.247l5 4.359a1 1 0 01.343.754V19zm2-8h2v2h-2v-2zm0 4h2v2h-2v-2zm0-8h2v2h-2V7zm-4 0h2v2h-2V7z"/>'},Sn={name:"ri-download-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M3 19h18v2H3v-2zm10-5.828L19.071 7.1l1.414 1.414L12 17 3.515 8.515 4.929 7.1 11 13.17V2h2v11.172z"/>'},Mn={name:"ri-file-copy-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M7 6V3a1 1 0 011-1h12a1 1 0 011 1v14a1 1 0 01-1 1h-3v3c0 .552-.45 1-1.007 1H4.007A1.001 1.001 0 013 21l.003-14c0-.552.45-1 1.007-1H7zM5.003 8L5 20h10V8H5.003zM9 6h8v10h2V4H9v2z"/>'},Tn={name:"ri-file-warning-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M15 4H5v16h14V8h-4V4zM3 2.992C3 2.444 3.447 2 3.999 2H16l5 5v13.993A1 1 0 0120.007 22H3.993A1 1 0 013 21.008V2.992zM11 15h2v2h-2v-2zm0-8h2v6h-2V7z"/>'},On={name:"ri-government-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M20 6h3v2h-1v11h1v2H1v-2h1V8H1V6h3V4a1 1 0 011-1h14a1 1 0 011 1v2zm0 2H4v11h3v-7h2v7h2v-7h2v7h2v-7h2v7h3V8zM6 5v1h12V5H6z"/>'},_n={name:"ri-user-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M4 22a8 8 0 1116 0h-2a6 6 0 10-12 0H4zm8-9c-3.315 0-6-2.685-6-6s2.685-6 6-6 6 2.685 6 6-2.685 6-6 6zm0-2c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4z"/>'},Nn={key:0,style:{color:"#3558a2"}},En={key:1},Dn=Ye({__name:"CopyButton",props:{text:{},label:{},copiedLabel:{},hideLabel:{type:Boolean,default:!1}},setup(e){A(kn,xn,Mn);const t=e,n=ct(!1),r=()=>{navigator.clipboard.writeText(t.text),n.value=!0,setTimeout(()=>n.value=!1,2e3)};return(t,o)=>(Ze(),Qe("button",{type:"button",onClick:r,class:lt(["fr-text--sm fr-mb-0 whitespace-nowrap relative fr-p-1v text-mention-grey line-height-1",{"border bg-white rounded-xxs text-grey-500":e.hideLabel}])},[n.value?(Ze(),Qe("span",Nn,[ut(rt($),{height:16,width:16,name:"ri-check-line"}),dt("span",{class:lt(["fr-ml-1v copy-label",{"fr-sr-only":e.hideLabel}])},pt(e.copiedLabel),3)])):st("",!0),n.value?st("",!0):(Ze(),Qe("span",En,[ut(rt($),{height:16,width:16,name:e.hideLabel?"ri-clipboard-line":"ri-file-copy-line",class:"copy-icon"},null,8,["name"]),dt("span",{class:lt(["fr-ml-1v copy-link copy-label",{"fr-sr-only":e.hideLabel}])},pt(e.label),3)]))],2))}}),An=(e,t)=>{const n=e.__vccOpts||e;for(const[r,o]of t)n[r]=o;return n},$n=An(Dn,[["__scopeId","data-v-4d7d7e27"]]);
/*! *****************************************************************************
      Copyright (c) Microsoft Corporation.

      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.

      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** */var Rn=function(){return Rn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Rn.apply(this,arguments)};function Ln(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}var In,Pn=function(e){var t=e.onRead,n=e.onRender,r=e.uncachedValues,o=void 0===r?new Set:r,i=e.useCache,a=void 0===i||i;return function(e){void 0===e&&(e={});var r=Ln(e,[]),i={},s=[],l=!1;function c(e,t){e.startsWith("--")&&(r.hasCSSVariable=!0);var n=i[e];i[e]=t,i[e]!==n&&(-1===s.indexOf(e)&&s.push(e),l||(l=!0,R.render(u.render)))}var u={get:function(e,n){return void 0===n&&(n=!1),!n&&a&&!o.has(e)&&void 0!==i[e]?i[e]:t(e,r)},set:function(e,t){if("string"==typeof e)c(e,t);else for(var n in e)c(n,e[n]);return this},render:function(e){return void 0===e&&(e=!1),(l||!0===e)&&(n(i,r,s),l=!1,s.length=0),this}};return u}},zn=/([a-z])([A-Z])/g,Bn=function(e){return e.replace(zn,"$1-$2").toLowerCase()},Fn=new Map,jn=new Map,Vn=["Webkit","Moz","O","ms",""],qn=Vn.length,Hn="undefined"!=typeof document,Un=function(e,t){return jn.set(e,Bn(t))},Wn=function(e,t){void 0===t&&(t=!1);var n=t?jn:Fn;return n.has(e)||(Hn?function(e){In=In||document.createElement("div");for(var t=0;t<qn;t++){var n=Vn[t],r=""===n,o=r?e:n+e.charAt(0).toUpperCase()+e.slice(1);if(o in In.style||r){if(r&&"clipPath"===e&&jn.has(e))return;Fn.set(e,o),Un(e,(r?"":"-")+Bn(o))}}}(e):function(e){Un(e,e)}(e)),n.get(e)||e},Kn=["","X","Y","Z"],Yn=["translate","scale","rotate","skew","transformPerspective"].reduce(function(e,t){return Kn.reduce(function(e,n){return e.push(t+n),e},e)},["x","y","z"]),Jn=Yn.reduce(function(e,t){return e[t]=!0,e},{});function Gn(e){return!0===Jn[e]}function Xn(e,t){return Yn.indexOf(e)-Yn.indexOf(t)}var Zn=new Set(["originX","originY","originZ"]);function Qn(e){return Zn.has(e)}var er=Rn(Rn({},j),{transform:Math.round}),tr={color:I,backgroundColor:I,outlineColor:I,fill:I,stroke:I,borderColor:I,borderTopColor:I,borderRightColor:I,borderBottomColor:I,borderLeftColor:I,borderWidth:L,borderTopWidth:L,borderRightWidth:L,borderBottomWidth:L,borderLeftWidth:L,borderRadius:L,radius:L,borderTopLeftRadius:L,borderTopRightRadius:L,borderBottomRightRadius:L,borderBottomLeftRadius:L,width:L,maxWidth:L,height:L,maxHeight:L,size:L,top:L,right:L,bottom:L,left:L,padding:L,paddingTop:L,paddingRight:L,paddingBottom:L,paddingLeft:L,margin:L,marginTop:L,marginRight:L,marginBottom:L,marginLeft:L,rotate:P,rotateX:P,rotateY:P,rotateZ:P,scale:z,scaleX:z,scaleY:z,scaleZ:z,skew:P,skewX:P,skewY:P,distance:L,translateX:L,translateY:L,translateZ:L,x:L,y:L,z:L,perspective:L,opacity:B,originX:F,originY:F,originZ:L,zIndex:er,fillOpacity:B,strokeOpacity:B,numOctaves:er},nr=function(e){return tr[e]},rr=function(e,t){return t&&"number"==typeof e?t.transform(e):e},or="scrollLeft",ir="scrollTop",ar=new Set([or,ir]),sr=new Set([or,ir,"transform"]),lr={x:"translateX",y:"translateY",z:"translateZ"};function cr(e){return"function"==typeof e}function ur(e,t,n,r,o,i,a,s){void 0===t&&(t=!0),void 0===n&&(n={}),void 0===r&&(r={}),void 0===o&&(o={}),void 0===i&&(i=[]),void 0===a&&(a=!1),void 0===s&&(s=!0);var l=!0,c=!1,u=!1;for(var d in e){var p=e[d],h=nr(d),f=rr(p,h);Gn(d)?(c=!0,r[d]=f,i.push(d),l&&(h.default&&p!==h.default||!h.default&&0!==p)&&(l=!1)):Qn(d)?(o[d]=f,u=!0):sr.has(d)&&cr(f)||(n[Wn(d,a)]=f)}return(c||"function"==typeof e.transform)&&(n.transform=function(e,t,n,r,o,i){void 0===i&&(i=!0);var a="",s=!1;n.sort(Xn);for(var l=n.length,c=0;c<l;c++){var u=n[c];a+=(lr[u]||u)+"("+t[u]+") ",s="z"===u||s}return!s&&o?a+="translateZ(0)":a=a.trim(),cr(e.transform)?a=e.transform(t,r?"":a):i&&r&&(a="none"),a}(e,r,i,l,t,s)),u&&(n.transformOrigin=(o.originX||"50%")+" "+(o.originY||"50%")+" "+(o.originZ||0)),n}function dr(e){var t=void 0===e?{}:e,n=t.enableHardwareAcceleration,r=void 0===n||n,o=t.isDashCase,i=void 0===o||o,a=t.allowTransformNone,s=void 0===a||a,l={},c={},u={},d=[];return function(e){return d.length=0,ur(e,r,l,c,u,d,i,s),l}}var pr=Pn({onRead:function(e,t){var n=t.element,r=t.preparseOutput,o=nr(e);if(Gn(e))return o&&o.default||0;if(ar.has(e))return n[e];var i=window.getComputedStyle(n,null).getPropertyValue(Wn(e,!0))||0;return r&&o&&o.test(i)&&o.parse?o.parse(i):i},onRender:function(e,t,n){var r=t.element,o=t.buildStyles,i=t.hasCSSVariable;if(Object.assign(r.style,o(e)),i)for(var a=n.length,s=0;s<a;s++){var l=n[s];l.startsWith("--")&&r.style.setProperty(l,e[l])}-1!==n.indexOf(or)&&(r[or]=e[or]),-1!==n.indexOf(ir)&&(r[ir]=e[ir])},uncachedValues:ar});var hr=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues"]),fr=function(e,t){return L.transform(e*t)},mr={x:0,y:0,width:0,height:0};function gr(e,t,n){return"string"==typeof e?e:L.transform(t+n*e)}var vr={enableHardwareAcceleration:!1,isDashCase:!1};function yr(e,t,n,r,o,i){void 0===t&&(t=mr),void 0===r&&(r=dr(vr)),void 0===o&&(o={style:{}}),void 0===i&&(i=!0);var a=e.attrX,s=e.attrY,l=e.originX,c=e.originY,u=e.pathLength,d=e.pathSpacing,p=void 0===d?1:d,h=e.pathOffset,f=void 0===h?0:h,m=r(Ln(e,["attrX","attrY","originX","originY","pathLength","pathSpacing","pathOffset"]));for(var g in m){if("transform"===g)o.style.transform=m[g];else o[i&&!hr.has(g)?Bn(g):g]=m[g]}return(void 0!==l||void 0!==c||m.transform)&&(o.style.transformOrigin=function(e,t,n){return gr(t,e.x,e.width)+" "+gr(n,e.y,e.height)}(t,void 0!==l?l:.5,void 0!==c?c:.5)),void 0!==a&&(o.x=a),void 0!==s&&(o.y=s),void 0!==n&&void 0!==u&&(o[i?"stroke-dashoffset":"strokeDashoffset"]=fr(-f,n),o[i?"stroke-dasharray":"strokeDasharray"]=fr(u,n)+" "+fr(p,n)),o}function wr(e,t,n){void 0===n&&(n=!0);var r={style:{}},o=dr(vr);return function(i){return yr(i,e,t,o,r,n)}}var br=Pn({onRead:function(e,t){var n=t.element;if(Gn(e=hr.has(e)?e:Bn(e))){var r=nr(e);return r&&r.default||0}return n.getAttribute(e)},onRender:function(e,t){var n=t.element,r=(0,t.buildAttrs)(e);for(var o in r)"style"===o?Object.assign(n.style,r.style):n.setAttribute(o,r[o])}}),kr=Pn({useCache:!1,onRead:function(e){return"scrollTop"===e?window.pageYOffset:window.pageXOffset},onRender:function(e){var t=e.scrollTop,n=void 0===t?0:t,r=e.scrollLeft,o=void 0===r?0:r;return window.scrollTo(o,n)}}),xr=new WeakMap,Cr=function(e,t){var n,r,o,i;return e===window?n=kr(e):!function(e){return e instanceof HTMLElement||"function"==typeof e.click}(e)?function(e){return e instanceof SVGElement||"ownerSVGElement"in e}(e)&&(o=function(e){try{return function(e){return"function"==typeof e.getBBox?e.getBBox():e.getBoundingClientRect()}(e)}catch(Yo){return{x:0,y:0,width:0,height:0}}}(r=e),i=function(e){return"path"===e.tagName}(r)&&r.getTotalLength?r.getTotalLength():void 0,n=br({element:r,buildAttrs:wr(o,i)})):n=function(e,t){void 0===t&&(t={});var n=t.enableHardwareAcceleration,r=t.allowTransformNone,o=Ln(t,["enableHardwareAcceleration","allowTransformNone"]);return pr(Rn({element:e,buildStyles:dr({enableHardwareAcceleration:n,allowTransformNone:r}),preparseOutput:!0},o))}(e,t),xr.set(e,n),n};function Sr(e,t){return function(e,t){return xr.has(e)?xr.get(e):Cr(e,t)}("string"==typeof e?document.querySelector(e):e,t)}function Mr(e,t,n=0){if(e){const r=Sr(e);t?(r.set({display:"block"}),r.render(!0),V({from:{height:0,padding:0},to:{height:e.scrollHeight+2*n,padding:n},duration:300,ease:q}).start({update:r.set,complete:()=>r.set({height:"auto"})})):V({from:{height:e.scrollHeight,padding:n},to:{height:0,padding:0},duration:300,ease:q}).start({update:r.set,complete:()=>r.set({height:0,display:"none"})})}}const Tr="public-service",Or="association",_r="company",Nr="local-authority",Er="other",Dr="user";function Ar(e,t){return $r(e,t)}function $r(e,t){return ht(e).badges.some(e=>e.kind===t)}function Rr(){const{t:e}=H();return[{type:Tr,label:e("Public service"),icon:"ri-bank-line"},{type:Nr,label:e("Local authority"),icon:"ri-government-line"},{type:Or,label:e("Association"),icon:"ri-community-line"},{type:_r,label:e("Company"),icon:"ri-building-2-line"},{type:Er,label:e("Other"),icon:""},{type:Dr,label:e("User"),icon:"ri-user-line"}]}function Lr(e){return Rr().find(t=>t.type===e)}const Ir=An(Ye({__name:"OwnerTypeIcon",props:{type:{}},setup(e){A(wn,bn,Cn,On,_n);const t=e,n=Xe(()=>Lr(t.type).icon);return(e,t)=>n.value?(Ze(),nt(rt($),{key:0,height:14,width:14,name:n.value},null,8,["name"])):st("",!0)}}),[["__scopeId","data-v-7acefa45"]]);const Pr=["title"],zr=Ye({__name:"OrganizationNameWithCertificate",props:{organization:{},showType:{type:Boolean,default:!0}},setup(e){const{t:t}=H(),n=e,{type:r}=function(e){const t=Xe(()=>Ar(e,Tr)),n=Xe(()=>Ar(e,Or)),r=Xe(()=>Ar(e,Nr)),o=Xe(()=>Ar(e,_r));return{type:Xe(()=>r.value?Nr:t.value?Tr:n.value?Or:o.value?_r:Er)}}(n.organization),{organizationCertified:o}=(i=n.organization,{organizationCertified:Xe(()=>{const e=ht(i);return!!e&&$r(e,"certified")&&(Ar(e,Tr)||Ar(e,Nr))})});var i;return(n,i)=>(Ze(),Qe("span",{class:lt(["inline-flex",rt(r)!==rt(Er)||rt(o)?"fr-grid-row--middle":"align-items-baseline"])},[dt("span",null,[e.showType?(Ze(),nt(Ir,{key:0,type:rt(r)},null,8,["type"])):st("",!0)]),ut(rt(D),{class:"fr-mx-1v","auto-resize":!0,text:e.organization.name,"max-lines":1},null,8,["text"]),rt(o)?(Ze(),Qe("span",{key:0,class:"fr-icon-success-line fr-icon--sm",title:rt(t)("The identity of this public service is certified by {certifier}",{certifier:rt(_).title}),"aria-hidden":"true"},null,8,Pr)):st("",!0)],2))}});function Br(e){return"function"==typeof e?e():rt(e)}const Fr="undefined"!=typeof window&&"undefined"!=typeof document;"undefined"!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope);const jr=()=>{};function Vr(e,t){return function(...n){return new Promise((r,o)=>{Promise.resolve(e(()=>t.apply(this,n),{fn:t,thisArg:this,args:n})).then(r).catch(o)})}}const qr=e=>e();function Hr(e,t=200,n={}){return Vr(function(e,t={}){let n,r,o=jr;const i=e=>{clearTimeout(e),o(),o=jr};return a=>{const s=Br(e),l=Br(t.maxWait);return n&&i(n),s<=0||void 0!==l&&l<=0?(r&&(i(r),r=null),Promise.resolve(a())):new Promise((e,c)=>{o=t.rejectOnCancel?c:e,l&&!r&&(r=setTimeout(()=>{n&&i(n),r=null,e(a())},l)),n=setTimeout(()=>{r&&i(r),r=null,e(a())},s)})}}(t,n),e)}function Ur(e,t=!0,n){const r=function(e){return e||vt()}();r?mt(e,n):t?e():gt(e)}function Wr(e,t,n){let r;r=xt(n)?{evaluating:n}:n||{};const{lazy:o=!1,evaluating:i,shallow:a=!0,onError:s=jr}=r,l=ct(!o),c=a?Ct(t):ct(t);let u=0;return St(async t=>{if(!l.value)return;u++;const n=u;let r=!1;i&&Promise.resolve().then(()=>{i.value=!0});try{const o=await e(e=>{t(()=>{i&&(i.value=!1),r||e()})});n===u&&(c.value=o)}catch(Yo){s(Yo)}finally{i&&n===u&&(i.value=!1),r=!0}}),o?Xe(()=>(l.value=!0,c.value)):c}function Kr(e){var t;const n=Br(e);return null!=(t=null==n?void 0:n.$el)?t:n}const Yr=Fr?window:void 0;function Jr(e,t=null){const n=vt();let r=()=>{};const o=bt((o,i)=>(r=i,{get(){var r,i;return o(),null!=(i=null==(r=null==n?void 0:n.proxy)?void 0:r.$refs[e])?i:t},set(){}}));return Ur(r),kt(r),o}function Gr(e){const t=function(){const e=ct(!1),t=vt();return t&&mt(()=>{e.value=!0},t),e}();return Xe(()=>(t.value,Boolean(e())))}function Xr(e,n,r={}){const{window:o=Yr}=r,i=C(r,t);let a;const s=Gr(()=>o&&"ResizeObserver"in o),l=()=>{a&&(a.disconnect(),a=void 0)},c=Xe(()=>Array.isArray(e)?e.map(e=>Kr(e)):[Kr(e)]),u=ft(c,e=>{if(l(),s.value&&o){a=new ResizeObserver(n);for(const t of e)t&&a.observe(t,i)}},{immediate:!0,flush:"post"}),d=()=>{l(),u()};var p;return p=d,yt()&&wt(p),{isSupported:s,stop:d}}const Zr=["src","alt","width","height"],Qr=Ye({__name:"Placeholder",props:{type:{},src:{},alt:{},size:{}},setup(e){const t=e,n=async()=>{const e=await((e,t)=>{const n=e[t];return n?"function"==typeof n?n():Promise.resolve(n):new Promise((e,n)=>{("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+t)))})})(Object.assign({"../../assets/img/placeholders/author.png":()=>U(()=>S.import("./author-legacy.6.2.4.js"),void 0),"../../assets/img/placeholders/dataset.png":()=>U(()=>S.import("./dataset-legacy.6.2.4.js"),void 0),"../../assets/img/placeholders/news.png":()=>U(()=>S.import("./news-legacy.6.2.4.js"),void 0),"../../assets/img/placeholders/organization.png":()=>U(()=>S.import("./organization-legacy.6.2.4.js"),void 0),"../../assets/img/placeholders/reuse.png":()=>U(()=>S.import("./reuse-legacy.6.2.4.js"),void 0)}),`../../assets/img/placeholders/${t.type}.png`);return t.src?t.src:e.default},r=Xe(()=>t.src?t.alt:""),o=Wr(()=>n());return(t,n)=>(Ze(),Qe("img",et({loading:"lazy",src:rt(o),alt:r.value,width:e.size,height:e.size},t.$attrs),null,16,Zr))}}),eo=["value"],to=Ye({__name:"QualityScore",props:{score:{},class:{default:""}},setup(e){const t=e,n=2/3,{t:r,locale:o}=H(),i=Xe(()=>new Intl.NumberFormat(o.value,{style:"percent"}).format(t.score));return(o,a)=>(Ze(),Qe("meter",{class:lt(["quality-score",t.class]),min:"0",low:"0",high:n,max:1,optimum:1,value:e.score},[e.score>=n?(Ze(),Qe(Mt,{key:0},[Tt(pt(rt(r)("Good")),1)],64)):(Ze(),Qe(Mt,{key:1},[Tt(pt(rt(r)("To improve")),1)],64)),Tt("("+pt(i.value)+") ",1)],10,eo))}}),no={key:0,class:"fr-my-0"},ro={key:1,class:"fr-my-0 text-mention-grey"},oo=Ye({__name:"QualityItem",props:{passed:{type:Boolean},messagePassed:{},messageFailed:{}},setup:e=>(t,n)=>(Ze(),Qe("li",null,[e.passed?(Ze(),Qe("p",no,[n[0]||(n[0]=dt("span",{class:"fr-icon-check-line","aria-hidden":"true"},null,-1)),Tt(" "+pt(e.messagePassed),1)])):(Ze(),Qe("p",ro,[n[1]||(n[1]=dt("span",{class:"fr-icon-warning-line","aria-hidden":"true"},null,-1)),Tt(" "+pt(e.messageFailed),1)]))]))});var io;let ao=Symbol("headlessui.useid"),so=0;const lo=null!=(io=Ot.useId)?io:function(){return Ot.inject(ao,()=>""+ ++so)()};function co(e){var t;if(null==e||null==e.value)return null;let n=null!=(t=e.value.$el)?t:e.value;return n instanceof Node?n:null}function uo(e,t,...n){if(e in t){let r=t[e];return"function"==typeof r?r(...n):r}let r=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(e=>`"${e}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,uo),r}var po=Object.defineProperty,ho=(e,t,n)=>(((e,t,n)=>{t in e?po(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);let fo=new class{constructor(){ho(this,"current",this.detect()),ho(this,"currentId",0)}set(e){this.current!==e&&(this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return"server"===this.current}get isClient(){return"client"===this.current}detect(){return"undefined"==typeof window||"undefined"==typeof document?"server":"client"}};function mo(e){if(fo.isServer)return null;if(e instanceof Node)return e.ownerDocument;if(null!=e&&e.hasOwnProperty("value")){let t=co(e);if(t)return t.ownerDocument}return document}let go=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var vo=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e))(vo||{}),yo=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(yo||{}),wo=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(wo||{});function bo(e=document.body){return null==e?[]:Array.from(e.querySelectorAll(go)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}var ko=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(ko||{});function xo(e,t=0){var n;return e!==(null==(n=mo(e))?void 0:n.body)&&uo(t,{0:()=>e.matches(go),1(){let t=e;for(;null!==t;){if(t.matches(go))return!0;t=t.parentElement}return!1}})}var Co=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(Co||{});"undefined"!=typeof window&&"undefined"!=typeof document&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{1===e.detail?delete document.documentElement.dataset.headlessuiFocusVisible:0===e.detail&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));let So=["textarea","input"].join(",");function Mo(e,t=e=>e){return e.slice().sort((e,n)=>{let r=t(e),o=t(n);if(null===r||null===o)return 0;let i=r.compareDocumentPosition(o);return i&Node.DOCUMENT_POSITION_FOLLOWING?-1:i&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function To(e,t,{sorted:n=!0,relativeTo:r=null,skipElements:o=[]}={}){var i;let a=null!=(i=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:null==e?void 0:e.ownerDocument)?i:document,s=Array.isArray(e)?n?Mo(e):e:bo(e);o.length>0&&s.length>1&&(s=s.filter(e=>!o.includes(e))),r=null!=r?r:a.activeElement;let l,c=(()=>{if(5&t)return 1;if(10&t)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=(()=>{if(1&t)return 0;if(2&t)return Math.max(0,s.indexOf(r))-1;if(4&t)return Math.max(0,s.indexOf(r))+1;if(8&t)return s.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),d=32&t?{preventScroll:!0}:{},p=0,h=s.length;do{if(p>=h||p+h<=0)return 0;let e=u+p;if(16&t)e=(e+h)%h;else{if(e<0)return 3;if(e>=h)return 1}l=s[e],null==l||l.focus(d),p+=c}while(l!==a.activeElement);return 6&t&&function(e){var t,n;return null!=(n=null==(t=null==e?void 0:e.matches)?void 0:t.call(e,So))&&n}(l)&&l.select(),2}function Oo(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0||/Android/gi.test(window.navigator.userAgent)}function _o(e,t,n){fo.isServer||St(r=>{document.addEventListener(e,t,n),r(()=>document.removeEventListener(e,t,n))})}function No(e,t,n){fo.isServer||St(r=>{window.addEventListener(e,t,n),r(()=>window.removeEventListener(e,t,n))})}function Eo(e,t,n=Xe(()=>!0)){function r(r,o){if(!n.value||r.defaultPrevented)return;let i=o(r);if(null===i||!i.getRootNode().contains(i))return;let a=function e(t){return"function"==typeof t?e(t()):Array.isArray(t)||t instanceof Set?t:[t]}(e);for(let e of a){if(null===e)continue;let t=e instanceof HTMLElement?e:co(e);if(null!=t&&t.contains(i)||r.composed&&r.composedPath().includes(t))return}return!xo(i,ko.Loose)&&-1!==i.tabIndex&&r.preventDefault(),t(r,i)}let o=ct(null);_o("pointerdown",e=>{var t,r;n.value&&(o.value=(null==(r=null==(t=e.composedPath)?void 0:t.call(e))?void 0:r[0])||e.target)},!0),_o("mousedown",e=>{var t,r;n.value&&(o.value=(null==(r=null==(t=e.composedPath)?void 0:t.call(e))?void 0:r[0])||e.target)},!0),_o("click",e=>{Oo()||o.value&&(r(e,()=>o.value),o.value=null)},!0),_o("touchend",e=>r(e,()=>e.target instanceof HTMLElement?e.target:null),!0),No("blur",e=>r(e,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function Do(e,t){if(e)return e;let n=null!=t?t:"button";return"string"==typeof n&&"button"===n.toLowerCase()?"button":void 0}function Ao(e,t){let n=ct(Do(e.value.type,e.value.as));return mt(()=>{n.value=Do(e.value.type,e.value.as)}),St(()=>{var e;n.value||co(t)&&co(t)instanceof HTMLButtonElement&&(null==(e=co(t))||!e.hasAttribute("type"))&&(n.value="button")}),n}var $o=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))($o||{}),Ro=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(Ro||{});function Lo(e){let{visible:t=!0,features:r=0,ourProps:o,theirProps:i}=e,a=C(e,n);var s;let l=zo(i,o),c=Object.assign(a,{props:l});if(t||2&r&&l.static)return Io(c);if(1&r){return uo(null==(s=l.unmount)||s?0:1,{0:()=>null,1:()=>Io(M(M({},a),{},{props:M(M({},l),{},{hidden:!0,style:{display:"none"}})}))})}return Io(c)}function Io({props:e,attrs:t,slots:n,slot:o,name:i}){var a,s;let l=Bo(e,["unmount","static"]),{as:c}=l,u=C(l,r),d=null==(a=n.default)?void 0:a.call(n,o),p={};if(o){let e=!1,t=[];for(let[n,r]of Object.entries(o))"boolean"==typeof r&&(e=!0),!0===r&&t.push(n);e&&(p["data-headlessui-state"]=t.join(" "))}if("template"===c){if(d=Po(null!=d?d:[]),Object.keys(u).length>0||Object.keys(t).length>0){let[e,...n]=null!=d?d:[];if(!function(e){return null!=e&&("string"==typeof e.type||"object"==typeof e.type||"function"==typeof e.type)}(e)||n.length>0)throw new Error(['Passing props on "template"!',"",`The current component <${i} /> is rendering a "template".`,"However we need to passthrough the following props:",Object.keys(u).concat(Object.keys(t)).map(e=>e.trim()).filter((e,t,n)=>n.indexOf(e)===t).sort((e,t)=>e.localeCompare(t)).map(e=>`  - ${e}`).join("\n"),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "template".',"Render a single element as the child so that we can forward the props onto that element."].map(e=>`  - ${e}`).join("\n")].join("\n"));let r=zo(null!=(s=e.props)?s:{},u,p),o=_t(e,r,!0);for(let t in r)t.startsWith("on")&&(o.props||(o.props={}),o.props[t]=r[t]);return o}return Array.isArray(d)&&1===d.length?d[0]:d}return Nt(c,Object.assign({},u,p),{default:()=>d})}function Po(e){return e.flatMap(e=>e.type===Mt?Po(e.children):[e])}function zo(...e){if(0===e.length)return{};if(1===e.length)return e[0];let t={},n={};for(let r of e)for(let e in r)e.startsWith("on")&&"function"==typeof r[e]?(null!=n[e]||(n[e]=[]),n[e].push(r[e])):t[e]=r[e];if(t.disabled||t["aria-disabled"])return Object.assign(t,Object.fromEntries(Object.keys(n).map(e=>[e,void 0])));for(let r in n)Object.assign(t,{[r](e,...t){let o=n[r];for(let n of o){if(e instanceof Event&&e.defaultPrevented)return;n(e,...t)}}});return t}function Bo(e,t=[]){let n=Object.assign({},e);for(let r of t)r in n&&delete n[r];return n}var Fo=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(Fo||{});let jo=Ye({name:"Hidden",props:{as:{type:[Object,String],default:"div"},features:{type:Number,default:1}},setup:(e,{slots:t,attrs:n})=>()=>{var r;let{features:i}=e,a=C(e,o);return Lo({ourProps:{"aria-hidden":!(2&~i)||(null!=(r=a["aria-hidden"])?r:void 0),hidden:!(4&~i)||void 0,style:M({position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"},!(4&~i)&&!!(2&~i)&&{display:"none"})},theirProps:a,slot:{},attrs:n,slots:t,name:"Hidden"})}}),Vo=Symbol("Context");var qo=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(qo||{});function Ho(){return Je(Vo,null)}var Uo=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(Uo||{});var Wo=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(Wo||{});function Ko(){let e=ct(0);return No("keydown",t=>{"Tab"===t.key&&(e.value=t.shiftKey?1:0)}),e}let Yo=Symbol("ForcePortalRootContext");function Jo(){return Je(Yo,!1)}Ye({name:"ForcePortalRoot",props:{as:{type:[Object,String],default:"template"},force:{type:Boolean,default:!1}},setup:(e,{slots:t,attrs:n})=>(Et(Yo,e.force),()=>{let{force:r}=e;return Lo({theirProps:C(e,i),ourProps:{},slot:{},slots:t,attrs:n,name:"ForcePortalRoot"})})});const Go=new WeakMap;function Xo(e,t){let n=t(function(e){var t;return null!=(t=Go.get(e))?t:0}(e));return n<=0?Go.delete(e):Go.set(e,n),n}Ye({name:"Portal",props:{as:{type:[Object,String],default:"div"}},setup(e,{slots:t,attrs:n}){let r=ct(null),o=Xe(()=>mo(r)),i=Jo(),a=Je(Qo,null),s=ct(!0===i||null==a?function(e){let t=mo(e);if(!t){if(null===e)return null;throw new Error(`[Headless UI]: Cannot find ownerDocument for contextElement: ${e}`)}let n=t.getElementById("headlessui-portal-root");if(n)return n;let r=t.createElement("div");return r.setAttribute("id","headlessui-portal-root"),t.body.appendChild(r)}(r.value):a.resolveTarget());s.value&&Xo(s.value,e=>e+1);let l=ct(!1);mt(()=>{l.value=!0}),St(()=>{i||null!=a&&(s.value=a.resolveTarget())});let c=Je(Zo,null),u=!1,d=vt();return ft(r,()=>{if(u||!c)return;let e=co(r);e&&(Dt(c.register(e),d),u=!0)}),Dt(()=>{var e,t;let n=null==(e=o.value)?void 0:e.getElementById("headlessui-portal-root");!n||s.value!==n||Xo(s.value,e=>e-1)||s.value.children.length>0||null==(t=s.value.parentElement)||t.removeChild(s.value)}),()=>{if(!l.value||null===s.value)return null;let o={ref:r,"data-headlessui-portal":""};return Nt(At,{to:s.value},Lo({ourProps:o,theirProps:e,slot:{},attrs:n,slots:t,name:"Portal"}))}}});let Zo=Symbol("PortalParentContext");let Qo=Symbol("PortalGroupContext");Ye({name:"PortalGroup",props:{as:{type:[Object,String],default:"template"},target:{type:Object,default:null}},setup(e,{attrs:t,slots:n}){let r=$t({resolveTarget:()=>e.target});return Et(Qo,r),()=>{let{target:r}=e;return Lo({theirProps:C(e,a),ourProps:{},slot:{},attrs:t,slots:n,name:"PortalGroup"})}}});var ei=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(ei||{});let ti=Symbol("PopoverContext");function ni(e){let t=Je(ti,null);if(null===t){let t=new Error(`<${e} /> is missing a parent <${ai.name} /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,ni),t}return t}let ri=Symbol("PopoverGroupContext");function oi(){return Je(ri,null)}let ii=Symbol("PopoverPanelContext");let ai=Ye({name:"Popover",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"}},setup(e,{slots:t,attrs:n,expose:r}){var o;let i=ct(null);r({el:i,$el:i});let a=ct(1),s=ct(null),l=ct(null),c=ct(null),u=ct(null),d=Xe(()=>mo(i)),p=Xe(()=>{var e,t;if(!co(s)||!co(u))return!1;for(let c of document.querySelectorAll("body > *"))if(Number(null==c?void 0:c.contains(co(s)))^Number(null==c?void 0:c.contains(co(u))))return!0;let n=bo(),r=n.indexOf(co(s)),o=(r+n.length-1)%n.length,i=(r+1)%n.length,a=n[o],l=n[i];return!(null!=(e=co(u))&&e.contains(a)||null!=(t=co(u))&&t.contains(l))}),h={popoverState:a,buttonId:ct(null),panelId:ct(null),panel:u,button:s,isPortalled:p,beforePanelSentinel:l,afterPanelSentinel:c,togglePopover(){a.value=uo(a.value,{0:1,1:0})},closePopover(){1!==a.value&&(a.value=1)},close(e){h.closePopover();let t=e?e instanceof HTMLElement?e:e.value instanceof HTMLElement?co(e):co(h.button):co(h.button);null==t||t.focus()}};Et(ti,h),function(e){Et(Vo,e)}(Xe(()=>uo(a.value,{0:qo.Open,1:qo.Closed})));let f={buttonId:h.buttonId,panelId:h.panelId,close(){h.closePopover()}},m=oi(),g=null==m?void 0:m.registerPopover,[v,y]=function(){let e=Je(Zo,null),t=ct([]);function n(n){let r=t.value.indexOf(n);-1!==r&&t.value.splice(r,1),e&&e.unregister(n)}let r={register:function(r){return t.value.push(r),e&&e.register(r),()=>n(r)},unregister:n,portals:t};return[t,Ye({name:"PortalWrapper",setup:(e,{slots:t})=>(Et(Zo,r),()=>{var e;return null==(e=t.default)?void 0:e.call(t)})})]}(),w=function({defaultContainers:e=[],portals:t,mainTreeNodeRef:n}={}){let r=ct(null),o=mo(r);function i(){var n,i,a;let s=[];for(let t of e)null!==t&&(t instanceof HTMLElement?s.push(t):"value"in t&&t.value instanceof HTMLElement&&s.push(t.value));if(null!=t&&t.value)for(let e of t.value)s.push(e);for(let e of null!=(n=null==o?void 0:o.querySelectorAll("html > *, body > *"))?n:[])e!==document.body&&e!==document.head&&e instanceof HTMLElement&&"headlessui-portal-root"!==e.id&&(e.contains(co(r))||e.contains(null==(a=null==(i=co(r))?void 0:i.getRootNode())?void 0:a.host)||s.some(t=>e.contains(t))||s.push(e));return s}return{resolveContainers:i,contains:e=>i().some(t=>t.contains(e)),mainTreeNodeRef:r,MainTreeNode:()=>null!=n?null:Nt(jo,{features:Fo.Hidden,ref:r})}}({mainTreeNodeRef:null==m?void 0:m.mainTreeNodeRef,portals:v,defaultContainers:[s,u]});return St(()=>null==g?void 0:g(f)),function(e,t,n,r){fo.isServer||St(o=>{(e=null!=e?e:window).addEventListener(t,n,r),o(()=>e.removeEventListener(t,n,r))})}(null==(o=d.value)?void 0:o.defaultView,"focus",e=>{var t,n;e.target!==window&&e.target instanceof HTMLElement&&0===a.value&&(function(){var e,t,n,r;return null!=(r=null==m?void 0:m.isFocusWithinPopoverGroup())?r:(null==(e=d.value)?void 0:e.activeElement)&&((null==(t=co(s))?void 0:t.contains(d.value.activeElement))||(null==(n=co(u))?void 0:n.contains(d.value.activeElement)))}()||s&&u&&(w.contains(e.target)||null!=(t=co(h.beforePanelSentinel))&&t.contains(e.target)||null!=(n=co(h.afterPanelSentinel))&&n.contains(e.target)||h.closePopover()))},!0),Eo(w.resolveContainers,(e,t)=>{var n;h.closePopover(),xo(t,ko.Loose)||(e.preventDefault(),null==(n=co(s))||n.focus())},Xe(()=>0===a.value)),()=>{let r={open:0===a.value,close:h.close};return Nt(Mt,[Nt(y,{},()=>Lo({theirProps:M(M({},e),n),ourProps:{ref:i},slot:r,slots:t,attrs:n,name:"Popover"})),Nt(w.MainTreeNode)])}}}),si=Ye({name:"PopoverButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(e,{attrs:t,slots:n,expose:r}){var o;let i=null!=(o=e.id)?o:`headlessui-popover-button-${lo()}`,a=ni("PopoverButton"),s=Xe(()=>mo(a.button));r({el:a.button,$el:a.button}),mt(()=>{a.buttonId.value=i}),Dt(()=>{a.buttonId.value=null});let l=oi(),c=null==l?void 0:l.closeOthers,u=Je(ii,null),d=Xe(()=>null!==u&&u.value===a.panelId.value),p=ct(null),h=`headlessui-focus-sentinel-${lo()}`;d.value||St(()=>{a.button.value=co(p)});let f=Ao(Xe(()=>({as:e.as,type:t.type})),p);function m(e){var t,n,r,o,i;if(d.value){if(1===a.popoverState.value)return;switch(e.key){case Uo.Space:case Uo.Enter:e.preventDefault(),null==(n=(t=e.target).click)||n.call(t),a.closePopover(),null==(r=co(a.button))||r.focus()}}else switch(e.key){case Uo.Space:case Uo.Enter:e.preventDefault(),e.stopPropagation(),1===a.popoverState.value&&(null==c||c(a.buttonId.value)),a.togglePopover();break;case Uo.Escape:if(0!==a.popoverState.value)return null==c?void 0:c(a.buttonId.value);if(!co(a.button)||null!=(o=s.value)&&o.activeElement&&(null==(i=co(a.button))||!i.contains(s.value.activeElement)))return;e.preventDefault(),e.stopPropagation(),a.closePopover()}}function g(e){d.value||e.key===Uo.Space&&e.preventDefault()}function v(t){var n,r;e.disabled||(d.value?(a.closePopover(),null==(n=co(a.button))||n.focus()):(t.preventDefault(),t.stopPropagation(),1===a.popoverState.value&&(null==c||c(a.buttonId.value)),a.togglePopover(),null==(r=co(a.button))||r.focus()))}function y(e){e.preventDefault(),e.stopPropagation()}let w=Ko();function b(){let e=co(a.panel);e&&uo(w.value,{[Wo.Forwards]:()=>To(e,vo.First),[Wo.Backwards]:()=>To(e,vo.Last)})===yo.Error&&To(bo().filter(e=>"true"!==e.dataset.headlessuiFocusGuard),uo(w.value,{[Wo.Forwards]:vo.Next,[Wo.Backwards]:vo.Previous}),{relativeTo:co(a.button)})}return()=>{let r=0===a.popoverState.value,o={open:r},s=Object.assign({},(x(e),e)),l=d.value?{ref:p,type:f.value,onKeydown:m,onClick:v}:{ref:p,id:i,type:f.value,"aria-expanded":0===a.popoverState.value,"aria-controls":co(a.panel)?a.panelId.value:void 0,disabled:!!e.disabled||void 0,onKeydown:m,onKeyup:g,onClick:v,onMousedown:y};return Nt(Mt,[Lo({ourProps:l,theirProps:M(M({},t),s),slot:o,attrs:t,slots:n,name:"PopoverButton"}),r&&!d.value&&a.isPortalled.value&&Nt(jo,{id:h,features:Fo.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:b})])}}});Ye({name:"PopoverOverlay",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0}},setup(e,{attrs:t,slots:n}){let r=ni("PopoverOverlay"),o=`headlessui-popover-overlay-${lo()}`,i=Ho(),a=Xe(()=>null!==i?(i.value&qo.Open)===qo.Open:0===r.popoverState.value);function s(){r.closePopover()}return()=>{let i={open:0===r.popoverState.value};return Lo({ourProps:{id:o,"aria-hidden":!0,onClick:s},theirProps:e,slot:i,attrs:t,slots:n,features:$o.RenderStrategy|$o.Static,visible:a.value,name:"PopoverOverlay"})}}});let li=Ye({name:"PopoverPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},focus:{type:Boolean,default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(e,{attrs:t,slots:n,expose:r}){var o;let i=null!=(o=e.id)?o:`headlessui-popover-panel-${lo()}`,{focus:a}=e,l=ni("PopoverPanel"),c=Xe(()=>mo(l.panel)),u=`headlessui-focus-sentinel-before-${lo()}`,d=`headlessui-focus-sentinel-after-${lo()}`;r({el:l.panel,$el:l.panel}),mt(()=>{l.panelId.value=i}),Dt(()=>{l.panelId.value=null}),Et(ii,l.panelId),St(()=>{var e,t;if(!a||0!==l.popoverState.value||!l.panel)return;let n=null==(e=c.value)?void 0:e.activeElement;null!=(t=co(l.panel))&&t.contains(n)||To(co(l.panel),vo.First)});let p=Ho(),h=Xe(()=>null!==p?(p.value&qo.Open)===qo.Open:0===l.popoverState.value);function f(e){var t,n;if(e.key===Uo.Escape){if(0!==l.popoverState.value||!co(l.panel)||c.value&&(null==(t=co(l.panel))||!t.contains(c.value.activeElement)))return;e.preventDefault(),e.stopPropagation(),l.closePopover(),null==(n=co(l.button))||n.focus()}}function m(e){var t,n,r,o,i;let a=e.relatedTarget;a&&co(l.panel)&&(null!=(t=co(l.panel))&&t.contains(a)||(l.closePopover(),(null!=(r=null==(n=co(l.beforePanelSentinel))?void 0:n.contains)&&r.call(n,a)||null!=(i=null==(o=co(l.afterPanelSentinel))?void 0:o.contains)&&i.call(o,a))&&a.focus({preventScroll:!0})))}let g=Ko();function v(){let e=co(l.panel);e&&uo(g.value,{[Wo.Forwards]:()=>{var t;To(e,vo.First)===yo.Error&&(null==(t=co(l.afterPanelSentinel))||t.focus())},[Wo.Backwards]:()=>{var e;null==(e=co(l.button))||e.focus({preventScroll:!0})}})}function y(){let e=co(l.panel);e&&uo(g.value,{[Wo.Forwards]:()=>{let e=co(l.button),t=co(l.panel);if(!e)return;let n=bo(),r=n.indexOf(e),o=n.slice(0,r+1),i=[...n.slice(r+1),...o];for(let a of i.slice())if("true"===a.dataset.headlessuiFocusGuard||null!=t&&t.contains(a)){let e=i.indexOf(a);-1!==e&&i.splice(e,1)}To(i,vo.First,{sorted:!1})},[Wo.Backwards]:()=>{var t;To(e,vo.Previous)===yo.Error&&(null==(t=co(l.button))||t.focus())}})}return()=>{let r={open:0===l.popoverState.value,close:l.close},{focus:o}=e,c=C(e,s);return Lo({ourProps:{ref:l.panel,id:i,onKeydown:f,onFocusout:a&&0===l.popoverState.value?m:void 0,tabIndex:-1},theirProps:M(M({},t),c),attrs:t,slot:r,slots:M(M({},n),{},{default:(...e)=>{var t;return[Nt(Mt,[h.value&&l.isPortalled.value&&Nt(jo,{id:u,ref:l.beforePanelSentinel,features:Fo.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:v}),null==(t=n.default)?void 0:t.call(n,...e),h.value&&l.isPortalled.value&&Nt(jo,{id:d,ref:l.afterPanelSentinel,features:Fo.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:y})])]}}),features:$o.RenderStrategy|$o.Static,visible:h.value,name:"PopoverPanel"})}}});Ye({name:"PopoverGroup",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"}},setup(e,{attrs:t,slots:n,expose:r}){let o=ct(null),i=Ct([]),a=Xe(()=>mo(o)),s=function(){let e=ct(null);return{mainTreeNodeRef:e,MainTreeNode:()=>Nt(jo,{features:Fo.Hidden,ref:e})}}();function l(e){let t=i.value.indexOf(e);-1!==t&&i.value.splice(t,1)}return r({el:o,$el:o}),Et(ri,{registerPopover:function(e){return i.value.push(e),()=>{l(e)}},unregisterPopover:l,isFocusWithinPopoverGroup:function(){var e;let t=a.value;if(!t)return!1;let n=t.activeElement;return!(null==(e=co(o))||!e.contains(n))||i.value.some(e=>{var r,o;return(null==(r=t.getElementById(e.buttonId.value))?void 0:r.contains(n))||(null==(o=t.getElementById(e.panelId.value))?void 0:o.contains(n))})},closeOthers:function(e){for(let t of i.value)t.buttonId.value!==e&&t.close()},mainTreeNodeRef:s.mainTreeNodeRef}),()=>Nt(Mt,[Lo({ourProps:{ref:o},theirProps:M(M({},e),t),slot:{},attrs:t,slots:n,name:"PopoverGroup"}),Nt(s.MainTreeNode)])}});let ci=Ye({props:{onFocus:{type:Function,required:!0}},setup(e){let t=ct(!0);return()=>t.value?Nt(jo,{as:"button",type:"button",features:Fo.Focusable,onFocus(n){n.preventDefault();let r,o=50;r=requestAnimationFrame(function n(){var i;if(!(o--<=0))return null!=(i=e.onFocus)&&i.call(e)?(t.value=!1,void cancelAnimationFrame(r)):void(r=requestAnimationFrame(n));r&&cancelAnimationFrame(r)})}}):null}});var ui=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(ui||{}),di=(e=>(e[e.Less=-1]="Less",e[e.Equal=0]="Equal",e[e.Greater=1]="Greater",e))(di||{});let pi=Symbol("TabsContext");function hi(e){let t=Je(pi,null);if(null===t){let t=new Error(`<${e} /> is missing a parent <TabGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,hi),t}return t}let fi=Symbol("TabsSSRContext"),mi=Ye({name:"TabGroup",emits:{change:e=>!0},props:{as:{type:[Object,String],default:"template"},selectedIndex:{type:[Number],default:null},defaultIndex:{type:[Number],default:0},vertical:{type:[Boolean],default:!1},manual:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(e,{slots:t,attrs:n,emit:r}){var o;let i=ct(null!=(o=e.selectedIndex)?o:e.defaultIndex),a=ct([]),s=ct([]),l=Xe(()=>null!==e.selectedIndex),c=Xe(()=>l.value?e.selectedIndex:i.value);function u(e){var t;let n=Mo(d.tabs.value,co),r=Mo(d.panels.value,co),o=n.filter(e=>{var t;return!(null!=(t=co(e))&&t.hasAttribute("disabled"))});if(e<0||e>n.length-1){let t=uo(null===i.value?0:Math.sign(e-i.value),{[-1]:()=>1,0:()=>uo(Math.sign(e),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0}),a=uo(t,{0:()=>n.indexOf(o[0]),1:()=>n.indexOf(o[o.length-1])});-1!==a&&(i.value=a),d.tabs.value=n,d.panels.value=r}else{let a=n.slice(0,e),s=[...n.slice(e),...a].find(e=>o.includes(e));if(!s)return;let l=null!=(t=n.indexOf(s))?t:d.selectedIndex.value;-1===l&&(l=d.selectedIndex.value),i.value=l,d.tabs.value=n,d.panels.value=r}}let d={selectedIndex:Xe(()=>{var t,n;return null!=(n=null!=(t=i.value)?t:e.defaultIndex)?n:null}),orientation:Xe(()=>e.vertical?"vertical":"horizontal"),activation:Xe(()=>e.manual?"manual":"auto"),tabs:a,panels:s,setSelectedIndex(e){c.value!==e&&r("change",e),l.value||u(e)},registerTab(e){var t;if(a.value.includes(e))return;let n=a.value[i.value];if(a.value.push(e),a.value=Mo(a.value,co),!l.value){let e=null!=(t=a.value.indexOf(n))?t:i.value;-1!==e&&(i.value=e)}},unregisterTab(e){let t=a.value.indexOf(e);-1!==t&&a.value.splice(t,1)},registerPanel(e){s.value.includes(e)||(s.value.push(e),s.value=Mo(s.value,co))},unregisterPanel(e){let t=s.value.indexOf(e);-1!==t&&s.value.splice(t,1)}};Et(pi,d);let p=ct({tabs:[],panels:[]}),h=ct(!1);mt(()=>{h.value=!0}),Et(fi,Xe(()=>h.value?null:p.value));let f=Xe(()=>e.selectedIndex);return mt(()=>{ft([f],()=>{var t;return u(null!=(t=e.selectedIndex)?t:e.defaultIndex)},{immediate:!0})}),St(()=>{if(!l.value||null==c.value||d.tabs.value.length<=0)return;let e=Mo(d.tabs.value,co);e.some((e,t)=>co(d.tabs.value[t])!==co(e))&&d.setSelectedIndex(e.findIndex(e=>co(e)===co(d.tabs.value[c.value])))}),()=>{let r={selectedIndex:i.value};return Nt(Mt,[a.value.length<=0&&Nt(ci,{onFocus:()=>{for(let e of a.value){let t=co(e);if(0===(null==t?void 0:t.tabIndex))return t.focus(),!0}return!1}}),Lo({theirProps:M(M({},n),Bo(e,["selectedIndex","defaultIndex","manual","vertical","onChange"])),ourProps:{},slot:r,slots:t,attrs:n,name:"TabGroup"})])}}}),gi=Ye({name:"TabList",props:{as:{type:[Object,String],default:"div"}},setup(e,{attrs:t,slots:n}){let r=hi("TabList");return()=>{let o={selectedIndex:r.selectedIndex.value};return Lo({ourProps:{role:"tablist","aria-orientation":r.orientation.value},theirProps:e,slot:o,attrs:t,slots:n,name:"TabList"})}}}),vi=Ye({name:"Tab",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},setup(e,{attrs:t,slots:n,expose:r}){var o;let i=null!=(o=e.id)?o:`headlessui-tabs-tab-${lo()}`,a=hi("Tab"),s=ct(null);r({el:s,$el:s}),mt(()=>a.registerTab(s)),Dt(()=>a.unregisterTab(s));let l=Je(fi),c=Xe(()=>{if(l.value){let e=l.value.tabs.indexOf(i);return-1===e?l.value.tabs.push(i)-1:e}return-1}),u=Xe(()=>{let e=a.tabs.value.indexOf(s);return-1===e?c.value:e}),d=Xe(()=>u.value===a.selectedIndex.value);function p(e){var t;let n=e();if(n===yo.Success&&"auto"===a.activation.value){let e=null==(t=mo(s))?void 0:t.activeElement,n=a.tabs.value.findIndex(t=>co(t)===e);-1!==n&&a.setSelectedIndex(n)}return n}function h(e){let t=a.tabs.value.map(e=>co(e)).filter(Boolean);if(e.key===Uo.Space||e.key===Uo.Enter)return e.preventDefault(),e.stopPropagation(),void a.setSelectedIndex(u.value);switch(e.key){case Uo.Home:case Uo.PageUp:return e.preventDefault(),e.stopPropagation(),p(()=>To(t,vo.First));case Uo.End:case Uo.PageDown:return e.preventDefault(),e.stopPropagation(),p(()=>To(t,vo.Last))}return p(()=>uo(a.orientation.value,{vertical:()=>e.key===Uo.ArrowUp?To(t,vo.Previous|vo.WrapAround):e.key===Uo.ArrowDown?To(t,vo.Next|vo.WrapAround):yo.Error,horizontal:()=>e.key===Uo.ArrowLeft?To(t,vo.Previous|vo.WrapAround):e.key===Uo.ArrowRight?To(t,vo.Next|vo.WrapAround):yo.Error}))===yo.Success?e.preventDefault():void 0}let f=ct(!1);function m(){var t;f.value||(f.value=!0,!e.disabled&&(null==(t=co(s))||t.focus({preventScroll:!0}),a.setSelectedIndex(u.value),function(e){"function"==typeof queueMicrotask?queueMicrotask(e):Promise.resolve().then(e).catch(e=>setTimeout(()=>{throw e}))}(()=>{f.value=!1})))}function g(e){e.preventDefault()}let v=Ao(Xe(()=>({as:e.as,type:t.type})),s);return()=>{var r,o;let l={selected:d.value,disabled:null!=(r=e.disabled)&&r},c=Object.assign({},(x(e),e));return Lo({ourProps:{ref:s,onKeydown:h,onMousedown:g,onClick:m,id:i,role:"tab",type:v.value,"aria-controls":null==(o=co(a.panels.value[u.value]))?void 0:o.id,"aria-selected":d.value,tabIndex:d.value?0:-1,disabled:!!e.disabled||void 0},theirProps:c,slot:l,attrs:t,slots:n,name:"Tab"})}}}),yi=Ye({name:"TabPanels",props:{as:{type:[Object,String],default:"div"}},setup(e,{slots:t,attrs:n}){let r=hi("TabPanels");return()=>{let o={selectedIndex:r.selectedIndex.value};return Lo({theirProps:e,ourProps:{},slot:o,attrs:n,slots:t,name:"TabPanels"})}}}),wi=Ye({name:"TabPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null},tabIndex:{type:Number,default:0}},setup(e,{attrs:t,slots:n,expose:r}){var o;let i=null!=(o=e.id)?o:`headlessui-tabs-panel-${lo()}`,a=hi("TabPanel"),s=ct(null);r({el:s,$el:s}),mt(()=>a.registerPanel(s)),Dt(()=>a.unregisterPanel(s));let c=Je(fi),u=Xe(()=>{if(c.value){let e=c.value.panels.indexOf(i);return-1===e?c.value.panels.push(i)-1:e}return-1}),d=Xe(()=>{let e=a.panels.value.indexOf(s);return-1===e?u.value:e}),p=Xe(()=>d.value===a.selectedIndex.value);return()=>{var r;let o={selected:p.value},{tabIndex:c}=e,u=C(e,l),h={ref:s,id:i,role:"tabpanel","aria-labelledby":null==(r=co(a.tabs.value[d.value]))?void 0:r.id,tabIndex:p.value?c:-1};return p.value||!e.unmount||e.static?Lo({ourProps:h,theirProps:u,slot:o,attrs:t,slots:n,features:$o.Static|$o.RenderStrategy,visible:p.value,name:"TabPanel"}):Nt(jo,M({as:"span","aria-hidden":!0},h))}}});const bi=Ye({__name:"ToggletipButton",props:{size:{default:"xs"},icon:{default:"fr-icon-information-line"}},setup(e){const t=e,n=Xe(()=>"md"===t.size?"":"xs"===t.size?`fr-btn--${t.size} fr-icon--sm`:`fr-btn--${t.size}`);return(t,r)=>(Ze(),Qe("button",{class:lt(`fr-btn fr-btn--tertiary-no-outline text-grey-380 fr-btn--darker-hover align-middle ${n.value} ${e.icon}`)},null,2))}}),ki=Ye(M(M({},{inheritAttrs:!1}),{},{__name:"Toggletip",props:{noMargin:{type:Boolean,default:!1},position:{default:"left"}},setup:e=>(t,n)=>(Ze(),nt(rt(ai),{class:"relative text-grey-500",focus:!0},{default:it(()=>[ut(rt(si),et(t.$attrs,{ref:"button",as:bi}),{default:it(()=>[tt(t.$slots,"default",{},void 0,!0)]),_:3},16),ut(rt(li),{class:lt(["toggletip",{"fr-p-0":e.noMargin,"left-0":"right"===e.position}]),ref:"toggletip"},{default:it(({close:e})=>[tt(t.$slots,"toggletip",{close:e},void 0,!0)]),_:3},8,["class"])]),_:3}))})),xi=An(ki,[["__scopeId","data-v-3bf812ef"]]),Ci={class:"fr-m-0 fr-grid-row fr-grid-row--middle fr-text--sm text-mention-grey"},Si={class:"fr-grid-row fr-grid-row--middle"},Mi={class:"fr-text--sm fr-my-0"},Ti={class:"list-style-none fr-m-0 fr-p-0"},Oi={class:"fr-grid-row fr-grid-row--right not-enlarged"},_i=["href","title"],Ni={class:"fr-my-0 fr-mr-1v text-mention-grey fr-text--sm"},Ei={class:"fr-grid-row fr-grid-row--middle fr-mr-1v"},Di=Ye({__name:"QualityComponentInline",props:{quality:{}},setup:e=>(t,n)=>(Ze(),Qe("div",Ci,[dt("div",Si,[ut(rt(xi),{class:"relative z-2"},{toggletip:it(()=>[dt("h5",Mi,pt(t.$t("Metadata quality:")),1),dt("ul",Ti,[ut(rt(oo),{passed:e.quality.dataset_description_quality,messagePassed:t.$t("Data description filled"),messageFailed:t.$t("Data description empty"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),ut(rt(oo),{passed:e.quality.resources_documentation,messagePassed:t.$t("Files documented"),messageFailed:t.$t("Files documentation missing"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),ut(rt(oo),{passed:e.quality.license,messagePassed:t.$t("License filled"),messageFailed:t.$t("No license set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),ut(rt(oo),{passed:e.quality.update_frequency&&!!e.quality.update_fulfilled_in_time,messagePassed:t.$t("Update frequency followed"),messageFailed:e.quality.update_frequency?t.$t("Update frequency not followed"):t.$t("Update frequency not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),ut(rt(oo),{passed:e.quality.has_open_format,messagePassed:t.$t("File formats are open"),messageFailed:t.$t("File formats are closed"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),ut(rt(oo),{passed:e.quality.temporal_coverage,messagePassed:t.$t("Temporal coverage filled"),messageFailed:t.$t("Temporal coverage not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),ut(rt(oo),{passed:e.quality.spatial,messagePassed:t.$t("Spatial coverage filled"),messageFailed:t.$t("Spatial coverage not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),ut(rt(oo),{passed:e.quality.all_resources_available,messagePassed:t.$t("All files are available"),messageFailed:t.$t("Some files are unavailable"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"])]),dt("div",Oi,[dt("a",{href:rt(_).guides_quality_url,target:"_blank",rel:"noopener",title:t.$t("Learn more about this indicator - opens a new window")},pt(t.$t("Learn more about this indicator")),9,_i)])]),_:1}),dt("p",Ni,pt(t.$t("Metadata :")),1),dt("div",Ei,[ut(rt(to),{score:e.quality.score},null,8,["score"])])])]))});const Ai=W({duration:!1,dismissible:!0});function $i(e){return Xe(()=>{const t=ht(e);if(t)return t.organization?t.organization.name:t.owner.first_name+" "+t.owner.last_name})}const Ri={class:"fr-my-2w fr-p-2w border border-default-grey fr-enlarge-link"},Li={key:0,class:"absolute top-0 fr-grid-row fr-grid-row--middle fr-mt-n3v fr-ml-n1v"},Ii={key:0,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},Pi={key:1,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},zi={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--top"},Bi={class:"fr-col-auto"},Fi={class:"logo"},ji={class:"fr-col-12 fr-col-sm"},Vi={class:"fr-text--md fr-mb-0 fr-grid-row"},qi={key:0,class:"fr-col-auto fr-ml-1w"},Hi={key:0,class:"fr-text--sm fr-m-0 inline-flex"},Ui={key:0,class:"not-enlarged fr-mr-1v"},Wi={class:"text-mention-grey dash-before-sm whitespace-nowrap"},Ki={class:"fr-mx-0 fr-mb-n1v fr-grid-row fr-grid-row--middle fr-text--sm text-mention-grey"},Yi={class:"fr-hidden flex-sm dash-after-sm text-grey-500"},Ji={class:"fr-grid-row fr-grid-row--middle fr-mr-1v"},Gi=["aria-label"],Xi=["aria-label"],Zi=["aria-label"],Qi=Ye({__name:"DatasetCard",props:{dataset:{},datasetUrl:{},organizationUrl:{},showDescription:{type:Boolean,default:!0}},setup(e){const t=e,{t:n}=H(),r=$i(t.dataset);return(t,o)=>(Ze(),Qe("div",Ri,[e.dataset.private||e.dataset.archived?(Ze(),Qe("div",Li,[e.dataset.private?(Ze(),Qe("p",Ii,[o[0]||(o[0]=dt("span",{class:"fr-icon-lock-line fr-icon--sm","aria-hidden":"true"},null,-1)),Tt(" "+pt(rt(n)("Draft")),1)])):st("",!0),e.dataset.archived?(Ze(),Qe("p",Pi,[o[1]||(o[1]=dt("span",{class:"fr-icon-archive-line fr-icon--sm","aria-hidden":"true"},null,-1)),Tt(" "+pt(rt(n)("Archived")),1)])):st("",!0)])):st("",!0),dt("div",zi,[dt("div",Bi,[dt("div",Fi,[e.dataset.organization?(Ze(),nt(rt(Qr),{key:0,type:"dataset",src:e.dataset.organization.logo_thumbnail,alt:"",size:40},null,8,["src"])):e.dataset.owner?(Ze(),nt(yn,{key:1,user:e.dataset.owner,size:40},null,8,["user"])):(Ze(),nt(rt(Qr),{key:2,type:"dataset",size:40}))])]),dt("div",ji,[dt("h4",Vi,[tt(t.$slots,"datasetUrl",{dataset:e.dataset,datasetUrl:e.datasetUrl},()=>[ut(mn,{to:e.datasetUrl,class:"text-grey-500 fr-grid-row"},{default:it(()=>[ut(rt(D),{class:"fr-col","auto-resize":!0,text:e.dataset.title,"max-lines":1},null,8,["text"]),e.dataset.acronym?(Ze(),Qe("small",qi,pt(e.dataset.acronym),1)):st("",!0)]),_:1},8,["to"])])]),e.dataset.organization||e.dataset.owner?(Ze(),Qe("div",Hi,[e.dataset.organization?(Ze(),Qe("span",Ui,[e.organizationUrl?(Ze(),nt(mn,{key:0,class:"fr-link fr-text--sm inline-flex items-center",to:e.organizationUrl},{default:it(()=>[ut(zr,{organization:e.dataset.organization},null,8,["organization"])]),_:1},8,["to"])):(Ze(),nt(zr,{key:1,organization:e.dataset.organization},null,8,["organization"]))])):(Ze(),nt(rt(D),{key:1,class:"not-enlarged fr-mr-1v","auto-resize":!0,text:rt(r),"max-lines":1},null,8,["text"])),dt("span",Wi,pt(t.$t("Updated {date}",{date:rt(K)(e.dataset.last_update)})),1)])):st("",!0),dt("div",Ki,[dt("div",Yi,[ut(rt(Di),{quality:e.dataset.quality},null,8,["quality"])]),dt("div",Ji,[dt("p",{class:"fr-text--sm fr-my-0","aria-label":rt(n)("{n} resources downloads",e.dataset.metrics.resources_downloads)},[o[2]||(o[2]=dt("span",{class:"fr-icon-download-line fr-icon--sm fr-px-1v","aria-hidden":"true"},null,-1)),Tt(pt(rt(Y)(e.dataset.metrics.resources_downloads)),1)],8,Gi),dt("p",{class:"fr-text--sm fr-my-0","aria-label":rt(n)("{n} followers",e.dataset.metrics.followers)},[o[3]||(o[3]=dt("span",{class:"fr-icon-star-line fr-icon--sm fr-px-1v","aria-hidden":"true"},null,-1)),Tt(pt(rt(Y)(e.dataset.metrics.followers)),1)],8,Xi),dt("p",{class:"fr-text--sm fr-my-0","aria-label":rt(n)("{n} reuses",e.dataset.metrics.reuses)},[o[4]||(o[4]=dt("span",{class:"fr-icon-line-chart-line fr-icon--sm fr-px-1v","aria-hidden":"true"},null,-1)),Tt(pt(rt(Y)(e.dataset.metrics.reuses)),1)],8,Zi)])]),e.showDescription?(Ze(),nt(Rt,{key:1},{default:it(()=>[ut(gn,{class:"fr-text--sm fr-mt-1w fr-mb-0 overflow-wrap-anywhere","auto-resize":!0,text:rt(J)(e.dataset.description),"max-lines":2},null,8,["text"])]),_:1})):st("",!0)])])]))}}),ea={key:0,class:"absolute top-0 fr-grid-row fr-grid-row--middle fr-mt-n3v fr-ml-n1v"},ta={key:0,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},na={key:1,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},ra={key:2,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},oa={class:"fr-text--md fr-mb-0"},ia={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",class:"fr-mr-1v",style:{width:"1rem"}},aa={key:1,class:"fr-icon-terminal-line fr-icon--sm fr-mr-1v","aria-hidden":"true"},sa={key:1,class:"fr-text--sm text-mention-grey inline-flex fr-mt-1v fr-mb-0"},la={key:0,class:"not-enlarged"},ca={class:"dash-before whitespace-nowrap"},ua={class:"fr-text--sm text-mention-grey fr-my-0 fr-mt-1v"},da={class:"text-grey-400"},pa=Ye({__name:"DataserviceCard",props:{dataservice:{},dataserviceUrl:{},organizationUrl:{},showDescription:{type:Boolean,default:!0}},setup(e){const t=e,{t:n}=H(),r=$i(t.dataservice),o=Xe(()=>_.tabular_api_dataservice_id===t.dataservice.id);return(i,a)=>(Ze(),Qe("article",{class:lt(["fr-my-2w fr-p-2w border fr-enlarge-link",{"border-tabular-api":o.value}]),style:Lt(t.style)},["restricted"===e.dataservice.access_type||e.dataservice.private||e.dataservice.archived_at?(Ze(),Qe("div",ea,["restricted"===e.dataservice.access_type?(Ze(),Qe("p",ta,[a[0]||(a[0]=dt("span",{class:"fr-icon-lock-line fr-icon--sm","aria-hidden":"true"},null,-1)),Tt(" "+pt(rt(n)("Restricted access")),1)])):st("",!0),e.dataservice.private?(Ze(),Qe("p",na,[a[1]||(a[1]=dt("span",{class:"fr-icon-lock-line fr-icon--sm","aria-hidden":"true"},null,-1)),Tt(" "+pt(rt(n)("Draft")),1)])):st("",!0),e.dataservice.archived_at?(Ze(),Qe("p",ra,[a[2]||(a[2]=dt("span",{class:"fr-icon-lock-line fr-icon--sm","aria-hidden":"true"},null,-1)),Tt(" "+pt(rt(n)("Archived")),1)])):st("",!0)])):st("",!0),dt("h4",oa,[tt(i.$slots,"dataserviceUrl",{dataservice:e.dataservice,dataserviceUrl:e.dataserviceUrl},()=>[o.value?(Ze(),Qe("svg",ia,[...a[3]||(a[3]=[dt("path",{d:"M17.0007 1.20825 18.3195 3.68108 20.7923 4.99992 18.3195 6.31876 17.0007 8.79159 15.6818 6.31876 13.209 4.99992 15.6818 3.68108 17.0007 1.20825ZM10.6673 9.33325 15.6673 11.9999 10.6673 14.6666 8.00065 19.6666 5.33398 14.6666.333984 11.9999 5.33398 9.33325 8.00065 4.33325 10.6673 9.33325ZM11.4173 11.9999 9.18905 10.8115 8.00065 8.58325 6.81224 10.8115 4.58398 11.9999 6.81224 13.1883 8.00065 15.4166 9.18905 13.1883 11.4173 11.9999ZM19.6673 16.3333 18.0007 13.2083 16.334 16.3333 13.209 17.9999 16.334 19.6666 18.0007 22.7916 19.6673 19.6666 22.7923 17.9999 19.6673 16.3333Z"},null,-1)])])):(Ze(),Qe("span",aa)),ut(mn,{class:"inline-flex",to:e.dataserviceUrl},{default:it(()=>[ut(rt(D),{"auto-resize":!0,text:e.dataservice.title,"max-lines":1},null,8,["text"])]),_:1},8,["to"])],!0)]),e.dataservice.organization||e.dataservice.owner?(Ze(),Qe("p",sa,[e.dataservice.organization?(Ze(),Qe("span",la,[e.organizationUrl?(Ze(),nt(mn,{key:0,class:"fr-link fr-text--sm",to:e.organizationUrl},{default:it(()=>[ut(zr,{organization:e.dataservice.organization},null,8,["organization"])]),_:1},8,["to"])):(Ze(),nt(zr,{key:1,organization:e.dataservice.organization},null,8,["organization"]))])):(Ze(),nt(rt(D),{key:1,class:"not-enlarged fr-mr-1v","auto-resize":!0,text:rt(r),"max-lines":1},null,8,["text"])),dt("span",ca,pt(rt(n)("Updated {date}",{date:rt(K)(e.dataservice.metadata_modified_at)})),1)])):st("",!0),dt("p",ua,[a[4]||(a[4]=dt("span",{class:"fr-icon-information-line fr-icon--sm text-grey-380"},null,-1)),Tt(" "+pt(rt(n)("Availability :"))+" ",1),dt("span",da,[e.dataservice.availability?(Ze(),Qe(Mt,{key:0},[Tt(pt(rt(n)("{n}%",e.dataservice.availability)),1)],64)):(Ze(),Qe(Mt,{key:1},[Tt(pt(rt(n)("unknown")),1)],64))])]),e.showDescription?(Ze(),nt(Rt,{key:2},{default:it(()=>[ut(gn,{class:"fr-text--sm fr-mt-1w fr-mb-0 overflow-wrap-anywhere","auto-resize":!0,text:rt(J)(e.dataservice.description),"max-lines":2},null,8,["text"])]),_:1})):st("",!0)],6))}}),ha=An(pa,[["__scopeId","data-v-47254e37"]]),fa={class:"fr-grid-row fr-grid-row--middle fr-pb-3w fr-mb-3w border-bottom border-default-grey"},ma={class:"fr-col"},ga={class:"fr-col-auto"},va=["aria-expanded","aria-controls"],ya=["id"],wa={class:"fr-pb-3w fr-mb-3w border-bottom border-default-grey"},ba={class:"fr-grid-row fr-grid-row--gutters fr-text--sm fr-m-0","data-testid":"extra-list"},ka={class:"subtitle fr-mb-1v"},xa={class:"fr-text--sm fr-m-0 text-mention-grey overflow-wrap-anywhere"},Ca=Ye({__name:"ExtraAccordion",props:{buttonText:{},titleText:{},extra:{},titleLevel:{}},setup(e){const t=G("accordion"),{expanded:n,expand:r}=function(e){const t=ct(!1);return{expanded:t,expand:function(){t.value=!t.value;const n=document.getElementById(e);n&&Mr(n,t.value)}}}(t);return(o,i)=>(Ze(),Qe("div",null,[dt("header",fa,[dt("div",ma,[(Ze(),nt(It(e.titleLevel),{class:"subtitle subtitle--uppercase fr-m-0"},{default:it(()=>[Tt(pt(e.titleText),1)]),_:1}))]),dt("div",ga,[dt("button",{onClick:i[0]||(i[0]=(...e)=>rt(r)&&rt(r)(...e)),role:"button","aria-expanded":rt(n),"aria-controls":rt(t),class:lt(["fr-btn fr-btn--tertiary-no-outline fr-btn--icon-left fr-btn--secondary-grey-500",{"fr-icon-arrow-up-s-line":rt(n),"fr-icon-arrow-down-s-line":!rt(n)}]),"data-testid":"button"},[rt(n)?(Ze(),Qe(Mt,{key:0},[Tt(pt(o.$t("Close details")),1)],64)):(Ze(),Qe(Mt,{key:1},[Tt(pt(e.buttonText),1)],64))],10,va)])]),dt("div",{class:"accordion-content",id:rt(t)},[dt("div",wa,[dt("div",ba,[(Ze(!0),Qe(Mt,null,Pt(e.extra,(e,t)=>(Ze(),Qe("div",{key:t,class:"fr-col-12 fr-col-sm-6 fr-col-md-4"},[dt("h3",ka,pt(t),1),dt("p",xa,pt(e),1)]))),128))])])],8,ya)]))}}),Sa=Ye({__name:"OwnerType",props:{type:{},size:{default:"sm"},color:{default:"grey"}},setup(e){const t=e,n=Xe(()=>{switch(t.color){case"black":return"text-grey-500";case"grey":return"text-mention-grey"}}),r=Xe(()=>Lr(t.type).label);return(t,o)=>(Ze(),Qe("p",{class:lt(`${n.value} fr-text--${e.size} fr-my-0`)},[ut(Ir,{type:e.type},null,8,["type"]),Tt(" "+pt(r.value),1)],2))}});function Ma(e,t=1){return[...Array(e).keys()].map(e=>e+t)}function Ta(e,t){const n=function(e){return Ma(e)}(t),r=function(e){return Math.max(e-3,2)}(e);if(t<=2)return[];let o=Ma(function(e,t){return Math.min(7,e.length-2,3+t-1,3+e.length-t)}(n,e),r);return o.includes(2)||o.unshift(null),o.includes(t-1)||o.push(null),o}const Oa=["aria-label"],_a={class:"fr-pagination__list"},Na=["href"],Ea=["href"],Da=["aria-current","href","title"],Aa=["aria-current","href","title","onClick","data-testid"],$a={key:1,class:"fr-pagination__link fr-hidden fr-unhidden-lg"},Ra=["aria-current","href","title","data-testid"],La=["href"],Ia=["href"],Pa=Ye({__name:"Pagination",props:{page:{default:1},pageSize:{default:20},totalResults:{}},emits:["change"],setup(e,{emit:t}){const n=t,r=e,{t:o}=H(),i=Xe(()=>Math.ceil(r.totalResults/r.pageSize)),a=Xe(()=>Ta(r.page,i.value)),s=e=>{if(e!==r.page)return n("change",e)},l=()=>{const e=r.page+1;if(e<=i.value)return n("change",e)},c=()=>{const e=r.page-1;if(e>0)return n("change",e)};return(t,n)=>e.totalResults>e.pageSize?(Ze(),Qe("nav",{key:0,role:"navigation",class:"fr-pagination fr-pagination--centered","aria-label":rt(o)("Pagination")},[dt("ul",_a,[dt("li",null,[dt("a",{href:1===e.page?void 0:"#",class:"fr-pagination__link fr-pagination__link--first",onClick:n[0]||(n[0]=zt(e=>s(1),["prevent"])),"data-testid":"first-page"},pt(rt(o)("First page")),9,Na)]),dt("li",null,[dt("a",{href:1===e.page?void 0:"#",class:"fr-pagination__link fr-pagination__link--prev fr-pagination__link--lg-label",onClick:zt(c,["prevent"]),"data-testid":"previous-page"},pt(rt(o)("Previous page")),9,Ea)]),dt("li",null,[dt("a",{"aria-current":1===e.page?"page":void 0,href:1===e.page?void 0:"#",class:lt(["fr-pagination__link",{"fr-hidden fr-unhidden-sm":e.page>1}]),title:rt(o)("Page {nb}",{nb:1}),onClick:n[1]||(n[1]=zt(e=>s(1),["prevent"])),"data-testid":1}," 1 ",10,Da)]),(Ze(!0),Qe(Mt,null,Pt(a.value,t=>(Ze(),Qe("li",null,[t?(Ze(),Qe("a",{key:0,class:lt(["fr-pagination__link",{"fr-hidden fr-unhidden-lg":t<e.page-1||t>e.page+1}]),"aria-current":e.page===t?"page":void 0,href:e.page===t?void 0:"#",title:rt(o)("Page {nb}",{nb:t}),onClick:zt(e=>s(t),["prevent"]),"data-testid":t},pt(t),11,Aa)):(Ze(),Qe("a",$a,"  "))]))),256)),dt("li",null,[dt("a",{class:"fr-pagination__link","aria-current":e.page===i.value?"page":void 0,href:e.page===i.value?void 0:"#",title:rt(o)("Page {nb}",{nb:i.value}),onClick:n[2]||(n[2]=zt(e=>s(i.value),["prevent"])),"data-testid":i.value},pt(i.value),9,Ra)]),dt("li",null,[dt("a",{class:"fr-pagination__link fr-pagination__link--next fr-pagination__link--lg-label",href:e.page===i.value?void 0:"#",onClick:zt(l,["prevent"]),"data-testid":"next-page"},pt(rt(o)("Next page")),9,La)]),dt("li",null,[dt("a",{class:"fr-pagination__link fr-pagination__link--last",href:e.page===i.value?void 0:"#",onClick:n[3]||(n[3]=zt(e=>s(i.value),["prevent"])),"data-testid":"last-page"},pt(rt(o)("Last page")),9,Ia)])])],8,Oa)):st("",!0)}}),za={class:"relative"},Ba=Ye({__name:"ReadMore",props:{maxHeight:{default:""}},setup(e){const t=e,n=ct(!1),r=ct(!1),o=Jr("containerRef"),i=Jr("readMoreRef"),{height:a}=function(e,t={width:0,height:0},n={}){const{window:r=Yr,box:o="content-box"}=n,i=Xe(()=>{var t,n;return null==(n=null==(t=Kr(e))?void 0:t.namespaceURI)?void 0:n.includes("svg")}),a=ct(t.width),s=ct(t.height),{stop:l}=Xr(e,([t])=>{const n="border-box"===o?t.borderBoxSize:"content-box"===o?t.contentBoxSize:t.devicePixelContentBoxSize;if(r&&i.value){const t=Kr(e);if(t){const e=t.getBoundingClientRect();a.value=e.width,s.value=e.height}}else if(n){const e=Array.isArray(n)?n:[n];a.value=e.reduce((e,{inlineSize:t})=>e+t,0),s.value=e.reduce((e,{blockSize:t})=>e+t,0)}else a.value=t.contentRect.width,s.value=t.contentRect.height},n);Ur(()=>{const n=Kr(e);n&&(a.value="offsetWidth"in n?n.offsetWidth:t.width,s.value="offsetHeight"in n?n.offsetHeight:t.height)});const c=ft(()=>Kr(e),e=>{a.value=e?t.width:0,s.value=e?t.height:0});return{width:a,height:s,stop:function(){l(),c()}}}(o),s=ct(284),l=e=>{const t=getComputedStyle(e);return parseFloat(t.getPropertyValue("height"))+parseFloat(t.getPropertyValue("margin-top"))+parseFloat(t.getPropertyValue("margin-bottom"))},c=()=>{const e=document.querySelector(`[data-read-more-max-height="${t.maxHeight}"]`);return e?Array.from(e.children).map(l).reduce((e,t)=>e+t,0):284},u=()=>{if(!i.value)return;const e=Sr(i.value);n.value?V({from:{height:i.value.scrollHeight},to:{height:c()},duration:300,ease:q}).start({update:e.set,complete:()=>{var e;return null===(e=i.value)||void 0===e?void 0:e.scrollIntoView({behavior:"smooth"})}}):V({from:{height:c()},to:{height:i.value.scrollHeight},duration:300,ease:q}).start({update:e.set,complete:()=>e.set({height:"auto"})}),n.value=!n.value};return ft(a,e=>{s.value=c(),r.value=e>s.value,r.value||(s.value=e)}),(e,t)=>(Ze(),Qe("div",za,[dt("div",{class:lt(["read-more",{expand:n.value}]),ref_key:"readMoreRef",ref:i,style:Lt({height:s.value+"px"})},[dt("div",{ref_key:"containerRef",ref:o},[tt(e.$slots,"default")],512)],6),r.value?(Ze(),Qe("div",{key:0,class:"read-more__bottom",onClick:zt(u,["prevent"])},[dt("button",{role:"button",class:"fr-btn fr-btn--tertiary-no-outline",onClick:zt(u,["prevent","stop"])},[n.value?(Ze(),Qe(Mt,{key:0},[Tt(pt(e.$t("Read less")),1)],64)):(Ze(),Qe(Mt,{key:1},[Tt(pt(e.$t("Read more")),1)],64))])])):st("",!0)]))}}),Fa=["y"],ja=["y"],Va=["y"],qa=["y"],Ha=["y"],Ua=["y"],Wa=["y"],Ka=Ye({__name:"Loader",setup(e){function t(e){return 20+56*e}return(e,n)=>(Ze(),nt(rt(ln),{width:1124,height:300,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},{default:it(()=>[n[0]||(n[0]=dt("rect",{x:"16",y:"16",rx:"4",ry:"4",width:"112",height:"24"},null,-1)),n[1]||(n[1]=dt("rect",{x:"160",y:"16",rx:"4",ry:"4",width:"116",height:"24"},null,-1)),n[2]||(n[2]=dt("rect",{x:"308",y:"16",rx:"4",ry:"4",width:"140",height:"24"},null,-1)),n[3]||(n[3]=dt("rect",{x:"480",y:"16",rx:"4",ry:"4",width:"106",height:"24"},null,-1)),n[4]||(n[4]=dt("rect",{x:"618",y:"16",rx:"4",ry:"4",width:"140",height:"24"},null,-1)),n[5]||(n[5]=dt("rect",{x:"790",y:"16",rx:"4",ry:"4",width:"144",height:"24"},null,-1)),n[6]||(n[6]=dt("rect",{x:"966",y:"16",rx:"4",ry:"4",width:"142",height:"24"},null,-1)),n[7]||(n[7]=dt("rect",{x:"4",y:"56",rx:"4",ry:"4",width:"1116",height:"4"},null,-1)),(Ze(),Qe(Mt,null,Pt(5,e=>(Ze(),Qe(Mt,null,[dt("rect",{x:"16",y:t(e),rx:"4",ry:"4",width:"112",height:"32"},null,8,Fa),dt("rect",{x:"160",y:t(e),rx:"4",ry:"4",width:"116",height:"32"},null,8,ja),dt("rect",{x:"308",y:t(e),rx:"4",ry:"4",width:"140",height:"32"},null,8,Va),dt("rect",{x:"480",y:t(e),rx:"4",ry:"4",width:"106",height:"32"},null,8,qa),dt("rect",{x:"618",y:t(e),rx:"4",ry:"4",width:"140",height:"32"},null,8,Ha),dt("rect",{x:"790",y:t(e),rx:"4",ry:"4",width:"144",height:"32"},null,8,Ua),dt("rect",{x:"966",y:t(e),rx:"4",ry:"4",width:"142",height:"32"},null,8,Wa)],64))),64))]),_:1}))}});const Ya={key:0,class:"bg-alt-green-tilleul-verveine fr-p-3v fr-mb-2w"},Ja={class:"fr-grid-row fr-m-0"},Ga={key:2,class:"fr-grid-row fr-grid-row--gutters"},Xa={key:0,class:"bg-alt-green-tilleul-verveine fr-p-3v fr-mb-2w"},Za={class:"fr-grid-row fr-m-0"},Qa={class:"fr-col-12 fr-col-sm-6 fr-col-md-4 fr-col-lg-3"},es={class:"fr-text--sm fr-text--bold fr-mt-0 fr-mb-1v"},ts={class:"code"},ns=Ye({__name:"DataStructure",props:{resource:{}},setup(e){const t=e,n=ct([]),r=ct({}),o=ct(!0),i=ct(!1),a=ct(!1);return mt(async()=>{try{const{data:e}=await function(e){const t=`${_.tabular_api_url}/api/resources/${e}/profile/`;return X.get(t)}(t.resource.id);"profile"in e&&e.profile?(n.value=Object.keys(e.profile.columns),r.value=e.profile.columns,a.value=!0,o.value=!1):(i.value=!0,o.value=!1)}catch(e){i.value=!0,o.value=!1}}),(e,t)=>i.value?(Ze(),Qe("div",Ya,[dt("p",Ja,[t[0]||(t[0]=dt("span",{class:"fr-icon-warning-line","aria-hidden":"true"},null,-1)),Tt(" "+pt(e.$t("The data structure of this file failed to load.")),1)])])):o.value?(Ze(),nt(Ka,{key:1})):(Ze(),Qe("div",Ga,[a.value?st("",!0):(Ze(),Qe("div",Xa,[dt("p",Za,[t[1]||(t[1]=dt("span",{class:"fr-icon-warning-line","aria-hidden":"true"},null,-1)),Tt(" "+pt(e.$t("No data structure found for this file.")),1)])])),a.value?(Ze(!0),Qe(Mt,{key:1},Pt(n.value,e=>(Ze(),Qe("div",Qa,[dt("h5",es,pt(e),1),dt("code",ts,pt(r.value[e].format),1)]))),256)):st("",!0)]))}}),rs={key:0,class:"bg-alt-green-tilleul-verveine fr-p-3v fr-mt-4w fr-mx-4w fr-mb-3v"},is={class:"fr-grid-row fr-m-0"},as={class:"bg-blue-100 text-blue-400 fr-hidden fr-unhidden-md fr-p-2w"},ss={class:"fr-grid-row fr-grid-row--middle fr-grid-row--gutters"},ls=["innerHTML"],cs={class:"fr-col"},us={class:"fr-text--bold fr-m-0"},ds={class:"fr-text--sm fr-m-0 f-italic"},ps={class:"fr-col-auto fr-my-0"},hs=["href"],fs={class:"fr-table fr-table--no-background fr-p-0 fr-pt-0-5v fr-m-0"},ms={class:"fr-mb-3w"},gs={class:"fr-sr-only"},vs={scope:"col"},ys={class:"fr-grid-row fr-grid-row--middle col-width"},ws=["onClick"],bs={class:"fr-sr-only"},ks={class:"cell-padding"},xs={class:"fr-grid-row fr-grid-row--middle fr-text--xs w-100 style-cell"},Cs={class:"fr-my-auto"},Ss={class:"fr-px-5v"},Ms=Ye({__name:"Preview",props:{resource:{}},setup(e){const t=e,{t:n}=H(),r=ct([]),o=ct([]),i=ct(!0),a=ct(!1),s=ct(null),l=ct(0),c=_.tabular_page_size,u=ct(1);function d(e){var t;return e===(null===(t=s.value)||void 0===t?void 0:t.column)}async function p(e,n){try{const{data:s}=await function(e,t,n){let r=`${_.tabular_api_url}/api/resources/${e}/data/?page=${t}&page_size=${_.tabular_page_size}`;return n&&(r+=`&${n.column}__sort=${n.type}`),X.get(r)}(t.resource.id,e,n);"data"in s&&s.data&&s.data.length>0?(r.value=s.data,o.value=Object.keys(s.data[0]).filter(e=>"__id"!==e),l.value=s.meta.total,u.value=e,i.value=!1):(a.value=!0,i.value=!1)}catch(s){a.value=!0,i.value=!1}}function h(e){p(e,s.value)}const f=Z(t.resource.extras["analysis:parsing:finished_at"]);return mt(()=>{p(u.value)}),(t,m)=>(Ze(),Qe("div",null,[a.value?(Ze(),Qe("div",rs,[dt("p",is,[m[0]||(m[0]=dt("span",{class:"fr-icon-warning-line","aria-hidden":"true"},null,-1)),Tt(" "+pt(rt(n)("The preview of this file failed to load.")),1)])])):i.value?(Ze(),nt(Ka,{key:1})):(Ze(),Qe(Mt,{key:2},[dt("div",as,[dt("div",ss,[dt("div",{class:"fr-col-auto",innerHTML:rt('<svg width="64" height="64" viewBox="0 0 64 64" aria-hidden="true" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="path-1-inside-1_677_1834" fill="white"><path d="M47.6364 31.7323C47.8391 31.8153 48.0153 31.8812 48.1901 31.9556C49.3599 32.4569 50.0394 33.3352 50.1277 34.6162C50.1983 35.6647 50.2292 36.7158 50.2371 37.7685C50.2523 39.8635 51.2789 41.4763 52.6657 42.8981C53.5865 43.842 53.6661 44.3716 52.7286 45.2974C51.1332 46.8812 49.3827 48.2165 47.1329 48.7665C44.8819 49.3216 42.5083 49.0548 40.4357 48.0138C39.4892 47.5604 38.5265 47.3019 37.5309 47.7071C37.071 47.9103 36.6618 48.214 36.3331 48.596C36.0111 48.9977 35.7367 49.4357 35.5154 49.9011C35.0548 50.75 34.2981 51.2484 33.4773 51.6648C33.2122 51.7978 32.9196 51.8661 32.6233 51.8641C32.3271 51.862 32.0355 51.7897 31.7724 51.653C31.4776 51.521 31.2044 51.3451 30.9618 51.1313C29.8211 50.0656 28.445 49.7385 26.9352 49.6965C24.2186 49.5962 21.5474 48.9671 19.0698 47.8441C18.4504 47.5532 17.8641 47.1957 17.3213 46.7778C16.6911 46.3217 16.5988 45.9152 16.8344 45.1807C17.1056 44.3195 17.3992 43.4821 17.6453 42.6226C17.6638 42.5251 17.6598 42.4247 17.6338 42.329C17.6077 42.2333 17.5603 42.1449 17.495 42.0705C16.4777 41.1564 16.4698 41.1632 15.3346 41.8919C12.2675 43.8671 9.1983 45.8419 6.12697 47.816C5.39573 48.2874 5.04746 48.1891 4.61497 47.4308C4.33147 46.9348 4.052 46.4365 3.77656 45.9357C3.18563 44.8787 3.26602 44.5782 4.27115 43.9407C7.48797 41.9067 10.6834 39.8658 13.9015 37.8507C14.3035 37.5956 14.4007 37.3572 14.3108 36.8936C13.6776 33.714 14.5417 30.9795 16.8278 28.6954C16.9816 28.5764 17.0894 28.4073 17.1328 28.2171C17.1763 28.027 17.1526 27.8277 17.0658 27.6532C16.5668 26.2486 15.7792 25.1355 14.3525 24.5233C13.5227 24.1467 12.7175 23.7178 11.9416 23.2391C10.7864 22.5922 9.89092 21.5619 9.40841 20.3243C9.31335 20.0822 9.28169 19.8197 9.31644 19.5617C9.3512 19.3037 9.45121 19.059 9.60692 18.8509C10.6377 17.2552 12.2625 16.7311 13.9773 16.7337C15.3337 16.7378 16.6957 17.1374 18.0435 17.418C19.2594 17.6697 19.3451 17.666 19.9235 16.5752C20.1987 16.055 20.4163 15.4882 20.7251 14.9994C21.2758 14.1191 21.9105 13.926 22.8624 14.3348C23.2938 14.516 23.7286 14.7474 24.1486 14.9462C24.9684 15.324 25.7026 15.2084 26.3461 14.585C26.6077 14.3351 26.842 14.0578 27.045 13.7578C27.8829 12.5231 28.9904 11.4969 30.2827 10.7576C31.7264 9.85971 32.9011 8.58535 33.6818 7.07013C34.0043 6.47507 34.6284 6.37336 35.1547 6.87449C36.1787 7.85765 37.2353 8.82594 38.1708 9.8952C39.6137 11.5828 41.5324 12.7905 43.6733 13.3587C45.1679 13.7661 46.5788 14.4553 48.045 14.97C49.8289 15.5957 51.624 16.1995 53.4326 16.7561C54.4429 17.0682 54.7071 17.4125 54.4318 18.4614C53.8032 20.8525 53.1633 23.2416 52.512 25.6287C52.2313 26.6591 51.5044 27.3829 50.6757 27.9621C49.3363 28.9134 48.2845 30.2182 47.6364 31.7323ZM19.0829 43.0845C18.8621 43.7906 18.688 44.4745 18.4321 45.1261C18.2675 45.546 18.3981 45.7414 18.7452 45.9473C21.1132 47.3103 23.6962 47.8813 26.3813 48.163C27.5256 48.2847 28.6999 48.356 29.785 48.6883C30.5876 48.9346 31.287 49.5481 32.0035 50.0404C32.41 50.3202 32.7838 50.4547 33.176 50.0845C33.6071 49.6961 34.0124 49.2799 34.3896 48.8386C34.6545 48.4664 34.8964 48.0784 35.1142 47.6767C35.6541 46.8224 36.438 46.3537 37.4121 46.1269C38.6063 45.8473 39.8607 46.0113 40.9435 46.5887C43.5843 47.9246 46.236 47.8653 48.8 46.4721C49.8779 45.8886 50.796 44.9852 51.8339 44.1811C49.2935 41.8756 48.4762 39.073 48.724 35.8709C48.7321 35.4135 48.6838 34.9569 48.5801 34.5115C48.4556 33.8144 47.9893 33.425 47.3285 33.2617C47.0897 33.2022 46.8401 33.1982 46.5981 33.1537C45.8078 32.9971 45.5014 32.4304 45.8734 31.7287C46.8901 29.7991 47.9735 27.9259 49.8707 26.6837C50.2318 26.4528 50.5403 26.1477 50.7759 25.7885C51.0114 25.4292 51.1688 25.0241 51.2375 24.5995C51.4742 23.351 51.8317 22.1215 52.1618 20.8919C52.3982 20.012 52.6732 19.1464 52.9439 18.2473C52.0883 17.992 51.2364 17.7912 50.4176 17.4913C48.2143 16.6752 46.0306 15.8094 43.8326 14.9782C42.7874 14.5843 41.7022 14.2815 40.6869 13.8328C38.9215 13.0457 37.6898 11.5944 36.4238 10.1918C35.887 9.59656 35.273 9.06983 34.7665 8.58209C33.7652 9.61965 32.9772 10.7416 31.9168 11.4609C30.2571 12.5878 28.7721 13.8207 27.6019 15.4618C27.008 16.2924 26.1005 16.6368 25.0653 16.6718C24.1996 16.7016 23.4937 16.3034 22.7614 15.9491C22.0637 15.6113 22.0795 15.6271 21.7115 16.3264C21.3435 17.0257 20.9463 17.727 20.5177 18.3967C20.3427 18.6865 20.0779 18.9105 19.764 19.0344C19.45 19.1582 19.1044 19.1751 18.7801 19.0823C17.7876 18.8694 16.7939 18.6383 15.799 18.389C14.442 18.0468 13.0074 18.2086 11.7591 18.8447C10.8519 19.286 10.659 19.8764 11.3125 20.6174C11.7995 21.1706 12.3573 21.6566 12.9713 22.0626C13.7107 22.5281 14.4823 22.9399 15.2802 23.2949C16.2898 23.744 17.1328 24.5015 17.6895 25.4597C18.0248 26.0498 18.3157 26.6661 18.629 27.2724C23.4786 24.8338 27.9071 26.9763 29.9508 29.657C31.1027 31.1657 31.7438 33.0057 31.7801 34.9075C31.8164 36.8093 31.2461 38.6732 30.1526 40.2264C28.1536 43.0702 23.9809 45.1654 19.0829 43.0845ZM23.4376 42.3861C27.4778 42.1222 30.5404 38.6684 30.2798 34.6712C30.16 32.7164 29.2747 30.8892 27.8175 29.5894C26.3603 28.2897 24.4499 27.6232 22.5043 27.7359C21.536 27.7825 20.5865 28.0224 19.7111 28.4416C18.8358 28.8608 18.0522 29.4508 17.4059 30.1773C16.7596 30.9039 16.2636 31.7523 15.9469 32.6733C15.6301 33.5943 15.4988 34.5693 15.5608 35.5416C15.6227 36.5139 15.8766 37.4639 16.3076 38.3364C16.7387 39.2089 17.3382 39.9863 18.0714 40.6234C18.8045 41.2604 19.6566 41.7444 20.5779 42.047C21.4992 42.3497 22.4713 42.465 23.4376 42.3861ZM5.73574 46.2692L15.5443 39.9311L14.9626 38.9176L5.11278 45.1722L5.73574 46.2692Z"/></mask><path d="M47.6364 31.7323C47.8391 31.8153 48.0153 31.8812 48.1901 31.9556C49.3599 32.4569 50.0394 33.3352 50.1277 34.6162C50.1983 35.6647 50.2292 36.7158 50.2371 37.7685C50.2523 39.8635 51.2789 41.4763 52.6657 42.8981C53.5865 43.842 53.6661 44.3716 52.7286 45.2974C51.1332 46.8812 49.3827 48.2165 47.1329 48.7665C44.8819 49.3216 42.5083 49.0548 40.4357 48.0138C39.4892 47.5604 38.5265 47.3019 37.5309 47.7071C37.071 47.9103 36.6618 48.214 36.3331 48.596C36.0111 48.9977 35.7367 49.4357 35.5154 49.9011C35.0548 50.75 34.2981 51.2484 33.4773 51.6648C33.2122 51.7978 32.9196 51.8661 32.6233 51.8641C32.3271 51.862 32.0355 51.7897 31.7724 51.653C31.4776 51.521 31.2044 51.3451 30.9618 51.1313C29.8211 50.0656 28.445 49.7385 26.9352 49.6965C24.2186 49.5962 21.5474 48.9671 19.0698 47.8441C18.4504 47.5532 17.8641 47.1957 17.3213 46.7778C16.6911 46.3217 16.5988 45.9152 16.8344 45.1807C17.1056 44.3195 17.3992 43.4821 17.6453 42.6226C17.6638 42.5251 17.6598 42.4247 17.6338 42.329C17.6077 42.2333 17.5603 42.1449 17.495 42.0705C16.4777 41.1564 16.4698 41.1632 15.3346 41.8919C12.2675 43.8671 9.1983 45.8419 6.12697 47.816C5.39573 48.2874 5.04746 48.1891 4.61497 47.4308C4.33147 46.9348 4.052 46.4365 3.77656 45.9357C3.18563 44.8787 3.26602 44.5782 4.27115 43.9407C7.48797 41.9067 10.6834 39.8658 13.9015 37.8507C14.3035 37.5956 14.4007 37.3572 14.3108 36.8936C13.6776 33.714 14.5417 30.9795 16.8278 28.6954C16.9816 28.5764 17.0894 28.4073 17.1328 28.2171C17.1763 28.027 17.1526 27.8277 17.0658 27.6532C16.5668 26.2486 15.7792 25.1355 14.3525 24.5233C13.5227 24.1467 12.7175 23.7178 11.9416 23.2391C10.7864 22.5922 9.89092 21.5619 9.40841 20.3243C9.31335 20.0822 9.28169 19.8197 9.31644 19.5617C9.3512 19.3037 9.45121 19.059 9.60692 18.8509C10.6377 17.2552 12.2625 16.7311 13.9773 16.7337C15.3337 16.7378 16.6957 17.1374 18.0435 17.418C19.2594 17.6697 19.3451 17.666 19.9235 16.5752C20.1987 16.055 20.4163 15.4882 20.7251 14.9994C21.2758 14.1191 21.9105 13.926 22.8624 14.3348C23.2938 14.516 23.7286 14.7474 24.1486 14.9462C24.9684 15.324 25.7026 15.2084 26.3461 14.585C26.6077 14.3351 26.842 14.0578 27.045 13.7578C27.8829 12.5231 28.9904 11.4969 30.2827 10.7576C31.7264 9.85971 32.9011 8.58535 33.6818 7.07013C34.0043 6.47507 34.6284 6.37336 35.1547 6.87449C36.1787 7.85765 37.2353 8.82594 38.1708 9.8952C39.6137 11.5828 41.5324 12.7905 43.6733 13.3587C45.1679 13.7661 46.5788 14.4553 48.045 14.97C49.8289 15.5957 51.624 16.1995 53.4326 16.7561C54.4429 17.0682 54.7071 17.4125 54.4318 18.4614C53.8032 20.8525 53.1633 23.2416 52.512 25.6287C52.2313 26.6591 51.5044 27.3829 50.6757 27.9621C49.3363 28.9134 48.2845 30.2182 47.6364 31.7323ZM19.0829 43.0845C18.8621 43.7906 18.688 44.4745 18.4321 45.1261C18.2675 45.546 18.3981 45.7414 18.7452 45.9473C21.1132 47.3103 23.6962 47.8813 26.3813 48.163C27.5256 48.2847 28.6999 48.356 29.785 48.6883C30.5876 48.9346 31.287 49.5481 32.0035 50.0404C32.41 50.3202 32.7838 50.4547 33.176 50.0845C33.6071 49.6961 34.0124 49.2799 34.3896 48.8386C34.6545 48.4664 34.8964 48.0784 35.1142 47.6767C35.6541 46.8224 36.438 46.3537 37.4121 46.1269C38.6063 45.8473 39.8607 46.0113 40.9435 46.5887C43.5843 47.9246 46.236 47.8653 48.8 46.4721C49.8779 45.8886 50.796 44.9852 51.8339 44.1811C49.2935 41.8756 48.4762 39.073 48.724 35.8709C48.7321 35.4135 48.6838 34.9569 48.5801 34.5115C48.4556 33.8144 47.9893 33.425 47.3285 33.2617C47.0897 33.2022 46.8401 33.1982 46.5981 33.1537C45.8078 32.9971 45.5014 32.4304 45.8734 31.7287C46.8901 29.7991 47.9735 27.9259 49.8707 26.6837C50.2318 26.4528 50.5403 26.1477 50.7759 25.7885C51.0114 25.4292 51.1688 25.0241 51.2375 24.5995C51.4742 23.351 51.8317 22.1215 52.1618 20.8919C52.3982 20.012 52.6732 19.1464 52.9439 18.2473C52.0883 17.992 51.2364 17.7912 50.4176 17.4913C48.2143 16.6752 46.0306 15.8094 43.8326 14.9782C42.7874 14.5843 41.7022 14.2815 40.6869 13.8328C38.9215 13.0457 37.6898 11.5944 36.4238 10.1918C35.887 9.59656 35.273 9.06983 34.7665 8.58209C33.7652 9.61965 32.9772 10.7416 31.9168 11.4609C30.2571 12.5878 28.7721 13.8207 27.6019 15.4618C27.008 16.2924 26.1005 16.6368 25.0653 16.6718C24.1996 16.7016 23.4937 16.3034 22.7614 15.9491C22.0637 15.6113 22.0795 15.6271 21.7115 16.3264C21.3435 17.0257 20.9463 17.727 20.5177 18.3967C20.3427 18.6865 20.0779 18.9105 19.764 19.0344C19.45 19.1582 19.1044 19.1751 18.7801 19.0823C17.7876 18.8694 16.7939 18.6383 15.799 18.389C14.442 18.0468 13.0074 18.2086 11.7591 18.8447C10.8519 19.286 10.659 19.8764 11.3125 20.6174C11.7995 21.1706 12.3573 21.6566 12.9713 22.0626C13.7107 22.5281 14.4823 22.9399 15.2802 23.2949C16.2898 23.744 17.1328 24.5015 17.6895 25.4597C18.0248 26.0498 18.3157 26.6661 18.629 27.2724C23.4786 24.8338 27.9071 26.9763 29.9508 29.657C31.1027 31.1657 31.7438 33.0057 31.7801 34.9075C31.8164 36.8093 31.2461 38.6732 30.1526 40.2264C28.1536 43.0702 23.9809 45.1654 19.0829 43.0845ZM23.4376 42.3861C27.4778 42.1222 30.5404 38.6684 30.2798 34.6712C30.16 32.7164 29.2747 30.8892 27.8175 29.5894C26.3603 28.2897 24.4499 27.6232 22.5043 27.7359C21.536 27.7825 20.5865 28.0224 19.7111 28.4416C18.8358 28.8608 18.0522 29.4508 17.4059 30.1773C16.7596 30.9039 16.2636 31.7523 15.9469 32.6733C15.6301 33.5943 15.4988 34.5693 15.5608 35.5416C15.6227 36.5139 15.8766 37.4639 16.3076 38.3364C16.7387 39.2089 17.3382 39.9863 18.0714 40.6234C18.8045 41.2604 19.6566 41.7444 20.5779 42.047C21.4992 42.3497 22.4713 42.465 23.4376 42.3861ZM5.73574 46.2692L15.5443 39.9311L14.9626 38.9176L5.11278 45.1722L5.73574 46.2692Z" fill="#e4794a" stroke="#e4794a" stroke-width="1.47127" mask="url(#path-1-inside-1_677_1834)"/><path d="M55.8056 54.9357L55.8053 54.9356C53.9679 53.7622 53.1178 52.0475 53.3058 49.8972C53.3294 49.6381 53.4447 49.3591 53.6234 49.051C53.749 48.8346 53.8901 48.6287 54.0361 48.4157C54.1014 48.3203 54.1677 48.2235 54.2341 48.1238L54.2342 48.1235C54.8237 47.2354 55.4726 46.374 56.1353 45.5437C56.3434 45.2859 56.6122 45.0845 56.9172 44.9578L56.9172 44.9579L56.923 44.9553C56.9599 44.9393 57 44.9321 57.04 44.9343C57.0801 44.9366 57.1192 44.9482 57.1542 44.9684L57.3381 44.6496L57.1542 44.9684C57.1892 44.9885 57.2192 45.0168 57.2417 45.0509C57.2643 45.0851 57.2786 45.1242 57.2835 45.1651L57.2856 45.1826L57.2894 45.1999C57.6104 46.6687 57.9003 48.1378 58.1967 49.6402C58.2648 49.9854 58.3332 50.3324 58.4025 50.6815C58.3661 51.0327 58.3381 51.3785 58.3105 51.7205C58.2462 52.5158 58.1835 53.291 58.0196 54.0677C58.0039 54.1413 57.9855 54.2112 57.9646 54.2774L57.2274 53.9288C57.2588 53.8551 57.2859 53.7789 57.3096 53.7024C57.3862 53.4552 57.4388 53.1657 57.4739 52.8556C57.5443 52.235 57.5488 51.4924 57.5128 50.7585C57.4768 50.0228 57.3995 49.2844 57.3024 48.6685C57.2079 48.0695 57.0879 47.5396 56.9499 47.2536L56.7354 46.8089L56.3706 47.1425C56.2548 47.2485 56.1361 47.3593 56.0145 47.4728C55.7638 47.7069 55.5007 47.9526 55.2238 48.1917C54.6795 48.6593 54.3018 49.1965 54.1288 49.809C53.9559 50.4209 53.997 51.0746 54.2336 51.7594C54.4146 52.3383 54.7129 52.8734 55.1098 53.331C55.3952 53.66 55.7272 53.9438 56.0944 54.1737L55.7471 54.522L56.7235 54.4551L56.7277 54.4549L57.9319 54.3724C57.7731 54.799 57.5043 55.0583 57.2051 55.1753C56.8363 55.3195 56.3419 55.2789 55.8056 54.9357Z" fill="#e4794a" stroke="#e4794a" stroke-width="0.735634"/><path d="M32.0098 27.4033C31.8698 27.2844 31.5731 27.1425 31.4612 26.9121C31.1579 26.3001 30.8869 25.6725 30.6493 25.0318C30.3973 24.4023 29.9882 24.0238 29.3023 23.9844C29.1123 23.9917 28.9234 23.9526 28.7517 23.8704C28.5172 23.7179 28.2081 23.5158 28.1586 23.2791C28.1439 23.1349 28.1632 22.9893 28.2149 22.854C28.2666 22.7187 28.3493 22.5976 28.4562 22.5003C29.5039 21.7777 29.8084 20.7899 29.7264 19.5716C29.7065 19.276 29.9189 18.7875 30.1499 18.7C30.4334 18.5837 30.8707 18.7286 31.1946 18.8687C31.3888 18.9523 31.5044 19.2372 31.6316 19.4454C32.1339 20.2747 32.7479 20.9278 33.7881 21.0293C34.2101 21.07 34.6257 21.2037 34.763 21.6872C34.9004 22.1708 34.6307 22.4926 34.3129 22.7861C33.2433 23.7735 32.6731 24.9564 32.828 26.4478C32.8683 26.9232 32.6691 27.2634 32.0098 27.4033ZM30.4794 22.663L30.6854 22.453L31.8104 23.5978L32.5667 22.3769L31.0835 21.3304C30.8875 21.782 30.6846 22.2235 30.4795 22.6651L30.4794 22.663Z" fill="white"/><path d="M35.3139 40.5875C35.3348 40.8978 35.3563 41.2165 35.3777 41.5352C35.4082 41.9882 35.3326 42.3915 34.814 42.5028C34.3801 42.5957 34.023 42.3042 33.8949 41.7716C33.8565 41.6057 33.8531 41.4311 33.8311 41.2599C33.8091 41.0886 33.7922 40.9613 33.7682 40.7923C33.2267 40.6882 32.6052 40.6718 32.5854 39.9106C32.5739 39.4901 32.8465 39.305 33.5825 39.1535C33.56 38.818 33.5204 38.4794 33.5144 38.1407C33.5097 37.5722 33.777 37.2148 34.2023 37.1815C34.6277 37.1481 34.9354 37.4536 35.0143 38.0338C35.0584 38.3467 35.0566 38.6628 35.0807 39.0214C35.6566 38.982 36.1913 38.8927 36.3436 39.5669C36.4511 40.0125 36.158 40.2979 35.3139 40.5875Z" fill="white"/><path d="M21.4362 21.894C21.9395 21.8975 22.3991 21.9376 22.4815 22.5071C22.5739 23.1327 22.0685 23.2853 21.6171 23.4615C21.6054 23.6919 21.6696 23.9614 21.5678 24.1305C21.4188 24.3767 21.1636 24.6954 20.9321 24.7133C20.7847 24.6985 20.6431 24.6475 20.5199 24.5649C20.3966 24.4822 20.2955 24.3704 20.2253 24.2393C20.0438 23.8157 19.9873 23.413 19.4798 23.1592C19.0311 22.9392 19.1104 22.3418 19.5218 22.0082C19.6613 21.8997 19.8457 21.7754 19.8794 21.6214C19.9716 21.217 20.1775 20.9438 20.5923 20.9406C21.0443 20.9286 21.2544 21.2471 21.3591 21.6507C21.3761 21.7169 21.4017 21.7868 21.4362 21.894Z" fill="white"/><path d="M25.7339 38.1494L25.5118 38.0538L23.9878 37.3977L23.6345 37.2455L23.8028 36.8992C24.223 36.035 24.0136 35.2562 23.5068 34.3769L25.7339 38.1494ZM25.7339 38.1494L25.9099 37.9831M25.7339 38.1494L25.9099 37.9831M25.9099 37.9831C28.053 35.958 27.6901 32.4635 25.1777 31.0098L25.9099 37.9831ZM24.2421 30.9358L24.2421 30.9358C24.3489 30.8623 24.4644 30.8442 24.5434 30.8403C24.6273 30.8362 24.7094 30.8464 24.7803 30.8608C24.9203 30.8893 25.0655 30.9447 25.1776 31.0097L24.2421 30.9358ZM24.2421 30.9358L24.2401 30.9372M24.2421 30.9358L24.2401 30.9372M24.2401 30.9372C23.7609 31.2718 23.4531 31.907 23.3201 32.5212M24.2401 30.9372L23.3201 32.5212M23.3201 32.5212C23.1867 33.1377 23.2036 33.8514 23.5067 34.3768L23.3201 32.5212ZM23.0591 40.1014L23.0591 40.1013L23.0499 40.1021C22.3684 40.1591 21.6825 40.0799 21.0317 39.8689C20.381 39.6578 19.7782 39.3192 19.2584 38.8724C18.7385 38.4257 18.3119 37.8796 18.0032 37.2658C17.6946 36.6521 17.5101 35.9827 17.4603 35.2966L17.4603 35.2965C17.2504 32.4087 19.5441 29.8094 22.5065 29.6066C25.4646 29.4041 27.8677 31.4988 28.0702 34.4116C28.1146 35.1162 28.0201 35.8228 27.792 36.4907C27.5638 37.1589 27.2066 37.7751 26.7408 38.3039C26.275 38.8327 25.7099 39.2637 25.0781 39.5721C24.4462 39.8806 23.7601 40.0605 23.0591 40.1014ZM23.9612 38.251C23.9505 38.2473 23.9397 38.2436 23.9291 38.2399C23.7969 38.1945 23.6718 38.1514 23.5454 38.1032C23.2053 37.9729 23.0039 37.7713 22.9151 37.5596C22.8289 37.3541 22.8275 37.0893 22.9832 36.7792C23.1516 36.4926 23.2326 36.1628 23.2164 35.8306C23.2 35.4964 23.0859 35.1745 22.8883 34.9051C22.5891 34.4641 22.4159 33.9488 22.3879 33.4153C22.3597 32.8796 22.479 32.3466 22.7324 31.8747L22.7326 31.8747L22.7378 31.8643C22.8467 31.6451 22.9491 31.418 23.0581 31.1762C23.1023 31.0783 23.1475 30.9779 23.1948 30.8747L23.436 30.3474L22.8564 30.3542C21.7919 30.3667 20.7629 30.7392 19.935 31.4108C19.7356 31.5393 19.5844 31.7309 19.5054 31.9551C19.4256 32.1818 19.4243 32.4286 19.5012 32.6557C19.6015 33.0536 19.7317 33.4432 19.8905 33.8213L19.8952 33.8325L19.9006 33.8433C20.5091 35.0609 20.4616 36.3277 20.0864 37.6368C20.0145 37.8854 19.9917 38.1472 20.1124 38.3899C20.23 38.6262 20.4455 38.7653 20.6559 38.8634L20.6565 38.8637C21.7133 39.3545 22.8172 39.5094 23.9887 39.04L24.387 39.1796L24.3495 38.6228L24.3493 38.6186L24.314 38.0951L23.9612 38.251ZM19.11 34.067L18.7841 34.1721L18.7448 33.9013L18.5019 33.9369L18.1413 33.9898L18.1904 34.3509L18.514 36.7302L18.5633 37.0933L18.9267 37.0448L19.1531 37.0145L19.3869 36.9833L19.4563 36.7577C19.594 36.3104 19.6343 35.8386 19.5745 35.3744C19.5148 34.9102 19.3564 34.4643 19.11 34.067Z" fill="#e4794a" stroke="#e4794a" stroke-width="0.735634"/><path d="M25.6571 37.7115L24.1331 37.0554C24.6319 36.027 24.3565 35.1105 23.8249 34.1884C23.3498 33.3573 23.7072 31.7529 24.4499 31.2344C24.56 31.1574 24.8398 31.2351 24.9925 31.3237C27.2847 32.6497 27.6341 35.8488 25.6571 37.7115Z" fill="#F2F7FF"/><path d="M18.7969 34.2611C19.0149 34.6133 19.1551 35.0084 19.2081 35.4198C19.2611 35.8312 19.2256 36.2492 19.104 36.6457L18.8776 36.676L18.554 34.2967L18.7969 34.2611Z" fill="#F2F7FF"/></svg>\n')},null,8,ls),dt("div",cs,[dt("p",us,pt(rt(n)("Explore data in detail")),1),dt("p",ds,pt(rt(n)("Use our tool to get an overview of data, learn about different columns or perform filters and sorts.")),1)]),dt("p",ps,[dt("a",{href:e.resource.preview_url,class:"fr-btn",target:"_blank"},pt(rt(n)("Explore data")),9,hs)])])]),dt("div",fs,[dt("table",ms,[dt("caption",gs,pt(rt(n)("Preview of {name}",{name:e.resource.title})),1),dt("thead",null,[dt("tr",null,[(Ze(!0),Qe(Mt,null,Pt(o.value,e=>(Ze(),Qe("th",vs,[dt("div",ys,[dt("button",{class:lt(["fr-btn fr-btn--sm fr-btn--tertiary-no-outline fr-my-n1w",{"fr-btn--secondary-grey-500":!d(e),"fr-btn--icon-right":d(e),"fr-icon-arrow-down-line":d(e)&&s.value&&"desc"==s.value.type,"fr-icon-arrow-up-line":d(e)&&s.value&&"asc"==s.value.type}]),onClick:t=>function(e){s.value&&s.value.column==e?"asc"==s.value.type?s.value.type="desc":s.value.type="asc":s.value?(s.value.column=e,s.value.type="asc"):s.value={column:e,type:"asc"},u.value=1,p(u.value,s.value)}(e)},[Tt(pt(e)+" ",1),dt("span",bs,pt(s.value&&"desc"==s.value.type?rt(n)("Sort ascending"):rt(n)("Sort descending")),1)],10,ws)])]))),256))])]),dt("tbody",null,[(Ze(!0),Qe(Mt,null,Pt(r.value,e=>(Ze(),Qe("tr",null,[(Ze(!0),Qe(Mt,null,Pt(o.value,t=>(Ze(),Qe("td",ks,[dt("div",xs,[dt("div",Cs,pt(e[t]),1)])]))),256))]))),256))])])]),ut(rt(Pa),{class:"fr-mt-3w",page:u.value,pageSize:rt(c),totalResults:l.value,onChange:h},null,8,["page","pageSize","totalResults"]),dt("div",Ss,pt(rt(n)("Preview updated on {date}",{date:rt(f)}))+"  "+pt(rt(n)("{count} columns",o.value.length))+"  "+pt(rt(n)("{count} rows",l.value)),1)],64))]))}}),Ts=An(Ms,[["__scopeId","data-v-90a6d6fe"]]),Os=["href"],_s=Ye({__name:"EditButton",props:{datasetId:{},isCommunityResource:{type:Boolean,default:!1},resource:{}},setup(e){const t=e,{t:n}=H(),r=Xe(()=>_.new_admin?"owner"in t.resource&&t.resource.owner?`${_.admin_root}users/${t.resource.owner.id}/community-resources/?resource_id=${t.resource.id}`:"organization"in t.resource&&t.resource.organization?`${_.admin_root}organization/${t.resource.organization.id}/community-resources/?resource_id=${t.resource.id}`:`${_.admin_root}datasets/${t.datasetId}/files/?resource_id=${t.resource.id}`:`${_.admin_root}dataset/${t.datasetId}/${t.isCommunityResource?"community-resource":"resource"}/${t.resource.id}`);return(e,t)=>(Ze(),Qe("a",{href:r.value,class:"fr-btn fr-btn--secondary fr-btn--secondary-warning-425 fr-icon-pencil-line fr-icon--sm","data-testid":"edit-button"},pt(rt(n)("Edit file")),9,Os))}});function Ns(e){var t;switch(null===(t=e.format)||void 0===t||null===(t=t.trim())||void 0===t?void 0:t.toLowerCase()){case"txt":case"pdf":case"rtf":case"odt":case"doc":case"docx":case"epub":return"/_themes/gouvfr/assets/documentation.svg";case"json":case"sql":case"xml":case"xsd":case"shp":case"kml":case"kmz":case"gpx":case"shx":case"ovr":case"gpkg":case"grib2":case"dbf":case"prj":case"sqlite":case"db":case"sbn":case"sbx":case"cpg":case"lyr":case"owl":case"dxf":case"ics":case"rdf":case"ttl":case"n3":return"/_themes/gouvfr/assets/code.svg";case"tar":case"gz":case"tgz":case"rar":case"zip":case"7z":case"xz":case"bz2":return"/_themes/gouvfr/assets/archive.svg";case"url":return"/_themes/gouvfr/assets/link2.svg";case"csv":case"ods":case"xls":case"xlsx":case"parquet":case"csv.gz":return"/_themes/gouvfr/assets/table.svg";case"geojson":return"/_themes/gouvfr/assets/map.svg";case"ogc:wfs":case"ogc:wms":case"wfs":case"wms":return"/_themes/gouvfr/assets/globe.svg";default:return null}}function Es(e){return"resource-"+e.id+"-title"}const Ds={class:"fr-icon-svg flex items-center"},As=["src"],$s=Ye({__name:"ResourceIcon",props:{resource:{}},setup(e){const t=e,n=Xe(()=>Ns(t.resource)||"/_themes/gouvfr/assets/file.svg");return(e,t)=>(Ze(),Qe("div",Ds,[dt("img",{src:n.value,alt:""},null,8,As)]))}}),Rs={key:0,class:"inline-flex fr-mb-0 align-items-baseline fr-text--xs"},Ls={class:"flex justify-between border-bottom"},Is={class:"fr-text--sm fr-my-0 fr-p-2v"},Ps=["onClick","title"],zs={class:"fr-p-3v"},Bs={key:0},Fs={key:1},js={key:2},Vs={key:3,class:"text-default-warning flex items-center fr-mt-4v"},qs={key:4,class:"text-default-warning flex items-center fr-mt-4v"},Hs={key:5,class:"text-default-warning flex items-center fr-mt-4v"},Us={key:6,class:"w-100 text-align-right fr-mt-5v",target:"_blank"},Ws=["href"],Ks={class:"fr-mr-1v text-grey-380"},Ys={class:"flex items-center bg-error-950 rounded-sm"},Js={class:"fr-tag fr-tag--sm"},Gs={key:0,class:"flex items-center padding-sm"},Xs={key:1,class:"flex items-center text-warning-425 padding-sm"},Zs=Ye({__name:"SchemaBadge",props:{resource:{}},setup(e){const t=e,{t:n}=H(),r=ct(null);mt(async()=>{r.value=await hn()});const o=Xe(()=>r.value?function(e,t){return e.find(e=>(null==t?void 0:t.name)===e.name)||null}(r.value,t.resource.schema):null),i=Xe(()=>o.value?function(e,t){if(!e.schema||!e.schema.name)return null;let n={schema_name:`schema-datagouvfr.${e.schema.name}`};if(e.schema&&e.schema.version){var r;const o=e.schema.version,i=null===(r=t.versions.find(e=>e.version_name===o))||void 0===r?void 0:r.schema_url;i&&(n={schema_url:i})}const o=new URLSearchParams(M({input:"url",url:e.url,"header-case":"on"},n)).toString();return`${_.schema_validata_url}/table-schema?${o}`}(t.resource,o.value):null),a=Xe(()=>{return o.value?(e=o.value.name,`${_.schema_documentation_url}${e}/`):null;var e}),s=Xe(()=>t.resource.schema?t.resource.schema.name||t.resource.schema.url:null),l=Xe(()=>t.resource.extras["validation-report:errors"]||[]),c=Xe(()=>l.value.filter(e=>[""].includes(e.code))),u=Xe(()=>l.value.filter(e=>["#body","#cell","#content","#row","#table"].some(t=>e.tags.includes(t)))),d=Xe(()=>l.value.filter(e=>["#head","#structure","#header"].some(t=>e.tags.includes(t)))),p=Xe(()=>0===l.value.length?"ok":l.value.length===c.value.length?"warnings":"ko");return(e,t)=>s.value?(Ze(),Qe("span",Rs,[ut(xi,{position:"right",noMargin:"",class:"relative z-2"},{toggletip:it(({close:r})=>[dt("div",Ls,[dt("h5",Is,pt(e.$t("Data schema")),1),dt("button",{type:"button",onClick:r,title:rt(n)("Close"),class:"border-left close-button flex items-center justify-center"},"",8,Ps)]),dt("div",zs,["ok"===p.value?(Ze(),Qe("div",Bs,[Tt(pt(rt(n)("This file is valid for the shema:"))+" ",1),(Ze(),nt(It(a.value?"a":"span"),{href:a.value,class:"fr-link fr-text--sm"},{default:it(()=>[Tt(pt(s.value),1)]),_:1},8,["href"])),t[0]||(t[0]=Tt(". ",-1))])):st("",!0),"warnings"===p.value?(Ze(),Qe("div",Fs,[Tt(pt(rt(n)("This file is valid for the shema:"))+" ",1),(Ze(),nt(It(a.value?"a":"span"),{href:a.value,class:"fr-link fr-text--sm"},{default:it(()=>[Tt(pt(s.value),1)]),_:1},8,["href"])),Tt(". "+pt(rt(n)("But its compliance could be improved.")),1)])):st("",!0),"ko"===p.value?(Ze(),Qe("div",js,[Tt(pt(rt(n)("This file indicates to follow the schema:"))+" ",1),(Ze(),nt(It(a.value?"a":"span"),{href:a.value,class:"fr-link fr-text--sm"},{default:it(()=>[Tt(pt(s.value),1)]),_:1},8,["href"])),Tt(". "+pt(rt(n)("But is not compliant.")),1)])):st("",!0),c.value.length?(Ze(),Qe("div",Vs,[t[1]||(t[1]=dt("span",{class:"fr-icon-alert-line fr-icon--sm fr-mr-1v"},null,-1)),dt("span",null,pt(c.value.length)+" "+pt(rt(n)("advices")),1)])):st("",!0),d.value.length?(Ze(),Qe("div",qs,[t[2]||(t[2]=dt("span",{class:"fr-icon-alert-line fr-icon--sm fr-mr-1v"},null,-1)),dt("span",null,pt(d.value.length)+" "+pt(rt(n)("structure errors")),1)])):st("",!0),u.value.length?(Ze(),Qe("div",Hs,[t[3]||(t[3]=dt("span",{class:"fr-icon-alert-line fr-icon--sm fr-mr-1v"},null,-1)),dt("span",null,pt(u.value.length)+" "+pt(rt(n)("body errors")),1)])):st("",!0),i.value?(Ze(),Qe("div",Us,[dt("a",{href:i.value},pt(rt(n)("See validation report")),9,Ws)])):st("",!0)])]),_:1}),dt("span",Ks,pt(rt(n)("Schema:")),1),dt("span",Ys,[dt("span",Js,pt(s.value),1),"warnings"===p.value?(Ze(),Qe("span",Gs,[t[4]||(t[4]=dt("span",{class:"fr-icon-alert-line fr-icon--sm fr-mr-1v"},null,-1)),dt("span",null,pt(rt(n)("Invalid")),1)])):st("",!0),"ko"===p.value?(Ze(),Qe("span",Xs,[t[5]||(t[5]=dt("span",{class:"fr-icon-error-line fr-icon--sm fr-mr-1v"},null,-1)),dt("span",null,pt(rt(n)("Invalid")),1)])):st("",!0)])])):st("",!0)}}),Qs=An(Zs,[["__scopeId","data-v-bf96ce2f"]]),el={class:"fr-text--sm fr-ml-0 fr-mt-0 fr-mb-2w text-mention-grey h-4w fr-grid-row fr-grid-row--middle"},tl={key:0,class:"text-overflow-ellipsis"},nl=Ye({__name:"DescriptionDetails",props:{withEllipsis:{type:Boolean,default:!0}},setup:e=>(t,n)=>(Ze(),Qe("dd",el,[e.withEllipsis?(Ze(),Qe("div",tl,[tt(t.$slots,"default")])):tt(t.$slots,"default",{key:1})]))}),rl={class:"fr-my-0"};const ol=An({},[["render",function(e,t){return Ze(),Qe("dl",rl,[tt(e.$slots,"default")])}]]),il={class:"fr-text--sm fr-my-0 fr-text--bold"};const al=An({},[["render",function(e,t){return Ze(),Qe("dt",il,[tt(e.$slots,"default")])}]]),sl={class:"flex gap-3rem flex-col-on-small"},ll={class:"code"},cl=["href"],ul={class:"code"},dl=["href"],pl={class:"code"},hl={class:"code"},fl={class:"code text-overflow-ellipsis"},ml=Ye({__name:"Metadata",props:{resource:{}},setup(e){const t=e,n=Xe(()=>Object.keys(t.resource.extras).length),r=Xe(()=>Es(t.resource)),{t:o}=H();return(t,i)=>(Ze(),Qe("div",null,[dt("div",sl,[ut(ol,{class:"flex-1"},{default:it(()=>[ut(al,null,{default:it(()=>[Tt(pt(rt(o)("URL"))+" ",1),ut($n,{label:t.$t("Copy URL"),"copied-label":t.$t("URL copied!"),text:e.resource.url,"aria-describedby":r.value},null,8,["label","copied-label","text","aria-describedby"])]),_:1}),ut(nl,{"with-ellipsis":!1},{default:it(()=>[dt("code",ll,[dt("a",{href:e.resource.url,target:"_blank",rel:"ugc nofollow noopener",download:""},[ut(rt(D),{"max-lines":1,autoresize:!0,text:e.resource.url},null,8,["text"])],8,cl)])]),_:1}),ut(al,null,{default:it(()=>[Tt(pt(rt(o)("Stable URL"))+" ",1),ut($n,{label:t.$t("Copy stable URL"),"copied-label":t.$t("Stable URL copied!"),text:e.resource.latest,"aria-describedby":r.value},null,8,["label","copied-label","text","aria-describedby"])]),_:1}),ut(nl,{"with-ellipsis":!1},{default:it(()=>[dt("code",ul,[dt("a",{href:e.resource.latest,target:"_blank",rel:"ugc nofollow noopener",download:""},[ut(rt(D),{"max-lines":1,autoresize:!0,text:e.resource.latest},null,8,["text"])],8,dl)])]),_:1}),ut(al,null,{default:it(()=>[Tt(pt(rt(o)("Identifier"))+" ",1),ut($n,{label:t.$t("Copy ID"),"copied-label":t.$t("ID copied!"),text:e.resource.id,"aria-describedby":r.value},null,8,["label","copied-label","text","aria-describedby"])]),_:1}),ut(nl,{"with-ellipsis":!1},{default:it(()=>[dt("code",pl,[ut(rt(D),{"max-lines":1,autoresize:!0,text:e.resource.id},null,8,["text"])])]),_:1}),e.resource.checksum?(Ze(),Qe(Mt,{key:0},[ut(al,null,{default:it(()=>[Tt(pt(e.resource.checksum.type)+" ",1),ut($n,{label:t.$t("Copy checksum"),"copied-label":t.$t("Checksum copied!"),text:e.resource.checksum.value,"aria-describedby":r.value},null,8,["label","copied-label","text","aria-describedby"])]),_:1}),ut(nl,{"with-ellipsis":!1},{default:it(()=>[dt("code",hl,[ut(rt(D),{"max-lines":1,autoresize:!0,text:e.resource.checksum.value},null,8,["text"])])]),_:1})],64)):st("",!0)]),_:1}),ut(ol,{style:{"flex-shrink":"0"}},{default:it(()=>[ut(al,null,{default:it(()=>[Tt(pt(rt(o)("Created on")),1)]),_:1}),ut(nl,null,{default:it(()=>[Tt(pt(rt(Z)(e.resource.created_at)),1)]),_:1}),ut(al,null,{default:it(()=>[Tt(pt(rt(o)("Modified on")),1)]),_:1}),ut(nl,null,{default:it(()=>[Tt(pt(rt(Z)(e.resource.last_modified)),1)]),_:1})]),_:1}),ut(ol,{style:{"flex-shrink":"0"}},{default:it(()=>[e.resource.filesize?(Ze(),Qe(Mt,{key:0},[ut(al,null,{default:it(()=>[Tt(pt(rt(o)("Size")),1)]),_:1}),ut(nl,null,{default:it(()=>[Tt(pt(rt(Q)(e.resource.filesize)),1)]),_:1})],64)):st("",!0),e.resource.mime?(Ze(),Qe(Mt,{key:1},[ut(al,null,{default:it(()=>[Tt(pt(rt(o)("Type")),1)]),_:1}),ut(nl,null,{default:it(()=>[Tt(pt(rt(ee)(e.resource.type)),1)]),_:1})],64)):st("",!0),e.resource.mime?(Ze(),Qe(Mt,{key:2},[ut(al,null,{default:it(()=>[Tt(pt(rt(o)("MIME Type")),1)]),_:1}),ut(nl,null,{default:it(()=>[dt("code",fl,pt(e.resource.mime),1)]),_:1})],64)):st("",!0)]),_:1})]),dt("div",null,[n.value?(Ze(),nt(Ca,{key:0,class:"fr-pt-3w fr-mt-3w border-top border-default-grey","button-text":rt(o)("See extras"),"title-text":rt(o)("Resource Extras"),"title-level":"h5",extra:e.resource.extras},null,8,["button-text","title-text","extra"])):st("",!0)])]))}}),gl=An(ml,[["__scopeId","data-v-9c694f12"]]),vl=Ye({__name:"TabGroup",props:{size:{default:"md"}},setup:e=>(t,n)=>(Ze(),nt(rt(mi),{as:"div",class:lt({"tabs-sm":"sm"===e.size})},{default:it(()=>[tt(t.$slots,"default")]),_:3},8,["class"]))}),yl=An(Ye({__name:"TabList",setup:e=>(e,t)=>(Ze(),nt(rt(gi),{class:"fr-segmented__elements"},{default:it(()=>[tt(e.$slots,"default",{},void 0,!0)]),_:3}))}),[["__scopeId","data-v-999cc2d0"]]),wl={class:"inner"},bl=An(Ye({__name:"Tab",setup:e=>(e,t)=>(Ze(),nt(rt(vi),{as:"template"},{default:it(({selected:t})=>[dt("button",{class:lt(["fr-segmented__element",{selected:t}])},[dt("div",wl,[tt(e.$slots,"default",{},void 0,!0)])],2)]),_:3}))}),[["__scopeId","data-v-80aca752"]]),kl=Ye({__name:"TabPanels",setup:e=>(e,t)=>(Ze(),nt(rt(yi),null,{default:it(()=>[tt(e.$slots,"default")]),_:3}))}),xl=Ye({__name:"TabPanel",setup:e=>(e,t)=>(Ze(),nt(rt(wi),null,{default:it(()=>[tt(e.$slots,"default")]),_:3}))});function Cl(e){var t;null===(t=globalThis._paq)||void 0===t||t.push(["trackEvent",...e])}const Sl={class:"flex items-center fr-mb-1v"},Ml=["id"],Tl=["aria-expanded"],Ol={class:"text-grey-380 subheaders-infos"},_l={class:"fr-text--xs fr-mb-0 dash-after"},Nl={key:0,class:"fr-text--xs fr-mb-0 dash-after"},El={class:"hidden show-on-small"},Dl={key:0},Al=["aria-label"],$l={class:"hidden show-on-small"},Rl={key:0,class:"fr-mb-0 fr-mt-1v fr-text--xs text-grey-380"},Ll=["href"],Il={class:"flex items-center fr-ml-4v buttons"},Pl={key:0,class:"fr-col-auto fr-ml-3v fr-m-0 z-2"},zl=["href","title","aria-describedby"],Bl={key:1,class:"fr-col-auto fr-ml-3v fr-m-0 z-2"},Fl=["id","data-clipboard-text","aria-describedby"],jl={key:2,class:"fr-col-auto fr-ml-3v fr-m-0"},Vl=["href","title","aria-describedby"],ql={class:"fr-sr-only"},Hl={key:3,class:"fr-col-auto fr-ml-3v fr-m-0 z-2"},Ul=["aria-labelledby"],Wl={class:"fr-pl-4v fr-pr-4v fr-pb-4v"},Kl={key:0},Yl={key:1,class:"fr-pl-4v fr-pr-4v"},Jl=["innerHTML"],Gl={key:2,class:"fr-pl-4v fr-pr-4v"},Xl={key:3,class:"fr-pl-4v fr-pr-4v"},Zl={key:4,class:"fr-pl-4v fr-pr-4v"},Ql={class:"fr-pl-0"},ec={key:0,class:"font-bold fr-text--sm fr-mb-0"},tc={key:1,class:"font-bold fr-text--sm fr-mb-0"},nc={class:"fr-text--sm fr-ml-0 fr-mt-0 fr-mb-2w text-mention-grey h-4w fr-grid-row fr-grid-row--middle"},rc={key:0},oc=["href"],ic={key:1},ac=["href"],sc={key:0},lc={class:"font-bold fr-text--sm fr-mb-0"},cc={class:"fr-text--sm fr-ml-0 fr-mt-0 fr-mb-2w text-mention-grey h-4w fr-grid-row fr-grid-row--middle"},uc=["href"],dc={key:0},pc={key:5,class:"fr-pl-4v fr-pr-4v"},hc=Ye({__name:"ResourceAccordion",props:{datasetId:{},expandedOnMount:{type:Boolean,default:!1},isCommunityResource:{type:Boolean,default:!1},resource:{},canEdit:{type:Boolean,default:!1}},setup(e){A(Tn,Sn);const t=["ogc:wfs","ogc:wms","wfs","wms"],n=e,r=Bt(()=>U(()=>S.import("./Swagger-legacy.6.2.4.js"),void 0)),{t:o}=H(),i=Xe(()=>_.tabular_api_url&&n.resource.extras["analysis:parsing:finished_at"]&&!n.resource.extras["analysis:parsing:error"]&&(_.tabular_allow_remote||"file"===n.resource.filetype)),a=Xe(()=>Ns(n.resource)?n.resource.format:o("File")),s=Xe(()=>t.includes(n.resource.format)),l=ct(n.expandedOnMount),c=()=>{l.value=!l.value,l.value?Cl(["Open resource",n.resource.id]):Cl(["Close resource",n.resource.id])},u=Xe(()=>{let e=[];return i.value&&e.push({key:"data",label:o("Data")}),n.resource.description&&e.push({key:"description",label:o("Description")}),i.value&&e.push({key:"data-structure",label:o("Data structure")}),e.push({key:"metadata",label:o("Metadata")}),e.push({key:"downloads",label:o("Downloads")}),i.value&&e.push({key:"swagger",label:o("Swagger")}),e}),d=e=>{const t=u.value[e];Cl(["View resource tab",n.resource.id,t.label]),"data"===t.key&&Cl(["Show preview",n.resource.id]),"data-structure"===t.key&&Cl(["Show data structure",n.resource.id])},p=Xe(()=>n.isCommunityResource?n.resource:null),h=$i(p.value),f=n.resource.last_modified,m=n.resource.extras&&"check:available"in n.resource.extras&&!1===n.resource.extras["check:available"],g=m?o("The {certifier} robot failed to access this file - Download file as {format}",{certifier:_.title,format:a.value}):o("Download file as {format}",{format:a.value}),v=Xe(()=>`${window.location.origin}${window.location.pathname}#/${n.isCommunityResource?"community-resources":"resources"}/${n.resource.id}`),y="resource-"+n.resource.id,w="resource-"+n.resource.id+"-header",b=Es(n.resource);return(t,k)=>(Ze(),Qe("div",{class:lt(["border border-default-grey",{"fr-pb-4v":l.value}])},[dt("header",{class:"fr-p-4v flex items-center justify-between relative",id:w},[dt("div",null,[dt("div",Sl,[dt("h4",{class:"fr-m-0",id:rt(b)},[dt("button",{type:"button",onClick:c,class:"fr-p-0 flex items-center","data-testid":"expand-button","aria-expanded":l.value},[ut($s,{resource:e.resource,class:"fr-icon--xs fr-mr-1v"},null,8,["resource"]),dt("span",{class:lt({"font-bold":l.value})},[ut(rt(D),{"max-lines":1,text:e.resource.title||rt(o)("Nameless file")},null,8,["text"])],2),k[0]||(k[0]=dt("span",{class:"absolute inset-0 z-1"},null,-1))],8,Tl)],8,Ml),ut($n,{label:t.$t("Copy link"),"copied-label":t.$t("Link copied!"),text:v.value,class:"z-2"},null,8,["label","copied-label","text"])]),dt("div",Ol,[ut(Qs,{resource:e.resource,class:"dash-after"},null,8,["resource"]),dt("span",_l,pt(rt(o)("Updated {date}",{date:rt(K)(rt(f))})),1),e.resource.format?(Ze(),Qe("span",Nl,[dt("span",El,pt(rt(o)("Format")),1),Tt(" "+pt(e.resource.format.trim().toLowerCase())+" ",1),e.resource.filesize?(Ze(),Qe("span",Dl,"("+pt(rt(Q)(e.resource.filesize))+")",1)):st("",!0)])):st("",!0),dt("span",{class:"inline-flex items-center fr-text--xs fr-mb-0","aria-label":rt(o)("{n} downloads",e.resource.metrics.views)},[k[1]||(k[1]=dt("span",{class:"fr-icon-download-line fr-icon--xs fr-mr-1v"},null,-1)),dt("span",null,[Tt(pt(rt(Y)(e.resource.metrics.views))+" ",1),dt("span",$l,pt(rt(o)("downloads")),1)])],8,Al)]),p.value?(Ze(),Qe("p",Rl,[Tt(pt(rt(o)("From"))+" ",1),p.value.organization?(Ze(),Qe("a",{key:0,class:"fr-link fr-text--xs",href:p.value.organization.page},[ut(zr,{organization:p.value.organization},null,8,["organization"])],8,Ll)):rt(h)?(Ze(),Qe(Mt,{key:1},[Tt(pt(rt(h)),1)],64)):st("",!0)])):st("",!0)]),dt("div",Il,["url"===e.resource.format?(Ze(),Qe("p",Pl,[dt("a",{href:e.resource.latest,title:rt(o)("File link - opens a new window"),"aria-describedby":rt(b),rel:"ugc nofollow noopener",target:"_blank",class:"fr-btn fr-btn--sm"},pt(t.$t("Visit")),9,zl)])):s.value?(Ze(),Qe("p",Bl,[dt("button",{id:e.resource.id+"-copy","data-clipboard-text":e.resource.url,"aria-describedby":rt(b),class:"fr-btn fr-btn--sm"},[dt("span",null,[ut(rt($),{height:16,width:16,name:"ri-file-copy-line",class:"copy-icon fr-mr-2v"})]),Tt(" "+pt(rt(o)("Copy link")),1)],8,Fl)])):(Ze(),Qe("p",jl,[dt("a",{href:e.resource.latest,rel:"ugc nofollow noopener",title:rt(g),target:"_blank",download:"",class:"relative text-transform-uppercase fr-btn fr-btn--sm matomo_download z-2 fr-link--no-after","aria-describedby":rt(b)},[rt(m)?(Ze(),nt(rt($),{key:0,height:16,width:16,name:"ri-file-warning-line",class:"fr-mr-2v"})):(Ze(),nt(rt($),{key:1,height:16,width:16,name:"ri-download-line",class:"fr-mr-2v"})),dt("span",ql,pt(rt(o)("Download file as ")),1),Tt(pt(a.value),1)],8,Vl)])),e.canEdit?(Ze(),Qe("p",Hl,[ut(_s,{"dataset-id":e.datasetId,resource:e.resource,"is-community-resource":e.isCommunityResource},null,8,["dataset-id","resource","is-community-resource"])])):st("",!0),dt("div",{class:lt(["fr-icon--sm fr-ml-4v",{"fr-icon-arrow-up-s-line":l.value,"fr-icon-arrow-down-s-line":!l.value}])},null,2)])]),l.value?(Ze(),Qe("section",{key:0,"aria-labelledby":rt(b),id:y},[ut(vl,{size:"sm",onChange:d},{default:it(()=>[dt("div",Wl,[ut(yl,{style:{"max-width":"100%","overflow-y":"auto"}},{default:it(()=>[(Ze(!0),Qe(Mt,null,Pt(u.value,e=>(Ze(),nt(bl,{key:e.key},{default:it(()=>[Tt(pt(e.label),1)]),_:2},1024))),128))]),_:1})]),ut(kl,null,{default:it(()=>[(Ze(!0),Qe(Mt,null,Pt(u.value,a=>(Ze(),nt(xl,{key:a.key},{default:it(()=>["data"===a.key?(Ze(),Qe("div",Kl,[ut(Ts,{resource:e.resource},null,8,["resource"])])):st("",!0),"description"===a.key?(Ze(),Qe("div",Yl,[dt("div",{class:"fr-mt-0 markdown fr-text--sm text-mention-grey",innerHTML:rt(te)(e.resource.description||"")},null,8,Jl)])):st("",!0),"data-structure"===a.key?(Ze(),Qe("div",Gl,[i.value?(Ze(),nt(ns,{key:0,resource:e.resource},null,8,["resource"])):st("",!0)])):st("",!0),"metadata"===a.key?(Ze(),Qe("div",Xl,[ut(gl,{resource:e.resource},null,8,["resource"])])):st("",!0),"downloads"===a.key?(Ze(),Qe("div",Zl,[dt("dl",Ql,["url"===e.resource.format?(Ze(),Qe("dt",ec,pt(t.$t("Original URL")),1)):(Ze(),Qe("dt",tc,pt(t.$t("Original format")),1)),dt("dd",nc,["url"===e.resource.format?(Ze(),Qe("span",rc,[dt("a",{href:e.resource.latest,class:"fr-link no-icon-after",rel:"ugc nofollow noopener",target:"_blank"},[ut(rt(D),{"auto-resize":!0,"max-lines":1,text:e.resource.url},{after:it(()=>[...k[2]||(k[2]=[dt("span",{class:"fr-ml-1v fr-icon-external-link-line fr-icon--sm"},null,-1)])]),_:1},8,["text"])],8,oc)])):(Ze(),Qe("span",ic,[k[3]||(k[3]=dt("span",{class:"text-blue-400 fr-icon-download-line fr-icon--sm fr-mr-1v fr-mt-1v"},null,-1)),dt("a",{href:e.resource.latest,class:"fr-link",rel:"ugc nofollow noopener",target:"_blank",download:""},[dt("span",null,[Tt(pt(t.$t("Format {format}",{format:e.resource.format})),1),e.resource.filesize?(Ze(),Qe("span",sc," - "+pt(rt(Q)(e.resource.filesize)),1)):st("",!0)])],8,ac)])),ut($n,{label:t.$t("Copy link"),"copied-label":t.$t("Link copied!"),text:e.resource.latest,class:"relative"},null,8,["label","copied-label","text"])]),e.resource.extras["analysis:parsing:parquet_url"]?(Ze(),Qe(Mt,{key:2},[dt("dt",lc,pt(t.$t("Auto-generated formats from {platform}",{platform:rt(_).title})),1),dt("dd",cc,[dt("span",null,[k[4]||(k[4]=dt("span",{class:"text-blue-400 fr-icon-download-line fr-icon--sm fr-mr-1v fr-mt-1v"},null,-1)),dt("a",{href:e.resource.extras["analysis:parsing:parquet_url"],class:"fr-link",rel:"ugc nofollow noopener",target:"_blank",download:""},[dt("span",null,[Tt(pt(t.$t("Format {format}",{format:"parquet"})),1),e.resource.extras["analysis:parsing:parquet_size"]?(Ze(),Qe("span",dc," - "+pt(rt(Q)(e.resource.extras["analysis:parsing:parquet_size"])),1)):st("",!0)])],8,uc)]),ut($n,{label:t.$t("Copy link"),"copied-label":t.$t("Link copied!"),text:e.resource.extras["analysis:parsing:parquet_url"],class:"relative"},null,8,["label","copied-label","text"])])],64)):st("",!0)])])):st("",!0),"swagger"===a.key?(Ze(),Qe("div",pc,[dt("div",null,pt(rt(o)("Swagger automatically generated by data.gouv.fr. This swagger allows you to query data by API by filtering it by column value.")),1),i.value?(Ze(),nt(rt(r),{key:0,url:`${rt(_).tabular_api_url}/api/resources/${n.resource.id}/swagger/`},null,8,["url"])):st("",!0)])):st("",!0)]),_:2},1024))),128))]),_:1})]),_:1})],8,Ul)):st("",!0)],2))}}),fc=An(hc,[["__scopeId","data-v-684aff4c"]]),mc=Ye({__name:"Loader",setup:e=>(e,t)=>(Ze(),nt(rt(ln),{width:1200,height:88,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},{default:it(()=>[...t[0]||(t[0]=[dt("rect",{x:"20",y:"24",rx:"4",ry:"4",width:"16",height:"16"},null,-1),dt("rect",{x:"52",y:"20",rx:"4",ry:"4",width:"536",height:"22"},null,-1),dt("rect",{x:"52",y:"52",rx:"4",ry:"4",width:"374",height:"16"},null,-1),dt("rect",{x:"1052",y:"30",rx:"4",ry:"4",width:"80",height:"20"},null,-1),dt("rect",{x:"1154",y:"20",rx:"20",ry:"20",width:"40",height:"40"},null,-1)])]),_:1}))});const gc={class:"fr-card fr-card--no-icon fr-enlarge-link"},vc={class:"fr-card__body"},yc={class:"fr-card__content fr-px-2w fr-py-1v"},wc={class:"fr-card__title fr-text--md fr-mt-1v fr-mb-0"},bc={class:"fr-card__desc fr-mt-0 text-mention-grey"},kc={class:"fr-text--sm fr-mb-0 flex"},xc={key:0,class:"not-enlarged"},Cc={class:"dash-before-sm text-overflow-ellipsis"},Sc={class:"fr-grid-row fr-grid-row--middle"},Mc={class:"fr-text--sm fr-my-0 dash-after-sm"},Tc=["aria-label"],Oc=["aria-label"],_c={class:"fr-card__header"},Nc={class:"fr-card__img"},Ec={key:0,class:"fr-badges-group"},Dc={key:0},Ac={class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380"},$c={key:1},Rc={class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380"},Lc=Ye({__name:"ReuseCard",props:{reuse:{},reuseUrl:{},organizationUrl:{}},setup(e){const t=e,{t:n}=H(),r=$i(t.reuse),{label:o}=function(e){const t=Wr(async()=>{const t=ht(e);return function(e,t){const n=e.find(e=>e.id===t);return n?n.label:""}(await dn(),t)},"");return{label:t}}(()=>t.reuse.type);return(t,i)=>(Ze(),Qe("article",gc,[dt("div",vc,[dt("div",yc,[dt("h3",wc,[ut(mn,{class:"text-grey-500",to:e.reuseUrl},{default:it(()=>[ut(rt(D),{"auto-resize":!0,text:e.reuse.title,"max-lines":1},null,8,["text"])]),_:1},8,["to"])]),dt("div",bc,[dt("p",kc,[e.reuse.organization?(Ze(),Qe("span",xc,[e.organizationUrl?(Ze(),nt(mn,{key:0,class:"fr-link",to:e.organizationUrl},{default:it(()=>[ut(rt(zr),{organization:e.reuse.organization},null,8,["organization"])]),_:1},8,["to"])):(Ze(),nt(rt(zr),{key:1,organization:e.reuse.organization},null,8,["organization"]))])):(Ze(),nt(rt(D),{key:1,class:"not-enlarged fr-mr-1v","auto-resize":!0,text:rt(r),"max-lines":1},null,8,["text"])),dt("span",Cc,pt(rt(n)("published {date}",{date:rt(K)(e.reuse.created_at)})),1)]),dt("div",Sc,[dt("p",Mc,pt(rt(o)),1),dt("p",{class:"fr-text--sm fr-my-0","aria-label":rt(n)("{n} views",e.reuse.metrics.views)},[i[0]||(i[0]=dt("span",{class:"fr-icon-eye-line fr-icon--xs fr-px-1v","aria-hidden":"true"},null,-1)),Tt(pt(rt(Y)(e.reuse.metrics.views)),1)],8,Tc),dt("p",{class:"fr-text--sm fr-my-0","aria-label":rt(n)("{n} followers",e.reuse.metrics.followers)},[i[1]||(i[1]=dt("span",{class:"fr-icon-star-line fr-icon--xs fr-px-1v","aria-hidden":"true"},null,-1)),Tt(pt(rt(Y)(e.reuse.metrics.followers)),1)],8,Oc)])])])]),dt("div",_c,[dt("div",Nc,[ut(Qr,{class:"fr-responsive-img reuse-ratio",alt:"",type:"reuse",src:e.reuse.image,size:320},null,8,["src"])]),e.reuse.private||e.reuse.archived?(Ze(),Qe("ul",Ec,[e.reuse.private?(Ze(),Qe("li",Dc,[dt("p",Ac,[i[2]||(i[2]=dt("span",{class:"fr-icon-lock-line fr-icon--xs"},null,-1)),Tt(" "+pt(rt(n)("Draft")),1)])])):st("",!0),e.reuse.archived?(Ze(),Qe("li",$c,[dt("p",Rc,[i[3]||(i[3]=dt("span",{class:"fr-icon-lock-line fr-icon--xs"},null,-1)),Tt(" "+pt(rt(n)("Archived")),1)])])):st("",!0)])):st("",!0)])]))}}),Ic=An(Lc,[["__scopeId","data-v-81c3bbfa"]]),Pc=Ye({__name:"Well",props:{type:{default:"primary"},color:{default:"grey-100"},weight:{default:"semi-bold"}},setup(e){const t=e,n=Xe(()=>`well${"primary"===t.type?"":"-"+t.type}-${t.color}`),r=Xe(()=>`fr-text--${t.weight}`),o=Xe(()=>r.value+" "+n.value);return(e,t)=>(Ze(),Qe("div",{class:lt(["well",o.value])},[tt(e.$slots,"default")],2))}});let zc=0;function Bc(e="id"){return zc++,Ft({id:`${e}-${zc}`})}const Fc=Ye({props:{data:{type:Object,required:!0},type:{type:String,default:"bar"}},setup(e){const{id:t}=Bc("bar-chart"),n=Object.keys(e.data),r="MM/YY",o=Z(n.shift()||"",r),i=Z(n.pop()||"",r);return mt(()=>{const n=document.getElementById(t),r=null==n?void 0:n.getContext("2d");if(!r)return;const o="#B6CFFB",i="#3558A2";let a={data:Object.values(e.data),type:e.type};if("bar"===e.type){const e=a;e.barPercentage=1,e.categoryPercentage=.9,e.backgroundColor=e.data.map((t,n)=>n===e.data.length-1?i:o),a=e}new ne(r,{data:{labels:Object.keys(e.data),datasets:[a]},options:{animation:!1,responsive:!0,locale:re,plugins:{legend:{display:!1},tooltip:{enabled:!1}},elements:{bar:{backgroundColor:o,borderRadius:2,hoverBackgroundColor:i},line:{backgroundColor:i,borderColor:i,borderJoinStyle:"round",tension:.35},point:{radius:0}},scales:{x:{display:!1,grid:{display:!1},ticks:{display:!1}},y:{display:!1,grid:{display:!1},ticks:{display:!1}}},layout:{padding:{top:1.5}}}})}),{id:t,startDate:o,endDate:i}}}),jc=["id"],Vc={class:"fr-grid-row justify-between"},qc={class:"text-xxs fr-m-0 text-mention-grey"},Hc={class:"text-xxs fr-m-0 text-mention-grey"};const Uc=An(Fc,[["render",function(e,t,n,r,o,i){return Ze(),Qe(Mt,null,[dt("canvas",{id:e.id,width:"120",height:"30"},null,8,jc),dt("div",Vc,[dt("p",qc,pt(e.startDate),1),dt("p",Hc,pt(e.endDate),1)])],64)}]]),Wc=Ye({props:{author:{type:Object,required:!0},badge:Boolean}}),Kc={class:"fr-text--sm fr-mb-0"},Yc={key:0,class:"fr-badge fr-ml-3v"};const Jc=An(Wc,[["render",function(e,t,n,r,o,i){return Ze(),Qe("span",Kc,[Tt(pt(e.author.first_name+" "+e.author.last_name)+" ",1),e.badge?(Ze(),Qe("span",Yc,pt(e.$t("Admin")),1)):st("",!0)])}]]);const Gc=An(Ye({emits:["click"],props:{primary:{type:Boolean,default:!1}}}),[["render",function(e,t,n,r,o,i){return Ze(),Qe("button",{type:"button",class:lt(["fr-btn",{"fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 fr-icon-add-line fr-btn--icon-left":!e.primary}]),onClick:t[0]||(t[0]=zt(t=>e.$emit("click"),["prevent"]))},pt(e.$t("Start a new discussion")),3)}]]);const Xc=An({},[["render",function(e,t){const n=jt("i18n-t");return Ze(),nt(n,{keypath:"Fields preceded by a star ({markup}) are required.",tag:"p",class:"fr-mt-0 fr-mb-1w fr-text--xs",scope:"global"},{markup:it(()=>[...t[0]||(t[0]=[dt("span",{class:"required-field-star"},"*",-1)])]),_:1})}]]),Zc=Ye({expose:["displayForm"],components:{ThreadCreateButton:Gc,Author:Jc,RequiredExplanation:Xc},props:{showCreateButton:{type:Boolean,default:!1},subjectId:{type:String,required:!0},subjectClass:{type:String,required:!0},onSubmit:{type:Function,required:!0}},setup(e){const t=ct(!1),n=ct(!1),r=ct(""),o=ct("");return{loading:t,showForm:n,title:r,comment:o,user:oe,displayForm:()=>{ie(),n.value=!0},hideForm:()=>{n.value=!1},submit:()=>{t.value=!0;const i={title:r.value,comment:o.value,subject:{id:e.subjectId,class:e.subjectClass}};e.onSubmit(i).finally(()=>{var e;t.value=!1,n.value=!1,r.value=o.value="",null===(e=document.querySelector("[data-no-discussion]"))||void 0===e||e.remove()})}}}}),Qc={class:"thread-create fr-mt-2w"},eu={key:1,class:"bg-contrast-grey"},tu={class:"fr-grid-row fr-grid-row--middle fr-py-2w fr-px-3w"},nu={class:"fr-col fr-h6 fr-mb-0"},ru={class:"thread-comment fr-pb-3w fr-px-3w"},ou={class:"fr-input-group"},iu={for:"thread-title",class:"fr-label required"},au=["placeholder"],su={class:"fr-input-group"},lu={for:"thread-comment",class:"fr-label required"},cu=["placeholder"],uu={class:"fr-grid-row justify-between fr-grid-row--middle"},du={class:"text-mention-grey fr-text--sm fr-mb-0"},pu=["value"];const hu=An(Zc,[["render",function(e,t,n,r,o,i){const a=jt("ThreadCreateButton"),s=jt("RequiredExplanation"),l=jt("Author");return Ze(),Qe("div",Qc,[e.showCreateButton&&!e.showForm?(Ze(),nt(a,{key:0,onClick:e.displayForm},null,8,["onClick"])):st("",!0),e.showForm?(Ze(),Qe("div",eu,[dt("div",tu,[dt("div",nu,pt(e.$t("New discussion")),1),dt("div",null,[dt("button",{class:"fr-btn--close fr-btn text-grey-500 fr-mr-0",onClick:t[0]||(t[0]=(...t)=>e.hideForm&&e.hideForm(...t))},pt(e.$t("Close")),1)])]),dt("div",ru,[dt("form",{class:"form fr-p-0",onSubmit:t[3]||(t[3]=zt((...t)=>e.submit&&e.submit(...t),["prevent"]))},[ut(s),dt("div",ou,[dt("label",iu,pt(e.$t("Title")),1),Vt(dt("input",{class:"fr-input",type:"text",id:"thread-title","onUpdate:modelValue":t[1]||(t[1]=t=>e.title=t),placeholder:e.$t("Title"),required:!0},null,8,au),[[qt,e.title]])]),dt("div",su,[dt("label",lu,pt(e.$t("Message")),1),Vt(dt("textarea",{id:"thread-comment","onUpdate:modelValue":t[2]||(t[2]=t=>e.comment=t),placeholder:e.$t("Comment"),class:"fr-input",required:!0},null,8,cu),[[qt,e.comment]])]),dt("footer",uu,[dt("span",du,[Tt(pt(e.$t("Reply as"))+" ",1),ut(l,{author:e.user},null,8,["author"])]),dt("input",{type:"submit",value:e.$t("Submit"),class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500"},null,8,pu)])],32)])])):st("",!0)])}]]);var fu=Object.defineProperty,mu=(e,t,n)=>(((e,t,n)=>{t in e?fu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const gu="top-right",vu="top",yu="top-left",wu="bottom-right",bu="bottom",ku="bottom-left";function xu(e,t,n){let r=t;switch(e){case vu:case gu:case yu:r=t;break;case bu:case wu:case ku:r=n}return r}class Cu{constructor(e,t){mu(this,"startedAt"),mu(this,"callback"),mu(this,"delay"),mu(this,"timer"),this.startedAt=Date.now(),this.callback=e,this.delay=t,this.timer=setTimeout(e,t)}pause(){this.stop(),this.delay-=Date.now()-this.startedAt}resume(){this.stop(),this.startedAt=Date.now(),this.timer=setTimeout(this.callback,this.delay)}stop(){clearTimeout(this.timer)}}const Su=function(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(e){e(n)}),(r=e.get("*"))&&r.slice().map(function(e){e(t,n)})}}}(),Mu=Ye({__name:"Toaster",props:{message:{},type:{default:"default"},position:{default:wu},maxToasts:{type:[Number,Boolean],default:!1},duration:{type:[Number,Boolean],default:4e3},dismissible:{type:Boolean,default:!0},queue:{type:Boolean,default:!1},props:{type:Boolean,default:!0},useDefaultCss:{type:Boolean,default:!0},onClose:{type:Function,default:()=>{}},onClick:{type:Function,default:()=>{}}},setup(e){const t=e;let n,r=null,o=null,i=null;const a=ct(null),s=ct(!1);function l(){if(function(){if(!t.queue&&!1===t.maxToasts)return!1;let e=0;r&&(e=r.childElementCount);let n=0;return o&&(n=o.childElementCount),!1!==t.maxToasts?t.maxToasts<=e+n:e>0||n>0}())return void(n=window.setTimeout(l,250));const e=r&&o?xu(t.position,r,o):null;e&&a.value&&(e.insertAdjacentElement("afterbegin",a.value),s.value=!0,i=!1!==t.duration?new Cu(d,t.duration):null)}function c(){t.onClick.apply(null,arguments),t.dismissible&&d()}function u(e){i&&(e?i.pause():i.resume())}function d(){i&&i.stop(),clearTimeout(n),s.value=!1,setTimeout(()=>{t.onClose.apply(null,arguments),a.value&&(e=>{typeof e.remove<"u"?e.remove():e.parentNode&&e.parentNode.removeChild(e)})(a.value)},150)}Ht(()=>{r=document.querySelector(".c-toast-container--top"),o=document.querySelector(".c-toast-container--bottom"),(!r||!o)&&(r||(r=document.createElement("div"),r.className="c-toast-container c-toast-container--top"),o||(o=document.createElement("div"),o.className="c-toast-container c-toast-container--bottom")),function(){const e=t.useDefaultCss?"add":"remove";r&&r.classList[e]("v--default-css"),o&&o.classList[e]("v--default-css")}(),function(){const e=document.body;r&&e.appendChild(r),o&&e.appendChild(o)}()}),mt(()=>{l(),Su.on("toast-clear",d)});const p=Xe(()=>xu(t.position,{enter:"fadeInDown",leave:"fadeOut"},{enter:"fadeInUp",leave:"fadeOut"})),h=Xe(()=>t.dismissible?"button":"div");return Ut(()=>{Su.off("toast-clear",d)}),(e,t)=>(Ze(),nt(Wt,{"enter-active-class":p.value.enter,"leave-active-class":p.value.leave,ref_key:"el",ref:a},{default:it(()=>[Vt((Ze(),nt(It(h.value),{class:lt(["c-toast",`c-toast--${e.type}`,`c-toast--${e.position}`]),onMouseover:t[0]||(t[0]=e=>u(!0)),onMouseleave:t[1]||(t[1]=e=>u(!1)),onClick:c,role:"alert"},{default:it(()=>[Tt(pt(e.message),1)]),_:1},40,["class"])),[[Kt,s.value]])]),_:1},8,["enter-active-class","leave-active-class"]))}});function Tu(e,{props:t}={}){let n=typeof document<"u"?document.createElement("div"):null,r=Nt(e,t);return n&&Yt(r,n),{vNode:r,destroy:()=>{n&&Yt(null,n),n=null,r=null},el:n}}const Ou=function(e={}){return{show(t,n={}){let r=M({message:t},n);return Tu(Mu,{props:M(M({},e),r)})},clear(){Su.emit("toast-clear")},success(e,t={}){return t.type="success",this.show(e,t)},error(e,t={}){return t.type="error",this.show(e,t)},info(e,t={}){return t.type="info",this.show(e,t)},warning(e,t={}){return t.type="warning",this.show(e,t)}}}({duration:!1,dismissible:!0});function _u(){return{toast:Ou}}const Nu=Ye({components:{Author:Jc,RequiredExplanation:Xc},emits:["close"],props:{onSubmit:{type:Function,required:!0}},setup(e){const{t:t}=H(),{toast:n}=_u(),r=ct(!1),o=ct("");return{comment:o,loading:r,submit:()=>{r.value=!0,e.onSubmit(o.value).catch(e=>{n.error(t("Error sending response"))}).finally(()=>{r.value=!1,o.value=""})},user:oe}}}),Eu={class:"thread-reply"},Du={class:"fr-grid-row fr-grid-row--middle fr-mb-3v"},Au={class:"fr-col fr-text--bold fr-mb-0"},$u={class:"fr-col-auto"},Ru={class:"fr-input-group"},Lu={class:"fr-label required",for:"textarea"},Iu={class:"fr-grid-row justify-between fr-grid-row--middle"},Pu={class:"text-mention-grey fr-text--sm fr-m-0"},zu=["value"];const Bu=An(Nu,[["render",function(e,t,n,r,o,i){const a=jt("RequiredExplanation"),s=jt("Author");return Ze(),Qe("div",Eu,[dt("div",Du,[dt("h4",Au,pt(e.$t("Reply to the discussion")),1),dt("div",$u,[dt("button",{class:"fr-btn--close fr-btn text-grey-500 fr-mr-0",onClick:t[0]||(t[0]=t=>e.$emit("close"))},pt(e.$t("Close")),1)])]),dt("form",{class:"form fr-p-0",onSubmit:t[2]||(t[2]=zt((...t)=>e.submit&&e.submit(...t),["prevent"]))},[ut(a),dt("div",Ru,[dt("label",Lu,pt(e.$t("Comment")),1),Vt(dt("textarea",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.comment=t),required:"",class:"fr-input",id:"textarea"},null,512),[[qt,e.comment]])]),dt("footer",Iu,[dt("p",Pu,[Tt(pt(e.$t("Reply as"))+" ",1),ut(s,{author:e.user},null,8,["author"])]),dt("input",{type:"submit",value:e.$t("Submit"),class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500"},null,8,zu)])],32)])}]]),Fu=Ye({__name:"MarkAsNoSpam",props:{url:{},spam:{}},setup(e){const t=e,n=()=>T.delete(t.url).then(()=>{window.location.reload()}),r=Xe(()=>t.spam&&t.spam.status&&"potential_spam"===t.spam.status&&oe&&oe.roles&&oe.roles.includes("admin"));return(e,t)=>r.value?(Ze(),Qe("button",{key:0,class:"fr-btn fr-btn--sm fr-btn--icon-right fr-icon-feedback-fill",onClick:n},pt(e.$t("Mark as no spam")),1)):st("",!0)}}),ju=["id"],Vu={class:"fr-grid-row fr-grid-row--middle justify-between fr-py-2w fr-px-3w no-wrap wrap-md"},qu={key:0,class:"fr-col-auto text-default-warning fr-text--bold fr-pr-2w fr-my-0"},Hu={class:"fr-col fr-mx-3v fr-mx-md-0 fr-h6 fr-mb-0"},Uu={class:"fr-col-auto text-align-right"},Wu=["id","data-clipboard-text"],Ku={class:"fr-grid-row fr-grid-row--gutters"},Yu={class:"fr-col-auto"},Ju={class:"fr-col"},Gu={class:"fr-my-0"},Xu={class:"fr-text--sm text-mention-grey fr-m-0"},Zu={class:"white-space-pre-wrap overflow-wrap-anywhere"},Qu={class:"fr-my-0"},ed={key:0,class:"fr-py-2w fr-px-3w"},td={class:"fr-py-2w fr-px-3w"},nd={key:1,class:"text-grey-380"},rd={class:"fr-px-1v"},od=Ye({__name:"Thread",props:{thread:{}},setup(e){const t=e,{t:n}=H(),r=ct(!1),o=ct([...t.thread.discussion]),i=ct(!!t.thread.closed),a=Xe(()=>"discussions/"+t.thread.id),s=Xe(()=>{const e="#/"+a.value;return window.location.origin+window.location.pathname+e}),l=()=>{ie(),r.value=!0},c=e=>T.post("/discussions/"+t.thread.id+"/",{comment:e}).then(e=>e.data).then(e=>{o.value=e.discussion,r.value=!1});return(t,u)=>(Ze(),Qe("div",{class:"bg-contrast-grey fr-mt-2w",id:a.value},[dt("header",Vu,[e.thread.closed?(Ze(),Qe("p",qu,[dt("span",null,pt(rt(n)("Discussion closed")),1)])):st("",!0),dt("h3",Hu,pt(e.thread.title),1),dt("div",Uu,[ut(Fu,{url:`discussions/${e.thread.id}/spam`,spam:e.thread.spam,class:"fr-mr-3v"},null,8,["url","spam"]),dt("button",{id:e.thread.id+"-copy","data-clipboard-text":s.value,class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 fr-btn--icon-right fr-icon-links-fill"},pt(rt(n)("Copy discussion permalink")),9,Wu)])]),dt("div",null,[ut(Jt,{name:"list"},{default:it(()=>[i.value?st("",!0):(Ze(!0),Qe(Mt,{key:0},Pt(o.value,(t,n)=>(Ze(),Qe("article",{class:"thread-comment fr-py-3w fr-px-3w fr-pr-5w",key:`comment-${e.thread.id}-${n}`},[dt("div",Ku,[dt("div",Yu,[ut(rt(yn),{user:t.posted_by},null,8,["user"])]),dt("div",Ju,[dt("p",Gu,[ut(Jc,{author:t.posted_by,badge:!1},null,8,["author"])]),dt("p",Xu,pt(rt(Z)(t.posted_on)),1),ut(rt(Ba),{class:"fr-mt-3v"},{default:it(()=>[dt("div",Zu,[dt("p",Qu,pt(t.content),1)])]),_:2},1024),ut(Fu,{url:`discussions/${e.thread.id}/comments/${n}/spam`,spam:t.spam,class:"fr-mt-3v"},null,8,["url","spam"])])])]))),128))]),_:1}),i.value?(Ze(),Qe("div",ed,[dt("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500",onClick:u[0]||(u[0]=zt(e=>i.value=!1,["prevent"]))},pt(rt(n)("See {n} messages",o.value.length)),1)])):st("",!0)]),dt("footer",td,[e.thread.closed||rt(ae)?st("",!0):(Ze(),Qe(Mt,{key:0},[r.value?(Ze(),nt(Bu,{key:1,subjectId:e.thread.id,onSubmit:c,onClose:u[1]||(u[1]=e=>r.value=!1)},null,8,["subjectId"])):(Ze(),Qe("button",{key:0,class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500 fr-btn--icon-right fr-icon-arrow-right-s-line",onClick:zt(l,["stop"])},pt(rt(n)("Reply")),1))],64)),e.thread.closed?(Ze(),Qe("div",nd,[Tt(pt(rt(n)("The discussion was closed by"))+" ",1),dt("strong",rd,[ut(Jc,{author:e.thread.closed_by},null,8,["author"])]),Tt(" "+pt(rt(n)("on"))+" "+pt(rt(Z)(e.thread.closed)),1)])):st("",!0)])],8,ju))}});const id=An({components:{ContentLoader:ln}},[["render",function(e,t,n,r,o,i){const a=jt("ContentLoader");return Ze(),nt(a,{width:280,height:180,speed:2,primaryColor:"#7c7c7c",secondaryColor:"#2d2d2d"},{default:it(()=>[...t[0]||(t[0]=[dt("rect",{x:"104",y:"41",rx:"3",ry:"3",width:"162",height:"10"},null,-1),dt("rect",{x:"105",y:"63",rx:"3",ry:"3",width:"139",height:"5"},null,-1),dt("rect",{x:"26",y:"99",rx:"5",ry:"5",width:"60",height:"60"},null,-1),dt("rect",{x:"104",y:"113",rx:"3",ry:"3",width:"162",height:"10"},null,-1),dt("rect",{x:"105",y:"135",rx:"3",ry:"3",width:"139",height:"5"},null,-1),dt("rect",{x:"26",y:"24",rx:"5",ry:"5",width:"60",height:"60"},null,-1)])]),_:1})}]]);const ad={key:0,class:"fr-grid-row fr-grid-row--middle"},sd={class:"fr-col"},ld={id:"community-discussions",class:"subtitle subtitle--uppercase"},cd={key:0,class:"fr-col-12 fr-col-md-6 fr-grid-row fr-grid-row--gutters fr-grid-row--middle fr-grid-row--right"},ud={class:"fr-col-auto"},dd=["aria-label"],pd=["value","selected"],hd={class:"fr-col-auto"},fd={key:1,class:"fr-grid-row fr-grid-row--center"},md={key:0},gd={class:"fr-grid-row fr-grid-row--middle justify-between"},vd={class:"text-decoration-underline"},yd={key:1},wd={class:"fr-mb-5v"},bd=Ye({__name:"Threads",props:{subjectId:{},subjectClass:{}},setup(e,{expose:t}){const n=e,{t:r}=H(),{toast:o}=_u(),i=ct([]),{id:a,resetHash:s}=function(e){const t=ct(null),n=()=>{const n=window.location.hash;for(const r of e){let[e,o,i]=r.exec(n)||[];if(o)return t.value=o}t.value=null};return mt(()=>{n(),window.addEventListener("hashchange",()=>n())}),{id:Ft(t),resetHash:()=>{history.pushState(null,""," "),window.dispatchEvent(new HashChangeEvent("hashchange"))}}}([/discussions\/([a-f0-9]{24})-?([0-9]+)?$/i,/discussion-([a-f0-9]{24})-?([0-9]+)?$/i]),l=ct(null),c=ct(1),u=ct(0),d=ct(!0),p=[{name:r("Discussion creation"),key:"-created"},{name:r("Last reply"),key:"-discussion.posted_on"}],h=ct(p[0]),f=ct(null),m=e=>{if(e)return d.value=!0,setTimeout(()=>{f.value&&f.value.scrollIntoView({behavior:"smooth"})},500),T.get("/discussions/"+e).then(e=>e.data).then(e=>{e&&(l.value=e,u.value=1)}).catch(()=>{o.error(r("An error occurred while fetching the discussion ")+e),g(1)}).finally(()=>{d.value=!1})},g=(e=1,t=!1)=>(e=ht(e),d.value=!0,t&&setTimeout(()=>{f.value&&f.value.scrollIntoView({behavior:"smooth"})},500),T.get("/discussions/",{params:{page:e,for:n.subjectId,sort:h.value.key,page_size:5}}).then(e=>e.data).then(e=>{e.data&&(i.value=e.data,u.value=e.total)}).catch(()=>{o.error(r("An error occurred while fetching discussions")),i.value=[]}).finally(()=>{d.value=!1})),v=ct(null),y=()=>{v.value&&v.value.displayForm()},w=e=>T.post("/discussions/",e).then(()=>{c.value=1,g(1,!0)}).catch(e=>o.error(r("An error occurred while creating the discussion "),e)),b=(e,t=!0)=>{c.value=e,g(e,t)};return mt(()=>{g()}),St(()=>{a.value&&m(a.value)}),ft(u,e=>{const t=document.querySelectorAll(".discussions-count");t&&t.forEach(t=>t.innerHTML=e.toFixed(0))}),t({startThread:()=>{y(),v.value&&v.value.$el.scrollIntoView()}}),(t,n)=>(Ze(),Qe("section",{class:"discussions-wrapper",ref_key:"top",ref:f},[u.value?(Ze(),Qe("div",ad,[dt("div",sd,[dt("h2",ld,pt(rt(r)("{n} discussions",u.value)),1)]),rt(a)?st("",!0):(Ze(),Qe("div",cd,[dt("div",ud,[Vt(dt("select",{name:"sortBy",id:"sortBy","aria-label":rt(r)("Sort discussions by"),onChange:n[0]||(n[0]=e=>{return t=h.value,h.value=t,void g(c);var t}),"onUpdate:modelValue":n[1]||(n[1]=e=>h.value=e),class:"fr-select fr-select--no-border fr-select--blue"},[(Ze(),Qe(Mt,null,Pt(p,e=>dt("option",{value:e,selected:e===h.value},pt(e.name),9,pd)),64))],40,dd),[[Gt,h.value]])]),dt("div",hd,[ut(Gc,{onClick:y})])]))])):(Ze(),Qe("div",fd,[ut(Gc,{class:"fr-col--bottom",primary:!0,onClick:y})])),ut(Wt,{mode:"out-in"},{default:it(()=>[d.value?(Ze(),nt(id,{key:0,class:"fr-mt-2w"})):(Ze(),Qe(Mt,{key:1},[rt(a)?(Ze(),Qe("div",md,[ut(rt(Pc),{type:"secondary",color:"success",class:"fr-mt-2w","data-cy":"threadFromURL"},{default:it(()=>[dt("div",gd,[Tt(pt(rt(r)("You are seeing a specific discussion about this dataset."))+" ",1),dt("button",{class:"fr-btn--close fr-btn fr-mr-0",onClick:n[2]||(n[2]=zt((...e)=>rt(s)&&rt(s)(...e),["prevent"]))},pt(rt(r)("Close")),1)])]),_:1}),l.value?(Ze(),nt(od,{key:0,thread:l.value},null,8,["thread"])):(Ze(),nt(rt(Pc),{key:1,type:"secondary",color:"warning",class:"fr-mt-2w"},{default:it(()=>[Tt(pt(t.$t("This discussion doesn't exist or was deleted.")),1)]),_:1})),dt("button",{class:"nav-link nav-link--no-icon text-decoration-none fr-link fr-mt-9v fr-link--icon-left fr-icon-arrow-right-s-line",onClick:n[3]||(n[3]=zt((...e)=>rt(s)&&rt(s)(...e),["prevent"]))},[dt("span",vd,pt(rt(r)("See all discussions about this dataset")),1)])])):(Ze(),Qe("div",yd,[rt(ae)?st("",!0):(Ze(),nt(hu,{key:0,ref_key:"createThread",ref:v,onSubmit:w,subjectId:e.subjectId,subjectClass:e.subjectClass},null,8,["subjectId","subjectClass"])),dt("ul",wd,[(Ze(!0),Qe(Mt,null,Pt(i.value,e=>(Ze(),Qe("li",null,[ut(od,{thread:e},null,8,["thread"])]))),256))]),u.value>5?(Ze(),nt(rt(Pa),{key:1,page:c.value,"page-size":5,"total-results":u.value,onChange:b},null,8,["page","total-results"])):st("",!0)]))],64))]),_:1})],512))}}),kd=["href"],xd={class:"fr-grid-row fr-grid-row--middle"},Cd=Ye({__name:"MenuSearchOption",props:{icon:{},query:{},link:{},type:{}},setup:e=>(t,n)=>{const r=jt("i18n-t");return Ze(),Qe("a",{class:"fr-nav__link unstyled",href:e.link},[dt("div",xd,[dt("span",{class:lt(["fr-icon--sm align-[-1px] fr-mr-1w",e.icon]),"aria-hidden":"true"},null,2),e.query?(Ze(),nt(r,{key:0,keypath:"Search {query} in {type}",class:"fr-col",tag:"div",scope:"global"},{query:it(()=>[dt("em",null,pt(e.query),1)]),type:it(()=>[dt("strong",null,pt(e.type),1)]),_:1})):(Ze(),nt(r,{key:1,keypath:"Start typing to search in X",class:"fr-col",tag:"div",scope:"global"},{type:it(()=>[dt("strong",null,pt(e.type),1)]),_:1})),n[0]||(n[0]=dt("div",{"aria-hidden":"true",class:"fr-col-auto"},[dt("span",{class:"fr-icon-arrow-right-s-line fr-icon--sm","aria-hidden":"true"})],-1))])],8,kd)}});function Sd(e){const t=Xe(()=>`${se}?q=${ht(e)}`);return{dataserviceUrl:Xe(()=>`${le}?q=${ht(e)}`),datasetUrl:t,organizationUrl:Xe(()=>`${ce}?q=${ht(e)}`),reuseUrl:Xe(()=>`${ue}?q=${ht(e)}`)}}function Md(e){const t=ct(),n=Xe(()=>ht(e).find(e=>e.id===t.value)),r=e=>{if(void 0===e)return i(0);t.value=e},o=()=>{t.value=void 0},i=t=>{let n=ht(e);n[t]&&r(n[t].id)};return{select:r,selected:t,selectedOption:n,isSelected:e=>t.value===e,focusOut:o,handleKeyPressForActiveDescendant:(n,r=!1)=>{switch(n.key){case"ArrowDown":r||n.altKey||(()=>{let n=0;t.value&&(n=ht(e).findIndex(e=>e.id===t.value),n++,n===ht(e).length&&(n=0)),i(n)})();break;case"ArrowUp":(()=>{const n=ht(e).length-1;let r=n;t.value&&(r=ht(e).findIndex(e=>e.id===t.value),r--,r<0&&(r=n)),i(r)})();break;case"ArrowLeft":case"ArrowRight":case"Home":case"End":case"Escape":o()}},ALREADY_MOVED_DOWN:!0,NOT_MOVED_YET:!1}}function Td(e,t){const n=ct(null),r=ct(null),o=ct(null),{expanded:i,handleKeyPressForCollapse:a,hide:s,registerBackgroundEvent:l,removeBackgroundEvent:c,show:u,uid:d}=function(){const e=G("collapse"),t=ct(!1),n=()=>t.value=!0,r=()=>t.value=!1;let o=null;const i=(e,t)=>!e||!e.contains(t),a=(e,t,n)=>o=>{const a=o.target;i(e,a)&&i(t,a)&&i(n,a)&&r()};return{expanded:t,uid:e,show:n,hide:r,toggle:()=>t.value=!t.value,registerBackgroundEvent:(e,t,n)=>{const r=ht(e),i=ht(t),s=ht(n);o=a(r,i,s),document.body.addEventListener("pointerup",o,!0)},removeBackgroundEvent:()=>{o&&document.body.removeEventListener("pointerup",o,!0)},handleKeyPressForCollapse:e=>{switch(e.key){case"Alt":case"Control":case"Shift":case"CapsLock":break;case"Escape":case"Tab":r();break;default:n()}}}}(),{focusOut:p,handleKeyPressForActiveDescendant:h,isSelected:f,select:m,selected:g,selectedOption:v,NOT_MOVED_YET:y,ALREADY_MOVED_DOWN:w}=Md(e);function b(){ht(t)&&(u(),m(g.value))}function k(){v.value&&(window.location.href=v.value.link)}return mt(()=>{l(n,r,o)}),Dt(()=>{c()}),{buttonRef:o,expanded:i,focusOut:p,handleFocusOut:function(){p(),s()},handleKeyDown:function(e){b();let t=y;i.value||(t=w),a(e),h(e,t)},handleKeyPressForActiveDescendant:h,handleKeyPressForCollapse:a,hide:s,inputRef:n,isSelected:f,listRef:r,registerBackgroundEvent:l,removeBackgroundEvent:c,searchSelectedOption:k,select:m,selected:g,show:u,showAndFocus:function(){var e;i.value?k():(null===(e=n.value)||void 0===e||e.focus(),b())},showAndSelectIfQuery:b,uid:d,NOT_MOVED_YET:y,ALREADY_MOVED_DOWN:w}}const Od=["id"],_d=["for","id"],Nd=["placeholder","aria-controls","aria-expanded","id","aria-activedescendant"],Ed=["aria-controls","aria-expanded"],Dd=["id","aria-labelledby"],Ad={class:"fr-menu__list",role:"listbox"},$d=["id","aria-selected"],Rd=Ye({__name:"MenuSearch",setup(e){const{t:t}=H(),n=ct(""),{datasetUrl:r,dataserviceUrl:o,reuseUrl:i,organizationUrl:a}=Sd(n),{id:s}=Bc("search"),l=Xe(()=>`${s}-input`),c=Xe(()=>`${s}-label`),u=ct([{id:"dataset-option",icon:"fr-icon-database-line",type:t("datasets"),link:r},{id:"dataservice-option",icon:"fr-icon-code-s-slash-line",type:t("dataservices"),link:o},{id:"reuse-option",icon:"fr-icon-line-chart-line",type:t("reuses"),link:i},{id:"organization-option",icon:"fr-icon-government-line",type:t("organizations"),link:a}]),{buttonRef:d,expanded:p,handleFocusOut:h,handleKeyDown:f,inputRef:m,isSelected:g,listRef:v,searchSelectedOption:y,selected:w,showAndFocus:b,showAndSelectIfQuery:k,uid:x}=Td(u,n);return(e,r)=>(Ze(),Qe("div",{id:rt(s),class:"fr-col fr-search-bar wrap",role:"search"},[dt("label",{class:"fr-label",for:l.value,id:c.value},pt(rt(t)("Search for data")),9,_d),Vt(dt("input",{class:"fr-input fr-col",placeholder:rt(t)("Search"),ref_key:"inputRef",ref:m,autocomplete:"off",role:"combobox","aria-autocomplete":"list","aria-controls":rt(x),"aria-expanded":rt(p),id:l.value,"data-cy":"search-input","aria-activedescendant":rt(w),name:"q","onUpdate:modelValue":r[0]||(r[0]=e=>n.value=e),onClickCapture:r[1]||(r[1]=zt((...e)=>rt(k)&&rt(k)(...e),["stop"])),onKeydown:r[2]||(r[2]=(...e)=>rt(f)&&rt(f)(...e)),onKeypress:r[3]||(r[3]=Xt(zt((...e)=>rt(y)&&rt(y)(...e),["prevent"]),["enter"])),onBlur:r[4]||(r[4]=(...e)=>rt(h)&&rt(h)(...e))},null,40,Nd),[[qt,n.value]]),dt("button",{type:"button",ref_key:"buttonRef",ref:d,class:"fr-btn",tabindex:"-1","aria-controls":rt(x),"aria-expanded":rt(p),onClickCapture:r[5]||(r[5]=zt((...e)=>rt(b)&&rt(b)(...e),["prevent","stop"]))},pt(rt(t)("Search")),41,Ed),dt("div",{class:"fr-menu fr-collapse autocomplete",id:rt(x),ref_key:"listRef",ref:v,role:"listbox","aria-labelledby":c.value,onMousedown:r[6]||(r[6]=zt(()=>{},["prevent"]))},[dt("ul",Ad,[(Ze(!0),Qe(Mt,null,Pt(u.value,e=>(Ze(),Qe("li",{key:e.id,id:e.id,role:"option","aria-selected":rt(g)(e.id)},[ut(Cd,{icon:e.icon,query:n.value,type:e.type,link:e.link},null,8,["icon","query","type","link"])],8,$d))),128))])],40,Dd)],8,Od))}}),Ld=Ye({emits:["change"],props:{value:{type:String,required:!0},placeholder:{type:String,required:!0}},setup(e,{emit:t}){const{id:n}=Bc("search-input"),r=ct(e.value),o=ct(null);return mt(async()=>{var e;await gt(),null===(e=o.value)||void 0===e||e.focus({preventScroll:!0})}),St(()=>{r.value=e.value}),{id:n,input:o,onDelete:()=>{""===r.value&&t("change",r.value)},onInput:e=>{const n=e.target;t("change",n.value)},queryString:r}}}),Id={class:"fr-search-bar fr-search-bar--lg w-100"},Pd=["for"],zd=["id","value","aria-label","placeholder"],Bd={class:"fr-btn",type:"submit"};const Fd=An(Ld,[["render",function(e,t,n,r,o,i){return Ze(),Qe("section",Id,[dt("label",{class:"fr-label",for:e.id},pt(e.$t("Search")),9,Pd),dt("input",{id:e.id,type:"search",name:"q",value:e.queryString,onInput:t[0]||(t[0]=(...t)=>e.onInput&&e.onInput(...t)),onKeydown:t[1]||(t[1]=Xt((...t)=>e.onDelete&&e.onDelete(...t),["delete"])),ref:"input",class:"fr-input","aria-label":e.placeholder||e.$t("Search..."),placeholder:e.placeholder||e.$t("Search..."),"data-cy":"search-input","data-testid":"search-input"},null,40,zd),dt("button",Bd,pt(e.$t("Search")),1)])}]]),jd=Ye({__name:"card-lg",props:{dataset:{},style:{type:[Boolean,null,String,Object,Array]},showDescription:{type:Boolean,default:!0}},setup:e=>(t,n)=>{var r;return Ze(),nt(rt(Qi),{dataset:e.dataset,style:Lt(e.style),showDescription:e.showDescription,"dataset-url":e.dataset.page,"organization-url":null===(r=e.dataset.organization)||void 0===r?void 0:r.page},null,8,["dataset","style","showDescription","dataset-url","organization-url"])}}),Vd=Ye({components:{ContentLoader:ln},setup(e){const t=de.resources_default_page_size;return{pageSize:t,height:88,getPosition:(e,t)=>88*(e-1)+t}}}),qd=["y"],Hd=["y"],Ud=["y"],Wd=["y"],Kd=["y"];const Yd=An(Vd,[["render",function(e,t,n,r,o,i){const a=jt("ContentLoader");return Ze(),nt(a,{width:1200,height:e.height*e.pageSize,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},{default:it(()=>[(Ze(!0),Qe(Mt,null,Pt(e.pageSize,t=>(Ze(),Qe(Mt,null,[dt("rect",{x:"20",y:e.getPosition(t,24),rx:"4",ry:"4",width:"16",height:"16"},null,8,qd),dt("rect",{x:"52",y:e.getPosition(t,20),rx:"4",ry:"4",width:"536",height:"22"},null,8,Hd),dt("rect",{x:"52",y:e.getPosition(t,52),rx:"4",ry:"4",width:"374",height:"16"},null,8,Ud),dt("rect",{x:"1052",y:e.getPosition(t,30),rx:"4",ry:"4",width:"80",height:"20"},null,8,Wd),dt("rect",{x:"1154",y:e.getPosition(t,20),rx:"20",ry:"20",width:"40",height:"40"},null,8,Kd)],64))),256))]),_:1},8,["height"])}]]),Jd={help:"Utilisez la tabulation (ou les touches flches) pour naviguer dans la liste des suggestions",placeholder:"Rechercher dans la liste",noResult:"Aucun rsultat",results:"{x} suggestion(s) disponibles",deleteItem:"Supprimer {t}",delete:"Supprimer",clear:"Vider"},Gd=Element.prototype.matches;let Xd=Element.prototype.closest;Xd||(Xd=function(e){var t=this;do{if(Gd.call(t,e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null});function Zd(e){return Array.from(e).map(e=>e.cloneNode(true))}function Qd(e){return"OPTGROUP"===e.parentNode.tagName&&(e.dataset.group=e.parentNode.label),e}class ep{constructor(e,t){var n;this.el=e,this.label=document.querySelector(`label[for=${e.id}]`),this.id=e.id,this.open=!1,this.multiple=this.el.multiple,this.search="",this.suggestions=[],this.focusIndex=null;const r=Object.assign({},t),o=Object.assign({},Jd,r.text);if(delete r.text,this._defaultSearch=this._defaultSearch.bind(this),this._options=Object.assign({text:o,showSelected:!0,fillSuggestions:this._defaultSearch,useLabelAsButton:!1,clearable:!1},r),this._handleFocus=this._handleFocus.bind(this),this._handleInput=this._handleInput.bind(this),this._handleKeyboard=this._handleKeyboard.bind(this),this._handleOpener=this._handleOpener.bind(this),this._handleClear=this._handleClear.bind(this),this._handleReset=this._handleReset.bind(this),this._handleSuggestionClick=this._handleSuggestionClick.bind(this),this._positionCursor=this._positionCursor.bind(this),this._removeOption=this._removeOption.bind(this),this.setText=this.setText.bind(this),this._setButtonText=this._setButtonText.bind(this),!this.multiple){const e=Array.from(this.el.options).some(e=>e.selected);if(this._options.useLabelAsButton&&!e){var i;const e=document.createElement("option");e.innerText=null!==(i=null==(n=this.label)?void 0:n.innerText)&&void 0!==i?i:"",e.setAttribute("value",""),e.setAttribute("selected","selected"),e.setAttribute("disabled","disabled"),e.setAttribute("hidden","hidden"),this.el.options.add(e,0)}}this.originalOptions=Zd(Array.from(this.el.options).map(Qd)),this.updatedOriginalOptions=Zd(this.originalOptions),this.currentOptions=Zd(this.originalOptions),this._disable(),this.button=this._createButton(),this._setButtonText(),this.clearButton=this._createClearButton(),this.liveZone=this._createLiveZone(),this.overlay=this._createOverlay(),this.wrap=this._wrap(),this.multiple&&this._options.showSelected&&(this.selectedList=this._createSelectedList(),this._updateSelectedList(),this.selectedList.addEventListener("click",this._removeOption)),this.button.addEventListener("click",this._handleOpener),this.clearButton.addEventListener("click",this._handleClear),this.wrap.addEventListener("keydown",this._handleKeyboard),document.addEventListener("blur",this._handleFocus,!0),this.el.form&&this.el.form.addEventListener("reset",this._handleReset)}setText(e){Object.assign(this._options.text,e)}selectOption(e,t=!0){const n=this.currentOptions.findIndex(t=>t.value===e);if(-1===n)return;const r=!this.multiple;this._toggleSelection(n,r,t)}selectOptionSilently(e){this.selectOption(e,false)}_createButton(){var e;const t=document.createElement("button");t.setAttribute("type","button"),t.setAttribute("aria-expanded",this.open?"true":"false"),t.className="select-a11y-button";const n=document.createElement("span");return n.className="select-a11y-button__text",this.label&&!this.label.id&&(this.label.id=`${this.el.id}-label`),t.setAttribute("id",this.el.id+"-button"),t.setAttribute("aria-labelledby",(null==(e=this.label)?void 0:e.id)+" "+t.id),n.innerHTML="&nbsp;",t.appendChild(n),t.insertAdjacentHTML("beforeend",'<span class="select-a11y-button__icon" aria-hidden="true"></span>'),t}_createClearButton(){const e=document.createElement("button");return e.setAttribute("type","button"),e.setAttribute("aria-label",this._options.text.clear),e.className="select-a11y-button__clear",e}_createLiveZone(){const e=document.createElement("p");return e.setAttribute("aria-live","polite"),e.classList.add("sr-only"),e}_createOverlay(){const e=document.createElement("div");e.classList.add("select-a11y__overlay");const t=document.createElement("div");return t.classList.add("select-a11y-suggestions"),t.id=`a11y-${this.id}-suggestions`,e.innerHTML=`\n      <p id="a11y-usage-${this.id}-js" class="sr-only">${this._options.text.help}</p>\n      <label for="a11y-${this.id}-js" class="sr-only">${this._options.text.placeholder}</label>\n      <input type="search" id="a11y-${this.id}-js" class="select-a11y__input ${this.el.className}" autocomplete="off" autocapitalize="off" spellcheck="false" placeholder="${this._options.text.placeholder}" aria-describedby="a11y-usage-${this.id}-js">\n    `,e.appendChild(t),this.list=t,this.list.addEventListener("click",this._handleSuggestionClick),this.input=e.querySelector("input"),this.input&&(this.input.addEventListener("input",this._handleInput),this.input.addEventListener("focus",this._positionCursor,!0)),e}_createSelectedList(){const e=document.createElement("ul");return e.className="select-a11y__selected-list",e}_disable(){this.el.setAttribute("tabindex","-1")}_mapToSuggestion(e){return{hidden:e.hidden,disabled:e.disabled,selected:e.hasAttribute("selected"),label:e.label,value:e.value,image:e.dataset.image,alt:e.dataset.alt,helper:e.dataset.helper,description:e.dataset.description,showIcon:e.dataset.showIcon,group:e.dataset.group,link:e.dataset.link,linkText:e.dataset.linkText}}_mapToOption(e){const t=document.createElement("option");return t.label=e.label,t.value=e.value,e.hidden&&t.setAttribute("hidden","hidden"),e.disabled&&t.setAttribute("disabled","disabled"),e.selected&&t.setAttribute("selected","selected"),e.image&&(t.dataset.image=e.image),e.alt&&(t.dataset.alt=e.alt),e.description&&(t.dataset.description=e.description),e.helper&&(t.dataset.helper=e.helper),e.showIcon&&(t.dataset.showIcon=e.showIcon),e.group&&(t.dataset.group=e.group),e.link&&(t.dataset.link=e.link),e.linkText&&(t.dataset.linkText=e.linkText),t}_defaultSearch(e,t){const n=t.filter(t=>-1!==(t.label||t.value).toLocaleLowerCase().indexOf(e)).map(this._mapToSuggestion);return Promise.resolve(n)}async _fillSuggestions(){const e=this.search.toLowerCase(),t=await this._options.fillSuggestions(e,this.updatedOriginalOptions);this.currentOptions=t.map(this._mapToOption),this.el.replaceChildren(...this._fillSelect(this.currentOptions));const n=t.map((e,t)=>{const n=document.createElement("div");n.setAttribute("role","option"),n.setAttribute("tabindex","0"),n.setAttribute("data-index",t.toString()),e.hidden&&n.setAttribute("data-hidden","hidden"),e.disabled&&n.setAttribute("data-disabled","disabled"),n.classList.add("select-a11y-suggestion");const r=document.createElement("div");r.classList.add("select-a11y-column"),n.appendChild(r);const o=document.createElement("div");if(o.classList.add("select-a11y-suggestion__label"),o.innerText=e.label||e.value,r.appendChild(o),e.selected&&n.setAttribute("aria-selected","true"),e.description){const t=document.createElement("div");t.classList.add("select-a11y-suggestion__description"),e.showIcon&&t.setAttribute("data-show-icon","true"),t.innerText=e.description,r.appendChild(t)}if(e.helper){const t=document.createElement("div");t.classList.add("column--right"),n.appendChild(t);const r=document.createElement("code");r.classList.add("select-a11y-suggestion__helper"),r.innerText=e.helper,t.appendChild(r)}else if(e.link){const t=document.createElement("div");t.classList.add("column--right"),n.appendChild(t);const r=document.createElement("a");r.target="_blank",r.innerText=e.linkText,r.href=e.link,t.appendChild(r)}if(e.image){const t=document.createElement("img");t.setAttribute("src",e.image),t.setAttribute("alt",e.alt?e.alt:""),t.classList.add("select-a11y-suggestion__image"),n.prepend(t)}return{suggestionElement:n,group:e.group}}).filter(e=>!e.suggestionElement.dataset.disabled&&!e.suggestionElement.dataset.hidden),r=[],o={};if(n.forEach(({suggestionElement:e,group:t})=>{if(t){if(!o[t]){const e=document.createElement("div");e.setAttribute("role","group"),o[t]=e;const n=document.createElement("div");n.setAttribute("role","presentation"),n.innerHTML=t,e.appendChild(n)}o[t].appendChild(e)}else r.push(e)}),this.suggestions=n.map(({suggestionElement:e})=>e),this.list)if(this.suggestions.length){const e=document.createElement("div");e.setAttribute("role","listbox"),this.multiple&&e.setAttribute("aria-multiselectable","true"),Object.values(r).forEach(t=>{e.appendChild(t)}),Object.values(o).forEach(t=>{e.appendChild(t)}),this.list.innerHTML="",this.list.appendChild(e)}else this.list.innerHTML=`<p class="select-a11y__no-suggestion">${this._options.text.noResult}</p>`;return this._setLiveZone(),t}_fillSelect(e){const t=[];return e.forEach(e=>{const n=e.dataset.group;if(n){if(!t.find(e=>"OPTGROUP"===e.tagName&&e.label===n)){const e=document.createElement("optgroup");e.label=n,t.push(e)}t[t.length-1].appendChild(e)}else t.push(e)}),t}_handleOpener(e){this._toggleOverlay()}_handleFocus(){this.open&&(clearTimeout(this._focusTimeout),this._focusTimeout=setTimeout(()=>{if(this.overlay.contains(document.activeElement)||this.button===document.activeElement)if(document.activeElement===this.input)this.focusIndex=null;else{const e=this.suggestions.indexOf(document.activeElement);-1!==e&&(this.focusIndex=e)}else this._toggleOverlay(!1,document.activeElement===document.body)},10))}_handleClear(){this.el.value="",this._handleReset()}_handleReset(){clearTimeout(this._resetTimeout),this._resetTimeout=setTimeout(async()=>{this.search="",this.updatedOriginalOptions=Zd(this.originalOptions),this.currentOptions=Zd(this.originalOptions),this.el.dispatchEvent(new Event("reset")),await this._fillSuggestions(),this.el.dispatchEvent(new Event("change")),this._setButtonText(),this.multiple&&this._options.showSelected&&this._updateSelectedList()},10)}_handleSuggestionClick(e){const t=Xd.call(e.target,'[role="option"]');if(!t)return;const n=parseInt(t.getAttribute("data-index"),10),r=!(this.multiple&&e.metaKey);this._toggleSelection(n,r)}_handleInput(){var e,t,n;this.search!==(null==(t=this.input)?void 0:t.value)&&(this.search=null!==(e=null==(n=this.input)?void 0:n.value)&&void 0!==e?e:"",this._fillSuggestions())}_handleKeyboard(e){const t=Xd.call(e.target,'[role="option"]'),n=Xd.call(e.target,"input");if(27!==e.keyCode)if(n&&13===e.keyCode)e.preventDefault();else{if(40===e.keyCode)return e.preventDefault(),void this._moveIndex(1);if(t){if(39===e.keyCode)return e.preventDefault(),void this._moveIndex(1);if(37===e.keyCode||38===e.keyCode)return e.preventDefault(),void this._moveIndex(-1);(!this.multiple&&13===e.keyCode||32===e.keyCode)&&(e.preventDefault(),this._toggleSelection(parseInt(t.getAttribute("data-index"),10),!this.multiple)),this.multiple&&13===e.keyCode&&this._toggleOverlay()}}else this._toggleOverlay()}_moveIndex(e){if(null===this.focusIndex)this.focusIndex=0;else{const t=this.focusIndex+e,n=this.suggestions.length-1;this.focusIndex=t>n?0:t<0?n:t}this.suggestions[this.focusIndex].focus()}_positionCursor(){setTimeout(()=>{if(this.input){var e;const t=null!==(e=this.input.value.length)&&void 0!==e?e:0;this.input.setSelectionRange(t,t)}})}_removeOption(e){var t,n;const r=Xd.call(e.target,"button");if(!r)return;const o=null==(t=this.selectedList)?void 0:t.querySelectorAll("button"),i=Array.prototype.indexOf.call(o,r)-1,a=parseInt(r.getAttribute("data-index"),10);if(this._toggleSelection(a),null!=(n=this.selectedList)&&n.parentElement){const e=this.selectedList.querySelectorAll("button");e[i]?e[i].focus():e[0].focus()}else this.button.focus()}_setButtonText(){var e;const t=this.el.item(this.el.selectedIndex),n=this.button.firstElementChild;t&&t.value?this.button.classList.remove("select-a11y-button--no-selected-option"):this.button.classList.add("select-a11y-button--no-selected-option"),this.multiple?this._options.useLabelAsButton?n.innerText=(null==(e=this.label)?void 0:e.innerText)||"":n.innerHTML="&nbsp;":t&&(n.innerText=t.label||t.value)}_setLiveZone(){const e=this.suggestions.length;let t="";this.open&&(t=e?this._options.text.results.replace("{x}",e):this._options.text.noResult),this.liveZone.innerText=t}_toggleOverlay(e,t){var n;this.open=void 0!==e?e:!this.open,this.button.setAttribute("aria-expanded",this.open?"true":"false"),this.open?(this._fillSuggestions(),this.button.insertAdjacentElement("afterend",this.overlay),null==(n=this.input)||n.focus()):this.wrap.contains(this.overlay)&&(this.wrap.removeChild(this.overlay),this.focusIndex=null,this.input&&this._options.fillSuggestions===this._defaultSearch&&(this.input.value=""),this.search="",this._setLiveZone(),(void 0===e||t)&&setTimeout(()=>{this.button.focus()}))}_toggleSelection(e,t=!0,n=!0){const r=this.el.item(e);this.multiple?null!=r&&r.hasAttribute("selected")?r.removeAttribute("selected"):null==r||r.setAttribute("selected","selected"):(null==r||r.setAttribute("selected","selected"),this.el.selectedIndex=e),this.updatedOriginalOptions=this.updatedOriginalOptions.map(e=>(e.value===(null==r?void 0:r.value)&&(r.hasAttribute("selected")?e.setAttribute("selected","selected"):e.removeAttribute("selected")),!this.multiple&&e.value!==(null==r?void 0:r.value)&&e.removeAttribute("selected"),e)),this.currentOptions=this.currentOptions.map(e=>(e.value===(null==r?void 0:r.value)&&(r.hasAttribute("selected")?e.setAttribute("selected","selected"):e.removeAttribute("selected")),!this.multiple&&e.value!==(null==r?void 0:r.value)&&e.removeAttribute("selected"),e)),this.suggestions=this.suggestions.map(e=>{var t;const n=parseInt(null!==(t=e.getAttribute("data-index"))&&void 0!==t?t:"",10),r=this.el.item(n);return r&&r.selected?e.setAttribute("aria-selected","true"):e.removeAttribute("aria-selected"),e}),n&&this.el.dispatchEvent(new Event("change")),this._setButtonText(),this.multiple&&this._options.showSelected&&this._updateSelectedList(),t&&this.open&&this._toggleOverlay()}_updateSelectedList(){var e;const t=this.currentOptions.map((e,t)=>{if(!e.selected||e.hidden)return;const n=e.label||e.value;return`\n        <li class="select-a11y__selected-item">\n          <span>${n}</span>\n          <button class="select-a11y-delete" title="${this._options.text.deleteItem.replace("{t}",n)}" type="button" data-index="${t}">\n            <span class="sr-only">${this._options.text.delete}</span>\n            <span class="select-a11y-delete__icon" aria-hidden="true"></span>\n          </button>\n        </li>`}).filter(Boolean);this.selectedList&&(this.selectedList.innerHTML=t.join(""),t.length?null!=(e=this.selectedList)&&e.parentElement||this.wrap.appendChild(this.selectedList):this.selectedList.parentElement&&this.wrap.removeChild(this.selectedList))}_wrap(){var e;const t=document.createElement("div");t.classList.add("select-a11y"),null==(e=this.el.parentElement)||e.appendChild(t);const n=document.createElement("div");return n.classList.add("select-a11y__hidden"),n.setAttribute("aria-hidden","true"),this._options.useLabelAsButton&&n.appendChild(this.label),n.appendChild(this.el),t.appendChild(n),t.appendChild(this.liveZone),t.appendChild(this.button),this._options.clearable&&t.appendChild(this.clearButton),t}}const tp=Ye({props:{required:{type:Boolean,required:!0}}}),np={key:0,class:"required-field-star"};const rp=An(tp,[["render",function(e,t,n,r,o,i){return e.required?(Ze(),Qe("span",np,"*")):st("",!0)}]]),op=Ye({components:{Required:rp},emits:["change"],props:{addAllOption:{type:Boolean,default:!0},allOption:{type:String,default:""},emptyPlaceholder:{type:String},entityUrl:{type:String},errorText:{type:String,default:""},explanation:{type:String,default:""},hasError:{type:Boolean,default:!1},hasWarning:{type:Boolean,default:!1},hintText:{type:String,default:""},isBlue:{type:Boolean,default:!1},initialOptions:Promise,isValid:{type:Boolean,default:!1},listUrl:{type:String},minimumCharacterBeforeSuggest:{type:Number,default:1},placeholder:{type:String,required:!0},required:{type:Boolean,default:!1},searchPlaceholder:{type:String,required:!0},suggestUrl:{type:String},values:{type:[Array,String]},multiple:{type:Boolean,default:!1},addNewOption:{type:Boolean,default:!1},helperLabel:{type:String,default:""},groups:{type:Array,default:null},onSuggest:{type:Function,default:null},showDescription:{type:Boolean,default:!1},roundedImages:{type:Boolean,default:!1}},setup(e,{emit:t}){const{t:n}=H(),{toast:r}=_u(),{id:o}=Bc("multiselect"),i=Xe(()=>o+"-desc-error"),a=Xe(()=>o+"-desc-valid"),s=Xe(()=>({"fr-select-group--error":e.hasError,"fr-select-group--warning":!e.hasError&&e.hasWarning,"fr-select-group--valid":e.isValid,"multiselect--rounded-images":e.roundedImages,"multiselect--align-center":!e.showDescription})),l=Jr("selectRef"),c=ct(null),u=ct(0),d=ct([]),p=ct([]),h=Xe(()=>d.value.slice(0,20)),f=ct(e.multiple?[]:null),m=ct(null),g=ct(null),v=Xe(()=>e.emptyPlaceholder||n("No results found.")),y=$t({help:n("Use tab (or arrow down) to move between suggestions"),placeholder:e.searchPlaceholder,noResult:v.value,results:n("{x} available suggestion"),deleteItem:n("Delete {t}"),delete:n("Delete")}),w=t=>t.map(t=>{var n,r,o,i,a,s,l,c,u,d,p,h,f,m,g;return{label:null!==(n=null!==(r=null!==(o=null!==(i=null!==(a=t.name)&&void 0!==a?a:t.title)&&void 0!==i?i:t.text)&&void 0!==o?o:null==t||null===(s=t.properties)||void 0===s?void 0:s.name)&&void 0!==r?r:t.label)&&void 0!==n?n:t,value:null!==(l=null!==(c=null!==(u=t.id)&&void 0!==u?u:t.text)&&void 0!==c?c:t.value)&&void 0!==l?l:t,image:null!==(d=null!==(p=null!==(h=null!==(f=null!==(m=t.logo_thumbnail)&&void 0!==m?m:t.logo)&&void 0!==f?f:t.image_url)&&void 0!==h?h:t.image)&&void 0!==p?p:t.avatar_thumbnail)&&void 0!==d?d:t.avatar,hidden:t.hidden,selected:!!t.selected,helper:null!=t&&t.code?e.helperLabel+t.code:null==t?void 0:t.helper,description:e.showDescription&&null!==(g=null==t?void 0:t.description)&&void 0!==g?g:"",group:null==t?void 0:t.group,recommended:null==t?void 0:t.recommended}}),b=t=>t.length<e.minimumCharacterBeforeSuggest?(async()=>e.initialOptions?e.initialOptions:e.listUrl?T.get(e.listUrl).then(t=>{let n=t.data;if(Array.isArray(n)||(n=n.data),e.groups){const t=n.map(t=>{const n=e.groups.find(e=>e.values.some(e=>e.value===t.id));if(n){const e=n.values.find(e=>e.value===t.id);if(e)return M(M({},t),{},{group:n.name,description:e.description||null,recommended:e.recommended,code:e.code})}return t});return w(t)}return w(n)}).catch(t=>(X.isCancel(t)||r.error(n("Error getting {type}.",{type:e.placeholder})),[])):p.value)():e.suggestUrl?(m.value&&m.value.cancel(),m.value=pe(),T.get(e.suggestUrl,{params:{q:t,size:20},cancelToken:m.value.token}).then(t=>e.onSuggest?e.onSuggest(t.data):t.data).then(n=>(e.addNewOption&&!n.some(e=>e.text===t)&&n.push({text:t}),w(n))).catch(t=>(X.isCancel(t)||r.error(n("Error getting {type}.",{type:e.placeholder})),[]))):(async(e="")=>{const t=d.value.filter(t=>-1!==(t.label||t.value).toLocaleLowerCase().indexOf(e)).slice(0,20);return w(t)})(t),k=(e="")=>b(e).then(C),x=(e="")=>k(e).then(e=>(p.value=e,e.slice(0,20))),C=t=>{const n=[...t].map(e=>(e.selected=!1,e));if(e.allOption){n.find(e=>!e.value)||n.unshift({label:e.allOption,value:"",hidden:!e.addAllOption})}let r=[];r=Array.isArray(f.value)?f.value:[f.value];for(let e of r)if("string"==typeof e){const t=n.findIndex(t=>t.value===e),r=p.value.find(t=>t.value===e);r&&(r.selected=!0,-1===t?n.unshift(r):n[t].selected=!0)}return w(n)},S=()=>{let t=[],o=ht((e=>{const t=ct(null);return("string"==typeof e||Array.isArray(e))&&(t.value=e),t})(e.values));if(Array.isArray(o))for(let e of o)t.push(O(e));else t.push(O(o));return Promise.all(t).then(t=>(e.multiple?f.value=t.filter(e=>null!==e):f.value=t[0],f.value)).catch(t=>(X.isCancel(t)||r.error(n("Error getting {type}.",{type:e.placeholder})),[]))},O=t=>{let o=null;if(t&&e.entityUrl)o=T.get(`${e.entityUrl}${t}/`).then(e=>e.data).then(e=>w([e])).then(e=>{var n,r;return null!==(n=null===(r=e[0])||void 0===r?void 0:r.label)&&void 0!==n?n:t}).then(e=>{p.value.every(e=>e.value!==t)&&p.value.push({label:e,value:t})}).then(()=>t);else{var i,a;let e=p.value.find(e=>e.value===t);t&&!e&&(e={label:t,value:t},p.value.push(e)),o=Promise.resolve(null!==(i=null===(a=e)||void 0===a?void 0:a.value)&&void 0!==i?i:null)}return o.then(e=>null!=e?e:"").catch(t=>(X.isCancel(t)||r.error(n("Error getting {type}.",{type:e.placeholder})),""))},_=()=>{if(l.value)if(e.multiple){const e=Array.from(l.value.selectedOptions).map(e=>e.value);f.value=e,t("change",e)}else f.value=l.value.value,t("change",l.value.value)},N=()=>{l.value&&(e.multiple?f.value=[]:f.value=null)},E=()=>{D(),A(),$()},D=()=>{if(!c.value)return;let e=c.value.getBoundingClientRect(),t=350;window.innerWidth<t&&(t=Math.min(350,e.width));let n=window.innerWidth-e.x<t;u.value=n?t-e.width:0;const r=c.value.style;r.setProperty("--offset-select-a11y__overlay",`-${u.value}px`),r.setProperty("--min-width-select-a11y__overlay",`${t}px`)},A=()=>{if(!c.value)return;const t=c.value.querySelector(".select-a11y");t&&(t.classList.add("fr-select"),e.isBlue&&t.classList.add("fr-select--blue"));const n=c.value.querySelector("label");n&&n.classList.add("fr-label");const r=c.value.querySelector(".select-a11y-button__text");r&&!r.innerHTML&&(r.innerHTML="&nbsp;")},$=()=>{c.value&&l.value&&(l.value.removeEventListener("change",_),l.value.addEventListener("change",_),l.value.removeEventListener("reset",N),l.value.addEventListener("reset",N))},R=()=>{const e={text:y,clearable:!0};e.fillSuggestions=x;try{g.value=new ep(l.value,e),E()}catch(Yo){console.log(Yo)}};ft(()=>e.values,async()=>{const e=f.value;await S();const t=(n=f.value,r=e,Array.isArray(n)&&Array.isArray(r)?[...n.filter(e=>!r.includes(e))]:n===r?[]:[n]);var n,r;for(const i of t){var o;null===(o=g.value)||void 0===o||o.selectOptionSilently(i)}});const L=k().then(e=>(d.value=e,p.value=e,e)).then(S);return mt(()=>L.then(R)),kt(E),{container:c,displayedOptions:h,errorTextId:i,id:o,offset:u,selected:f,selectGroupClass:s,selectOption:async function(e){var t;await x(e),null===(t=g.value)||void 0===t||t.selectOptionSilently(e),f.value=e},validTextId:a}}}),ip=["data-selected"],ap=["for","title"],sp={key:0,class:"fr-icon-information-line","aria-hidden":"true"},lp={key:1,class:"fr-hint-text"},cp=["id","required","multiple"],up=["label"],dp=["value","data-image","hidden","data-helper","data-description","data-show-icon"],pp=["value","data-image","hidden","data-helper","data-description","data-show-icon"],hp=["value","data-image","hidden","data-helper","data-description","data-show-icon"],fp=["id"],mp=["id"];const gp=An(op,[["render",function(e,t,n,r,o,i){const a=jt("Required");return Ze(),Qe("div",{class:lt(["multiselect w-100 fr-select-group",e.selectGroupClass]),ref:"container","data-selected":!!e.selected},[dt("div",null,[dt("label",{for:e.id,title:e.explanation},[Tt(pt(e.placeholder)+" ",1),ut(a,{required:e.required},null,8,["required"]),e.explanation?(Ze(),Qe("span",sp)):st("",!0),e.hintText?(Ze(),Qe("span",lp,pt(e.hintText),1)):st("",!0)],8,ap),Vt(dt("select",{class:"multiselect__input",id:e.id,ref:"selectRef","onUpdate:modelValue":t[0]||(t[0]=t=>e.selected=t),required:e.required,multiple:e.multiple},[e.groups?(Ze(),Qe(Mt,{key:0},[(Ze(!0),Qe(Mt,null,Pt(e.groups,t=>(Ze(),Qe("optgroup",{label:t.name},[(Ze(!0),Qe(Mt,null,Pt(e.displayedOptions,e=>(Ze(),Qe(Mt,{key:e.value},[t.name==e.group?(Ze(),Qe("option",{key:0,value:e.value,"data-image":e.image,hidden:e.hidden,"data-helper":e.helper,"data-description":e.description,"data-show-icon":e.recommended},pt(e.label),9,dp)):st("",!0)],64))),128))],8,up))),256)),(Ze(!0),Qe(Mt,null,Pt(e.displayedOptions,e=>(Ze(),Qe(Mt,{key:e.value},[e.group?st("",!0):(Ze(),Qe("option",{key:0,value:e.value,"data-image":e.image,hidden:e.hidden,"data-helper":e.helper,"data-description":e.description,"data-show-icon":e.recommended},pt(e.label),9,pp))],64))),128))],64)):(Ze(!0),Qe(Mt,{key:1},Pt(e.displayedOptions,e=>(Ze(),Qe("option",{key:e.value,value:e.value,"data-image":e.image,hidden:e.hidden,"data-helper":e.helper,"data-description":e.description,"data-show-icon":e.recommended},pt(e.label),9,hp))),128))],8,cp),[[Gt,e.selected]])]),e.isValid?(Ze(),Qe("p",{key:0,id:e.validTextId,class:"fr-valid-text"},pt(e.validText),9,fp)):e.hasError?(Ze(),Qe("p",{key:1,id:e.errorTextId,class:"fr-error-text"},pt(e.errorText),9,mp)):st("",!0)],10,ip)}],["__scopeId","data-v-9b8f38b5"]]),vp=Ye({__name:"SchemaSelect",props:{allOption:{default:""},isBlue:{type:Boolean,default:!1},showExplanation:{type:Boolean,default:!0},values:{}},emits:["change"],setup(e,{emit:t}){const n=t,r=hn().then(e=>e.map(e=>({label:e.name,value:e.name}))),o=e=>n("change",e);return(t,n)=>(Ze(),nt(gp,{placeholder:t.$t("Schema"),explanation:e.showExplanation?t.$t("Data schemas describe data models: what are the fields, how are data shown, what are the available values, etc. See schema.data.gouv.fr"):"",searchPlaceholder:t.$t("Search a schema..."),allOption:e.allOption?e.allOption:t.$t("All schemas"),initialOptions:rt(r),values:e.values,onChange:o,isBlue:e.isBlue},null,8,["placeholder","explanation","searchPlaceholder","allOption","initialOptions","values","isBlue"]))}});function yp(e){return yp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yp(e)}function wp(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function bp(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function kp(e){bp(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===yp(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}function xp(e,t){bp(2,arguments);var n=kp(e),r=wp(t);if(isNaN(r))return new Date(NaN);if(!r)return n;var o=n.getDate(),i=new Date(n.getTime());return i.setMonth(n.getMonth()+r+1,0),o>=i.getDate()?i:(n.setFullYear(i.getFullYear(),i.getMonth(),o),n)}var Cp={};function Sp(){return Cp}function Mp(e,t){var n,r,o,i,a,s,l,c;bp(1,arguments);var u=Sp(),d=wp(null!==(n=null!==(r=null!==(o=null!==(i=null==t?void 0:t.weekStartsOn)&&void 0!==i?i:null==t||null===(a=t.locale)||void 0===a||null===(s=a.options)||void 0===s?void 0:s.weekStartsOn)&&void 0!==o?o:u.weekStartsOn)&&void 0!==r?r:null===(l=u.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.weekStartsOn)&&void 0!==n?n:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var p=kp(e),h=p.getDay(),f=(h<d?7:0)+h-d;return p.setDate(p.getDate()-f),p.setHours(0,0,0,0),p}function Tp(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function Op(e){bp(1,arguments);var t=kp(e);return t.setHours(0,0,0,0),t}function _p(e,t){return bp(2,arguments),xp(e,12*wp(t))}function Np(e,t){bp(2,arguments);var n=Op(e),r=Op(t);return n.getTime()===r.getTime()}function Ep(e){if(bp(1,arguments),!function(e){return bp(1,arguments),e instanceof Date||"object"===yp(e)&&"[object Date]"===Object.prototype.toString.call(e)}(e)&&"number"!=typeof e)return!1;var t=kp(e);return!isNaN(Number(t))}function Dp(e){bp(1,arguments);var t=kp(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function Ap(e){bp(1,arguments);var t=kp(e);return t.setSeconds(0,0),t}function $p(e){bp(1,arguments);var t=kp(e);return t.setDate(1),t.setHours(0,0,0,0),t}function Rp(e,t){var n,r,o,i,a,s,l,c;bp(1,arguments);var u=Sp(),d=wp(null!==(n=null!==(r=null!==(o=null!==(i=null==t?void 0:t.weekStartsOn)&&void 0!==i?i:null==t||null===(a=t.locale)||void 0===a||null===(s=a.options)||void 0===s?void 0:s.weekStartsOn)&&void 0!==o?o:u.weekStartsOn)&&void 0!==r?r:null===(l=u.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.weekStartsOn)&&void 0!==n?n:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var p=kp(e),h=p.getDay(),f=6+(h<d?-7:0)-(h-d);return p.setDate(p.getDate()+f),p.setHours(23,59,59,999),p}function Lp(e,t){return bp(2,arguments),function(e,t){bp(2,arguments);var n=kp(e).getTime(),r=wp(t);return new Date(n+r)}(e,-wp(t))}function Ip(e){bp(1,arguments);var t=kp(e),n=t.getUTCDay(),r=(n<1?7:0)+n-1;return t.setUTCDate(t.getUTCDate()-r),t.setUTCHours(0,0,0,0),t}function Pp(e){bp(1,arguments);var t=kp(e),n=t.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(n+1,0,4),r.setUTCHours(0,0,0,0);var o=Ip(r),i=new Date(0);i.setUTCFullYear(n,0,4),i.setUTCHours(0,0,0,0);var a=Ip(i);return t.getTime()>=o.getTime()?n+1:t.getTime()>=a.getTime()?n:n-1}function zp(e){bp(1,arguments);var t=kp(e),n=Ip(t).getTime()-function(e){bp(1,arguments);var t=Pp(e),n=new Date(0);return n.setUTCFullYear(t,0,4),n.setUTCHours(0,0,0,0),Ip(n)}(t).getTime();return Math.round(n/6048e5)+1}function Bp(e,t){var n,r,o,i,a,s,l,c;bp(1,arguments);var u=Sp(),d=wp(null!==(n=null!==(r=null!==(o=null!==(i=null==t?void 0:t.weekStartsOn)&&void 0!==i?i:null==t||null===(a=t.locale)||void 0===a||null===(s=a.options)||void 0===s?void 0:s.weekStartsOn)&&void 0!==o?o:u.weekStartsOn)&&void 0!==r?r:null===(l=u.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.weekStartsOn)&&void 0!==n?n:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var p=kp(e),h=p.getUTCDay(),f=(h<d?7:0)+h-d;return p.setUTCDate(p.getUTCDate()-f),p.setUTCHours(0,0,0,0),p}function Fp(e,t){var n,r,o,i,a,s,l,c;bp(1,arguments);var u=kp(e),d=u.getUTCFullYear(),p=Sp(),h=wp(null!==(n=null!==(r=null!==(o=null!==(i=null==t?void 0:t.firstWeekContainsDate)&&void 0!==i?i:null==t||null===(a=t.locale)||void 0===a||null===(s=a.options)||void 0===s?void 0:s.firstWeekContainsDate)&&void 0!==o?o:p.firstWeekContainsDate)&&void 0!==r?r:null===(l=p.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==n?n:1);if(!(h>=1&&h<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var f=new Date(0);f.setUTCFullYear(d+1,0,h),f.setUTCHours(0,0,0,0);var m=Bp(f,t),g=new Date(0);g.setUTCFullYear(d,0,h),g.setUTCHours(0,0,0,0);var v=Bp(g,t);return u.getTime()>=m.getTime()?d+1:u.getTime()>=v.getTime()?d:d-1}function jp(e,t){bp(1,arguments);var n=kp(e),r=Bp(n,t).getTime()-function(e,t){var n,r,o,i,a,s,l,c;bp(1,arguments);var u=Sp(),d=wp(null!==(n=null!==(r=null!==(o=null!==(i=null==t?void 0:t.firstWeekContainsDate)&&void 0!==i?i:null==t||null===(a=t.locale)||void 0===a||null===(s=a.options)||void 0===s?void 0:s.firstWeekContainsDate)&&void 0!==o?o:u.firstWeekContainsDate)&&void 0!==r?r:null===(l=u.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==n?n:1),p=Fp(e,t),h=new Date(0);return h.setUTCFullYear(p,0,d),h.setUTCHours(0,0,0,0),Bp(h,t)}(n,t).getTime();return Math.round(r/6048e5)+1}function Vp(e,t){for(var n=e<0?"-":"",r=Math.abs(e).toString();r.length<t;)r="0"+r;return n+r}const qp={y:function(e,t){var n=e.getUTCFullYear(),r=n>0?n:1-n;return Vp("yy"===t?r%100:r,t.length)},M:function(e,t){var n=e.getUTCMonth();return"M"===t?String(n+1):Vp(n+1,2)},d:function(e,t){return Vp(e.getUTCDate(),t.length)},a:function(e,t){var n=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:function(e,t){return Vp(e.getUTCHours()%12||12,t.length)},H:function(e,t){return Vp(e.getUTCHours(),t.length)},m:function(e,t){return Vp(e.getUTCMinutes(),t.length)},s:function(e,t){return Vp(e.getUTCSeconds(),t.length)},S:function(e,t){var n=t.length,r=e.getUTCMilliseconds();return Vp(Math.floor(r*Math.pow(10,n-3)),t.length)}};var Hp="midnight",Up="noon",Wp="morning",Kp="afternoon",Yp="evening",Jp="night",Gp={G:function(e,t,n){var r=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if("yo"===t){var r=e.getUTCFullYear(),o=r>0?r:1-r;return n.ordinalNumber(o,{unit:"year"})}return qp.y(e,t)},Y:function(e,t,n,r){var o=Fp(e,r),i=o>0?o:1-o;return"YY"===t?Vp(i%100,2):"Yo"===t?n.ordinalNumber(i,{unit:"year"}):Vp(i,t.length)},R:function(e,t){return Vp(Pp(e),t.length)},u:function(e,t){return Vp(e.getUTCFullYear(),t.length)},Q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return Vp(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return Vp(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){var r=e.getUTCMonth();switch(t){case"M":case"MM":return qp.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){var r=e.getUTCMonth();switch(t){case"L":return String(r+1);case"LL":return Vp(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){var o=jp(e,r);return"wo"===t?n.ordinalNumber(o,{unit:"week"}):Vp(o,t.length)},I:function(e,t,n){var r=zp(e);return"Io"===t?n.ordinalNumber(r,{unit:"week"}):Vp(r,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getUTCDate(),{unit:"date"}):qp.d(e,t)},D:function(e,t,n){var r=function(e){bp(1,arguments);var t=kp(e),n=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var r=n-t.getTime();return Math.floor(r/864e5)+1}(e);return"Do"===t?n.ordinalNumber(r,{unit:"dayOfYear"}):Vp(r,t.length)},E:function(e,t,n){var r=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){var o=e.getUTCDay(),i=(o-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Vp(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(o,{width:"short",context:"formatting"});default:return n.day(o,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){var o=e.getUTCDay(),i=(o-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Vp(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(o,{width:"narrow",context:"standalone"});case"cccccc":return n.day(o,{width:"short",context:"standalone"});default:return n.day(o,{width:"wide",context:"standalone"})}},i:function(e,t,n){var r=e.getUTCDay(),o=0===r?7:r;switch(t){case"i":return String(o);case"ii":return Vp(o,t.length);case"io":return n.ordinalNumber(o,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){var r=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){var r,o=e.getUTCHours();switch(r=12===o?Up:0===o?Hp:o/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){var r,o=e.getUTCHours();switch(r=o>=17?Yp:o>=12?Kp:o>=4?Wp:Jp,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){var r=e.getUTCHours()%12;return 0===r&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return qp.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getUTCHours(),{unit:"hour"}):qp.H(e,t)},K:function(e,t,n){var r=e.getUTCHours()%12;return"Ko"===t?n.ordinalNumber(r,{unit:"hour"}):Vp(r,t.length)},k:function(e,t,n){var r=e.getUTCHours();return 0===r&&(r=24),"ko"===t?n.ordinalNumber(r,{unit:"hour"}):Vp(r,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):qp.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):qp.s(e,t)},S:function(e,t){return qp.S(e,t)},X:function(e,t,n,r){var o=(r._originalDate||e).getTimezoneOffset();if(0===o)return"Z";switch(t){case"X":return Zp(o);case"XXXX":case"XX":return Qp(o);default:return Qp(o,":")}},x:function(e,t,n,r){var o=(r._originalDate||e).getTimezoneOffset();switch(t){case"x":return Zp(o);case"xxxx":case"xx":return Qp(o);default:return Qp(o,":")}},O:function(e,t,n,r){var o=(r._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Xp(o,":");default:return"GMT"+Qp(o,":")}},z:function(e,t,n,r){var o=(r._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Xp(o,":");default:return"GMT"+Qp(o,":")}},t:function(e,t,n,r){var o=r._originalDate||e;return Vp(Math.floor(o.getTime()/1e3),t.length)},T:function(e,t,n,r){return Vp((r._originalDate||e).getTime(),t.length)}};function Xp(e,t){var n=e>0?"-":"+",r=Math.abs(e),o=Math.floor(r/60),i=r%60;if(0===i)return n+String(o);var a=t||"";return n+String(o)+a+Vp(i,2)}function Zp(e,t){return e%60==0?(e>0?"-":"+")+Vp(Math.abs(e)/60,2):Qp(e,t)}function Qp(e,t){var n=t||"",r=e>0?"-":"+",o=Math.abs(e);return r+Vp(Math.floor(o/60),2)+n+Vp(o%60,2)}const eh=Gp;var th=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},nh=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},rh={p:nh,P:function(e,t){var n,r=e.match(/(P+)(p+)?/)||[],o=r[1],i=r[2];if(!i)return th(e,t);switch(o){case"P":n=t.dateTime({width:"short"});break;case"PP":n=t.dateTime({width:"medium"});break;case"PPP":n=t.dateTime({width:"long"});break;default:n=t.dateTime({width:"full"})}return n.replace("{{date}}",th(o,t)).replace("{{time}}",nh(i,t))}};const oh=rh;var ih=["D","DD"],ah=["YY","YYYY"];function sh(e){return-1!==ih.indexOf(e)}function lh(e){return-1!==ah.indexOf(e)}function ch(e,t,n){if("YYYY"===e)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("YY"===e)throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("D"===e)throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("DD"===e)throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var uh={date:he({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:he({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:he({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})};const dh={code:"en-US",formatDistance:fe,formatLong:uh,formatRelative:me,localize:ge,match:ve,options:{weekStartsOn:0,firstWeekContainsDate:1}};var ph=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,hh=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,fh=/^'([^]*?)'?$/,mh=/''/g,gh=/[a-zA-Z]/;function vh(e,t,n){var r,o,i,a,s,l,c,u,d,p,h,f,m,g,v,y,w,b;bp(2,arguments);var k=String(t),x=Sp(),C=null!==(r=null!==(o=null==n?void 0:n.locale)&&void 0!==o?o:x.locale)&&void 0!==r?r:dh,S=wp(null!==(i=null!==(a=null!==(s=null!==(l=null==n?void 0:n.firstWeekContainsDate)&&void 0!==l?l:null==n||null===(c=n.locale)||void 0===c||null===(u=c.options)||void 0===u?void 0:u.firstWeekContainsDate)&&void 0!==s?s:x.firstWeekContainsDate)&&void 0!==a?a:null===(d=x.locale)||void 0===d||null===(p=d.options)||void 0===p?void 0:p.firstWeekContainsDate)&&void 0!==i?i:1);if(!(S>=1&&S<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var M=wp(null!==(h=null!==(f=null!==(m=null!==(g=null==n?void 0:n.weekStartsOn)&&void 0!==g?g:null==n||null===(v=n.locale)||void 0===v||null===(y=v.options)||void 0===y?void 0:y.weekStartsOn)&&void 0!==m?m:x.weekStartsOn)&&void 0!==f?f:null===(w=x.locale)||void 0===w||null===(b=w.options)||void 0===b?void 0:b.weekStartsOn)&&void 0!==h?h:0);if(!(M>=0&&M<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!C.localize)throw new RangeError("locale must contain localize property");if(!C.formatLong)throw new RangeError("locale must contain formatLong property");var T=kp(e);if(!Ep(T))throw new RangeError("Invalid time value");var O=Lp(T,Tp(T)),_={firstWeekContainsDate:S,weekStartsOn:M,locale:C,_originalDate:T};return k.match(hh).map(function(e){var t=e[0];return"p"===t||"P"===t?(0,oh[t])(e,C.formatLong):e}).join("").match(ph).map(function(r){if("''"===r)return"'";var o=r[0];if("'"===o)return function(e){var t=e.match(fh);if(!t)return e;return t[1].replace(mh,"'")}(r);var i=eh[o];if(i)return null!=n&&n.useAdditionalWeekYearTokens||!lh(r)||ch(r,t,String(e)),null!=n&&n.useAdditionalDayOfYearTokens||!sh(r)||ch(r,t,String(e)),i(O,r,C.localize,_);if(o.match(gh))throw new RangeError("Format string contains an unescaped latin alphabet character `"+o+"`");return r}).join("")}function yh(e,t){if(null==e)throw new TypeError("assign requires that input parameter not be null or undefined");for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function wh(e){bp(1,arguments);var t=kp(e).getFullYear();return 10*Math.floor(t/10)}function bh(e){return bp(1,arguments),kp(e).getFullYear()}function kh(e,t){bp(2,arguments);var n=kp(e),r=kp(t);return n.getTime()>r.getTime()}function xh(e,t){bp(2,arguments);var n=kp(e),r=kp(t);return n.getTime()<r.getTime()}function Ch(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Sh(e,t){if(e){if("string"==typeof e)return Ch(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ch(e,t):void 0}}function Mh(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Sh(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Th(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oh(e,t){return Oh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Oh(e,t)}function _h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Oh(e,t)}function Nh(e){return Nh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Nh(e)}function Eh(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Eh=function(){return!!e})()}function Dh(e){var t=Eh();return function(){var n,r=Nh(e);if(t){var o=Nh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"==yp(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Th(e)}(this,n)}}function Ah(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $h(e){var t=function(e,t){if("object"!=yp(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=yp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==yp(t)?t:t+""}function Rh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$h(r.key),r)}}function Lh(e,t,n){return t&&Rh(e.prototype,t),n&&Rh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ih(e,t,n){return(t=$h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ph=function(){function e(){Ah(this,e),Ih(this,"priority",void 0),Ih(this,"subPriority",0)}return Lh(e,[{key:"validate",value:function(e,t){return!0}}]),e}(),zh=function(e){_h(n,e);var t=Dh(n);function n(e,r,o,i,a){var s;return Ah(this,n),(s=t.call(this)).value=e,s.validateValue=r,s.setValue=o,s.priority=i,a&&(s.subPriority=a),s}return Lh(n,[{key:"validate",value:function(e,t){return this.validateValue(e,this.value,t)}},{key:"set",value:function(e,t,n){return this.setValue(e,t,this.value,n)}}]),n}(Ph),Bh=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",10),Ih(Th(e),"subPriority",-1),e}return Lh(n,[{key:"set",value:function(e,t){if(t.timestampIsSet)return e;var n=new Date(0);return n.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),n.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),n}}]),n}(Ph),Fh=function(){function e(){Ah(this,e),Ih(this,"incompatibleTokens",void 0),Ih(this,"priority",void 0),Ih(this,"subPriority",void 0)}return Lh(e,[{key:"run",value:function(e,t,n,r){var o=this.parse(e,t,n,r);return o?{setter:new zh(o.value,this.validate,this.set,this.priority,this.subPriority),rest:o.rest}:null}},{key:"validate",value:function(e,t,n){return!0}}]),e}(),jh=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",140),Ih(Th(e),"incompatibleTokens",["R","u","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){switch(t){case"G":case"GG":case"GGG":return n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"});case"GGGGG":return n.era(e,{width:"narrow"});default:return n.era(e,{width:"wide"})||n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"})}}},{key:"set",value:function(e,t,n){return t.era=n,e.setUTCFullYear(n,0,1),e.setUTCHours(0,0,0,0),e}}]),n}(Fh),Vh=/^(1[0-2]|0?\d)/,qh=/^(3[0-1]|[0-2]?\d)/,Hh=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,Uh=/^(5[0-3]|[0-4]?\d)/,Wh=/^(2[0-3]|[0-1]?\d)/,Kh=/^(2[0-4]|[0-1]?\d)/,Yh=/^(1[0-1]|0?\d)/,Jh=/^(1[0-2]|0?\d)/,Gh=/^[0-5]?\d/,Xh=/^[0-5]?\d/,Zh=/^\d/,Qh=/^\d{1,2}/,ef=/^\d{1,3}/,tf=/^\d{1,4}/,nf=/^-?\d+/,rf=/^-?\d/,of=/^-?\d{1,2}/,af=/^-?\d{1,3}/,sf=/^-?\d{1,4}/,lf=/^([+-])(\d{2})(\d{2})?|Z/,cf=/^([+-])(\d{2})(\d{2})|Z/,uf=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,df=/^([+-])(\d{2}):(\d{2})|Z/,pf=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function hf(e,t){return e?{value:t(e.value),rest:e.rest}:e}function ff(e,t){var n=t.match(e);return n?{value:parseInt(n[0],10),rest:t.slice(n[0].length)}:null}function mf(e,t){var n=t.match(e);return n?"Z"===n[0]?{value:0,rest:t.slice(1)}:{value:("+"===n[1]?1:-1)*(36e5*(n[2]?parseInt(n[2],10):0)+6e4*(n[3]?parseInt(n[3],10):0)+1e3*(n[5]?parseInt(n[5],10):0)),rest:t.slice(n[0].length)}:null}function gf(e){return ff(nf,e)}function vf(e,t){switch(e){case 1:return ff(Zh,t);case 2:return ff(Qh,t);case 3:return ff(ef,t);case 4:return ff(tf,t);default:return ff(new RegExp("^\\d{1,"+e+"}"),t)}}function yf(e,t){switch(e){case 1:return ff(rf,t);case 2:return ff(of,t);case 3:return ff(af,t);case 4:return ff(sf,t);default:return ff(new RegExp("^-?\\d{1,"+e+"}"),t)}}function wf(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function bf(e,t){var n,r=t>0,o=r?t:1-t;if(o<=50)n=e||100;else{var i=o+50;n=e+100*Math.floor(i/100)-(e>=i%100?100:0)}return r?n:1-n}function kf(e){return e%400==0||e%4==0&&e%100!=0}var xf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",130),Ih(Th(e),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){var r=function(e){return{year:e,isTwoDigitYear:"yy"===t}};switch(t){case"y":return hf(vf(4,e),r);case"yo":return hf(n.ordinalNumber(e,{unit:"year"}),r);default:return hf(vf(t.length,e),r)}}},{key:"validate",value:function(e,t){return t.isTwoDigitYear||t.year>0}},{key:"set",value:function(e,t,n){var r=e.getUTCFullYear();if(n.isTwoDigitYear){var o=bf(n.year,r);return e.setUTCFullYear(o,0,1),e.setUTCHours(0,0,0,0),e}var i="era"in t&&1!==t.era?1-n.year:n.year;return e.setUTCFullYear(i,0,1),e.setUTCHours(0,0,0,0),e}}]),n}(Fh),Cf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",130),Ih(Th(e),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){var r=function(e){return{year:e,isTwoDigitYear:"YY"===t}};switch(t){case"Y":return hf(vf(4,e),r);case"Yo":return hf(n.ordinalNumber(e,{unit:"year"}),r);default:return hf(vf(t.length,e),r)}}},{key:"validate",value:function(e,t){return t.isTwoDigitYear||t.year>0}},{key:"set",value:function(e,t,n,r){var o=Fp(e,r);if(n.isTwoDigitYear){var i=bf(n.year,o);return e.setUTCFullYear(i,0,r.firstWeekContainsDate),e.setUTCHours(0,0,0,0),Bp(e,r)}var a="era"in t&&1!==t.era?1-n.year:n.year;return e.setUTCFullYear(a,0,r.firstWeekContainsDate),e.setUTCHours(0,0,0,0),Bp(e,r)}}]),n}(Fh),Sf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",130),Ih(Th(e),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t){return yf("R"===t?4:t.length,e)}},{key:"set",value:function(e,t,n){var r=new Date(0);return r.setUTCFullYear(n,0,4),r.setUTCHours(0,0,0,0),Ip(r)}}]),n}(Fh),Mf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",130),Ih(Th(e),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t){return yf("u"===t?4:t.length,e)}},{key:"set",value:function(e,t,n){return e.setUTCFullYear(n,0,1),e.setUTCHours(0,0,0,0),e}}]),n}(Fh),Tf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",120),Ih(Th(e),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){switch(t){case"Q":case"QQ":return vf(t.length,e);case"Qo":return n.ordinalNumber(e,{unit:"quarter"});case"QQQ":return n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(e,{width:"narrow",context:"formatting"});default:return n.quarter(e,{width:"wide",context:"formatting"})||n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=1&&t<=4}},{key:"set",value:function(e,t,n){return e.setUTCMonth(3*(n-1),1),e.setUTCHours(0,0,0,0),e}}]),n}(Fh),Of=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",120),Ih(Th(e),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){switch(t){case"q":case"qq":return vf(t.length,e);case"qo":return n.ordinalNumber(e,{unit:"quarter"});case"qqq":return n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(e,{width:"narrow",context:"standalone"});default:return n.quarter(e,{width:"wide",context:"standalone"})||n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(e,t){return t>=1&&t<=4}},{key:"set",value:function(e,t,n){return e.setUTCMonth(3*(n-1),1),e.setUTCHours(0,0,0,0),e}}]),n}(Fh),_f=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),Ih(Th(e),"priority",110),e}return Lh(n,[{key:"parse",value:function(e,t,n){var r=function(e){return e-1};switch(t){case"M":return hf(ff(Vh,e),r);case"MM":return hf(vf(2,e),r);case"Mo":return hf(n.ordinalNumber(e,{unit:"month"}),r);case"MMM":return n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(e,{width:"narrow",context:"formatting"});default:return n.month(e,{width:"wide",context:"formatting"})||n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=11}},{key:"set",value:function(e,t,n){return e.setUTCMonth(n,1),e.setUTCHours(0,0,0,0),e}}]),n}(Fh),Nf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",110),Ih(Th(e),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){var r=function(e){return e-1};switch(t){case"L":return hf(ff(Vh,e),r);case"LL":return hf(vf(2,e),r);case"Lo":return hf(n.ordinalNumber(e,{unit:"month"}),r);case"LLL":return n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(e,{width:"narrow",context:"standalone"});default:return n.month(e,{width:"wide",context:"standalone"})||n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=11}},{key:"set",value:function(e,t,n){return e.setUTCMonth(n,1),e.setUTCHours(0,0,0,0),e}}]),n}(Fh);var Ef=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",100),Ih(Th(e),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){switch(t){case"w":return ff(Uh,e);case"wo":return n.ordinalNumber(e,{unit:"week"});default:return vf(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=53}},{key:"set",value:function(e,t,n,r){return Bp(function(e,t,n){bp(2,arguments);var r=kp(e),o=wp(t),i=jp(r,n)-o;return r.setUTCDate(r.getUTCDate()-7*i),r}(e,n,r),r)}}]),n}(Fh);var Df=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",100),Ih(Th(e),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){switch(t){case"I":return ff(Uh,e);case"Io":return n.ordinalNumber(e,{unit:"week"});default:return vf(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=53}},{key:"set",value:function(e,t,n){return Ip(function(e,t){bp(2,arguments);var n=kp(e),r=wp(t),o=zp(n)-r;return n.setUTCDate(n.getUTCDate()-7*o),n}(e,n))}}]),n}(Fh),Af=[31,28,31,30,31,30,31,31,30,31,30,31],$f=[31,29,31,30,31,30,31,31,30,31,30,31],Rf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",90),Ih(Th(e),"subPriority",1),Ih(Th(e),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){switch(t){case"d":return ff(qh,e);case"do":return n.ordinalNumber(e,{unit:"date"});default:return vf(t.length,e)}}},{key:"validate",value:function(e,t){var n=kf(e.getUTCFullYear()),r=e.getUTCMonth();return n?t>=1&&t<=$f[r]:t>=1&&t<=Af[r]}},{key:"set",value:function(e,t,n){return e.setUTCDate(n),e.setUTCHours(0,0,0,0),e}}]),n}(Fh),Lf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",90),Ih(Th(e),"subpriority",1),Ih(Th(e),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){switch(t){case"D":case"DD":return ff(Hh,e);case"Do":return n.ordinalNumber(e,{unit:"date"});default:return vf(t.length,e)}}},{key:"validate",value:function(e,t){return kf(e.getUTCFullYear())?t>=1&&t<=366:t>=1&&t<=365}},{key:"set",value:function(e,t,n){return e.setUTCMonth(0,n),e.setUTCHours(0,0,0,0),e}}]),n}(Fh);function If(e,t,n){var r,o,i,a,s,l,c,u;bp(2,arguments);var d=Sp(),p=wp(null!==(r=null!==(o=null!==(i=null!==(a=null==n?void 0:n.weekStartsOn)&&void 0!==a?a:null==n||null===(s=n.locale)||void 0===s||null===(l=s.options)||void 0===l?void 0:l.weekStartsOn)&&void 0!==i?i:d.weekStartsOn)&&void 0!==o?o:null===(c=d.locale)||void 0===c||null===(u=c.options)||void 0===u?void 0:u.weekStartsOn)&&void 0!==r?r:0);if(!(p>=0&&p<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=kp(e),f=wp(t),m=((f%7+7)%7<p?7:0)+f-h.getUTCDay();return h.setUTCDate(h.getUTCDate()+m),h}var Pf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",90),Ih(Th(e),"incompatibleTokens",["D","i","e","c","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){switch(t){case"E":case"EE":case"EEE":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=6}},{key:"set",value:function(e,t,n,r){return(e=If(e,n,r)).setUTCHours(0,0,0,0),e}}]),n}(Fh),zf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",90),Ih(Th(e),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n,r){var o=function(e){var t=7*Math.floor((e-1)/7);return(e+r.weekStartsOn+6)%7+t};switch(t){case"e":case"ee":return hf(vf(t.length,e),o);case"eo":return hf(n.ordinalNumber(e,{unit:"day"}),o);case"eee":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeeee":return n.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=6}},{key:"set",value:function(e,t,n,r){return(e=If(e,n,r)).setUTCHours(0,0,0,0),e}}]),n}(Fh),Bf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",90),Ih(Th(e),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n,r){var o=function(e){var t=7*Math.floor((e-1)/7);return(e+r.weekStartsOn+6)%7+t};switch(t){case"c":case"cc":return hf(vf(t.length,e),o);case"co":return hf(n.ordinalNumber(e,{unit:"day"}),o);case"ccc":return n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"ccccc":return n.day(e,{width:"narrow",context:"standalone"});case"cccccc":return n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});default:return n.day(e,{width:"wide",context:"standalone"})||n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=6}},{key:"set",value:function(e,t,n,r){return(e=If(e,n,r)).setUTCHours(0,0,0,0),e}}]),n}(Fh);var Ff=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",90),Ih(Th(e),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){var r=function(e){return 0===e?7:e};switch(t){case"i":case"ii":return vf(t.length,e);case"io":return n.ordinalNumber(e,{unit:"day"});case"iii":return hf(n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),r);case"iiiii":return hf(n.day(e,{width:"narrow",context:"formatting"}),r);case"iiiiii":return hf(n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),r);default:return hf(n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),r)}}},{key:"validate",value:function(e,t){return t>=1&&t<=7}},{key:"set",value:function(e,t,n){return e=function(e,t){bp(2,arguments);var n=wp(t);n%7==0&&(n-=7);var r=kp(e),o=((n%7+7)%7<1?7:0)+n-r.getUTCDay();return r.setUTCDate(r.getUTCDate()+o),r}(e,n),e.setUTCHours(0,0,0,0),e}}]),n}(Fh),jf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",80),Ih(Th(e),"incompatibleTokens",["b","B","H","k","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){switch(t){case"a":case"aa":case"aaa":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(e,t,n){return e.setUTCHours(wf(n),0,0,0),e}}]),n}(Fh),Vf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",80),Ih(Th(e),"incompatibleTokens",["a","B","H","k","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){switch(t){case"b":case"bb":case"bbb":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(e,t,n){return e.setUTCHours(wf(n),0,0,0),e}}]),n}(Fh),qf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",80),Ih(Th(e),"incompatibleTokens",["a","b","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){switch(t){case"B":case"BB":case"BBB":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(e,t,n){return e.setUTCHours(wf(n),0,0,0),e}}]),n}(Fh),Hf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",70),Ih(Th(e),"incompatibleTokens",["H","K","k","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){switch(t){case"h":return ff(Jh,e);case"ho":return n.ordinalNumber(e,{unit:"hour"});default:return vf(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=12}},{key:"set",value:function(e,t,n){var r=e.getUTCHours()>=12;return r&&n<12?e.setUTCHours(n+12,0,0,0):r||12!==n?e.setUTCHours(n,0,0,0):e.setUTCHours(0,0,0,0),e}}]),n}(Fh),Uf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",70),Ih(Th(e),"incompatibleTokens",["a","b","h","K","k","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){switch(t){case"H":return ff(Wh,e);case"Ho":return n.ordinalNumber(e,{unit:"hour"});default:return vf(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=23}},{key:"set",value:function(e,t,n){return e.setUTCHours(n,0,0,0),e}}]),n}(Fh),Wf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",70),Ih(Th(e),"incompatibleTokens",["h","H","k","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){switch(t){case"K":return ff(Yh,e);case"Ko":return n.ordinalNumber(e,{unit:"hour"});default:return vf(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=11}},{key:"set",value:function(e,t,n){return e.getUTCHours()>=12&&n<12?e.setUTCHours(n+12,0,0,0):e.setUTCHours(n,0,0,0),e}}]),n}(Fh),Kf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",70),Ih(Th(e),"incompatibleTokens",["a","b","h","H","K","t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){switch(t){case"k":return ff(Kh,e);case"ko":return n.ordinalNumber(e,{unit:"hour"});default:return vf(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=24}},{key:"set",value:function(e,t,n){var r=n<=24?n%24:n;return e.setUTCHours(r,0,0,0),e}}]),n}(Fh),Yf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",60),Ih(Th(e),"incompatibleTokens",["t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){switch(t){case"m":return ff(Gh,e);case"mo":return n.ordinalNumber(e,{unit:"minute"});default:return vf(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=59}},{key:"set",value:function(e,t,n){return e.setUTCMinutes(n,0,0),e}}]),n}(Fh),Jf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",50),Ih(Th(e),"incompatibleTokens",["t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t,n){switch(t){case"s":return ff(Xh,e);case"so":return n.ordinalNumber(e,{unit:"second"});default:return vf(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=59}},{key:"set",value:function(e,t,n){return e.setUTCSeconds(n,0),e}}]),n}(Fh),Gf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",30),Ih(Th(e),"incompatibleTokens",["t","T"]),e}return Lh(n,[{key:"parse",value:function(e,t){return hf(vf(t.length,e),function(e){return Math.floor(e*Math.pow(10,3-t.length))})}},{key:"set",value:function(e,t,n){return e.setUTCMilliseconds(n),e}}]),n}(Fh),Xf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",10),Ih(Th(e),"incompatibleTokens",["t","T","x"]),e}return Lh(n,[{key:"parse",value:function(e,t){switch(t){case"X":return mf(lf,e);case"XX":return mf(cf,e);case"XXXX":return mf(uf,e);case"XXXXX":return mf(pf,e);default:return mf(df,e)}}},{key:"set",value:function(e,t,n){return t.timestampIsSet?e:new Date(e.getTime()-n)}}]),n}(Fh),Zf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",10),Ih(Th(e),"incompatibleTokens",["t","T","X"]),e}return Lh(n,[{key:"parse",value:function(e,t){switch(t){case"x":return mf(lf,e);case"xx":return mf(cf,e);case"xxxx":return mf(uf,e);case"xxxxx":return mf(pf,e);default:return mf(df,e)}}},{key:"set",value:function(e,t,n){return t.timestampIsSet?e:new Date(e.getTime()-n)}}]),n}(Fh),Qf=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",40),Ih(Th(e),"incompatibleTokens","*"),e}return Lh(n,[{key:"parse",value:function(e){return gf(e)}},{key:"set",value:function(e,t,n){return[new Date(1e3*n),{timestampIsSet:!0}]}}]),n}(Fh),em=function(e){_h(n,e);var t=Dh(n);function n(){var e;Ah(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Ih(Th(e=t.call.apply(t,[this].concat(o))),"priority",20),Ih(Th(e),"incompatibleTokens","*"),e}return Lh(n,[{key:"parse",value:function(e){return gf(e)}},{key:"set",value:function(e,t,n){return[new Date(n),{timestampIsSet:!0}]}}]),n}(Fh),tm={G:new jh,y:new xf,Y:new Cf,R:new Sf,u:new Mf,Q:new Tf,q:new Of,M:new _f,L:new Nf,w:new Ef,I:new Df,d:new Rf,D:new Lf,E:new Pf,e:new zf,c:new Bf,i:new Ff,a:new jf,b:new Vf,B:new qf,h:new Hf,H:new Uf,K:new Wf,k:new Kf,m:new Yf,s:new Jf,S:new Gf,X:new Xf,x:new Zf,t:new Qf,T:new em},nm=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,rm=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,om=/^'([^]*?)'?$/,im=/''/g,am=/\S/,sm=/[a-zA-Z]/;function lm(e,t,n,r){var o,i,a,s,l,c,u,d,p,h,f,m,g,v,y,w,b,k;bp(3,arguments);var x=String(e),C=String(t),S=Sp(),M=null!==(o=null!==(i=null==r?void 0:r.locale)&&void 0!==i?i:S.locale)&&void 0!==o?o:dh;if(!M.match)throw new RangeError("locale must contain match property");var T=wp(null!==(a=null!==(s=null!==(l=null!==(c=null==r?void 0:r.firstWeekContainsDate)&&void 0!==c?c:null==r||null===(u=r.locale)||void 0===u||null===(d=u.options)||void 0===d?void 0:d.firstWeekContainsDate)&&void 0!==l?l:S.firstWeekContainsDate)&&void 0!==s?s:null===(p=S.locale)||void 0===p||null===(h=p.options)||void 0===h?void 0:h.firstWeekContainsDate)&&void 0!==a?a:1);if(!(T>=1&&T<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var O=wp(null!==(f=null!==(m=null!==(g=null!==(v=null==r?void 0:r.weekStartsOn)&&void 0!==v?v:null==r||null===(y=r.locale)||void 0===y||null===(w=y.options)||void 0===w?void 0:w.weekStartsOn)&&void 0!==g?g:S.weekStartsOn)&&void 0!==m?m:null===(b=S.locale)||void 0===b||null===(k=b.options)||void 0===k?void 0:k.weekStartsOn)&&void 0!==f?f:0);if(!(O>=0&&O<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(""===C)return""===x?kp(n):new Date(NaN);var _,N={firstWeekContainsDate:T,weekStartsOn:O,locale:M},E=[new Bh],D=C.match(rm).map(function(e){var t=e[0];return t in oh?(0,oh[t])(e,M.formatLong):e}).join("").match(nm),A=[],$=Mh(D);try{var R=function(){var t=_.value;null!=r&&r.useAdditionalWeekYearTokens||!lh(t)||ch(t,C,e),null!=r&&r.useAdditionalDayOfYearTokens||!sh(t)||ch(t,C,e);var n=t[0],o=tm[n];if(o){var i=o.incompatibleTokens;if(Array.isArray(i)){var a=A.find(function(e){return i.includes(e.token)||e.token===n});if(a)throw new RangeError("The format string mustn't contain `".concat(a.fullToken,"` and `").concat(t,"` at the same time"))}else if("*"===o.incompatibleTokens&&A.length>0)throw new RangeError("The format string mustn't contain `".concat(t,"` and any other token at the same time"));A.push({token:n,fullToken:t});var s=o.run(x,t,M.match,N);if(!s)return{v:new Date(NaN)};E.push(s.setter),x=s.rest}else{if(n.match(sm))throw new RangeError("Format string contains an unescaped latin alphabet character `"+n+"`");if("''"===t?t="'":"'"===n&&(t=t.match(om)[1].replace(im,"'")),0!==x.indexOf(t))return{v:new Date(NaN)};x=x.slice(t.length)}};for($.s();!(_=$.n()).done;){var L=R();if("object"===yp(L))return L.v}}catch(H){$.e(H)}finally{$.f()}if(x.length>0&&am.test(x))return new Date(NaN);var I=E.map(function(e){return e.priority}).sort(function(e,t){return t-e}).filter(function(e,t,n){return n.indexOf(e)===t}).map(function(e){return E.filter(function(t){return t.priority===e}).sort(function(e,t){return t.subPriority-e.subPriority})}).map(function(e){return e[0]}),P=kp(n);if(isNaN(P.getTime()))return new Date(NaN);var z,B=Lp(P,Tp(P)),F={},j=Mh(I);try{for(j.s();!(z=j.n()).done;){var V=z.value;if(!V.validate(B,N))return new Date(NaN);var q=V.set(B,F,N);Array.isArray(q)?(B=q[0],yh(F,q[1])):B=q}}catch(H){j.e(H)}finally{j.f()}return B}function cm(e){bp(1,arguments);var t=kp(e);return t.setMinutes(0,0,0),t}function um(e,t){bp(2,arguments);var n=kp(e),r=kp(t);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()}function dm(e,t){bp(2,arguments);var n=kp(e),r=kp(t);return n.getFullYear()===r.getFullYear()}function pm(e,t){bp(2,arguments);var n=kp(e).getTime(),r=kp(t.start).getTime(),o=kp(t.end).getTime();if(!(r<=o))throw new RangeError("Invalid interval");return n>=r&&n<=o}function hm(e,t){bp(2,arguments);var n=kp(e),r=wp(t),o=n.getFullYear(),i=n.getDate(),a=new Date(0);a.setFullYear(o,r,15),a.setHours(0,0,0,0);var s=function(e){bp(1,arguments);var t=kp(e),n=t.getFullYear(),r=t.getMonth(),o=new Date(0);return o.setFullYear(n,r+1,0),o.setHours(0,0,0,0),o.getDate()}(a);return n.setMonth(r,Math.min(i,s)),n}function fm(e,t){if(bp(2,arguments),"object"!==yp(t)||null===t)throw new RangeError("values parameter must be an object");var n=kp(e);return isNaN(n.getTime())?new Date(NaN):(null!=t.year&&n.setFullYear(t.year),null!=t.month&&(n=hm(n,t.month)),null!=t.date&&n.setDate(wp(t.date)),null!=t.hours&&n.setHours(wp(t.hours)),null!=t.minutes&&n.setMinutes(wp(t.minutes)),null!=t.seconds&&n.setSeconds(wp(t.seconds)),null!=t.milliseconds&&n.setMilliseconds(wp(t.milliseconds)),n)}function mm(e,t,n){var r,o,i,a,s,l,c,u;bp(2,arguments);var d=Sp(),p=wp(null!==(r=null!==(o=null!==(i=null!==(a=null==n?void 0:n.weekStartsOn)&&void 0!==a?a:null==n||null===(s=n.locale)||void 0===s||null===(l=s.options)||void 0===l?void 0:l.weekStartsOn)&&void 0!==i?i:d.weekStartsOn)&&void 0!==o?o:null===(c=d.locale)||void 0===c||null===(u=c.options)||void 0===u?void 0:u.weekStartsOn)&&void 0!==r?r:0);if(!(p>=0&&p<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=kp(e),f=wp(t),m=h.getDay(),g=7-p;return function(e,t){bp(2,arguments);var n=kp(e),r=wp(t);return isNaN(r)?new Date(NaN):r?(n.setDate(n.getDate()+r),n):n}(h,f<0||f>6?f-(m+g)%7:((f%7+7)%7+g)%7-(m+g)%7)}function gm(e,t){return bp(2,arguments),_p(e,-wp(t))}const vm=(e,t=0,n=!1)=>{let r;return(...o)=>{n&&!r&&e(...o),clearTimeout(r),r=setTimeout(()=>{e(...o)},t)}};const ym=Ye({props:{actionsAlignment:{type:String,default:""},heading:{type:String,default:"h2"},icon:{type:String,required:!0},stretchHeight:{type:Boolean,default:!1},title:{type:String,required:!0},content:{type:String},type:{type:String,default:"default"}},setup(e){const t=Xe(()=>`fr-grid-row--${be(e.actionsAlignment)}`),n=Xe(()=>"primary"===e.type?"bg-contrast-blue-cumulus":"bg-white"),r=Xe(()=>"primary"===e.type);return{alignment:t,isDefault:Xe(()=>"default"===e.type),isPrimary:r,type:n}}}),wm={class:"fr-col-auto"},bm=["src"],km={class:"fr-col-12 fr-col-sm fr-grid-row flex-direction-column justify-between"},xm={class:"fr-mb-1w"},Cm={key:0,class:"fr-my-1w"};const Sm=An(ym,[["render",function(e,t,n,r,o,i){return Ze(),Qe("div",{class:lt(["rounded-xxs fr-p-3w fr-grid-row flex-direction-column",{"h-100":e.stretchHeight,[e.type]:e.type,"border border-default-grey":!e.isPrimary}])},[dt("div",{class:lt(["fr-col fr-grid-row fr-grid-row--gutters",{"text-blue-400":e.isPrimary}])},[dt("div",wm,[dt("img",{class:"w-100",src:e.icon,alt:""},null,8,bm)]),dt("div",km,[dt("div",xm,[(Ze(),nt(It(e.heading),{class:lt(["fr-m-0 fr-mb-1w",{"fr-text--bold fr-text--md":e.isPrimary,"fr--h5":!e.isPrimary}])},{default:it(()=>[Tt(pt(e.title),1)]),_:1},8,["class"])),e.content?(Ze(),Qe("p",Cm,pt(e.content),1)):tt(e.$slots,"default",{key:1})]),dt("div",{class:lt(["fr-grid-row",e.alignment])},[tt(e.$slots,"actions")],2)])],2)],2)}]]),Mm={class:"fr-mt-1v fr-mb-3v"},Tm=["href"],Om=Ye({__name:"NoSearchResults",emits:["resetFilters"],setup(e){const{t:t}=H();return(e,n)=>(Ze(),nt(Sm,{title:rt(t)("Didn't find what you are looking for?"),icon:rt("/_themes/gouvfr/assets/magnifying_glass.svg"),type:"primary"},{actions:it(()=>[dt("button",{onClick:n[0]||(n[0]=t=>e.$emit("resetFilters")),class:"fr-btn fr-btn--secondary"},pt(rt(t)("Reset filters")),1),rt(ke)?(Ze(),Qe("a",{key:0,href:rt(ke),class:"fr-btn fr-btn--tertiary-no-outline fr-btn--icon-left fr-icon-lightbulb-line fr-ml-1w"},pt(rt(t)("Check our forum")),9,Tm)):st("",!0)]),default:it(()=>[dt("p",Mm,[Tt(pt(rt(t)("Try resetting the filters to broaden your search.")),1),n[1]||(n[1]=dt("br",null,null,-1)),Tt(" "+pt(rt(t)("You can also check ongoing requests and submit your own on our forum dedicated to data discovery and openness.")),1)])]),_:1},8,["title","icon"]))}}),_m={class:"fr-grid-row fr-mt-1w fr-mt-md-5v"},Nm={class:"fr-col-12 fr-col-md-4 fr-col-lg-3"},Em={class:"fr-sidemenu","aria-labelledby":"fr-sidemenu-title"},Dm={class:"fr-sidemenu__inner"},Am={class:"fr-sidemenu__btn fr-mt-1w",hidden:"","aria-controls":"fr-sidemenu-wrapper","aria-expanded":"false"},$m={class:"fr-collapse",id:"fr-sidemenu-wrapper"},Rm={class:"fr-sidemenu__title fr-mb-3v",id:"fr-sidemenu-title"},Lm={class:"fr-grid-row fr-grid-row--gutters"},Im={key:0,class:"fr-col-12"},Pm={class:"fr-col-12"},zm={class:"fr-col-12"},Bm={class:"fr-col-12"},Fm={class:"fr-col-12"},jm={class:"fr-col-12"},Vm={class:"fr-col-12"},qm={key:1,class:"fr-col-12 fr-mb-3w text-align-center"},Hm=["href"],Um={key:0,class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle justify-between fr-pb-1w"},Wm={class:"fr-col-auto fr-my-0",role:"status"},Km={class:"fr-col-auto fr-grid-row fr-grid-row--middle"},Ym={for:"sort-search",class:"fr-col-auto fr-text--sm fr-m-0 fr-mr-1w"},Jm={class:"fr-col"},Gm={value:""},Xm=["value"],Zm={key:0},Qm={key:1},eg={class:"fr-mt-1w border-default-grey border-top relative z-2"},tg={key:2,class:"fr-mt-2w"},ng=Ye(M(M({},{inheritAttrs:!1}),{},{__name:"Search",props:{downloadLink:{default:""},disableFirstSearch:{type:Boolean,default:!1},organization:{default:""},sorts:{default:()=>[]}},setup(e){const t=e,{t:n}=H(),{toast:r}=_u(),o=new URL(window.location.href),i=new URLSearchParams(o.search),a=ye("datasets/extensions/"),s=ye("datasets/licenses/"),l=Rr().filter(e=>e.type!==Er&&e.type!==Dr).map(e=>({label:e.label,value:e.type})),d=Promise.resolve(l),p=ct(""),{reuseUrl:h}=Sd(p),f=ct(""),m=ct([]),g=ct(0),v=ct(1),y=ct({organization:t.organization}),w=ct(!1),b=ct(null),k=ct(null),x=ct(null),S=vm((e=true)=>{w.value=!0,b.value&&b.value.cancel(),b.value=pe(),we.get("/datasets/search/",{cancelToken:b.value.token,params:M(M({},P.value),{},{page_size:20})}).then(e=>e.data).then(n=>{m.value=n.data,g.value=n.total,w.value=!1,((e=!0)=>{let n=new URL(window.location.href);const r=M({},P.value);t.organization&&(delete r.organization,delete r.organization_badge),n.search=new URLSearchParams(r).toString(),e&&window.history.pushState(null,"",n);let o=document.querySelectorAll("[data-q]");for(let t of o)t.href=h.value})(e)}).catch(e=>{X.isCancel(e)||(r.error(n("Error getting search results.")),w.value=!1)})},xe),T=e=>{p.value=e,v.value=1,S()},O=(e,n)=>{y.value[e]=n||void 0,t.organization&&(y.value.organization=t.organization,y.value.organization_badge=void 0),v.value=1,S()},_=()=>{v.value=1,S()},N=e=>{v.value=e,S(),E()},E=()=>{x.value&&x.value.scrollIntoView({behavior:"smooth"})},D=(e,n=true)=>{let{page:r=1,sort:o=""}=e,i=C(e,c);y.value=M(M({},i),{},{organization:t.organization||i.organization}),v.value=r,f.value=o,S(n)},A=()=>{D({})},$=()=>{R(),E()},R=(e={},t=true)=>{let{q:n=""}=e,r=C(e,u);p.value=n,D(r,t)},L=Xe(()=>Object.keys(y.value).some(e=>{var n;return(null===(n=y.value[e])||void 0===n?void 0:n.length)&&(!t.organization||"organization"!==e)})),I=Xe(()=>t.sorts.map(e=>({value:"asc"==e.order?e.value:"-"+e.value,label:e.label}))),P=Xe(()=>{let e,t={};for(e in y.value){const n=y.value[e];n&&(t[e]=n)}return v.value>1&&(t.page=v.value.toString()),p.value&&(t.q=p.value),f.value&&(t.sort=f.value),t}),z=i.get("q");z&&(p.value=z,i.delete("q"));const B=i.get("page");B&&(v.value=parseInt(B),i.delete("page"));const F=i.get("sort");return F&&(f.value=F,i.delete("sort")),y.value=M(M({},Object.fromEntries(i)),{},{organization:t.organization||i.get("organization")||""}),t.disableFirstSearch?w.value=!0:S(),mt(()=>{if(t.disableFirstSearch&&k.value){let e=k.value.dataset.totalResults;if(e&&parseInt(e)>0){let t=k.value.dataset.results;t&&(m.value=JSON.parse(t)),g.value=JSON.parse(e)}w.value=!1}addEventListener("popstate",()=>{const e=new URL(window.location.href),t={};for(const[n,r]of e.searchParams)t[n]=r;R(t,false)})}),(t,r)=>(Ze(),Qe("form",{class:"fr-pt-3v",onSubmit:r[9]||(r[9]=zt((...e)=>rt(S)&&rt(S)(...e),["prevent"]))},[dt("div",{class:"fr-grid-row fr-grid-row--middle justify-between",ref_key:"searchRef",ref:x,"data-cy":"search"},[ut(Fd,{onChange:T,value:p.value,placeholder:rt(n)("Ex. 2022 presidential election")},null,8,["value","placeholder"])],512),dt("div",_m,[dt("div",Nm,[dt("nav",Em,[dt("div",Dm,[dt("button",Am,pt(rt(n)("Filter results")),1),dt("div",$m,[dt("div",Rm,pt(rt(n)("Filters")),1),dt("div",Lm,[e.organization?st("",!0):(Ze(),Qe("div",Im,[ut(gp,{placeholder:rt(n)("Organizations"),searchPlaceholder:rt(n)("Search an organization..."),allOption:rt(n)("All organizations"),listUrl:"/organizations/?sort=-followers",suggestUrl:"/organizations/suggest/",entityUrl:"/organizations/",values:y.value.organization,onChange:r[0]||(r[0]=e=>O("organization",e)),isBlue:!0},null,8,["placeholder","searchPlaceholder","allOption","values"]),ut(gp,{initialOptions:rt(d),placeholder:rt(n)("Organization type"),searchPlaceholder:rt(n)("Search an organization type..."),allOption:rt(n)("All types"),values:y.value.organization_badge,onChange:r[1]||(r[1]=e=>O("organization_badge",e)),isBlue:!0},null,8,["initialOptions","placeholder","searchPlaceholder","allOption","values"])])),dt("div",Pm,[ut(gp,{placeholder:rt(n)("Tags"),searchPlaceholder:rt(n)("Search a tag..."),allOption:rt(n)("All tags"),suggestUrl:"/tags/suggest/",values:y.value.tag,onChange:r[2]||(r[2]=e=>O("tag",e)),minimumCharacterBeforeSuggest:2,isBlue:!0},null,8,["placeholder","searchPlaceholder","allOption","values"])]),dt("div",zm,[ut(gp,{placeholder:rt(n)("Formats"),searchPlaceholder:rt(n)("Search a format..."),allOption:rt(n)("All formats"),listUrl:rt(a),values:y.value.format,onChange:r[3]||(r[3]=e=>O("format",e)),isBlue:!0},null,8,["placeholder","searchPlaceholder","allOption","listUrl","values"])]),dt("div",Bm,[ut(gp,{placeholder:rt(n)("Licenses"),explanation:rt(n)("Licenses define reuse rules for published datasets. See page data.gouv.fr/licences"),searchPlaceholder:rt(n)("Search a license..."),allOption:rt(n)("All licenses"),listUrl:rt(s),values:y.value.license,onChange:r[4]||(r[4]=e=>O("license",e)),isBlue:!0},null,8,["placeholder","explanation","searchPlaceholder","allOption","listUrl","values"])]),dt("div",Fm,[ut(vp,{values:y.value.schema||"",onChange:r[5]||(r[5]=e=>O("schema",e)),isBlue:!0},null,8,["values"])]),dt("div",jm,[ut(gp,{placeholder:rt(n)("Spatial coverage"),explanation:rt(n)("Geographic areas covered by data and for which they are relevant."),searchPlaceholder:rt(n)("Search a spatial coverage..."),allOption:rt(n)("All coverages"),suggestUrl:"/spatial/zones/suggest/",entityUrl:"/spatial/zone/",values:y.value.geozone,onChange:r[6]||(r[6]=e=>O("geozone",e)),isBlue:!0},null,8,["placeholder","explanation","searchPlaceholder","allOption","values"])]),dt("div",Vm,[ut(gp,{placeholder:rt(n)("Spatial granularity"),explanation:rt(n)("Finest level of geographic detail covered by data."),searchPlaceholder:rt(n)("Search a granularity..."),allOption:rt(n)("All granularities"),listUrl:"/spatial/granularities/",values:y.value.granularity,onChange:r[7]||(r[7]=e=>O("granularity",e)),isBlue:!0},null,8,["placeholder","explanation","searchPlaceholder","allOption","values"])]),L.value||e.downloadLink?(Ze(),Qe("div",qm,[L.value?(Ze(),Qe("button",{key:0,class:"fr-btn fr-btn--secondary fr-icon-close-circle-line fr-btn--icon-left justify-center w-100",onClick:A},pt(rt(n)("Reset filters")),1)):e.downloadLink?(Ze(),Qe("a",{key:1,class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500 fr-icon-download-line fr-btn--icon-left justify-center w-100 matomo_download",href:e.downloadLink},pt(rt(n)("Download list as CSV")),9,Hm)):st("",!0)])):st("",!0)])])])])]),dt("section",et({class:"fr-col-12 fr-col-md-8 fr-col-lg-9 fr-mt-2w fr-mt-md-0 search-results",ref_key:"resultsRef",ref:k},t.$attrs),[g.value?(Ze(),Qe("div",Um,[dt("p",Wm,pt(rt(n)("{count} results",g.value)),1),dt("div",Km,[dt("label",Ym,pt(rt(n)("Sort by:")),1),dt("div",Jm,[Vt(dt("select",{id:"sort-search",class:"fr-select fr-select--blue",name:"sort","onUpdate:modelValue":r[8]||(r[8]=e=>f.value=e),onChange:_},[dt("option",Gm,pt(rt(n)("Relevance")),1),(Ze(!0),Qe(Mt,null,Pt(I.value,({value:e,label:t})=>(Ze(),Qe("option",{value:e},pt(t),9,Xm))),256))],544),[[Gt,f.value]])])])])):st("",!0),ut(Wt,{mode:"out-in"},{default:it(()=>[w.value?(Ze(),Qe("div",Zm,[ut(Yd)])):m.value.length?(Ze(),Qe("div",Qm,[dt("ul",eg,[(Ze(!0),Qe(Mt,null,Pt(m.value,e=>(Ze(),Qe("li",{key:e.id},[ut(jd,{dataset:e},null,8,["dataset"])]))),128))]),g.value>20?(Ze(),nt(rt(Pa),{key:0,page:v.value,pageSize:20,totalResults:g.value,onChange:N,class:"fr-mt-2w"},null,8,["page","totalResults"])):(Ze(),nt(Om,{key:1,onResetFilters:$}))])):(Ze(),Qe("div",tg,[ut(Om,{onResetFilters:$})]))]),_:1})],16)])],32))}})),rg=["disabled","aria-controls"],og=["id"],ig={class:"fr-container fr-container--fluid fr-container-md"},ag={class:"fr-grid-row fr-grid-row--center"},sg={class:"fr-col-12 fr-col-md-8 fr-col-lg-6"},lg={class:"fr-modal__body"},cg={class:"fr-modal__header"},ug=["aria-controls"],dg={class:"fr-modal__content"},pg={class:"fr-modal__footer"},hg={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-reverse fr-btns-group--inline-lg fr-btns-group--icon-left"},fg=Ye({__name:"DeleteButton",props:{url:{}},setup(e){const t=e,{t:n}=H(),{toast:r}=_u(),o=ae,i=G("delete-modal"),a=i+"-title";function s(){return ie(),T.delete(t.url).then(()=>window.location.reload()).catch(()=>r.error(n("An error occured during the deletion.")))}return(e,t)=>(Ze(),Qe(Mt,null,[dt("button",{type:"button",class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-warning-425 fr-btn--icon-left fr-icon-delete-line",disabled:rt(o),"data-fr-opened":"false","aria-controls":rt(i)},pt(rt(n)("Delete")),9,rg),(Ze(),nt(At,{to:"body"},[dt("dialog",{"aria-labelledby":a,id:rt(i),class:"fr-modal",role:"dialog"},[dt("div",ig,[dt("div",ag,[dt("div",sg,[dt("div",lg,[dt("div",cg,[dt("button",{class:"fr-btn--close fr-btn","aria-controls":rt(i)},pt(rt(n)("Close")),9,ug)]),dt("div",dg,[dt("h1",{id:a,class:"fr-modal__title"},[t[0]||(t[0]=dt("span",{class:"fr-icon-delete-line fr-icon--lg"},null,-1)),Tt(" "+pt(rt(n)("Are you sure ?")),1)]),dt("p",null,pt(rt(n)("The content will be permanently deleted.")),1)]),dt("div",pg,[dt("div",hg,[dt("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-warning-425 fr-btn--icon-left fr-icon-delete-line",role:"button",onClick:s},pt(rt(n)("Delete")),1)])])])])])])],8,og)]))],64))}});const mg=["disabled","aria-controls"],gg=["id"],vg={class:"fr-container fr-container--fluid fr-container-md"},yg={class:"fr-grid-row fr-grid-row--center"},wg={class:"fr-col-12 fr-col-md-8 fr-col-lg-6"},bg={class:"fr-modal__body"},kg={class:"fr-modal__header"},xg=["aria-controls"],Cg={class:"fr-modal__content"},Sg={class:"fr-grid-row fr-grid-row--middle fr-mb-2w"},Mg={class:"avatar fr-mr-1w"},Tg=["src"],Og={class:"fr-modal__footer"},_g={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-reverse fr-btns-group--inline-lg fr-btns-group--icon-left"},Ng=Ye({__name:"DeleteUserButton",props:{id:{},full_name:{},avatar_thumbnail:{}},setup(e){const t=e,{t:n}=H(),{toast:r}=_u(),o=ae,i=G("delete-modal"),a=i+"-title";function s(){return(e=t.id,T.delete(`users/${e}/`)).then(()=>window.location.reload()).catch(()=>r.error(n("An error occured during the deletion.")));var e}function l(){return(e=t.id,T.delete(`users/${e}/?no_mail=true&delete_comments=true`)).then(()=>window.location.reload()).catch(()=>r.error(n("An error occured during the deletion.")));var e}return(e,r)=>(Ze(),Qe(Mt,null,[dt("button",{type:"button",class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-warning-425 fr-btn--icon-left fr-icon-delete-line",disabled:rt(o),"data-fr-opened":"false","aria-controls":rt(i)},pt(rt(n)("Delete")),9,mg),(Ze(),nt(At,{to:"body"},[dt("dialog",{"aria-labelledby":a,id:rt(i),class:"fr-modal",role:"dialog"},[dt("div",vg,[dt("div",yg,[dt("div",wg,[dt("div",bg,[dt("div",kg,[dt("button",{class:"fr-btn--close fr-btn","aria-controls":rt(i)},pt(rt(n)("Close")),9,xg)]),dt("div",Cg,[dt("h1",{id:a,class:"fr-modal__title"},[r[0]||(r[0]=dt("span",{class:"fr-icon-delete-line fr-icon--lg"},null,-1)),Tt(" "+pt(rt(n)("Are you sure ?")),1)]),dt("p",Sg,[dt("div",Mg,[dt("img",{class:"rounded-circle border border-default-grey",src:t.avatar_thumbnail,width:"40",height:"40",loading:"lazy",alt:""},null,8,Tg)]),Tt(" "+pt(t.full_name)+" "+pt(rt(n)("will be permanently deleted.")),1)])]),dt("div",Og,[dt("div",_g,[dt("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-warning-425 fr-btn--icon-left fr-icon-delete-line",role:"button",onClick:l},pt(rt(n)("Delete without as spam (no mail sent and discussions are deleted)")),1),dt("button",{class:"fr-btn bg-warning-425 fr-btn--icon-left fr-icon-delete-line",role:"button",onClick:s},pt(rt(n)("Delete")),1)])])])])])])],8,gg)]))],64))}}),Eg=Ye({name:"featured-button",props:{subjectId:{type:String,required:!0},subjectType:{type:String,required:!0},featured:{type:Boolean,required:!0}},setup(e){const{t:t}=H(),{toast:n}=_u(),r=ct(e.featured),o=ct(null);return mt(()=>{var e;return null===(e=o.value)||void 0===e?void 0:e.toggleAttribute("checked",r.value)}),{isFeatured:r,t:t,toggleFeatured:()=>{const o=r.value?"delete":"post",i=`${e.subjectType.toLowerCase()}s/${e.subjectId}/featured/`;T[o](i).then(e=>{r.value=!r.value}).catch(()=>n.error(t("An error occurred while featuring this subject.")))},toggleInput:o}}}),Dg={class:"fr-toggle fr-toggle--label-left"},Ag=["checked"],$g=["data-fr-checked-label","data-fr-unchecked-label"];const Rg=An(Eg,[["render",function(e,t,n,r,o,i){return Ze(),Qe("div",Dg,[dt("input",{ref:"toggleInput",onClick:t[0]||(t[0]=(...t)=>e.toggleFeatured&&e.toggleFeatured(...t)),type:"checkbox",class:"fr-toggle__input",id:"featured-toggle",checked:e.isFeatured},null,8,Ag),dt("label",{class:"fr-toggle__label",for:"featured-toggle","data-fr-checked-label":e.t("Featured"),"data-fr-unchecked-label":e.t("Standard")},pt(e.t("Feature this content")),9,$g)])}]]),Lg=Ye({props:{followers:Number,url:{type:String,required:!0},following:Boolean},setup(e){const t=ct(!1),n=ct(e.following),r=de.read_only_enabled;return{following:n,animating:t,readOnlyEnabled:r,toggleFollow:()=>{let r;ie(),r=n.value?T.delete(e.url):T.post(e.url),r.then(()=>{n.value=!n.value,n.value&&(t.value=!0,setTimeout(()=>t.value=!1,1300))})}}}}),Ig=["disabled"],Pg={class:"fr-ml-1w"};const zg=An(Lg,[["render",function(e,t,n,r,o,i){return Ze(),Qe("button",{onClick:t[0]||(t[0]=zt((...t)=>e.toggleFollow&&e.toggleFollow(...t),["prevent"])),type:"button",class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 follow-button",disabled:e.readOnlyEnabled},[dt("span",{class:lt(["magic fr-grid-row",{active:e.animating}]),style:Lt({color:e.following?"inherit":"transparent"})},[...t[1]||(t[1]=[dt("svg",{"aria-hidden":"true",width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},[dt("path",{d:"M7.20703 1.24224L5.42968 4.87896L1.41015 5.45318C0.699214 5.56255 0.425776 6.43755 0.945308 6.95709L3.8164 9.77349L3.13281 13.7383C3.02343 14.4493 3.78906 14.9961 4.41796 14.668L8 12.7813L11.5547 14.668C12.1836 14.9961 12.9492 14.4493 12.8398 13.7383L12.1562 9.77349L15.0273 6.95709C15.5469 6.43755 15.2734 5.56255 14.5625 5.45318L10.5703 4.87896L8.76562 1.24224C8.46484 0.613336 7.53515 0.585992 7.20703 1.24224Z",stroke:"#161616"})],-1)])],6),dt("span",Pg,[e.following?(Ze(),Qe(Mt,{key:0},[Tt(pt(e.$t("Remove from favourites")),1)],64)):(Ze(),Qe(Mt,{key:1},[Tt(pt(e.$t("Add to favourites")),1)],64))])],8,Ig)}]]),Bg=Ye({props:{organization:{type:String,required:!0}},setup(e){const{t:t}=H(),n=ct("");return{askToJoinOrganization:()=>{ie(),n.value=prompt(t("You can add some details here for your membership request"))||"",T.post("organizations/"+e.organization+"/membership/",{comment:n.value}).then(e=>{alert(t("A request has been sent to the administrators")),window.location.reload()}).catch(e=>{alert(t("Error while requesting membership")),console.error(e)})},comment:n}}});const Fg=An(Bg,[["render",function(e,t,n,r,o,i){return Ze(),Qe("button",{onClick:t[0]||(t[0]=zt((...t)=>e.askToJoinOrganization&&e.askToJoinOrganization(...t),["prevent"])),class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500 fr-btn--icon-left fr-icon-team-line"},pt(e.$t("Ask to join the organization as a producer")),1)}]]);Ft(["pdf","doc","docx","word","xls","excel","xlsx"]);const jg=/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/i,Vg=new RegExp("/resources/("+jg.source+")?$",jg.flags),qg=new RegExp("/resource-("+jg.source+")?$",jg.flags),Hg=new RegExp("/community-resources/("+jg.source+")?$",jg.flags),Ug=(e,t)=>{for(const n of t?[Hg]:[Vg,qg]){let[t,r,o]=n.exec(e)||[];if(r)return r}return null};function Wg(){const e=ct(window.location.hash),t=()=>e.value=window.location.hash;return mt(()=>window.addEventListener("hashchange",t)),Dt(()=>window.removeEventListener("hashchange",t)),{hash:e}}function Kg(){history.pushState(null,""," "),window.dispatchEvent(new HashChangeEvent("hashchange"))}const Yg={key:0},Jg={key:1},Gg={class:"fr-grid-row fr-grid-row--middle justify-between"},Xg={key:0},Zg={key:1},Qg=Ye({__name:"resourceFromHash",props:{canEdit:{type:Boolean},datasetId:{},communityResource:{type:Boolean,default:!1}},setup(e){const t=e,{t:n}=H(),{toast:r}=_u(),o=ct(null),i=ct(null),a=ct(!1),{hash:s}=Wg(),l=Xe(()=>Ug(s.value,t.communityResource)),c=Xe(()=>t.communityResource?`/datasets/community_resources/${l.value}`:`/datasets/${t.datasetId}/resources/${l.value}`);return St(async()=>{if(l.value){a.value=!0;try{const e=await T.get(c.value),t=await e.data;t&&(i.value=t,o.value&&o.value.scrollIntoView())}catch(Yo){console.error(Yo),r.error(n("An error occurred while fetching the file ")+l.value)}finally{a.value=!1}}}),(t,r)=>l.value?(Ze(),Qe("section",{key:0,ref_key:"top",ref:o},[ut(Wt,{mode:"out-in"},{default:it(()=>[a.value?(Ze(),Qe("div",Yg,[ut(rt(mc))])):(Ze(),Qe("div",Jg,[ut(rt(Pc),{type:"secondary",color:"success",class:"fr-mb-2w"},{default:it(()=>[dt("div",Gg,[e.communityResource?(Ze(),Qe("span",Xg,pt(rt(n)("You are seeing a specific community resource of this dataset")),1)):(Ze(),Qe("span",Zg,pt(rt(n)("You are seeing a specific file of this dataset")),1)),dt("button",{class:"fr-btn--close fr-btn fr-mr-0",onClick:r[0]||(r[0]=zt((...e)=>rt(Kg)&&rt(Kg)(...e),["prevent"]))},pt(rt(n)("Close")),1)])]),_:1}),i.value?(Ze(),nt(rt(fc),{key:0,id:"resource-"+l.value,datasetId:e.datasetId,expandedOnMount:!0,resource:i.value,canEdit:e.canEdit,isCommunityResource:e.communityResource},null,8,["id","datasetId","resource","canEdit","isCommunityResource"])):st("",!0)]))]),_:1})],512)):st("",!0)}}),ev=Ye({__name:"Reuse",props:{reuse:{}},setup:e=>(t,n)=>{var r;return Ze(),nt(rt(Ic),{reuse:e.reuse,reuseUrl:e.reuse.page,organizationUrl:null===(r=e.reuse.organization)||void 0===r?void 0:r.page},null,8,["reuse","reuseUrl","organizationUrl"])}});const tv="resourcesSearch",nv=function(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(e){e(n)}),(r=e.get("*"))&&r.slice().map(function(e){e(t,n)})}}}(),rv=e=>{e.config.globalProperties.$bus=nv},ov=Ye({props:{eventName:{type:String,default:tv},type:{type:String}},setup(e){const t=function(e,t=0,n=!1){const r=ct(e);return bt((e,o)=>({get:()=>(e(),r.value),set:vm(e=>{r.value=e,o()},t,n)}))}("",xe),n=()=>{nv.emit(e.eventName,{type:e.type,value:t.value})};let r;Ce&&ft(t,n);return Dt(()=>clearTimeout(r)),{search:n,searchWithoutAutocomplete:()=>{r=setTimeout(()=>{n()},xe)},searchValue:t}}}),iv=["aria-label"],av=["for"],sv=["id"],lv={class:"fr-btn",type:"submit"};const cv=An(ov,[["render",function(e,t,n,r,o,i){return Ze(),Qe("form",{onSubmit:t[1]||(t[1]=zt((...t)=>e.searchWithoutAutocomplete&&e.searchWithoutAutocomplete(...t),["prevent"]))},[dt("div",{class:"fr-search-bar",role:"search","aria-label":e.$t("Search files")},[dt("label",{class:"fr-label",for:e.eventName},pt(e.$t("Search files")),9,av),Vt(dt("input",{class:"fr-input",placeholder:"Rechercher",type:"search",id:e.eventName,"onUpdate:modelValue":t[0]||(t[0]=t=>e.searchValue=t)},null,8,sv),[[qt,e.searchValue]]),dt("button",lv,pt(e.$t("Search")),1)],8,iv)],32)}]]),uv={class:"fr-grid-row"},dv={class:"fr-col"},pv={key:0,class:"fr-col-auto"},hv=["href"],fv={key:0,class:"fr-my-3v"},mv={key:0},gv={key:1,class:"flex flex-direction-column gap-10px"},vv={key:0,class:"fr-my-0 fr-text--sm border-bottom",role:"status"},yv={key:1},wv=!1,bv=Ye({__name:"resources",props:{canEdit:{type:Boolean,default:!1},canEditResources:{default:()=>({})},datasetId:{},showTotal:{type:Boolean,default:!0},type:{},typeLabel:{},firstGroup:{type:Boolean,default:!0}},setup(e){var t;const n=e,{t:r}=H(),{toast:o}=_u(),i=ct(1),{hash:a}=Wg(),s=Xe(()=>Ug(a.value,"community"===n.type)),l=ct([]),c=de.resources_default_page_size,u=new URL(null!==(t=de.admin_root)&&void 0!==t&&t.startsWith("http")?de.admin_root:`${document.location.origin}${de.admin_root}community-resource/new/`),d=new URLSearchParams({dataset_id:n.datasetId});u.search=d.toString();const p=u.toString(),h=ct(0),f=ct(0),m=ct(!0),g=ct(null),v=ct(""),y=ct("community"===n.type),w=Xe(()=>!y.value&&h.value>de.resources_min_count_to_show_search),b=Xe(()=>h.value!=f.value),k=(e=1,t=!1)=>{let i;return m.value=!0,t&&g.value&&g.value.scrollIntoView({behavior:"smooth"}),i=y.value?async function(e,t,n){return(await T.get("datasets/community_resources/",{params:{page:t,dataset:e,page_size:n}})).data}(n.datasetId,e,c):async function(e,t,n,r,o){return(await we.get("/datasets/"+e+"/resources/",{params:{page:n,type:t,page_size:r,q:o}})).data}(n.datasetId,n.type,e,c,v.value),i.then(e=>(e.data&&(l.value=e.data,f.value=e.total),e.total||0)).catch(()=>(o.error(r("An error occurred while fetching resources")),l.value=[],0)).finally(()=>{m.value=!1})},x=(e,t=!0)=>(i.value=e,k(e,t)),C=e=>n.canEdit?n.canEdit:n.canEditResources[e.id];y.value||nv.on(tv,({type:e,value:t})=>{e===n.type&&(v.value=t,x(1,wv))});return mt(()=>{x(1,wv).then(e=>h.value=e)}),(t,n)=>s.value?st("",!0):(Ze(),Qe("section",{key:0,class:"fr-mb-3v",ref_key:"top",ref:g},[dt("div",uv,[dt("div",dv,[dt("h2",{class:lt([{"fr-mt-4w":!e.firstGroup},"fr-mb-0 subtitle subtitle--uppercase"])},pt(e.typeLabel),3)]),y.value?(Ze(),Qe("div",pv,[dt("a",{class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 fr-icon-add-line fr-btn--icon-left",href:rt(p)},pt(rt(r)("Add a community resource")),9,hv)])):st("",!0)]),w.value?(Ze(),Qe("div",fv,[ut(cv,{eventName:rt(tv),type:e.type},null,8,["eventName","type"])])):st("",!0),ut(Wt,{mode:"out-in"},{default:it(()=>[m.value?(Ze(),Qe("div",mv,[(Ze(!0),Qe(Mt,null,Pt(rt(c),e=>(Ze(),nt(rt(mc),{class:"fr-mt-2w"}))),256))])):(Ze(),Qe("div",gv,[b.value?(Ze(),Qe("p",vv,pt(rt(r)("{count} results",f.value)),1)):st("",!0),(Ze(!0),Qe(Mt,null,Pt(l.value,t=>(Ze(),nt(rt(fc),{id:"resource-"+t.id,datasetId:e.datasetId,isCommunityResource:y.value,resource:t,canEdit:C(t)},null,8,["id","datasetId","isCommunityResource","resource","canEdit"]))),256)),f.value?f.value>rt(c)?(Ze(),nt(rt(Pa),{key:2,class:"fr-mt-3w",page:i.value,"page-size":rt(c),"total-results":f.value,onChange:x},null,8,["page","page-size","total-results"])):st("",!0):(Ze(),Qe("p",yv,pt(rt(r)("No files match your search.")),1))]))]),_:1})],512))}}),kv=An(bv,[["__scopeId","data-v-4aa480fc"]]),xv={key:0},Cv=Ye({__name:"CardList",props:{datasets:{},loading:{type:Boolean,default:!1},totalResults:{},pageSize:{default:20}},emits:["changePage"],setup(e,{emit:t}){const n=t,r=ct(1),o=ct();function i(e){r.value=e,n("changePage",e),o.value&&o.value.scrollIntoView({behavior:"smooth"})}return(t,n)=>e.loading?(Ze(),Qe("div",xv,[ut(Yd)])):e.totalResults?(Ze(),Qe(Mt,{key:1},[dt("ul",{ref_key:"listRef",ref:o},[(Ze(!0),Qe(Mt,null,Pt(e.datasets,e=>(Ze(),Qe("li",{key:e.id},[ut(jd,{dataset:e},null,8,["dataset"])]))),128))],512),e.totalResults>e.pageSize?(Ze(),nt(rt(Pa),{key:0,page:r.value,pageSize:e.pageSize,totalResults:e.totalResults,onChange:i,class:"fr-mt-2w"},null,8,["page","pageSize","totalResults"])):st("",!0)],64)):st("",!0)}}),Sv={key:0,class:"subtitle subtitle--uppercase fr-mb-5v"},Mv=Ye({__name:"UserDatasetList",props:{owner:{}},setup(e){const{t:t}=H(),{toast:n}=_u(),r=e,o=ct([]),i=ct(0),a=ct(!1),s=ct(null);function l(e){a.value=!0,s.value&&s.value.cancel(),s.value=pe(),we.get("/datasets/search/",{cancelToken:s.value.token,params:{page:e,owner:r.owner,page_size:3}}).then(e=>e.data).then(e=>{o.value=e.data,i.value=e.total,a.value=!1}).catch(e=>{X.isCancel(e)||(n.error(t("Error getting search results.")),a.value=!1)})}return mt(()=>{l(1)}),(e,n)=>(Ze(),Qe(Mt,null,[i.value?(Ze(),Qe("h2",Sv,pt(rt(t)("{n} datasets",i.value)),1)):st("",!0),ut(Cv,{"page-size":3,datasets:o.value,loading:a.value,"total-results":i.value,onChangePage:l},null,8,["datasets","loading","total-results"])],64))}});const Tv=An({components:{ContentLoader:ln}},[["render",function(e,t,n,r,o,i){const a=jt("ContentLoader");return Ze(),nt(a,{width:350,height:180,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},{default:it(()=>[...t[0]||(t[0]=[dt("rect",{x:"43",y:"153",rx:"3",ry:"3",width:"97",height:"6"},null,-1),dt("rect",{x:"44",y:"166",rx:"3",ry:"3",width:"97",height:"5"},null,-1),dt("rect",{x:"184",y:"7",rx:"5",ry:"5",width:"130",height:"130"},null,-1),dt("rect",{x:"198",y:"153",rx:"3",ry:"3",width:"97",height:"6"},null,-1),dt("rect",{x:"199",y:"166",rx:"3",ry:"3",width:"97",height:"5"},null,-1),dt("rect",{x:"27",y:"8",rx:"5",ry:"5",width:"130",height:"130"},null,-1)])]),_:1})}]]),Ov={key:0},_v=Ye({__name:"ReuseList",props:{reuses:{},loading:{type:Boolean,default:!1},totalResults:{},pageSize:{default:20}},emits:["changePage"],setup(e,{emit:t}){const n=t,r=ct(1),o=ct();function i(e){r.value=e,n("changePage",e),o.value&&o.value.scrollIntoView({behavior:"smooth"})}return(t,n)=>e.loading?(Ze(),Qe("div",Ov,[ut(Tv)])):e.totalResults?(Ze(),Qe(Mt,{key:1},[dt("ul",{ref_key:"listRef",ref:o,class:"fr-grid-row fr-grid-row--gutters"},[(Ze(!0),Qe(Mt,null,Pt(e.reuses,t=>(Ze(),Qe("li",{class:lt(["fr-col-12",{"fr-col-md-6":e.reuses.length<=2,"fr-col-md-4":e.reuses.length>=3}]),key:t.id},[ut(ev,{reuse:t},null,8,["reuse"])],2))),128))],512),e.totalResults>e.pageSize?(Ze(),nt(rt(Pa),{key:0,page:r.value,pageSize:e.pageSize,totalResults:e.totalResults,onChange:i,class:"fr-mt-2w"},null,8,["page","pageSize","totalResults"])):st("",!0)],64)):st("",!0)}}),Nv={key:0,class:"subtitle subtitle--uppercase fr-mb-5v"},Ev=Ye({__name:"UserReuseList",props:{owner:{}},setup(e){const{t:t}=H(),{toast:n}=_u(),r=e,o=ct([]),i=ct(0),a=ct(!1),s=ct(null);function l(e){a.value=!0,s.value&&s.value.cancel(),s.value=pe(),we.get("/reuses/search/",{cancelToken:s.value.token,params:{page:e,owner:r.owner,page_size:6}}).then(e=>e.data).then(e=>{o.value=e.data,i.value=e.total,a.value=!1}).catch(e=>{X.isCancel(e)||(n.error(t("Error getting search results.")),a.value=!1)})}return mt(()=>{l(1)}),(e,n)=>(Ze(),Qe(Mt,null,[i.value?(Ze(),Qe("h2",Nv,pt(rt(t)("{n} reuses",i.value)),1)):st("",!0),ut(_v,{"page-size":6,reuses:o.value,loading:a.value,"total-results":i.value,onChangePage:l},null,8,["reuses","loading","total-results"])],64))}}),Dv={key:0,class:"border border-blue-400 fr-p-2w bg-alt-grey"},Av={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},$v={class:"fr-col-12 fr-col-sm"},Rv={class:"fr-h6 fr-mb-0 text-blue-400"},Lv={class:"fr-col-auto flex"},Iv=["href"],Pv=["href"],zv=["href"],Bv={key:1,class:"border border-blue-400 fr-p-2w fr-dataservice__box fr-dataservice__swagger"},Fv={class:"fr-h6 fr-mb-0 text-blue-400"},jv={class:"flex items-center fr-ml-4v"},Vv={key:0},qv=Ye({__name:"DataserviceLinks",props:{dataservice:{}},setup(e){const t=e,{t:n}=H(),r=ct(!1),o=ct(!1),i=Bt(()=>U(()=>S.import("./Swagger-legacy.6.2.4.js"),void 0)),a=()=>{r.value=!r.value};return mt(async()=>{var e;t.dataservice.machine_documentation_url&&(o.value=(e=t.dataservice.machine_documentation_url).endsWith(".json")||e.endsWith(".yaml")||e.endsWith(".yml"))}),(t,s)=>(Ze(),Qe("div",null,[!o.value&&e.dataservice.machine_documentation_url||e.dataservice.technical_documentation_url||e.dataservice.business_documentation_url?(Ze(),Qe("div",Dv,[dt("div",Av,[dt("div",$v,[dt("h2",Rv,pt(rt(n)("API documentation")),1)]),dt("div",Lv,[e.dataservice.technical_documentation_url?(Ze(),Qe("a",{key:0,class:"fr-btn fr-ml-3v",href:e.dataservice.technical_documentation_url,target:"_blank",rel:"ugc nofollow noopener"},pt(rt(n)("Technical documentation")),9,Iv)):st("",!0),!o.value&&e.dataservice.machine_documentation_url?(Ze(),Qe("a",{key:1,class:"fr-btn fr-ml-3v",href:e.dataservice.machine_documentation_url,target:"_blank",rel:"ugc nofollow noopener"},pt(rt(n)("Machine readable documentation")),9,Pv)):st("",!0),e.dataservice.business_documentation_url?(Ze(),Qe("a",{key:2,class:lt(["fr-btn fr-ml-3v",o.value?"":"fr-btn--secondary"]),href:e.dataservice.business_documentation_url,target:"_blank",rel:"ugc nofollow noopener"},pt(rt(n)("Business documentation")),11,zv)):st("",!0)])])])):st("",!0),s[0]||(s[0]=dt("br",null,null,-1)),o.value?(Ze(),Qe("div",Bv,[dt("header",{class:"fr-p-2v flex items-center justify-between",onClick:a},[dt("h2",Fv,pt(rt(n)("Swagger")),1),dt("div",jv,[dt("div",{class:lt(["fr-icon--sm fr-ml-4v",{"fr-icon-arrow-up-s-line":r.value,"fr-icon-arrow-down-s-line":!r.value}])},null,2)])]),r.value&&e.dataservice.machine_documentation_url?(Ze(),Qe("div",Vv,[ut(rt(i),{url:e.dataservice.machine_documentation_url},null,8,["url"])])):st("",!0)])):st("",!0)]))}}),Hv=An(qv,[["__scopeId","data-v-67dee39c"]]);document.querySelectorAll("[data-tabs]").forEach(e=>{const t=e.querySelectorAll("[role=tab]");t.forEach(e=>{e.addEventListener("click",n=>{var r,o;n.preventDefault();const i=n.target,a=Array.from(t).find(e=>"true"===e.getAttribute("aria-selected"));if(a){var s;a.setAttribute("aria-selected","false");const e=a.getAttribute("aria-controls")||"";null===(s=document.getElementById(e))||void 0===s||s.classList.remove("fr-unhidden")}const l=i.getAttribute("aria-controls")||"";i.setAttribute("aria-selected","true"),null===(r=document.getElementById(l))||void 0===r||r.classList.add("fr-unhidden"),null===(o=globalThis._paq)||void 0===o||o.push(["trackEvent","Move page to tab",window.location.pathname,e.textContent])})})});document.querySelectorAll("[data-accordion-button]").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault();const t=e.target;if(t instanceof HTMLElement){t.toggleAttribute("aria-expanded");const e=document.querySelector("#"+t.getAttribute("aria-controls"));e&&(e.classList.toggle("active"),Mr(e,t.hasAttribute("aria-expanded")))}})});var Uv={exports:{}};
/*!
       * clipboard.js v2.0.11
       * https://clipboardjs.com/
       *
       * Licensed MIT  Zeno Rocha
       */!function(e){var t;t=function(){return function(){var e={686:function(e,t,n){n.d(t,{default:function(){return x}});var r=n(279),o=n.n(r),i=n(370),a=n.n(i),s=n(817),l=n.n(s);function c(e){try{return document.execCommand(e)}catch(t){return!1}}var u=function(e){var t=l()(e);return c("cut"),t},d=function(e,t){var n=function(e){var t="rtl"===document.documentElement.getAttribute("dir"),n=document.createElement("textarea");n.style.fontSize="12pt",n.style.border="0",n.style.padding="0",n.style.margin="0",n.style.position="absolute",n.style[t?"right":"left"]="-9999px";var r=window.pageYOffset||document.documentElement.scrollTop;return n.style.top="".concat(r,"px"),n.setAttribute("readonly",""),n.value=e,n}(e);t.container.appendChild(n);var r=l()(n);return c("copy"),n.remove(),r},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{container:document.body},n="";return"string"==typeof e?n=d(e,t):e instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(null==e?void 0:e.type)?n=d(e.value,t):(n=l()(e),c("copy")),n};function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}var f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.action,n=void 0===t?"copy":t,r=e.container,o=e.target,i=e.text;if("copy"!==n&&"cut"!==n)throw new Error('Invalid "action" value, use either "copy" or "cut"');if(void 0!==o){if(!o||"object"!==h(o)||1!==o.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===n&&o.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===n&&(o.hasAttribute("readonly")||o.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes')}return i?p(i,{container:r}):o?"cut"===n?u(o):p(o,{container:r}):void 0};function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t){return v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},v(e,t)}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(Yo){return!1}}();return function(){var n,r=w(e);if(t){var o=w(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){return!t||"object"!==m(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,n)}}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function b(e,t){var n="data-clipboard-".concat(e);if(t.hasAttribute(n))return t.getAttribute(n)}var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(i,e);var t,n,r,o=y(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this)).resolveOptions(t),n.listenClick(e),n}return t=i,n=[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof e.action?e.action:this.defaultAction,this.target="function"==typeof e.target?e.target:this.defaultTarget,this.text="function"==typeof e.text?e.text:this.defaultText,this.container="object"===m(e.container)?e.container:document.body}},{key:"listenClick",value:function(e){var t=this;this.listener=a()(e,"click",function(e){return t.onClick(e)})}},{key:"onClick",value:function(e){var t=e.delegateTarget||e.currentTarget,n=this.action(t)||"copy",r=f({action:n,container:this.container,target:this.target(t),text:this.text(t)});this.emit(r?"success":"error",{action:n,text:r,trigger:t,clearSelection:function(){t&&t.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(e){return b("action",e)}},{key:"defaultTarget",value:function(e){var t=b("target",e);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(e){return b("text",e)}},{key:"destroy",value:function(){this.listener.destroy()}}],r=[{key:"copy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{container:document.body};return p(e,t)}},{key:"cut",value:function(e){return u(e)}},{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],t="string"==typeof e?[e]:e,n=!!document.queryCommandSupported;return t.forEach(function(e){n=n&&!!document.queryCommandSupported(e)}),n}}],n&&g(t.prototype,n),r&&g(t,r),i}(o()),x=k},828:function(e){if("undefined"!=typeof Element&&!Element.prototype.matches){var t=Element.prototype;t.matches=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}e.exports=function(e,t){for(;e&&9!==e.nodeType;){if("function"==typeof e.matches&&e.matches(t))return e;e=e.parentNode}}},438:function(e,t,n){var r=n(828);function o(e,t,n,r,o){var a=i.apply(this,arguments);return e.addEventListener(n,a,o),{destroy:function(){e.removeEventListener(n,a,o)}}}function i(e,t,n,o){return function(n){n.delegateTarget=r(n.target,t),n.delegateTarget&&o.call(e,n)}}e.exports=function(e,t,n,r,i){return"function"==typeof e.addEventListener?o.apply(null,arguments):"function"==typeof n?o.bind(null,document).apply(null,arguments):("string"==typeof e&&(e=document.querySelectorAll(e)),Array.prototype.map.call(e,function(e){return o(e,t,n,r,i)}))}},879:function(e,t){t.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},t.nodeList=function(e){var n=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in e&&(0===e.length||t.node(e[0]))},t.string=function(e){return"string"==typeof e||e instanceof String},t.fn=function(e){return"[object Function]"===Object.prototype.toString.call(e)}},370:function(e,t,n){var r=n(879),o=n(438);e.exports=function(e,t,n){if(!e&&!t&&!n)throw new Error("Missing required arguments");if(!r.string(t))throw new TypeError("Second argument must be a String");if(!r.fn(n))throw new TypeError("Third argument must be a Function");if(r.node(e))return function(e,t,n){return e.addEventListener(t,n),{destroy:function(){e.removeEventListener(t,n)}}}(e,t,n);if(r.nodeList(e))return function(e,t,n){return Array.prototype.forEach.call(e,function(e){e.addEventListener(t,n)}),{destroy:function(){Array.prototype.forEach.call(e,function(e){e.removeEventListener(t,n)})}}}(e,t,n);if(r.string(e))return function(e,t,n){return o(document.body,e,t,n)}(e,t,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}},817:function(e){e.exports=function(e){var t;if("SELECT"===e.nodeName)e.focus(),t=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName){var n=e.hasAttribute("readonly");n||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),n||e.removeAttribute("readonly"),t=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var r=window.getSelection(),o=document.createRange();o.selectNodeContents(e),r.removeAllRanges(),r.addRange(o),t=r.toString()}return t}},279:function(e){function t(){}t.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var r=this;function o(){r.off(e,o),t.apply(n,arguments)}return o._=t,this.on(e,o,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,o=n.length;r<o;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],o=[];if(r&&t)for(var i=0,a=r.length;i<a;i++)r[i].fn!==t&&r[i].fn._!==t&&o.push(r[i]);return o.length?n[e]=o:delete n[e],this}},e.exports=t,e.exports.TinyEmitter=t}},t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}return n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n(686)}().default},e.exports=t()}(Uv);new(cn(Uv.exports))('[id$="-copy"]');document.querySelectorAll("[data-dialogs]").forEach(e=>{!function(e,t=3,n="/"){const r=window.location.pathname,o=e.id;if(window.localStorage.getItem(o))return;if(-1===r.indexOf(n))return;const i="pv-"+o;let a=parseInt(window.sessionStorage.getItem(i)||"0",10);a>=t&&function(e){e&&e.classList.remove("fr-hidden")}(e),a++,window.sessionStorage.setItem(i,a.toFixed(0))}(e);e.querySelectorAll("[data-dialogs-close]").forEach(t=>{t instanceof HTMLElement&&t.addEventListener("click",()=>function(e){e&&e.classList.add("fr-hidden"),window.localStorage.setItem(e.id,"true")}(e))})});function Wv(e){return`#/${e.dataset.updateUrl||e.getAttribute("aria-controls")}`}function Kv(e){e.forEach(e=>{const t=Wv(e),n=`#${e.dataset.previousUrl}`;if(n&&window.location.hash.startsWith(n)){const e=window.location.hash.slice(n.length);window.location.hash=`${t}/${e}`}if(window.location.hash.includes(t)){const t=e.getAttribute("aria-controls");t||console.error("TabButton without `aria-controls` ID.",e);const n=document.getElementById(t);n||console.error(`Unknown TabPanel with id '${t}'.`,e),dsfr(n).tabPanel.disclose()}})}function Yv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Jv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yv(Object(n),!0).forEach(function(t){Gv(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yv(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Gv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xv(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Object.keys(e).reduce((n,r)=>(t.includes(r)||(n[r]=rt(e[r])),n),{})}function Zv(e){return"function"==typeof e}function Qv(e,t,n){let r=e;const o=t.split(".");for(let i=0;i<o.length;i++){if(!r[o[i]])return n;r=r[o[i]]}return r}function ey(e,t,n){return Xe(()=>e.some(e=>Qv(t,e,{[n]:!1})[n]))}function ty(e,t,n){return Xe(()=>e.reduce((e,r)=>{const o=Qv(t,r,{[n]:!1})[n]||[];return e.concat(o)},[]))}function ny(e,t,n,r){return e.call(r,rt(t),rt(n),r)}function ry(e){return void 0!==e.$valid?!e.$valid:!e}function oy(e,t,n,r,o,i,a,s,l,c,u){const d=ct(!1),p=e.$params||{},h=ct(null);let f,m;e.$async?({$invalid:f,$unwatch:m}=function(e,t,n,r,o,i,a){let{$lazy:s,$rewardEarly:l}=o,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],u=arguments.length>8?arguments[8]:void 0,d=arguments.length>9?arguments[9]:void 0,p=arguments.length>10?arguments[10]:void 0;const h=ct(!!r.value),f=ct(0);n.value=!1;const m=ft([t,r].concat(c,p),()=>{if(s&&!r.value||l&&!d.value&&!n.value)return;let o;try{o=ny(e,t,u,a)}catch(c){o=Promise.reject(c)}f.value++,n.value=!!f.value,h.value=!1,Promise.resolve(o).then(e=>{f.value--,n.value=!!f.value,i.value=e,h.value=ry(e)}).catch(e=>{f.value--,n.value=!!f.value,i.value=e,h.value=!0})},{immediate:!0,deep:"object"==typeof t});return{$invalid:h,$unwatch:m}}(e.$validator,t,d,n,r,h,o,e.$watchTargets,l,c,u)):({$invalid:f,$unwatch:m}=function(e,t,n,r,o,i,a,s){let{$lazy:l,$rewardEarly:c}=r;return{$unwatch:()=>({}),$invalid:Xe(()=>{if(l&&!n.value||c&&!s.value)return!1;let r=!0;try{const n=ny(e,t,a,i);o.value=n,r=ry(n)}catch(u){o.value=u}return r})}}(e.$validator,t,n,r,h,o,l,c));const g=e.$message;return{$message:Zv(g)?Xe(()=>g(Xv({$pending:d,$invalid:f,$params:Xv(p),$model:t,$response:h,$validator:i,$propertyPath:s,$property:a}))):g||"",$params:p,$pending:d,$invalid:f,$response:h,$unwatch:m}}document.querySelectorAll("[data-select-sort]").forEach(e=>{e.querySelectorAll("option").forEach(e=>{e.disabled=!1}),e.form&&(e.addEventListener("change",t=>{var n;null===(n=e.form)||void 0===n||n.dispatchEvent(new Event("submit"))}),e.form.addEventListener("submit",t=>{var n,r;t.preventDefault(),e.value||(e.disabled=!0),null===(n=e.form)||void 0===n||n.submit(),null===(r=globalThis._paq)||void 0===r||r.push(["trackEvent","Search","Sort",e.value])}))});function iy(e){let{validations:t,state:n,key:r,parentKey:o,childResults:i,resultsCache:a,globalConfig:s={},instance:l,externalResults:c}=e;const u=o?`${o}.${r}`:r,{rules:d,nestedValidators:p,config:h,validationGroups:f}=function(){const e=rt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),t=Object.keys(e),n={},r={},o={};let i=null;return t.forEach(t=>{const a=e[t];switch(!0){case Zv(a.$validator):n[t]=a;break;case Zv(a):n[t]={$validator:a};break;case"$validationGroups"===t:i=a;break;case t.startsWith("$"):o[t]=a;break;default:r[t]=a}}),{rules:n,nestedValidators:r,config:o,validationGroups:i}}(t),m=Jv(Jv({},s),h),g=r?Xe(()=>{const e=rt(n);return e?rt(e[r]):void 0}):n,v=Jv({},rt(c)||{}),y=Xe(()=>{const e=rt(c);return r?e?rt(e[r]):void 0:e}),w=function(e,t,n,r,o,i,a,s,l){const c=Object.keys(e),u=r.get(o,e),d=ct(!1),p=ct(!1),h=ct(0);if(u){if(!u.$partial)return u;u.$unwatch(),d.value=u.$dirty.value}const f={$dirty:d,$path:o,$touch:()=>{d.value||(d.value=!0)},$reset:()=>{d.value&&(d.value=!1)},$commit:()=>{}};return c.length?(c.forEach(r=>{f[r]=oy(e[r],t,f.$dirty,i,a,r,n,o,l,p,h)}),f.$externalResults=Xe(()=>s.value?[].concat(s.value).map((e,t)=>({$propertyPath:o,$property:n,$validator:"$externalResults",$uid:`${o}-externalResult-${t}`,$message:e,$params:{},$response:null,$pending:!1})):[]),f.$invalid=Xe(()=>{const e=c.some(e=>rt(f[e].$invalid));return p.value=e,!!f.$externalResults.value.length||e}),f.$pending=Xe(()=>c.some(e=>rt(f[e].$pending))),f.$error=Xe(()=>!!f.$dirty.value&&(f.$pending.value||f.$invalid.value)),f.$silentErrors=Xe(()=>c.filter(e=>rt(f[e].$invalid)).map(e=>{const t=f[e];return $t({$propertyPath:o,$property:n,$validator:e,$uid:`${o}-${e}`,$message:t.$message,$params:t.$params,$response:t.$response,$pending:t.$pending})}).concat(f.$externalResults.value)),f.$errors=Xe(()=>f.$dirty.value?f.$silentErrors.value:[]),f.$unwatch=()=>c.forEach(e=>{f[e].$unwatch()}),f.$commit=()=>{p.value=!0,h.value=Date.now()},r.set(o,e,f),f):(u&&r.set(o,e,f),f)}(d,g,r,a,u,m,l,y,n),b=function(e,t,n,r,o,i,a){const s=Object.keys(e);return s.length?s.reduce((s,l)=>(s[l]=iy({validations:e[l],state:t,key:l,parentKey:n,resultsCache:r,globalConfig:o,instance:i,externalResults:a}),s),{}):{}}(p,g,u,a,m,l,y),k={};f&&Object.entries(f).forEach(e=>{let[t,n]=e;k[t]={$invalid:ey(n,b,"$invalid"),$error:ey(n,b,"$error"),$pending:ey(n,b,"$pending"),$errors:ty(n,b,"$errors"),$silentErrors:ty(n,b,"$silentErrors")}});const{$dirty:x,$errors:C,$invalid:S,$anyDirty:M,$error:T,$pending:O,$touch:_,$reset:N,$silentErrors:E,$commit:D}=function(e,t,n){const r=Xe(()=>[t,n].filter(e=>e).reduce((e,t)=>e.concat(Object.values(rt(t))),[])),o=Xe({get:()=>e.$dirty.value||!!r.value.length&&r.value.every(e=>e.$dirty),set(t){e.$dirty.value=t}}),i=Xe(()=>{const t=rt(e.$silentErrors)||[],n=r.value.filter(e=>(rt(e).$silentErrors||[]).length).reduce((e,t)=>e.concat(...t.$silentErrors),[]);return t.concat(n)}),a=Xe(()=>{const t=rt(e.$errors)||[],n=r.value.filter(e=>(rt(e).$errors||[]).length).reduce((e,t)=>e.concat(...t.$errors),[]);return t.concat(n)}),s=Xe(()=>r.value.some(e=>e.$invalid)||rt(e.$invalid)||!1),l=Xe(()=>r.value.some(e=>rt(e.$pending))||rt(e.$pending)||!1),c=Xe(()=>r.value.some(e=>e.$dirty)||r.value.some(e=>e.$anyDirty)||o.value),u=Xe(()=>!!o.value&&(l.value||s.value)),d=()=>{e.$touch(),r.value.forEach(e=>{e.$touch()})};return r.value.length&&r.value.every(e=>e.$dirty)&&d(),{$dirty:o,$errors:a,$invalid:s,$anyDirty:c,$error:u,$pending:l,$touch:d,$reset:()=>{e.$reset(),r.value.forEach(e=>{e.$reset()})},$silentErrors:i,$commit:()=>{e.$commit(),r.value.forEach(e=>{e.$commit()})}}}(w,b,i),A=r?Xe({get:()=>rt(g),set:e=>{x.value=!0;const t=rt(n),o=rt(c);o&&(o[r]=v[r]),xt(t[r])?t[r].value=e:t[r]=e}}):null;return r&&m.$autoDirty&&ft(g,()=>{x.value||_();const e=rt(c);e&&(e[r]=v[r])},{flush:"sync"}),$t(Jv(Jv(Jv({},w),{},{$model:A,$dirty:x,$error:T,$errors:C,$invalid:S,$anyDirty:M,$pending:O,$touch:_,$reset:N,$path:u||"__root",$silentErrors:E,$validate:async function(){return _(),m.$rewardEarly&&(D(),await gt()),await gt(),new Promise(e=>{if(!O.value)return e(!S.value);const t=ft(O,()=>{e(!S.value),t()})})},$commit:D},i&&{$getResultsForChild:function(e){return(i.value||{})[e]},$clearExternalResults:function(){xt(c)?c.value=v:0===Object.keys(v).length?Object.keys(c).forEach(e=>{delete c[e]}):Object.assign(c,v)},$validationGroups:k}),b))}class ay{constructor(){this.storage=new Map}set(e,t,n){this.storage.set(e,{rules:t,result:n})}checkRulesValidity(e,t,n){const r=Object.keys(n),o=Object.keys(t);if(o.length!==r.length)return!1;return!!o.every(e=>r.includes(e))&&o.every(e=>!t[e].$params||Object.keys(t[e].$params).every(r=>rt(n[e].$params[r])===rt(t[e].$params[r])))}get(e,t){const n=this.storage.get(e);if(!n)return;const{rules:r,result:o}=n,i=this.checkRulesValidity(e,t,r),a=o.$unwatch?o.$unwatch:()=>({});return i?o:{$dirty:o.$dirty,$partial:!0,$unwatch:a}}}const sy={COLLECT_ALL:!0,COLLECT_NONE:!1},ly=Symbol("vuelidate#injectChildResults"),cy=Symbol("vuelidate#removeChildResults");function uy(e){return new Proxy(e,{get:(e,t)=>"object"==typeof e[t]?uy(e[t]):Xe(()=>e[t])})}let dy=0;function py(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};1===arguments.length&&(r=e,e=void 0,t=void 0);let{$registerAs:o,$scope:i=sy.COLLECT_ALL,$stopPropagation:a,$externalResults:s,currentVueInstance:l}=r;const c=l||(null===(n=vt())||void 0===n?void 0:n.proxy),u=c?c.$options:{};o||(dy+=1,o=`_vuelidate_${dy}`);const d=ct({}),p=new ay,{childResults:h,sendValidationResultsToParent:f,removeValidationResultsFromParent:m}=c?function(e){let{$scope:t,instance:n}=e;const r={},o=ct([]),i=Xe(()=>o.value.reduce((e,t)=>(e[t]=rt(r[t]),e),{}));n.__vuelidateInjectInstances=[].concat(n.__vuelidateInjectInstances||[],function(e,n){let{$registerAs:i,$scope:a,$stopPropagation:s}=n;s||t===sy.COLLECT_NONE||a===sy.COLLECT_NONE||t!==sy.COLLECT_ALL&&t!==a||(r[i]=e,o.value.push(i))}),n.__vuelidateRemoveInstances=[].concat(n.__vuelidateRemoveInstances||[],function(e){o.value=o.value.filter(t=>t!==e),delete r[e]});const a=Je(ly,[]);Et(ly,n.__vuelidateInjectInstances);const s=Je(cy,[]);return Et(cy,n.__vuelidateRemoveInstances),{childResults:i,sendValidationResultsToParent:a,removeValidationResultsFromParent:s}}({$scope:i,instance:c}):{childResults:ct({})};if(!e&&u.validations){const e=u.validations;t=ct({}),Ht(()=>{t.value=c,ft(()=>Zv(e)?e.call(t.value,new uy(t.value)):e,e=>{d.value=iy({validations:e,state:t,childResults:h,resultsCache:p,globalConfig:r,instance:c,externalResults:s||c.vuelidateExternalResults})},{immediate:!0})}),r=u.validationsConfig||r}else{const n=xt(e)||(Zt(g=e)||Qt(g))?e:$t(e||{});ft(n,e=>{d.value=iy({validations:e,state:t,childResults:h,resultsCache:p,globalConfig:r,instance:null!=c?c:{},externalResults:s})},{immediate:!0})}var g;return c&&(f.forEach(e=>e(d,{$registerAs:o,$scope:i,$stopPropagation:a})),Ut(()=>m.forEach(e=>e(o)))),Xe(()=>Jv(Jv({},rt(d.value)),h.value))}function hy(e,t,n,r=!1){const o=py(t,e,{$scope:r}),i=py(n,e,{$scope:"warning"});return{getErrorText:e=>(i.value[e].$dirty&&o.value[e].$touch(),o.value[e].$errors.map(e=>e.$message).join("\n")),getFunctionalState:fy,getWarningText:e=>i.value[e].$errors.map(e=>e.$message).join("\n"),hasError:my,hasWarning:gy,reset:()=>{i.value.$reset(),o.value.$reset()},validateRequiredRules:()=>(i.value.$validate(),o.value.$validate(),o.value.$validate()),v$:o,vWarning$:i}}const fy=(e,t,n)=>e?t?"error":n?"warning":"success":"disabled",my=(e,t)=>"error"===ht(e)[t],gy=(e,t)=>"warning"===ht(e)[t],vy=["for"],yy={key:0,class:"fr-hint-text"},wy=["aria-describedby","id","required","disabled"],by=["selected"],ky=["value","selected","disabled","hidden"],xy=["id"],Cy=["id"],Sy=Ye({__name:"SelectGroup",props:{disabled:{type:Boolean,default:!1},errorText:{default:""},hasError:{type:Boolean,default:!1},hintText:{default:""},isValid:{type:Boolean,default:!1},label:{},modelValue:{default:void 0},options:{},required:{type:Boolean,default:!1},validText:{default:""}},emits:["update:modelValue"],setup(e,{emit:t}){const n=t,r=e,{id:o}=Bc("select"),i=Xe(()=>o+"-desc-error"),a=Xe(()=>o+"-desc-valid"),s=Xe(()=>{let e="";return r.isValid?e+=" "+a:r.hasError&&(e+=" "+i),e}),l=Xe(()=>({"fr-select-group--disabled":r.disabled,"fr-select-group--error":r.hasError,"fr-select-group--valid":r.isValid})),c=e=>{var t;const r=e.target;n("update:modelValue",null!==(t=null==r?void 0:r.value)&&void 0!==t?t:"")};return(t,n)=>(Ze(),Qe("div",{class:lt(["fr-select-group",l.value])},[dt("label",{class:"fr-label",for:rt(o)},[Tt(pt(e.label)+" ",1),ut(rp,{required:e.required},null,8,["required"]),e.hintText?(Ze(),Qe("span",yy,pt(e.hintText),1)):st("",!0)],8,vy),dt("select",{class:lt(["fr-select",{"fr-select--error":e.hasError,"fr-select--valid":e.isValid}]),"aria-describedby":s.value,id:rt(o),required:e.required,disabled:e.disabled,onChange:c},[dt("option",{value:"",selected:!e.modelValue,disabled:"",hidden:""},pt(t.$t("Select an option")),9,by),(Ze(!0),Qe(Mt,null,Pt(e.options,e=>(Ze(),Qe("option",{value:e.value,selected:e.selected,disabled:e.disabled,hidden:e.hidden},pt(e.label),9,ky))),256))],42,wy),e.isValid?(Ze(),Qe("p",{key:0,id:a.value,class:"fr-valid-text"},pt(e.validText),9,xy)):e.hasError?(Ze(),Qe("p",{key:1,id:i.value,class:"fr-error-text"},pt(e.errorText),9,Cy)):st("",!0)],2))}});!function(){try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode(".v3dp__popout[data-v-65eb861b]{z-index:10;position:absolute;text-align:center;width:17.5em;background-color:var(--popout-bg-color);box-shadow:var(--box-shadow);border-radius:var(--border-radius);padding:8px 0 1em;color:var(--text-color)}.v3dp__popout *[data-v-65eb861b]{color:inherit;font-size:inherit;font-weight:inherit}.v3dp__popout[data-v-65eb861b] button{background:none;border:none;outline:none}.v3dp__popout[data-v-65eb861b] button:not(:disabled){cursor:pointer}.v3dp__heading[data-v-65eb861b]{width:100%;display:flex;height:var(--heading-size);line-height:var(--heading-size);font-weight:var(--heading-weight)}.v3dp__heading__button[data-v-65eb861b]{background:none;border:none;padding:0;display:flex;justify-content:center;align-items:center;width:var(--heading-size)}button.v3dp__heading__center[data-v-65eb861b]:hover,.v3dp__heading__button[data-v-65eb861b]:not(:disabled):hover{background-color:var(--heading-hover-color)}.v3dp__heading__center[data-v-65eb861b]{flex:1}.v3dp__heading__icon[data-v-65eb861b]{height:12px;stroke:var(--arrow-color)}.v3dp__heading__button:disabled .v3dp__heading__icon[data-v-65eb861b]{stroke:var(--elem-disabled-color)}.v3dp__subheading[data-v-65eb861b],.v3dp__elements[data-v-65eb861b]{display:grid;grid-template-columns:var(--popout-column-definition);font-size:var(--elem-font-size)}.v3dp__subheading[data-v-65eb861b]{margin-top:1em}.v3dp__divider[data-v-65eb861b]{border:1px solid var(--divider-color);border-radius:3px}.v3dp__elements[data-v-65eb861b] button:disabled{color:var(--elem-disabled-color)}.v3dp__elements[data-v-65eb861b] button{padding:.3em .6em}.v3dp__elements[data-v-65eb861b] button span{display:block;line-height:1.9em;height:1.8em;border-radius:var(--elem-border-radius)}.v3dp__elements[data-v-65eb861b] button:not(:disabled):hover span{background-color:var(--elem-hover-bg-color);color:var(--elem-hover-color)}.v3dp__elements[data-v-65eb861b] button.selected span{background-color:var(--elem-selected-bg-color);color:var(--elem-selected-color)}.v3dp__elements[data-v-65eb861b] button.current span{font-weight:var(--elem-current-font-weight);outline:1px solid var(--elem-current-outline-color)}.v3dp__column[data-v-81ac698d]{display:flex;flex-direction:column;overflow-y:auto;height:190px}.v3dp__datepicker{--popout-bg-color: var(--vdp-bg-color, #fff);--box-shadow: var( --vdp-box-shadow, 0 4px 10px 0 rgba(128, 144, 160, .1), 0 0 1px 0 rgba(128, 144, 160, .81) );--text-color: var(--vdp-text-color, #000000);--border-radius: var(--vdp-border-radius, 3px);--heading-size: var(--vdp-heading-size, 2.5em);--heading-weight: var(--vdp-heading-weight, bold);--heading-hover-color: var(--vdp-heading-hover-color, #eeeeee);--arrow-color: var(--vdp-arrow-color, currentColor);--elem-color: var(--vdp-elem-color, currentColor);--elem-disabled-color: var(--vdp-disabled-color, #d5d9e0);--elem-hover-color: var(--vdp-hover-color, #fff);--elem-hover-bg-color: var(--vdp-hover-bg-color, #0baf74);--elem-selected-color: var(--vdp-selected-color, #fff);--elem-selected-bg-color: var(--vdp-selected-bg-color, #0baf74);--elem-current-outline-color: var(--vdp-current-date-outline-color, #888);--elem-current-font-weight: var(--vdp-current-date-font-weight, bold);--elem-font-size: var(--vdp-elem-font-size, .8em);--elem-border-radius: var(--vdp-elem-border-radius, 3px);--divider-color: var(--vdp-divider-color, var(--elem-disabled-color));position:relative}.v3dp__clearable{display:inline;position:relative;left:-15px;cursor:pointer}")),document.head.appendChild(e)}}catch(Uo){console.error("vite-plugin-css-injected-by-js",Uo)}}();const My=["year","month","day","time","custom"],Ty=Ye({emits:{elementClick:e=>Ep(e),left:()=>!0,right:()=>!0,heading:()=>!0},props:{headingClickable:{type:Boolean,default:!1},leftDisabled:{type:Boolean,default:!1},rightDisabled:{type:Boolean,default:!1},columnCount:{type:Number,default:7},items:{type:Array,default:()=>[]},viewMode:{type:String,required:!0,validate:e=>"string"==typeof e&&My.includes(e)}}}),Oy=(e,t)=>{const n=e.__vccOpts||e;for(const[r,o]of t)n[r]=o;return n},_y=e=>(en("data-v-65eb861b"),e=e(),tn(),e),Ny={class:"v3dp__heading"},Ey=["disabled"],Dy=_y(()=>dt("svg",{class:"v3dp__heading__icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 6 8"},[dt("g",{fill:"none","fill-rule":"evenodd"},[dt("path",{stroke:"none",d:"M-9 16V-8h24v24z"}),dt("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 0L1 4l4 4"})])],-1)),Ay=["disabled"],$y=_y(()=>dt("svg",{class:"v3dp__heading__icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 6 8"},[dt("g",{fill:"none","fill-rule":"evenodd"},[dt("path",{stroke:"none",d:"M15-8v24H-9V-8z"}),dt("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M1 8l4-4-4-4"})])],-1)),Ry={class:"v3dp__body"},Ly={class:"v3dp__subheading"},Iy=_y(()=>dt("hr",{class:"v3dp__divider"},null,-1)),Py={class:"v3dp__elements"},zy=["disabled","onClick"];const By=Oy(Ty,[["render",function(e,t,n,r,o,i){return Ze(),Qe("div",{class:lt(["v3dp__popout",`v3dp__popout-${e.viewMode}`]),style:Lt({"--popout-column-definition":`repeat(${e.columnCount}, 1fr)`}),onMousedown:t[3]||(t[3]=zt(()=>{},["prevent"]))},[dt("div",Ny,[dt("button",{class:"v3dp__heading__button v3dp__heading__button__left",disabled:e.leftDisabled,onClick:t[0]||(t[0]=zt(t=>e.$emit("left"),["stop","prevent"]))},[tt(e.$slots,"arrow-left",{},()=>[Dy],!0)],8,Ey),(Ze(),nt(It(e.headingClickable?"button":"span"),{class:"v3dp__heading__center",onClick:t[1]||(t[1]=zt(t=>e.$emit("heading"),["stop","prevent"]))},{default:it(()=>[tt(e.$slots,"heading",{},void 0,!0)]),_:3})),dt("button",{class:"v3dp__heading__button v3dp__heading__button__right",disabled:e.rightDisabled,onClick:t[2]||(t[2]=zt(t=>e.$emit("right"),["stop","prevent"]))},[tt(e.$slots,"arrow-right",{},()=>[$y],!0)],8,Ay)]),dt("div",Ry,["subheading"in e.$slots?(Ze(),Qe(Mt,{key:0},[dt("div",Ly,[tt(e.$slots,"subheading",{},void 0,!0)]),Iy],64)):st("",!0),dt("div",Py,[tt(e.$slots,"body",{},()=>[(Ze(!0),Qe(Mt,null,Pt(e.items,t=>(Ze(),Qe("button",{key:t.key,disabled:t.disabled,class:lt([{selected:t.selected,current:t.current},`v3dp__element__button__${e.viewMode}`]),onClick:zt(n=>e.$emit("elementClick",t.value),["stop","prevent"])},[dt("span",null,pt(t.display),1)],10,zy))),128))],!0)])])],38)}],["__scopeId","data-v-65eb861b"]]),Fy=Ye({components:{PickerPopup:By},emits:{"update:pageDate":e=>Ep(e),select:e=>Ep(e)},props:{selected:{type:Date,required:!1},pageDate:{type:Date,required:!0},lowerLimit:{type:Date,required:!1},upperLimit:{type:Date,required:!1}},setup(e,{emit:t}){const n=Xe(()=>function(e){bp(1,arguments);var t=kp(e),n=t.getFullYear(),r=10*Math.floor(n/10);return t.setFullYear(r,0,1),t.setHours(0,0,0,0),t}(e.pageDate)),r=Xe(()=>function(e){bp(1,arguments);var t=kp(e),n=t.getFullYear(),r=9+10*Math.floor(n/10);return t.setFullYear(r,11,31),t.setHours(23,59,59,999),t}(e.pageDate)),o=(e,t,n)=>!t&&!n||!(t&&bh(e)<bh(t)||n&&bh(e)>bh(n)),i=Xe(()=>function(e){bp(1,arguments);var t=e||{},n=kp(t.start),r=kp(t.end).getTime();if(!(n.getTime()<=r))throw new RangeError("Invalid interval");var o=[],i=n;for(i.setHours(0,0,0,0),i.setMonth(0,1);i.getTime()<=r;)o.push(kp(i)),i.setFullYear(i.getFullYear()+1);return o}({start:n.value,end:r.value}).map(t=>({value:t,key:String(bh(t)),display:bh(t),selected:!!e.selected&&bh(t)===bh(e.selected),disabled:!o(t,e.lowerLimit,e.upperLimit)})));return{years:i,heading:Xe(()=>`${bh(n.value)} - ${bh(r.value)}`),leftDisabled:Xe(()=>e.lowerLimit&&(wh(e.lowerLimit)===wh(e.pageDate)||xh(e.pageDate,e.lowerLimit))),rightDisabled:Xe(()=>e.upperLimit&&(wh(e.upperLimit)===wh(e.pageDate)||kh(e.pageDate,e.upperLimit))),previousPage:()=>t("update:pageDate",gm(e.pageDate,10)),nextPage:()=>t("update:pageDate",_p(e.pageDate,10))}}});const jy=Oy(Fy,[["render",function(e,t,n,r,o,i){const a=jt("picker-popup");return Ze(),nt(a,{columnCount:3,leftDisabled:e.leftDisabled,rightDisabled:e.rightDisabled,items:e.years,viewMode:"year",onLeft:e.previousPage,onRight:e.nextPage,onElementClick:t[0]||(t[0]=t=>e.$emit("select",t))},{heading:it(()=>[Tt(pt(e.heading),1)]),_:1},8,["leftDisabled","rightDisabled","items","onLeft","onRight"])}]]),Vy=Ye({components:{PickerPopup:By},emits:{"update:pageDate":e=>Ep(e),select:e=>Ep(e),back:()=>!0},props:{selected:{type:Date,required:!1},pageDate:{type:Date,required:!0},format:{type:String,required:!1,default:"LLL"},locale:{type:Object,required:!1},lowerLimit:{type:Date,required:!1},upperLimit:{type:Date,required:!1}},setup(e,{emit:t}){const n=Xe(()=>function(e){bp(1,arguments);var t=kp(e),n=new Date(0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}(e.pageDate)),r=Xe(()=>function(e){bp(1,arguments);var t=kp(e),n=t.getFullYear();return t.setFullYear(n+1,0,0),t.setHours(23,59,59,999),t}(e.pageDate)),o=Xe(()=>t=>vh(t,e.format,{locale:e.locale})),i=(e,t,n)=>!t&&!n||!(t&&xh(e,$p(t))||n&&kh(e,Dp(n))),a=Xe(()=>function(e){bp(1,arguments);var t=e||{},n=kp(t.start),r=kp(t.end).getTime(),o=[];if(!(n.getTime()<=r))throw new RangeError("Invalid interval");var i=n;for(i.setHours(0,0,0,0),i.setDate(1);i.getTime()<=r;)o.push(kp(i)),i.setMonth(i.getMonth()+1);return o}({start:n.value,end:r.value}).map(t=>({value:t,display:o.value(t),key:o.value(t),selected:!!e.selected&&um(e.selected,t),disabled:!i(t,e.lowerLimit,e.upperLimit)})));return{months:a,heading:Xe(()=>bh(n.value)),leftDisabled:Xe(()=>e.lowerLimit&&(dm(e.lowerLimit,e.pageDate)||xh(e.pageDate,e.lowerLimit))),rightDisabled:Xe(()=>e.upperLimit&&(dm(e.upperLimit,e.pageDate)||kh(e.pageDate,e.upperLimit))),previousPage:()=>t("update:pageDate",gm(e.pageDate,1)),nextPage:()=>t("update:pageDate",_p(e.pageDate,1))}}});const qy=Oy(Vy,[["render",function(e,t,n,r,o,i){const a=jt("picker-popup");return Ze(),nt(a,{headingClickable:"",columnCount:3,items:e.months,leftDisabled:e.leftDisabled,rightDisabled:e.rightDisabled,viewMode:"month",onLeft:e.previousPage,onRight:e.nextPage,onHeading:t[0]||(t[0]=t=>e.$emit("back")),onElementClick:t[1]||(t[1]=t=>e.$emit("select",t))},{heading:it(()=>[Tt(pt(e.heading),1)]),_:1},8,["items","leftDisabled","rightDisabled","onLeft","onRight"])}]]),Hy=Ye({components:{PickerPopup:By},emits:{"update:pageDate":e=>Ep(e),select:e=>Ep(e),back:()=>!0},props:{selected:{type:Date,required:!1},pageDate:{type:Date,required:!0},format:{type:String,required:!1,default:"dd"},headingFormat:{type:String,required:!1,default:"LLLL yyyy"},weekdayFormat:{type:String,required:!1,default:"EE"},locale:{type:Object,required:!1},weekStartsOn:{type:Number,required:!1,default:1,validator:e=>"number"==typeof e&&Number.isInteger(e)&&e>=0&&e<=6},lowerLimit:{type:Date,required:!1},upperLimit:{type:Date,required:!1},disabledDates:{type:Object,required:!1},allowOutsideInterval:{type:Boolean,required:!1,default:!1}},setup(e,{emit:t}){const n=Xe(()=>t=>n=>vh(n,t,{locale:e.locale,weekStartsOn:e.weekStartsOn})),r=Xe(()=>$p(e.pageDate)),o=Xe(()=>Dp(e.pageDate)),i=Xe(()=>({start:r.value,end:o.value})),a=Xe(()=>({start:Mp(r.value,{weekStartsOn:e.weekStartsOn}),end:Rp(o.value,{weekStartsOn:e.weekStartsOn})})),s=Xe(()=>{const t=e.weekStartsOn,r=n.value(e.weekdayFormat);return Array.from(Array(7)).map((e,n)=>(t+n)%7).map(t=>mm(new Date,t,{weekStartsOn:e.weekStartsOn})).map(r)}),l=(e,t,n,r)=>{var o,i;return!(null!=(o=null==r?void 0:r.dates)&&o.some(t=>Np(e,t))||null!=(i=null==r?void 0:r.predicate)&&i.call(r,e))&&(!t&&!n||!(t&&xh(e,Op(t))||n&&kh(e,function(e){bp(1,arguments);var t=kp(e);return t.setHours(23,59,59,999),t}(n))))},c=Xe(()=>{const t=new Date,r=n.value(e.format);return function(e,t){var n;bp(1,arguments);var r=e||{},o=kp(r.start),i=kp(r.end).getTime();if(!(o.getTime()<=i))throw new RangeError("Invalid interval");var a=[],s=o;s.setHours(0,0,0,0);var l=Number(null!==(n=null==t?void 0:t.step)&&void 0!==n?n:1);if(l<1||isNaN(l))throw new RangeError("`options.step` must be a number greater than 1");for(;s.getTime()<=i;)a.push(kp(s)),s.setDate(s.getDate()+l),s.setHours(0,0,0,0);return a}(a.value).map(o=>({value:o,display:r(o),selected:!!e.selected&&Np(e.selected,o),current:Np(t,o),disabled:!e.allowOutsideInterval&&!pm(o,i.value)||!l(o,e.lowerLimit,e.upperLimit,e.disabledDates),key:n.value("yyyy-MM-dd")(o)}))});return{weekDays:s,days:c,heading:Xe(()=>n.value(e.headingFormat)(e.pageDate)),leftDisabled:Xe(()=>e.lowerLimit&&(um(e.lowerLimit,e.pageDate)||xh(e.pageDate,e.lowerLimit))),rightDisabled:Xe(()=>e.upperLimit&&(um(e.upperLimit,e.pageDate)||kh(e.pageDate,e.upperLimit))),previousPage:()=>t("update:pageDate",function(e,t){return bp(2,arguments),xp(e,-wp(t))}(e.pageDate,1)),nextPage:()=>t("update:pageDate",xp(e.pageDate,1))}}});const Uy=Oy(Hy,[["render",function(e,t,n,r,o,i){const a=jt("picker-popup");return Ze(),nt(a,{headingClickable:"",leftDisabled:e.leftDisabled,rightDisabled:e.rightDisabled,items:e.days,viewMode:"day",onLeft:e.previousPage,onRight:e.nextPage,onHeading:t[0]||(t[0]=t=>e.$emit("back")),onElementClick:t[1]||(t[1]=t=>e.$emit("select",t))},{heading:it(()=>[Tt(pt(e.heading),1)]),subheading:it(()=>[(Ze(!0),Qe(Mt,null,Pt(e.weekDays,(e,t)=>(Ze(),Qe("span",{key:e,class:lt(`v3dp__subheading__weekday__${t}`)},pt(e),3))),128))]),_:1},8,["leftDisabled","rightDisabled","items","onLeft","onRight"])}]]);function Wy(e,t){const n=e.getBoundingClientRect(),r=e.clientHeight,o=(e.clientWidth,t.getBoundingClientRect());if(!(o.top>=n.top&&o.bottom<=n.top+r)){const t=o.top-n.top,r=o.bottom-n.bottom;Math.abs(t)<Math.abs(r)?e.scrollTop+=t:e.scrollTop+=r}}const Ky=Ye({components:{PickerPopup:By},emits:{select:e=>Ep(e),back:()=>!0},props:{selected:{type:Date,required:!1},pageDate:{type:Date,required:!0},visible:{type:Boolean,required:!0},disabledTime:{type:Object,required:!1}},setup(e,{emit:t}){const n=ct(null),r=ct(null),o=Xe(()=>{var t;return null!==(t=e.pageDate)&&void 0!==t?t:e.selected}),i=ct(o.value.getHours()),a=ct(o.value.getMinutes());ft(()=>e.selected,e=>{let t=0,n=0;e&&(t=e.getHours(),n=e.getMinutes()),i.value=t,a.value=n});const s=Xe(()=>[...Array(24).keys()].map(e=>({value:e,date:fm(new Date(o.value.getTime()),{hours:e,minutes:a.value,seconds:0}),selected:i.value===e,ref:ct(null)}))),l=Xe(()=>[...Array(60).keys()].map(e=>({value:e,date:fm(new Date(o.value.getTime()),{hours:i.value,minutes:e,seconds:0}),selected:a.value===e,ref:ct(null)}))),c=()=>{const e=s.value.find(e=>{var t,n,r;return null!==(t=null==(r=null==(n=e.ref.value)?void 0:n.classList)?void 0:r.contains("selected"))&&void 0!==t&&t}),t=l.value.find(e=>{var t,n,r;return null!==(t=null==(r=null==(n=e.ref.value)?void 0:n.classList)?void 0:r.contains("selected"))&&void 0!==t&&t});e&&t&&(Wy(n.value,e.ref.value),Wy(r.value,t.ref.value))};return ft(()=>e.visible,e=>{e&&gt(c)}),{hoursListRef:n,minutesListRef:r,hours:i,minutes:a,hoursList:s,minutesList:l,padStartZero:e=>`0${e}`.substr(-2),selectMinutes:e=>{a.value=e.value,t("select",e.date)},isEnabled:t=>{var n,r,o,i;return!(null!=(r=null==(n=e.disabledTime)?void 0:n.dates)&&r.some(e=>function(e,t){bp(2,arguments);var n=cm(e),r=cm(t);return n.getTime()===r.getTime()}(t,e)&&function(e,t){bp(2,arguments);var n=Ap(e),r=Ap(t);return n.getTime()===r.getTime()}(t,e))||null!=(i=null==(o=e.disabledTime)?void 0:o.predicate)&&i.call(o,t))},scroll:c}}}),Yy={ref:"hoursListRef",class:"v3dp__column"},Jy=["disabled","onClick"],Gy={ref:"minutesListRef",class:"v3dp__column"},Xy=["disabled","onClick"];const Zy=Oy(Ky,[["render",function(e,t,n,r,o,i){const a=jt("picker-popup");return Ze(),nt(a,{headingClickable:"",columnCount:2,leftDisabled:!0,rightDisabled:!0,viewMode:"time",onHeading:t[0]||(t[0]=t=>e.$emit("back"))},{heading:it(()=>[Tt(pt(e.padStartZero(e.hours))+":"+pt(e.padStartZero(e.minutes)),1)]),body:it(()=>[dt("div",Yy,[(Ze(!0),Qe(Mt,null,Pt(e.hoursList,t=>(Ze(),Qe("button",{key:t.value,ref_for:!0,ref:t.ref,class:lt([{selected:t.selected},"v3dp__element_button__hour"]),disabled:!e.isEnabled(t.date),onClick:zt(n=>e.hours=t.value,["stop","prevent"])},[dt("span",null,pt(e.padStartZero(t.value)),1)],10,Jy))),128))],512),dt("div",Gy,[(Ze(!0),Qe(Mt,null,Pt(e.minutesList,t=>(Ze(),Qe("button",{key:t.value,ref_for:!0,ref:t.ref,class:lt([{selected:t.selected},"v3dp__element_button__minute"]),disabled:!e.isEnabled(t.date),onClick:zt(n=>e.selectMinutes(t),["stop","prevent"])},[dt("span",null,pt(e.padStartZero(t.value)),1)],10,Xy))),128))],512)]),_:1})}],["__scopeId","data-v-81ac698d"]]),Qy=["time","day","month","year"],ew=(e,t,n=void 0)=>{let r=n||new Date;return e&&(r=function(e){var t,n;if(bp(1,arguments),e&&"function"==typeof e.forEach)t=e;else{if("object"!==yp(e)||null===e)return new Date(NaN);t=Array.prototype.slice.call(e)}return t.forEach(function(e){var t=kp(e);(void 0===n||n<t||isNaN(Number(t)))&&(n=t)}),n||new Date(NaN)}([e,r])),t&&(r=function(e){var t,n;if(bp(1,arguments),e&&"function"==typeof e.forEach)t=e;else{if("object"!==yp(e)||null===e)return new Date(NaN);t=Array.prototype.slice.call(e)}return t.forEach(function(e){var t=kp(e);(void 0===n||n>t||isNaN(t.getDate()))&&(n=t)}),n||new Date(NaN)}([t,r])),r},tw=Ye({components:{YearPicker:jy,MonthPicker:qy,DayPicker:Uy,TimePicker:Zy},inheritAttrs:!1,props:{placeholder:{type:String,default:""},modelValue:{type:Date,required:!1},disabledDates:{type:Object,required:!1},allowOutsideInterval:{type:Boolean,required:!1,default:!1},disabledTime:{type:Object,required:!1},upperLimit:{type:Date,required:!1},lowerLimit:{type:Date,required:!1},startingView:{type:String,required:!1,default:"day",validate:e=>"string"==typeof e&&Qy.includes(e)},startingViewDate:{type:Date,required:!1,default:()=>new Date},dayPickerHeadingFormat:{type:String,required:!1,default:"LLLL yyyy"},monthListFormat:{type:String,required:!1,default:"LLL"},weekdayFormat:{type:String,required:!1,default:"EE"},dayFormat:{type:String,required:!1,default:"dd"},inputFormat:{type:String,required:!1,default:"yyyy-MM-dd"},locale:{type:Object,required:!1},weekStartsOn:{type:Number,required:!1,default:1,validator:e=>[0,1,2,3,4,5,6].includes(e)},disabled:{type:Boolean,required:!1,default:!1},clearable:{type:Boolean,required:!1,default:!1},typeable:{type:Boolean,required:!1,default:!1},minimumView:{type:String,required:!1,default:"day",validate:e=>"string"==typeof e&&Qy.includes(e)}},emits:{"update:modelValue":e=>null==e||Ep(e),decadePageChanged:e=>!0,yearPageChanged:e=>!0,monthPageChanged:e=>!0,opened:()=>!0,closed:()=>!0},setup(e,{emit:t,attrs:n}){const r=ct("none"),o=ct(e.startingViewDate),i=ct(null),a=ct(!1),s=ct("");St(()=>{const t=lm(s.value,e.inputFormat,new Date,{locale:e.locale});Ep(t)&&(o.value=t)}),St(()=>s.value=e.modelValue&&Ep(e.modelValue)?vh(e.modelValue,e.inputFormat,{locale:e.locale}):"");const l=(n="none")=>{e.disabled||("none"!==n&&"none"===r.value&&(o.value=e.modelValue||ew(e.lowerLimit,e.upperLimit,o.value)),r.value=n,t("none"!==n?"opened":"closed"))};St(()=>{e.disabled&&(r.value="none")});const c=Xe(()=>Qy.indexOf(e.startingView)<Qy.indexOf(e.minimumView)?e.minimumView:e.startingView);return{blur:()=>{a.value=!1,l()},focus:()=>l(c.value),click:()=>a.value=!0,input:s,inputRef:i,pageDate:o,renderView:l,updatePageDate:(e,n)=>{o.value=n,"year"===e?t("decadePageChanged",n):"month"===e?t("yearPageChanged",n):"day"===e&&t("monthPageChanged",n)},selectYear:n=>{o.value=n,"year"===e.minimumView?(l("none"),t("update:modelValue",n)):r.value="month"},selectMonth:n=>{o.value=n,"month"===e.minimumView?(l("none"),t("update:modelValue",n)):r.value="day"},selectDay:n=>{o.value=n,"day"===e.minimumView?(l("none"),t("update:modelValue",n)):r.value="time"},selectTime:e=>{l("none"),t("update:modelValue",e)},keyUp:n=>{const r=n.keyCode?n.keyCode:n.which;if([27,13].includes(r)&&i.value.blur(),e.typeable){const n=lm(i.value.value,e.inputFormat,new Date,{locale:e.locale});Ep(n)&&s.value===vh(n,e.inputFormat,{locale:e.locale})&&(s.value=i.value.value,t("update:modelValue",n))}},viewShown:r,goBackFromTimepicker:()=>"time"===e.startingView&&"time"===e.minimumView?null:r.value="day",clearModelValue:()=>{e.clearable&&(l("none"),t("update:modelValue",null),o.value=e.startingViewDate)},initialView:c,log:e=>console.log(e),variables:e=>Object.fromEntries(Object.entries(null!=e?e:{}).filter(([e,t])=>e.startsWith("--")))}}}),nw={class:"v3dp__input_wrapper"},rw=["readonly","placeholder","disabled","tabindex"],ow={class:"v3dp__clearable"};const iw=Oy(tw,[["render",function(e,t,n,r,o,i){const a=jt("year-picker"),s=jt("month-picker"),l=jt("day-picker"),c=jt("time-picker");return Ze(),Qe("div",{class:"v3dp__datepicker",style:Lt(e.variables(e.$attrs.style))},[dt("div",nw,[Vt(dt("input",et({type:"text",ref:"inputRef",readonly:!e.typeable,"onUpdate:modelValue":t[0]||(t[0]=t=>e.input=t)},e.$attrs,{placeholder:e.placeholder,disabled:e.disabled,tabindex:e.disabled?-1:0,onKeyup:t[1]||(t[1]=(...t)=>e.keyUp&&e.keyUp(...t)),onBlur:t[2]||(t[2]=(...t)=>e.blur&&e.blur(...t)),onFocus:t[3]||(t[3]=(...t)=>e.focus&&e.focus(...t)),onClick:t[4]||(t[4]=(...t)=>e.click&&e.click(...t))}),null,16,rw),[[qt,e.input]]),Vt(dt("div",ow,[tt(e.$slots,"clear",{onClear:e.clearModelValue},()=>[dt("i",{onClick:t[5]||(t[5]=t=>e.clearModelValue())},"x")])],512),[[Kt,e.clearable&&e.modelValue]])]),Vt(ut(a,{pageDate:e.pageDate,"onUpdate:pageDate":t[6]||(t[6]=t=>e.updatePageDate("year",t)),selected:e.modelValue,lowerLimit:e.lowerLimit,upperLimit:e.upperLimit,onSelect:e.selectYear},null,8,["pageDate","selected","lowerLimit","upperLimit","onSelect"]),[[Kt,"year"===e.viewShown]]),Vt(ut(s,{pageDate:e.pageDate,"onUpdate:pageDate":t[7]||(t[7]=t=>e.updatePageDate("month",t)),selected:e.modelValue,onSelect:e.selectMonth,lowerLimit:e.lowerLimit,upperLimit:e.upperLimit,format:e.monthListFormat,locale:e.locale,onBack:t[8]||(t[8]=t=>e.viewShown="year")},null,8,["pageDate","selected","onSelect","lowerLimit","upperLimit","format","locale"]),[[Kt,"month"===e.viewShown]]),Vt(ut(l,{pageDate:e.pageDate,"onUpdate:pageDate":t[9]||(t[9]=t=>e.updatePageDate("day",t)),selected:e.modelValue,weekStartsOn:e.weekStartsOn,lowerLimit:e.lowerLimit,upperLimit:e.upperLimit,headingFormat:e.dayPickerHeadingFormat,disabledDates:e.disabledDates,locale:e.locale,weekdayFormat:e.weekdayFormat,"allow-outside-interval":e.allowOutsideInterval,format:e.dayFormat,onSelect:e.selectDay,onBack:t[10]||(t[10]=t=>e.viewShown="month")},null,8,["pageDate","selected","weekStartsOn","lowerLimit","upperLimit","headingFormat","disabledDates","locale","weekdayFormat","allow-outside-interval","format","onSelect"]),[[Kt,"day"===e.viewShown]]),Vt(ut(c,{pageDate:e.pageDate,visible:"time"===e.viewShown,selected:e.modelValue,disabledTime:e.disabledTime,onSelect:e.selectTime,onBack:e.goBackFromTimepicker},null,8,["pageDate","visible","selected","disabledTime","onSelect","onBack"]),[[Kt,"time"===e.viewShown]])],4)}]]),aw=Ye({components:{Datepicker:iw},emits:["change","update:modelValue"],props:{modelValue:{type:Object,default:()=>({start:null,end:null})}},setup(e,{emit:t}){const n=ct(e.modelValue.start),r=ct(e.modelValue.end),o=Jr("startRef"),i=Jr("endRef"),a=ct(null),s="START";ft([n,r],()=>{let e={start:null,end:null};n.value&&r.value&&(e={start:vh(n.value,"yyyy-MM-dd"),end:vh(r.value,"yyyy-MM-dd")}),t("update:modelValue",e),t("change",e)});const l=e=>{e.value&&e.value.renderView(e.value.initialView)};return{start:n,end:r,showStartSelector:()=>{a.value=s,l(o)},showEndSelector:()=>{a.value="END",l(i)},hideSelector:()=>{a.value=null},selectorShown:a,selectorShownStart:s,selectorShownEnd:"END",locale:Se(re),clear:()=>{n.value=null,r.value=null},formatDate:Z,formatTemplate:"L"}}}),sw={class:"rangepicker__hint fr-m-0"},lw={class:"rangepicker__hint fr-m-0"};const cw=An(aw,[["render",function(e,t,n,r,o,i){const a=jt("Datepicker");return Ze(),Qe("div",{class:lt(["rangepicker fr-select",{"rangepicker--selected":e.start}])},[Vt(dt("div",null,[dt("p",sw,pt(e.$t("Select lower bound:")),1),ut(a,{modelValue:e.start,"onUpdate:modelValue":[t[0]||(t[0]=t=>e.start=t),e.showEndSelector],upperLimit:e.end,locale:e.locale,ref:"startRef"},null,8,["modelValue","upperLimit","locale","onUpdate:modelValue"])],512),[[Kt,e.selectorShown===e.selectorShownStart]]),Vt(dt("div",null,[dt("p",lw,pt(e.$t("Select upper bound:")),1),ut(a,{modelValue:e.end,"onUpdate:modelValue":[t[1]||(t[1]=t=>e.end=t),e.hideSelector],lowerLimit:e.start,locale:e.locale,ref:"endRef"},null,8,["modelValue","lowerLimit","locale","onUpdate:modelValue"])],512),[[Kt,e.selectorShown===e.selectorShownEnd]]),null===e.selectorShown?(Ze(),Qe("button",{key:0,class:"rangepicker__button w-100 text-align-left",onClick:t[3]||(t[3]=zt((...t)=>e.showStartSelector&&e.showStartSelector(...t),["prevent"]))},[e.start?(Ze(),Qe(Mt,{key:1},[Tt(pt(e.formatDate(e.start,e.formatTemplate)),1),e.end?(Ze(),Qe(Mt,{key:0},[Tt(""+pt(e.formatDate(e.end,e.formatTemplate)),1)],64)):st("",!0),e.start?(Ze(),Qe("button",{key:1,class:"fr-fi-close-line clear",onClick:t[2]||(t[2]=zt((...t)=>e.clear&&e.clear(...t),["stop"]))})):st("",!0)],64)):(Ze(),Qe(Mt,{key:0},[Tt(pt(e.$t("from dd/mm/yyyy to dd/mm/yyyy")),1)],64))])):st("",!0)],2)}]]),uw=Symbol("editorInfoCtxKey");const dw=Ye({name:"Milkdown",setup:()=>{const e=function(){const{dom:e,loading:t,editor:n,editorFactory:r}=Je(uw,{}),o=ct();return mt(()=>{if(!e.value)return;const i=r.value(e.value);i&&(t.value=!0,o.value=i,i.create().then(e=>{n.value=e}).finally(()=>{t.value=!1}).catch(console.error))}),Dt(()=>{var e;null===(e=o.value)||void 0===e||e.destroy().catch(console.error)}),e}();return()=>ut("div",{"data-milkdown-root":!0,ref:e},null)}}),pw=Ye({name:"MilkdownProvider",setup:(e,{slots:t})=>{const n=ct(null),r=ct(void 0),o=ct(void 0),i=ct(!0);return Et(uw,{loading:i,dom:n,editor:o,editorFactory:r}),()=>{var e;return ut(Mt,null,[null===(e=t.default)||void 0===e?void 0:e.call(t)])}}});function hw(){const e=Je(uw);return[e.loading,()=>e.editor.value]}var fw,mw,gw=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},vw=(e,t,n)=>(((e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)})(e,t,"access private method"),n);let yw=class{constructor({node:e,view:t,getPos:n,decorations:r,innerDecorations:o,options:i}){gw(this,fw),this.selected=!1,this.selectNode=()=>{var e,t;this.selected=!0,null==(t=(e=this.options).selectNode)||t.call(e)},this.deselectNode=()=>{var e,t;this.selected=!1,null==(t=(e=this.options).deselectNode)||t.call(e)},this.shouldUpdate=e=>!(e.type!==this.node.type||e.sameMarkup(this.node)&&e.content.eq(this.node.content)),this.update=(e,t,n)=>{var r,o;const i=this.options.update;let a;return i&&(a=i(e,t,n)),"boolean"!=typeof a&&(a=this.shouldUpdate(e)),this.node=e,this.decorations=t,this.innerDecorations=n,a&&(null==(o=(r=this.options).onUpdate)||o.call(r)),a},this.shouldIgnoreMutation=e=>!(this.dom&&this.contentDOM&&!this.node.isLeaf&&!this.node.isAtom)||"selection"!==e.type&&(this.contentDOM===e.target&&"attributes"===e.type||!this.contentDOM.contains(e.target)),this.ignoreMutation=e=>{if(!this.dom||!this.contentDOM)return!0;let t;const n=this.options.ignoreMutation;return n&&(t=n(e)),"boolean"!=typeof t&&(t=this.shouldIgnoreMutation(e)),t},this.destroy=()=>{var e,t,n;null==(t=(e=this.options).destroy)||t.call(e),this.dom.remove(),null==(n=this.contentDOM)||n.remove()},this.setAttrs=e=>{const{dispatch:t,state:n}=this.view,r=this.getPos();if("number"==typeof r)return t(n.tr.setNodeMarkup(r,void 0,M(M({},this.node.attrs),e)))},this.node=e,this.view=t,this.getPos=n,this.decorations=r,this.innerDecorations=o,this.options=i,this.dom=this.createDOM(i.as),this.contentDOM=e.isLeaf?null:this.createContentDOM(i.contentAs),this.dom.setAttribute("data-node-view-root","true"),this.contentDOM&&(this.contentDOM.setAttribute("data-node-view-content","true"),this.contentDOM.style.whiteSpace="inherit"),this.setSelection=i.setSelection,this.stopEvent=i.stopEvent}createDOM(e){return vw(this,fw,mw).call(this,e)}createContentDOM(e){return vw(this,fw,mw).call(this,e)}get component(){return this.options.component}};fw=new WeakSet,mw=function(e){const{node:t}=this;return null==e?document.createElement(t.isInline?"span":"div"):e instanceof HTMLElement?e:e instanceof Function?e(t):document.createElement(e)};class ww{constructor(e){this.view=e.view,this.options=e.options}get component(){return this.options.component}get root(){var e,t,n;let r=null==(n=(t=this.options).root)?void 0:n.call(t,this.view.dom);return r||(r=null!==(e=this.view.dom.parentElement)&&void 0!==e?e:document.body),r}update(e,t){var n,r;this.view=e,this.prevState=t,null==(r=(n=this.options).update)||r.call(n,e,t)}destroy(){var e,t;null==(t=(e=this.options).destroy)||t.call(e)}}var bw,kw;let xw=class{constructor({pos:e,spec:t,options:n}){gw(this,bw),this.pos=e,this.options=n,this.spec=t,this.dom=vw(this,bw,kw).call(this,n.as),this.dom.setAttribute("data-widget-view-root","true")}bind(e,t){this.view=e,this.getPos=t}get component(){return this.options.component}};bw=new WeakSet,kw=function(e){return e instanceof HTMLElement?e:document.createElement(e)};let Cw=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((e,t)=>e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_","");function Sw(e){this.content=e}function Mw(e,t,n){for(let r=0;;r++){if(r==e.childCount||r==t.childCount)return e.childCount==t.childCount?null:n;let o=e.child(r),i=t.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(let e=0;o.text[e]==i.text[e];e++)n++;return n}if(o.content.size||i.content.size){let e=Mw(o.content,i.content,n+1);if(null!=e)return e}n+=o.nodeSize}else n+=o.nodeSize}}function Tw(e,t,n,r){for(let o=e.childCount,i=t.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};let a=e.child(--o),s=t.child(--i),l=a.nodeSize;if(a!=s){if(!a.sameMarkup(s))return{a:n,b:r};if(a.isText&&a.text!=s.text){let e=0,t=Math.min(a.text.length,s.text.length);for(;e<t&&a.text[a.text.length-e-1]==s.text[s.text.length-e-1];)e++,n--,r--;return{a:n,b:r}}if(a.content.size||s.content.size){let e=Tw(a.content,s.content,n-1,r-1);if(e)return e}n-=l,r-=l}else n-=l,r-=l}}Sw.prototype={constructor:Sw,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return-1==t?void 0:this.content[t+1]},update:function(e,t,n){var r=n&&n!=e?this.remove(n):this,o=r.find(e),i=r.content.slice();return-1==o?i.push(n||e,t):(i[o+1]=t,n&&(i[o]=n)),new Sw(i)},remove:function(e){var t=this.find(e);if(-1==t)return this;var n=this.content.slice();return n.splice(t,2),new Sw(n)},addToStart:function(e,t){return new Sw([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new Sw(n)},addBefore:function(e,t,n){var r=this.remove(t),o=r.content.slice(),i=r.find(e);return o.splice(-1==i?o.length:i,0,t,n),new Sw(o)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=Sw.from(e)).size?new Sw(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=Sw.from(e)).size?new Sw(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=Sw.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},toObject:function(){var e={};return this.forEach(function(t,n){e[t]=n}),e},get size(){return this.content.length>>1}},Sw.from=function(e){if(e instanceof Sw)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new Sw(t)};class Ow{constructor(e,t){if(this.content=e,this.size=t||0,null==t)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,t,n,r=0,o){for(let i=0,a=0;a<t;i++){let s=this.content[i],l=a+s.nodeSize;if(l>e&&!1!==n(s,r+a,o||null,i)&&s.content.size){let o=a+1;s.nodesBetween(Math.max(0,e-o),Math.min(s.content.size,t-o),n,r+o)}a=l}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,r){let o="",i=!0;return this.nodesBetween(e,t,(a,s)=>{let l=a.isText?a.text.slice(Math.max(e,s)-s,t-s):a.isLeaf?r?"function"==typeof r?r(a):r:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&l||a.isTextblock)&&n&&(i?i=!1:o+=n),o+=l},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,r=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(n)&&(r[r.length-1]=t.withText(t.text+n.text),o=1);o<e.content.length;o++)r.push(e.content[o]);return new Ow(r,this.size+e.size)}cut(e,t=this.size){if(0==e&&t==this.size)return this;let n=[],r=0;if(t>e)for(let o=0,i=0;i<t;o++){let a=this.content[o],s=i+a.nodeSize;s>e&&((i<e||s>t)&&(a=a.isText?a.cut(Math.max(0,e-i),Math.min(a.text.length,t-i)):a.cut(Math.max(0,e-i-1),Math.min(a.content.size,t-i-1))),n.push(a),r+=a.nodeSize),i=s}return new Ow(n,r)}cutByIndex(e,t){return e==t?Ow.empty:0==e&&t==this.content.length?this:new Ow(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let r=this.content.slice(),o=this.size+t.nodeSize-n.nodeSize;return r[e]=t,new Ow(r,o)}addToStart(e){return new Ow([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Ow(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let r=this.content[t];e(r,n,t),n+=r.nodeSize}}findDiffStart(e,t=0){return Mw(this,e,t)}findDiffEnd(e,t=this.size,n=e.size){return Tw(this,e,t,n)}findIndex(e){if(0==e)return Nw(0,e);if(e==this.size)return Nw(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let t=0,n=0;;t++){let r=n+this.child(t).nodeSize;if(r>=e)return r==e?Nw(t+1,r):Nw(t,n);n=r}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return Ow.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new Ow(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Ow.empty;let t,n=0;for(let r=0;r<e.length;r++){let o=e[r];n+=o.nodeSize,r&&o.isText&&e[r-1].sameMarkup(o)?(t||(t=e.slice(0,r)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new Ow(t||e,n)}static from(e){if(!e)return Ow.empty;if(e instanceof Ow)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Ow([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Ow.empty=new Ow([],0);const _w={index:0,offset:0};function Nw(e,t){return _w.index=e,_w.offset=t,_w}function Ew(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;let n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!Ew(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!Ew(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}class Dw{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let r=0;r<e.length;r++){let o=e[r];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,r));else{if(o.type.excludes(this.type))return e;!n&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),n=!0),t&&t.push(o)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Ew(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw new RangeError(`There is no mark type ${t.type} in this schema`);let r=n.create(t.attrs);return n.checkAttrs(r.attrs),r}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&0==e.length)return Dw.none;if(e instanceof Dw)return[e];let t=e.slice();return t.sort((e,t)=>e.type.rank-t.type.rank),t}}Dw.none=[];class Aw extends Error{}let $w=class e{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,n){let r=Lw(this.content,t+this.openStart,n);return r&&new e(r,this.openStart,this.openEnd)}removeBetween(t,n){return new e(Rw(this.content,t+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(t,n){if(!n)return e.empty;let r=n.openStart||0,o=n.openEnd||0;if("number"!=typeof r||"number"!=typeof o)throw new RangeError("Invalid input for Slice.fromJSON");return new e(Ow.fromJSON(t,n.content),r,o)}static maxOpen(t,n=!0){let r=0,o=0;for(let e=t.firstChild;e&&!e.isLeaf&&(n||!e.type.spec.isolating);e=e.firstChild)r++;for(let e=t.lastChild;e&&!e.isLeaf&&(n||!e.type.spec.isolating);e=e.lastChild)o++;return new e(t,r,o)}};function Rw(e,t,n){let{index:r,offset:o}=e.findIndex(t),i=e.maybeChild(r),{index:a,offset:s}=e.findIndex(n);if(o==t||i.isText){if(s!=n&&!e.child(a).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(n))}if(r!=a)throw new RangeError("Removing non-flat range");return e.replaceChild(r,i.copy(Rw(i.content,t-o-1,n-o-1)))}function Lw(e,t,n,r){let{index:o,offset:i}=e.findIndex(t),a=e.maybeChild(o);if(i==t||a.isText)return r&&!r.canReplace(o,o,n)?null:e.cut(0,t).append(n).append(e.cut(t));let s=Lw(a.content,t-i-1,n,a);return s&&e.replaceChild(o,a.copy(s))}function Iw(e,t,n){if(n.openStart>e.depth)throw new Aw("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new Aw("Inconsistent open depths");return Pw(e,t,n,0)}function Pw(e,t,n,r){let o=e.index(r),i=e.node(r);if(o==t.index(r)&&r<e.depth-n.openStart){let a=Pw(e,t,n,r+1);return i.copy(i.content.replaceChild(o,a))}if(n.content.size){if(n.openStart||n.openEnd||e.depth!=r||t.depth!=r){let{start:o,end:a}=function(e,t){let n=t.depth-e.openStart,r=t.node(n).copy(e.content);for(let o=n-1;o>=0;o--)r=t.node(o).copy(Ow.from(r));return{start:r.resolveNoCache(e.openStart+n),end:r.resolveNoCache(r.content.size-e.openEnd-n)}}(n,e);return Vw(i,qw(e,o,a,t,r))}{let r=e.parent,o=r.content;return Vw(r,o.cut(0,e.parentOffset).append(n.content).append(o.cut(t.parentOffset)))}}return Vw(i,Hw(e,t,r))}function zw(e,t){if(!t.type.compatibleContent(e.type))throw new Aw("Cannot join "+t.type.name+" onto "+e.type.name)}function Bw(e,t,n){let r=e.node(n);return zw(r,t.node(n)),r}function Fw(e,t){let n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function jw(e,t,n,r){let o=(t||e).node(n),i=0,a=t?t.index(n):o.childCount;e&&(i=e.index(n),e.depth>n?i++:e.textOffset&&(Fw(e.nodeAfter,r),i++));for(let s=i;s<a;s++)Fw(o.child(s),r);t&&t.depth==n&&t.textOffset&&Fw(t.nodeBefore,r)}function Vw(e,t){return e.type.checkContent(t),e.copy(t)}function qw(e,t,n,r,o){let i=e.depth>o&&Bw(e,t,o+1),a=r.depth>o&&Bw(n,r,o+1),s=[];return jw(null,e,o,s),i&&a&&t.index(o)==n.index(o)?(zw(i,a),Fw(Vw(i,qw(e,t,n,r,o+1)),s)):(i&&Fw(Vw(i,Hw(e,t,o+1)),s),jw(t,n,o,s),a&&Fw(Vw(a,Hw(n,r,o+1)),s)),jw(r,null,o,s),new Ow(s)}function Hw(e,t,n){let r=[];if(jw(null,e,n,r),e.depth>n){Fw(Vw(Bw(e,t,n+1),Hw(e,t,n+1)),r)}return jw(t,null,n,r),new Ow(r)}$w.empty=new $w(Ow.empty,0,0);class Uw{constructor(e,t,n){this.pos=e,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}resolveDepth(e){return null==e?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[3*this.resolveDepth(e)]}index(e){return this.path[3*this.resolveDepth(e)+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}start(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}after(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let n=this.path[3*t],r=0==t?0:this.path[3*t-1]+1;for(let o=0;o<e;o++)r+=n.child(o).nodeSize;return r}marks(){let e=this.parent,t=this.index();if(0==e.content.size)return Dw.none;if(this.textOffset)return e.child(t).marks;let n=e.maybeChild(t-1),r=e.maybeChild(t);if(!n){let e=n;n=r,r=e}let o=n.marks;for(var i=0;i<o.length;i++)!1!==o[i].type.spec.inclusive||r&&o[i].isInSet(r.marks)||(o=o[i--].removeFromSet(o));return o}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let n=t.marks,r=e.parent.maybeChild(e.index());for(var o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new Jw(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let n=[],r=0,o=t;for(let i=e;;){let{index:e,offset:t}=i.content.findIndex(o),a=o-t;if(n.push(i,e,r+t),!a)break;if(i=i.child(e),i.isText)break;o=a-1,r+=t+1}return new Uw(t,n,o)}static resolveCached(e,t){let n=Yw.get(e);if(n)for(let o=0;o<n.elts.length;o++){let e=n.elts[o];if(e.pos==t)return e}else Yw.set(e,n=new Ww);let r=n.elts[n.i]=Uw.resolve(e,t);return n.i=(n.i+1)%Kw,r}}class Ww{constructor(){this.elts=[],this.i=0}}const Kw=12,Yw=new WeakMap;class Jw{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Gw=Object.create(null);let Xw=class e{constructor(e,t,n,r=Dw.none){this.type=e,this.attrs=t,this.marks=r,this.content=n||Ow.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,n,r=0){this.content.nodesBetween(e,t,n,r,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,n,r){return this.content.textBetween(e,t,n,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,n){return this.type==e&&Ew(this.attrs,t||e.defaultAttrs||Gw)&&Dw.sameSet(this.marks,n||Dw.none)}copy(t=null){return t==this.content?this:new e(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new e(this.type,this.attrs,this.content,t)}cut(e,t=this.content.size){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,n=!1){if(e==t)return $w.empty;let r=this.resolve(e),o=this.resolve(t),i=n?0:r.sharedDepth(t),a=r.start(i),s=r.node(i).content.cut(r.pos-a,o.pos-a);return new $w(s,r.depth-i,o.depth-i)}replace(e,t,n){return Iw(this.resolve(e),this.resolve(t),n)}nodeAt(e){for(let t=this;;){let{index:n,offset:r}=t.content.findIndex(e);if(t=t.maybeChild(n),!t)return null;if(r==e||t.isText)return t;e-=r+1}}childAfter(e){let{index:t,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:n}}childBefore(e){if(0==e)return{node:null,index:0,offset:0};let{index:t,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(t),index:t,offset:n};let r=this.content.child(t-1);return{node:r,index:t-1,offset:n-r.nodeSize}}resolve(e){return Uw.resolveCached(this,e)}resolveNoCache(e){return Uw.resolve(this,e)}rangeHasMark(e,t,n){let r=!1;return t>e&&this.nodesBetween(e,t,e=>(n.isInSet(e.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Qw(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,n=Ow.empty,r=0,o=n.childCount){let i=this.contentMatchAt(e).matchFragment(n,r,o),a=i&&i.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let s=r;s<o;s++)if(!this.type.allowsMarks(n.child(s).marks))return!1;return!0}canReplaceWith(e,t,n,r){if(r&&!this.type.allowsMarks(r))return!1;let o=this.contentMatchAt(e).matchType(n),i=o&&o.matchFragment(this.content,t);return!!i&&i.validEnd}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Dw.none;for(let t=0;t<this.marks.length;t++){let n=this.marks[t];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!Dw.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(e=>e.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let n;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}let r=Ow.fromJSON(e,t.content),o=e.nodeType(t.type).create(t.attrs,r,n);return o.type.checkAttrs(o.attrs),o}};Xw.prototype.text=void 0;class Zw extends Xw{constructor(e,t,n,r){if(super(e,t,null,r),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Qw(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Zw(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Zw(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return 0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function Qw(e,t){for(let n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}class eb{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let n=new tb(e,t);if(null==n.next)return eb.empty;let r=nb(n);n.next&&n.err("Unexpected trailing text");let o=function(e){let t=Object.create(null);return n(lb(e,0));function n(r){let o=[];r.forEach(t=>{e[t].forEach(({term:t,to:n})=>{if(!t)return;let r;for(let e=0;e<o.length;e++)o[e][0]==t&&(r=o[e][1]);lb(e,n).forEach(e=>{r||o.push([t,r=[]]),-1==r.indexOf(e)&&r.push(e)})})});let i=t[r.join(",")]=new eb(r.indexOf(e.length-1)>-1);for(let e=0;e<o.length;e++){let r=o[e][1].sort(sb);i.next.push({type:o[e][0],next:t[r.join(",")]||n(r)})}return i}}(function(e){let t=[[]];return o(i(e,0),n()),t;function n(){return t.push([])-1}function r(e,n,r){let o={term:r,to:n};return t[e].push(o),o}function o(e,t){e.forEach(e=>e.to=t)}function i(e,t){if("choice"==e.type)return e.exprs.reduce((e,n)=>e.concat(i(n,t)),[]);if("seq"!=e.type){if("star"==e.type){let a=n();return r(t,a),o(i(e.expr,a),a),[r(a)]}if("plus"==e.type){let a=n();return o(i(e.expr,t),a),o(i(e.expr,a),a),[r(a)]}if("opt"==e.type)return[r(t)].concat(i(e.expr,t));if("range"==e.type){let a=t;for(let t=0;t<e.min;t++){let t=n();o(i(e.expr,a),t),a=t}if(-1==e.max)o(i(e.expr,a),a);else for(let t=e.min;t<e.max;t++){let t=n();r(a,t),o(i(e.expr,a),t),a=t}return[r(a)]}if("name"==e.type)return[r(t,void 0,e.value)];throw new Error("Unknown expr type")}for(let r=0;;r++){let a=i(e.exprs[r],t);if(r==e.exprs.length-1)return a;o(a,t=n())}}}(r));return function(e,t){for(let n=0,r=[e];n<r.length;n++){let e=r[n],o=!e.validEnd,i=[];for(let t=0;t<e.next.length;t++){let{type:n,next:a}=e.next[t];i.push(n.name),!o||n.isText||n.hasRequiredAttrs()||(o=!1),-1==r.indexOf(a)&&r.push(a)}o&&t.err("Only non-generatable nodes ("+i.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,n=e.childCount){let r=this;for(let o=t;r&&o<n;o++)r=r.matchType(e.child(o).type);return r}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!t.isText&&!t.hasRequiredAttrs())return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let n=0;n<e.next.length;n++)if(this.next[t].type==e.next[n].type)return!0;return!1}fillBefore(e,t=!1,n=0){let r=[this];return function o(i,a){let s=i.matchFragment(e,n);if(s&&(!t||s.validEnd))return Ow.from(a.map(e=>e.createAndFill()));for(let e=0;e<i.next.length;e++){let{type:t,next:n}=i.next[e];if(!t.isText&&!t.hasRequiredAttrs()&&-1==r.indexOf(n)){r.push(n);let e=o(n,a.concat(t));if(e)return e}}return null}(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let r=n.shift(),o=r.match;if(o.matchType(e)){let e=[];for(let t=r;t.type;t=t.via)e.push(t.type);return e.reverse()}for(let e=0;e<o.next.length;e++){let{type:i,next:a}=o.next[e];i.isLeaf||i.hasRequiredAttrs()||i.name in t||r.type&&!a.validEnd||(n.push({match:i.contentMatch,type:i,via:r}),t[i.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];return function t(n){e.push(n);for(let r=0;r<n.next.length;r++)-1==e.indexOf(n.next[r].next)&&t(n.next[r].next)}(this),e.map((t,n)=>{let r=n+(t.validEnd?"*":" ")+" ";for(let o=0;o<t.next.length;o++)r+=(o?", ":"")+t.next[o].type.name+"->"+e.indexOf(t.next[o].next);return r}).join("\n")}}eb.empty=new eb(!0);class tb{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function nb(e){let t=[];do{t.push(rb(e))}while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function rb(e){let t=[];do{t.push(ob(e))}while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function ob(e){let t=function(e){if(e.eat("(")){let t=nb(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){let t=function(e,t){let n=e.nodeTypes,r=n[t];if(r)return[r];let o=[];for(let i in n){let e=n[i];e.isInGroup(t)&&o.push(e)}0==o.length&&e.err("No node type or group '"+t+"' found");return o}(e,e.next).map(t=>(null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t}));return e.pos++,1==t.length?t[0]:{type:"choice",exprs:t}}e.err("Unexpected token '"+e.next+"'")}(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=ab(e,t)}return t}function ib(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function ab(e,t){let n=ib(e),r=n;return e.eat(",")&&(r="}"!=e.next?ib(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}function sb(e,t){return t-e}function lb(e,t){let n=[];return function t(r){let o=e[r];if(1==o.length&&!o[0].term)return t(o[0].to);n.push(r);for(let e=0;e<o.length;e++){let{term:r,to:i}=o[e];r||-1!=n.indexOf(i)||t(i)}}(t),n.sort(sb)}function cb(e){let t=Object.create(null);for(let n in e){let r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function ub(e,t){let n=Object.create(null);for(let r in e){let o=t&&t[r];if(void 0===o){let t=e[r];if(!t.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=t.default}n[r]=o}return n}function db(e,t,n,r){for(let o in t)if(!(o in e))throw new RangeError(`Unsupported attribute ${o} for ${n} of type ${o}`);for(let o in e){let n=e[o];n.validate&&n.validate(t[o])}}function pb(e,t){let n=Object.create(null);if(t)for(let r in t)n[r]=new fb(e,r,t[r]);return n}let hb=class e{constructor(e,t,n){this.name=e,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=pb(e,n.attrs),this.defaultAttrs=cb(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==eb.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:ub(this.attrs,e)}create(e=null,t,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Xw(this,this.computeAttrs(e),Ow.from(t),Dw.setFrom(n))}createChecked(e=null,t,n){return t=Ow.from(t),this.checkContent(t),new Xw(this,this.computeAttrs(e),t,Dw.setFrom(n))}createAndFill(e=null,t,n){if(e=this.computeAttrs(e),(t=Ow.from(t)).size){let e=this.contentMatch.fillBefore(t);if(!e)return null;t=e.append(t)}let r=this.contentMatch.matchFragment(t),o=r&&r.fillBefore(Ow.empty,!0);return o?new Xw(this,e,t.append(o),Dw.setFrom(n)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){db(this.attrs,e,"node",this.name)}allowsMarkType(e){return null==this.markSet||this.markSet.indexOf(e)>-1}allowsMarks(e){if(null==this.markSet)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(null==this.markSet)return e;let t;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:Dw.none:e}static compile(t,n){let r=Object.create(null);t.forEach((t,o)=>r[t]=new e(t,n,o));let o=n.spec.topNode||"doc";if(!r[o])throw new RangeError("Schema is missing its top node type ('"+o+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let e in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};class fb{constructor(e,t,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate="string"==typeof n.validate?function(e,t,n){let r=n.split("|");return n=>{let o=null===n?"null":typeof n;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${t} on type ${e}, got ${o}`)}}(e,t,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class mb{constructor(e,t,n,r){this.name=e,this.rank=t,this.schema=n,this.spec=r,this.attrs=pb(e,r.attrs),this.excluded=null;let o=cb(this.attrs);this.instance=o?new Dw(this,o):null}create(e=null){return!e&&this.instance?this.instance:new Dw(this,ub(this.attrs,e))}static compile(e,t){let n=Object.create(null),r=0;return e.forEach((e,o)=>n[e]=new mb(e,r++,t,o)),n}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){db(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class gb{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let r in e)t[r]=e[r];t.nodes=Sw.from(e.nodes),t.marks=Sw.from(e.marks||{}),this.nodes=hb.compile(this.spec.nodes,this),this.marks=mb.compile(this.spec.marks,this);let n=Object.create(null);for(let r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");let e=this.nodes[r],t=e.spec.content||"",o=e.spec.marks;if(e.contentMatch=n[t]||(n[t]=eb.parse(t,this.nodes)),e.inlineContent=e.contentMatch.inlineContent,e.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!e.isInline||!e.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=e}e.markSet="_"==o?null:o?vb(this,o.split(" ")):""!=o&&e.inlineContent?null:[]}for(let r in this.marks){let e=this.marks[r],t=e.spec.excludes;e.excluded=null==t?[e]:""==t?[]:vb(this,t.split(" "))}this.nodeFromJSON=e=>Xw.fromJSON(this,e),this.markFromJSON=e=>Dw.fromJSON(this,e),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,n,r){if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof hb))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(t,n,r)}text(e,t){let n=this.nodes.text;return new Zw(n,n.defaultAttrs,e,Dw.setFrom(t))}mark(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function vb(e,t){let n=[];for(let r=0;r<t.length;r++){let o=t[r],i=e.marks[o],a=i;if(i)n.push(i);else for(let t in e.marks){let r=e.marks[t];("_"==o||r.spec.group&&r.spec.group.split(" ").indexOf(o)>-1)&&n.push(a=r)}if(!a)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return n}class yb{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let n=this.matchedStyles=[];t.forEach(e=>{if(function(e){return null!=e.tag}(e))this.tags.push(e);else if(function(e){return null!=e.style}(e)){let t=/[^=]*/.exec(e.style)[0];n.indexOf(t)<0&&n.push(t),this.styles.push(e)}}),this.normalizeLists=!this.tags.some(t=>{if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;let n=e.nodes[t.node];return n.contentMatch.matchType(n)})}parse(e,t={}){let n=new Sb(this,t,!1);return n.addAll(e,Dw.none,t.from,t.to),n.finish()}parseSlice(e,t={}){let n=new Sb(this,t,!0);return n.addAll(e,Dw.none,t.from,t.to),$w.maxOpen(n.finish())}matchTag(e,t,n){for(let r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){let n=this.tags[r];if(Mb(e,n.tag)&&(void 0===n.namespace||e.namespaceURI==n.namespace)&&(!n.context||t.matchesContext(n.context))){if(n.getAttrs){let t=n.getAttrs(e);if(!1===t)continue;n.attrs=t||void 0}return n}}}matchStyle(e,t,n,r){for(let o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){let r=this.styles[o],i=r.style;if(!(0!=i.indexOf(e)||r.context&&!n.matchesContext(r.context)||i.length>e.length&&(61!=i.charCodeAt(e.length)||i.slice(e.length+1)!=t))){if(r.getAttrs){let e=r.getAttrs(t);if(!1===e)continue;r.attrs=e||void 0}return r}}}static schemaRules(e){let t=[];function n(e){let n=null==e.priority?50:e.priority,r=0;for(;r<t.length;r++){let e=t[r];if((null==e.priority?50:e.priority)<n)break}t.splice(r,0,e)}for(let r in e.marks){let t=e.marks[r].spec.parseDOM;t&&t.forEach(e=>{n(e=Tb(e)),e.mark||e.ignore||e.clearMark||(e.mark=r)})}for(let r in e.nodes){let t=e.nodes[r].spec.parseDOM;t&&t.forEach(e=>{n(e=Tb(e)),e.node||e.ignore||e.mark||(e.node=r)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new yb(e,yb.schemaRules(e)))}}const wb={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},bb={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},kb={ol:!0,ul:!0};function xb(e,t,n){return null!=t?(t?1:0)|("full"===t?2:0):e&&"pre"==e.whitespace?3:-5&n}class Cb{constructor(e,t,n,r,o,i){this.type=e,this.attrs=t,this.marks=n,this.solid=r,this.options=i,this.content=[],this.activeMarks=Dw.none,this.match=o||(4&i?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(Ow.from(e));if(!t){let t,n=this.type.contentMatch;return(t=n.findWrapping(e.type))?(this.match=n,t):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)}finish(e){if(!(1&this.options)){let e,t=this.content[this.content.length-1];if(t&&t.isText&&(e=/[ \t\r\n\u000c]+$/.exec(t.text))){let n=t;t.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length))}}let t=Ow.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(Ow.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!wb.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Sb{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let r,o=t.topNode,i=xb(null,t.preserveWhitespace,0)|(n?4:0);r=o?new Cb(o.type,o.attrs,Dw.none,!0,t.topMatch||o.type.contentMatch,i):new Cb(n?null:e.schema.topNodeType,null,Dw.none,!0,null,i),this.nodes=[r],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){3==e.nodeType?this.addTextNode(e,t):1==e.nodeType&&this.addElement(e,t)}addTextNode(e,t){let n=e.nodeValue,r=this.top,o=2&r.options?"full":this.localPreserveWS||(1&r.options)>0;if("full"===o||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(o)n="full"!==o?n.replace(/\r?\n|\r/g," "):n.replace(/\r\n?/g,"\n");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let t=r.content[r.content.length-1],o=e.previousSibling;(!t||o&&"BR"==o.nodeName||t.isText&&/[ \t\r\n\u000c]$/.test(t.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n),t,!/\S/.test(n)),this.findInText(e)}else this.findInside(e)}addElement(e,t,n){let r=this.localPreserveWS,o=this.top;("PRE"==e.tagName||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let i,a=e.nodeName.toLowerCase();kb.hasOwnProperty(a)&&this.parser.normalizeLists&&function(e){for(let t=e.firstChild,n=null;t;t=t.nextSibling){let e=1==t.nodeType?t.nodeName.toLowerCase():null;e&&kb.hasOwnProperty(e)&&n?(n.appendChild(t),t=n):"li"==e?n=t:e&&(n=null)}}(e);let s=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(i=this.parser.matchTag(e,this,n));e:if(s?s.ignore:bb.hasOwnProperty(a))this.findInside(e),this.ignoreFallback(e,t);else if(!s||s.skip||s.closeParent){s&&s.closeParent?this.open=Math.max(0,this.open-1):s&&s.skip.nodeType&&(e=s.skip);let n,r=this.needsBlock;if(wb.hasOwnProperty(a))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),n=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let i=s&&s.skip?t:this.readStyles(e,t);i&&this.addAll(e,i),n&&this.sync(o),this.needsBlock=r}else{let n=this.readStyles(e,t);n&&this.addElementByRule(e,s,n,!1===s.consuming?i:void 0)}this.localPreserveWS=r}leafFallback(e,t){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"),t)}ignoreFallback(e,t){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let n=e.style;if(n&&n.length)for(let r=0;r<this.parser.matchedStyles.length;r++){let e=this.parser.matchedStyles[r],o=n.getPropertyValue(e);if(o)for(let n;;){let r=this.parser.matchStyle(e,o,this,n);if(!r)break;if(r.ignore)return null;if(t=r.clearMark?t.filter(e=>!r.clearMark(e)):t.concat(this.parser.schema.marks[r.mark].create(r.attrs)),!1!==r.consuming)break;n=r}}return t}addElementByRule(e,t,n,r){let o,i;if(t.node)if(i=this.parser.schema.nodes[t.node],i.isLeaf)this.insertNode(i.create(t.attrs),n,"BR"==e.nodeName)||this.leafFallback(e,n);else{let e=this.enter(i,t.attrs||null,n,t.preserveWhitespace);e&&(o=!0,n=e)}else{let e=this.parser.schema.marks[t.mark];n=n.concat(e.create(t.attrs))}let a=this.top;if(i&&i.isLeaf)this.findInside(e);else if(r)this.addElement(e,n,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(e=>this.insertNode(e,n,!1));else{let r=e;"string"==typeof t.contentElement?r=e.querySelector(t.contentElement):"function"==typeof t.contentElement?r=t.contentElement(e):t.contentElement&&(r=t.contentElement),this.findAround(e,r,!0),this.addAll(r,n),this.findAround(e,r,!1)}o&&this.sync(a)&&this.open--}addAll(e,t,n,r){let o=n||0;for(let i=n?e.childNodes[n]:e.firstChild,a=null==r?null:e.childNodes[r];i!=a;i=i.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(i,t);this.findAtPoint(e,o)}findPlace(e,t,n){let r,o;for(let i=this.open,a=0;i>=0;i--){let t=this.nodes[i],s=t.findWrapping(e);if(s&&(!r||r.length>s.length+a)&&(r=s,o=t,!s.length))break;if(t.solid){if(n)break;a+=2}}if(!r)return null;this.sync(o);for(let i=0;i<r.length;i++)t=this.enterInner(r[i],null,t,!1);return t}insertNode(e,t,n){if(e.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&(t=this.enterInner(e,null,t))}let r=this.findPlace(e,t,n);if(r){this.closeExtra();let t=this.top;t.match&&(t.match=t.match.matchType(e.type));let n=Dw.none;for(let o of r.concat(e.marks))(t.type?t.type.allowsMarkType(o.type):Ob(o.type,e.type))&&(n=o.addToSet(n));return t.content.push(e.mark(n)),!0}return!1}enter(e,t,n,r){let o=this.findPlace(e.create(t),n,!1);return o&&(o=this.enterInner(e,t,n,!0,r)),o}enterInner(e,t,n,r=!1,o){this.closeExtra();let i=this.top;i.match=i.match&&i.match.matchType(e);let a=xb(e,o,i.options);4&i.options&&0==i.content.length&&(a|=4);let s=Dw.none;return n=n.filter(t=>!(i.type?i.type.allowsMarkType(t.type):Ob(t.type,e))||(s=t.addToSet(s),!1)),this.nodes.push(new Cb(e,t,s,r,null,a)),this.open++,n}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!(!this.isOpen&&!this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=1)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let t=n.length-1;t>=0;t--)e+=n[t].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let r=0;r<this.find.length;r++)if(null==this.find[r].pos&&1==e.nodeType&&e.contains(this.find[r].node)){t.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,r=!(this.isOpen||n&&n.parent.type!=this.nodes[0].type),o=-(n?n.depth+1:0)+(r?0:1),i=(e,a)=>{for(;e>=0;e--){let s=t[e];if(""==s){if(e==t.length-1||0==e)continue;for(;a>=o;a--)if(i(e-1,a))return!0;return!1}{let e=a>0||0==a&&r?this.nodes[a].type:n&&a>=o?n.node(a-o).type:null;if(!e||e.name!=s&&!e.isInGroup(s))return!1;a--}}return!0};return i(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let t in this.parser.schema.nodes){let e=this.parser.schema.nodes[t];if(e.isTextblock&&e.defaultAttrs)return e}}}function Mb(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function Tb(e){let t={};for(let n in e)t[n]=e[n];return t}function Ob(e,t){let n=t.schema.nodes;for(let r in n){let o=n[r];if(!o.allowsMarkType(e))continue;let i=[],a=e=>{i.push(e);for(let n=0;n<e.edgeCount;n++){let{type:r,next:o}=e.edge(n);if(r==t)return!0;if(i.indexOf(o)<0&&a(o))return!0}};if(a(o.contentMatch))return!0}}class _b{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},n){n||(n=Eb(t).createDocumentFragment());let r=n,o=[];return e.forEach(e=>{if(o.length||e.marks.length){let n=0,i=0;for(;n<o.length&&i<e.marks.length;){let t=e.marks[i];if(this.marks[t.type.name]){if(!t.eq(o[n][0])||!1===t.type.spec.spanning)break;n++,i++}else i++}for(;n<o.length;)r=o.pop()[1];for(;i<e.marks.length;){let n=e.marks[i++],a=this.serializeMark(n,e.isInline,t);a&&(o.push([n,r]),r.appendChild(a.dom),r=a.contentDOM||a.dom)}}r.appendChild(this.serializeNodeInner(e,t))}),n}serializeNodeInner(e,t){let{dom:n,contentDOM:r}=$b(Eb(t),this.nodes[e.type.name](e),null,e.attrs);if(r){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,r)}return n}serializeNode(e,t={}){let n=this.serializeNodeInner(e,t);for(let r=e.marks.length-1;r>=0;r--){let o=this.serializeMark(e.marks[r],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n}serializeMark(e,t,n={}){let r=this.marks[e.type.name];return r&&$b(Eb(n),r(e,t),null,e.attrs)}static renderSpec(e,t,n=null,r){return $b(e,t,n,r)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new _b(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Nb(e.nodes);return t.text||(t.text=e=>e.text),t}static marksFromSchema(e){return Nb(e.marks)}}function Nb(e){let t={};for(let n in e){let r=e[n].spec.toDOM;r&&(t[n]=r)}return t}function Eb(e){return e.document||window.document}const Db=new WeakMap;function Ab(e){let t=Db.get(e);return void 0===t&&Db.set(e,t=function(e){let t=null;function n(e){if(e&&"object"==typeof e)if(Array.isArray(e))if("string"==typeof e[0])t||(t=[]),t.push(e);else for(let t=0;t<e.length;t++)n(e[t]);else for(let t in e)n(e[t])}return n(e),t}(e)),t}function $b(e,t,n,r){if("string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;let o,i=t[0];if("string"!=typeof i)throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=Ab(r))&&o.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let a,s=i.indexOf(" ");s>0&&(n=i.slice(0,s),i=i.slice(s+1));let l=n?e.createElementNS(n,i):e.createElement(i),c=t[1],u=1;if(c&&"object"==typeof c&&null==c.nodeType&&!Array.isArray(c)){u=2;for(let e in c)if(null!=c[e]){let t=e.indexOf(" ");t>0?l.setAttributeNS(e.slice(0,t),e.slice(t+1),c[e]):"style"==e&&l.style?l.style.cssText=c[e]:l.setAttribute(e,c[e])}}for(let d=u;d<t.length;d++){let o=t[d];if(0===o){if(d<t.length-1||d>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}{let{dom:t,contentDOM:i}=$b(e,o,n,r);if(l.appendChild(t),i){if(a)throw new RangeError("Multiple content holes");a=i}}}return{dom:l,contentDOM:a}}const Rb=Math.pow(2,16);function Lb(e,t){return e+t*Rb}function Ib(e){return 65535&e}class Pb{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class zb{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&zb.empty)return zb.empty}recover(e){let t=0,n=Ib(e);if(!this.inverted)for(let r=0;r<n;r++)t+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+t+function(e){return(e-(65535&e))/Rb}(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,n){let r=0,o=this.inverted?2:1,i=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let s=this.ranges[a]-(this.inverted?r:0);if(s>e)break;let l=this.ranges[a+o],c=this.ranges[a+i],u=s+l;if(e<=u){let o=s+r+((l?e==s?-1:e==u?1:t:t)<0?0:c);if(n)return o;let i=e==(t<0?s:u)?null:Lb(a/3,e-s),d=e==s?2:e==u?1:4;return(t<0?e!=s:e!=u)&&(d|=8),new Pb(o,d,i)}r+=c-l}return n?e+r:new Pb(e+r,0,null)}touches(e,t){let n=0,r=Ib(t),o=this.inverted?2:1,i=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let t=this.ranges[a]-(this.inverted?n:0);if(t>e)break;let s=this.ranges[a+o];if(e<=t+s&&a==3*r)return!0;n+=this.ranges[a+i]-s}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let r=0,o=0;r<this.ranges.length;r+=3){let i=this.ranges[r],a=i-(this.inverted?o:0),s=i+(this.inverted?0:o),l=this.ranges[r+t],c=this.ranges[r+n];e(a,a+l,s,s+c),o+=c-l}}invert(){return new zb(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?zb.empty:new zb(e<0?[0,-e,0]:[0,0,e])}}zb.empty=new zb([]);class Bb{constructor(e,t,n=0,r=(e?e.length:0)){this.mirror=t,this.from=n,this.to=r,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new Bb(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),null!=t&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,n=this._maps.length;t<e._maps.length;t++){let r=e.getMirror(t);this.appendMap(e._maps[t],null!=r&&r<t?n+r:void 0)}}getMirror(e){if(this.mirror)for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,n=this._maps.length+e._maps.length;t>=0;t--){let r=e.getMirror(t);this.appendMap(e._maps[t].invert(),null!=r&&r>t?n-r-1:void 0)}}invert(){let e=new Bb;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let n=this.from;n<this.to;n++)e=this._maps[n].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,n){let r=0;for(let o=this.from;o<this.to;o++){let n=this._maps[o].mapResult(e,t);if(null!=n.recover){let t=this.getMirror(o);if(null!=t&&t>o&&t<this.to){o=t,e=this._maps[t].recover(n.recover);continue}}r|=n.delInfo,e=n.pos}return n?e:new Pb(e,r,null)}}const Fb=Object.create(null);class jb{getMap(){return zb.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=Fb[t.stepType];if(!n)throw new RangeError(`No step type ${t.stepType} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in Fb)throw new RangeError("Duplicate use of step JSON ID "+e);return Fb[e]=t,t.prototype.jsonID=e,t}}class Vb{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Vb(e,null)}static fail(e){return new Vb(null,e)}static fromReplace(e,t,n,r){try{return Vb.ok(e.replace(t,n,r))}catch(Yo){if(Yo instanceof Aw)return Vb.fail(Yo.message);throw Yo}}}function qb(e,t,n){let r=[];for(let o=0;o<e.childCount;o++){let i=e.child(o);i.content.size&&(i=i.copy(qb(i.content,t,i))),i.isInline&&(i=t(i,n,o)),r.push(i)}return Ow.fromArray(r)}class Hb extends jb{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),r=n.node(n.sharedDepth(this.to)),o=new $w(qb(t.content,(e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e,r),t.openStart,t.openEnd);return Vb.fromReplace(e,this.from,this.to,o)}invert(){return new Ub(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new Hb(t.pos,n.pos,this.mark)}merge(e){return e instanceof Hb&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Hb(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Hb(t.from,t.to,e.markFromJSON(t.mark))}}jb.jsonID("addMark",Hb);class Ub extends jb{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new $w(qb(t.content,e=>e.mark(this.mark.removeFromSet(e.marks)),e),t.openStart,t.openEnd);return Vb.fromReplace(e,this.from,this.to,n)}invert(){return new Hb(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new Ub(t.pos,n.pos,this.mark)}merge(e){return e instanceof Ub&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ub(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ub(t.from,t.to,e.markFromJSON(t.mark))}}jb.jsonID("removeMark",Ub);class Wb extends jb{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Vb.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Vb.fromReplace(e,this.pos,this.pos+1,new $w(Ow.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let e=this.mark.addToSet(t.marks);if(e.length==t.marks.length){for(let n=0;n<t.marks.length;n++)if(!t.marks[n].isInSet(e))return new Wb(this.pos,t.marks[n]);return new Wb(this.pos,this.mark)}}return new Kb(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Wb(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Wb(t.pos,e.markFromJSON(t.mark))}}jb.jsonID("addNodeMark",Wb);class Kb extends jb{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Vb.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Vb.fromReplace(e,this.pos,this.pos+1,new $w(Ow.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new Wb(this.pos,this.mark):this}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Kb(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Kb(t.pos,e.markFromJSON(t.mark))}}jb.jsonID("removeNodeMark",Kb);class Yb extends jb{constructor(e,t,n,r=!1){super(),this.from=e,this.to=t,this.slice=n,this.structure=r}apply(e){return this.structure&&Gb(e,this.from,this.to)?Vb.fail("Structure replace would overwrite content"):Vb.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new zb([this.from,this.to-this.from,this.slice.size])}invert(e){return new Yb(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new Yb(t.pos,Math.max(t.pos,n.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Yb)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;{let t=this.slice.size+e.slice.size==0?$w.empty:new $w(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Yb(e.from,this.to,t,this.structure)}}{let t=this.slice.size+e.slice.size==0?$w.empty:new $w(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Yb(this.from,this.to+(e.to-e.from),t,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Yb(t.from,t.to,$w.fromJSON(e,t.slice),!!t.structure)}}jb.jsonID("replace",Yb);class Jb extends jb{constructor(e,t,n,r,o,i,a=!1){super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=r,this.slice=o,this.insert=i,this.structure=a}apply(e){if(this.structure&&(Gb(e,this.from,this.gapFrom)||Gb(e,this.gapTo,this.to)))return Vb.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Vb.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?Vb.fromReplace(e,this.from,this.to,n):Vb.fail("Content does not fit in gap")}getMap(){return new zb([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Jb(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),r=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||r<t.pos||o>n.pos?null:new Jb(t.pos,n.pos,r,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Jb(t.from,t.to,t.gapFrom,t.gapTo,$w.fromJSON(e,t.slice),t.insert,!!t.structure)}}function Gb(e,t,n){let r=e.resolve(t),o=n-t,i=r.depth;for(;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0){let e=r.node(i).maybeChild(r.indexAfter(i));for(;o>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,o--}}return!1}function Xb(e,t,n,r=n.contentMatch,o=!0){let i=e.doc.nodeAt(t),a=[],s=t+1;for(let l=0;l<i.childCount;l++){let t=i.child(l),c=s+t.nodeSize,u=r.matchType(t.type);if(u){r=u;for(let r=0;r<t.marks.length;r++)n.allowsMarkType(t.marks[r].type)||e.step(new Ub(s,c,t.marks[r]));if(o&&t.isText&&"pre"!=n.whitespace){let e,r,o=/\r?\n|\r/g;for(;e=o.exec(t.text);)r||(r=new $w(Ow.from(n.schema.text(" ",n.allowedMarks(t.marks))),0,0)),a.push(new Yb(s+e.index,s+e.index+e[0].length,r))}}else a.push(new Yb(s,c,$w.empty));s=c}if(!r.validEnd){let t=r.fillBefore(Ow.empty,!0);e.replace(s,s,new $w(t,0,0))}for(let l=a.length-1;l>=0;l--)e.step(a[l])}function Zb(e,t,n){return(0==t||e.canReplace(t,e.childCount))&&(n==e.childCount||e.canReplace(0,n))}function Qb(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth;;--n){let r=e.$from.node(n),o=e.$from.index(n),i=e.$to.indexAfter(n);if(n<e.depth&&r.canReplace(o,i,t))return n;if(0==n||r.type.spec.isolating||!Zb(r,o,i))break}return null}function ek(e,t,n=null,r=e){let o=function(e,t){let{parent:n,startIndex:r,endIndex:o}=e,i=n.contentMatchAt(r).findWrapping(t);if(!i)return null;let a=i.length?i[0]:t;return n.canReplaceWith(r,o,a)?i:null}(e,t),i=o&&function(e,t){let{parent:n,startIndex:r,endIndex:o}=e,i=n.child(r),a=t.contentMatch.findWrapping(i.type);if(!a)return null;let s=(a.length?a[a.length-1]:t).contentMatch;for(let l=r;s&&l<o;l++)s=s.matchType(n.child(l).type);return s&&s.validEnd?a:null}(r,t);return i?o.map(tk).concat({type:t,attrs:n}).concat(i.map(tk)):null}function tk(e){return{type:e,attrs:null}}function nk(e,t,n,r){t.forEach((o,i)=>{if(o.isText){let a,s=/\r?\n|\r/g;for(;a=s.exec(o.text);){let o=e.mapping.slice(r).map(n+1+i+a.index);e.replaceWith(o,o+1,t.type.schema.linebreakReplacement.create())}}})}function rk(e,t,n,r){t.forEach((o,i)=>{if(o.type==o.type.schema.linebreakReplacement){let o=e.mapping.slice(r).map(n+1+i);e.replaceWith(o,o+1,t.type.schema.text("\n"))}})}function ok(e,t,n=1,r){let o=e.resolve(t),i=o.depth-n,a=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!a.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(let c=o.depth-1,u=n-2;c>i;c--,u--){let e=o.node(c),t=o.index(c);if(e.type.spec.isolating)return!1;let n=e.content.cutByIndex(t,e.childCount),i=r&&r[u+1];i&&(n=n.replaceChild(0,i.type.create(i.attrs)));let a=r&&r[u]||e;if(!e.canReplace(t+1,e.childCount)||!a.type.validContent(n))return!1}let s=o.indexAfter(i),l=r&&r[0];return o.node(i).canReplaceWith(s,s,l?l.type:o.node(i+1).type)}function ik(e,t){let n=e.resolve(t),r=n.index();return function(e,t){return!(!e||!t||e.isLeaf||!function(e,t){t.content.size||e.type.compatibleContent(t.type);let n=e.contentMatchAt(e.childCount),{linebreakReplacement:r}=e.type.schema;for(let o=0;o<t.childCount;o++){let i=t.child(o),a=i.type==r?e.type.schema.nodes.text:i.type;if(n=n.matchType(a),!n)return!1;if(!e.type.allowsMarks(i.marks))return!1}return n.validEnd}(e,t))}(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function ak(e,t,n=t,r=$w.empty){if(t==n&&!r.size)return null;let o=e.resolve(t),i=e.resolve(n);return sk(o,i,r)?new Yb(t,n,r):new lk(o,i,r).fit()}function sk(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}jb.jsonID("replaceAround",Jb);class lk{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=Ow.empty;for(let r=0;r<=e.depth;r++){let t=e.node(r);this.frontier.push({type:t.type,match:t.contentMatchAt(e.indexAfter(r))})}for(let r=e.depth;r>0;r--)this.placed=Ow.from(e.node(r).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,r=this.close(e<0?this.$to:n.doc.resolve(e));if(!r)return null;let o=this.placed,i=n.depth,a=r.depth;for(;i&&a&&1==o.childCount;)o=o.firstChild.content,i--,a--;let s=new $w(o,i,a);return e>-1?new Jb(n.pos,e,this.$to.pos,this.$to.end(),s,t):s.size||n.pos!=this.$to.pos?new Yb(n.pos,r.pos,s):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,n=0,r=this.unplaced.openEnd;n<e;n++){let o=t.firstChild;if(t.childCount>1&&(r=0),o.type.spec.isolating&&r<=n){e=n;break}t=o.content}for(let t=1;t<=2;t++)for(let n=1==t?e:this.unplaced.openStart;n>=0;n--){let e,r=null;n?(r=dk(this.unplaced.content,n-1).firstChild,e=r.content):e=this.unplaced.content;let o=e.firstChild;for(let i=this.depth;i>=0;i--){let e,{type:a,match:s}=this.frontier[i],l=null;if(1==t&&(o?s.matchType(o.type)||(l=s.fillBefore(Ow.from(o),!1)):r&&a.compatibleContent(r.type)))return{sliceDepth:n,frontierDepth:i,parent:r,inject:l};if(2==t&&o&&(e=s.findWrapping(o.type)))return{sliceDepth:n,frontierDepth:i,parent:r,wrap:e};if(r&&s.matchType(r.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=dk(e,t);return!(!r.childCount||r.firstChild.isLeaf)&&(this.unplaced=new $w(e,t+1,Math.max(n,r.size+t>=e.size-n?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=dk(e,t);if(r.childCount<=1&&t>0){let o=e.size-t<=t+r.size;this.unplaced=new $w(ck(e,t-1,1),t-1,o?t-1:n)}else this.unplaced=new $w(ck(e,t,1),t,n)}placeNodes({sliceDepth:e,frontierDepth:t,parent:n,inject:r,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let f=0;f<o.length;f++)this.openFrontierNode(o[f]);let i=this.unplaced,a=n?n.content:i.content,s=i.openStart-e,l=0,c=[],{match:u,type:d}=this.frontier[t];if(r){for(let e=0;e<r.childCount;e++)c.push(r.child(e));u=u.matchFragment(r)}let p=a.size+e-(i.content.size-i.openEnd);for(;l<a.childCount;){let e=a.child(l),t=u.matchType(e.type);if(!t)break;l++,(l>1||0==s||e.content.size)&&(u=t,c.push(pk(e.mark(d.allowedMarks(e.marks)),1==l?s:0,l==a.childCount?p:-1)))}let h=l==a.childCount;h||(p=-1),this.placed=uk(this.placed,t,Ow.from(c)),this.frontier[t].match=u,h&&p<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let f=0,m=a;f<p;f++){let e=m.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),m=e.content}this.unplaced=h?0==e?$w.empty:new $w(ck(i.content,e-1,1),e-1,p<0?i.openEnd:e-1):new $w(ck(i.content,e,l),i.openStart,i.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e,t=this.frontier[this.depth];if(!t.type.isTextblock||!hk(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:n}=this.$to,r=this.$to.after(n);for(;n>1&&r==this.$to.end(--n);)++r;return r}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:r}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),i=hk(e,t,r,n,o);if(i){for(let n=t-1;n>=0;n--){let{match:t,type:r}=this.frontier[n],o=hk(e,n,r,t,!0);if(!o||o.childCount)continue e}return{depth:t,fit:i,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=uk(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let t=e.node(n),r=t.type.contentMatch.fillBefore(t.content,!0,e.index(n));this.openFrontierNode(t.type,t.attrs,r)}return e}openFrontierNode(e,t=null,n){let r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=uk(this.placed,this.depth,Ow.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(Ow.empty,!0);e.childCount&&(this.placed=uk(this.placed,this.frontier.length,e))}}function ck(e,t,n){return 0==t?e.cutByIndex(n,e.childCount):e.replaceChild(0,e.firstChild.copy(ck(e.firstChild.content,t-1,n)))}function uk(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(uk(e.lastChild.content,t-1,n)))}function dk(e,t){for(let n=0;n<t;n++)e=e.firstChild.content;return e}function pk(e,t,n){if(t<=0)return e;let r=e.content;return t>1&&(r=r.replaceChild(0,pk(r.firstChild,t-1,1==r.childCount?n-1:0))),t>0&&(r=e.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(e.type.contentMatch.matchFragment(r).fillBefore(Ow.empty,!0)))),e.copy(r)}function hk(e,t,n,r,o){let i=e.node(t),a=o?e.indexAfter(t):e.index(t);if(a==i.childCount&&!n.compatibleContent(i.type))return null;let s=r.fillBefore(i.content,!0,a);return s&&!function(e,t,n){for(let r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}(n,i.content,a)?s:null}function fk(e){return e.spec.defining||e.spec.definingForContent}function mk(e,t,n,r,o){if(t<n){let o=e.firstChild;e=e.replaceChild(0,o.copy(mk(o.content,t+1,n,r,o)))}if(t>r){let t=o.contentMatchAt(0),n=t.fillBefore(e).append(e);e=n.append(t.matchFragment(n).fillBefore(Ow.empty,!0))}return e}function gk(e,t){let n=[];for(let r=Math.min(e.depth,t.depth);r>=0;r--){let o=e.start(r);if(o<e.pos-(e.depth-r)||t.end(r)>t.pos+(t.depth-r)||e.node(r).type.spec.isolating||t.node(r).type.spec.isolating)break;(o==t.start(r)||r==e.depth&&r==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&r&&t.start(r-1)==o-1)&&n.push(r)}return n}class vk extends jb{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return Vb.fail("No node at attribute step's position");let n=Object.create(null);for(let o in t.attrs)n[o]=t.attrs[o];n[this.attr]=this.value;let r=t.type.create(n,null,t.marks);return Vb.fromReplace(e,this.pos,this.pos+1,new $w(Ow.from(r),0,t.isLeaf?0:1))}getMap(){return zb.empty}invert(e){return new vk(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new vk(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new vk(t.pos,t.attr,t.value)}}jb.jsonID("attr",vk);class yk extends jb{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let r in e.attrs)t[r]=e.attrs[r];t[this.attr]=this.value;let n=e.type.create(t,e.content,e.marks);return Vb.ok(n)}getMap(){return zb.empty}invert(e){return new yk(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if("string"!=typeof t.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new yk(t.attr,t.value)}}jb.jsonID("docAttr",yk);let wk=class extends Error{};wk=function e(t){let n=Error.call(this,t);return n.__proto__=e.prototype,n},(wk.prototype=Object.create(Error.prototype)).constructor=wk,wk.prototype.name="TransformError";class bk{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Bb}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new wk(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,n=$w.empty){let r=ak(this.doc,e,t,n);return r&&this.step(r),this}replaceWith(e,t,n){return this.replace(e,t,new $w(Ow.from(n),0,0))}delete(e,t){return this.replace(e,t,$w.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,n){return function(e,t,n,r){if(!r.size)return e.deleteRange(t,n);let o=e.doc.resolve(t),i=e.doc.resolve(n);if(sk(o,i,r))return e.step(new Yb(t,n,r));let a=gk(o,e.doc.resolve(n));0==a[a.length-1]&&a.pop();let s=-(o.depth+1);a.unshift(s);for(let p=o.depth,h=o.pos-1;p>0;p--,h--){let e=o.node(p).type.spec;if(e.defining||e.definingAsContext||e.isolating)break;a.indexOf(p)>-1?s=p:o.before(p)==h&&a.splice(1,0,-p)}let l=a.indexOf(s),c=[],u=r.openStart;for(let p=r.content,h=0;;h++){let e=p.firstChild;if(c.push(e),h==r.openStart)break;p=e.content}for(let p=u-1;p>=0;p--){let e=c[p],t=fk(e.type);if(t&&!e.sameMarkup(o.node(Math.abs(s)-1)))u=p;else if(t||!e.type.isTextblock)break}for(let p=r.openStart;p>=0;p--){let t=(p+u+1)%(r.openStart+1),s=c[t];if(s)for(let c=0;c<a.length;c++){let u=a[(c+l)%a.length],d=!0;u<0&&(d=!1,u=-u);let p=o.node(u-1),h=o.index(u-1);if(p.canReplaceWith(h,h,s.type,s.marks))return e.replace(o.before(u),d?i.after(u):n,new $w(mk(r.content,0,r.openStart,t),t,r.openEnd))}}let d=e.steps.length;for(let p=a.length-1;p>=0&&(e.replace(t,n,r),!(e.steps.length>d));p--){let e=a[p];e<0||(t=o.before(e),n=i.after(e))}}(this,e,t,n),this}replaceRangeWith(e,t,n){return function(e,t,n,r){if(!r.isInline&&t==n&&e.doc.resolve(t).parent.content.size){let o=function(e,t,n){let r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(0==r.parentOffset)for(let o=r.depth-1;o>=0;o--){let e=r.index(o);if(r.node(o).canReplaceWith(e,e,n))return r.before(o+1);if(e>0)return null}if(r.parentOffset==r.parent.content.size)for(let o=r.depth-1;o>=0;o--){let e=r.indexAfter(o);if(r.node(o).canReplaceWith(e,e,n))return r.after(o+1);if(e<r.node(o).childCount)return null}return null}(e.doc,t,r.type);null!=o&&(t=n=o)}e.replaceRange(t,n,new $w(Ow.from(r),0,0))}(this,e,t,n),this}deleteRange(e,t){return function(e,t,n){let r=e.doc.resolve(t),o=e.doc.resolve(n),i=gk(r,o);for(let a=0;a<i.length;a++){let t=i[a],n=a==i.length-1;if(n&&0==t||r.node(t).type.contentMatch.validEnd)return e.delete(r.start(t),o.end(t));if(t>0&&(n||r.node(t-1).canReplace(r.index(t-1),o.indexAfter(t-1))))return e.delete(r.before(t),o.after(t))}for(let a=1;a<=r.depth&&a<=o.depth;a++)if(t-r.start(a)==r.depth-a&&n>r.end(a)&&o.end(a)-n!=o.depth-a&&r.start(a-1)==o.start(a-1)&&r.node(a-1).canReplace(r.index(a-1),o.index(a-1)))return e.delete(r.before(a),n);e.delete(t,n)}(this,e,t),this}lift(e,t){return function(e,t,n){let{$from:r,$to:o,depth:i}=t,a=r.before(i+1),s=o.after(i+1),l=a,c=s,u=Ow.empty,d=0;for(let f=i,m=!1;f>n;f--)m||r.index(f)>0?(m=!0,u=Ow.from(r.node(f).copy(u)),d++):l--;let p=Ow.empty,h=0;for(let f=i,m=!1;f>n;f--)m||o.after(f+1)<o.end(f)?(m=!0,p=Ow.from(o.node(f).copy(p)),h++):c++;e.step(new Jb(l,c,a,s,new $w(u.append(p),d,h),u.size-d,!0))}(this,e,t),this}join(e,t=1){return function(e,t,n){let r=null,{linebreakReplacement:o}=e.doc.type.schema,i=e.doc.resolve(t-n),a=i.node().type;if(o&&a.inlineContent){let e="pre"==a.whitespace,t=!!a.contentMatch.matchType(o);e&&!t?r=!1:!e&&t&&(r=!0)}let s=e.steps.length;if(!1===r){let r=e.doc.resolve(t+n);rk(e,r.node(),r.before(),s)}a.inlineContent&&Xb(e,t+n-1,a,i.node().contentMatchAt(i.index()),null==r);let l=e.mapping.slice(s),c=l.map(t-n);if(e.step(new Yb(c,l.map(t+n,-1),$w.empty,!0)),!0===r){let t=e.doc.resolve(c);nk(e,t.node(),t.before(),e.steps.length)}}(this,e,t),this}wrap(e,t){return function(e,t,n){let r=Ow.empty;for(let a=n.length-1;a>=0;a--){if(r.size){let e=n[a].type.contentMatch.matchFragment(r);if(!e||!e.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=Ow.from(n[a].type.create(n[a].attrs,r))}let o=t.start,i=t.end;e.step(new Jb(o,i,o,i,new $w(r,0,0),n.length,!0))}(this,e,t),this}setBlockType(e,t=e,n,r=null){return function(e,t,n,r,o){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=e.steps.length;e.doc.nodesBetween(t,n,(t,n)=>{let a="function"==typeof o?o(t):o;if(t.isTextblock&&!t.hasMarkup(r,a)&&function(e,t,n){let r=e.resolve(t),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}(e.doc,e.mapping.slice(i).map(n),r)){let o=null;if(r.schema.linebreakReplacement){let e="pre"==r.whitespace,t=!!r.contentMatch.matchType(r.schema.linebreakReplacement);e&&!t?o=!1:!e&&t&&(o=!0)}!1===o&&rk(e,t,n,i),Xb(e,e.mapping.slice(i).map(n,1),r,void 0,null===o);let s=e.mapping.slice(i),l=s.map(n,1),c=s.map(n+t.nodeSize,1);return e.step(new Jb(l,c,l+1,c-1,new $w(Ow.from(r.create(a,null,t.marks)),0,0),1,!0)),!0===o&&nk(e,t,n,i),!1}})}(this,e,t,n,r),this}setNodeMarkup(e,t,n=null,r){return function(e,t,n,r,o){let i=e.doc.nodeAt(t);if(!i)throw new RangeError("No node at given position");n||(n=i.type);let a=n.create(r,null,o||i.marks);if(i.isLeaf)return e.replaceWith(t,t+i.nodeSize,a);if(!n.validContent(i.content))throw new RangeError("Invalid content for node type "+n.name);e.step(new Jb(t,t+i.nodeSize,t+1,t+i.nodeSize-1,new $w(Ow.from(a),0,0),1,!0))}(this,e,t,n,r),this}setNodeAttribute(e,t,n){return this.step(new vk(e,t,n)),this}setDocAttribute(e,t){return this.step(new yk(e,t)),this}addNodeMark(e,t){return this.step(new Wb(e,t)),this}removeNodeMark(e,t){let n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(t instanceof Dw)t.isInSet(n.marks)&&this.step(new Kb(e,t));else{let r,o=n.marks,i=[];for(;r=t.isInSet(o);)i.push(new Kb(e,r)),o=r.removeFromSet(o);for(let e=i.length-1;e>=0;e--)this.step(i[e])}return this}split(e,t=1,n){return function(e,t,n=1,r){let o=e.doc.resolve(t),i=Ow.empty,a=Ow.empty;for(let s=o.depth,l=o.depth-n,c=n-1;s>l;s--,c--){i=Ow.from(o.node(s).copy(i));let e=r&&r[c];a=Ow.from(e?e.type.create(e.attrs,a):o.node(s).copy(a))}e.step(new Yb(t,t,new $w(i.append(a),n,n),!0))}(this,e,t,n),this}addMark(e,t,n){return function(e,t,n,r){let o,i,a=[],s=[];e.doc.nodesBetween(t,n,(e,l,c)=>{if(!e.isInline)return;let u=e.marks;if(!r.isInSet(u)&&c.type.allowsMarkType(r.type)){let c=Math.max(l,t),d=Math.min(l+e.nodeSize,n),p=r.addToSet(u);for(let e=0;e<u.length;e++)u[e].isInSet(p)||(o&&o.to==c&&o.mark.eq(u[e])?o.to=d:a.push(o=new Ub(c,d,u[e])));i&&i.to==c?i.to=d:s.push(i=new Hb(c,d,r))}}),a.forEach(t=>e.step(t)),s.forEach(t=>e.step(t))}(this,e,t,n),this}removeMark(e,t,n){return function(e,t,n,r){let o=[],i=0;e.doc.nodesBetween(t,n,(e,a)=>{if(!e.isInline)return;i++;let s=null;if(r instanceof mb){let t,n=e.marks;for(;t=r.isInSet(n);)(s||(s=[])).push(t),n=t.removeFromSet(n)}else r?r.isInSet(e.marks)&&(s=[r]):s=e.marks;if(s&&s.length){let r=Math.min(a+e.nodeSize,n);for(let e=0;e<s.length;e++){let n,l=s[e];for(let e=0;e<o.length;e++){let t=o[e];t.step==i-1&&l.eq(o[e].style)&&(n=t)}n?(n.to=r,n.step=i):o.push({style:l,from:Math.max(a,t),to:r,step:i})}}}),o.forEach(t=>e.step(new Ub(t.from,t.to,t.style)))}(this,e,t,n),this}clearIncompatible(e,t,n){return Xb(this,e,t,n),this}}const kk=Object.create(null);class xk{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new Ck(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=$w.empty){let n=t.content.lastChild,r=null;for(let a=0;a<t.openEnd;a++)r=n,n=n.lastChild;let o=e.steps.length,i=this.ranges;for(let a=0;a<i.length;a++){let{$from:s,$to:l}=i[a],c=e.mapping.slice(o);e.replaceRange(c.map(s.pos),c.map(l.pos),a?$w.empty:t),0==a&&$k(e,o,(n?n.isInline:r&&r.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,r=this.ranges;for(let o=0;o<r.length;o++){let{$from:i,$to:a}=r[o],s=e.mapping.slice(n),l=s.map(i.pos),c=s.map(a.pos);o?e.deleteRange(l,c):(e.replaceRangeWith(l,c,t),$k(e,n,t.isInline?-1:1))}}static findFrom(e,t,n=!1){let r=e.parent.inlineContent?new Tk(e):Ak(e.node(0),e.parent,e.pos,e.index(),t,n);if(r)return r;for(let o=e.depth-1;o>=0;o--){let r=t<0?Ak(e.node(0),e.node(o),e.before(o+1),e.index(o),t,n):Ak(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,n);if(r)return r}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new Ek(e.node(0))}static atStart(e){return Ak(e,e,0,0,1)||new Ek(e)}static atEnd(e){return Ak(e,e,e.content.size,e.childCount,-1)||new Ek(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=kk[t.type];if(!n)throw new RangeError(`No selection type ${t.type} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in kk)throw new RangeError("Duplicate use of selection JSON ID "+e);return kk[e]=t,t.prototype.jsonID=e,t}getBookmark(){return Tk.between(this.$anchor,this.$head).getBookmark()}}xk.prototype.visible=!0;class Ck{constructor(e,t){this.$from=e,this.$to=t}}let Sk=!1;function Mk(e){Sk||e.parent.inlineContent||(Sk=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class Tk extends xk{constructor(e,t=e){Mk(e),Mk(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return xk.near(n);let r=e.resolve(t.map(this.anchor));return new Tk(r.parent.inlineContent?r:n,n)}replace(e,t=$w.empty){if(super.replace(e,t),t==$w.empty){let t=this.$from.marksAcross(this.$to);t&&e.ensureMarks(t)}}eq(e){return e instanceof Tk&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Ok(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if("number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new Tk(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,n=t){let r=e.resolve(t);return new this(r,n==t?r:e.resolve(n))}static between(e,t,n){let r=e.pos-t.pos;if(n&&!r||(n=r>=0?1:-1),!t.parent.inlineContent){let e=xk.findFrom(t,n,!0)||xk.findFrom(t,-n,!0);if(!e)return xk.near(t,n);t=e.$head}return e.parent.inlineContent||(0==r||(e=(xk.findFrom(e,-n,!0)||xk.findFrom(e,n,!0)).$anchor).pos<t.pos!=r<0)&&(e=t),new Tk(e,t)}}xk.jsonID("text",Tk);class Ok{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Ok(e.map(this.anchor),e.map(this.head))}resolve(e){return Tk.between(e.resolve(this.anchor),e.resolve(this.head))}}class _k extends xk{constructor(e){let t=e.nodeAfter,n=e.node(0).resolve(e.pos+t.nodeSize);super(e,n),this.node=t}map(e,t){let{deleted:n,pos:r}=t.mapResult(this.anchor),o=e.resolve(r);return n?xk.near(o):new _k(o)}content(){return new $w(Ow.from(this.node),0,0)}eq(e){return e instanceof _k&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Nk(this.anchor)}static fromJSON(e,t){if("number"!=typeof t.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new _k(e.resolve(t.anchor))}static create(e,t){return new _k(e.resolve(t))}static isSelectable(e){return!e.isText&&!1!==e.type.spec.selectable}}_k.prototype.visible=!1,xk.jsonID("node",_k);class Nk{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new Ok(n,n):new Nk(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&_k.isSelectable(n)?new _k(t):xk.near(t)}}class Ek extends xk{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=$w.empty){if(t==$w.empty){e.delete(0,e.doc.content.size);let t=xk.atStart(e.doc);t.eq(e.selection)||e.setSelection(t)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Ek(e)}map(e){return new Ek(e)}eq(e){return e instanceof Ek}getBookmark(){return Dk}}xk.jsonID("all",Ek);const Dk={map(){return this},resolve:e=>new Ek(e)};function Ak(e,t,n,r,o,i=!1){if(t.inlineContent)return Tk.create(e,n);for(let a=r-(o>0?0:1);o>0?a<t.childCount:a>=0;a+=o){let r=t.child(a);if(r.isAtom){if(!i&&_k.isSelectable(r))return _k.create(e,n-(o<0?r.nodeSize:0))}else{let t=Ak(e,r,n+o,o<0?r.childCount:0,o,i);if(t)return t}n+=r.nodeSize*o}return null}function $k(e,t,n){let r=e.steps.length-1;if(r<t)return;let o,i=e.steps[r];(i instanceof Yb||i instanceof Jb)&&(e.mapping.maps[r].forEach((e,t,n,r)=>{null==o&&(o=r)}),e.setSelection(xk.near(e.doc.resolve(o),n)))}class Rk extends bk{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&this.updated|1,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=2,this}ensureMarks(e){return Dw.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(e,t){super.addStep(e,t),this.updated=-3&this.updated,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let n=this.selection;return t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||Dw.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,n){let r=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();{if(null==n&&(n=t),n=null==n?t:n,!e)return this.deleteRange(t,n);let o=this.storedMarks;if(!o){let e=this.doc.resolve(t);o=n==t?e.marks():e.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,r.text(e,o)),this.selection.empty||this.setSelection(xk.near(this.selection.$to)),this}}setMeta(e,t){return this.meta["string"==typeof e?e:e.key]=t,this}getMeta(e){return this.meta["string"==typeof e?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function Lk(e,t){return t&&e?e.bind(t):e}class Ik{constructor(e,t,n){this.name=e,this.init=Lk(t.init,n),this.apply=Lk(t.apply,n)}}const Pk=[new Ik("doc",{init:e=>e.doc||e.schema.topNodeType.createAndFill(),apply:e=>e.doc}),new Ik("selection",{init:(e,t)=>e.selection||xk.atStart(t.doc),apply:e=>e.selection}),new Ik("storedMarks",{init:e=>e.storedMarks||null,apply:(e,t,n,r)=>r.selection.$cursor?e.storedMarks:null}),new Ik("scrollToSelection",{init:()=>0,apply:(e,t)=>e.scrolledIntoView?t+1:t})];class zk{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Pk.slice(),t&&t.forEach(e=>{if(this.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");this.plugins.push(e),this.pluginsByKey[e.key]=e,e.spec.state&&this.fields.push(new Ik(e.key,e.spec.state,e))})}}class Bk{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=t){let t=this.config.plugins[n];if(t.spec.filterTransaction&&!t.spec.filterTransaction.call(t,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],n=this.applyInner(e),r=null;for(;;){let o=!1;for(let i=0;i<this.config.plugins.length;i++){let a=this.config.plugins[i];if(a.spec.appendTransaction){let s=r?r[i].n:0,l=r?r[i].state:this,c=s<t.length&&a.spec.appendTransaction.call(a,s?t.slice(s):t,l,n);if(c&&n.filterTransaction(c,i)){if(c.setMeta("appendedTransaction",e),!r){r=[];for(let e=0;e<this.config.plugins.length;e++)r.push(e<i?{state:n,n:t.length}:{state:this,n:0})}t.push(c),n=n.applyInner(c),o=!0}r&&(r[i]={state:n,n:t.length})}}if(!o)return{state:n,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new Bk(this.config),n=this.config.fields;for(let r=0;r<n.length;r++){let o=n[r];t[o.name]=o.apply(e,this[o.name],this,t)}return t}get tr(){return new Rk(this)}static create(e){let t=new zk(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new Bk(t);for(let r=0;r<t.fields.length;r++)n[t.fields[r].name]=t.fields[r].init(e,n);return n}reconfigure(e){let t=new zk(this.schema,e.plugins),n=t.fields,r=new Bk(t);for(let o=0;o<n.length;o++){let t=n[o].name;r[t]=this.hasOwnProperty(t)?this[t]:n[o].init(e,r)}return r}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(e=>e.toJSON())),e&&"object"==typeof e)for(let n in e){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let r=e[n],o=r.spec.state;o&&o.toJSON&&(t[n]=o.toJSON.call(r,this[r.key]))}return t}static fromJSON(e,t,n){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let r=new zk(e.schema,e.plugins),o=new Bk(r);return r.fields.forEach(r=>{if("doc"==r.name)o.doc=Xw.fromJSON(e.schema,t.doc);else if("selection"==r.name)o.selection=xk.fromJSON(o.doc,t.selection);else if("storedMarks"==r.name)t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let i in n){let a=n[i],s=a.spec.state;if(a.key==r.name&&s&&s.fromJSON&&Object.prototype.hasOwnProperty.call(t,i))return void(o[r.name]=s.fromJSON.call(a,e,t[i],o))}o[r.name]=r.init(e,o)}}),o}}function Fk(e,t,n){for(let r in e){let o=e[r];o instanceof Function?o=o.bind(t):"handleDOMEvents"==r&&(o=Fk(o,t,{})),n[r]=o}return n}class jk{constructor(e){this.spec=e,this.props={},e.props&&Fk(e.props,this,this.props),this.key=e.key?e.key.key:qk("plugin")}getState(e){return e[this.key]}}const Vk=Object.create(null);function qk(e){return e in Vk?e+"$"+ ++Vk[e]:(Vk[e]=0,e+"$")}class Hk{constructor(e="key"){this.key=qk(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Uk=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},Wk=function(e){let t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t};let Kk=null;const Yk=function(e,t,n){let r=Kk||(Kk=document.createRange());return r.setEnd(e,null==n?e.nodeValue.length:n),r.setStart(e,t||0),r},Jk=function(e,t,n,r){return n&&(Xk(e,t,n,r,-1)||Xk(e,t,n,r,1))},Gk=/^(img|br|input|textarea|hr)$/i;function Xk(e,t,n,r,o){for(var i;;){if(e==n&&t==r)return!0;if(t==(o<0?0:Zk(e))){let n=e.parentNode;if(!n||1!=n.nodeType||Qk(e)||Gk.test(e.nodeName)||"false"==e.contentEditable)return!1;t=Uk(e)+(o<0?0:1),e=n}else{if(1!=e.nodeType)return!1;{let n=e.childNodes[t+(o<0?-1:0)];if(1==n.nodeType&&"false"==n.contentEditable){if(!(null===(i=n.pmViewDesc)||void 0===i?void 0:i.ignoreForSelection))return!1;t+=o}else e=n,t=o<0?Zk(e):0}}}}function Zk(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function Qk(e){let t;for(let n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}const ex=function(e){return e.focusNode&&Jk(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function tx(e,t){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}const nx="undefined"!=typeof navigator?navigator:null,rx="undefined"!=typeof document?document:null,ox=nx&&nx.userAgent||"",ix=/Edge\/(\d+)/.exec(ox),ax=/MSIE \d/.exec(ox),sx=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ox),lx=!!(ax||sx||ix),cx=ax?document.documentMode:sx?+sx[1]:ix?+ix[1]:0,ux=!lx&&/gecko\/(\d+)/i.test(ox);ux&&(/Firefox\/(\d+)/.exec(ox)||[0,0])[1];const dx=!lx&&/Chrome\/(\d+)/.exec(ox),px=!!dx,hx=dx?+dx[1]:0,fx=!lx&&!!nx&&/Apple Computer/.test(nx.vendor),mx=fx&&(/Mobile\/\w+/.test(ox)||!!nx&&nx.maxTouchPoints>2),gx=mx||!!nx&&/Mac/.test(nx.platform),vx=!!nx&&/Win/.test(nx.platform),yx=/Android \d/.test(ox),wx=!!rx&&"webkitFontSmoothing"in rx.documentElement.style,bx=wx?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function kx(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function xx(e,t){return"number"==typeof e?e:e[t]}function Cx(e){let t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*r}}function Sx(e,t,n){let r=e.someProp("scrollThreshold")||0,o=e.someProp("scrollMargin")||5,i=e.dom.ownerDocument;for(let a=n||e.dom;a;){if(1!=a.nodeType){a=Wk(a);continue}let e=a,n=e==i.body,s=n?kx(i):Cx(e),l=0,c=0;if(t.top<s.top+xx(r,"top")?c=-(s.top-t.top+xx(o,"top")):t.bottom>s.bottom-xx(r,"bottom")&&(c=t.bottom-t.top>s.bottom-s.top?t.top+xx(o,"top")-s.top:t.bottom-s.bottom+xx(o,"bottom")),t.left<s.left+xx(r,"left")?l=-(s.left-t.left+xx(o,"left")):t.right>s.right-xx(r,"right")&&(l=t.right-s.right+xx(o,"right")),l||c)if(n)i.defaultView.scrollBy(l,c);else{let n=e.scrollLeft,r=e.scrollTop;c&&(e.scrollTop+=c),l&&(e.scrollLeft+=l);let o=e.scrollLeft-n,i=e.scrollTop-r;t={left:t.left-o,top:t.top-i,right:t.right-o,bottom:t.bottom-i}}let u=n?"fixed":getComputedStyle(a).position;if(/^(fixed|sticky)$/.test(u))break;a="absolute"==u?a.offsetParent:Wk(a)}}function Mx(e){let t=[],n=e.ownerDocument;for(let r=e;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),e!=n);r=Wk(r));return t}function Tx(e,t){for(let n=0;n<e.length;n++){let{dom:r,top:o,left:i}=e[n];r.scrollTop!=o+t&&(r.scrollTop=o+t),r.scrollLeft!=i&&(r.scrollLeft=i)}}let Ox=null;function _x(e,t){let n,r,o,i,a=2e8,s=0,l=t.top,c=t.top;for(let u=e.firstChild,d=0;u;u=u.nextSibling,d++){let e;if(1==u.nodeType)e=u.getClientRects();else{if(3!=u.nodeType)continue;e=Yk(u).getClientRects()}for(let p=0;p<e.length;p++){let h=e[p];if(h.top<=l&&h.bottom>=c){l=Math.max(h.bottom,l),c=Math.min(h.top,c);let e=h.left>t.left?h.left-t.left:h.right<t.left?t.left-h.right:0;if(e<a){n=u,a=e,r=e&&3==n.nodeType?{left:h.right<t.left?h.right:h.left,top:t.top}:t,1==u.nodeType&&e&&(s=d+(t.left>=(h.left+h.right)/2?1:0));continue}}else h.top>t.top&&!o&&h.left<=t.left&&h.right>=t.left&&(o=u,i={left:Math.max(h.left,Math.min(h.right,t.left)),top:h.top});!n&&(t.left>=h.right&&t.top>=h.top||t.left>=h.left&&t.top>=h.bottom)&&(s=d+1)}}return!n&&o&&(n=o,r=i,a=0),n&&3==n.nodeType?function(e,t){let n=e.nodeValue.length,r=document.createRange();for(let o=0;o<n;o++){r.setEnd(e,o+1),r.setStart(e,o);let n=$x(r,1);if(n.top!=n.bottom&&Nx(t,n))return{node:e,offset:o+(t.left>=(n.left+n.right)/2?1:0)}}return{node:e,offset:0}}(n,r):!n||a&&1==n.nodeType?{node:e,offset:s}:_x(n,r)}function Nx(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function Ex(e,t,n){let r=e.childNodes.length;if(r&&n.top<n.bottom)for(let o=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-n.top)/(n.bottom-n.top))-2)),i=o;;){let n=e.childNodes[i];if(1==n.nodeType){let e=n.getClientRects();for(let r=0;r<e.length;r++){let o=e[r];if(Nx(t,o))return Ex(n,t,o)}}if((i=(i+1)%r)==o)break}return e}function Dx(e,t){let n,r=e.dom.ownerDocument,o=0,i=function(e,t,n){if(e.caretPositionFromPoint)try{let r=e.caretPositionFromPoint(t,n);if(r)return{node:r.offsetNode,offset:Math.min(Zk(r.offsetNode),r.offset)}}catch(r){}if(e.caretRangeFromPoint){let r=e.caretRangeFromPoint(t,n);if(r)return{node:r.startContainer,offset:Math.min(Zk(r.startContainer),r.startOffset)}}}(r,t.left,t.top);i&&({node:n,offset:o}=i);let a,s=(e.root.elementFromPoint?e.root:r).elementFromPoint(t.left,t.top);if(!s||!e.dom.contains(1!=s.nodeType?s.parentNode:s)){let n=e.dom.getBoundingClientRect();if(!Nx(t,n))return null;if(s=Ex(e.dom,t,n),!s)return null}if(fx)for(let c=s;n&&c;c=Wk(c))c.draggable&&(n=void 0);if(s=function(e,t){let n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}(s,t),n){if(ux&&1==n.nodeType&&(o=Math.min(o,n.childNodes.length),o<n.childNodes.length)){let e,r=n.childNodes[o];"IMG"==r.nodeName&&(e=r.getBoundingClientRect()).right<=t.left&&e.bottom>t.top&&o++}let r;wx&&o&&1==n.nodeType&&1==(r=n.childNodes[o-1]).nodeType&&"false"==r.contentEditable&&r.getBoundingClientRect().top>=t.top&&o--,n==e.dom&&o==n.childNodes.length-1&&1==n.lastChild.nodeType&&t.top>n.lastChild.getBoundingClientRect().bottom?a=e.state.doc.content.size:0!=o&&1==n.nodeType&&"BR"==n.childNodes[o-1].nodeName||(a=function(e,t,n,r){let o=-1;for(let i=t,a=!1;i!=e.dom;){let t,n=e.docView.nearestDesc(i,!0);if(!n)return null;if(1==n.dom.nodeType&&(n.node.isBlock&&n.parent||!n.contentDOM)&&((t=n.dom.getBoundingClientRect()).width||t.height)&&(n.node.isBlock&&n.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(n.dom.nodeName)&&(!a&&t.left>r.left||t.top>r.top?o=n.posBefore:(!a&&t.right<r.left||t.bottom<r.top)&&(o=n.posAfter),a=!0),!n.contentDOM&&o<0&&!n.node.isText))return(n.node.isBlock?r.top<(t.top+t.bottom)/2:r.left<(t.left+t.right)/2)?n.posBefore:n.posAfter;i=n.dom.parentNode}return o>-1?o:e.docView.posFromDOM(t,n,-1)}(e,n,o,t))}null==a&&(a=function(e,t,n){let{node:r,offset:o}=_x(t,n),i=-1;if(1==r.nodeType&&!r.firstChild){let e=r.getBoundingClientRect();i=e.left!=e.right&&n.left>(e.left+e.right)/2?1:-1}return e.docView.posFromDOM(r,o,i)}(e,s,t));let l=e.docView.nearestDesc(s,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function Ax(e){return e.top<e.bottom||e.left<e.right}function $x(e,t){let n=e.getClientRects();if(n.length){let e=n[t<0?0:n.length-1];if(Ax(e))return e}return Array.prototype.find.call(n,Ax)||e.getBoundingClientRect()}const Rx=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Lx(e,t,n){let{node:r,offset:o,atom:i}=e.docView.domFromPos(t,n<0?-1:1),a=wx||ux;if(3==r.nodeType){if(!a||!Rx.test(r.nodeValue)&&(n<0?o:o!=r.nodeValue.length)){let e=o,t=o,i=n<0?1:-1;return n<0&&!o?(t++,i=-1):n>=0&&o==r.nodeValue.length?(e--,i=1):n<0?e--:t++,Ix($x(Yk(r,e,t),i),i<0)}{let e=$x(Yk(r,o,o),n);if(ux&&o&&/\s/.test(r.nodeValue[o-1])&&o<r.nodeValue.length){let t=$x(Yk(r,o-1,o-1),-1);if(t.top==e.top){let n=$x(Yk(r,o,o+1),-1);if(n.top!=e.top)return Ix(n,n.left<t.left)}}return e}}if(!e.state.doc.resolve(t-(i||0)).parent.inlineContent){if(null==i&&o&&(n<0||o==Zk(r))){let e=r.childNodes[o-1];if(1==e.nodeType)return Px(e.getBoundingClientRect(),!1)}if(null==i&&o<Zk(r)){let e=r.childNodes[o];if(1==e.nodeType)return Px(e.getBoundingClientRect(),!0)}return Px(r.getBoundingClientRect(),n>=0)}if(null==i&&o&&(n<0||o==Zk(r))){let e=r.childNodes[o-1],t=3==e.nodeType?Yk(e,Zk(e)-(a?0:1)):1!=e.nodeType||"BR"==e.nodeName&&e.nextSibling?null:e;if(t)return Ix($x(t,1),!1)}if(null==i&&o<Zk(r)){let e=r.childNodes[o];for(;e.pmViewDesc&&e.pmViewDesc.ignoreForCoords;)e=e.nextSibling;let t=e?3==e.nodeType?Yk(e,0,a?0:1):1==e.nodeType?e:null:null;if(t)return Ix($x(t,-1),!0)}return Ix($x(3==r.nodeType?Yk(r):r,-n),n>=0)}function Ix(e,t){if(0==e.width)return e;let n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function Px(e,t){if(0==e.height)return e;let n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function zx(e,t,n){let r=e.state,o=e.root.activeElement;r!=t&&e.updateState(t),o!=e.dom&&e.focus();try{return n()}finally{r!=t&&e.updateState(r),o!=e.dom&&o&&o.focus()}}const Bx=/[\u0590-\u08ac]/;let Fx=null,jx=null,Vx=!1;function qx(e,t,n){return Fx==t&&jx==n?Vx:(Fx=t,jx=n,Vx="up"==n||"down"==n?function(e,t,n){let r=t.selection,o="up"==n?r.$from:r.$to;return zx(e,t,()=>{let{node:t}=e.docView.domFromPos(o.pos,"up"==n?-1:1);for(;;){let n=e.docView.nearestDesc(t,!0);if(!n)break;if(n.node.isBlock){t=n.contentDOM||n.dom;break}t=n.dom.parentNode}let r=Lx(e,o.pos,1);for(let e=t.firstChild;e;e=e.nextSibling){let t;if(1==e.nodeType)t=e.getClientRects();else{if(3!=e.nodeType)continue;t=Yk(e,0,e.nodeValue.length).getClientRects()}for(let e=0;e<t.length;e++){let o=t[e];if(o.bottom>o.top+1&&("up"==n?r.top-o.top>2*(o.bottom-r.top):o.bottom-r.bottom>2*(r.bottom-o.top)))return!1}}return!0})}(e,t,n):function(e,t,n){let{$head:r}=t.selection;if(!r.parent.isTextblock)return!1;let o=r.parentOffset,i=!o,a=o==r.parent.content.size,s=e.domSelection();return s?Bx.test(r.parent.textContent)&&s.modify?zx(e,t,()=>{let{focusNode:t,focusOffset:o,anchorNode:i,anchorOffset:a}=e.domSelectionRange(),l=s.caretBidiLevel;s.modify("move",n,"character");let c=r.depth?e.docView.domAfterPos(r.before()):e.dom,{focusNode:u,focusOffset:d}=e.domSelectionRange(),p=u&&!c.contains(1==u.nodeType?u:u.parentNode)||t==u&&o==d;try{s.collapse(i,a),t&&(t!=i||o!=a)&&s.extend&&s.extend(t,o)}catch(h){}return null!=l&&(s.caretBidiLevel=l),p}):"left"==n||"backward"==n?i:a:r.pos==r.start()||r.pos==r.end()}(e,t,n))}class Hx{constructor(e,t,n,r){this.parent=e,this.children=t,this.dom=n,this.contentDOM=r,this.dirty=0,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,n=this.posAtStart;;t++){let r=this.children[t];if(r==e)return n;n+=r.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,n){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(n<0){let n,r;if(e==this.contentDOM)n=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.previousSibling}for(;n&&(!(r=n.pmViewDesc)||r.parent!=this);)n=n.previousSibling;return n?this.posBeforeChild(r)+r.size:this.posAtStart}{let n,r;if(e==this.contentDOM)n=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.nextSibling}for(;n&&(!(r=n.pmViewDesc)||r.parent!=this);)n=n.nextSibling;return n?this.posBeforeChild(r):this.posAtEnd}}let r;if(e==this.dom&&this.contentDOM)r=t>Uk(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))r=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!1;break}if(t.previousSibling)break}if(null==r&&t==e.childNodes.length)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!0;break}if(t.nextSibling)break}}return(null==r?n>0:r)?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let n=!0,r=e;r;r=r.parentNode){let o,i=this.getDesc(r);if(i&&(!t||i.node)){if(!n||!(o=i.nodeDOM)||(1==o.nodeType?o.contains(1==e.nodeType?e:e.parentNode):o==e))return i;n=!1}}}getDesc(e){let t=e.pmViewDesc;for(let n=t;n;n=n.parent)if(n==this)return t}posFromDOM(e,t,n){for(let r=e;r;r=r.parentNode){let o=this.getDesc(r);if(o)return o.localPosFromDOM(e,t,n)}return-1}descAt(e){for(let t=0,n=0;t<this.children.length;t++){let r=this.children[t],o=n+r.size;if(n==e&&o!=n){for(;!r.border&&r.children.length;)for(let e=0;e<r.children.length;e++){let t=r.children[e];if(t.size){r=t;break}}return r}if(e<o)return r.descAt(e-n-r.border);n=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,r=0;for(let o=0;n<this.children.length;n++){let t=this.children[n],i=o+t.size;if(i>e||t instanceof Xx){r=e-o;break}o=i}if(r)return this.children[n].domFromPos(r-this.children[n].border,t);for(let o;n&&!(o=this.children[n-1]).size&&o instanceof Ux&&o.side>=0;n--);if(t<=0){let e,r=!0;for(;e=n?this.children[n-1]:null,e&&e.dom.parentNode!=this.contentDOM;n--,r=!1);return e&&t&&r&&!e.border&&!e.domAtom?e.domFromPos(e.size,t):{node:this.contentDOM,offset:e?Uk(e.dom)+1:0}}{let e,r=!0;for(;e=n<this.children.length?this.children[n]:null,e&&e.dom.parentNode!=this.contentDOM;n++,r=!1);return e&&r&&!e.border&&!e.domAtom?e.domFromPos(0,t):{node:this.contentDOM,offset:e?Uk(e.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,n=0){if(0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let r=-1,o=-1;for(let i=n,a=0;;a++){let n=this.children[a],s=i+n.size;if(-1==r&&e<=s){let o=i+n.border;if(e>=o&&t<=s-n.border&&n.node&&n.contentDOM&&this.contentDOM.contains(n.contentDOM))return n.parseRange(e,t,o);e=i;for(let t=a;t>0;t--){let n=this.children[t-1];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(1)){r=Uk(n.dom)+1;break}e-=n.size}-1==r&&(r=0)}if(r>-1&&(s>t||a==this.children.length-1)){t=s;for(let e=a+1;e<this.children.length;e++){let n=this.children[e];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(-1)){o=Uk(n.dom);break}t+=n.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=s}return{node:this.contentDOM,from:e,to:t,fromOffset:r,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:n}=this.domFromPos(e,0);if(1!=t.nodeType||n==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[n]}setSelection(e,t,n,r=!1){let o=Math.min(e,t),i=Math.max(e,t);for(let h=0,f=0;h<this.children.length;h++){let a=this.children[h],s=f+a.size;if(o>f&&i<s)return a.setSelection(e-f-a.border,t-f-a.border,n,r);f=s}let a=this.domFromPos(e,e?-1:1),s=t==e?a:this.domFromPos(t,t?-1:1),l=n.root.getSelection(),c=n.domSelectionRange(),u=!1;if((ux||fx)&&e==t){let{node:e,offset:t}=a;if(3==e.nodeType){if(u=!(!t||"\n"!=e.nodeValue[t-1]),u&&t==e.nodeValue.length)for(let n,r=e;r;r=r.parentNode){if(n=r.nextSibling){"BR"==n.nodeName&&(a=s={node:n.parentNode,offset:Uk(n)+1});break}let e=r.pmViewDesc;if(e&&e.node&&e.node.isBlock)break}}else{let n=e.childNodes[t-1];u=n&&("BR"==n.nodeName||"false"==n.contentEditable)}}if(ux&&c.focusNode&&c.focusNode!=s.node&&1==c.focusNode.nodeType){let e=c.focusNode.childNodes[c.focusOffset];e&&"false"==e.contentEditable&&(r=!0)}if(!(r||u&&fx)&&Jk(a.node,a.offset,c.anchorNode,c.anchorOffset)&&Jk(s.node,s.offset,c.focusNode,c.focusOffset))return;let d=!1;if((l.extend||e==t)&&(!u||!ux)){l.collapse(a.node,a.offset);try{e!=t&&l.extend(s.node,s.offset),d=!0}catch(p){}}if(!d){if(e>t){let e=a;a=s,s=e}let n=document.createRange();n.setEnd(s.node,s.offset),n.setStart(a.node,a.offset),l.removeAllRanges(),l.addRange(n)}}ignoreMutation(e){return!this.contentDOM&&"selection"!=e.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let n=0,r=0;r<this.children.length;r++){let o=this.children[r],i=n+o.size;if(n==i?e<=i&&t>=n:e<i&&t>n){let r=n+o.border,a=i-o.border;if(e>=r&&t<=a)return this.dirty=e==n||t==i?2:1,void(e!=r||t!=a||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(e-r,t-r):o.dirty=3);o.dirty=o.dom!=o.contentDOM||o.dom.parentNode!=this.contentDOM||o.children.length?3:2}n=i}this.dirty=2}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let n=1==e?2:1;t.dirty<n&&(t.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class Ux extends Hx{constructor(e,t,n,r){let o,i=t.type.toDOM;if("function"==typeof i&&(i=i(n,()=>o?o.parent?o.parent.posBeforeChild(o):void 0:r)),!t.type.spec.raw){if(1!=i.nodeType){let e=document.createElement("span");e.appendChild(i),i=e}i.contentEditable="false",i.classList.add("ProseMirror-widget")}super(e,[],i,null),this.widget=t,this.widget=t,o=this}matchesWidget(e){return 0==this.dirty&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return!!t&&t(e)}ignoreMutation(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class Wx extends Hx{constructor(e,t,n,r){super(e,[],t,null),this.textDOM=n,this.text=r}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}class Kx extends Hx{constructor(e,t,n,r,o){super(e,[],n,r),this.mark=t,this.spec=o}static create(e,t,n,r){let o=r.nodeViews[t.type.name],i=o&&o(t,r,n);return i&&i.dom||(i=_b.renderSpec(document,t.type.spec.toDOM(t,n),null,t.attrs)),new Kx(e,t,i.dom,i.contentDOM||i.dom,i)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return 3!=this.dirty&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),0!=this.dirty){let e=this.parent;for(;!e.node;)e=e.parent;e.dirty<this.dirty&&(e.dirty=this.dirty),this.dirty=0}}slice(e,t,n){let r=Kx.create(this.parent,this.mark,!0,n),o=this.children,i=this.size;t<i&&(o=uC(o,t,i,n)),e>0&&(o=uC(o,0,e,n));for(let a=0;a<o.length;a++)o[a].parent=r;return r.children=o,r}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Yx extends Hx{constructor(e,t,n,r,o,i,a,s,l){super(e,[],o,i),this.node=t,this.outerDeco=n,this.innerDeco=r,this.nodeDOM=a}static create(e,t,n,r,o,i){let a,s=o.nodeViews[t.type.name],l=s&&s(t,o,()=>a?a.parent?a.parent.posBeforeChild(a):void 0:i,n,r),c=l&&l.dom,u=l&&l.contentDOM;if(t.isText)if(c){if(3!=c.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else c=document.createTextNode(t.text);else if(!c){let e=_b.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs);({dom:c,contentDOM:u}=e)}u||t.isText||"BR"==c.nodeName||(c.hasAttribute("contenteditable")||(c.contentEditable="false"),t.type.spec.draggable&&(c.draggable=!0));let d=c;return c=iC(c,n,t),l?a=new Zx(e,t,n,r,c,u||null,d,l,o,i+1):t.isText?new Gx(e,t,n,r,c,d,o):new Yx(e,t,n,r,c,u||null,d,o,i+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let t=this.children.length-1;t>=0;t--){let n=this.children[t];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>Ow.empty)}else e.contentElement=this.contentDOM;else e.getContent=()=>this.node.content;return e}matchesNode(e,t,n){return 0==this.dirty&&e.eq(this.node)&&aC(t,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let n=this.node.inlineContent,r=t,o=e.composing?this.localCompositionInfo(e,t):null,i=o&&o.pos>-1?o:null,a=o&&o.pos<0,s=new lC(this,i&&i.node,e);!function(e,t,n,r){let o=t.locals(e),i=0;if(0==o.length){for(let n=0;n<e.childCount;n++){let a=e.child(n);r(a,o,t.forChild(i,a),n),i+=a.nodeSize}return}let a=0,s=[],l=null;for(let c=0;;){let u,d,p,h;for(;a<o.length&&o[a].to==i;){let e=o[a++];e.widget&&(u?(d||(d=[u])).push(e):u=e)}if(u)if(d){d.sort(cC);for(let e=0;e<d.length;e++)n(d[e],c,!!l)}else n(u,c,!!l);if(l)h=-1,p=l,l=null;else{if(!(c<e.childCount))break;h=c,p=e.child(c++)}for(let e=0;e<s.length;e++)s[e].to<=i&&s.splice(e--,1);for(;a<o.length&&o[a].from<=i&&o[a].to>i;)s.push(o[a++]);let f=i+p.nodeSize;if(p.isText){let e=f;a<o.length&&o[a].from<e&&(e=o[a].from);for(let t=0;t<s.length;t++)s[t].to<e&&(e=s[t].to);e<f&&(l=p.cut(e-i),p=p.cut(0,e-i),f=e,h=-1)}else for(;a<o.length&&o[a].to<f;)a++;let m=p.isInline&&!p.isLeaf?s.filter(e=>!e.inline):s.slice();r(p,m,t.forChild(i,p),h),i=f}}(this.node,this.innerDeco,(t,o,i)=>{t.spec.marks?s.syncToMarks(t.spec.marks,n,e):t.type.side>=0&&!i&&s.syncToMarks(o==this.node.childCount?Dw.none:this.node.child(o).marks,n,e),s.placeWidget(t,e,r)},(t,i,l,c)=>{let u;s.syncToMarks(t.marks,n,e),s.findNodeMatch(t,i,l,c)||a&&e.state.selection.from>r&&e.state.selection.to<r+t.nodeSize&&(u=s.findIndexWithChild(o.node))>-1&&s.updateNodeAt(t,i,l,u,e)||s.updateNextNode(t,i,l,e,c,r)||s.addNode(t,i,l,e,r),r+=t.nodeSize}),s.syncToMarks([],n,e),this.node.isTextblock&&s.addTextblockHacks(),s.destroyRest(),(s.changed||2==this.dirty)&&(i&&this.protectLocalComposition(e,i),Qx(this.contentDOM,this.children,e),mx&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))}localCompositionInfo(e,t){let{from:n,to:r}=e.state.selection;if(!(e.state.selection instanceof Tk)||n<t||r>t+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let e=o.nodeValue,i=function(e,t,n,r){for(let o=0,i=0;o<e.childCount&&i<=r;){let a=e.child(o++),s=i;if(i+=a.nodeSize,!a.isText)continue;let l=a.text;for(;o<e.childCount;){let t=e.child(o++);if(i+=t.nodeSize,!t.isText)break;l+=t.text}if(i>=n){if(i>=r&&l.slice(r-t.length-s,r-s)==t)return r-t.length;let e=s<r?l.lastIndexOf(t,r-s-1):-1;if(e>=0&&e+t.length+s>=n)return s+e;if(n==r&&l.length>=r+t.length-s&&l.slice(r-s,r-s+t.length)==t)return r}}return-1}(this.node.content,e,n-t,r-t);return i<0?null:{node:o,pos:i,text:e}}return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:n,text:r}){if(this.getDesc(t))return;let o=t;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let i=new Wx(this,o,t,r);e.input.compositionNodes.push(i),this.children=uC(this.children,n,n+r.length,e,i)}update(e,t,n,r){return!(3==this.dirty||!e.sameMarkup(this.node))&&(this.updateInner(e,t,n,r),!0)}updateInner(e,t,n,r){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0}updateOuterDeco(e){if(aC(e,this.outerDeco))return;let t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=rC(this.dom,this.nodeDOM,nC(this.outerDeco,this.node,t),nC(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.nodeDOM.draggable=!0))}deselectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function Jx(e,t,n,r,o){iC(r,t,e);let i=new Yx(void 0,e,t,n,r,r,r,o,0);return i.contentDOM&&i.updateChildren(o,0),i}class Gx extends Yx{constructor(e,t,n,r,o,i,a){super(e,t,n,r,o,null,i,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,n,r){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node))&&(this.updateOuterDeco(t),0==this.dirty&&e.text==this.node.text||e.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=0,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,n){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,n)}ignoreMutation(e){return"characterData"!=e.type&&"selection"!=e.type}slice(e,t,n){let r=this.node.cut(e,t),o=document.createTextNode(r.text);return new Gx(this.parent,r,this.outerDeco,this.innerDeco,o,o,n)}markDirty(e,t){super.markDirty(e,t),this.dom==this.nodeDOM||0!=e&&t!=this.nodeDOM.nodeValue.length||(this.dirty=3)}get domAtom(){return!1}isText(e){return this.node.text==e}}class Xx extends Hx{parseRule(){return{ignore:!0}}matchesHack(e){return 0==this.dirty&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class Zx extends Yx{constructor(e,t,n,r,o,i,a,s,l,c){super(e,t,n,r,o,i,a,l,c),this.spec=s}update(e,t,n,r){if(3==this.dirty)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,t,n);return o&&this.updateInner(e,t,n,r),o}return!(!this.contentDOM&&!e.isLeaf)&&super.update(e,t,n,r)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,n,r){this.spec.setSelection?this.spec.setSelection(e,t,n.root):super.setSelection(e,t,n,r)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function Qx(e,t,n){let r=e.firstChild,o=!1;for(let i=0;i<t.length;i++){let a=t[i],s=a.dom;if(s.parentNode==e){for(;s!=r;)r=sC(r),o=!0;r=r.nextSibling}else o=!0,e.insertBefore(s,r);if(a instanceof Kx){let t=r?r.previousSibling:e.lastChild;Qx(a.contentDOM,a.children,n),r=t?t.nextSibling:e.firstChild}}for(;r;)r=sC(r),o=!0;o&&n.trackWrites==e&&(n.trackWrites=null)}const eC=function(e){e&&(this.nodeName=e)};eC.prototype=Object.create(null);const tC=[new eC];function nC(e,t,n){if(0==e.length)return tC;let r=n?tC[0]:new eC,o=[r];for(let i=0;i<e.length;i++){let a=e[i].type.attrs;if(a){a.nodeName&&o.push(r=new eC(a.nodeName));for(let e in a){let i=a[e];null!=i&&(n&&1==o.length&&o.push(r=new eC(t.isInline?"span":"div")),"class"==e?r.class=(r.class?r.class+" ":"")+i:"style"==e?r.style=(r.style?r.style+";":"")+i:"nodeName"!=e&&(r[e]=i))}}}return o}function rC(e,t,n,r){if(n==tC&&r==tC)return t;let o=t;for(let i=0;i<r.length;i++){let t=r[i],a=n[i];if(i){let n;a&&a.nodeName==t.nodeName&&o!=e&&(n=o.parentNode)&&n.nodeName.toLowerCase()==t.nodeName||(n=document.createElement(t.nodeName),n.pmIsDeco=!0,n.appendChild(o),a=tC[0]),o=n}oC(o,a||tC[0],t)}return o}function oC(e,t,n){for(let r in t)"class"==r||"style"==r||"nodeName"==r||r in n||e.removeAttribute(r);for(let r in n)"class"!=r&&"style"!=r&&"nodeName"!=r&&n[r]!=t[r]&&e.setAttribute(r,n[r]);if(t.class!=n.class){let r=t.class?t.class.split(" ").filter(Boolean):[],o=n.class?n.class.split(" ").filter(Boolean):[];for(let t=0;t<r.length;t++)-1==o.indexOf(r[t])&&e.classList.remove(r[t]);for(let t=0;t<o.length;t++)-1==r.indexOf(o[t])&&e.classList.add(o[t]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style){let n,r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;n=r.exec(t.style);)e.style.removeProperty(n[1])}n.style&&(e.style.cssText+=n.style)}}function iC(e,t,n){return rC(e,e,tC,nC(t,n,1!=e.nodeType))}function aC(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function sC(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class lC{constructor(e,t,n){this.lock=t,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=function(e,t){let n=t,r=n.children.length,o=e.childCount,i=new Map,a=[];e:for(;o>0;){let s;for(;;)if(r){let e=n.children[r-1];if(!(e instanceof Kx)){s=e,r--;break}n=e,r=e.children.length}else{if(n==t)break e;r=n.parent.children.indexOf(n),n=n.parent}let l=s.node;if(l){if(l!=e.child(o-1))break;--o,i.set(s,o),a.push(s)}}return{index:o,matched:i,matches:a.reverse()}}(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,n){let r=0,o=this.stack.length>>1,i=Math.min(o,e.length);for(;r<i&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&!1!==e[r].type.spec.spanning;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let r=-1;for(let t=this.index;t<Math.min(this.index+3,this.top.children.length);t++){let n=this.top.children[t];if(n.matchesMark(e[o])&&!this.isLocked(n.dom)){r=t;break}}if(r>-1)r>this.index&&(this.changed=!0,this.destroyBetween(this.index,r)),this.top=this.top.children[this.index];else{let r=Kx.create(this.top,e[o],t,n);this.top.children.splice(this.index,0,r),this.top=r,this.changed=!0}this.index=0,o++}}findNodeMatch(e,t,n,r){let o,i=-1;if(r>=this.preMatch.index&&(o=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,n))i=this.top.children.indexOf(o,this.index);else for(let a=this.index,s=Math.min(this.top.children.length,a+5);a<s;a++){let r=this.top.children[a];if(r.matchesNode(e,t,n)&&!this.preMatch.matched.has(r)){i=a;break}}return!(i<0)&&(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,n,r,o){let i=this.top.children[r];return 3==i.dirty&&i.dom==i.contentDOM&&(i.dirty=2),!!i.update(e,t,n,o)&&(this.destroyBetween(this.index,r),this.index++,!0)}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let t=e.pmViewDesc;if(t)for(let e=this.index;e<this.top.children.length;e++)if(this.top.children[e]==t)return e;return-1}e=t}}updateNextNode(e,t,n,r,o,i){for(let a=this.index;a<this.top.children.length;a++){let s=this.top.children[a];if(s instanceof Yx){let l=this.preMatch.matched.get(s);if(null!=l&&l!=o)return!1;let c,u=s.dom,d=this.isLocked(u)&&!(e.isText&&s.node&&s.node.isText&&s.nodeDOM.nodeValue==e.text&&3!=s.dirty&&aC(t,s.outerDeco));if(!d&&s.update(e,t,n,r))return this.destroyBetween(this.index,a),s.dom!=u&&(this.changed=!0),this.index++,!0;if(!d&&(c=this.recreateWrapper(s,e,t,n,r,i)))return this.destroyBetween(this.index,a),this.top.children[this.index]=c,c.contentDOM&&(c.dirty=2,c.updateChildren(r,i+1),c.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,n,r,o,i){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!aC(n,e.outerDeco)||!r.eq(e.innerDeco))return null;let a=Yx.create(this.top,t,n,r,o,i);if(a.contentDOM){a.children=e.children,e.children=[];for(let e of a.children)e.parent=a}return e.destroy(),a}addNode(e,t,n,r,o){let i=Yx.create(this.top,e,t,n,r,o);i.contentDOM&&i.updateChildren(r,o+1),this.top.children.splice(this.index++,0,i),this.changed=!0}placeWidget(e,t,n){let r=this.index<this.top.children.length?this.top.children[this.index]:null;if(!r||!r.matchesWidget(e)||e!=r.widget&&r.widget.type.toDOM.parentNode){let r=new Ux(this.top,e,t,n);this.top.children.splice(this.index++,0,r),this.changed=!0}else this.index++}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof Kx;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof Gx)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((fx||px)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);"IMG"==e&&(n.className="ProseMirror-separator",n.alt=""),"BR"==e&&(n.className="ProseMirror-trailingBreak");let r=new Xx(this.top,[],n,null);t!=this.top?t.children.push(r):t.children.splice(this.index++,0,r),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||1==e.nodeType&&e.contains(this.lock.parentNode))}}function cC(e,t){return e.type.side-t.type.side}function uC(e,t,n,r,o){let i=[];for(let a=0,s=0;a<e.length;a++){let l=e[a],c=s,u=s+=l.size;c>=n||u<=t?i.push(l):(c<t&&i.push(l.slice(0,t-c,r)),o&&(i.push(o),o=void 0),u>n&&i.push(l.slice(n-c,l.size,r)))}return i}function dC(e,t=null){let n=e.domSelectionRange(),r=e.state.doc;if(!n.focusNode)return null;let o=e.docView.nearestDesc(n.focusNode),i=o&&0==o.size,a=e.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(a<0)return null;let s,l,c=r.resolve(a);if(ex(n)){for(s=a;o&&!o.node;)o=o.parent;let e=o.node;if(o&&e.isAtom&&_k.isSelectable(e)&&o.parent&&(!e.isInline||!function(e,t,n){for(let r=0==t,o=t==Zk(e);r||o;){if(e==n)return!0;let t=Uk(e);if(!(e=e.parentNode))return!1;r=r&&0==t,o=o&&t==Zk(e)}}(n.focusNode,n.focusOffset,o.dom))){let e=o.posBefore;l=new _k(a==e?c:r.resolve(e))}}else{if(n instanceof e.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let t=a,o=a;for(let r=0;r<n.rangeCount;r++){let i=n.getRangeAt(r);t=Math.min(t,e.docView.posFromDOM(i.startContainer,i.startOffset,1)),o=Math.max(o,e.docView.posFromDOM(i.endContainer,i.endOffset,-1))}if(t<0)return null;[s,a]=o==e.state.selection.anchor?[o,t]:[t,o],c=r.resolve(a)}else s=e.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(s<0)return null}let u=r.resolve(s);if(!l){l=bC(e,u,c,"pointer"==t||e.state.selection.head<c.pos&&!i?1:-1)}return l}function pC(e){return e.editable?e.hasFocus():xC(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function hC(e,t=!1){let n=e.state.selection;if(yC(e,n),pC(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&px){let t=e.domSelectionRange(),n=e.domObserver.currentSelection;if(t.anchorNode&&n.anchorNode&&Jk(t.anchorNode,t.anchorOffset,n.anchorNode,n.anchorOffset))return e.input.mouseDown.delayedSelectionSync=!0,void e.domObserver.setCurSelection()}if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){let t=e.domSelection();if(!t)return;let n=e.cursorWrapper.dom,r="IMG"==n.nodeName;r?t.collapse(n.parentNode,Uk(n)+1):t.collapse(n,0);!r&&!e.state.selection.visible&&lx&&cx<=11&&(n.disabled=!0,n.disabled=!1)}(e);else{let r,o,{anchor:i,head:a}=n;!fC||n instanceof Tk||(n.$from.parent.inlineContent||(r=mC(e,n.from)),n.empty||n.$from.parent.inlineContent||(o=mC(e,n.to))),e.docView.setSelection(i,a,e,t),fC&&(r&&vC(r),o&&vC(o)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let n=e.domSelectionRange(),r=n.anchorNode,o=n.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{n.anchorNode==r&&n.anchorOffset==o||(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{pC(e)&&!e.state.selection.visible||e.dom.classList.remove("ProseMirror-hideselection")},20))})}(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}const fC=fx||px&&hx<63;function mC(e,t){let{node:n,offset:r}=e.docView.domFromPos(t,0),o=r<n.childNodes.length?n.childNodes[r]:null,i=r?n.childNodes[r-1]:null;if(fx&&o&&"false"==o.contentEditable)return gC(o);if(!(o&&"false"!=o.contentEditable||i&&"false"!=i.contentEditable)){if(o)return gC(o);if(i)return gC(i)}}function gC(e){return e.contentEditable="true",fx&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function vC(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function yC(e,t){if(t instanceof _k){let n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(wC(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else wC(e)}function wC(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function bC(e,t,n,r){return e.someProp("createSelectionBetween",r=>r(e,t,n))||Tk.between(t,n,r)}function kC(e){return!(e.editable&&!e.hasFocus())&&xC(e)}function xC(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(n){return!1}}function CC(e,t){let{$anchor:n,$head:r}=e.selection,o=t>0?n.max(r):n.min(r),i=o.parent.inlineContent?o.depth?e.doc.resolve(t>0?o.after():o.before()):null:o;return i&&xk.findFrom(i,t)}function SC(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function MC(e,t,n){let r=e.state.selection;if(!(r instanceof Tk)){if(r instanceof _k&&r.node.isInline)return SC(e,new Tk(t>0?r.$to:r.$from));{let n=CC(e.state,t);return!!n&&SC(e,n)}}if(n.indexOf("s")>-1){let{$head:n}=r,o=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let i=e.state.doc.resolve(n.pos+o.nodeSize*(t<0?-1:1));return SC(e,new Tk(r.$anchor,i))}if(!r.empty)return!1;if(e.endOfTextblock(t>0?"forward":"backward")){let n=CC(e.state,t);return!!(n&&n instanceof _k)&&SC(e,n)}if(!(gx&&n.indexOf("m")>-1)){let n,o=r.$head,i=o.textOffset?null:t<0?o.nodeBefore:o.nodeAfter;if(!i||i.isText)return!1;let a=t<0?o.pos-i.nodeSize:o.pos;return!!(i.isAtom||(n=e.docView.descAt(a))&&!n.contentDOM)&&(_k.isSelectable(i)?SC(e,new _k(t<0?e.state.doc.resolve(o.pos-i.nodeSize):o)):!!wx&&SC(e,new Tk(e.state.doc.resolve(t<0?a:a+i.nodeSize))))}}function TC(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function OC(e,t){let n=e.pmViewDesc;return n&&0==n.size&&(t<0||e.nextSibling||"BR"!=e.nodeName)}function _C(e,t){return t<0?function(e){let t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(!n)return;let o,i,a=!1;ux&&1==n.nodeType&&r<TC(n)&&OC(n.childNodes[r],-1)&&(a=!0);for(;;)if(r>0){if(1!=n.nodeType)break;{let e=n.childNodes[r-1];if(OC(e,-1))o=n,i=--r;else{if(3!=e.nodeType)break;n=e,r=n.nodeValue.length}}}else{if(NC(n))break;{let t=n.previousSibling;for(;t&&OC(t,-1);)o=n.parentNode,i=Uk(t),t=t.previousSibling;if(t)n=t,r=TC(n);else{if(n=n.parentNode,n==e.dom)break;r=0}}}a?EC(e,n,r):o&&EC(e,o,i)}(e):function(e){let t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(!n)return;let o,i,a=TC(n);for(;;)if(r<a){if(1!=n.nodeType)break;if(!OC(n.childNodes[r],1))break;o=n,i=++r}else{if(NC(n))break;{let t=n.nextSibling;for(;t&&OC(t,1);)o=t.parentNode,i=Uk(t)+1,t=t.nextSibling;if(t)n=t,r=0,a=TC(n);else{if(n=n.parentNode,n==e.dom)break;r=a=0}}}o&&EC(e,o,i)}(e)}function NC(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function EC(e,t,n){if(3!=t.nodeType){let e,r;(r=function(e,t){for(;e&&t==e.childNodes.length&&!Qk(e);)t=Uk(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let n=e.childNodes[t];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;e=n,t=0}}(t,n))?(t=r,n=0):(e=function(e,t){for(;e&&!t&&!Qk(e);)t=Uk(e),e=e.parentNode;for(;e&&t;){let n=e.childNodes[t-1];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;t=(e=n).childNodes.length}}(t,n))&&(t=e,n=e.nodeValue.length)}let r=e.domSelection();if(!r)return;if(ex(r)){let e=document.createRange();e.setEnd(t,n),e.setStart(t,n),r.removeAllRanges(),r.addRange(e)}else r.extend&&r.extend(t,n);e.domObserver.setCurSelection();let{state:o}=e;setTimeout(()=>{e.state==o&&hC(e)},50)}function DC(e,t){let n=e.state.doc.resolve(t);if(!px&&!vx&&n.parent.inlineContent){let r=e.coordsAtPos(t);if(t>n.start()){let n=e.coordsAtPos(t-1),o=(n.top+n.bottom)/2;if(o>r.top&&o<r.bottom&&Math.abs(n.left-r.left)>1)return n.left<r.left?"ltr":"rtl"}if(t<n.end()){let n=e.coordsAtPos(t+1),o=(n.top+n.bottom)/2;if(o>r.top&&o<r.bottom&&Math.abs(n.left-r.left)>1)return n.left>r.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(e.dom).direction?"rtl":"ltr"}function AC(e,t,n){let r=e.state.selection;if(r instanceof Tk&&!r.empty||n.indexOf("s")>-1)return!1;if(gx&&n.indexOf("m")>-1)return!1;let{$from:o,$to:i}=r;if(!o.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let n=CC(e.state,t);if(n&&n instanceof _k)return SC(e,n)}if(!o.parent.inlineContent){let n=t<0?o:i,a=r instanceof Ek?xk.near(n,t):xk.findFrom(n,t);return!!a&&SC(e,a)}return!1}function $C(e,t){if(!(e.state.selection instanceof Tk))return!0;let{$head:n,$anchor:r,empty:o}=e.state.selection;if(!n.sameParent(r))return!0;if(!o)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let i=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(i&&!i.isText){let r=e.state.tr;return t<0?r.delete(n.pos-i.nodeSize,n.pos):r.delete(n.pos,n.pos+i.nodeSize),e.dispatch(r),!0}return!1}function RC(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function LC(e,t){let n=t.keyCode,r=function(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);if(8==n||gx&&72==n&&"c"==r)return $C(e,-1)||_C(e,-1);if(46==n&&!t.shiftKey||gx&&68==n&&"c"==r)return $C(e,1)||_C(e,1);if(13==n||27==n)return!0;if(37==n||gx&&66==n&&"c"==r){let t=37==n?"ltr"==DC(e,e.state.selection.from)?-1:1:-1;return MC(e,t,r)||_C(e,t)}if(39==n||gx&&70==n&&"c"==r){let t=39==n?"ltr"==DC(e,e.state.selection.from)?1:-1:1;return MC(e,t,r)||_C(e,t)}return 38==n||gx&&80==n&&"c"==r?AC(e,-1,r)||_C(e,-1):40==n||gx&&78==n&&"c"==r?function(e){if(!fx||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(t&&1==t.nodeType&&0==n&&t.firstChild&&"false"==t.firstChild.contentEditable){let n=t.firstChild;RC(e,n,"true"),setTimeout(()=>RC(e,n,"false"),20)}return!1}(e)||AC(e,1,r)||_C(e,1):r==(gx?"m":"c")&&(66==n||73==n||89==n||90==n)}function IC(e,t){e.someProp("transformCopied",n=>{t=n(t,e)});let n=[],{content:r,openStart:o,openEnd:i}=t;for(;o>1&&i>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,i--;let e=r.firstChild;n.push(e.type.name,e.attrs!=e.type.defaultAttrs?e.attrs:null),r=e.content}let a=e.someProp("clipboardSerializer")||_b.fromSchema(e.state.schema),s=WC(),l=s.createElement("div");l.appendChild(a.serializeFragment(r,{document:s}));let c,u=l.firstChild,d=0;for(;u&&1==u.nodeType&&(c=HC[u.nodeName.toLowerCase()]);){for(let e=c.length-1;e>=0;e--){let t=s.createElement(c[e]);for(;l.firstChild;)t.appendChild(l.firstChild);l.appendChild(t),d++}u=l.firstChild}u&&1==u.nodeType&&u.setAttribute("data-pm-slice",`${o} ${i}${d?` -${d}`:""} ${JSON.stringify(n)}`);let p=e.someProp("clipboardTextSerializer",n=>n(t,e))||t.content.textBetween(0,t.content.size,"\n\n");return{dom:l,text:p,slice:t}}function PC(e,t,n,r,o){let i,a,s=o.parent.type.spec.code;if(!n&&!t)return null;let l=!!t&&(r||s||!n);if(l){if(e.someProp("transformPastedText",n=>{t=n(t,s||r,e)}),s)return a=new $w(Ow.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0),e.someProp("transformPasted",t=>{a=t(a,e,!0)}),a;let n=e.someProp("clipboardTextParser",n=>n(t,o,r,e));if(n)a=n;else{let n=o.marks(),{schema:r}=e.state,a=_b.fromSchema(r);i=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(e=>{let t=i.appendChild(document.createElement("p"));e&&t.appendChild(a.serializeNode(r.text(e,n)))})}}else e.someProp("transformPastedHTML",t=>{n=t(n,e)}),i=function(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let n,r=WC().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(e);(n=o&&HC[o[1].toLowerCase()])&&(e=n.map(e=>"<"+e+">").join("")+e+n.map(e=>"</"+e+">").reverse().join(""));if(r.innerHTML=function(e){let t=window.trustedTypes;if(!t)return e;KC||(KC=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:e=>e}));return KC.createHTML(e)}(e),n)for(let i=0;i<n.length;i++)r=r.querySelector(n[i])||r;return r}(n),wx&&function(e){let t=e.querySelectorAll(px?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<t.length;n++){let r=t[n];1==r.childNodes.length&&""==r.textContent&&r.parentNode&&r.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),r)}}(i);let c=i&&i.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let e=i.firstChild;for(;e&&1!=e.nodeType;)e=e.nextSibling;if(!e)break;i=e}if(!a){let t=e.someProp("clipboardParser")||e.someProp("domParser")||yb.fromSchema(e.state.schema);a=t.parseSlice(i,{preserveWhitespace:!(!l&&!u),context:o,ruleFromNode:e=>"BR"!=e.nodeName||e.nextSibling||!e.parentNode||zC.test(e.parentNode.nodeName)?null:{ignore:!0}})}if(u)a=function(e,t){if(!e.size)return e;let n,r=e.content.firstChild.type.schema;try{n=JSON.parse(t)}catch(Yo){return e}let{content:o,openStart:i,openEnd:a}=e;for(let s=n.length-2;s>=0;s-=2){let e=r.nodes[n[s]];if(!e||e.hasRequiredAttrs())break;o=Ow.from(e.create(n[s+1],o)),i++,a++}return new $w(o,i,a)}(qC(a,+u[1],+u[2]),u[4]);else if(a=$w.maxOpen(function(e,t){if(e.childCount<2)return e;for(let n=t.depth;n>=0;n--){let r,o=t.node(n).contentMatchAt(t.index(n)),i=[];if(e.forEach(e=>{if(!i)return;let t,n=o.findWrapping(e.type);if(!n)return i=null;if(t=i.length&&r.length&&FC(n,r,e,i[i.length-1],0))i[i.length-1]=t;else{i.length&&(i[i.length-1]=jC(i[i.length-1],r.length));let t=BC(e,n);i.push(t),o=o.matchType(t.type),r=n}}),i)return Ow.from(i)}return e}(a.content,o),!0),a.openStart||a.openEnd){let e=0,t=0;for(let n=a.content.firstChild;e<a.openStart&&!n.type.spec.isolating;e++,n=n.firstChild);for(let n=a.content.lastChild;t<a.openEnd&&!n.type.spec.isolating;t++,n=n.lastChild);a=qC(a,e,t)}return e.someProp("transformPasted",t=>{a=t(a,e,l)}),a}const zC=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function BC(e,t,n=0){for(let r=t.length-1;r>=n;r--)e=t[r].create(null,Ow.from(e));return e}function FC(e,t,n,r,o){if(o<e.length&&o<t.length&&e[o]==t[o]){let i=FC(e,t,n,r.lastChild,o+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(o==e.length-1?n.type:e[o+1]))return r.copy(r.content.append(Ow.from(BC(n,e,o+1))))}}function jC(e,t){if(0==t)return e;let n=e.content.replaceChild(e.childCount-1,jC(e.lastChild,t-1)),r=e.contentMatchAt(e.childCount).fillBefore(Ow.empty,!0);return e.copy(n.append(r))}function VC(e,t,n,r,o,i){let a=t<0?e.firstChild:e.lastChild,s=a.content;return e.childCount>1&&(i=0),o<r-1&&(s=VC(s,t,n,r,o+1,i)),o>=n&&(s=t<0?a.contentMatchAt(0).fillBefore(s,i<=o).append(s):s.append(a.contentMatchAt(a.childCount).fillBefore(Ow.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,a.copy(s))}function qC(e,t,n){return t<e.openStart&&(e=new $w(VC(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new $w(VC(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}const HC={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let UC=null;function WC(){return UC||(UC=document.implementation.createHTMLDocument("title"))}let KC=null;const YC={},JC={},GC={touchstart:!0,touchmove:!0};class XC{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function ZC(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function QC(e){e.someProp("handleDOMEvents",t=>{for(let n in t)e.input.eventHandlers[n]||e.dom.addEventListener(n,e.input.eventHandlers[n]=t=>eS(e,t))})}function eS(e,t){return e.someProp("handleDOMEvents",n=>{let r=n[t.type];return!!r&&(r(e,t)||t.defaultPrevented)})}function tS(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}function nS(e){return{left:e.clientX,top:e.clientY}}function rS(e,t,n,r,o){if(-1==r)return!1;let i=e.state.doc.resolve(r);for(let a=i.depth+1;a>0;a--)if(e.someProp(t,t=>a>i.depth?t(e,n,i.nodeAfter,i.before(a),o,!0):t(e,n,i.node(a),i.before(a),o,!1)))return!0;return!1}function oS(e,t,n){if(e.focused||e.focus(),e.state.selection.eq(t))return;let r=e.state.tr.setSelection(t);"pointer"==n&&r.setMeta("pointer",!0),e.dispatch(r)}function iS(e,t,n,r,o){return rS(e,"handleClickOn",t,n,r)||e.someProp("handleClick",n=>n(e,t,r))||(o?function(e,t){if(-1==t)return!1;let n,r,o=e.state.selection;o instanceof _k&&(n=o.node);let i=e.state.doc.resolve(t);for(let a=i.depth+1;a>0;a--){let e=a>i.depth?i.nodeAfter:i.node(a);if(_k.isSelectable(e)){r=n&&o.$from.depth>0&&a>=o.$from.depth&&i.before(o.$from.depth+1)==o.$from.pos?i.before(o.$from.depth):i.before(a);break}}return null!=r&&(oS(e,_k.create(e.state.doc,r),"pointer"),!0)}(e,n):function(e,t){if(-1==t)return!1;let n=e.state.doc.resolve(t),r=n.nodeAfter;return!!(r&&r.isAtom&&_k.isSelectable(r))&&(oS(e,new _k(n),"pointer"),!0)}(e,n))}function aS(e,t,n,r){return rS(e,"handleDoubleClickOn",t,n,r)||e.someProp("handleDoubleClick",n=>n(e,t,r))}function sS(e,t,n,r){return rS(e,"handleTripleClickOn",t,n,r)||e.someProp("handleTripleClick",n=>n(e,t,r))||function(e,t,n){if(0!=n.button)return!1;let r=e.state.doc;if(-1==t)return!!r.inlineContent&&(oS(e,Tk.create(r,0,r.content.size),"pointer"),!0);let o=r.resolve(t);for(let i=o.depth+1;i>0;i--){let t=i>o.depth?o.nodeAfter:o.node(i),n=o.before(i);if(t.inlineContent)oS(e,Tk.create(r,n+1,n+1+t.content.size),"pointer");else{if(!_k.isSelectable(t))continue;oS(e,_k.create(r,n),"pointer")}return!0}}(e,n,r)}function lS(e){return gS(e)}JC.keydown=(e,t)=>{let n=t;if(e.input.shiftKey=16==n.keyCode||n.shiftKey,!dS(e,n)&&(e.input.lastKeyCode=n.keyCode,e.input.lastKeyCodeTime=Date.now(),!yx||!px||13!=n.keyCode))if(229!=n.keyCode&&e.domObserver.forceFlush(),!mx||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)e.someProp("handleKeyDown",t=>t(e,n))||LC(e,n)?n.preventDefault():ZC(e,"key");else{let t=Date.now();e.input.lastIOSEnter=t,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==t&&(e.someProp("handleKeyDown",t=>t(e,tx(13,"Enter"))),e.input.lastIOSEnter=0)},200)}},JC.keyup=(e,t)=>{16==t.keyCode&&(e.input.shiftKey=!1)},JC.keypress=(e,t)=>{let n=t;if(dS(e,n)||!n.charCode||n.ctrlKey&&!n.altKey||gx&&n.metaKey)return;if(e.someProp("handleKeyPress",t=>t(e,n)))return void n.preventDefault();let r=e.state.selection;if(!(r instanceof Tk&&r.$from.sameParent(r.$to))){let t=String.fromCharCode(n.charCode),o=()=>e.state.tr.insertText(t).scrollIntoView();/[\r\n]/.test(t)||e.someProp("handleTextInput",n=>n(e,r.$from.pos,r.$to.pos,t,o))||e.dispatch(o()),n.preventDefault()}};const cS=gx?"metaKey":"ctrlKey";YC.mousedown=(e,t)=>{let n=t;e.input.shiftKey=n.shiftKey;let r=lS(e),o=Date.now(),i="singleClick";o-e.input.lastClick.time<500&&function(e,t){let n=t.x-e.clientX,r=t.y-e.clientY;return n*n+r*r<100}(n,e.input.lastClick)&&!n[cS]&&e.input.lastClick.button==n.button&&("singleClick"==e.input.lastClick.type?i="doubleClick":"doubleClick"==e.input.lastClick.type&&(i="tripleClick")),e.input.lastClick={time:o,x:n.clientX,y:n.clientY,type:i,button:n.button};let a=e.posAtCoords(nS(n));a&&("singleClick"==i?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new uS(e,a,n,!!r)):("doubleClick"==i?aS:sS)(e,a.pos,a.inside,n)?n.preventDefault():ZC(e,"pointer"))};class uS{constructor(e,t,n,r){let o,i;if(this.view=e,this.pos=t,this.event=n,this.flushed=r,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[cS],this.allowDefault=n.shiftKey,t.inside>-1)o=e.state.doc.nodeAt(t.inside),i=t.inside;else{let n=e.state.doc.resolve(t.pos);o=n.parent,i=n.depth?n.before():0}const a=r?null:n.target,s=a?e.docView.nearestDesc(a,!0):null;this.target=s&&1==s.nodeDOM.nodeType?s.nodeDOM:null;let{selection:l}=e.state;(0==n.button&&o.type.spec.draggable&&!1!==o.type.spec.selectable||l instanceof _k&&l.from<=i&&l.to>i)&&(this.mightDrag={node:o,pos:i,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!ux||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),ZC(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>hC(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(nS(e))),this.updateAllowDefault(e),this.allowDefault||!t?ZC(this.view,"pointer"):iS(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():0==e.button&&(this.flushed||fx&&this.mightDrag&&!this.mightDrag.node.isAtom||px&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(oS(this.view,xk.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):ZC(this.view,"pointer")}move(e){this.updateAllowDefault(e),ZC(this.view,"pointer"),0==e.buttons&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}function dS(e,t){return!!e.composing||!!(fx&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500)&&(e.input.compositionEndedAt=-2e8,!0)}YC.touchstart=e=>{e.input.lastTouch=Date.now(),lS(e),ZC(e,"pointer")},YC.touchmove=e=>{e.input.lastTouch=Date.now(),ZC(e,"pointer")},YC.contextmenu=e=>lS(e);const pS=yx?5e3:-1;function hS(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>gS(e),t))}function fS(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=function(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function mS(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let n=function(e,t){for(;;){if(3==e.nodeType&&t)return e;if(1==e.nodeType&&t>0){if("false"==e.contentEditable)return null;t=Zk(e=e.childNodes[t-1])}else{if(!e.parentNode||Qk(e))return null;t=Uk(e),e=e.parentNode}}}(t.focusNode,t.focusOffset),r=function(e,t){for(;;){if(3==e.nodeType&&t<e.nodeValue.length)return e;if(1==e.nodeType&&t<e.childNodes.length){if("false"==e.contentEditable)return null;e=e.childNodes[t],t=0}else{if(!e.parentNode||Qk(e))return null;t=Uk(e)+1,e=e.parentNode}}}(t.focusNode,t.focusOffset);if(n&&r&&n!=r){let t=r.pmViewDesc,o=e.domObserver.lastChangedTextNode;if(n==o||r==o)return o;if(!t||!t.isText(r.nodeValue))return r;if(e.input.compositionNode==r){let e=n.pmViewDesc;if(e&&e.isText(n.nodeValue))return r}}return n||r}function gS(e,t=!1){if(!(yx&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),fS(e),t||e.docView&&e.docView.dirty){let n=dC(e),r=e.state.selection;return n&&!n.eq(r)?e.dispatch(e.state.tr.setSelection(n)):!e.markCursor&&!t||r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?e.updateState(e.state):e.dispatch(e.state.tr.deleteSelection()),!0}return!1}}JC.compositionstart=JC.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,n=t.selection.$to;if(t.selection instanceof Tk&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(e=>!1===e.type.spec.inclusive)))e.markCursor=e.state.storedMarks||n.marks(),gS(e,!0),e.markCursor=null;else if(gS(e,!t.selection.empty),ux&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let t=e.domSelectionRange();for(let n=t.focusNode,r=t.focusOffset;n&&1==n.nodeType&&0!=r;){let t=r<0?n.lastChild:n.childNodes[r-1];if(!t)break;if(3==t.nodeType){let n=e.domSelection();n&&n.collapse(t,t.nodeValue.length);break}n=t,r=-1}}e.input.composing=!0}hS(e,pS)},JC.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,hS(e,20))};const vS=lx&&cx<15||mx&&bx<604;function yS(e,t,n,r,o){let i=PC(e,t,n,r,e.state.selection.$from);if(e.someProp("handlePaste",t=>t(e,o,i||$w.empty)))return!0;if(!i)return!1;let a=function(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(i),s=a?e.state.tr.replaceSelectionWith(a,r):e.state.tr.replaceSelection(i);return e.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function wS(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let n=e.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}YC.copy=JC.cut=(e,t)=>{let n=t,r=e.state.selection,o="cut"==n.type;if(r.empty)return;let i=vS?null:n.clipboardData,a=r.content(),{dom:s,text:l}=IC(e,a);i?(n.preventDefault(),i.clearData(),i.setData("text/html",s.innerHTML),i.setData("text/plain",l)):function(e,t){if(!e.dom.parentNode)return;let n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),o=document.createRange();o.selectNodeContents(t),e.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),e.focus()},50)}(e,s),o&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},JC.paste=(e,t)=>{let n=t;if(e.composing&&!yx)return;let r=vS?null:n.clipboardData,o=e.input.shiftKey&&45!=e.input.lastKeyCode;r&&yS(e,wS(r),r.getData("text/html"),o,n)?n.preventDefault():function(e,t){if(!e.dom.parentNode)return;let n=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,r=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let o=e.input.shiftKey&&45!=e.input.lastKeyCode;setTimeout(()=>{e.focus(),r.parentNode&&r.parentNode.removeChild(r),n?yS(e,r.value,null,o,t):yS(e,r.textContent,r.innerHTML,o,t)},50)}(e,n)};class bS{constructor(e,t,n){this.slice=e,this.move=t,this.node=n}}const kS=gx?"altKey":"ctrlKey";function xS(e,t){let n=e.someProp("dragCopies",e=>!e(t));return null!=n?n:!t[kS]}YC.dragstart=(e,t)=>{let n=t,r=e.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let o,i=e.state.selection,a=i.empty?null:e.posAtCoords(nS(n));if(a&&a.pos>=i.from&&a.pos<=(i instanceof _k?i.to-1:i.to));else if(r&&r.mightDrag)o=_k.create(e.state.doc,r.mightDrag.pos);else if(n.target&&1==n.target.nodeType){let t=e.docView.nearestDesc(n.target,!0);t&&t.node.type.spec.draggable&&t!=e.docView&&(o=_k.create(e.state.doc,t.posBefore))}let s=(o||e.state.selection).content(),{dom:l,text:c,slice:u}=IC(e,s);(!n.dataTransfer.files.length||!px||hx>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(vS?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",vS||n.dataTransfer.setData("text/plain",c),e.dragging=new bS(u,xS(e,n),o)},YC.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)},JC.dragover=JC.dragenter=(e,t)=>t.preventDefault(),JC.drop=(e,t)=>{let n=t,r=e.dragging;if(e.dragging=null,!n.dataTransfer)return;let o=e.posAtCoords(nS(n));if(!o)return;let i=e.state.doc.resolve(o.pos),a=r&&r.slice;a?e.someProp("transformPasted",t=>{a=t(a,e,!1)}):a=PC(e,wS(n.dataTransfer),vS?null:n.dataTransfer.getData("text/html"),!1,i);let s=!(!r||!xS(e,n));if(e.someProp("handleDrop",t=>t(e,n,a||$w.empty,s)))return void n.preventDefault();if(!a)return;n.preventDefault();let l=a?function(e,t,n){let r=e.resolve(t);if(!n.content.size)return t;let o=n.content;for(let i=0;i<n.openStart;i++)o=o.firstChild.content;for(let i=1;i<=(0==n.openStart&&n.size?2:1);i++)for(let e=r.depth;e>=0;e--){let t=e==r.depth?0:r.pos<=(r.start(e+1)+r.end(e+1))/2?-1:1,n=r.index(e)+(t>0?1:0),a=r.node(e),s=!1;if(1==i)s=a.canReplace(n,n,o);else{let e=a.contentMatchAt(n).findWrapping(o.firstChild.type);s=e&&a.canReplaceWith(n,n,e[0])}if(s)return 0==t?r.pos:t<0?r.before(e+1):r.after(e+1)}return null}(e.state.doc,i.pos,a):i.pos;null==l&&(l=i.pos);let c=e.state.tr;if(s){let{node:e}=r;e?e.replace(c):c.deleteSelection()}let u=c.mapping.map(l),d=0==a.openStart&&0==a.openEnd&&1==a.content.childCount,p=c.doc;if(d?c.replaceRangeWith(u,u,a.content.firstChild):c.replaceRange(u,u,a),c.doc.eq(p))return;let h=c.doc.resolve(u);if(d&&_k.isSelectable(a.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(a.content.firstChild))c.setSelection(new _k(h));else{let t=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((e,n,r,o)=>t=o),c.setSelection(bC(e,h,c.doc.resolve(t)))}e.focus(),e.dispatch(c.setMeta("uiEvent","drop"))},YC.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&hC(e)},20))},YC.blur=(e,t)=>{let n=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),n.relatedTarget&&e.dom.contains(n.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)},YC.beforeinput=(e,t)=>{if(px&&yx&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();let{domChangeCount:t}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=t)return;if(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",t=>t(e,tx(8,"Backspace"))))return;let{$cursor:n}=e.state.selection;n&&n.pos>0&&e.dispatch(e.state.tr.delete(n.pos-1,n.pos).scrollIntoView())},50)}};for(let e in JC)YC[e]=JC[e];function CS(e,t){if(e==t)return!0;for(let n in e)if(e[n]!==t[n])return!1;for(let n in t)if(!(n in e))return!1;return!0}class SS{constructor(e,t){this.toDOM=e,this.spec=t||NS,this.side=this.spec.side||0}map(e,t,n,r){let{pos:o,deleted:i}=e.mapResult(t.from+r,this.side<0?-1:1);return i?null:new OS(o-n,o-n,this)}valid(){return!0}eq(e){return this==e||e instanceof SS&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&CS(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class MS{constructor(e,t){this.attrs=e,this.spec=t||NS}map(e,t,n,r){let o=e.map(t.from+r,this.spec.inclusiveStart?-1:1)-n,i=e.map(t.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new OS(o,i,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof MS&&CS(this.attrs,e.attrs)&&CS(this.spec,e.spec)}static is(e){return e.type instanceof MS}destroy(){}}class TS{constructor(e,t){this.attrs=e,this.spec=t||NS}map(e,t,n,r){let o=e.mapResult(t.from+r,1);if(o.deleted)return null;let i=e.mapResult(t.to+r,-1);return i.deleted||i.pos<=o.pos?null:new OS(o.pos-n,i.pos-n,this)}valid(e,t){let n,{index:r,offset:o}=e.content.findIndex(t.from);return o==t.from&&!(n=e.child(r)).isText&&o+n.nodeSize==t.to}eq(e){return this==e||e instanceof TS&&CS(this.attrs,e.attrs)&&CS(this.spec,e.spec)}destroy(){}}class OS{constructor(e,t,n){this.from=e,this.to=t,this.type=n}copy(e,t){return new OS(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,n){return this.type.map(e,this,t,n)}static widget(e,t,n){return new OS(e,e,new SS(t,n))}static inline(e,t,n,r){return new OS(e,t,new MS(n,r))}static node(e,t,n,r){return new OS(e,t,new TS(n,r))}get spec(){return this.type.spec}get inline(){return this.type instanceof MS}get widget(){return this.type instanceof SS}}const _S=[],NS={};class ES{constructor(e,t){this.local=e.length?e:_S,this.children=t.length?t:_S}static create(e,t){return t.length?IS(t,e,0,NS):DS}find(e,t,n){let r=[];return this.findInner(null==e?0:e,null==t?1e9:t,r,0,n),r}findInner(e,t,n,r,o){for(let i=0;i<this.local.length;i++){let a=this.local[i];a.from<=t&&a.to>=e&&(!o||o(a.spec))&&n.push(a.copy(a.from+r,a.to+r))}for(let i=0;i<this.children.length;i+=3)if(this.children[i]<t&&this.children[i+1]>e){let a=this.children[i]+1;this.children[i+2].findInner(e-a,t-a,n,r+a,o)}}map(e,t,n){return this==DS||0==e.maps.length?this:this.mapInner(e,t,0,0,n||NS)}mapInner(e,t,n,r,o){let i;for(let a=0;a<this.local.length;a++){let s=this.local[a].map(e,n,r);s&&s.type.valid(t,s)?(i||(i=[])).push(s):o.onRemove&&o.onRemove(this.local[a].spec)}return this.children.length?function(e,t,n,r,o,i,a){let s=e.slice();for(let c=0,u=i;c<n.maps.length;c++){let e=0;n.maps[c].forEach((t,n,r,o)=>{let i=o-r-(n-t);for(let a=0;a<s.length;a+=3){let r=s[a+1];if(r<0||t>r+u-e)continue;let o=s[a]+u-e;n>=o?s[a+1]=t<=o?-2:-1:t>=u&&i&&(s[a]+=i,s[a+1]+=i)}e+=i}),u=n.maps[c].map(u,-1)}let l=!1;for(let c=0;c<s.length;c+=3)if(s[c+1]<0){if(-2==s[c+1]){l=!0,s[c+1]=-1;continue}let t=n.map(e[c]+i),u=t-o;if(u<0||u>=r.content.size){l=!0;continue}let d=n.map(e[c+1]+i,-1)-o,{index:p,offset:h}=r.content.findIndex(u),f=r.maybeChild(p);if(f&&h==u&&h+f.nodeSize==d){let r=s[c+2].mapInner(n,f,t+1,e[c]+i+1,a);r!=DS?(s[c]=u,s[c+1]=d,s[c+2]=r):(s[c+1]=-2,l=!0)}else l=!0}if(l){let l=function(e,t,n,r,o,i,a){function s(e,t){for(let i=0;i<e.local.length;i++){let s=e.local[i].map(r,o,t);s?n.push(s):a.onRemove&&a.onRemove(e.local[i].spec)}for(let n=0;n<e.children.length;n+=3)s(e.children[n+2],e.children[n]+t+1)}for(let l=0;l<e.length;l+=3)-1==e[l+1]&&s(e[l+2],t[l]+i+1);return n}(s,e,t,n,o,i,a),c=IS(l,r,0,a);t=c.local;for(let e=0;e<s.length;e+=3)s[e+1]<0&&(s.splice(e,3),e-=3);for(let e=0,t=0;e<c.children.length;e+=3){let n=c.children[e];for(;t<s.length&&s[t]<n;)t+=3;s.splice(t,0,c.children[e],c.children[e+1],c.children[e+2])}}return new ES(t.sort(PS),s)}(this.children,i||[],e,t,n,r,o):i?new ES(i.sort(PS),_S):DS}add(e,t){return t.length?this==DS?ES.create(e,t):this.addInner(e,t,0):this}addInner(e,t,n){let r,o=0;e.forEach((e,i)=>{let a,s=i+n;if(a=RS(t,e,s)){for(r||(r=this.children.slice());o<r.length&&r[o]<i;)o+=3;r[o]==i?r[o+2]=r[o+2].addInner(e,a,s+1):r.splice(o,0,i,i+e.nodeSize,IS(a,e,s+1,NS)),o+=3}});let i=$S(o?LS(t):t,-n);for(let a=0;a<i.length;a++)i[a].type.valid(e,i[a])||i.splice(a--,1);return new ES(i.length?this.local.concat(i).sort(PS):this.local,r||this.children)}remove(e){return 0==e.length||this==DS?this:this.removeInner(e,0)}removeInner(e,t){let n=this.children,r=this.local;for(let o=0;o<n.length;o+=3){let r,i=n[o]+t,a=n[o+1]+t;for(let t,n=0;n<e.length;n++)(t=e[n])&&t.from>i&&t.to<a&&(e[n]=null,(r||(r=[])).push(t));if(!r)continue;n==this.children&&(n=this.children.slice());let s=n[o+2].removeInner(r,i+1);s!=DS?n[o+2]=s:(n.splice(o,3),o-=3)}if(r.length)for(let o,i=0;i<e.length;i++)if(o=e[i])for(let e=0;e<r.length;e++)r[e].eq(o,t)&&(r==this.local&&(r=this.local.slice()),r.splice(e--,1));return n==this.children&&r==this.local?this:r.length||n.length?new ES(r,n):DS}forChild(e,t){if(this==DS)return this;if(t.isLeaf)return ES.empty;let n,r;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(n=this.children[a+2]);break}let o=e+1,i=o+t.content.size;for(let a=0;a<this.local.length;a++){let e=this.local[a];if(e.from<i&&e.to>o&&e.type instanceof MS){let t=Math.max(o,e.from)-o,n=Math.min(i,e.to)-o;t<n&&(r||(r=[])).push(e.copy(t,n))}}if(r){let e=new ES(r.sort(PS),_S);return n?new AS([e,n]):e}return n||DS}eq(e){if(this==e)return!0;if(!(e instanceof ES)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return zS(this.localsInner(e))}localsInner(e){if(this==DS)return _S;if(e.inlineContent||!this.local.some(MS.is))return this.local;let t=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof MS||t.push(this.local[n]);return t}forEachSet(e){e(this)}}ES.empty=new ES([],[]),ES.removeOverlap=zS;const DS=ES.empty;class AS{constructor(e){this.members=e}map(e,t){const n=this.members.map(n=>n.map(e,t,NS));return AS.from(n)}forChild(e,t){if(t.isLeaf)return ES.empty;let n=[];for(let r=0;r<this.members.length;r++){let o=this.members[r].forChild(e,t);o!=DS&&(o instanceof AS?n=n.concat(o.members):n.push(o))}return AS.from(n)}eq(e){if(!(e instanceof AS)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,n=!0;for(let r=0;r<this.members.length;r++){let o=this.members[r].localsInner(e);if(o.length)if(t){n&&(t=t.slice(),n=!1);for(let e=0;e<o.length;e++)t.push(o[e])}else t=o}return t?zS(n?t:t.sort(PS)):_S}static from(e){switch(e.length){case 0:return DS;case 1:return e[0];default:return new AS(e.every(e=>e instanceof ES)?e:e.reduce((e,t)=>e.concat(t instanceof ES?t:t.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function $S(e,t){if(!t||!e.length)return e;let n=[];for(let r=0;r<e.length;r++){let o=e[r];n.push(new OS(o.from+t,o.to+t,o.type))}return n}function RS(e,t,n){if(t.isLeaf)return null;let r=n+t.nodeSize,o=null;for(let i,a=0;a<e.length;a++)(i=e[a])&&i.from>n&&i.to<r&&((o||(o=[])).push(i),e[a]=null);return o}function LS(e){let t=[];for(let n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function IS(e,t,n,r){let o=[],i=!1;t.forEach((t,a)=>{let s=RS(e,t,a+n);if(s){i=!0;let e=IS(s,t,n+a+1,r);e!=DS&&o.push(a,a+t.nodeSize,e)}});let a=$S(i?LS(e):e,-n).sort(PS);for(let s=0;s<a.length;s++)a[s].type.valid(t,a[s])||(r.onRemove&&r.onRemove(a[s].spec),a.splice(s--,1));return a.length||o.length?new ES(a,o):DS}function PS(e,t){return e.from-t.from||e.to-t.to}function zS(e){let t=e;for(let n=0;n<t.length-1;n++){let r=t[n];if(r.from!=r.to)for(let o=n+1;o<t.length;o++){let i=t[o];if(i.from!=r.from){i.from<r.to&&(t==e&&(t=e.slice()),t[n]=r.copy(r.from,i.from),BS(t,o,r.copy(i.from,r.to)));break}i.to!=r.to&&(t==e&&(t=e.slice()),t[o]=i.copy(i.from,r.to),BS(t,o+1,i.copy(r.to,i.to)))}}return t}function BS(e,t,n){for(;t<e.length&&PS(n,e[t])>0;)t++;e.splice(t,0,n)}function FS(e){let t=[];return e.someProp("decorations",n=>{let r=n(e.state);r&&r!=DS&&t.push(r)}),e.cursorWrapper&&t.push(ES.create(e.state.doc,[e.cursorWrapper.deco])),AS.from(t)}const jS={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},VS=lx&&cx<=11;class qS{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class HS{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new qS,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(e=>{for(let t=0;t<e.length;t++)this.queue.push(e[t]);lx&&cx<=11&&e.some(e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length)?this.flushSoon():this.flush()}),VS&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,jS)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(kC(this.view)){if(this.suppressingSelectionUpdates)return hC(this.view);if(lx&&cx<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Jk(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t,n=new Set;for(let o=e.focusNode;o;o=Wk(o))n.add(o);for(let o=e.anchorNode;o;o=Wk(o))if(n.has(o)){t=o;break}let r=t&&this.view.docView.nearestDesc(t);return r&&r.ignoreMutation({type:"selection",target:3==t.nodeType?t.parentNode:t})?(this.setCurSelection(),!0):void 0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let n=e.domSelectionRange(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&kC(e)&&!this.ignoreSelectionChange(n),o=-1,i=-1,a=!1,s=[];if(e.editable)for(let c=0;c<t.length;c++){let e=this.registerMutation(t[c],s);e&&(o=o<0?e.from:Math.min(e.from,o),i=i<0?e.to:Math.max(e.to,i),e.typeOver&&(a=!0))}if(ux&&s.length){let t=s.filter(e=>"BR"==e.nodeName);if(2==t.length){let[e,n]=t;e.parentNode&&e.parentNode.parentNode==n.parentNode?n.remove():e.remove()}else{let{focusNode:n}=this.currentSelection;for(let r of t){let t=r.parentNode;!t||"LI"!=t.nodeName||n&&YS(e,n)==t||r.remove()}}}let l=null;o<0&&r&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&ex(n)&&(l=dC(e))&&l.eq(xk.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,hC(e),this.currentSelection.set(n),e.scrollToSelection()):(o>-1||r)&&(o>-1&&(e.docView.markDirty(o,i),function(e){if(US.has(e))return;if(US.set(e,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)){if(e.requiresGeckoHackNode=ux,WS)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),WS=!0}}(e)),this.handleDOMChange(o,i,a,s),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||hC(e),this.currentSelection.set(n))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(n==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(e))return null;if("childList"==e.type){for(let n=0;n<e.addedNodes.length;n++){let r=e.addedNodes[n];t.push(r),3==r.nodeType&&(this.lastChangedTextNode=r)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let r=e.previousSibling,o=e.nextSibling;if(lx&&cx<=11&&e.addedNodes.length)for(let t=0;t<e.addedNodes.length;t++){let{previousSibling:n,nextSibling:i}=e.addedNodes[t];(!n||Array.prototype.indexOf.call(e.addedNodes,n)<0)&&(r=n),(!i||Array.prototype.indexOf.call(e.addedNodes,i)<0)&&(o=i)}let i=r&&r.parentNode==e.target?Uk(r)+1:0,a=n.localPosFromDOM(e.target,i,-1),s=o&&o.parentNode==e.target?Uk(o):e.target.childNodes.length;return{from:a,to:n.localPosFromDOM(e.target,s,1)}}return"attributes"==e.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let US=new WeakMap,WS=!1;function KS(e,t){let n=t.startContainer,r=t.startOffset,o=t.endContainer,i=t.endOffset,a=e.domAtPos(e.state.selection.anchor);return Jk(a.node,a.offset,o,i)&&([n,r,o,i]=[o,i,n,r]),{anchorNode:n,anchorOffset:r,focusNode:o,focusOffset:i}}function YS(e,t){for(let n=t.parentNode;n&&n!=e.dom;n=n.parentNode){let t=e.docView.nearestDesc(n,!0);if(t&&t.node.isBlock)return n}return null}function JS(e){let t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(fx&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(e.parentNode.lastChild==e||fx&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}const GS=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function XS(e,t,n,r,o){let i=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let t=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,n=dC(e,t);if(n&&!e.state.selection.eq(n)){if(px&&yx&&13===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",t=>t(e,tx(13,"Enter"))))return;let r=e.state.tr.setSelection(n);"pointer"==t?r.setMeta("pointer",!0):"key"==t&&r.scrollIntoView(),i&&r.setMeta("composition",i),e.dispatch(r)}return}let a=e.state.doc.resolve(t),s=a.sharedDepth(n);t=a.before(s+1),n=e.state.doc.resolve(n).after(s+1);let l,c,u=e.state.selection,d=function(e,t,n){let r,{node:o,fromOffset:i,toOffset:a,from:s,to:l}=e.docView.parseRange(t,n),c=e.domSelectionRange(),u=c.anchorNode;if(u&&e.dom.contains(1==u.nodeType?u:u.parentNode)&&(r=[{node:u,offset:c.anchorOffset}],ex(c)||r.push({node:c.focusNode,offset:c.focusOffset})),px&&8===e.input.lastKeyCode)for(let g=a;g>i;g--){let e=o.childNodes[g-1],t=e.pmViewDesc;if("BR"==e.nodeName&&!t){a=g;break}if(!t||t.size)break}let d=e.state.doc,p=e.someProp("domParser")||yb.fromSchema(e.state.schema),h=d.resolve(s),f=null,m=p.parse(o,{topNode:h.parent,topMatch:h.parent.contentMatchAt(h.index()),topOpen:!0,from:i,to:a,preserveWhitespace:"pre"!=h.parent.type.whitespace||"full",findPositions:r,ruleFromNode:JS,context:h});if(r&&null!=r[0].pos){let e=r[0].pos,t=r[1]&&r[1].pos;null==t&&(t=e),f={anchor:e+s,head:t+s}}return{doc:m,sel:f,from:s,to:l}}(e,t,n),p=e.state.doc,h=p.slice(d.from,d.to);8===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime?(l=e.state.selection.to,c="end"):(l=e.state.selection.from,c="start"),e.input.lastKeyCode=null;let f=function(e,t,n,r,o){let i=e.findDiffStart(t,n);if(null==i)return null;let{a:a,b:s}=e.findDiffEnd(t,n+e.size,n+t.size);if("end"==o){r-=a+Math.max(0,i-Math.min(a,s))-i}if(a<i&&e.size<t.size){let e=r<=i&&r>=a?i-r:0;i-=e,i&&i<t.size&&eM(t.textBetween(i-1,i+1))&&(i+=e?1:-1),s=i+(s-a),a=i}else if(s<i){let t=r<=i&&r>=s?i-r:0;i-=t,i&&i<e.size&&eM(e.textBetween(i-1,i+1))&&(i+=t?1:-1),a=i+(a-s),s=i}return{start:i,endA:a,endB:s}}(h.content,d.doc.content,d.from,l,c);if(f&&e.input.domChangeCount++,(mx&&e.input.lastIOSEnter>Date.now()-225||yx)&&o.some(e=>1==e.nodeType&&!GS.test(e.nodeName))&&(!f||f.endA>=f.endB)&&e.someProp("handleKeyDown",t=>t(e,tx(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(!f){if(!(r&&u instanceof Tk&&!u.empty&&u.$head.sameParent(u.$anchor))||e.composing||d.sel&&d.sel.anchor!=d.sel.head){if(d.sel){let t=ZS(e,e.state.doc,d.sel);if(t&&!t.eq(e.state.selection)){let n=e.state.tr.setSelection(t);i&&n.setMeta("composition",i),e.dispatch(n)}}return}f={start:u.from,endA:u.to,endB:u.to}}e.state.selection.from<e.state.selection.to&&f.start==f.endB&&e.state.selection instanceof Tk&&(f.start>e.state.selection.from&&f.start<=e.state.selection.from+2&&e.state.selection.from>=d.from?f.start=e.state.selection.from:f.endA<e.state.selection.to&&f.endA>=e.state.selection.to-2&&e.state.selection.to<=d.to&&(f.endB+=e.state.selection.to-f.endA,f.endA=e.state.selection.to)),lx&&cx<=11&&f.endB==f.start+1&&f.endA==f.start&&f.start>d.from&&" "==d.doc.textBetween(f.start-d.from-1,f.start-d.from+1)&&(f.start--,f.endA--,f.endB--);let m=d.doc.resolveNoCache(f.start-d.from),g=d.doc.resolveNoCache(f.endB-d.from),v=p.resolve(f.start),y=m.sameParent(g)&&m.parent.inlineContent&&v.end()>=f.endA;if((mx&&e.input.lastIOSEnter>Date.now()-225&&(!y||o.some(e=>"DIV"==e.nodeName||"P"==e.nodeName))||!y&&m.pos<d.doc.content.size&&(!m.sameParent(g)||!m.parent.inlineContent)&&m.pos<g.pos&&!/\S/.test(d.doc.textBetween(m.pos,g.pos,"","")))&&e.someProp("handleKeyDown",t=>t(e,tx(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(e.state.selection.anchor>f.start&&function(e,t,n,r,o){if(n-t<=o.pos-r.pos||QS(r,!0,!1)<o.pos)return!1;let i=e.resolve(t);if(!r.parent.isTextblock){let e=i.nodeAfter;return null!=e&&n==t+e.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let a=e.resolve(QS(i,!0,!0));return!(!a.parent.isTextblock||a.pos>n||QS(a,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(a.parent.content)}(p,f.start,f.endA,m,g)&&e.someProp("handleKeyDown",t=>t(e,tx(8,"Backspace"))))return void(yx&&px&&e.domObserver.suppressSelectionUpdates());px&&f.endB==f.start&&(e.input.lastChromeDelete=Date.now()),yx&&!y&&m.start()!=g.start()&&0==g.parentOffset&&m.depth==g.depth&&d.sel&&d.sel.anchor==d.sel.head&&d.sel.head==f.endA&&(f.endB-=2,g=d.doc.resolveNoCache(f.endB-d.from),setTimeout(()=>{e.someProp("handleKeyDown",function(t){return t(e,tx(13,"Enter"))})},20));let w,b=f.start,k=f.endA,x=t=>{let n=t||e.state.tr.replace(b,k,d.doc.slice(f.start-d.from,f.endB-d.from));if(d.sel){let t=ZS(e,n.doc,d.sel);t&&!(px&&e.composing&&t.empty&&(f.start!=f.endB||e.input.lastChromeDelete<Date.now()-100)&&(t.head==b||t.head==n.mapping.map(k)-1)||lx&&t.empty&&t.head==b)&&n.setSelection(t)}return i&&n.setMeta("composition",i),n.scrollIntoView()};if(y)if(m.pos==g.pos){lx&&cx<=11&&0==m.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>hC(e),20));let t=x(e.state.tr.delete(b,k)),n=p.resolve(f.start).marksAcross(p.resolve(f.endA));n&&t.ensureMarks(n),e.dispatch(t)}else if(f.endA==f.endB&&(w=function(e,t){let n,r,o,i=e.firstChild.marks,a=t.firstChild.marks,s=i,l=a;for(let u=0;u<a.length;u++)s=a[u].removeFromSet(s);for(let u=0;u<i.length;u++)l=i[u].removeFromSet(l);if(1==s.length&&0==l.length)r=s[0],n="add",o=e=>e.mark(r.addToSet(e.marks));else{if(0!=s.length||1!=l.length)return null;r=l[0],n="remove",o=e=>e.mark(r.removeFromSet(e.marks))}let c=[];for(let u=0;u<t.childCount;u++)c.push(o(t.child(u)));if(Ow.from(c).eq(e))return{mark:r,type:n}}(m.parent.content.cut(m.parentOffset,g.parentOffset),v.parent.content.cut(v.parentOffset,f.endA-v.start())))){let t=x(e.state.tr);"add"==w.type?t.addMark(b,k,w.mark):t.removeMark(b,k,w.mark),e.dispatch(t)}else if(m.parent.child(m.index()).isText&&m.index()==g.index()-(g.textOffset?0:1)){let t=m.parent.textBetween(m.parentOffset,g.parentOffset),n=()=>x(e.state.tr.insertText(t,b,k));e.someProp("handleTextInput",r=>r(e,b,k,t,n))||e.dispatch(n())}else e.dispatch(x());else e.dispatch(x())}function ZS(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:bC(e,t.resolve(n.anchor),t.resolve(n.head))}function QS(e,t,n){let r=e.depth,o=t?e.end():e.pos;for(;r>0&&(t||e.indexAfter(r)==e.node(r).childCount);)r--,o++,t=!1;if(n){let t=e.node(r).maybeChild(e.indexAfter(r));for(;t&&!t.isLeaf;)t=t.firstChild,o++}return o}function eM(e){if(2!=e.length)return!1;let t=e.charCodeAt(0),n=e.charCodeAt(1);return t>=56320&&t<=57343&&n>=55296&&n<=56319}class tM{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new XC,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(aM),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):"function"==typeof e?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=oM(this),rM(this),this.nodeViews=iM(this),this.docView=Jx(this.state.doc,nM(this),FS(this),this.dom,this),this.domObserver=new HS(this,(e,t,n,r)=>XS(this,e,t,n,r)),this.domObserver.start(),function(e){for(let t in YC){let n=YC[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=t=>{!tS(e,t)||eS(e,t)||!e.editable&&t.type in JC||n(e,t)},GC[t]?{passive:!0}:void 0)}fx&&e.dom.addEventListener("input",()=>null),QC(e)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&QC(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(aM),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let n in this._props)t[n]=this._props[n];t.state=this.state;for(let n in e)t[n]=e[n];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var n;let r=this.state,o=!1,i=!1;e.storedMarks&&this.composing&&(fS(this),i=!0),this.state=e;let a=r.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let e=iM(this);(function(e,t){let n=0,r=0;for(let o in e){if(e[o]!=t[o])return!0;n++}for(let o in t)r++;return n!=r})(e,this.nodeViews)&&(this.nodeViews=e,o=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&QC(this),this.editable=oM(this),rM(this);let s=FS(this),l=nM(this),c=r.plugins==e.plugins||r.doc.eq(e.doc)?e.scrollToSelection>r.scrollToSelection?"to selection":"preserve":"reset",u=o||!this.docView.matchesNode(e.doc,l,s);!u&&e.selection.eq(r.selection)||(i=!0);let d="preserve"==c&&i&&null==this.dom.style.overflowAnchor&&function(e){let t,n,r=e.dom.getBoundingClientRect(),o=Math.max(0,r.top);for(let i=(r.left+r.right)/2,a=o+1;a<Math.min(innerHeight,r.bottom);a+=5){let r=e.root.elementFromPoint(i,a);if(!r||r==e.dom||!e.dom.contains(r))continue;let s=r.getBoundingClientRect();if(s.top>=o-20){t=r,n=s.top;break}}return{refDOM:t,refTop:n,stack:Mx(e.dom)}}(this);if(i){this.domObserver.stop();let t=u&&(lx||px)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&function(e,t){let n=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(n)!=t.$anchor.start(n)}(r.selection,e.selection);if(u){let n=px?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=mS(this)),!o&&this.docView.update(e.doc,l,s,this)||(this.docView.updateOuterDeco(l),this.docView.destroy(),this.docView=Jx(e.doc,l,s,this.dom,this)),n&&!this.trackWrites&&(t=!0)}t||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),n=e.domSelectionRange();return Jk(t.node,t.offset,n.anchorNode,n.anchorOffset)}(this))?hC(this,t):(yC(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),(null===(n=this.dragging)||void 0===n?void 0:n.node)&&!r.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,r),"reset"==c?this.dom.scrollTop=0:"to selection"==c?this.scrollToSelection():d&&function({refDOM:e,refTop:t,stack:n}){let r=e?e.getBoundingClientRect().top:0;Tx(n,0==r?0:r-t)}(d)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(e&&this.dom.contains(1==e.nodeType?e:e.parentNode))if(this.someProp("handleScrollToSelection",e=>e(this)));else if(this.state.selection instanceof _k){let t=this.docView.domAfterPos(this.state.selection.from);1==t.nodeType&&Sx(this,t.getBoundingClientRect(),e)}else Sx(this,this.coordsAtPos(this.state.selection.head,1),e);else;}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let t=0;t<this.pluginViews.length;t++){let n=this.pluginViews[t];n.update&&n.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let t=this.directPlugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let t=this.state.plugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}}}updateDraggedNode(e,t){let n=e.node,r=-1;if(this.state.doc.nodeAt(n.from)==n.node)r=n.from;else{let e=n.from+(this.state.doc.content.size-t.doc.content.size);(e>0&&this.state.doc.nodeAt(e))==n.node&&(r=e)}this.dragging=new bS(e.slice,e.move,r<0?void 0:_k.create(this.state.doc,r))}someProp(e,t){let n,r=this._props&&this._props[e];if(null!=r&&(n=t?t(r):r))return n;for(let i=0;i<this.directPlugins.length;i++){let r=this.directPlugins[i].props[e];if(null!=r&&(n=t?t(r):r))return n}let o=this.state.plugins;if(o)for(let i=0;i<o.length;i++){let r=o[i].props[e];if(null!=r&&(n=t?t(r):r))return n}}hasFocus(){if(lx){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if("false"==e.contentEditable)return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(Ox)return e.focus(Ox);let t=Mx(e);e.focus(null==Ox?{get preventScroll(){return Ox={preventScroll:!0},!0}}:void 0),Ox||(Ox=!1,Tx(t,0))}(this.dom),hC(this),this.domObserver.start()}get root(){let e=this._root;if(null==e)for(let t=this.dom.parentNode;t;t=t.parentNode)if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t;return e||document}updateRoot(){this._root=null}posAtCoords(e){return Dx(this,e)}coordsAtPos(e,t=1){return Lx(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,n=-1){let r=this.docView.posFromDOM(e,t,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r}endOfTextblock(e,t){return qx(this,t||this.state,e)}pasteHTML(e,t){return yS(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return yS(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return IC(this,e)}destroy(){this.docView&&(!function(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],FS(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,Kk=null)}get isDestroyed(){return null==this.docView}dispatchEvent(e){return function(e,t){eS(e,t)||!YC[t.type]||!e.editable&&t.type in JC||YC[t.type](e,t)}(this,e)}domSelectionRange(){let e=this.domSelection();return e?fx&&11===this.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom&&function(e,t){if(t.getComposedRanges){let n=t.getComposedRanges(e.root)[0];if(n)return KS(e,n)}let n;function r(e){e.preventDefault(),e.stopImmediatePropagation(),n=e.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",r,!0),n?KS(e,n):null}(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function nM(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",n=>{if("function"==typeof n&&(n=n(e.state)),n)for(let e in n)"class"==e?t.class+=" "+n[e]:"style"==e?t.style=(t.style?t.style+";":"")+n[e]:t[e]||"contenteditable"==e||"nodeName"==e||(t[e]=String(n[e]))}),t.translate||(t.translate="no"),[OS.node(0,e.state.doc.content.size,t)]}function rM(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:OS.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function oM(e){return!e.someProp("editable",t=>!1===t(e.state))}function iM(e){let t=Object.create(null);function n(e){for(let n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])}return e.someProp("nodeViews",n),e.someProp("markViews",n),t}function aM(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}tM.prototype.dispatch=function(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))};var sM=Object.defineProperty,lM=(e,t,n)=>(((e,t,n)=>{t in e?sM(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const cM=Symbol("[ProsemirrorAdapter]nodeViewContext"),uM=Symbol("[ProsemirrorAdapter]useNodeViewFactory");class dM extends yw{constructor(){super(...arguments),lM(this,"key",Cw()),lM(this,"context",{contentRef:e=>{e&&e instanceof HTMLElement&&this.contentDOM&&e.firstChild!==this.contentDOM&&e.appendChild(this.contentDOM)},view:this.view,getPos:this.getPos,setAttrs:this.setAttrs,node:Ct(this.node),selected:Ct(this.selected),decorations:Ct(this.decorations),innerDecorations:Ct(this.innerDecorations)}),lM(this,"updateContext",()=>{Object.entries({node:this.node,selected:this.selected,decorations:this.decorations,innerDecorations:this.innerDecorations}).forEach(([e,t])=>{const n=this.context[e];n.value!==t&&(n.value=t)})}),lM(this,"render",()=>{const e=this.component;return nn(Ye({name:"ProsemirrorNodeView",setup:()=>(Et(cM,this.context),()=>ut(At,{key:this.key,to:this.dom},{default:()=>[ut(e,null,null)]}))}))})}}const pM=Symbol("[ProsemirrorAdapter]nodeViewContext"),hM=()=>Je(pM),fM=Symbol("[ProsemirrorAdapter]usePluginViewFactory"),mM=()=>Je(fM);class gM extends ww{constructor(){super(...arguments),lM(this,"key",Cw()),lM(this,"context",{view:Ct(this.view),prevState:Ct(this.prevState)}),lM(this,"updateContext",()=>{Object.entries({view:this.view,prevState:this.prevState}).forEach(([e,t])=>{const n=this.context[e];if("view"===e){const e=Object.assign(Object.create(Object.getPrototypeOf(t)),t);return void(n.value=e)}n.value=t})}),lM(this,"render",()=>{const e=this.component;return nn(Ye({name:"ProsemirrorNodeView",setup:()=>(Et(pM,this.context),()=>ut(At,{key:this.key,to:this.root},{default:()=>[ut(e,null,null)]}))}))})}}const vM=Symbol("[ProsemirrorAdapter]widgetViewContext"),yM=Symbol("[ProsemirrorAdapter]useWidgetViewFactory");class wM extends xw{constructor(){super(...arguments),lM(this,"key",Cw()),lM(this,"context",{view:this.view,getPos:this.getPos,spec:this.spec}),lM(this,"updateContext",()=>{Object.assign(this.context,{view:this.view,getPos:this.getPos,spec:this.spec})}),lM(this,"render",()=>{const e=this.component;return nn(Ye({name:"ProsemirrorWidgetView",setup:()=>(Et(vM,this.context),()=>ut(At,{key:this.key,to:this.dom},{default:()=>[ut(e,null,null)]}))}))})}}const bM=Ye({name:"ProsemirrorAdapterProvider",setup:(e,{slots:t})=>{const{portals:n,renderVueRenderer:r,removeVueRenderer:o}=(()=>{const e=ct({}),t=vt(),n=nn({});return Ht(()=>{n.updater=()=>{null==t||t.update()}}),Dt(()=>{n.updater=void 0}),{portals:e,renderVueRenderer:t=>{var r;e.value[t.key]=t.render(),null==(r=n.updater)||r.call(n)},removeVueRenderer:t=>{delete e.value[t.key]}}})(),i=((e,t)=>n=>(r,o,i,a,s)=>{const l=new dM({node:r,view:o,getPos:i,decorations:a,innerDecorations:s,options:M(M({},n),{},{onUpdate(){var e;null==(e=n.onUpdate)||e.call(n),l.updateContext()},selectNode(){var e;null==(e=n.selectNode)||e.call(n),l.updateContext()},deselectNode(){var e;null==(e=n.deselectNode)||e.call(n),l.updateContext()},destroy(){var e;null==(e=n.destroy)||e.call(n),t(l)}})});return e(l),l})(r,o),a=((e,t)=>n=>r=>{const o=new gM({view:r,options:M(M({},n),{},{update:(e,t)=>{var r;null==(r=n.update)||r.call(n,e,t),o.updateContext()},destroy:()=>{var e;null==(e=n.destroy)||e.call(n),t(o)}})});return e(o),o})(r,o),s=((e,t)=>n=>(r,o={})=>{const i=new wM({pos:r,options:n}),a=M(M({},o),{},{destroy:e=>{var n;null==(n=o.destroy)||n.call(o,e),t(i)}});return i.spec=a,OS.widget(r,(t,n)=>(i.bind(t,n),i.updateContext(),e(i),i.dom),a)})(r,o);return Et(uM,i),Et(fM,a),Et(yM,s),()=>{var e;return ut(Mt,null,[null==(e=t.default)?void 0:e.call(t),Object.values(n.value).map(e=>Nt(e))])}}});var kM=(e=>(e.docTypeError="docTypeError",e.contextNotFound="contextNotFound",e.timerNotFound="timerNotFound",e.ctxCallOutOfScope="ctxCallOutOfScope",e.createNodeInParserFail="createNodeInParserFail",e.stackOverFlow="stackOverFlow",e.parserMatchError="parserMatchError",e.serializerMatchError="serializerMatchError",e.getAtomFromSchemaFail="getAtomFromSchemaFail",e.expectDomTypeError="expectDomTypeError",e.callCommandBeforeEditorView="callCommandBeforeEditorView",e.missingRootElement="missingRootElement",e.missingNodeInSchema="missingNodeInSchema",e.missingMarkInSchema="missingMarkInSchema",e.ctxNotBind="ctxNotBind",e.missingYjsDoc="missingYjsDoc",e))(kM||{});class xM extends Error{constructor(e,t){super(t),this.name="MilkdownError",this.code=e}}const CM=(e,t)=>"function"==typeof t?"[Function]":t,SM=e=>JSON.stringify(e,CM);function MM(){return new xM(kM.ctxCallOutOfScope,"Should not call a context out of the plugin.")}function TM(){return new xM(kM.stackOverFlow,"Stack over flow, cannot pop on an empty stack.")}function OM(e){return new xM(kM.expectDomTypeError,`Expect to be a dom, but get: ${SM(e)}.`)}function _M(){return new xM(kM.callCommandBeforeEditorView,"You're trying to call a command before editor view initialized, make sure to get commandManager from ctx after editor view has been initialized")}class NM{constructor(){this.sliceMap=new Map,this.get=e=>{const t="string"==typeof e?[...this.sliceMap.values()].find(t=>t.type.name===e):this.sliceMap.get(e.id);if(!t){throw function(e){return new xM(kM.contextNotFound,`Context "${e}" not found, do you forget to inject it?`)}("string"==typeof e?e:e.name)}return t},this.remove=e=>{const t="string"==typeof e?[...this.sliceMap.values()].find(t=>t.type.name===e):this.sliceMap.get(e.id);t&&this.sliceMap.delete(t.type.id)},this.has=e=>"string"==typeof e?[...this.sliceMap.values()].some(t=>t.type.name===e):this.sliceMap.has(e.id)}}var EM=new WeakMap,DM=new WeakMap,AM=new WeakMap;class $M{constructor(e,t,n){v(this,EM,void 0),v(this,DM,void 0),v(this,AM,void 0),b(EM,this,[]),b(AM,this,()=>{w(EM,this).forEach(e=>e(w(DM,this)))}),this.set=e=>{b(DM,this,e),w(AM,this).call(this)},this.get=()=>w(DM,this),this.update=e=>{b(DM,this,e(w(DM,this))),w(AM,this).call(this)},this.type=n,b(DM,this,t),e.set(n.id,this)}on(e){return w(EM,this).push(e),()=>{b(EM,this,w(EM,this).filter(t=>t!==e))}}once(e){const t=this.on(n=>{e(n),t()});return t}off(e){b(EM,this,w(EM,this).filter(t=>t!==e))}offAll(){b(EM,this,[])}}class RM{constructor(e,t){this.id=Symbol(`Context-${t}`),this.name=t,this._defaultValue=e,this._typeInfo=()=>{throw MM()}}create(e,t=this._defaultValue){return new $M(e,t,this)}}const LM=(e,t)=>new RM(e,t);var IM=new WeakMap,PM=new WeakMap,zM=new WeakMap,BM=new WeakMap,FM=new WeakMap,jM=new WeakMap,VM=new WeakMap,qM=new WeakMap,HM=new WeakMap;class UM{constructor(e,t,n){v(this,IM,void 0),v(this,PM,void 0),v(this,zM,void 0),v(this,BM,void 0),v(this,FM,void 0),v(this,jM,void 0),v(this,VM,void 0),v(this,qM,void 0),v(this,HM,void 0),b(BM,this,new Set),b(FM,this,new Set),b(jM,this,new Map),b(VM,this,new Map),this.read=()=>({metadata:w(IM,this),injectedSlices:[...w(BM,this)].map(e=>({name:"string"==typeof e?e:e.name,value:w(qM,this).call(this,e)})),consumedSlices:[...w(FM,this)].map(e=>({name:"string"==typeof e?e:e.name,value:w(qM,this).call(this,e)})),recordedTimers:[...w(jM,this)].map(([e,{duration:t}])=>({name:e.name,duration:t,status:w(HM,this).call(this,e)})),waitTimers:[...w(VM,this)].map(([e,{duration:t}])=>({name:e.name,duration:t,status:w(HM,this).call(this,e)}))}),this.onRecord=e=>{w(jM,this).set(e,{start:Date.now(),duration:0})},this.onClear=e=>{w(jM,this).delete(e)},this.onDone=e=>{const t=w(jM,this).get(e);t&&(t.duration=Date.now()-t.start)},this.onWait=(e,t)=>{const n=Date.now();t.finally(()=>{w(VM,this).set(e,{duration:Date.now()-n})}).catch(console.error)},this.onInject=e=>{w(BM,this).add(e)},this.onRemove=e=>{w(BM,this).delete(e)},this.onUse=e=>{w(FM,this).add(e)},b(qM,this,e=>w(PM,this).get(e).get()),b(HM,this,e=>w(zM,this).get(e).status),b(PM,this,e),b(zM,this,t),b(IM,this,n)}}var WM=new WeakMap,KM=new WeakMap,YM=new WeakMap,JM=new WeakMap;class GM{constructor(e,t,n){v(this,WM,void 0),v(this,KM,void 0),v(this,YM,void 0),v(this,JM,void 0),this.produce=e=>e&&Object.keys(e).length?new GM(w(WM,this),w(KM,this),M({},e)):this,this.inject=(e,t)=>{var n;const r=e.create(w(WM,this).sliceMap);return null!=t&&r.set(t),null===(n=w(JM,this))||void 0===n||n.onInject(e),this},this.remove=e=>{var t;return w(WM,this).remove(e),null===(t=w(JM,this))||void 0===t||t.onRemove(e),this},this.record=e=>{var t;return e.create(w(KM,this).store),null===(t=w(JM,this))||void 0===t||t.onRecord(e),this},this.clearTimer=e=>{var t;return w(KM,this).remove(e),null===(t=w(JM,this))||void 0===t||t.onClear(e),this},this.isInjected=e=>w(WM,this).has(e),this.isRecorded=e=>w(KM,this).has(e),this.use=e=>{var t;return null===(t=w(JM,this))||void 0===t||t.onUse(e),w(WM,this).get(e)},this.get=e=>this.use(e).get(),this.set=(e,t)=>this.use(e).set(t),this.update=(e,t)=>this.use(e).update(t),this.timer=e=>w(KM,this).get(e),this.done=e=>{var t;this.timer(e).done(),null===(t=w(JM,this))||void 0===t||t.onDone(e)},this.wait=e=>{var t;const n=this.timer(e).start();return null===(t=w(JM,this))||void 0===t||t.onWait(e,n),n},this.waitTimers=async e=>{await Promise.all(this.get(e).map(e=>this.wait(e)))},b(WM,this,e),b(KM,this,t),b(YM,this,n),n&&b(JM,this,new UM(e,t,n))}get meta(){return w(YM,this)}get inspector(){return w(JM,this)}}class XM{constructor(){this.store=new Map,this.get=e=>{const t=this.store.get(e.id);if(!t)throw n=e.name,new xM(kM.timerNotFound,`Timer "${n}" not found, do you forget to record it?`);var n;return t},this.remove=e=>{this.store.delete(e.id)},this.has=e=>this.store.has(e.id)}}var ZM=new WeakMap,QM=new WeakMap,eT=new WeakMap,tT=new WeakMap,nT=new WeakMap,rT=new WeakMap;class oT{constructor(e,t){v(this,ZM,void 0),v(this,QM,void 0),v(this,eT,void 0),v(this,tT,void 0),v(this,nT,void 0),v(this,rT,void 0),b(ZM,this,null),b(QM,this,null),b(tT,this,"pending"),this.start=()=>{var e;return null!==(e=w(ZM,this))&&void 0!==e||b(ZM,this,new Promise((e,t)=>{b(QM,this,t=>{t instanceof CustomEvent&&t.detail.id===w(eT,this)&&(b(tT,this,"resolved"),w(nT,this).call(this),t.stopImmediatePropagation(),e())}),w(rT,this).call(this,()=>{"pending"===w(tT,this)&&b(tT,this,"rejected"),w(nT,this).call(this),t(new Error(`Timing ${this.type.name} timeout.`))}),b(tT,this,"pending"),addEventListener(this.type.name,w(QM,this))})),w(ZM,this)},this.done=()=>{const e=new CustomEvent(this.type.name,{detail:{id:w(eT,this)}});dispatchEvent(e)},b(nT,this,()=>{w(QM,this)&&removeEventListener(this.type.name,w(QM,this))}),b(rT,this,e=>{setTimeout(()=>{e()},this.type.timeout)}),b(eT,this,Symbol(t.name)),this.type=t,e.set(t.id,this)}get status(){return w(tT,this)}}class iT{constructor(e,t=3e3){this.create=e=>new oT(e,this),this.id=Symbol(`Timer-${e}`),this.name=e,this.timeout=t}}const aT=(e,t=3e3)=>new iT(e,t);var sT,lT,cT,uT,dT,pT,hT,fT,mT,gT,vT,yT,wT,bT,kT,xT,CT,ST,MT,TT,OT=e=>{throw TypeError(e)},_T=(e,t,n)=>t.has(e)||OT("Cannot "+n),NT=(e,t,n)=>(_T(e,t,"read from private field"),n?n.call(e):t.get(e)),ET=(e,t,n)=>t.has(e)?OT("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),DT=(e,t,n,r)=>(_T(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);class AT{}class $T{constructor(){this.elements=[],this.size=()=>this.elements.length,this.top=()=>this.elements.at(-1),this.push=e=>{var t;null===(t=this.top())||void 0===t||t.push(e)},this.open=e=>{this.elements.push(e)},this.close=()=>{const e=this.elements.pop();if(!e)throw TM();return e}}}class RT extends AT{constructor(e,t,n){super(),this.type=e,this.content=t,this.attrs=n}push(e,...t){this.content.push(e,...t)}pop(){return this.content.pop()}static create(e,t,n){return new RT(e,t,n)}}const LT=class extends $T{constructor(e){super(),ET(this,sT),ET(this,lT),ET(this,cT),ET(this,uT),ET(this,dT),ET(this,pT),ET(this,hT),DT(this,sT,Dw.none),DT(this,lT,e=>e.isText),DT(this,cT,(e,t)=>{if(NT(this,lT).call(this,e)&&NT(this,lT).call(this,t)&&Dw.sameSet(e.marks,t.marks))return this.schema.text(e.text+t.text,e.marks)}),DT(this,uT,e=>{const t=Object.values(M(M({},this.schema.nodes),this.schema.marks)).find(t=>t.spec.parseMarkdown.match(e));if(!t)throw function(e){return new xM(kM.parserMatchError,`Cannot match target parser for node: ${SM(e)}.`)}(e);return t}),DT(this,dT,e=>{const t=NT(this,uT).call(this,e);t.spec.parseMarkdown.runner(this,e,t)}),this.injectRoot=(e,t,n)=>(this.openNode(t,n),this.next(e.children),this),this.openNode=(e,t)=>(this.open(RT.create(e,[],t)),this),DT(this,pT,()=>{DT(this,sT,Dw.none);const e=this.close();return NT(this,hT).call(this,e.type,e.attrs,e.content)}),this.closeNode=()=>{try{NT(this,pT).call(this)}catch(Yo){console.error(Yo)}return this},DT(this,hT,(e,t,n)=>{const r=e.createAndFill(t,n,NT(this,sT));if(!r)throw function(e,t,n){const r="name"in e?e.name:e,o=e=>{if(null==e)return"null";if(Array.isArray(e))return`[${e.map(o).join(", ")}]`;if("object"==typeof e)return"toJSON"in e&&"function"==typeof e.toJSON?JSON.stringify(e.toJSON()):"spec"in e?JSON.stringify(e.spec):JSON.stringify(e);if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return JSON.stringify(e);if("function"==typeof e)return`[Function: ${e.name||"anonymous"}]`;try{return String(e)}catch(t){return"[Unserializable]"}},i=[["[Description]",`Cannot create node for ${r}`],["[Attributes]",t],["[Content]",(null!=n?n:[]).map(e=>e?"object"==typeof e&&"type"in e?`${e}`:o(e):"null")]].reduce((e,[t,n])=>{const r=`${t}: ${o(n)}.`;return e.concat(r)},[]);return new xM(kM.createNodeInParserFail,i.join("\n"))}(e,t,n);return this.push(r),r}),this.addNode=(e,t,n)=>{try{NT(this,hT).call(this,e,t,n)}catch(Yo){console.error(Yo)}return this},this.openMark=(e,t)=>{const n=e.create(t);return DT(this,sT,n.addToSet(NT(this,sT))),this},this.closeMark=e=>(DT(this,sT,e.removeFromSet(NT(this,sT))),this),this.addText=e=>{try{const t=this.top();if(!t)throw TM();const n=t.pop(),r=this.schema.text(e,NT(this,sT));if(!n)return t.push(r),this;const o=NT(this,cT).call(this,n,r);return o?(t.push(o),this):(t.push(n,r),this)}catch(Yo){return console.error(Yo),this}},this.build=()=>{let e;do{e=NT(this,pT).call(this)}while(this.size());return e},this.next=(e=[])=>([e].flat().forEach(e=>NT(this,dT).call(this,e)),this),this.toDoc=()=>this.build(),this.run=(e,t)=>{const n=e.runSync(e.parse(t),t);return this.next(n),this},this.schema=e}};sT=new WeakMap,lT=new WeakMap,cT=new WeakMap,uT=new WeakMap,dT=new WeakMap,pT=new WeakMap,hT=new WeakMap,LT.create=(e,t)=>{const n=new LT(e);return e=>(n.run(t,e),n.toDoc())};let IT=LT;const PT=class extends AT{constructor(e,t,n,r={}){super(),this.type=e,this.children=t,this.value=n,this.props=r,this.push=(e,...t)=>{this.children||(this.children=[]),this.children.push(e,...t)},this.pop=()=>{var e;return null===(e=this.children)||void 0===e?void 0:e.pop()}}};PT.create=(e,t,n,r={})=>new PT(e,t,n,r);let zT=PT;const BT=class extends $T{constructor(e){super(),ET(this,fT),ET(this,mT),ET(this,gT),ET(this,vT),ET(this,yT),ET(this,wT),ET(this,bT),ET(this,kT),ET(this,xT),ET(this,CT),ET(this,ST),ET(this,MT),ET(this,TT),DT(this,fT,Dw.none),DT(this,mT,e=>{const t=Object.values(M(M({},this.schema.nodes),this.schema.marks)).find(t=>t.spec.toMarkdown.match(e));if(!t)throw function(e){return new xM(kM.serializerMatchError,`Cannot match target serializer for node: ${SM(e)}.`)}(e.type);return t}),DT(this,gT,e=>NT(this,mT).call(this,e).spec.toMarkdown.runner(this,e)),DT(this,vT,(e,t)=>NT(this,mT).call(this,e).spec.toMarkdown.runner(this,e,t)),DT(this,yT,e=>{const{marks:t}=e,n=e=>{var t;return null!==(t=e.type.spec.priority)&&void 0!==t?t:50},r=[...t].sort((e,t)=>n(e)-n(t));r.every(t=>!NT(this,vT).call(this,t,e))&&NT(this,gT).call(this,e),t.forEach(e=>NT(this,TT).call(this,e))}),DT(this,wT,(e,t)=>{var n;if(e.type===t)return e;if(1!==(null===(n=e.children)||void 0===n?void 0:n.length))return e;const r=e=>{var n;if(e.type===t)return e;if(1!==(null===(n=e.children)||void 0===n?void 0:n.length))return null;const[o]=e.children;return o?r(o):null},o=r(e);if(!o)return e;const i=o.children?[...o.children]:void 0,a=M(M({},e),{},{children:i});return a.children=i,o.children=[a],o}),DT(this,bT,e=>{const{children:t}=e;return t?(e.children=t.reduce((e,t,n)=>{if(0===n)return[t];const r=e.at(-1);if(r&&r.isMark&&t.isMark){t=NT(this,wT).call(this,t,r.type);const{children:n}=t,o=C(t,d),{children:i}=r,a=C(r,p);if(t.type===r.type&&n&&i&&JSON.stringify(o)===JSON.stringify(a)){const t=M(M({},a),{},{children:[...i,...n]});return e.slice(0,-1).concat(NT(this,bT).call(this,t))}}return e.concat(t)},[]),e):e}),DT(this,kT,e=>{const t=M(M({},e.props),{},{type:e.type});return e.children&&(t.children=e.children),e.value&&(t.value=e.value),t}),this.openNode=(e,t,n)=>(this.open(zT.create(e,void 0,t,n)),this),DT(this,xT,(e,t)=>{let n="",r="";const o=e.children;let i=-1,a=-1;if(o){(s=o)&&s.forEach((e,t)=>{"text"===e.type&&e.value&&(i<0&&(i=t),a=t)});const e=null==o?void 0:o[a],t=null==o?void 0:o[i];if(e&&e.value.endsWith(" ")){const t=e.value,n=t.trimEnd();r=t.slice(n.length),e.value=n}if(t&&t.value.startsWith(" ")){const e=t.value,r=e.trimStart();n=e.slice(0,e.length-r.length),t.value=r}}var s;n.length&&NT(this,ST).call(this,"text",void 0,n);const l=t();return r.length&&NT(this,ST).call(this,"text",void 0,r),l}),DT(this,CT,(e=!1)=>{const t=this.close(),n=()=>NT(this,ST).call(this,t.type,t.children,t.value,t.props);return e?NT(this,xT).call(this,t,n):n()}),this.closeNode=()=>(NT(this,CT).call(this),this),DT(this,ST,(e,t,n,r)=>{const o=zT.create(e,t,n,r),i=NT(this,bT).call(this,NT(this,kT).call(this,o));return this.push(i),i}),this.addNode=(e,t,n,r)=>(NT(this,ST).call(this,e,t,n,r),this),DT(this,MT,(e,t,n,r)=>e.isInSet(NT(this,fT))?this:(DT(this,fT,e.addToSet(NT(this,fT))),this.openNode(t,n,M(M({},r),{},{isMark:!0})))),DT(this,TT,e=>{e.isInSet(NT(this,fT))&&(DT(this,fT,e.type.removeFromSet(NT(this,fT))),NT(this,CT).call(this,!0))}),this.withMark=(e,t,n,r)=>(NT(this,MT).call(this,e,t,n,r),this),this.closeMark=e=>(NT(this,TT).call(this,e),this),this.build=()=>{let e=null;do{e=NT(this,CT).call(this)}while(this.size());return e},this.next=e=>(e=>Object.prototype.hasOwnProperty.call(e,"size"))(e)?(e.forEach(e=>{NT(this,yT).call(this,e)}),this):(NT(this,yT).call(this,e),this),this.toString=e=>e.stringify(this.build()),this.run=e=>(this.next(e),this),this.schema=e}};fT=new WeakMap,mT=new WeakMap,gT=new WeakMap,vT=new WeakMap,yT=new WeakMap,wT=new WeakMap,bT=new WeakMap,kT=new WeakMap,xT=new WeakMap,CT=new WeakMap,ST=new WeakMap,MT=new WeakMap,TT=new WeakMap,BT.create=(e,t)=>{const n=new BT(e);return e=>(n.run(e),n.toString(t))};let FT=BT;const jT=(e,t)=>!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function VT(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("backward",e):n.parentOffset>0)?null:n}const qT=(e,t,n)=>{let r=VT(e,n);if(!r)return!1;let o=KT(r);if(!o){let n=r.blockRange(),o=n&&Qb(n);return null!=o&&(t&&t(e.tr.lift(n,o).scrollIntoView()),!0)}let i=o.nodeBefore;if(ZT(e,o,t,-1))return!0;if(0==r.parent.content.size&&(UT(i,"end")||_k.isSelectable(i)))for(let a=r.depth;;a--){let n=ak(e.doc,r.before(a),r.after(a),$w.empty);if(n&&n.slice.size<n.to-n.from){if(t){let r=e.tr.step(n);r.setSelection(UT(i,"end")?xk.findFrom(r.doc.resolve(r.mapping.map(o.pos,-1)),-1):_k.create(r.doc,o.pos-i.nodeSize)),t(r.scrollIntoView())}return!0}if(1==a||r.node(a-1).childCount>1)break}return!(!i.isAtom||o.depth!=r.depth-1)&&(t&&t(e.tr.delete(o.pos-i.nodeSize,o.pos).scrollIntoView()),!0)},HT=(e,t,n)=>{let r=VT(e,n);if(!r)return!1;let o=KT(r);return!!o&&function(e,t,n){let r=t.nodeBefore,o=r,i=t.pos-1;for(;!o.isTextblock;i--){if(o.type.spec.isolating)return!1;let e=o.lastChild;if(!e)return!1;o=e}let a=t.nodeAfter,s=a,l=t.pos+1;for(;!s.isTextblock;l++){if(s.type.spec.isolating)return!1;let e=s.firstChild;if(!e)return!1;s=e}let c=ak(e.doc,i,l,$w.empty);if(!c||c.from!=i||c instanceof Yb&&c.slice.size>=l-i)return!1;if(n){let t=e.tr.step(c);t.setSelection(Tk.create(t.doc,i)),n(t.scrollIntoView())}return!0}(e,o,t)};function UT(e,t,n=!1){for(let r=e;r;r="start"==t?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&1!=r.childCount)return!1}return!1}const WT=(e,t,n)=>{let{$head:r,empty:o}=e.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):r.parentOffset>0)return!1;i=KT(r)}let a=i&&i.nodeBefore;return!(!a||!_k.isSelectable(a))&&(t&&t(e.tr.setSelection(_k.create(e.doc,i.pos-a.nodeSize)).scrollIntoView()),!0)};function KT(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function YT(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}function JT(e){for(let t=0;t<e.edgeCount;t++){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const GT=(e,t)=>{let{$from:n,$to:r}=e.selection;if(e.selection instanceof _k&&e.selection.node.isBlock)return!(!n.parentOffset||!ok(e.doc,n.pos)||(t&&t(e.tr.split(n.pos).scrollIntoView()),0));if(!n.depth)return!1;let o,i,a=[],s=!1,l=!1;for(let p=n.depth;;p--){if(n.node(p).isBlock){s=n.end(p)==n.pos+(n.depth-p),l=n.start(p)==n.pos-(n.depth-p),i=JT(n.node(p-1).contentMatchAt(n.indexAfter(p-1)));let e=XT&&XT(r.parent,s,n);a.unshift(e||(s&&i?{type:i}:null)),o=p;break}if(1==p)return!1;a.unshift(null)}let c=e.tr;(e.selection instanceof Tk||e.selection instanceof Ek)&&c.deleteSelection();let u=c.mapping.map(n.pos),d=ok(c.doc,u,a.length,a);if(d||(a[0]=i?{type:i}:null,d=ok(c.doc,u,a.length,a)),!d)return!1;if(c.split(u,a.length,a),!s&&l&&n.node(o).type!=i){let e=c.mapping.map(n.before(o)),t=c.doc.resolve(e);i&&n.node(o-1).canReplaceWith(t.index(),t.index()+1,i)&&c.setNodeMarkup(c.mapping.map(n.before(o)),i)}return t&&t(c.scrollIntoView()),!0};var XT;function ZT(e,t,n,r){let o,i,a=t.nodeBefore,s=t.nodeAfter,l=a.type.spec.isolating||s.type.spec.isolating;if(!l&&function(e,t,n){let r=t.nodeBefore,o=t.nodeAfter,i=t.index();return!(!(r&&o&&r.type.compatibleContent(o.type))||(!r.content.size&&t.parent.canReplace(i-1,i)?(n&&n(e.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(i,i+1)||!o.isTextblock&&!ik(e.doc,t.pos)||(n&&n(e.tr.join(t.pos).scrollIntoView()),0)))}(e,t,n))return!0;let c=!l&&t.parent.canReplace(t.index(),t.index()+1);if(c&&(o=(i=a.contentMatchAt(a.childCount)).findWrapping(s.type))&&i.matchType(o[0]||s.type).validEnd){if(n){let r=t.pos+s.nodeSize,i=Ow.empty;for(let e=o.length-1;e>=0;e--)i=Ow.from(o[e].create(null,i));i=Ow.from(a.copy(i));let l=e.tr.step(new Jb(t.pos-1,r,t.pos,r,new $w(i,1,0),o.length,!0)),c=l.doc.resolve(r+2*o.length);c.nodeAfter&&c.nodeAfter.type==a.type&&ik(l.doc,c.pos)&&l.join(c.pos),n(l.scrollIntoView())}return!0}let u=s.type.spec.isolating||r>0&&l?null:xk.findFrom(t,1),d=u&&u.$from.blockRange(u.$to),p=d&&Qb(d);if(null!=p&&p>=t.depth)return n&&n(e.tr.lift(d,p).scrollIntoView()),!0;if(c&&UT(s,"start",!0)&&UT(a,"end")){let r=a,o=[];for(;o.push(r),!r.isTextblock;)r=r.lastChild;let i=s,l=1;for(;!i.isTextblock;i=i.firstChild)l++;if(r.canReplace(r.childCount,r.childCount,i.content)){if(n){let r=Ow.empty;for(let e=o.length-1;e>=0;e--)r=Ow.from(o[e].copy(r));n(e.tr.step(new Jb(t.pos-o.length,t.pos+s.nodeSize,t.pos+l,t.pos+s.nodeSize-l,new $w(r,o.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function QT(e){return function(t,n){let r=t.selection,o=e<0?r.$from:r.$to,i=o.depth;for(;o.node(i).isInline;){if(!i)return!1;i--}return!!o.node(i).isTextblock&&(n&&n(t.tr.setSelection(Tk.create(t.doc,e<0?o.start(i):o.end(i)))),!0)}}const eO=QT(-1),tO=QT(1);function nO(e,t=null){return function(n,r){let{$from:o,$to:i}=n.selection,a=o.blockRange(i),s=a&&ek(a,e,t);return!!s&&(r&&r(n.tr.wrap(a,s).scrollIntoView()),!0)}}function rO(e,t=null){return function(n,r){let o=!1;for(let i=0;i<n.selection.ranges.length&&!o;i++){let{$from:{pos:r},$to:{pos:a}}=n.selection.ranges[i];n.doc.nodesBetween(r,a,(r,i)=>{if(o)return!1;if(r.isTextblock&&!r.hasMarkup(e,t))if(r.type==e)o=!0;else{let t=n.doc.resolve(i),r=t.index();o=t.parent.canReplaceWith(r,r+1,e)}})}if(!o)return!1;if(r){let o=n.tr;for(let r=0;r<n.selection.ranges.length;r++){let{$from:{pos:i},$to:{pos:a}}=n.selection.ranges[r];o.setBlockType(i,a,e,t)}r(o.scrollIntoView())}return!0}}function oO(e,t=null,n){let r=!1!==(n&&n.removeWhenPresent),o=!1!==(n&&n.enterInlineAtoms),i=!(n&&n.includeWhitespace);return function(n,a){let{empty:s,$cursor:l,ranges:c}=n.selection;if(s&&!l||!function(e,t,n,r){for(let o=0;o<t.length;o++){let{$from:i,$to:a}=t[o],s=0==i.depth&&e.inlineContent&&e.type.allowsMarkType(n);if(e.nodesBetween(i.pos,a.pos,(e,t)=>{if(s||!r&&e.isAtom&&e.isInline&&t>=i.pos&&t+e.nodeSize<=a.pos)return!1;s=e.inlineContent&&e.type.allowsMarkType(n)}),s)return!0}return!1}(n.doc,c,e,o))return!1;if(a)if(l)e.isInSet(n.storedMarks||l.marks())?a(n.tr.removeStoredMark(e)):a(n.tr.addStoredMark(e.create(t)));else{let s,l=n.tr;o||(c=function(e){let t=[];for(let n=0;n<e.length;n++){let{$from:r,$to:o}=e[n];r.doc.nodesBetween(r.pos,o.pos,(e,n)=>{if(e.isAtom&&e.content.size&&e.isInline&&n>=r.pos&&n+e.nodeSize<=o.pos)return n+1>r.pos&&t.push(new Ck(r,r.doc.resolve(n+1))),r=r.doc.resolve(n+1+e.content.size),!1}),r.pos<o.pos&&t.push(new Ck(r,o))}return t}(c)),s=r?!c.some(t=>n.doc.rangeHasMark(t.$from.pos,t.$to.pos,e)):!c.every(t=>{let n=!1;return l.doc.nodesBetween(t.$from.pos,t.$to.pos,(r,o,i)=>{if(n)return!1;n=!e.isInSet(r.marks)&&!!i&&i.type.allowsMarkType(e)&&!(r.isText&&/^\s*$/.test(r.textBetween(Math.max(0,t.$from.pos-o),Math.min(r.nodeSize,t.$to.pos-o))))}),!n});for(let n=0;n<c.length;n++){let{$from:r,$to:o}=c[n];if(s){let n=r.pos,a=o.pos,s=r.nodeAfter,c=o.nodeBefore,u=i&&s&&s.isText?/^\s*/.exec(s.text)[0].length:0,d=i&&c&&c.isText?/\s*$/.exec(c.text)[0].length:0;n+u<a&&(n+=u,a-=d),l.addMark(n,a,e.create(t))}else l.removeMark(r.pos,o.pos,e)}a(l.scrollIntoView())}return!0}}function iO(...e){return function(t,n,r){for(let o=0;o<e.length;o++)if(e[o](t,n,r))return!0;return!1}}let aO=iO(jT,qT,WT),sO=iO(jT,(e,t,n)=>{let r=function(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)?null:n}(e,n);if(!r)return!1;let o=YT(r);if(!o)return!1;let i=o.nodeAfter;if(ZT(e,o,t,1))return!0;if(0==r.parent.content.size&&(UT(i,"start")||_k.isSelectable(i))){let n=ak(e.doc,r.before(),r.after(),$w.empty);if(n&&n.slice.size<n.to-n.from){if(t){let r=e.tr.step(n);r.setSelection(UT(i,"start")?xk.findFrom(r.doc.resolve(r.mapping.map(o.pos)),1):_k.create(r.doc,r.mapping.map(o.pos))),t(r.scrollIntoView())}return!0}}return!(!i.isAtom||o.depth!=r.depth-1)&&(t&&t(e.tr.delete(o.pos,o.pos+i.nodeSize).scrollIntoView()),!0)},(e,t,n)=>{let{$head:r,empty:o}=e.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size)return!1;i=YT(r)}let a=i&&i.nodeAfter;return!(!a||!_k.isSelectable(a))&&(t&&t(e.tr.setSelection(_k.create(e.doc,i.pos)).scrollIntoView()),!0)});const lO={Enter:iO((e,t)=>{let{$head:n,$anchor:r}=e.selection;return!(!n.parent.type.spec.code||!n.sameParent(r))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)},(e,t)=>{let n=e.selection,{$from:r,$to:o}=n;if(n instanceof Ek||r.parent.inlineContent||o.parent.inlineContent)return!1;let i=JT(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){let n=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,a=e.tr.insert(n,i.createAndFill());a.setSelection(Tk.create(a.doc,n+1)),t(a.scrollIntoView())}return!0},(e,t)=>{let{$cursor:n}=e.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let r=n.before();if(ok(e.doc,r))return t&&t(e.tr.split(r).scrollIntoView()),!0}let r=n.blockRange(),o=r&&Qb(r);return null!=o&&(t&&t(e.tr.lift(r,o).scrollIntoView()),!0)},GT),"Mod-Enter":(e,t)=>{let{$head:n,$anchor:r}=e.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let o=n.node(-1),i=n.indexAfter(-1),a=JT(o.contentMatchAt(i));if(!a||!o.canReplaceWith(i,i,a))return!1;if(t){let r=n.after(),o=e.tr.replaceWith(r,r,a.createAndFill());o.setSelection(xk.near(o.doc.resolve(r),1)),t(o.scrollIntoView())}return!0},Backspace:aO,"Mod-Backspace":aO,"Shift-Backspace":aO,Delete:sO,"Mod-Delete":sO,"Mod-a":(e,t)=>(t&&t(e.tr.setSelection(new Ek(e.doc))),!0)},cO={"Ctrl-h":lO.Backspace,"Alt-Backspace":lO["Mod-Backspace"],"Ctrl-d":lO.Delete,"Ctrl-Alt-Backspace":lO["Mod-Delete"],"Alt-Delete":lO["Mod-Delete"],"Alt-d":lO["Mod-Delete"],"Ctrl-a":eO,"Ctrl-e":tO};for(let e in lO)cO[e]=lO[e];const uO=("undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!("undefined"==typeof os||!os.platform)&&"darwin"==os.platform())?cO:lO;class dO{constructor(e,t,n={}){var r;this.match=e,this.match=e,this.handler="string"==typeof t?(r=t,function(e,t,n,o){let i=r;if(t[1]){let e=t[0].lastIndexOf(t[1]);i+=t[0].slice(e+t[1].length);let r=(n+=e)-o;r>0&&(i=t[0].slice(e-r,e)+i,n=o)}return e.tr.insertText(i,n,o)}):t,this.undoable=!1!==n.undoable,this.inCode=n.inCode||!1,this.inCodeMark=!1!==n.inCodeMark}}const pO=(e,t)=>{let n=e.plugins;for(let r=0;r<n.length;r++){let o,i=n[r];if(i.spec.isInputRules&&(o=i.getState(e))){if(t){let n=e.tr,r=o.transform;for(let e=r.steps.length-1;e>=0;e--)n.step(r.steps[e].invert(r.docs[e]));if(o.text){let t=n.doc.resolve(o.from).marks();n.replaceWith(o.from,o.to,e.schema.text(o.text,t))}else n.delete(o.from,o.to);t(n)}return!0}}return!1};function hO(e,t,n=null,r){return new dO(e,(e,o,i,a)=>{let s=n instanceof Function?n(o):n,l=e.tr.delete(i,a),c=l.doc.resolve(i).blockRange(),u=c&&ek(c,t,s);if(!u)return null;l.wrap(c,u);let d=l.doc.resolve(i-1).nodeBefore;return d&&d.type==t&&ik(l.doc,i-1)&&(!r||r(o,d))&&l.join(i-1),l})}function fO(e,t,n=null){return new dO(e,(e,r,o,i)=>{let a=e.doc.resolve(o),s=n instanceof Function?n(r):n;return a.node(-1).canReplaceWith(a.index(-1),a.indexAfter(-1),t)?e.tr.delete(o,i).setBlockType(o,o,t,s):null})}new dO(/--$/,"",{inCodeMark:!1}),new dO(/\.\.\.$/,"",{inCodeMark:!1}),new dO(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"",{inCodeMark:!1}),new dO(/"$/,"",{inCodeMark:!1}),new dO(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"",{inCodeMark:!1}),new dO(/'$/,"",{inCodeMark:!1});const mO="undefined"!=typeof navigator?navigator:null,gO="undefined"!=typeof document?document:null,vO=mO&&mO.userAgent||"",yO=/Edge\/(\d+)/.exec(vO),wO=/MSIE \d/.exec(vO),bO=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(vO),kO=!!(wO||bO||yO);wO?document.documentMode:bO?bO[1]:yO&&yO[1];!kO&&/gecko\/(\d+)/i.test(vO)&&(/Firefox\/(\d+)/.exec(vO)||[0,0])[1];const xO=!kO&&/Chrome\/(\d+)/.exec(vO);xO&&xO[1];!kO&&!!mO&&/Apple Computer/.test(mO.vendor)&&(/Mobile\/\w+/.test(vO)||!!mO&&mO.maxTouchPoints>2)||mO&&/Mac/.test(mO.platform);function CO(e,t,n,r,o,i){if(e.composing)return!1;const a=e.state,s=a.doc.resolve(t);if(s.parent.type.spec.code)return!1;const l=s.parent.textBetween(Math.max(0,s.parentOffset-500),s.parentOffset,void 0,"")+r;for(let c of o){const o=c,s=o.match.exec(l),u=s&&s[0]&&o.handler(a,s,t-(s[0].length-r.length),n);if(u)return!1!==o.undoable&&u.setMeta(i,{transform:u,from:t,to:n,text:r}),e.dispatch(u),!0}return!1}!!gO&&"webkitFontSmoothing"in gO.documentElement.style&&(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];const SO=new Hk("MILKDOWN_CUSTOM_INPUTRULES");function MO({rules:e}){const t=new jk({key:SO,isInputRules:!0,state:{init:()=>null,apply(e,t){const n=e.getMeta(this);return n||(e.selectionSet||e.docChanged?null:t)}},props:{handleTextInput:(n,r,o,i)=>CO(n,r,o,i,e,t),handleDOMEvents:{compositionend:n=>(setTimeout(()=>{const{$cursor:r}=n.state.selection;r&&CO(n,r.pos,r.pos,"",e,t)}),!1)},handleKeyDown(n,r){if("Enter"!==r.key)return!1;const{$cursor:o}=n.state.selection;return!!o&&CO(n,o.pos,o.pos,"\n",e,t)}}});return t}function TO(e,t,n={}){return new dO(e,(e,r,o,i)=>{var a,s,l,c;const{tr:u}=e;let d=r[r.length-1],p=r[0],h=[],f=i;const m={group:d,fullMatch:p,start:o,end:i},g=null==(a=n.updateCaptured)?void 0:a.call(n,m);if(Object.assign(m,g),({group:d,fullMatch:p,start:o,end:i}=m),null===p)return null;if(""===(null==d?void 0:d.trim()))return null;if(d){const e=p.search(/\S/),a=o+p.indexOf(d),m=a+d.length;h=null!=(s=u.storedMarks)?s:[],m<i&&u.delete(m,i),a>o&&u.delete(o+e,a),f=o+e+d.length;const g=null==(l=n.getAttr)?void 0:l.call(n,r);u.addMark(o,f,t.create(g)),u.setStoredMarks(h),null==(c=n.beforeDispatch)||c.call(n,{match:r,start:o,end:i,tr:u})}return u})}var OO=Object.defineProperty,_O=Object.defineProperties,NO=Object.getOwnPropertyDescriptors,EO=Object.getOwnPropertySymbols,DO=Object.prototype.hasOwnProperty,AO=Object.prototype.propertyIsEnumerable,$O=(e,t,n)=>t in e?OO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function RO(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function LO(e,t,n){const r=e.state.doc.content.size,o=RO(t,0,r),i=RO(n,0,r),a=e.coordsAtPos(o),s=e.coordsAtPos(i,-1),l=Math.min(a.top,s.top),c=Math.max(a.bottom,s.bottom),u=Math.min(a.left,s.left),d=Math.max(a.right,s.right),p={top:l,bottom:c,left:u,right:d,width:d-u,height:c-l,x:u,y:l};return((e,t)=>_O(e,NO(t)))(((e,t)=>{for(var n in t||(t={}))DO.call(t,n)&&$O(e,n,t[n]);if(EO)for(var n of EO(t))AO.call(t,n)&&$O(e,n,t[n]);return e})({},p),{toJSON:()=>p})}function IO(e){return Object.assign(Object.create(e),e).setTime(Date.now())}function PO(e,t){if(!(e instanceof _k))return;const{node:n,$from:r}=e;return function(e,t){return Array.isArray(e)&&e.includes(t.type)||t.type===e}(t,n)?{node:n,pos:r.pos,start:r.start(r.depth),depth:r.depth}:void 0}for(var zO={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},BO={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},FO="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),jO="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),VO=0;VO<10;VO++)zO[48+VO]=zO[96+VO]=String(VO);for(VO=1;VO<=24;VO++)zO[VO+111]="F"+VO;for(VO=65;VO<=90;VO++)zO[VO]=String.fromCharCode(VO+32),BO[VO]=String.fromCharCode(VO);for(var qO in zO)BO.hasOwnProperty(qO)||(BO[qO]=zO[qO]);const HO="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),UO="undefined"!=typeof navigator&&/Win/.test(navigator.platform);function WO(e){let t,n,r,o,i=e.split(/-(?!$)/),a=i[i.length-1];"Space"==a&&(a=" ");for(let s=0;s<i.length-1;s++){let e=i[s];if(/^(cmd|meta|m)$/i.test(e))o=!0;else if(/^a(lt)?$/i.test(e))t=!0;else if(/^(c|ctrl|control)$/i.test(e))n=!0;else if(/^s(hift)?$/i.test(e))r=!0;else{if(!/^mod$/i.test(e))throw new Error("Unrecognized modifier name: "+e);HO?o=!0:n=!0}}return t&&(a="Alt-"+a),n&&(a="Ctrl-"+a),o&&(a="Meta-"+a),r&&(a="Shift-"+a),a}function KO(e,t,n=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),n&&t.shiftKey&&(e="Shift-"+e),e}function YO(e){let t=function(e){let t=Object.create(null);for(let n in e)t[WO(n)]=e[n];return t}(e);return function(e,n){let r,o=function(e){var t=!(FO&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||jO&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key)&&e.key||(e.shiftKey?BO:zO)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(n),i=t[KO(o,n)];if(i&&i(e.state,e.dispatch,e))return!0;if(1==o.length&&" "!=o){if(n.shiftKey){let r=t[KO(o,n,!1)];if(r&&r(e.state,e.dispatch,e))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(UO&&n.ctrlKey&&n.altKey)&&(r=zO[n.keyCode])&&r!=o){let o=t[KO(r,n)];if(o&&o(e.state,e.dispatch,e))return!0}}return!1}}function JO(e,t){return e.meta=M({package:"@milkdown/core",group:"System"},t),e}const GO={text:(e,t,n,r)=>{const o=e.value;return/^[^*_\\]*\s+$/.test(o)?o:n.safe(o,M(M({},r),{},{encode:[]}))},strong:(e,t,n,r)=>{const o=e.marker||n.options.strong||"*",i=n.enter("strong"),a=n.createTracker(r);let s=a.move(o+o);return s+=a.move(n.containerPhrasing(e,M({before:s,after:o},a.current()))),s+=a.move(o+o),i(),s},emphasis:(e,t,n,r)=>{const o=e.marker||n.options.emphasis||"*",i=n.enter("emphasis"),a=n.createTracker(r);let s=a.move(o);return s+=a.move(n.containerPhrasing(e,M({before:s,after:o},a.current()))),s+=a.move(o),i(),s}},XO=LM({},"editorView"),ZO=LM({},"editorState"),QO=LM([],"initTimer"),e_=LM({},"editor"),t_=LM([],"inputRules"),n_=LM([],"prosePlugins"),r_=LM([],"remarkPlugins"),o_=LM([],"nodeView"),i_=LM([],"markView"),a_=LM(Me().use(Te).use(Oe),"remark"),s_=LM({handlers:GO,encode:[]},"remarkStringifyOptions"),l_=aT("ConfigReady");const c_=aT("InitReady");function u_(e){const t=t=>(t.inject(e_,e).inject(n_,[]).inject(r_,[]).inject(t_,[]).inject(o_,[]).inject(i_,[]).inject(s_,{handlers:GO,encode:[]}).inject(a_,Me().use(Te).use(Oe)).inject(QO,[l_]).record(c_),async()=>{await t.waitTimers(QO);const e=t.get(s_);return t.set(a_,Me().use(Te).use(Oe,e)),t.done(c_),()=>{t.remove(e_).remove(n_).remove(r_).remove(t_).remove(o_).remove(i_).remove(s_).remove(a_).remove(QO).clearTimer(c_)}});return JO(t,{displayName:"Init"}),t}const d_=aT("SchemaReady"),p_=LM([],"schemaTimer"),h_=LM({},"schema"),f_=LM([],"nodes"),m_=LM([],"marks");function g_(e){var t;return M(M({},e),{},{parseDOM:null===(t=e.parseDOM)||void 0===t?void 0:t.map(t=>M({priority:e.priority},t))})}const v_=e=>(e.inject(h_,{}).inject(f_,[]).inject(m_,[]).inject(p_,[c_]).record(d_),async()=>{await e.waitTimers(p_);const t=e.get(a_),n=e.get(r_).reduce((e,t)=>e.use(t.plugin,t.options),t);e.set(a_,n);const r=Object.fromEntries(e.get(f_).map(([e,t])=>[e,g_(t)])),o=Object.fromEntries(e.get(m_).map(([e,t])=>[e,g_(t)])),i=new gb({nodes:r,marks:o});return e.set(h_,i),e.done(d_),()=>{e.remove(h_).remove(f_).remove(m_).remove(p_).clearTimer(d_)}});JO(v_,{displayName:"Schema"});var y_=new WeakMap,w_=new WeakMap;class b_{constructor(){v(this,y_,void 0),v(this,w_,void 0),b(y_,this,new NM),b(w_,this,null),this.setCtx=e=>{b(w_,this,e)},this.chain=()=>{if(null==w(w_,this))throw _M();const e=w(w_,this),t=[],n=this.get.bind(this),r={run:()=>{const n=iO(...t),r=e.get(XO);return n(r.state,r.dispatch,r)},inline:e=>(t.push(e),r),pipe:function(e,o){const i=n(e);return t.push(i(o)),r}.bind(this)};return r}}get ctx(){return w(w_,this)}create(e,t){const n=e.create(w(y_,this).sliceMap);return n.set(t),n}get(e){return w(y_,this).get(e).get()}remove(e){return w(y_,this).remove(e)}call(e,t){if(null==w(w_,this))throw _M();const n=this.get(e)(t),r=w(w_,this).get(XO);return n(r.state,r.dispatch,r)}inline(e){if(null==w(w_,this))throw _M();const t=w(w_,this).get(XO);return e(t.state,t.dispatch,t)}}const k_=LM(new b_,"commands"),x_=LM([d_],"commandsTimer"),C_=aT("CommandsReady"),S_=e=>{const t=new b_;return t.setCtx(e),e.inject(k_,t).inject(x_,[d_]).record(C_),async()=>(await e.waitTimers(x_),e.done(C_),()=>{e.remove(k_).remove(x_).clearTimer(C_)})};JO(S_,{displayName:"Commands"});var M_=new WeakMap,T_=new WeakMap;class O_{constructor(){v(this,M_,void 0),v(this,T_,void 0),b(M_,this,null),b(T_,this,[]),this.setCtx=e=>{b(M_,this,e)},this.add=e=>(w(T_,this).push(e),()=>{b(T_,this,w(T_,this).filter(t=>t!==e))}),this.addObjectKeymap=e=>{const t=[];return Object.entries(e).forEach(([e,n])=>{if("function"==typeof n){const r={key:e,onRun:()=>n};w(T_,this).push(r),t.push(()=>{b(T_,this,w(T_,this).filter(e=>e!==r))})}else w(T_,this).push(n),t.push(()=>{b(T_,this,w(T_,this).filter(e=>e!==n))})}),()=>{t.forEach(e=>e())}},this.addBaseKeymap=()=>{const e=function(e){const t=iO(pO,jT,HT,WT);return e.Backspace=t,e}(uO);return this.addObjectKeymap(e)},this.build=()=>{const e={};w(T_,this).forEach(t=>{e[t.key]=[...e[t.key]||[],t]});const t=Object.fromEntries(Object.entries(e).map(([e,t])=>{const n=t.sort((e,t)=>{var n,r;return(null!==(n=t.priority)&&void 0!==n?n:50)-(null!==(r=e.priority)&&void 0!==r?r:50)});return[e,(e,t,r)=>{const o=w(M_,this);if(null==o)throw MM();return iO(...n.map(e=>e.onRun(o)))(e,t,r)}]}));return t}}get ctx(){return w(M_,this)}}const __=LM(new O_,"keymap"),N_=LM([d_],"keymapTimer"),E_=aT("KeymapReady"),D_=e=>{const t=new O_;return t.setCtx(e),e.inject(__,t).inject(N_,[d_]).record(E_),async()=>(await e.waitTimers(N_),e.done(E_),()=>{e.remove(__).remove(N_).clearTimer(E_)})},A_=aT("ParserReady"),$_=()=>{throw MM()},R_=LM($_,"parser"),L_=LM([],"parserTimer"),I_=e=>(e.inject(R_,$_).inject(L_,[d_]).record(A_),async()=>{await e.waitTimers(L_);const t=e.get(a_),n=e.get(h_);return e.set(R_,IT.create(n,t)),e.done(A_),()=>{e.remove(R_).remove(L_).clearTimer(A_)}});JO(I_,{displayName:"Parser"});const P_=aT("SerializerReady"),z_=LM([],"serializerTimer"),B_=()=>{throw MM()},F_=LM(B_,"serializer"),j_=e=>(e.inject(F_,B_).inject(z_,[d_]).record(P_),async()=>{await e.waitTimers(z_);const t=e.get(a_),n=e.get(h_);return e.set(F_,FT.create(n,t)),e.done(P_),()=>{e.remove(F_).remove(z_).clearTimer(P_)}});JO(j_,{displayName:"Serializer"});const V_=LM("","defaultValue"),q_=LM(e=>e,"stateOptions"),H_=LM([],"editorStateTimer"),U_=aT("EditorStateReady");function W_(e,t,n){if("string"==typeof e)return t(e);if("html"===e.type)return yb.fromSchema(n).parse(e.dom);if("json"===e.type)return Xw.fromJSON(n,e.value);throw r=e,new xM(kM.docTypeError,`Doc type error, unsupported type: ${SM(r)}`);var r}const K_=new Hk("MILKDOWN_STATE_TRACKER"),Y_=e=>(e.inject(V_,"").inject(ZO,{}).inject(q_,e=>e).inject(H_,[A_,P_,C_,E_]).record(U_),async()=>{await e.waitTimers(H_);const t=e.get(h_),n=e.get(R_),r=e.get(t_),o=e.get(q_),i=e.get(n_),a=W_(e.get(V_),n,t),s=e.get(__),l=s.addBaseKeymap(),c=[...i,new jk({key:K_,state:{init:()=>{},apply:(t,n,r,o)=>{e.set(ZO,o)}}}),MO({rules:r}),(u=s.build(),new jk({props:{handleKeyDown:YO(u)}}))];var u;e.set(n_,c);const d=o({schema:t,doc:a,plugins:c}),p=Bk.create(d);return e.set(ZO,p),e.done(U_),()=>{l(),e.remove(V_).remove(ZO).remove(q_).remove(H_).clearTimer(U_)}});JO(Y_,{displayName:"EditorState"});const J_=LM([],"pasteRule"),G_=LM([d_],"pasteRuleTimer"),X_=aT("PasteRuleReady"),Z_=e=>(e.inject(J_,[]).inject(G_,[d_]).record(X_),async()=>(await e.waitTimers(G_),e.done(X_),()=>{e.remove(J_).remove(G_).clearTimer(X_)}));JO(Z_,{displayName:"PasteRule"});const Q_=aT("EditorViewReady"),eN=LM([],"editorViewTimer"),tN=LM({},"editorViewOptions"),nN=LM(null,"root"),rN=LM(null,"rootDOM"),oN=LM({},"rootAttrs");const iN=new Hk("MILKDOWN_VIEW_CLEAR"),aN=e=>(e.inject(nN,document.body).inject(XO,{}).inject(tN,{}).inject(rN,null).inject(oN,{}).inject(eN,[U_,X_]).record(Q_),async()=>{await e.wait(c_);const t=e.get(nN)||document.body,n="string"==typeof t?document.querySelector(t):t;e.update(n_,t=>[new jk({key:iN,view:t=>{const r=n?function(e,t){const n=document.createElement("div");n.className="milkdown",e.appendChild(n),t.set(rN,n);const r=t.get(oN);return Object.entries(r).forEach(([e,t])=>n.setAttribute(e,t)),n}(n,e):void 0;return(()=>{if(r&&n){const e=t.dom;n.replaceChild(r,e),r.appendChild(e)}})(),{destroy:()=>{null!=r&&r.parentNode&&(null==r||r.parentNode.replaceChild(t.dom,r)),null==r||r.remove()}}}}),...t]),await e.waitTimers(eN);const r=e.get(ZO),o=e.get(tN),i=Object.fromEntries(e.get(o_)),a=Object.fromEntries(e.get(i_)),s=new tM(n,M({state:r,nodeViews:i,markViews:a,transformPasted:(t,n,r)=>(e.get(J_).sort((e,t)=>{var n,r;return(null!==(n=t.priority)&&void 0!==n?n:50)-(null!==(r=e.priority)&&void 0!==r?r:50)}).map(e=>e.run).forEach(e=>{t=e(t,n,r)}),t)},o));var l;return(l=s.dom).classList.add("editor"),l.setAttribute("role","textbox"),e.set(XO,s),e.done(Q_),()=>{null==s||s.destroy(),e.remove(nN).remove(XO).remove(tN).remove(rN).remove(oN).remove(eN).clearTimer(Q_)}});JO(aN,{displayName:"EditorView"});var sN=new WeakMap,lN=new WeakMap,cN=new WeakMap,uN=new WeakMap,dN=new WeakMap,pN=new WeakMap,hN=new WeakMap,fN=new WeakMap,mN=new WeakMap,gN=new WeakMap,vN=new WeakMap,yN=new WeakMap,wN=new WeakMap,bN=new WeakMap,kN=new WeakMap;class xN{constructor(){v(this,sN,void 0),v(this,lN,void 0),v(this,cN,void 0),v(this,uN,void 0),v(this,dN,void 0),v(this,pN,void 0),v(this,hN,void 0),v(this,fN,void 0),v(this,mN,void 0),v(this,gN,void 0),v(this,vN,void 0),v(this,yN,void 0),v(this,wN,void 0),v(this,bN,void 0),v(this,kN,void 0),b(sN,this,!1),b(lN,this,"Idle"),b(cN,this,[]),b(uN,this,()=>{}),b(dN,this,new NM),b(pN,this,new XM),b(hN,this,new Map),b(fN,this,new Map),b(mN,this,new GM(w(dN,this),w(pN,this))),b(gN,this,()=>{const e=function(e){const t=t=>(t.record(l_),async()=>(await e(t),t.done(l_),()=>{t.clearTimer(l_)}));return JO(t,{displayName:"Config"}),t}(async e=>{await Promise.all(w(cN,this).map(t=>Promise.resolve(t(e))))}),t=[v_,I_,j_,S_,D_,Z_,Y_,aN,u_(this),e];w(vN,this).call(this,t,w(fN,this))}),b(vN,this,(e,t)=>{e.forEach(e=>{const n=w(mN,this).produce(w(sN,this)?e.meta:void 0),r=e(n);t.set(e,{ctx:n,handler:r,cleanup:void 0})})}),b(yN,this,(e,t=!1)=>Promise.all([e].flat().map(async e=>{const n=w(hN,this).get(e),r=null==n?void 0:n.cleanup;return t?w(hN,this).delete(e):w(hN,this).set(e,{ctx:void 0,handler:void 0,cleanup:void 0}),"function"==typeof r?r():r}))),b(wN,this,async()=>{await Promise.all([...w(fN,this).entries()].map(async([e,{cleanup:t}])=>"function"==typeof t?t():t)),w(fN,this).clear()}),b(bN,this,e=>{b(lN,this,e),w(uN,this).call(this,e)}),b(kN,this,e=>[...e.entries()].map(async([t,n])=>{const{ctx:r,handler:o}=n;if(!o)return;const i=await o();e.set(t,{ctx:r,handler:o,cleanup:i})})),this.enableInspector=(e=!0)=>(b(sN,this,e),this),this.onStatusChange=e=>(b(uN,this,e),this),this.config=e=>(w(cN,this).push(e),this),this.removeConfig=e=>(b(cN,this,w(cN,this).filter(t=>t!==e)),this),this.use=e=>{const t=[e].flat();return t.flat().forEach(e=>{w(hN,this).set(e,{ctx:void 0,handler:void 0,cleanup:void 0})}),"Created"===w(lN,this)&&w(vN,this).call(this,t,w(hN,this)),this},this.remove=async e=>"OnCreate"===w(lN,this)?(console.warn("[Milkdown]: You are trying to remove plugins when the editor is creating, this is not recommended, please check your code."),new Promise(t=>{setTimeout(()=>{t(this.remove(e))},50)})):(await w(yN,this).call(this,[e].flat(),!0),this),this.create=async()=>("OnCreate"===w(lN,this)||("Created"===w(lN,this)&&await this.destroy(),w(bN,this).call(this,"OnCreate"),w(gN,this).call(this),w(vN,this).call(this,[...w(hN,this).keys()],w(hN,this)),await Promise.all([w(kN,this).call(this,w(fN,this)),w(kN,this).call(this,w(hN,this))].flat()),w(bN,this).call(this,"Created")),this),this.destroy=async(e=!1)=>"Destroyed"===w(lN,this)||"OnDestroy"===w(lN,this)?this:"OnCreate"===w(lN,this)?new Promise(t=>{setTimeout(()=>{t(this.destroy(e))},50)}):(e&&b(cN,this,[]),w(bN,this).call(this,"OnDestroy"),await w(yN,this).call(this,[...w(hN,this).keys()],e),await w(wN,this).call(this),w(bN,this).call(this,"Destroyed"),this),this.action=e=>e(w(mN,this)),this.inspect=()=>w(sN,this)?[...w(fN,this).values(),...w(hN,this).values()].map(({ctx:e})=>{var t;return null==e||null===(t=e.inspector)||void 0===t?void 0:t.read()}).filter(e=>Boolean(e)):(console.warn("[Milkdown]: You are trying to collect inspection when inspector is disabled, please enable inspector by `editor.enableInspector()` first."),[])}static make(){return new xN}get ctx(){return w(mN,this)}get status(){return w(lN,this)}}var CN=200,SN=function(){};SN.prototype.append=function(e){return e.length?(e=SN.from(e),!this.length&&e||e.length<CN&&this.leafAppend(e)||this.length<CN&&e.leafPrepend(this)||this.appendInner(e)):this},SN.prototype.prepend=function(e){return e.length?SN.from(e).append(this):this},SN.prototype.appendInner=function(e){return new TN(this,e)},SN.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t?SN.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},SN.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},SN.prototype.forEach=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)},SN.prototype.map=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length);var r=[];return this.forEach(function(t,n){return r.push(e(t,n))},t,n),r},SN.from=function(e){return e instanceof SN?e:e&&e.length?new MN(e):SN.empty};var MN=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,n){return 0==e&&n==this.length?this:new t(this.values.slice(e,n))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,n,r){for(var o=t;o<n;o++)if(!1===e(this.values[o],r+o))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){for(var o=t-1;o>=n;o--)if(!1===e(this.values[o],r+o))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=CN)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=CN)return new t(e.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(SN);SN.empty=new MN([]);var TN=function(e){function t(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,n,r){var o=this.left.length;return!(t<o&&!1===this.left.forEachInner(e,t,Math.min(n,o),r))&&(!(n>o&&!1===this.right.forEachInner(e,Math.max(t-o,0),Math.min(this.length,n)-o,r+o))&&void 0)},t.prototype.forEachInvertedInner=function(e,t,n,r){var o=this.left.length;return!(t>o&&!1===this.right.forEachInvertedInner(e,t-o,Math.max(n,o)-o,r+o))&&(!(n<o&&!1===this.left.forEachInvertedInner(e,Math.min(t,o),n,r))&&void 0)},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var n=this.left.length;return t<=n?this.left.slice(e,t):e>=n?this.right.slice(e-n,t-n):this.left.slice(e,n).append(this.right.slice(0,t-n))},t.prototype.leafAppend=function(e){var n=this.right.leafAppend(e);if(n)return new t(this.left,n)},t.prototype.leafPrepend=function(e){var n=this.left.leafPrepend(e);if(n)return new t(n,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(SN);class ON{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(0==this.eventCount)return null;let n,r,o=this.items.length;for(;;o--){if(this.items.get(o-1).selection){--o;break}}t&&(n=this.remapping(o,this.items.length),r=n.maps.length);let i,a,s=e.tr,l=[],c=[];return this.items.forEach((e,t)=>{if(!e.step)return n||(n=this.remapping(o,t+1),r=n.maps.length),r--,void c.push(e);if(n){c.push(new _N(e.map));let t,o=e.step.map(n.slice(r));o&&s.maybeStep(o).doc&&(t=s.mapping.maps[s.mapping.maps.length-1],l.push(new _N(t,void 0,void 0,l.length+c.length))),r--,t&&n.appendMap(t,r)}else s.maybeStep(e.step);return e.selection?(i=n?e.selection.map(n.slice(r)):e.selection,a=new ON(this.items.slice(0,o).append(c.reverse().concat(l)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:a,transform:s,selection:i}}addTransform(e,t,n,r){let o=[],i=this.eventCount,a=this.items,s=!r&&a.length?a.get(a.length-1):null;for(let c=0;c<e.steps.length;c++){let n,l=e.steps[c].invert(e.docs[c]),u=new _N(e.mapping.maps[c],l,t);(n=s&&s.merge(u))&&(u=n,c?o.pop():a=a.slice(0,a.length-1)),o.push(u),t&&(i++,t=void 0),r||(s=u)}let l=i-n.depth;return l>EN&&(a=function(e,t){let n;return e.forEach((e,r)=>{if(e.selection&&0==t--)return n=r,!1}),e.slice(n)}(a,l),i-=l),new ON(a.append(o),i)}remapping(e,t){let n=new Bb;return this.items.forEach((t,r)=>{let o=null!=t.mirrorOffset&&r-t.mirrorOffset>=e?n.maps.length-t.mirrorOffset:void 0;n.appendMap(t.map,o)},e,t),n}addMaps(e){return 0==this.eventCount?this:new ON(this.items.append(e.map(e=>new _N(e))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let n=[],r=Math.max(0,this.items.length-t),o=e.mapping,i=e.steps.length,a=this.eventCount;this.items.forEach(e=>{e.selection&&a--},r);let s=t;this.items.forEach(t=>{let r=o.getMirror(--s);if(null==r)return;i=Math.min(i,r);let l=o.maps[r];if(t.step){let i=e.steps[r].invert(e.docs[r]),c=t.selection&&t.selection.map(o.slice(s+1,r));c&&a++,n.push(new _N(l,i,c))}else n.push(new _N(l))},r);let l=[];for(let d=t;d<i;d++)l.push(new _N(o.maps[d]));let c=this.items.slice(0,r).append(l).append(n),u=new ON(c,a);return u.emptyItemCount()>500&&(u=u.compress(this.items.length-n.length)),u}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),n=t.maps.length,r=[],o=0;return this.items.forEach((i,a)=>{if(a>=e)r.push(i),i.selection&&o++;else if(i.step){let e=i.step.map(t.slice(n)),a=e&&e.getMap();if(n--,a&&t.appendMap(a,n),e){let s=i.selection&&i.selection.map(t.slice(n));s&&o++;let l,c=new _N(a.invert(),e,s),u=r.length-1;(l=r.length&&r[u].merge(c))?r[u]=l:r.push(c)}}else i.map&&n--},this.items.length,0),new ON(SN.from(r.reverse()),o)}}ON.empty=new ON(SN.empty,0);class _N{constructor(e,t,n,r){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=r}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new _N(t.getMap().invert(),t,this.selection)}}}class NN{constructor(e,t,n,r,o){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=r,this.prevComposition=o}}const EN=20;function DN(e){let t=[];for(let n=e.length-1;n>=0&&0==t.length;n--)e[n].forEach((e,n,r,o)=>t.push(r,o));return t}function AN(e,t){if(!e)return null;let n=[];for(let r=0;r<e.length;r+=2){let o=t.map(e[r],1),i=t.map(e[r+1],-1);o<=i&&n.push(o,i)}return n}let $N=!1,RN=null;function LN(e){let t=e.plugins;if(RN!=t){$N=!1,RN=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){$N=!0;break}}return $N}const IN=new Hk("history"),PN=new Hk("closeHistory");function zN(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new jk({key:IN,state:{init:()=>new NN(ON.empty,ON.empty,null,0,-1),apply:(t,n,r)=>function(e,t,n,r){let o,i=n.getMeta(IN);if(i)return i.historyState;n.getMeta(PN)&&(e=new NN(e.done,e.undone,null,0,-1));let a=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(a&&a.getMeta(IN))return a.getMeta(IN).redo?new NN(e.done.addTransform(n,void 0,r,LN(t)),e.undone,DN(n.mapping.maps),e.prevTime,e.prevComposition):new NN(e.done,e.undone.addTransform(n,void 0,r,LN(t)),null,e.prevTime,e.prevComposition);if(!1===n.getMeta("addToHistory")||a&&!1===a.getMeta("addToHistory"))return(o=n.getMeta("rebased"))?new NN(e.done.rebased(n,o),e.undone.rebased(n,o),AN(e.prevRanges,n.mapping),e.prevTime,e.prevComposition):new NN(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),AN(e.prevRanges,n.mapping),e.prevTime,e.prevComposition);{let o=n.getMeta("composition"),i=0==e.prevTime||!a&&e.prevComposition!=o&&(e.prevTime<(n.time||0)-r.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach((e,r)=>{for(let o=0;o<t.length;o+=2)e<=t[o+1]&&r>=t[o]&&(n=!0)}),n}(n,e.prevRanges)),s=a?AN(e.prevRanges,n.mapping):DN(n.mapping.maps);return new NN(e.done.addTransform(n,i?t.selection.getBookmark():void 0,r,LN(t)),ON.empty,s,n.time,null==o?e.prevComposition:o)}}(n,r,t,e)},config:e,props:{handleDOMEvents:{beforeinput(e,t){let n=t.inputType,r="historyUndo"==n?FN:"historyRedo"==n?jN:null;return!!r&&(t.preventDefault(),r(e.state,e.dispatch))}}}})}function BN(e,t){return(n,r)=>{let o=IN.getState(n);if(!o||0==(e?o.undone:o.done).eventCount)return!1;if(r){let i=function(e,t,n){let r=LN(t),o=IN.get(t).spec.config,i=(n?e.undone:e.done).popEvent(t,r);if(!i)return null;let a=i.selection.resolve(i.transform.doc),s=(n?e.done:e.undone).addTransform(i.transform,t.selection.getBookmark(),o,r),l=new NN(n?s:i.remaining,n?i.remaining:s,null,0,-1);return i.transform.setSelection(a).setMeta(IN,{redo:n,historyState:l})}(o,n,e);i&&r(t?i.scrollIntoView():i)}return!0}}const FN=BN(!1,!0),jN=BN(!0,!0);let VN=e=>crypto.getRandomValues(new Uint8Array(e));function qN(e,t){const n=function(e="cmdKey"){return LM(()=>()=>!1,e)}(e),r=o=>async()=>{r.key=n,await o.wait(C_);const i=t(o);return o.get(k_).create(n,i),r.run=t=>o.get(k_).call(e,t),()=>{o.get(k_).remove(n)}};return r}function HN(e){const t=n=>async()=>{await n.wait(d_);const r=e(n);return n.update(t_,e=>[...e,r]),t.inputRule=r,()=>{n.update(t_,e=>e.filter(e=>e!==r))}};return t}function UN(e,t){const n=r=>async()=>{const o=t(r);return r.update(m_,t=>[...t.filter(t=>t[0]!==e),[e,o]]),n.id=e,n.schema=o,()=>{r.update(m_,t=>t.filter(([t])=>t!==e))}};return n.type=t=>{const n=t.get(h_).marks[e];if(!n)throw r=e,new xM(kM.missingMarkInSchema,`Missing mark in schema, milkdown cannot find "${r}" in schema.`);var r;return n},n}function WN(e,t){const n=r=>async()=>{const o=t(r);return r.update(f_,t=>[...t.filter(t=>t[0]!==e),[e,o]]),n.id=e,n.schema=o,()=>{r.update(f_,t=>t.filter(([t])=>t!==e))}};return n.type=t=>{const n=t.get(h_).nodes[e];if(!n)throw r=e,new xM(kM.missingNodeInSchema,`Missing node in schema, milkdown cannot find "${r}" in schema.`);var r;return n},n}function KN(e){let t;const n=n=>async()=>(await n.wait(d_),t=e(n),n.update(n_,e=>[...e,t]),()=>{n.update(n_,e=>e.filter(e=>e!==t))});return n.plugin=()=>t,n.key=()=>t.spec.key,n}function YN(e,t){const n=LM(e,t),r=e=>(e.inject(n),()=>()=>{e.remove(n)});return r.key=n,r}function JN(e,t){const n=YN(t,e),r=WN(e,e=>e.get(n.key)(e)),o=[n,r];return o.id=r.id,o.node=r,o.type=e=>r.type(e),o.ctx=n,o.key=n.key,o.extendSchema=n=>{const r=n(t);return JN(e,r)},o}function GN(e,t){const n=YN(t,e),r=UN(e,e=>e.get(n.key)(e)),o=[n,r];return o.id=r.id,o.mark=r,o.type=e=>r.type(e),o.ctx=n,o.key=n.key,o.extendSchema=n=>{const r=n(t);return GN(e,r)},o}function XN(e,t){const n=YN(Object.fromEntries(Object.entries(t).map(([e,{shortcuts:t,priority:n}])=>[e,{shortcuts:t,priority:n}])),`${e}Keymap`),r=function(e){const t=n=>async()=>{await n.wait(E_);const r=n.get(__),o=e(n),i=r.addObjectKeymap(o);return t.keymap=o,()=>{i()}};return t}(e=>{const r=e.get(n.key),o=Object.entries(t).flatMap(([e,{command:t}])=>{const n=r[e],o=[n.shortcuts].flat(),i=n.priority;return o.map(e=>[e,{key:e,onRun:t,priority:i}])});return Object.fromEntries(o)}),o=[n,r];return o.ctx=n,o.shortcuts=r,o.key=n.key,o.keymap=r.keymap,o}((e,t=21)=>{((e,t,n)=>{let r=(2<<Math.log2(e.length-1))-1,o=-~(1.6*r*t/e.length)})(e,0|t,VN)})("abcedfghicklmn",10);const ZN=(e,t=()=>({}))=>YN(t,`${e}Attr`),QN=(e,t=()=>({}))=>YN(t,`${e}Attr`);function eE(e,t,n){const r=YN(null!=n?n:{},e),o=e=>async()=>{await e.wait(c_);const n={plugin:t(e),options:e.get(r.key)};return e.update(r_,e=>[...e,n]),()=>{e.update(r_,e=>e.filter(e=>e!==n))}},i=[r,o];return i.id=e,i.plugin=o,i.options=r,i}function tE(e,t){return Object.assign(e,{meta:M({package:"@milkdown/plugin-history"},t)}),e}const nE=qN("Undo",()=>()=>FN);tE(nE,{displayName:"Command<undo>"});const rE=qN("Redo",()=>()=>jN);tE(rE,{displayName:"Command<redo>"});const oE=YN({},"historyProviderConfig");tE(oE,{displayName:"Ctx<historyProviderConfig>"});const iE=KN(e=>zN(e.get(oE.key)));tE(iE,{displayName:"Ctx<historyProviderPlugin>"});const aE=XN("historyKeymap",{Undo:{shortcuts:"Mod-z",command:e=>{const t=e.get(k_);return()=>t.call(nE.key)}},Redo:{shortcuts:["Mod-y","Shift-Mod-z"],command:e=>{const t=e.get(k_);return()=>t.call(rE.key)}}});tE(aE.ctx,{displayName:"KeymapCtx<history>"}),tE(aE.shortcuts,{displayName:"Keymap<history>"});const sE=[oE,iE,aE,nE,rE].flat();const lE="object"==typeof global&&global&&global.Object===Object&&global;var cE="object"==typeof self&&self&&self.Object===Object&&self;const uE=lE||cE||Function("return this")();const dE=uE.Symbol;var pE=Object.prototype,hE=pE.hasOwnProperty,fE=pE.toString,mE=dE?dE.toStringTag:void 0;var gE=Object.prototype.toString;var vE=dE?dE.toStringTag:void 0;function yE(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":vE&&vE in Object(e)?function(e){var t=hE.call(e,mE),n=e[mE];try{e[mE]=void 0;var r=!0}catch(Yo){}var o=fE.call(e);return r&&(t?e[mE]=n:delete e[mE]),o}(e):function(e){return gE.call(e)}(e)}var wE=/\s/;var bE=/^\s+/;function kE(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&wE.test(e.charAt(t)););return t}(e)+1).replace(bE,""):e}function xE(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var CE=/^[-+]0x[0-9a-f]+$/i,SE=/^0b[01]+$/i,ME=/^0o[0-7]+$/i,TE=parseInt;function OE(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return null!=e&&"object"==typeof e}(e)&&"[object Symbol]"==yE(e)}(e))return NaN;if(xE(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=xE(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=kE(e);var n=SE.test(e);return n||ME.test(e)?TE(e.slice(2),n?2:8):CE.test(e)?NaN:+e}const _E=function(){return uE.Date.now()};var NE=Math.max,EE=Math.min;function DE(e,t,n){var r,o,i,a,s,l,c=0,u=!1,d=!1,p=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function h(t){var n=r,i=o;return r=o=void 0,c=t,a=e.apply(i,n)}function f(e){var n=e-l;return void 0===l||n>=t||n<0||d&&e-c>=i}function m(){var e=_E();if(f(e))return g(e);s=setTimeout(m,function(e){var n=t-(e-l);return d?EE(n,i-(e-c)):n}(e))}function g(e){return s=void 0,p&&r?h(e):(r=o=void 0,a)}function v(){var e=_E(),n=f(e);if(r=arguments,o=this,l=e,n){if(void 0===s)return function(e){return c=e,s=setTimeout(m,t),u?h(e):a}(l);if(d)return clearTimeout(s),s=setTimeout(m,t),h(l)}return void 0===s&&(s=setTimeout(m,t)),a}return t=OE(t)||0,xE(n)&&(u=!!n.leading,i=(d="maxWait"in n)?NE(OE(n.maxWait)||0,t):i,p="trailing"in n?!!n.trailing:p),v.cancel=function(){void 0!==s&&clearTimeout(s),c=0,r=l=o=s=void 0},v.flush=function(){return void 0===s?a:g(_E())},v}class AE{constructor(){this.beforeMountedListeners=[],this.mountedListeners=[],this.updatedListeners=[],this.selectionUpdatedListeners=[],this.markdownUpdatedListeners=[],this.blurListeners=[],this.focusListeners=[],this.destroyListeners=[],this.beforeMount=e=>(this.beforeMountedListeners.push(e),this),this.mounted=e=>(this.mountedListeners.push(e),this),this.updated=e=>(this.updatedListeners.push(e),this)}get listeners(){return{beforeMount:this.beforeMountedListeners,mounted:this.mountedListeners,updated:this.updatedListeners,markdownUpdated:this.markdownUpdatedListeners,blur:this.blurListeners,focus:this.focusListeners,destroy:this.destroyListeners,selectionUpdated:this.selectionUpdatedListeners}}markdownUpdated(e){return this.markdownUpdatedListeners.push(e),this}blur(e){return this.blurListeners.push(e),this}focus(e){return this.focusListeners.push(e),this}destroy(e){return this.destroyListeners.push(e),this}selectionUpdated(e){return this.selectionUpdatedListeners.push(e),this}}const $E=LM(new AE,"listener"),RE=new Hk("MILKDOWN_LISTENER"),LE=e=>(e.inject($E,new AE),async()=>{await e.wait(c_);const t=e.get($E),{listeners:n}=t;n.beforeMount.forEach(t=>t(e)),await e.wait(P_);const r=e.get(F_);let o=null,i=null,a=null;const s=new jk({key:RE,view:()=>({destroy:()=>{n.destroy.forEach(t=>t(e))}}),props:{handleDOMEvents:{focus:()=>(n.focus.forEach(t=>t(e)),!1),blur:()=>(n.blur.forEach(t=>t(e)),!1)}},state:{init:(e,t)=>{o=t.doc,i=r(t.doc)},apply:t=>{const s=t.selection;if((!a&&s||a&&!s.eq(a))&&(n.selectionUpdated.forEach(t=>{t(e,s,a)}),a=s),!t.docChanged||!1===t.getMeta("addToHistory"))return;const l=DE(()=>{const{doc:a}=t;if(n.updated.length>0&&o&&!o.eq(a)&&n.updated.forEach(t=>{t(e,a,o)}),n.markdownUpdated.length>0&&o&&!o.eq(a)){const t=r(a);n.markdownUpdated.forEach(n=>{n(e,t,i)}),i=t}o=a},200);return l()}}});e.update(n_,e=>e.concat(s)),await e.wait(Q_),n.mounted.forEach(t=>t(e))});function IE(e){return function(t,n){let{$from:r,$to:o}=t.selection,i=r.blockRange(o,t=>t.childCount>0&&t.firstChild.type==e);return!!i&&(!n||(r.node(i.depth-1).type==e?function(e,t,n,r){let o=e.tr,i=r.end,a=r.$to.end(r.depth);i<a&&(o.step(new Jb(i-1,a,i,a,new $w(Ow.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Jw(o.doc.resolve(r.$from.pos),o.doc.resolve(a),r.depth));const s=Qb(r);if(null==s)return!1;o.lift(r,s);let l=o.doc.resolve(o.mapping.map(i,-1)-1);ik(o.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&o.join(l.pos);return t(o.scrollIntoView()),!0}(t,n,e,i):function(e,t,n){let r=e.tr,o=n.parent;for(let h=n.end,f=n.endIndex-1,m=n.startIndex;f>m;f--)h-=o.child(f).nodeSize,r.delete(h-1,h+1);let i=r.doc.resolve(n.start),a=i.nodeAfter;if(r.mapping.map(n.end)!=n.start+i.nodeAfter.nodeSize)return!1;let s=0==n.startIndex,l=n.endIndex==o.childCount,c=i.node(-1),u=i.index(-1);if(!c.canReplace(u+(s?0:1),u+1,a.content.append(l?Ow.empty:Ow.from(o))))return!1;let d=i.pos,p=d+a.nodeSize;return r.step(new Jb(d-(s?1:0),p+(l?1:0),d+1,p-1,new $w((s?Ow.empty:Ow.from(o.copy(Ow.empty))).append(l?Ow.empty:Ow.from(o.copy(Ow.empty))),s?0:1,l?0:1),s?0:1)),t(r.scrollIntoView()),!0}(t,n,i)))}}function PE(e){return String(e||"").toUpperCase()}function zE(){return function(e){const t=function(e){const t=new Map;if(!e||!e.type)throw new Error("mdast-util-definitions expected node");return _e(e,"definition",function(e){const n=PE(e.identifier);n&&!t.get(n)&&t.set(n,e)}),function(e){const n=PE(e);return t.get(n)}}(e);_e(e,function(e,n,r){if("definition"===e.type&&void 0!==r&&"number"==typeof n)return r.children.splice(n,1),[Ne,n];if("imageReference"===e.type||"linkReference"===e.type){const o=t(e.identifier);if(o&&r&&"number"==typeof n)return r.children[n]="imageReference"===e.type?{type:"image",url:o.url,title:o.title,alt:e.alt}:{type:"link",url:o.url,title:o.title,children:e.children},[Ne,n]}})}}function BE(e,t){var n;if(!(t.childCount>=1&&"hardbreak"===(null===(n=t.lastChild)||void 0===n?void 0:n.type.name)))return void e.next(t.content);const r=[];t.content.forEach((e,n,o)=>{o!==t.childCount-1&&r.push(e)}),e.next(Ow.fromArray(r))}function FE(e,t){return Object.assign(e,{meta:M({package:"@milkdown/preset-commonmark"},t)}),e}LE.meta={package:"@milkdown/plugin-listener",displayName:"Listener"};const jE=QN("emphasis");FE(jE,{displayName:"Attr<emphasis>",group:"Emphasis"});const VE=GN("emphasis",e=>({attrs:{marker:{default:e.get(s_).emphasis||"*",validate:"string"}},parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:e=>"italic"===e}],toDOM:t=>["em",e.get(jE.key)(t)],parseMarkdown:{match:e=>"emphasis"===e.type,runner:(e,t,n)=>{e.openMark(n,{marker:t.marker}),e.next(t.children),e.closeMark(n)}},toMarkdown:{match:e=>"emphasis"===e.type.name,runner:(e,t)=>{e.withMark(t,"emphasis",void 0,{marker:t.attrs.marker})}}}));FE(VE.mark,{displayName:"MarkSchema<emphasis>",group:"Emphasis"}),FE(VE.ctx,{displayName:"MarkSchemaCtx<emphasis>",group:"Emphasis"});const qE=qN("ToggleEmphasis",e=>()=>oO(VE.type(e)));FE(qE,{displayName:"Command<toggleEmphasisCommand>",group:"Emphasis"});const HE=HN(e=>TO(/(?:^|[^*])\*([^*]+)\*$/,VE.type(e),{getAttr:()=>({marker:"*"}),updateCaptured:({fullMatch:e,start:t})=>e.startsWith("*")?{}:{fullMatch:e.slice(1),start:t+1}}));FE(HE,{displayName:"InputRule<emphasis>|Star",group:"Emphasis"});const UE=HN(e=>TO(/\b_(?![_\s])(.*?[^_\s])_\b/,VE.type(e),{getAttr:()=>({marker:"_"}),updateCaptured:({fullMatch:e,start:t})=>e.startsWith("_")?{}:{fullMatch:e.slice(1),start:t+1}}));FE(UE,{displayName:"InputRule<emphasis>|Underscore",group:"Emphasis"});const WE=XN("emphasisKeymap",{ToggleEmphasis:{shortcuts:"Mod-i",command:e=>{const t=e.get(k_);return()=>t.call(qE.key)}}});FE(WE.ctx,{displayName:"KeymapCtx<emphasis>",group:"Emphasis"}),FE(WE.shortcuts,{displayName:"Keymap<emphasis>",group:"Emphasis"});const KE=QN("strong");FE(KE,{displayName:"Attr<strong>",group:"Strong"});const YE=GN("strong",e=>({attrs:{marker:{default:e.get(s_).strong||"*",validate:"string"}},parseDOM:[{tag:"b",getAttrs:e=>"normal"!=e.style.fontWeight&&null},{tag:"strong"},{style:"font-style",getAttrs:e=>"bold"===e},{style:"font-weight=400",clearMark:e=>"strong"==e.type.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],toDOM:t=>["strong",e.get(KE.key)(t)],parseMarkdown:{match:e=>"strong"===e.type,runner:(e,t,n)=>{e.openMark(n,{marker:t.marker}),e.next(t.children),e.closeMark(n)}},toMarkdown:{match:e=>"strong"===e.type.name,runner:(e,t)=>{e.withMark(t,"strong",void 0,{marker:t.attrs.marker})}}}));FE(YE.mark,{displayName:"MarkSchema<strong>",group:"Strong"}),FE(YE.ctx,{displayName:"MarkSchemaCtx<strong>",group:"Strong"});const JE=qN("ToggleStrong",e=>()=>oO(YE.type(e)));FE(JE,{displayName:"Command<toggleStrongCommand>",group:"Strong"});const GE=HN(e=>TO(new RegExp("(?<![\\w:/])(?:\\*\\*|__)([^*_]+?)(?:\\*\\*|__)(?![\\w/])$"),YE.type(e),{getAttr:e=>({marker:e[0].startsWith("*")?"*":"_"})}));FE(GE,{displayName:"InputRule<strong>",group:"Strong"});const XE=XN("strongKeymap",{ToggleBold:{shortcuts:["Mod-b"],command:e=>{const t=e.get(k_);return()=>t.call(JE.key)}}});FE(XE.ctx,{displayName:"KeymapCtx<strong>",group:"Strong"}),FE(XE.shortcuts,{displayName:"Keymap<strong>",group:"Strong"});const ZE=QN("inlineCode");FE(ZE,{displayName:"Attr<inlineCode>",group:"InlineCode"});const QE=GN("inlineCode",e=>({priority:100,code:!0,parseDOM:[{tag:"code"}],toDOM:t=>["code",e.get(ZE.key)(t)],parseMarkdown:{match:e=>"inlineCode"===e.type,runner:(e,t,n)=>{e.openMark(n),e.addText(t.value),e.closeMark(n)}},toMarkdown:{match:e=>"inlineCode"===e.type.name,runner:(e,t,n)=>{e.withMark(t,"inlineCode",n.text||"")}}}));FE(QE.mark,{displayName:"MarkSchema<inlineCode>",group:"InlineCode"}),FE(QE.ctx,{displayName:"MarkSchemaCtx<inlineCode>",group:"InlineCode"});const eD=qN("ToggleInlineCode",e=>()=>(t,n)=>{const{selection:r,tr:o}=t;if(r.empty)return!1;const{from:i,to:a}=r;if(t.doc.rangeHasMark(i,a,QE.type(e)))return null==n||n(o.removeMark(i,a,QE.type(e))),!0;const s=Object.keys(t.schema.marks).filter(e=>e!==QE.type.name);return s.map(e=>t.schema.marks[e]).forEach(e=>{o.removeMark(i,a,e)}),null==n||n(o.addMark(i,a,QE.type(e).create())),!0});FE(eD,{displayName:"Command<toggleInlineCodeCommand>",group:"InlineCode"});const tD=HN(e=>TO(/(?:`)([^`]+)(?:`)$/,QE.type(e)));FE(tD,{displayName:"InputRule<inlineCodeInputRule>",group:"InlineCode"});const nD=XN("inlineCodeKeymap",{ToggleInlineCode:{shortcuts:"Mod-e",command:e=>{const t=e.get(k_);return()=>t.call(eD.key)}}});FE(nD.ctx,{displayName:"KeymapCtx<inlineCode>",group:"InlineCode"}),FE(nD.shortcuts,{displayName:"Keymap<inlineCode>",group:"InlineCode"});const rD=QN("link");FE(rD,{displayName:"Attr<link>",group:"Link"});const oD=GN("link",e=>({attrs:{href:{validate:"string"},title:{default:null,validate:"string|null"}},parseDOM:[{tag:"a[href]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw OM(e);return{href:e.getAttribute("href"),title:e.getAttribute("title")}}}],toDOM:t=>["a",M(M({},e.get(rD.key)(t)),t.attrs)],parseMarkdown:{match:e=>"link"===e.type,runner:(e,t,n)=>{const r=t.url,o=t.title;e.openMark(n,{href:r,title:o}),e.next(t.children),e.closeMark(n)}},toMarkdown:{match:e=>"link"===e.type.name,runner:(e,t)=>{e.withMark(t,"link",void 0,{title:t.attrs.title,url:t.attrs.href})}}}));FE(oD.mark,{displayName:"MarkSchema<link>",group:"Link"});const iD=qN("ToggleLink",e=>(t={})=>oO(oD.type(e),t));FE(iD,{displayName:"Command<toggleLinkCommand>",group:"Link"});const aD=qN("UpdateLink",e=>(t={})=>(n,r)=>{if(!r)return!1;let o,i=-1;const{selection:a}=n,{from:s,to:l}=a;if(n.doc.nodesBetween(s,s===l?l+1:l,(t,n)=>{if(oD.type(e).isInSet(t.marks))return o=t,i=n,!1}),!o)return!1;const c=o.marks.find(({type:t})=>t===oD.type(e));if(!c)return!1;const u=i,d=i+o.nodeSize,{tr:p}=n,h=oD.type(e).create(M(M({},c.attrs),t));return!!h&&(r(p.removeMark(u,d,c).addMark(u,d,h).setSelection(new Tk(p.selection.$anchor)).scrollIntoView()),!0)});FE(aD,{displayName:"Command<updateLinkCommand>",group:"Link"});const sD=WN("doc",()=>({content:"block+",parseMarkdown:{match:({type:e})=>"root"===e,runner:(e,t,n)=>{e.injectRoot(t,n)}},toMarkdown:{match:e=>"doc"===e.type.name,runner:(e,t)=>{e.openNode("root"),e.next(t.content)}}}));function lD(e){return Ee(e,e=>{var t;return"html"===e.type&&["<br />","<br>","<br >","<br/>"].includes(null===(t=e.value)||void 0===t?void 0:t.trim())},(e,t)=>{if(!t.length)return;const n=t[t.length-1];if(!n)return;const r=n.children.indexOf(e);-1!==r&&n.children.splice(r,1)},!0)}FE(sD,{displayName:"NodeSchema<doc>",group:"Doc"});const cD=eE("remark-preserve-empty-line",()=>()=>lD);FE(cD.plugin,{displayName:"Remark<remarkPreserveEmptyLine>",group:"Remark"}),FE(cD.options,{displayName:"RemarkConfig<remarkPreserveEmptyLine>",group:"Remark"});const uD=ZN("paragraph");FE(uD,{displayName:"Attr<paragraph>",group:"Paragraph"});const dD=JN("paragraph",e=>({content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:t=>["p",e.get(uD.key)(t),0],parseMarkdown:{match:e=>"paragraph"===e.type,runner:(e,t,n)=>{e.openNode(n),t.children?e.next(t.children):e.addText(t.value||""),e.closeNode()}},toMarkdown:{match:e=>"paragraph"===e.type.name,runner:(t,n)=>{var r;const o=null===(r=e.get(XO).state)||void 0===r?void 0:r.doc.lastChild;t.openNode("paragraph"),n.content&&0!==n.content.size||n===o||!function(e){let t=!1;try{e.get(cD.id),t=!0}catch(n){t=!1}return t}(e)?BE(t,n):t.addNode("html",void 0,"<br />"),t.closeNode()}}}));FE(dD.node,{displayName:"NodeSchema<paragraph>",group:"Paragraph"}),FE(dD.ctx,{displayName:"NodeSchemaCtx<paragraph>",group:"Paragraph"});const pD=qN("TurnIntoText",e=>()=>rO(dD.type(e)));FE(pD,{displayName:"Command<turnIntoTextCommand>",group:"Paragraph"});const hD=XN("paragraphKeymap",{TurnIntoText:{shortcuts:"Mod-Alt-0",command:e=>{const t=e.get(k_);return()=>t.call(pD.key)}}});FE(hD.ctx,{displayName:"KeymapCtx<paragraph>",group:"Paragraph"}),FE(hD.shortcuts,{displayName:"Keymap<paragraph>",group:"Paragraph"});const fD=Array(6).fill(0).map((e,t)=>t+1);const mD=YN(function(e){return e.textContent.toLowerCase().trim().replace(/\s+/g,"-")},"headingIdGenerator");FE(mD,{displayName:"Ctx<HeadingIdGenerator>",group:"Heading"});const gD=ZN("heading");FE(gD,{displayName:"Attr<heading>",group:"Heading"});const vD=JN("heading",e=>{const t=e.get(mD.key);return{content:"inline*",group:"block",defining:!0,attrs:{id:{default:"",validate:"string"},level:{default:1,validate:"number"}},parseDOM:fD.map(e=>({tag:`h${e}`,getAttrs:t=>{if(!(t instanceof HTMLElement))throw OM(t);return{level:e,id:t.id}}})),toDOM:n=>[`h${n.attrs.level}`,M(M({},e.get(gD.key)(n)),{},{id:n.attrs.id||t(n)}),0],parseMarkdown:{match:({type:e})=>"heading"===e,runner:(e,t,n)=>{const r=t.depth;e.openNode(n,{level:r}),e.next(t.children),e.closeNode()}},toMarkdown:{match:e=>"heading"===e.type.name,runner:(e,t)=>{e.openNode("heading",void 0,{depth:t.attrs.level}),BE(e,t),e.closeNode()}}}});FE(vD.node,{displayName:"NodeSchema<heading>",group:"Heading"}),FE(vD.ctx,{displayName:"NodeSchemaCtx<heading>",group:"Heading"});const yD=HN(e=>fO(m(/^(#+)\s$/,{hashes:1}),vD.type(e),t=>{var n;const r=(null===(n=t.groups)||void 0===n||null===(n=n.hashes)||void 0===n?void 0:n.length)||0,o=e.get(XO),{$from:i}=o.state.selection,a=i.node();if("heading"===a.type.name){let e=Number(a.attrs.level)+Number(r);return e>6&&(e=6),{level:e}}return{level:r}}));FE(yD,{displayName:"InputRule<wrapInHeadingInputRule>",group:"Heading"});const wD=qN("WrapInHeading",e=>t=>(null!=t||(t=1),t<1?rO(dD.type(e)):rO(vD.type(e),{level:t})));FE(wD,{displayName:"Command<wrapInHeadingCommand>",group:"Heading"});const bD=qN("DowngradeHeading",e=>()=>(t,n,r)=>{const{$from:o}=t.selection,i=o.node();if(i.type!==vD.type(e)||!t.selection.empty||0!==o.parentOffset)return!1;const a=i.attrs.level-1;return a?(null==n||n(t.tr.setNodeMarkup(t.selection.$from.before(),void 0,M(M({},i.attrs),{},{level:a}))),!0):rO(dD.type(e))(t,n,r)});FE(bD,{displayName:"Command<downgradeHeadingCommand>",group:"Heading"});const kD=XN("headingKeymap",{TurnIntoH1:{shortcuts:"Mod-Alt-1",command:e=>{const t=e.get(k_);return()=>t.call(wD.key,1)}},TurnIntoH2:{shortcuts:"Mod-Alt-2",command:e=>{const t=e.get(k_);return()=>t.call(wD.key,2)}},TurnIntoH3:{shortcuts:"Mod-Alt-3",command:e=>{const t=e.get(k_);return()=>t.call(wD.key,3)}},TurnIntoH4:{shortcuts:"Mod-Alt-4",command:e=>{const t=e.get(k_);return()=>t.call(wD.key,4)}},TurnIntoH5:{shortcuts:"Mod-Alt-5",command:e=>{const t=e.get(k_);return()=>t.call(wD.key,5)}},TurnIntoH6:{shortcuts:"Mod-Alt-6",command:e=>{const t=e.get(k_);return()=>t.call(wD.key,6)}},DowngradeHeading:{shortcuts:["Delete","Backspace"],command:e=>{const t=e.get(k_);return()=>t.call(bD.key)}}});FE(kD.ctx,{displayName:"KeymapCtx<heading>",group:"Heading"}),FE(kD.shortcuts,{displayName:"Keymap<heading>",group:"Heading"});const xD=ZN("blockquote");FE(xD,{displayName:"Attr<blockquote>",group:"Blockquote"});const CD=JN("blockquote",e=>({content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:t=>["blockquote",e.get(xD.key)(t),0],parseMarkdown:{match:({type:e})=>"blockquote"===e,runner:(e,t,n)=>{e.openNode(n).next(t.children).closeNode()}},toMarkdown:{match:e=>"blockquote"===e.type.name,runner:(e,t)=>{e.openNode("blockquote").next(t.content).closeNode()}}}));FE(CD.node,{displayName:"NodeSchema<blockquote>",group:"Blockquote"}),FE(CD.ctx,{displayName:"NodeSchemaCtx<blockquote>",group:"Blockquote"});const SD=HN(e=>hO(/^\s*>\s$/,CD.type(e)));FE(SD,{displayName:"InputRule<wrapInBlockquoteInputRule>",group:"Blockquote"});const MD=qN("WrapInBlockquote",e=>()=>nO(CD.type(e)));FE(MD,{displayName:"Command<wrapInBlockquoteCommand>",group:"Blockquote"});const TD=XN("blockquoteKeymap",{WrapInBlockquote:{shortcuts:"Mod-Shift-b",command:e=>{const t=e.get(k_);return()=>t.call(MD.key)}}});FE(TD.ctx,{displayName:"KeymapCtx<blockquote>",group:"Blockquote"}),FE(TD.shortcuts,{displayName:"Keymap<blockquote>",group:"Blockquote"});const OD=ZN("codeBlock",()=>({pre:{},code:{}}));FE(OD,{displayName:"Attr<codeBlock>",group:"CodeBlock"});const _D=JN("code_block",e=>({content:"text*",group:"block",marks:"",defining:!0,code:!0,attrs:{language:{default:"",validate:"string"}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:e=>{if(!(e instanceof HTMLElement))throw OM(e);return{language:e.dataset.language}}}],toDOM:t=>{const n=e.get(OD.key)(t),r=t.attrs.language,o=r&&r.length>0?{"data-language":r}:void 0;return["pre",M(M({},n.pre),o),["code",n.code,0]]},parseMarkdown:{match:({type:e})=>"code"===e,runner:(e,t,n)=>{var r;const o=null!==(r=t.lang)&&void 0!==r?r:"",i=t.value;e.openNode(n,{language:o}),i&&e.addText(i),e.closeNode()}},toMarkdown:{match:e=>"code_block"===e.type.name,runner:(e,t)=>{var n;e.addNode("code",void 0,(null===(n=t.content.firstChild)||void 0===n?void 0:n.text)||"",{lang:t.attrs.language})}}}));FE(_D.node,{displayName:"NodeSchema<codeBlock>",group:"CodeBlock"}),FE(_D.ctx,{displayName:"NodeSchemaCtx<codeBlock>",group:"CodeBlock"});const ND=HN(e=>fO(m(/^```([a-z]*)?[\s\n]$/,{language:1}),_D.type(e),e=>{var t,n;return{language:null!==(t=null===(n=e.groups)||void 0===n?void 0:n.language)&&void 0!==t?t:""}}));FE(ND,{displayName:"InputRule<createCodeBlockInputRule>",group:"CodeBlock"});const ED=qN("CreateCodeBlock",e=>(t="")=>rO(_D.type(e),{language:t}));FE(ED,{displayName:"Command<createCodeBlockCommand>",group:"CodeBlock"});FE(qN("UpdateCodeBlockLanguage",()=>({pos:e,language:t}={pos:-1,language:""})=>(n,r)=>e>=0&&(null==r||r(n.tr.setNodeAttribute(e,"language",t)),!0)),{displayName:"Command<updateCodeBlockLanguageCommand>",group:"CodeBlock"});const DD=XN("codeBlockKeymap",{CreateCodeBlock:{shortcuts:"Mod-Alt-c",command:e=>{const t=e.get(k_);return()=>t.call(ED.key)}}});FE(DD.ctx,{displayName:"KeymapCtx<codeBlock>",group:"CodeBlock"}),FE(DD.shortcuts,{displayName:"Keymap<codeBlock>",group:"CodeBlock"});const AD=ZN("image");FE(AD,{displayName:"Attr<image>",group:"Image"});const $D=JN("image",e=>({inline:!0,group:"inline",selectable:!0,draggable:!0,marks:"",atom:!0,defining:!0,isolating:!0,attrs:{src:{default:"",validate:"string"},alt:{default:"",validate:"string"},title:{default:"",validate:"string"}},parseDOM:[{tag:"img[src]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw OM(e);return{src:e.getAttribute("src")||"",alt:e.getAttribute("alt")||"",title:e.getAttribute("title")||e.getAttribute("alt")||""}}}],toDOM:t=>["img",M(M({},e.get(AD.key)(t)),t.attrs)],parseMarkdown:{match:({type:e})=>"image"===e,runner:(e,t,n)=>{const r=t.url,o=t.alt,i=t.title;e.addNode(n,{src:r,alt:o,title:i})}},toMarkdown:{match:e=>"image"===e.type.name,runner:(e,t)=>{e.addNode("image",void 0,void 0,{title:t.attrs.title,url:t.attrs.src,alt:t.attrs.alt})}}}));FE($D.node,{displayName:"NodeSchema<image>",group:"Image"}),FE($D.ctx,{displayName:"NodeSchemaCtx<image>",group:"Image"});const RD=qN("InsertImage",e=>(t={})=>(n,r)=>{if(!r)return!0;const{src:o="",alt:i="",title:a=""}=t,s=$D.type(e).create({src:o,alt:i,title:a});return!s||(r(n.tr.replaceSelectionWith(s).scrollIntoView()),!0)});FE(RD,{displayName:"Command<insertImageCommand>",group:"Image"});const LD=qN("UpdateImage",e=>(t={})=>(n,r)=>{const o=PO(n.selection,$D.type(e));if(!o)return!1;const{node:i,pos:a}=o,s=M({},i.attrs),{src:l,alt:c,title:u}=t;return void 0!==l&&(s.src=l),void 0!==c&&(s.alt=c),void 0!==u&&(s.title=u),null==r||r(n.tr.setNodeMarkup(a,void 0,s).scrollIntoView()),!0});FE(LD,{displayName:"Command<updateImageCommand>",group:"Image"});const ID=HN(e=>new dO(m(/!\[(.*?)]\((.*?)\s*(?="|\))"?([^"]+)?"?\)/,{alt:1,filename:2,title:3}),(t,n,r,o)=>{const[i,a,s="",l]=n;return i?t.tr.replaceWith(r,o,$D.type(e).create({src:s,alt:a,title:l})):null}));FE(ID,{displayName:"InputRule<insertImageInputRule>",group:"Image"});const PD=ZN("hardbreak",e=>({"data-type":"hardbreak","data-is-inline":e.attrs.isInline}));FE(PD,{displayName:"Attr<hardbreak>",group:"Hardbreak"});const zD=JN("hardbreak",e=>({inline:!0,group:"inline",attrs:{isInline:{default:!1,validate:"boolean"}},selectable:!1,parseDOM:[{tag:"br"},{tag:'span[data-type="hardbreak"]',getAttrs:()=>({isInline:!0})}],toDOM:t=>t.attrs.isInline?["span",e.get(PD.key)(t)," "]:["br",e.get(PD.key)(t)],parseMarkdown:{match:({type:e})=>"break"===e,runner:(e,t,n)=>{var r;e.addNode(n,{isInline:Boolean(null===(r=t.data)||void 0===r?void 0:r.isInline)})}},leafText:()=>"\n",toMarkdown:{match:e=>"hardbreak"===e.type.name,runner:(e,t)=>{t.attrs.isInline?e.addNode("text",void 0,"\n"):e.addNode("break")}}}));FE(zD.node,{displayName:"NodeSchema<hardbreak>",group:"Hardbreak"}),FE(zD.ctx,{displayName:"NodeSchemaCtx<hardbreak>",group:"Hardbreak"});const BD=qN("InsertHardbreak",e=>()=>(t,n)=>{const{selection:r,tr:o}=t;if(!(r instanceof Tk))return!1;if(r.empty){var i;const e=r.$from.node();if(e.childCount>0&&"hardbreak"===(null===(i=e.lastChild)||void 0===i?void 0:i.type.name))return null==n||n(o.replaceRangeWith(r.to-1,r.to,t.schema.node("paragraph")).setSelection(xk.near(o.doc.resolve(r.to))).scrollIntoView()),!0}return null==n||n(o.setMeta("hardbreak",!0).replaceSelectionWith(zD.type(e).create()).scrollIntoView()),!0});FE(BD,{displayName:"Command<insertHardbreakCommand>",group:"Hardbreak"});const FD=XN("hardbreakKeymap",{InsertHardbreak:{shortcuts:"Shift-Enter",command:e=>{const t=e.get(k_);return()=>t.call(BD.key)}}});FE(FD.ctx,{displayName:"KeymapCtx<hardbreak>",group:"Hardbreak"}),FE(FD.shortcuts,{displayName:"Keymap<hardbreak>",group:"Hardbreak"});const jD=ZN("hr");FE(jD,{displayName:"Attr<hr>",group:"Hr"});const VD=JN("hr",e=>({group:"block",parseDOM:[{tag:"hr"}],toDOM:t=>["hr",e.get(jD.key)(t)],parseMarkdown:{match:({type:e})=>"thematicBreak"===e,runner:(e,t,n)=>{e.addNode(n)}},toMarkdown:{match:e=>"hr"===e.type.name,runner:e=>{e.addNode("thematicBreak")}}}));FE(VD.node,{displayName:"NodeSchema<hr>",group:"Hr"}),FE(VD.ctx,{displayName:"NodeSchemaCtx<hr>",group:"Hr"});const qD=HN(e=>new dO(/^(?:---|___\s|\*\*\*\s)$/,(t,n,r,o)=>{const{tr:i}=t;return n[0]&&i.replaceWith(r-1,o,VD.type(e).create()),i}));FE(qD,{displayName:"InputRule<insertHrInputRule>",group:"Hr"});const HD=qN("InsertHr",e=>()=>(t,n)=>{if(!n)return!0;const r=dD.node.type(e).create(),{tr:o,selection:i}=t,{from:a}=i,s=VD.type(e).create();if(!s)return!0;const l=o.replaceSelectionWith(s).insert(a,r),c=xk.findFrom(l.doc.resolve(a),1,!0);return!c||(n(l.setSelection(c).scrollIntoView()),!0)});FE(HD,{displayName:"Command<insertHrCommand>",group:"Hr"});const UD=ZN("bulletList");FE(UD,{displayName:"Attr<bulletList>",group:"BulletList"});const WD=JN("bullet_list",e=>({content:"listItem+",group:"block",attrs:{spread:{default:!1,validate:"boolean"}},parseDOM:[{tag:"ul",getAttrs:e=>{if(!(e instanceof HTMLElement))throw OM(e);return{spread:"true"===e.dataset.spread}}}],toDOM:t=>["ul",M(M({},e.get(UD.key)(t)),{},{"data-spread":t.attrs.spread}),0],parseMarkdown:{match:({type:e,ordered:t})=>"list"===e&&!t,runner:(e,t,n)=>{const r=null!=t.spread?`${t.spread}`:"false";e.openNode(n,{spread:r}).next(t.children).closeNode()}},toMarkdown:{match:e=>"bullet_list"===e.type.name,runner:(e,t)=>{e.openNode("list",void 0,{ordered:!1,spread:t.attrs.spread}).next(t.content).closeNode()}}}));FE(WD.node,{displayName:"NodeSchema<bulletList>",group:"BulletList"}),FE(WD.ctx,{displayName:"NodeSchemaCtx<bulletList>",group:"BulletList"});const KD=HN(e=>hO(/^\s*([-+*])\s$/,WD.type(e)));FE(KD,{displayName:"InputRule<wrapInBulletListInputRule>",group:"BulletList"});const YD=qN("WrapInBulletList",e=>()=>nO(WD.type(e)));FE(YD,{displayName:"Command<wrapInBulletListCommand>",group:"BulletList"});const JD=XN("bulletListKeymap",{WrapInBulletList:{shortcuts:"Mod-Alt-8",command:e=>{const t=e.get(k_);return()=>t.call(YD.key)}}});FE(JD.ctx,{displayName:"KeymapCtx<bulletListKeymap>",group:"BulletList"}),FE(JD.shortcuts,{displayName:"Keymap<bulletListKeymap>",group:"BulletList"});const GD=ZN("orderedList");FE(GD,{displayName:"Attr<orderedList>",group:"OrderedList"});const XD=JN("ordered_list",e=>({content:"listItem+",group:"block",attrs:{order:{default:1,validate:"number"},spread:{default:!1,validate:"boolean"}},parseDOM:[{tag:"ol",getAttrs:e=>{if(!(e instanceof HTMLElement))throw OM(e);return{spread:e.dataset.spread,order:e.hasAttribute("start")?Number(e.getAttribute("start")):1}}}],toDOM:t=>["ol",M(M(M({},e.get(GD.key)(t)),1===t.attrs.order?{}:t.attrs.order),{},{"data-spread":t.attrs.spread}),0],parseMarkdown:{match:({type:e,ordered:t})=>"list"===e&&!!t,runner:(e,t,n)=>{const r=null!=t.spread?`${t.spread}`:"true";e.openNode(n,{spread:r}).next(t.children).closeNode()}},toMarkdown:{match:e=>"ordered_list"===e.type.name,runner:(e,t)=>{e.openNode("list",void 0,{ordered:!0,start:1,spread:"true"===t.attrs.spread}),e.next(t.content),e.closeNode()}}}));FE(XD.node,{displayName:"NodeSchema<orderedList>",group:"OrderedList"}),FE(XD.ctx,{displayName:"NodeSchemaCtx<orderedList>",group:"OrderedList"});const ZD=HN(e=>hO(/^\s*(\d+)\.\s$/,XD.type(e),e=>({order:Number(e[1])}),(e,t)=>t.childCount+t.attrs.order===Number(e[1])));FE(ZD,{displayName:"InputRule<wrapInOrderedListInputRule>",group:"OrderedList"});const QD=qN("WrapInOrderedList",e=>()=>nO(XD.type(e)));FE(QD,{displayName:"Command<wrapInOrderedListCommand>",group:"OrderedList"});const eA=XN("orderedListKeymap",{WrapInOrderedList:{shortcuts:"Mod-Alt-7",command:e=>{const t=e.get(k_);return()=>t.call(QD.key)}}});FE(eA.ctx,{displayName:"KeymapCtx<orderedList>",group:"OrderedList"}),FE(eA.shortcuts,{displayName:"Keymap<orderedList>",group:"OrderedList"});const tA=ZN("listItem");FE(tA,{displayName:"Attr<listItem>",group:"ListItem"});const nA=JN("list_item",e=>({group:"listItem",content:"paragraph block*",attrs:{label:{default:"",validate:"string"},listType:{default:"bullet",validate:"string"},spread:{default:!0,validate:"boolean"}},defining:!0,parseDOM:[{tag:"li",getAttrs:e=>{if(!(e instanceof HTMLElement))throw OM(e);return{label:e.dataset.label,listType:e.dataset.listType,spread:"true"===e.dataset.spread}}}],toDOM:t=>["li",M(M({},e.get(tA.key)(t)),{},{"data-label":t.attrs.label,"data-list-type":t.attrs.listType,"data-spread":t.attrs.spread}),0],parseMarkdown:{match:({type:e})=>"listItem"===e,runner:(e,t,n)=>{const r=null!=t.label?`${t.label}.`:"",o=null!=t.label?"ordered":"bullet",i=null!=t.spread?`${t.spread}`:"true";e.openNode(n,{label:r,listType:o,spread:i}),e.next(t.children),e.closeNode()}},toMarkdown:{match:e=>"list_item"===e.type.name,runner:(e,t)=>{e.openNode("listItem",void 0,{spread:t.attrs.spread}),e.next(t.content),e.closeNode()}}}));FE(nA.node,{displayName:"NodeSchema<listItem>",group:"ListItem"}),FE(nA.ctx,{displayName:"NodeSchemaCtx<listItem>",group:"ListItem"});const rA=qN("SinkListItem",e=>()=>{return t=nA.type(e),function(e,n){let{$from:r,$to:o}=e.selection,i=r.blockRange(o,e=>e.childCount>0&&e.firstChild.type==t);if(!i)return!1;let a=i.startIndex;if(0==a)return!1;let s=i.parent,l=s.child(a-1);if(l.type!=t)return!1;if(n){let r=l.lastChild&&l.lastChild.type==s.type,o=Ow.from(r?t.create():null),a=new $w(Ow.from(t.create(null,Ow.from(s.type.create(null,o)))),r?3:1,0),c=i.start,u=i.end;n(e.tr.step(new Jb(c-(r?3:1),u,c,u,a,1,!0)).scrollIntoView())}return!0};var t});FE(rA,{displayName:"Command<sinkListItemCommand>",group:"ListItem"});const oA=qN("LiftListItem",e=>()=>IE(nA.type(e)));FE(oA,{displayName:"Command<liftListItemCommand>",group:"ListItem"});const iA=qN("SplitListItem",e=>()=>{return t=nA.type(e),function(e,r){let{$from:o,$to:i,node:a}=e.selection;if(a&&a.isBlock||o.depth<2||!o.sameParent(i))return!1;let s=o.node(-1);if(s.type!=t)return!1;if(0==o.parent.content.size&&o.node(-1).childCount==o.indexAfter(-1)){if(3==o.depth||o.node(-3).type!=t||o.index(-2)!=o.node(-2).childCount-1)return!1;if(r){let n=Ow.empty,i=o.index(-1)?1:o.index(-2)?2:3;for(let e=o.depth-i;e>=o.depth-3;e--)n=Ow.from(o.node(e).copy(n));let a=o.indexAfter(-1)<o.node(-2).childCount?1:o.indexAfter(-2)<o.node(-3).childCount?2:3;n=n.append(Ow.from(t.createAndFill()));let s=o.before(o.depth-(i-1)),l=e.tr.replace(s,o.after(-a),new $w(n,4-i,0)),c=-1;l.doc.nodesBetween(s,l.doc.content.size,(e,t)=>{if(c>-1)return!1;e.isTextblock&&0==e.content.size&&(c=t+1)}),c>-1&&l.setSelection(xk.near(l.doc.resolve(c))),r(l.scrollIntoView())}return!0}let l=i.pos==o.end()?s.contentMatchAt(0).defaultType:null,c=e.tr.delete(o.pos,i.pos),u=l?[n?{type:t,attrs:n}:null,{type:l}]:void 0;return!!ok(c.doc,o.pos,2,u)&&(r&&r(c.split(o.pos,2,u).scrollIntoView()),!0)};var t,n});FE(iA,{displayName:"Command<splitListItemCommand>",group:"ListItem"});const aA=qN("LiftFirstListItem",e=>()=>function(e){return(t,n,r)=>{const{selection:o}=t;if(!(o instanceof Tk))return!1;const{empty:i,$from:a}=o;return!(!i||0!==a.parentOffset)&&(a.node(-1).type===nA.type(e)&&qT(t,n,r))}}(e));FE(aA,{displayName:"Command<liftFirstListItemCommand>",group:"ListItem"});const sA=XN("listItemKeymap",{NextListItem:{shortcuts:"Enter",command:e=>{const t=e.get(k_);return()=>t.call(iA.key)}},SinkListItem:{shortcuts:["Tab","Mod-]"],command:e=>{const t=e.get(k_);return()=>t.call(rA.key)}},LiftListItem:{shortcuts:["Shift-Tab","Mod-["],command:e=>{const t=e.get(k_);return()=>t.call(oA.key)}},LiftFirstListItem:{shortcuts:["Backspace","Delete"],command:e=>{const t=e.get(k_);return()=>t.call(aA.key)}}});FE(sA.ctx,{displayName:"KeymapCtx<listItem>",group:"ListItem"}),FE(sA.shortcuts,{displayName:"Keymap<listItem>",group:"ListItem"});const lA=WN("text",()=>({group:"inline",parseMarkdown:{match:({type:e})=>"text"===e,runner:(e,t)=>{e.addText(t.value)}},toMarkdown:{match:e=>"text"===e.type.name,runner:(e,t)=>{e.addNode("text",void 0,t.text)}}}));FE(lA,{displayName:"NodeSchema<text>",group:"Text"});const cA=ZN("html");FE(cA,{displayName:"Attr<html>",group:"Html"});const uA=JN("html",e=>({atom:!0,group:"inline",inline:!0,attrs:{value:{default:"",validate:"string"}},toDOM:t=>{const n=document.createElement("span"),r=M(M({},e.get(cA.key)(t)),{},{"data-value":t.attrs.value,"data-type":"html"});return n.textContent=t.attrs.value,["span",r,t.attrs.value]},parseDOM:[{tag:'span[data-type="html"]',getAttrs:e=>{var t;return{value:null!==(t=e.dataset.value)&&void 0!==t?t:""}}}],parseMarkdown:{match:({type:e})=>Boolean("html"===e),runner:(e,t,n)=>{e.addNode(n,{value:t.value})}},toMarkdown:{match:e=>"html"===e.type.name,runner:(e,t)=>{e.addNode("html",void 0,t.attrs.value)}}}));FE(uA.node,{displayName:"NodeSchema<html>",group:"Html"}),FE(uA.ctx,{displayName:"NodeSchemaCtx<html>",group:"Html"});const dA=[sD,uD,dD,mD,gD,vD,PD,zD,xD,CD,OD,_D,jD,VD,AD,$D,UD,WD,GD,XD,tA,nA,jE,VE,KE,YE,ZE,QE,rD,oD,cA,uA,lA].flat(),pA=[SD,KD,ZD,ND,qD,yD].flat(),hA=[HE,UE,tD,GE],fA=qN("IsMarkSelected",()=>e=>t=>{if(!e)return!1;const{doc:n,selection:r}=t;return n.rangeHasMark(r.from,r.to,e)}),mA=qN("IsNoteSelected",()=>e=>t=>{if(!e)return!1;const n=((e,t)=>{const{selection:n,doc:r}=e;if(n instanceof _k)return{hasNode:n.node.type===t,pos:n.from,target:n.node};const{from:o,to:i}=n;let a=!1,s=-1,l=null;return r.nodesBetween(o,i,(e,n)=>!(l||e.type===t&&(a=!0,s=n,l=e,1))),{hasNode:a,pos:s,target:l}})(t,e);return n.hasNode}),gA=qN("ClearTextInCurrentBlock",()=>()=>(e,t)=>{let n=e.tr;const{$from:r,$to:o}=n.selection,{pos:i}=r,{pos:a}=o,s=i-r.node().content.size;return!(s<0)&&(n=n.deleteRange(s,a),null==t||t(n),!0)}),vA=qN("SetBlockType",()=>e=>(t,n)=>{const{nodeType:r,attrs:o=null}=null!=e?e:{};if(!r)return!1;const i=t.tr,{from:a,to:s}=i.selection;try{i.setBlockType(a,s,r,o)}catch(l){return!1}return null==n||n(i),!0}),yA=qN("WrapInBlockType",()=>e=>(t,n)=>{const{nodeType:r,attrs:o=null}=null!=e?e:{};if(!r)return!1;let i=t.tr;try{const{$from:e,$to:t}=i.selection,n=e.blockRange(t),a=n&&ek(n,r,o);if(!a)return!1;i=i.wrap(n,a)}catch(a){return!1}return null==n||n(i),!0}),wA=qN("AddBlockType",()=>e=>(t,n)=>{const{nodeType:r,attrs:o=null}=null!=e?e:{};if(!r)return!1;const i=t.tr;try{const e=r instanceof Xw?r:r.createAndFill(o);if(!e)return!1;i.replaceSelectionWith(e)}catch(a){return!1}return null==n||n(i),!0}),bA=qN("SelectTextNearPos",()=>e=>(t,n)=>{const{pos:r}=null!=e?e:{};if(null==r)return!1;const o=t.tr;try{const e=t.doc.resolve(((e,t,n)=>Math.min(Math.max(e,t),n))(r,0,t.doc.content.size));o.setSelection(Tk.near(e))}catch(i){return!1}return null==n||n(o.scrollIntoView()),!0}),kA=[pD,MD,wD,bD,ED,BD,HD,RD,LD,QD,YD,rA,iA,oA,aA,qE,eD,JE,iD,aD,fA,mA,gA,vA,yA,wA,bA],xA=[TD,DD,FD,kD,sA,eA,JD,hD,WE,nD,XE].flat(),CA=eE("remarkAddOrderInList",()=>()=>e=>{_e(e,"list",e=>{if(e.ordered){var t;const n=null!==(t=e.start)&&void 0!==t?t:1;e.children.forEach((e,t)=>{e.label=t+n})}})});FE(CA.plugin,{displayName:"Remark<remarkAddOrderInListPlugin>",group:"Remark"}),FE(CA.options,{displayName:"RemarkConfig<remarkAddOrderInListPlugin>",group:"Remark"});const SA=eE("remarkLineBreak",()=>()=>e=>{const t=/[\t ]*(?:\r?\n|\r)/g;_e(e,"text",(e,n,r)=>{if(!e.value||"string"!=typeof e.value)return;const o=[];let i=0;t.lastIndex=0;let a=t.exec(e.value);for(;a;){const n=a.index;i!==n&&o.push({type:"text",value:e.value.slice(i,n)}),o.push({type:"break",data:{isInline:!0}}),i=n+a[0].length,a=t.exec(e.value)}return o.length>0&&r&&"number"==typeof n?(i<e.value.length&&o.push({type:"text",value:e.value.slice(i)}),r.children.splice(n,1,...o),n+o.length):void 0})});FE(SA.plugin,{displayName:"Remark<remarkLineBreak>",group:"Remark"}),FE(SA.options,{displayName:"RemarkConfig<remarkLineBreak>",group:"Remark"});const MA=eE("remarkInlineLink",()=>zE);FE(MA.plugin,{displayName:"Remark<remarkInlineLinkPlugin>",group:"Remark"}),FE(MA.options,{displayName:"RemarkConfig<remarkInlineLinkPlugin>",group:"Remark"});const TA=["root","blockquote","listItem"],OA=eE("remarkHTMLTransformer",()=>()=>e=>{var t;t=(e,t,n)=>(e=>"html"===e.type)(e)?(n&&TA.includes(n.type)&&(e.children=[M({},e)],delete e.value,e.type="paragraph"),[e]):[e],function e(n,r,o){if((e=>!!e.children)(n)){const t=[];for(let r=0,o=n.children.length;r<o;r++){const o=n.children[r];if(o){const i=e(o,r,n);if(i)for(let e=0,n=i.length;e<n;e++){const n=i[e];n&&t.push(n)}}}n.children=t}return t(n,r,o)}(e,0,null)[0]});FE(OA.plugin,{displayName:"Remark<remarkHtmlTransformer>",group:"Remark"}),FE(OA.options,{displayName:"RemarkConfig<remarkHtmlTransformer>",group:"Remark"});const _A=eE("remarkMarker",()=>()=>(e,t)=>{_e(e,e=>["strong","emphasis"].includes(e.type),e=>{e.marker=(e=>t.value.charAt(e.position.start.offset))(e)})});FE(_A.plugin,{displayName:"Remark<remarkMarker>",group:"Remark"}),FE(_A.options,{displayName:"RemarkConfig<remarkMarker>",group:"Remark"});const NA=KN(()=>{let e=!1;const t=new Hk("MILKDOWN_INLINE_NODES_CURSOR"),n=new jk({key:t,state:{init:()=>!1,apply(e){if(!e.selection.empty)return!1;const t=e.selection.$from,n=t.nodeBefore,r=t.nodeAfter;return!(!(n&&r&&n.isInline&&!n.isText&&r.isInline)||r.isText)}},props:{handleDOMEvents:{compositionend:(t,r)=>!!e&&(e=!1,requestAnimationFrame(()=>{if(n.getState(t.state)){const e=t.state.selection.from;r.preventDefault(),t.dispatch(t.state.tr.insertText(r.data||"",e))}}),!0),compositionstart:t=>(n.getState(t.state)&&(e=!0),!1),beforeinput:(t,r)=>{if(n.getState(t.state)&&r instanceof InputEvent&&r.data&&!e){const e=t.state.selection.from;return r.preventDefault(),t.dispatch(t.state.tr.insertText(r.data||"",e)),!0}return!1}},decorations(e){if(n.getState(e)){const t=e.selection.$from.pos,n=document.createElement("span"),r=OS.widget(t,n,{side:-1}),o=document.createElement("span"),i=OS.widget(t,o);return setTimeout(()=>{n.contentEditable="true",o.contentEditable="true"}),ES.create(e.doc,[r,i])}return ES.empty}}});return n});FE(NA,{displayName:"Prose<inlineNodesCursorPlugin>",group:"Prose"});const EA=KN(e=>new jk({key:new Hk("MILKDOWN_HARDBREAK_MARKS"),appendTransaction:(t,n,r)=>{if(!t.length)return;const[o]=t;if(!o)return;const[i]=o.steps;if(o.getMeta("hardbreak")){if(!(i instanceof Yb))return;const{from:t}=i;return r.tr.setNodeMarkup(t,zD.type(e),void 0,[])}if(i instanceof Hb){let t=r.tr;const{from:n,to:o}=i;return r.doc.nodesBetween(n,o,(n,r)=>{n.type===zD.type(e)&&(t=t.setNodeMarkup(r,zD.type(e),void 0,[]))}),t}}}));FE(EA,{displayName:"Prose<hardbreakClearMarkPlugin>",group:"Prose"});const DA=YN(["table","code_block"],"hardbreakFilterNodes");FE(DA,{displayName:"Ctx<hardbreakFilterNodes>",group:"Prose"});const AA=KN(e=>{const t=e.get(DA.key);return new jk({key:new Hk("MILKDOWN_HARDBREAK_FILTER"),filterTransaction:(e,n)=>{const r=e.getMeta("hardbreak"),[o]=e.steps;if(r&&o){const{from:e}=o,r=n.doc.resolve(e);let i=r.depth,a=!0;for(;i>0;)t.includes(r.node(i).type.name)&&(a=!1),i--;return a}return!0}})});FE(AA,{displayName:"Prose<hardbreakFilterPlugin>",group:"Prose"});const $A=KN(e=>{const t=new Hk("MILKDOWN_HEADING_ID"),n=n=>{if(n.composing)return;const r=e.get(mD.key),o=n.state.tr.setMeta("addToHistory",!1);let i=!1;const a={};n.state.doc.descendants((n,s)=>{if(n.type===vD.type(e)){if(0===n.textContent.trim().length)return;const e=n.attrs;let l=r(n);a[l]?(a[l]+=1,l+=`-#${a[l]}`):a[l]=1,e.id!==l&&(i=!0,o.setMeta(t,!0).setNodeMarkup(s,void 0,M(M({},e),{},{id:l})))}}),i&&n.dispatch(o)};return new jk({key:t,view:e=>(n(e),{update:(e,t)=>{e.state.doc.eq(t.doc)||n(e)}})})});FE($A,{displayName:"Prose<syncHeadingIdPlugin>",group:"Prose"});const RA=KN(e=>new jk({key:new Hk("MILKDOWN_KEEP_LIST_ORDER"),appendTransaction:(t,n,r)=>{if(!r.selection||t.some(e=>!1===e.getMeta("addToHistory")||!e.isGeneric))return null;const o=XD.type(e),i=WD.type(e),a=nA.type(e),s=(e,t)=>{let n=!1;const r=`${t+1}.`;return e.label!==r&&(e.label=r,n=!0),n};let l=r.tr,c=!1;return r.doc.descendants((e,t,n,r)=>{if(e.type===i){const n=e.maybeChild(0);(null==n?void 0:n.type)===a&&"ordered"===n.attrs.listType&&(c=!0,l.setNodeMarkup(t,o,{spread:"true"}),e.descendants((e,t,n,r)=>{if(e.type===a){const n=M({},e.attrs);s(n,r)&&(l=l.setNodeMarkup(t,void 0,n))}return!1}))}else if(e.type===a&&(null==n?void 0:n.type)===o){const o=M({},e.attrs);let i=!1;"ordered"!==o.listType&&(o.listType="ordered",i=!0);(null==n?void 0:n.maybeChild(0))&&(i=s(o,r)),i&&(l=l.setNodeMarkup(t,void 0,o),c=!0)}}),c?l.setMeta("addToHistory",!1):null}}));FE(RA,{displayName:"Prose<syncListOrderPlugin>",group:"Prose"});const LA=[dA,pA,hA,kA,xA,[EA,DA,AA,NA,CA,MA,SA,OA,_A,cD,$A,RA].flat()].flat();var IA,PA;if("undefined"!=typeof WeakMap){let e=new WeakMap;IA=t=>e.get(t),PA=(t,n)=>(e.set(t,n),n)}else{const e=[],t=10;let n=0;IA=t=>{for(let n=0;n<e.length;n+=2)if(e[n]==t)return e[n+1]},PA=(r,o)=>(n==t&&(n=0),e[n++]=r,e[n++]=o)}var zA=class{constructor(e,t,n,r){this.width=e,this.height=t,this.map=n,this.problems=r}findCell(e){for(let t=0;t<this.map.length;t++){const n=this.map[t];if(n!=e)continue;const r=t%this.width,o=t/this.width|0;let i=r+1,a=o+1;for(let e=1;i<this.width&&this.map[t+e]==n;e++)i++;for(let e=1;a<this.height&&this.map[t+this.width*e]==n;e++)a++;return{left:r,top:o,right:i,bottom:a}}throw new RangeError(`No cell with offset ${e} found`)}colCount(e){for(let t=0;t<this.map.length;t++)if(this.map[t]==e)return t%this.width;throw new RangeError(`No cell with offset ${e} found`)}nextCell(e,t,n){const{left:r,right:o,top:i,bottom:a}=this.findCell(e);return"horiz"==t?(n<0?0==r:o==this.width)?null:this.map[i*this.width+(n<0?r-1:o)]:(n<0?0==i:a==this.height)?null:this.map[r+this.width*(n<0?i-1:a)]}rectBetween(e,t){const{left:n,right:r,top:o,bottom:i}=this.findCell(e),{left:a,right:s,top:l,bottom:c}=this.findCell(t);return{left:Math.min(n,a),top:Math.min(o,l),right:Math.max(r,s),bottom:Math.max(i,c)}}cellsInRect(e){const t=[],n={};for(let r=e.top;r<e.bottom;r++)for(let o=e.left;o<e.right;o++){const i=r*this.width+o,a=this.map[i];n[a]||(n[a]=!0,o==e.left&&o&&this.map[i-1]==a||r==e.top&&r&&this.map[i-this.width]==a||t.push(a))}return t}positionAt(e,t,n){for(let r=0,o=0;;r++){const i=o+n.child(r).nodeSize;if(r==e){let n=t+e*this.width;const r=(e+1)*this.width;for(;n<r&&this.map[n]<o;)n++;return n==r?i-1:this.map[n]}o=i}}static get(e){return IA(e)||PA(e,function(e){if("table"!=e.type.spec.tableRole)throw new RangeError("Not a table node: "+e.type.name);const t=function(e){let t=-1,n=!1;for(let r=0;r<e.childCount;r++){const o=e.child(r);let i=0;if(n)for(let t=0;t<r;t++){const n=e.child(t);for(let e=0;e<n.childCount;e++){const o=n.child(e);t+o.attrs.rowspan>r&&(i+=o.attrs.colspan)}}for(let e=0;e<o.childCount;e++){const t=o.child(e);i+=t.attrs.colspan,t.attrs.rowspan>1&&(n=!0)}-1==t?t=i:t!=i&&(t=Math.max(t,i))}return t}(e),n=e.childCount,r=[];let o=0,i=null;const a=[];for(let c=0,u=t*n;c<u;c++)r[c]=0;for(let c=0,u=0;c<n;c++){const s=e.child(c);u++;for(let e=0;;e++){for(;o<r.length&&0!=r[o];)o++;if(e==s.childCount)break;const l=s.child(e),{colspan:d,rowspan:p,colwidth:h}=l.attrs;for(let e=0;e<p;e++){if(e+c>=n){(i||(i=[])).push({type:"overlong_rowspan",pos:u,n:p-e});break}const s=o+e*t;for(let e=0;e<d;e++){0==r[s+e]?r[s+e]=u:(i||(i=[])).push({type:"collision",row:c,pos:u,n:d-e});const n=h&&h[e];if(n){const r=(s+e)%t*2,o=a[r];null==o||o!=n&&1==a[r+1]?(a[r]=n,a[r+1]=1):o==n&&a[r+1]++}}}o+=d,u+=l.nodeSize}const l=(c+1)*t;let d=0;for(;o<l;)0==r[o++]&&d++;d&&(i||(i=[])).push({type:"missing",row:c,n:d}),u++}0!==t&&0!==n||(i||(i=[])).push({type:"zero_sized"});const s=new zA(t,n,r,i);let l=!1;for(let c=0;!l&&c<a.length;c+=2)null!=a[c]&&a[c+1]<n&&(l=!0);l&&function(e,t,n){e.problems||(e.problems=[]);const r={};for(let o=0;o<e.map.length;o++){const i=e.map[o];if(r[i])continue;r[i]=!0;const a=n.nodeAt(i);if(!a)throw new RangeError(`No cell with offset ${i} found`);let s=null;const l=a.attrs;for(let n=0;n<l.colspan;n++){const r=t[2*((o+n)%e.width)];null==r||l.colwidth&&l.colwidth[n]==r||((s||(s=BA(l)))[n]=r)}s&&e.problems.unshift({type:"colwidth mismatch",pos:i,colwidth:s})}}(s,a,e);return s}(e))}};function BA(e){if(e.colwidth)return e.colwidth.slice();const t=[];for(let n=0;n<e.colspan;n++)t.push(0);return t}function FA(e,t){if("string"==typeof e)return{};const n=e.getAttribute("data-colwidth"),r=n&&/^\d+(,\d+)*$/.test(n)?n.split(",").map(e=>Number(e)):null,o=Number(e.getAttribute("colspan")||1),i={colspan:o,rowspan:Number(e.getAttribute("rowspan")||1),colwidth:r&&r.length==o?r:null};for(const a in t){const n=t[a].getFromDOM,r=n&&n(e);null!=r&&(i[a]=r)}return i}function jA(e,t){const n={};1!=e.attrs.colspan&&(n.colspan=e.attrs.colspan),1!=e.attrs.rowspan&&(n.rowspan=e.attrs.rowspan),e.attrs.colwidth&&(n["data-colwidth"]=e.attrs.colwidth.join(","));for(const r in t){const o=t[r].setDOMAttr;o&&o(e.attrs[r],n)}return n}function VA(e){if(null!==e){if(!Array.isArray(e))throw new TypeError("colwidth must be null or an array");for(const t of e)if("number"!=typeof t)throw new TypeError("colwidth must be null or an array of numbers")}}function qA(e){let t=e.cached.tableNodeTypes;if(!t){t=e.cached.tableNodeTypes={};for(const n in e.nodes){const r=e.nodes[n],o=r.spec.tableRole;o&&(t[o]=r)}}return t}var HA=new Hk("selectingCells");function UA(e){for(let t=e.depth-1;t>0;t--)if("row"==e.node(t).type.spec.tableRole)return e.node(0).resolve(e.before(t+1));return null}function WA(e){const t=e.selection.$head;for(let n=t.depth;n>0;n--)if("row"==t.node(n).type.spec.tableRole)return!0;return!1}function KA(e){const t=e.selection;if("$anchorCell"in t&&t.$anchorCell)return t.$anchorCell.pos>t.$headCell.pos?t.$anchorCell:t.$headCell;if("node"in t&&t.node&&"cell"==t.node.type.spec.tableRole)return t.$anchor;const n=UA(t.$head)||function(e){for(let t=e.nodeAfter,n=e.pos;t;t=t.firstChild,n++){const r=t.type.spec.tableRole;if("cell"==r||"header_cell"==r)return e.doc.resolve(n)}for(let t=e.nodeBefore,n=e.pos;t;t=t.lastChild,n--){const r=t.type.spec.tableRole;if("cell"==r||"header_cell"==r)return e.doc.resolve(n-t.nodeSize)}}(t.$head);if(n)return n;throw new RangeError(`No cell found around position ${t.head}`)}function YA(e){return"row"==e.parent.type.spec.tableRole&&!!e.nodeAfter}function JA(e,t){return e.depth==t.depth&&e.pos>=t.start(-1)&&e.pos<=t.end(-1)}function GA(e,t,n){const r=e.node(-1),o=zA.get(r),i=e.start(-1),a=o.nextCell(e.pos-i,t,n);return null==a?null:e.node(0).resolve(i+a)}function XA(e,t,n=1){const r=M(M({},e),{},{colspan:e.colspan-n});return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(t,n),r.colwidth.some(e=>e>0)||(r.colwidth=null)),r}function ZA(e,t,n=1){const r=M(M({},e),{},{colspan:e.colspan+n});if(r.colwidth){r.colwidth=r.colwidth.slice();for(let e=0;e<n;e++)r.colwidth.splice(t,0,0)}return r}var QA=class e extends xk{constructor(e,t=e){const n=e.node(-1),r=zA.get(n),o=e.start(-1),i=r.rectBetween(e.pos-o,t.pos-o),a=e.node(0),s=r.cellsInRect(i).filter(e=>e!=t.pos-o);s.unshift(t.pos-o);const l=s.map(e=>{const t=n.nodeAt(e);if(!t)throw RangeError(`No cell with offset ${e} found`);const r=o+e+1;return new Ck(a.resolve(r),a.resolve(r+t.content.size))});super(l[0].$from,l[0].$to,l),this.$anchorCell=e,this.$headCell=t}map(t,n){const r=t.resolve(n.map(this.$anchorCell.pos)),o=t.resolve(n.map(this.$headCell.pos));if(YA(r)&&YA(o)&&JA(r,o)){const t=this.$anchorCell.node(-1)!=r.node(-1);return t&&this.isRowSelection()?e.rowSelection(r,o):t&&this.isColSelection()?e.colSelection(r,o):new e(r,o)}return Tk.between(r,o)}content(){const e=this.$anchorCell.node(-1),t=zA.get(e),n=this.$anchorCell.start(-1),r=t.rectBetween(this.$anchorCell.pos-n,this.$headCell.pos-n),o={},i=[];for(let s=r.top;s<r.bottom;s++){const n=[];for(let i=s*t.width+r.left,a=r.left;a<r.right;a++,i++){const a=t.map[i];if(o[a])continue;o[a]=!0;const s=t.findCell(a);let l=e.nodeAt(a);if(!l)throw RangeError(`No cell with offset ${a} found`);const c=r.left-s.left,u=s.right-r.right;if(c>0||u>0){let e=l.attrs;if(c>0&&(e=XA(e,0,c)),u>0&&(e=XA(e,e.colspan-u,u)),s.left<r.left){if(l=l.type.createAndFill(e),!l)throw RangeError(`Could not create cell with attrs ${JSON.stringify(e)}`)}else l=l.type.create(e,l.content)}if(s.top<r.top||s.bottom>r.bottom){const e=M(M({},l.attrs),{},{rowspan:Math.min(s.bottom,r.bottom)-Math.max(s.top,r.top)});l=s.top<r.top?l.type.createAndFill(e):l.type.create(e,l.content)}n.push(l)}i.push(e.child(s).copy(Ow.from(n)))}const a=this.isColSelection()&&this.isRowSelection()?e:i;return new $w(Ow.from(a),1,1)}replace(e,t=$w.empty){const n=e.steps.length,r=this.ranges;for(let i=0;i<r.length;i++){const{$from:o,$to:a}=r[i],s=e.mapping.slice(n);e.replace(s.map(o.pos),s.map(a.pos),i?$w.empty:t)}const o=xk.findFrom(e.doc.resolve(e.mapping.slice(n).map(this.to)),-1);o&&e.setSelection(o)}replaceWith(e,t){this.replace(e,new $w(Ow.from(t),0,0))}forEachCell(e){const t=this.$anchorCell.node(-1),n=zA.get(t),r=this.$anchorCell.start(-1),o=n.cellsInRect(n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r));for(let i=0;i<o.length;i++)e(t.nodeAt(o[i]),r+o[i])}isColSelection(){const e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);if(Math.min(e,t)>0)return!1;const n=e+this.$anchorCell.nodeAfter.attrs.rowspan,r=t+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(n,r)==this.$headCell.node(-1).childCount}static colSelection(t,n=t){const r=t.node(-1),o=zA.get(r),i=t.start(-1),a=o.findCell(t.pos-i),s=o.findCell(n.pos-i),l=t.node(0);return a.top<=s.top?(a.top>0&&(t=l.resolve(i+o.map[a.left])),s.bottom<o.height&&(n=l.resolve(i+o.map[o.width*(o.height-1)+s.right-1]))):(s.top>0&&(n=l.resolve(i+o.map[s.left])),a.bottom<o.height&&(t=l.resolve(i+o.map[o.width*(o.height-1)+a.right-1]))),new e(t,n)}isRowSelection(){const e=this.$anchorCell.node(-1),t=zA.get(e),n=this.$anchorCell.start(-1),r=t.colCount(this.$anchorCell.pos-n),o=t.colCount(this.$headCell.pos-n);if(Math.min(r,o)>0)return!1;const i=r+this.$anchorCell.nodeAfter.attrs.colspan,a=o+this.$headCell.nodeAfter.attrs.colspan;return Math.max(i,a)==t.width}eq(t){return t instanceof e&&t.$anchorCell.pos==this.$anchorCell.pos&&t.$headCell.pos==this.$headCell.pos}static rowSelection(t,n=t){const r=t.node(-1),o=zA.get(r),i=t.start(-1),a=o.findCell(t.pos-i),s=o.findCell(n.pos-i),l=t.node(0);return a.left<=s.left?(a.left>0&&(t=l.resolve(i+o.map[a.top*o.width])),s.right<o.width&&(n=l.resolve(i+o.map[o.width*(s.top+1)-1]))):(s.left>0&&(n=l.resolve(i+o.map[s.top*o.width])),a.right<o.width&&(t=l.resolve(i+o.map[o.width*(a.top+1)-1]))),new e(t,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(t,n){return new e(t.resolve(n.anchor),t.resolve(n.head))}static create(t,n,r=n){return new e(t.resolve(n),t.resolve(r))}getBookmark(){return new e$(this.$anchorCell.pos,this.$headCell.pos)}};QA.prototype.visible=!1,xk.jsonID("cell",QA);var e$=class e{constructor(e,t){this.anchor=e,this.head=t}map(t){return new e(t.map(this.anchor),t.map(this.head))}resolve(e){const t=e.resolve(this.anchor),n=e.resolve(this.head);return"row"==t.parent.type.spec.tableRole&&"row"==n.parent.type.spec.tableRole&&t.index()<t.parent.childCount&&n.index()<n.parent.childCount&&JA(t,n)?new QA(t,n):xk.near(n,1)}};function t$(e){if(!(e.selection instanceof QA))return null;const t=[];return e.selection.forEachCell((e,n)=>{t.push(OS.node(n,n+e.nodeSize,{class:"selectedCell"}))}),ES.create(e.doc,t)}var n$=new Hk("fix-tables");function r$(e,t,n,r){const o=e.childCount,i=t.childCount;e:for(let a=0,s=0;a<i;a++){const i=t.child(a);for(let t=s,r=Math.min(o,a+3);t<r;t++)if(e.child(t)==i){s=t+1,n+=i.nodeSize;continue e}r(i,n),s<o&&e.child(s).sameMarkup(i)?r$(e.child(s),i,n+1,r):i.nodesBetween(0,i.content.size,r,n+1),n+=i.nodeSize}}function o$(e,t){let n;const r=(t,r)=>{"table"==t.type.spec.tableRole&&(n=function(e,t,n,r){const o=zA.get(t);if(!o.problems)return r;r||(r=e.tr);const i=[];for(let l=0;l<o.height;l++)i.push(0);for(let l=0;l<o.problems.length;l++){const e=o.problems[l];if("collision"==e.type){const o=t.nodeAt(e.pos);if(!o)continue;const a=o.attrs;for(let t=0;t<a.rowspan;t++)i[e.row+t]+=e.n;r.setNodeMarkup(r.mapping.map(n+1+e.pos),null,XA(a,a.colspan-e.n,e.n))}else if("missing"==e.type)i[e.row]+=e.n;else if("overlong_rowspan"==e.type){const o=t.nodeAt(e.pos);if(!o)continue;r.setNodeMarkup(r.mapping.map(n+1+e.pos),null,M(M({},o.attrs),{},{rowspan:o.attrs.rowspan-e.n}))}else if("colwidth mismatch"==e.type){const o=t.nodeAt(e.pos);if(!o)continue;r.setNodeMarkup(r.mapping.map(n+1+e.pos),null,M(M({},o.attrs),{},{colwidth:e.colwidth}))}else if("zero_sized"==e.type){const e=r.mapping.map(n);r.delete(e,e+t.nodeSize)}}let a,s;for(let l=0;l<i.length;l++)i[l]&&(null==a&&(a=l),s=l);for(let l=0,c=n+1;l<o.height;l++){const n=t.child(l),o=c+n.nodeSize,u=i[l];if(u>0){let t="cell";n.firstChild&&(t=n.firstChild.type.spec.tableRole);const i=[];for(let n=0;n<u;n++){const n=qA(e.schema)[t].createAndFill();n&&i.push(n)}const d=0!=l&&a!=l-1||s!=l?o-1:c+1;r.insert(r.mapping.map(d),i)}c=o}return r.setMeta(n$,{fixTables:!0})}(e,t,r,n))};return t?t.doc!=e.doc&&r$(t.doc,e.doc,0,r):e.doc.descendants(r),n}function i$(e){const t=zA.get(e),n=[],r=t.height,o=t.width;for(let i=0;i<r;i++){const r=[];for(let n=0;n<o;n++){const a=i*o+n,s=t.map[a];if(i>0){const e=a-o;if(s===t.map[e]){r.push(null);continue}}if(n>0){const e=a-1;if(s===t.map[e]){r.push(null);continue}}r.push(e.nodeAt(s))}n.push(r)}return n}function a$(e,t){const n=[],r=zA.get(e),o=r.height,i=r.width;for(let a=0;a<o;a++){const o=e.child(a),s=[];for(let n=0;n<i;n++){const o=t[a][n];if(!o)continue;const i=r.map[a*r.width+n],l=e.nodeAt(i);if(!l)continue;const c=l.type.createChecked(o.attrs,o.content,o.marks);s.push(c)}const l=o.type.createChecked(o.attrs,s,o.marks);n.push(l)}return e.type.createChecked(e.attrs,n,e.marks)}function s$(e){return function(e,t){for(let n=t.depth;n>=0;n-=1){const r=t.node(n);if(e(r)){return{node:r,pos:0===n?0:t.before(n),start:t.start(n),depth:n}}}return null}(e=>"table"===e.type.spec.tableRole,e)}function l$(e,t){const n=s$(t.$from);if(!n)return;const r=zA.get(n.node);if(e<0||e>r.width-1)return;return r.cellsInRect({left:e,right:e+1,top:0,bottom:r.height}).map(e=>{const t=n.node.nodeAt(e),r=e+n.start;return{pos:r,start:r+1,node:t,depth:n.depth+2}})}function c$(e,t){const n=s$(t.$from);if(!n)return;const r=zA.get(n.node);if(e<0||e>r.height-1)return;return r.cellsInRect({left:0,right:r.width,top:e,bottom:e+1}).map(e=>{const t=n.node.nodeAt(e),r=e+n.start;return{pos:r,start:r+1,node:t,depth:n.depth+2}})}function u$(e,t,n=t){let r=t,o=n;for(let u=t;u>=0;u--){const t=l$(u,e.selection);t&&t.forEach(e=>{const t=e.node.attrs.colspan+u-1;t>=r&&(r=u),t>o&&(o=t)})}for(let u=t;u<=o;u++){const t=l$(u,e.selection);t&&t.forEach(e=>{const t=e.node.attrs.colspan+u-1;e.node.attrs.colspan>1&&t>o&&(o=t)})}const i=[];for(let u=r;u<=o;u++){const t=l$(u,e.selection);t&&t.length>0&&i.push(u)}r=i[0],o=i[i.length-1];const a=l$(r,e.selection),s=c$(0,e.selection);if(!a||!s)return;const l=e.doc.resolve(a[a.length-1].pos);let c;for(let u=o;u>=r;u--){const t=l$(u,e.selection);if(t&&t.length>0){for(let e=s.length-1;e>=0;e--)if(s[e].pos===t[0].pos){c=t[0];break}if(c)break}}if(!c)return;return{$anchor:l,$head:e.doc.resolve(c.pos),indexes:i}}function d$(e,t,n=t){let r=t,o=n;for(let u=t;u>=0;u--){const t=c$(u,e.selection);t&&t.forEach(e=>{const t=e.node.attrs.rowspan+u-1;t>=r&&(r=u),t>o&&(o=t)})}for(let u=t;u<=o;u++){const t=c$(u,e.selection);t&&t.forEach(e=>{const t=e.node.attrs.rowspan+u-1;e.node.attrs.rowspan>1&&t>o&&(o=t)})}const i=[];for(let u=r;u<=o;u++){const t=c$(u,e.selection);t&&t.length>0&&i.push(u)}r=i[0],o=i[i.length-1];const a=c$(r,e.selection),s=l$(0,e.selection);if(!a||!s)return;const l=e.doc.resolve(a[a.length-1].pos);let c;for(let u=o;u>=r;u--){const t=c$(u,e.selection);if(t&&t.length>0){for(let e=s.length-1;e>=0;e--)if(s[e].pos===t[0].pos){c=t[0];break}if(c)break}}if(!c)return;return{$anchor:l,$head:e.doc.resolve(c.pos),indexes:i}}function p$(e,t,n,r){const o=t[0]>n[0]?-1:1,i=e.splice(t[0],t.length),a=i.length%2==0?1:0;let s;return s=-1===r&&1===o?n[0]-1:1===r&&-1===o?n[n.length-1]-a+1:-1===o?n[0]:n[n.length-1]-a,e.splice(s,0,...i),e}function h$(e){return e[0].map((t,n)=>e.map(e=>e[n]))}function f$(e){var t,n;const{tr:r,originIndex:o,targetIndex:i,select:a,pos:s}=e,l=s$(r.doc.resolve(s));if(!l)return!1;const c=null==(t=u$(r,o))?void 0:t.indexes,u=null==(n=u$(r,i))?void 0:n.indexes;if(!c||!u)return!1;if(c.includes(i))return!1;const d=function(e,t,n,r){let o=h$(i$(e));return o=p$(o,t,n,r),o=h$(o),a$(e,o)}(l.node,c,u,0);if(r.replaceWith(l.pos,l.pos+l.node.nodeSize,d),!a)return!0;const p=zA.get(d),h=l.start,f=i,m=p.positionAt(p.height-1,f,d),g=r.doc.resolve(h+m),v=p.positionAt(0,f,d),y=r.doc.resolve(h+v);return r.setSelection(QA.colSelection(g,y)),!0}function m$(e){var t,n;const{tr:r,originIndex:o,targetIndex:i,select:a,pos:s}=e,l=s$(r.doc.resolve(s));if(!l)return!1;const c=null==(t=d$(r,o))?void 0:t.indexes,u=null==(n=d$(r,i))?void 0:n.indexes;if(!c||!u)return!1;if(c.includes(i))return!1;const d=function(e,t,n,r){let o=i$(e);return o=p$(o,t,n,r),a$(e,o)}(l.node,c,u,0);if(r.replaceWith(l.pos,l.pos+l.node.nodeSize,d),!a)return!0;const p=zA.get(d),h=l.start,f=i,m=p.positionAt(f,p.width-1,d),g=r.doc.resolve(h+m),v=p.positionAt(f,0,d),y=r.doc.resolve(h+v);return r.setSelection(QA.rowSelection(g,y)),!0}function g$(e){const t=e.selection,n=KA(e),r=n.node(-1),o=n.start(-1),i=zA.get(r);return M(M({},t instanceof QA?i.rectBetween(t.$anchorCell.pos-o,t.$headCell.pos-o):i.findCell(n.pos-o)),{},{tableStart:o,map:i,table:r})}function v$(e,{map:t,tableStart:n,table:r},o){let i=o>0?-1:0;(function(e,t,n){const r=qA(t.type.schema).header_cell;for(let o=0;o<e.height;o++)if(t.nodeAt(e.map[n+o*e.width]).type!=r)return!1;return!0})(t,r,o+i)&&(i=0==o||o==t.width?null:0);for(let a=0;a<t.height;a++){const s=a*t.width+o;if(o>0&&o<t.width&&t.map[s-1]==t.map[s]){const i=t.map[s],l=r.nodeAt(i);e.setNodeMarkup(e.mapping.map(n+i),null,ZA(l.attrs,o-t.colCount(i))),a+=l.attrs.rowspan-1}else{const l=null==i?qA(r.type.schema).cell:r.nodeAt(t.map[s+i]).type,c=t.positionAt(a,o,r);e.insert(e.mapping.map(n+c),l.createAndFill())}}return e}function y$(e,t){if(!WA(e))return!1;if(t){const n=g$(e);t(v$(e.tr,n,n.left))}return!0}function w$(e,t){if(!WA(e))return!1;if(t){const n=g$(e);t(v$(e.tr,n,n.right))}return!0}function b$(e,{map:t,table:n,tableStart:r},o){const i=e.mapping.maps.length;for(let a=0;a<t.height;){const s=a*t.width+o,l=t.map[s],c=n.nodeAt(l),u=c.attrs;if(o>0&&t.map[s-1]==l||o<t.width-1&&t.map[s+1]==l)e.setNodeMarkup(e.mapping.slice(i).map(r+l),null,XA(u,o-t.colCount(l)));else{const t=e.mapping.slice(i).map(r+l);e.delete(t,t+c.nodeSize)}a+=u.rowspan}}function k$(e,{map:t,table:n,tableStart:r},o){let i=0;for(let c=0;c<o;c++)i+=n.child(c).nodeSize;const a=i+n.child(o).nodeSize,s=e.mapping.maps.length;e.delete(i+r,a+r);const l=new Set;for(let c=0,u=o*t.width;c<t.width;c++,u++){const i=t.map[u];if(!l.has(i))if(l.add(i),o>0&&i==t.map[u-t.width]){const t=n.nodeAt(i).attrs;e.setNodeMarkup(e.mapping.slice(s).map(i+r),null,M(M({},t),{},{rowspan:t.rowspan-1})),c+=t.colspan-1}else if(o<t.height&&i==t.map[u+t.width]){const a=n.nodeAt(i),l=a.attrs,u=a.type.create(M(M({},l),{},{rowspan:a.attrs.rowspan-1}),a.content),d=t.positionAt(o+1,c,n);e.insert(e.mapping.slice(s).map(r+d),u),c+=l.colspan-1}}}function x$(e,t,n){const r=t.map.cellsInRect({left:0,top:0,right:"row"==e?t.map.width:1,bottom:"column"==e?t.map.height:1});for(let o=0;o<r.length;o++){const e=t.table.nodeAt(r[o]);if(e&&e.type!==n.header_cell)return!1}return!0}function C$(e,t){return(t=t||{useDeprecatedLogic:!1}).useDeprecatedLogic?function(e){return function(t,n){if(!WA(t))return!1;if(n){const r=qA(t.schema),o=g$(t),i=t.tr,a=o.map.cellsInRect("column"==e?{left:o.left,top:0,right:o.right,bottom:o.map.height}:"row"==e?{left:0,top:o.top,right:o.map.width,bottom:o.bottom}:o),s=a.map(e=>o.table.nodeAt(e));for(let e=0;e<a.length;e++)s[e].type==r.header_cell&&i.setNodeMarkup(o.tableStart+a[e],r.cell,s[e].attrs);if(0==i.steps.length)for(let e=0;e<a.length;e++)i.setNodeMarkup(o.tableStart+a[e],r.header_cell,s[e].attrs);n(i)}return!0}}(e):function(t,n){if(!WA(t))return!1;if(n){const r=qA(t.schema),o=g$(t),i=t.tr,a=x$("row",o,r),s=x$("column",o,r),l=("column"===e?a:"row"===e&&s)?1:0,c="column"==e?{left:0,top:l,right:1,bottom:o.map.height}:"row"==e?{left:l,top:0,right:o.map.width,bottom:1}:o,u="column"==e?s?r.cell:r.header_cell:"row"==e?a?r.cell:r.header_cell:r.cell;o.map.cellsInRect(c).forEach(e=>{const t=e+o.tableStart,n=i.doc.nodeAt(t);n&&i.setNodeMarkup(t,u,n.attrs)}),n(i)}return!0}}function S$(e){return function(t,n){if(!WA(t))return!1;const r=function(e,t){if(t<0){const t=e.nodeBefore;if(t)return e.pos-t.nodeSize;for(let n=e.index(-1)-1,r=e.before();n>=0;n--){const t=e.node(-1).child(n),o=t.lastChild;if(o)return r-1-o.nodeSize;r-=t.nodeSize}}else{if(e.index()<e.parent.childCount-1)return e.pos+e.nodeAfter.nodeSize;const t=e.node(-1);for(let n=e.indexAfter(-1),r=e.after();n<t.childCount;n++){const e=t.child(n);if(e.childCount)return r+1;r+=e.nodeSize}}return null}(KA(t),e);if(null==r)return!1;if(n){const e=t.doc.resolve(r);n(t.tr.setSelection(Tk.between(e,(o=e,o.node(0).resolve(o.pos+o.nodeAfter.nodeSize)))).scrollIntoView())}var o;return!0}}function M$(e,t){const n=e.selection;if(!(n instanceof QA))return!1;if(t){const r=e.tr,o=qA(e.schema).cell.createAndFill().content;n.forEachCell((e,t)=>{e.content.eq(o)||r.replace(r.mapping.map(t+1),r.mapping.map(t+e.nodeSize-1),new $w(o,0,0))}),r.docChanged&&t(r)}return!0}function T$(e){if(!e.size)return null;let{content:t,openStart:n,openEnd:r}=e;for(;1==t.childCount&&(n>0&&r>0||"table"==t.child(0).type.spec.tableRole);)n--,r--,t=t.child(0).content;const o=t.child(0),i=o.type.spec.tableRole,a=o.type.schema,s=[];if("row"==i)for(let l=0;l<t.childCount;l++){let e=t.child(l).content;const o=l?0:Math.max(0,n-1),i=l<t.childCount-1?0:Math.max(0,r-1);(o||i)&&(e=O$(qA(a).row,new $w(e,o,i)).content),s.push(e)}else{if("cell"!=i&&"header_cell"!=i)return null;s.push(n||r?O$(qA(a).row,new $w(t,n,r)).content:t)}return function(e,t){const n=[];for(let o=0;o<t.length;o++){const e=t[o];for(let t=e.childCount-1;t>=0;t--){const{rowspan:r,colspan:i}=e.child(t).attrs;for(let e=o;e<o+r;e++)n[e]=(n[e]||0)+i}}let r=0;for(let o=0;o<n.length;o++)r=Math.max(r,n[o]);for(let o=0;o<n.length;o++)if(o>=t.length&&t.push(Ow.empty),n[o]<r){const i=qA(e).cell.createAndFill(),a=[];for(let e=n[o];e<r;e++)a.push(i);t[o]=t[o].append(Ow.from(a))}return{height:t.length,width:r,rows:t}}(a,s)}function O$(e,t){const n=e.createAndFill();return new bk(n).replace(0,n.content.size,t).doc}function _$(e,t,n,r,o,i,a,s){if(0==a||a==t.height)return!1;let l=!1;for(let c=o;c<i;c++){const o=a*t.width+c,i=t.map[o];if(t.map[o-t.width]==i){l=!0;const o=n.nodeAt(i),{top:u,left:d}=t.findCell(i);e.setNodeMarkup(e.mapping.slice(s).map(i+r),null,M(M({},o.attrs),{},{rowspan:a-u})),e.insert(e.mapping.slice(s).map(t.positionAt(a,d,n)),o.type.createAndFill(M(M({},o.attrs),{},{rowspan:u+o.attrs.rowspan-a}))),c+=o.attrs.colspan-1}}return l}function N$(e,t,n,r,o,i,a,s){if(0==a||a==t.width)return!1;let l=!1;for(let c=o;c<i;c++){const o=c*t.width+a,i=t.map[o];if(t.map[o-1]==i){l=!0;const o=n.nodeAt(i),u=t.colCount(i),d=e.mapping.slice(s).map(i+r);e.setNodeMarkup(d,null,XA(o.attrs,a-u,o.attrs.colspan-(a-u))),e.insert(d+o.nodeSize,o.type.createAndFill(XA(o.attrs,0,a-u))),c+=o.attrs.rowspan-1}}return l}function E$(e,t,n,r,o){let i=n?e.doc.nodeAt(n-1):e.doc;if(!i)throw new Error("No table found");let a=zA.get(i);const{top:s,left:l}=r,c=l+o.width,u=s+o.height,d=e.tr;let p=0;function h(){if(i=n?d.doc.nodeAt(n-1):d.doc,!i)throw new Error("No table found");a=zA.get(i),p=d.mapping.maps.length}(function(e,t,n,r,o,i,a){const s=qA(e.doc.type.schema);let l,c;if(o>t.width)for(let u=0,d=0;u<t.height;u++){const i=n.child(u);d+=i.nodeSize;const p=[];let h;h=null==i.lastChild||i.lastChild.type==s.cell?l||(l=s.cell.createAndFill()):c||(c=s.header_cell.createAndFill());for(let e=t.width;e<o;e++)p.push(h);e.insert(e.mapping.slice(a).map(d-1+r),p)}if(i>t.height){const u=[];for(let e=0,r=(t.height-1)*t.width;e<Math.max(t.width,o);e++){const o=!(e>=t.width)&&n.nodeAt(t.map[r+e]).type==s.header_cell;u.push(o?c||(c=s.header_cell.createAndFill()):l||(l=s.cell.createAndFill()))}const d=s.row.create(null,Ow.from(u)),p=[];for(let e=t.height;e<i;e++)p.push(d);e.insert(e.mapping.slice(a).map(r+n.nodeSize-2),p)}return!(!l&&!c)})(d,a,i,n,c,u,p)&&h(),_$(d,a,i,n,l,c,s,p)&&h(),_$(d,a,i,n,l,c,u,p)&&h(),N$(d,a,i,n,s,u,l,p)&&h(),N$(d,a,i,n,s,u,c,p)&&h();for(let f=s;f<u;f++){const e=a.positionAt(f,l,i),t=a.positionAt(f,c,i);d.replace(d.mapping.slice(p).map(e+n),d.mapping.slice(p).map(t+n),new $w(o.rows[f-s],0,0))}h(),d.setSelection(new QA(d.doc.resolve(n+a.positionAt(s,l,i)),d.doc.resolve(n+a.positionAt(u-1,c-1,i)))),t(d)}C$("row",{useDeprecatedLogic:!0}),C$("column",{useDeprecatedLogic:!0}),C$("cell",{useDeprecatedLogic:!0});var D$=YO({ArrowLeft:$$("horiz",-1),ArrowRight:$$("horiz",1),ArrowUp:$$("vert",-1),ArrowDown:$$("vert",1),"Shift-ArrowLeft":R$("horiz",-1),"Shift-ArrowRight":R$("horiz",1),"Shift-ArrowUp":R$("vert",-1),"Shift-ArrowDown":R$("vert",1),Backspace:M$,"Mod-Backspace":M$,Delete:M$,"Mod-Delete":M$});function A$(e,t,n){return!n.eq(e.selection)&&(t&&t(e.tr.setSelection(n).scrollIntoView()),!0)}function $$(e,t){return(n,r,o)=>{if(!o)return!1;const i=n.selection;if(i instanceof QA)return A$(n,r,xk.near(i.$headCell,t));if("horiz"!=e&&!i.empty)return!1;const a=z$(o,e,t);if(null==a)return!1;if("horiz"==e)return A$(n,r,xk.near(n.doc.resolve(i.head+t),t));{const o=n.doc.resolve(a),i=GA(o,e,t);let s;return s=i?xk.near(i,1):t<0?xk.near(n.doc.resolve(o.before(-1)),-1):xk.near(n.doc.resolve(o.after(-1)),1),A$(n,r,s)}}}function R$(e,t){return(n,r,o)=>{if(!o)return!1;const i=n.selection;let a;if(i instanceof QA)a=i;else{const r=z$(o,e,t);if(null==r)return!1;a=new QA(n.doc.resolve(r))}const s=GA(a.$headCell,e,t);return!!s&&A$(n,r,new QA(a.$anchorCell,s))}}function L$(e,t){const n=UA(e.state.doc.resolve(t));return!!n&&(e.dispatch(e.state.tr.setSelection(new QA(n))),!0)}function I$(e,t,n){if(!WA(e.state))return!1;let r=T$(n);const o=e.state.selection;if(o instanceof QA){r||(r={width:1,height:1,rows:[Ow.from(O$(qA(e.state.schema).cell,n))]});const t=o.$anchorCell.node(-1),i=o.$anchorCell.start(-1),a=zA.get(t).rectBetween(o.$anchorCell.pos-i,o.$headCell.pos-i);return r=function({width:e,height:t,rows:n},r,o){if(e!=r){const t=[],o=[];for(let e=0;e<n.length;e++){const i=n[e],a=[];for(let n=t[e]||0,o=0;n<r;o++){let s=i.child(o%i.childCount);n+s.attrs.colspan>r&&(s=s.type.createChecked(XA(s.attrs,s.attrs.colspan,n+s.attrs.colspan-r),s.content)),a.push(s),n+=s.attrs.colspan;for(let n=1;n<s.attrs.rowspan;n++)t[e+n]=(t[e+n]||0)+s.attrs.colspan}o.push(Ow.from(a))}n=o,e=r}if(t!=o){const e=[];for(let r=0,i=0;r<o;r++,i++){const a=[],s=n[i%t];for(let e=0;e<s.childCount;e++){let t=s.child(e);r+t.attrs.rowspan>o&&(t=t.type.create(M(M({},t.attrs),{},{rowspan:Math.max(1,o-t.attrs.rowspan)}),t.content)),a.push(t)}e.push(Ow.from(a))}n=e,t=o}return{width:e,height:t,rows:n}}(r,a.right-a.left,a.bottom-a.top),E$(e.state,e.dispatch,i,a,r),!0}if(r){const t=KA(e.state),n=t.start(-1);return E$(e.state,e.dispatch,n,zA.get(t.node(-1)).findCell(t.pos-n),r),!0}return!1}function P$(e,t){var n;if(t.ctrlKey||t.metaKey)return;const r=B$(e,t.target);let o;if(t.shiftKey&&e.state.selection instanceof QA)i(e.state.selection.$anchorCell,t),t.preventDefault();else if(t.shiftKey&&r&&null!=(o=UA(e.state.selection.$anchor))&&(null==(n=F$(e,t))?void 0:n.pos)!=o.pos)i(o,t),t.preventDefault();else if(!r)return;function i(t,n){let r=F$(e,n);const o=null==HA.getState(e.state);if(!r||!JA(t,r)){if(!o)return;r=t}const i=new QA(t,r);if(o||!e.state.selection.eq(i)){const n=e.state.tr.setSelection(i);o&&n.setMeta(HA,t.pos),e.dispatch(n)}}function a(){e.root.removeEventListener("mouseup",a),e.root.removeEventListener("dragstart",a),e.root.removeEventListener("mousemove",s),null!=HA.getState(e.state)&&e.dispatch(e.state.tr.setMeta(HA,-1))}function s(n){const o=n,s=HA.getState(e.state);let l;if(null!=s)l=e.state.doc.resolve(s);else if(B$(e,o.target)!=r&&(l=F$(e,t),!l))return a();l&&i(l,o)}e.root.addEventListener("mouseup",a),e.root.addEventListener("dragstart",a),e.root.addEventListener("mousemove",s)}function z$(e,t,n){if(!(e.state.selection instanceof Tk))return null;const{$head:r}=e.state.selection;for(let o=r.depth-1;o>=0;o--){const i=r.node(o);if((n<0?r.index(o):r.indexAfter(o))!=(n<0?0:i.childCount))return null;if("cell"==i.type.spec.tableRole||"header_cell"==i.type.spec.tableRole){const i=r.before(o),a="vert"==t?n>0?"down":"up":n>0?"right":"left";return e.endOfTextblock(a)?i:null}}return null}function B$(e,t){for(;t&&t!=e.dom;t=t.parentNode)if("TD"==t.nodeName||"TH"==t.nodeName)return t;return null}function F$(e,t){const n=e.posAtCoords({left:t.clientX,top:t.clientY});return n&&n?UA(e.state.doc.resolve(n.pos)):null}var j$=class{constructor(e,t){this.node=e,this.defaultCellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${t}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),V$(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type==this.node.type&&(this.node=e,V$(e,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(e){return"attributes"==e.type&&(e.target==this.table||this.colgroup.contains(e.target))}};function V$(e,t,n,r,o,i){var a;let s=0,l=!0,c=t.firstChild;const u=e.firstChild;if(u){for(let e=0,n=0;e<u.childCount;e++){const{colspan:a,colwidth:d}=u.child(e).attrs;for(let e=0;e<a;e++,n++){const a=o==n?i:d&&d[e],u=a?a+"px":"";if(s+=a||r,a||(l=!1),c)c.style.width!=u&&(c.style.width=u),c=c.nextSibling;else{const e=document.createElement("col");e.style.width=u,t.appendChild(e)}}}for(;c;){const e=c.nextSibling;null==(a=c.parentNode)||a.removeChild(c),c=e}l?(n.style.width=s+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=s+"px")}}var q$=new Hk("tableColumnResizing");function H$({handleWidth:e=5,cellMinWidth:t=25,defaultCellMinWidth:n=100,View:r=j$,lastColumnResizable:o=!0}={}){const i=new jk({key:q$,state:{init(e,t){var o,a;const s=null==(a=null==(o=i.spec)?void 0:o.props)?void 0:a.nodeViews,l=qA(t.schema).table.name;return r&&s&&(s[l]=(e,t)=>new r(e,n,t)),new U$(-1,!1)},apply:(e,t)=>t.apply(e)},props:{attributes:e=>{const t=q$.getState(e);return t&&t.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(t,n)=>{!function(e,t,n,r){if(!e.editable)return;const o=q$.getState(e.state);if(!o)return;if(!o.dragging){const i=function(e){for(;e&&"TD"!=e.nodeName&&"TH"!=e.nodeName;)e=e.classList&&e.classList.contains("ProseMirror")?null:e.parentNode;return e}(t.target);let a=-1;if(i){const{left:r,right:o}=i.getBoundingClientRect();t.clientX-r<=n?a=W$(e,t,"left",n):o-t.clientX<=n&&(a=W$(e,t,"right",n))}if(a!=o.activeHandle){if(!r&&-1!==a){const t=e.state.doc.resolve(a),n=t.node(-1),r=zA.get(n),o=t.start(-1);if(r.colCount(t.pos-o)+t.nodeAfter.attrs.colspan-1==r.width-1)return}Y$(e,a)}}}(t,n,e,o)},mouseleave:e=>{!function(e){if(!e.editable)return;const t=q$.getState(e.state);t&&t.activeHandle>-1&&!t.dragging&&Y$(e,-1)}(e)},mousedown:(e,r)=>{!function(e,t,n,r){var o;if(!e.editable)return!1;const i=null!=(o=e.dom.ownerDocument.defaultView)?o:window,a=q$.getState(e.state);if(!a||-1==a.activeHandle||a.dragging)return!1;const s=e.state.doc.nodeAt(a.activeHandle),l=function(e,t,{colspan:n,colwidth:r}){const o=r&&r[r.length-1];if(o)return o;const i=e.domAtPos(t);let a=i.node.childNodes[i.offset].offsetWidth,s=n;if(r)for(let l=0;l<n;l++)r[l]&&(a-=r[l],s--);return a/s}(e,a.activeHandle,s.attrs);function c(t){i.removeEventListener("mouseup",c),i.removeEventListener("mousemove",u);const r=q$.getState(e.state);(null==r?void 0:r.dragging)&&(!function(e,t,n){const r=e.state.doc.resolve(t),o=r.node(-1),i=zA.get(o),a=r.start(-1),s=i.colCount(r.pos-a)+r.nodeAfter.attrs.colspan-1,l=e.state.tr;for(let c=0;c<i.height;c++){const e=c*i.width+s;if(c&&i.map[e]==i.map[e-i.width])continue;const t=i.map[e],r=o.nodeAt(t).attrs,u=1==r.colspan?0:s-i.colCount(t);if(r.colwidth&&r.colwidth[u]==n)continue;const d=r.colwidth?r.colwidth.slice():G$(r.colspan);d[u]=n,l.setNodeMarkup(a+t,null,M(M({},r),{},{colwidth:d}))}l.docChanged&&e.dispatch(l)}(e,r.activeHandle,K$(r.dragging,t,n)),e.dispatch(e.state.tr.setMeta(q$,{setDragging:null})))}function u(t){if(!t.which)return c(t);const o=q$.getState(e.state);if(o&&o.dragging){const i=K$(o.dragging,t,n);J$(e,o.activeHandle,i,r)}}e.dispatch(e.state.tr.setMeta(q$,{setDragging:{startX:t.clientX,startWidth:l}})),J$(e,a.activeHandle,l,r),i.addEventListener("mouseup",c),i.addEventListener("mousemove",u),t.preventDefault()}(e,r,t,n)}},decorations:e=>{const t=q$.getState(e);if(t&&t.activeHandle>-1)return function(e,t){var n;const r=[],o=e.doc.resolve(t),i=o.node(-1);if(!i)return ES.empty;const a=zA.get(i),s=o.start(-1),l=a.colCount(o.pos-s)+o.nodeAfter.attrs.colspan-1;for(let c=0;c<a.height;c++){const t=l+c*a.width;if(!(l!=a.width-1&&a.map[t]==a.map[t+1]||0!=c&&a.map[t]==a.map[t-a.width])){const o=a.map[t],l=s+o+i.nodeAt(o).nodeSize-1,c=document.createElement("div");c.className="column-resize-handle",(null==(n=q$.getState(e))?void 0:n.dragging)&&r.push(OS.node(s+o,s+o+i.nodeAt(o).nodeSize,{class:"column-resize-dragging"})),r.push(OS.widget(l,c))}}return ES.create(e.doc,r)}(e,t.activeHandle)},nodeViews:{}}});return i}var U$=class e{constructor(e,t){this.activeHandle=e,this.dragging=t}apply(t){const n=this,r=t.getMeta(q$);if(r&&null!=r.setHandle)return new e(r.setHandle,!1);if(r&&void 0!==r.setDragging)return new e(n.activeHandle,r.setDragging);if(n.activeHandle>-1&&t.docChanged){let r=t.mapping.map(n.activeHandle,-1);return YA(t.doc.resolve(r))||(r=-1),new e(r,n.dragging)}return n}};function W$(e,t,n,r){const o="right"==n?-r:r,i=e.posAtCoords({left:t.clientX+o,top:t.clientY});if(!i)return-1;const{pos:a}=i,s=UA(e.state.doc.resolve(a));if(!s)return-1;if("right"==n)return s.pos;const l=zA.get(s.node(-1)),c=s.start(-1),u=l.map.indexOf(s.pos-c);return u%l.width==0?-1:c+l.map[u-1]}function K$(e,t,n){const r=t.clientX-e.startX;return Math.max(n,e.startWidth+r)}function Y$(e,t){e.dispatch(e.state.tr.setMeta(q$,{setHandle:t}))}function J$(e,t,n,r){const o=e.state.doc.resolve(t),i=o.node(-1),a=o.start(-1),s=zA.get(i).colCount(o.pos-a)+o.nodeAfter.attrs.colspan-1;let l=e.domAtPos(o.start(-1)).node;for(;l&&"TABLE"!=l.nodeName;)l=l.parentNode;l&&V$(i,l.firstChild,l,r,s,n)}function G$(e){return Array(e).fill(0)}function X$({allowTableNodeSelection:e=!1}={}){return new jk({key:HA,state:{init:()=>null,apply(e,t){const n=e.getMeta(HA);if(null!=n)return-1==n?null:n;if(null==t||!e.docChanged)return t;const{deleted:r,pos:o}=e.mapping.mapResult(t);return r?null:o}},props:{decorations:t$,handleDOMEvents:{mousedown:P$},createSelectionBetween:e=>null!=HA.getState(e.state)?e.state.selection:null,handleTripleClick:L$,handleKeyDown:D$,handlePaste:I$},appendTransaction:(t,n,r)=>function(e,t,n){const r=(t||e).selection,o=(t||e).doc;let i,a;if(r instanceof _k&&(a=r.node.type.spec.tableRole)){if("cell"==a||"header_cell"==a)i=QA.create(o,r.from);else if("row"==a){const e=o.resolve(r.from+1);i=QA.rowSelection(e,e)}else if(!n){const e=zA.get(r.node),t=r.from+1,n=t+e.map[e.width*e.height-1];i=QA.create(o,t+1,n)}}else r instanceof Tk&&function({$from:e,$to:t}){if(e.pos==t.pos||e.pos<t.pos-6)return!1;let n=e.pos,r=t.pos,o=e.depth;for(;o>=0&&!(e.after(o+1)<e.end(o));o--,n++);for(let i=t.depth;i>=0&&!(t.before(i+1)>t.start(i));i--,r--);return n==r&&/row|table/.test(e.node(o).type.spec.tableRole)}(r)?i=Tk.create(o,r.from):r instanceof Tk&&function({$from:e,$to:t}){let n,r;for(let o=e.depth;o>0;o--){const t=e.node(o);if("cell"===t.type.spec.tableRole||"header_cell"===t.type.spec.tableRole){n=t;break}}for(let o=t.depth;o>0;o--){const e=t.node(o);if("cell"===e.type.spec.tableRole||"header_cell"===e.type.spec.tableRole){r=e;break}}return n!==r&&0===t.parentOffset}(r)&&(i=Tk.create(o,r.$from.start(),r.$from.end()));return i&&(t||(t=e.tr)).setSelection(i),t}(r,o$(r,n),e)})}var Z$="undefined"!=typeof navigator?navigator:null,Q$=Z$&&Z$.userAgent||"",eR=/Edge\/(\d+)/.exec(Q$),tR=/MSIE \d/.exec(Q$),nR=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Q$),rR=!!!(tR||nR||eR)&&!!Z$&&/Apple Computer/.test(Z$.vendor),oR=new Hk("safari-ime-span"),iR=!1;function aR(e){const t=e.dom.ownerDocument.createElement("span");return t.className="ProseMirror-safari-ime-span",t}var sR=new jk(rR?{key:oR,props:{decorations:function(e){const{$from:t,$to:n,to:r}=e.selection;if(iR&&t.sameParent(n)){const t=OS.widget(r,aR,{ignoreSelection:!0,key:"safari-ime-span"});return ES.create(e.doc,[t])}},handleDOMEvents:{compositionstart:()=>{iR=!0},compositionend:()=>{iR=!1}}}}:{key:oR});function lR(e,t){return Object.assign(e,{meta:M({package:"@milkdown/preset-gfm"},t)}),e}const cR=QN("strike_through");lR(cR,{displayName:"Attr<strikethrough>",group:"Strikethrough"});const uR=GN("strike_through",e=>({parseDOM:[{tag:"del"},{style:"text-decoration",getAttrs:e=>"line-through"===e}],toDOM:t=>["del",e.get(cR.key)(t)],parseMarkdown:{match:e=>"delete"===e.type,runner:(e,t,n)=>{e.openMark(n),e.next(t.children),e.closeMark(n)}},toMarkdown:{match:e=>"strike_through"===e.type.name,runner:(e,t)=>{e.withMark(t,"delete")}}}));lR(uR.mark,{displayName:"MarkSchema<strikethrough>",group:"Strikethrough"}),lR(uR.ctx,{displayName:"MarkSchemaCtx<strikethrough>",group:"Strikethrough"});const dR=qN("ToggleStrikeThrough",e=>()=>oO(uR.type(e)));lR(dR,{displayName:"Command<ToggleStrikethrough>",group:"Strikethrough"});const pR=HN(e=>TO(new RegExp("(?<![\\w:/])(~{1,2})(.+?)\\1(?!\\w|\\/)"),uR.type(e)));lR(pR,{displayName:"InputRule<strikethrough>",group:"Strikethrough"});const hR=XN("strikeThroughKeymap",{ToggleStrikethrough:{shortcuts:"Mod-Alt-x",command:e=>{const t=e.get(k_);return()=>t.call(dR.key)}}});lR(hR.ctx,{displayName:"KeymapCtx<strikethrough>",group:"Strikethrough"}),lR(hR.shortcuts,{displayName:"Keymap<strikethrough>",group:"Strikethrough"});const fR=function(e){const t=e.cellAttributes||{},n={colspan:{default:1,validate:"number"},rowspan:{default:1,validate:"number"},colwidth:{default:null,validate:VA}};for(const r in t)n[r]={default:t[r].default,validate:t[r].validate};return{table:{content:"table_row+",tableRole:"table",isolating:!0,group:e.tableGroup,parseDOM:[{tag:"table"}],toDOM:()=>["table",["tbody",0]]},table_row:{content:"(table_cell | table_header)*",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM:()=>["tr",0]},table_cell:{content:e.cellContent,attrs:n,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs:e=>FA(e,t)}],toDOM:e=>["td",jA(e,t),0]},table_header:{content:e.cellContent,attrs:n,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs:e=>FA(e,t)}],toDOM:e=>["th",jA(e,t),0]}}}({tableGroup:"block",cellContent:"paragraph",cellAttributes:{alignment:{default:"left",getFromDOM:e=>e.style.textAlign||"left",setDOMAttr:(e,t)=>{t.style=`text-align: ${e||"left"}`}}}}),mR=JN("table",()=>M(M({},fR.table),{},{content:"table_header_row table_row+",disableDropCursor:!0,parseMarkdown:{match:e=>"table"===e.type,runner:(e,t,n)=>{const r=t.align,o=t.children.map((e,t)=>M(M({},e),{},{align:r,isHeader:0===t}));e.openNode(n),e.next(o),e.closeNode()}},toMarkdown:{match:e=>"table"===e.type.name,runner:(e,t)=>{var n;const r=null===(n=t.content.firstChild)||void 0===n?void 0:n.content;if(!r)return;const o=[];r.forEach(e=>{o.push(e.attrs.alignment)}),e.openNode("table",void 0,{align:o}),e.next(t.content),e.closeNode()}}}));lR(mR.node,{displayName:"NodeSchema<table>",group:"Table"}),lR(mR.ctx,{displayName:"NodeSchemaCtx<table>",group:"Table"});const gR=JN("table_header_row",()=>M(M({},fR.table_row),{},{disableDropCursor:!0,content:"(table_header)*",parseDOM:[{tag:"tr[data-is-header]"}],toDOM:()=>["tr",{"data-is-header":!0},0],parseMarkdown:{match:e=>Boolean("tableRow"===e.type&&e.isHeader),runner:(e,t,n)=>{const r=t.align,o=t.children.map((e,n)=>M(M({},e),{},{align:r[n],isHeader:t.isHeader}));e.openNode(n),e.next(o),e.closeNode()}},toMarkdown:{match:e=>"table_header_row"===e.type.name,runner:(e,t)=>{e.openNode("tableRow",void 0,{isHeader:!0}),e.next(t.content),e.closeNode()}}}));lR(gR.node,{displayName:"NodeSchema<tableHeaderRow>",group:"Table"}),lR(gR.ctx,{displayName:"NodeSchemaCtx<tableHeaderRow>",group:"Table"});const vR=JN("table_row",()=>M(M({},fR.table_row),{},{disableDropCursor:!0,content:"(table_cell)*",parseMarkdown:{match:e=>"tableRow"===e.type,runner:(e,t,n)=>{const r=t.align,o=t.children.map((e,t)=>M(M({},e),{},{align:r[t]}));e.openNode(n),e.next(o),e.closeNode()}},toMarkdown:{match:e=>"table_row"===e.type.name,runner:(e,t)=>{0!==t.content.size&&(e.openNode("tableRow"),e.next(t.content),e.closeNode())}}}));lR(vR.node,{displayName:"NodeSchema<tableRow>",group:"Table"}),lR(vR.ctx,{displayName:"NodeSchemaCtx<tableRow>",group:"Table"});const yR=JN("table_cell",()=>M(M({},fR.table_cell),{},{disableDropCursor:!0,parseMarkdown:{match:e=>"tableCell"===e.type&&!e.isHeader,runner:(e,t,n)=>{const r=t.align;e.openNode(n,{alignment:r}).openNode(e.schema.nodes.paragraph).next(t.children).closeNode().closeNode()}},toMarkdown:{match:e=>"table_cell"===e.type.name,runner:(e,t)=>{e.openNode("tableCell").next(t.content).closeNode()}}}));lR(yR.node,{displayName:"NodeSchema<tableCell>",group:"Table"}),lR(yR.ctx,{displayName:"NodeSchemaCtx<tableCell>",group:"Table"});const wR=JN("table_header",()=>M(M({},fR.table_header),{},{disableDropCursor:!0,parseMarkdown:{match:e=>"tableCell"===e.type&&!!e.isHeader,runner:(e,t,n)=>{const r=t.align;e.openNode(n,{alignment:r}),e.openNode(e.schema.nodes.paragraph),e.next(t.children),e.closeNode(),e.closeNode()}},toMarkdown:{match:e=>"table_header"===e.type.name,runner:(e,t)=>{e.openNode("tableCell"),e.next(t.content),e.closeNode()}}}));function bR(e,t=3,n=3){const r=Array(n).fill(0).map(()=>yR.type(e).createAndFill()),o=Array(n).fill(0).map(()=>wR.type(e).createAndFill()),i=Array(t).fill(0).map((t,n)=>0===n?gR.type(e).create(null,o):vR.type(e).create(null,r));return mR.type(e).create(null,i)}function kR(e){return(t,n)=>r=>{n=null!=n?n:r.selection.from;const o=r.doc.resolve(n),i=(a=e=>"table"===e.type.name,e=>{for(let t=e.depth;t>0;t--){const n=e.node(t);if(a(n))return{pos:t>0?e.before(t):0,start:e.start(t),depth:t,node:n}}})(o);var a;const s=i?{node:i.node,from:i.start}:void 0,l="row"===e;if(s){const e=zA.get(s.node);if(t>=0&&t<(l?e.height:e.width)){const n=e.positionAt(l?t:e.height-1,l?e.width-1:t,s.node),o=r.doc.resolve(s.from+n),i=l?QA.rowSelection:QA.colSelection,a=e.positionAt(l?t:0,l?0:t,s.node),c=r.doc.resolve(s.from+a);return IO(r.setSelection(i(o,c)))}}return r}}lR(wR.node,{displayName:"NodeSchema<tableHeader>",group:"Table"}),lR(wR.ctx,{displayName:"NodeSchemaCtx<tableHeader>",group:"Table"});const xR=kR("row"),CR=kR("col");function SR(e,t,{map:n,tableStart:r,table:o},i){const a=Array(i).fill(0).reduce((e,t,n)=>e+o.child(n).nodeSize,r),s=Array(n.width).fill(0).map((t,r)=>{const i=o.nodeAt(n.map[r]);return yR.type(e).createAndFill({alignment:null==i?void 0:i.attrs.alignment})});return t.insert(a,vR.type(e).create(null,s)),t}function MR(e){const t=function(e){const t=s$(e.$from);if(!t)return;const n=zA.get(t.node);return n.cellsInRect({left:0,right:n.width,top:0,bottom:n.height}).map(e=>{const n=t.node.nodeAt(e),r=e+t.start;return{pos:r,start:r+1,node:n}})}(e.selection);if(t&&t[0]){const n=e.doc.resolve(t[0].pos),r=t[t.length-1];if(r){const t=e.doc.resolve(r.pos);return IO(e.setSelection(new QA(t,n)))}}return e}const TR=qN("GoToPrevTableCell",()=>()=>S$(-1));lR(TR,{displayName:"Command<goToPrevTableCellCommand>",group:"Table"});const OR=qN("GoToNextTableCell",()=>()=>S$(1));lR(OR,{displayName:"Command<goToNextTableCellCommand>",group:"Table"});const _R=qN("ExitTable",e=>()=>(t,n)=>{if(!WA(t))return!1;const{$head:r}=t.selection,o=(i=r,a=mR.type(e),(s=e=>e.type===a,e=>{for(let t=e.depth;t>0;t-=1){const n=e.node(t);if(s(n))return{from:e.before(t),to:e.after(t),node:n}}})(i));var i,a,s;if(!o)return!1;const{to:l}=o,c=t.tr.replaceWith(l,l,dD.type(e).createAndFill());return c.setSelection(xk.near(c.doc.resolve(l),1)).scrollIntoView(),null==n||n(c),!0});lR(_R,{displayName:"Command<breakTableCommand>",group:"Table"});const NR=qN("InsertTable",e=>({row:t,col:n}={})=>(r,o)=>{const{selection:i,tr:a}=r,{from:s}=i,l=bR(e,t,n),c=a.replaceSelectionWith(l),u=xk.findFrom(c.doc.resolve(s),1,!0);return u&&c.setSelection(u),null==o||o(c),!0});lR(NR,{displayName:"Command<insertTableCommand>",group:"Table"});const ER=qN("MoveRow",()=>({from:e,to:t,pos:n}={})=>{return r={from:null!=e?e:0,to:null!=t?t:0,pos:n},(e,t)=>{const{from:n,to:o,select:i=!0,pos:a=e.selection.from}=r,s=e.tr;return!!m$({tr:s,originIndex:n,targetIndex:o,select:i,pos:a})&&(null==t||t(s),!0)};var r});lR(ER,{displayName:"Command<moveRowCommand>",group:"Table"});const DR=qN("MoveCol",()=>({from:e,to:t,pos:n}={})=>{return r={from:null!=e?e:0,to:null!=t?t:0,pos:n},(e,t)=>{const{from:n,to:o,select:i=!0,pos:a=e.selection.from}=r,s=e.tr;return!!f$({tr:s,originIndex:n,targetIndex:o,select:i,pos:a})&&(null==t||t(s),!0)};var r});lR(DR,{displayName:"Command<moveColCommand>",group:"Table"});const AR=qN("SelectRow",()=>(e={index:0})=>(t,n)=>{const{tr:r}=t,o=null==n?void 0:n(xR(e.index,e.pos)(r));return Boolean(o)});lR(AR,{displayName:"Command<selectRowCommand>",group:"Table"});const $R=qN("SelectCol",()=>(e={index:0})=>(t,n)=>{const{tr:r}=t,o=null==n?void 0:n(CR(e.index,e.pos)(r));return Boolean(o)});lR($R,{displayName:"Command<selectColCommand>",group:"Table"});const RR=qN("SelectTable",()=>()=>(e,t)=>{const{tr:n}=e,r=null==t?void 0:t(MR(n));return Boolean(r)});lR(RR,{displayName:"Command<selectTableCommand>",group:"Table"});const LR=qN("DeleteSelectedCells",()=>()=>(e,t)=>{const{selection:n}=e;if(!(n instanceof QA))return!1;const r=n.isRowSelection(),o=n.isColSelection();return r&&o?function(e,t){const n=e.selection.$anchor;for(let r=n.depth;r>0;r--)if("table"==n.node(r).type.spec.tableRole)return t&&t(e.tr.delete(n.before(r),n.after(r)).scrollIntoView()),!0;return!1}(e,t):o?function(e,t){if(!WA(e))return!1;if(t){const n=g$(e),r=e.tr;if(0==n.left&&n.right==n.map.width)return!1;for(let e=n.right-1;b$(r,n,e),e!=n.left;e--){const e=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!e)throw RangeError("No table found");n.table=e,n.map=zA.get(e)}t(r)}return!0}(e,t):function(e,t){if(!WA(e))return!1;if(t){const n=g$(e),r=e.tr;if(0==n.top&&n.bottom==n.map.height)return!1;for(let e=n.bottom-1;k$(r,n,e),e!=n.top;e--){const e=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!e)throw RangeError("No table found");n.table=e,n.map=zA.get(n.table)}t(r)}return!0}(e,t)});lR(LR,{displayName:"Command<deleteSelectedCellsCommand>",group:"Table"});const IR=qN("AddColBefore",()=>()=>y$);lR(IR,{displayName:"Command<addColBeforeCommand>",group:"Table"});const PR=qN("AddColAfter",()=>()=>w$);lR(PR,{displayName:"Command<addColAfterCommand>",group:"Table"});const zR=qN("AddRowBefore",e=>()=>(t,n)=>{if(!WA(t))return!1;if(n){const r=g$(t);n(SR(e,t.tr,r,r.top))}return!0});lR(zR,{displayName:"Command<addRowBeforeCommand>",group:"Table"});const BR=qN("AddRowAfter",e=>()=>(t,n)=>{if(!WA(t))return!1;if(n){const r=g$(t);n(SR(e,t.tr,r,r.bottom))}return!0});lR(BR,{displayName:"Command<addRowAfterCommand>",group:"Table"});const FR=qN("SetAlign",()=>(e="left")=>{return t="alignment",n=e,function(e,r){if(!WA(e))return!1;const o=KA(e);if(o.nodeAfter.attrs[t]===n)return!1;if(r){const i=e.tr;e.selection instanceof QA?e.selection.forEachCell((e,r)=>{e.attrs[t]!==n&&i.setNodeMarkup(r,null,M(M({},e.attrs),{},{[t]:n}))}):i.setNodeMarkup(o.pos,null,M(M({},o.nodeAfter.attrs),{},{[t]:n})),r(i)}return!0};var t,n});lR(FR,{displayName:"Command<setAlignCommand>",group:"Table"});const jR=HN(e=>new dO(m(/^\|(\d+)[xX](\d+)\|\s$/,{col:1,row:2}),(t,n,r,o)=>{var i,a,s;const l=t.doc.resolve(r);if(!l.node(-1).canReplaceWith(l.index(-1),l.indexAfter(-1),mR.type(e)))return null;const c=Math.max(Number(null!==(i=null===(a=n.groups)||void 0===a?void 0:a.row)&&void 0!==i?i:0),2),u=bR(e,c,Number(null===(s=n.groups)||void 0===s?void 0:s.col)),d=t.tr.replaceRangeWith(r,o,u);return d.setSelection(Tk.create(d.doc,r+3)).scrollIntoView()}));lR(jR,{displayName:"InputRule<insertTableInputRule>",group:"Table"});const VR=function(e){const t=n=>async()=>{await n.wait(d_);const r=e(n);return n.update(J_,e=>[...e,r]),t.pasteRule=r,()=>{n.update(J_,e=>e.filter(e=>e!==r))}};return t}(e=>({run:(t,n,r)=>{if(r)return t;let o=t.content;return t.content.forEach((t,n,r)=>{var i,a;if((null==t?void 0:t.type)!==mR.type(e))return;const s=t.childCount,l=null!==(i=null===(a=t.lastChild)||void 0===a?void 0:a.childCount)&&void 0!==i?i:0;if(0===s||0===l)return void(o=o.replaceChild(r,dD.type(e).create()));const c=t.firstChild;if(!(l>0&&c&&0===c.childCount))return;const u=Array(l).fill(0).map(()=>wR.type(e).createAndFill()),d=new $w(Ow.from(u),0,0),p=c.replace(0,0,d),h=t.replace(0,c.nodeSize,new $w(Ow.from(p),0,0));o=o.replaceChild(r,h)}),new $w(Ow.from(o),t.openStart,t.openEnd)}}));lR(VR,{displayName:"PasteRule<table>",group:"Table"});const qR=XN("tableKeymap",{NextCell:{priority:100,shortcuts:["Mod-]","Tab"],command:e=>{const t=e.get(k_);return()=>t.call(OR.key)}},PrevCell:{shortcuts:["Mod-[","Shift-Tab"],command:e=>{const t=e.get(k_);return()=>t.call(TR.key)}},ExitTable:{shortcuts:["Mod-Enter","Enter"],command:e=>{const t=e.get(k_);return()=>t.call(_R.key)}}});lR(qR.ctx,{displayName:"KeymapCtx<table>",group:"Table"}),lR(qR.shortcuts,{displayName:"Keymap<table>",group:"Table"});const HR="footnote_definition",UR="footnoteDefinition",WR=JN("footnote_definition",()=>({group:"block",content:"block+",defining:!0,attrs:{label:{default:"",validate:"string"}},parseDOM:[{tag:`dl[data-type="${HR}"]`,getAttrs:e=>{if(!(e instanceof HTMLElement))throw OM(e);return{label:e.dataset.label}},contentElement:"dd"}],toDOM:e=>{const t=e.attrs.label;return["dl",{"data-label":t,"data-type":HR},["dt",t],["dd",0]]},parseMarkdown:{match:({type:e})=>e===UR,runner:(e,t,n)=>{e.openNode(n,{label:t.label}).next(t.children).closeNode()}},toMarkdown:{match:e=>e.type.name===HR,runner:(e,t)=>{e.openNode(UR,void 0,{label:t.attrs.label,identifier:t.attrs.label}).next(t.content).closeNode()}}}));lR(WR.ctx,{displayName:"NodeSchemaCtx<footnodeDef>",group:"footnote"}),lR(WR.node,{displayName:"NodeSchema<footnodeDef>",group:"footnote"});const KR="footnote_reference",YR=JN("footnote_reference",()=>({group:"inline",inline:!0,atom:!0,attrs:{label:{default:"",validate:"string"}},parseDOM:[{tag:`sup[data-type="${KR}"]`,getAttrs:e=>{if(!(e instanceof HTMLElement))throw OM(e);return{label:e.dataset.label}}}],toDOM:e=>{const t=e.attrs.label;return["sup",{"data-label":t,"data-type":KR},t]},parseMarkdown:{match:({type:e})=>"footnoteReference"===e,runner:(e,t,n)=>{e.addNode(n,{label:t.label})}},toMarkdown:{match:e=>e.type.name===KR,runner:(e,t)=>{e.addNode("footnoteReference",void 0,void 0,{label:t.attrs.label,identifier:t.attrs.label})}}}));lR(YR.ctx,{displayName:"NodeSchemaCtx<footnodeRef>",group:"footnote"}),lR(YR.node,{displayName:"NodeSchema<footnodeRef>",group:"footnote"});const JR=nA.extendSchema(e=>t=>{const n=e(t);return M(M({},n),{},{attrs:M(M({},n.attrs),{},{checked:{default:null,validate:"boolean|null"}}),parseDOM:[{tag:'li[data-item-type="task"]',getAttrs:e=>{if(!(e instanceof HTMLElement))throw OM(e);return{label:e.dataset.label,listType:e.dataset.listType,spread:e.dataset.spread,checked:e.dataset.checked?"true"===e.dataset.checked:null}}},...(null==n?void 0:n.parseDOM)||[]],toDOM:e=>n.toDOM&&null==e.attrs.checked?n.toDOM(e):["li",{"data-item-type":"task","data-label":e.attrs.label,"data-list-type":e.attrs.listType,"data-spread":e.attrs.spread,"data-checked":e.attrs.checked},0],parseMarkdown:{match:({type:e})=>"listItem"===e,runner:(e,t,r)=>{if(null==t.checked)return void n.parseMarkdown.runner(e,t,r);const o=null!=t.label?`${t.label}.`:"",i=null!=t.checked?Boolean(t.checked):null,a=null!=t.label?"ordered":"bullet",s=null!=t.spread?`${t.spread}`:"true";e.openNode(r,{label:o,listType:a,spread:s,checked:i}),e.next(t.children),e.closeNode()}},toMarkdown:{match:e=>"list_item"===e.type.name,runner:(e,t)=>{if(null==t.attrs.checked)return void n.toMarkdown.runner(e,t);const r=t.attrs.label,o=t.attrs.listType,i="true"===t.attrs.spread,a=t.attrs.checked;e.openNode("listItem",void 0,{label:r,listType:o,spread:i,checked:a}),e.next(t.content),e.closeNode()}}})});lR(JR.node,{displayName:"NodeSchema<taskListItem>",group:"ListItem"}),lR(JR.ctx,{displayName:"NodeSchemaCtx<taskListItem>",group:"ListItem"});const GR=HN(()=>new dO(m(/^\[(\s|x)\]\s$/,{checked:1}),(e,t,n,r)=>{var o;const i=e.doc.resolve(n);let a=0,s=i.node(a);for(;s&&"list_item"!==s.type.name;)a--,s=i.node(a);if(!s||null!=s.attrs.checked)return null;const l=Boolean("x"===(null===(o=t.groups)||void 0===o?void 0:o.checked)),c=i.before(a),u=e.tr;return u.deleteRange(n,r).setNodeMarkup(c,void 0,M(M({},s.attrs),{},{checked:l})),u}));lR(GR,{displayName:"InputRule<wrapInTaskListInputRule>",group:"ListItem"});const XR=[hR,qR].flat(),ZR=[jR,GR],QR=[pR],eL=[VR],tL=KN(()=>sR);lR(tL,{displayName:"Prose<autoInsertSpanPlugin>",group:"Prose"});const nL=KN(()=>H$({}));lR(nL,{displayName:"Prose<columnResizingPlugin>",group:"Prose"});const rL=KN(()=>X$({allowTableNodeSelection:!0}));lR(rL,{displayName:"Prose<tableEditingPlugin>",group:"Prose"});const oL=eE("remarkGFM",()=>De);lR(oL.plugin,{displayName:"Remark<remarkGFMPlugin>",group:"Remark"}),lR(oL.options,{displayName:"RemarkConfig<remarkGFMPlugin>",group:"Remark"});const iL=new Hk("MILKDOWN_KEEP_TABLE_ALIGN_PLUGIN");const aL=KN(()=>new jk({key:iL,appendTransaction:(e,t,n)=>{let r;return t.doc!==n.doc&&n.doc.descendants((e,t)=>{if(r||(r=n.tr),"table_cell"!==e.type.name)return;const o=n.doc.resolve(t),i=o.node(o.depth),a=o.node(o.depth-1).firstChild;if(!a)return;const s=function(e,t){let n=0;return t.forEach((t,r,o)=>{t===e&&(n=o)}),n}(e,i),l=a.maybeChild(s);if(!l)return;const c=l.attrs.alignment;c!==e.attrs.alignment&&r.setNodeMarkup(t,void 0,M(M({},e.attrs),{},{alignment:c}))}),r}}));lR(aL,{displayName:"Prose<keepTableAlignPlugin>",group:"Prose"});const sL=[aL,tL,oL,rL].flat(),lL=[[JR,mR,gR,vR,wR,yR,WR,YR,cR,uR].flat(),ZR,eL,QR,XR,[OR,TR,_R,NR,ER,DR,AR,$R,RR,LR,zR,BR,IR,PR,FR,dR],sL].flat(),cL=Ye({__name:"EditorButton",props:{icon:{}},setup:e=>(t,n)=>(Ze(),Qe("button",{class:lt(["fr-btn fr-btn--secondary-grey-400 fr-btn--sm fr-btn--tertiary-no-outline",e.icon]),role:"menuitem"},[tt(t.$slots,"default")],2))}),uL=["aria-labelledby","id"],dL={class:"fr-container fr-container--fluid fr-container-md"},pL={class:"fr-grid-row fr-grid-row--center"},hL={class:"fr-col-12 fr-col-md-8 fr-col-lg-6"},fL={class:"fr-modal__body"},mL={class:"fr-modal__header"},gL={class:"fr-modal__content"},vL=["id"],yL={"data-testid":"summary"},wL={class:"fr-my-1w"},bL={class:"fr-modal__footer"},kL={class:"fr-btns-group fr-btns-group--right"},xL=Ye(M(M({},{inheritAttrs:!1}),{},{__name:"ImageModal",props:{id:{}},emits:["sendModal"],setup(e,{emit:t}){const n=e,r=t,{t:o}=H(),i=Xe(()=>n.id+"-title"),a=ct(),s={src:"",title:"",alt:""},l=$t(M({},s)),c={src:{required:Ae}},{getErrorText:u,getFunctionalState:d,hasError:p,reset:h,validateRequiredRules:f,v$:m}=hy(l,c,c),g=Xe(()=>({src:d(m.value.src.$dirty,m.value.src.$error,!1)}));function v(){globalThis.dsfr(a.value).modal.conceal(),l.src=s.src,l.title=s.title,l.alt=s.alt,h()}function y(){f().then(e=>{e&&(r("sendModal",M({},l)),v())})}return(t,n)=>{return Ze(),nt(At,{to:"body"},[dt("dialog",et(t.$attrs,{"aria-labelledby":i.value,id:e.id,role:"dialog",class:"fr-modal",ref_key:"modalRef",ref:a}),[dt("div",dL,[dt("div",pL,[dt("div",hL,[dt("div",fL,[dt("div",mL,[dt("button",{class:"fr-btn--close fr-btn","aria-controls":"fr-modal-2",onClick:v},pt(rt(o)("Close")),1)]),dt("div",gL,[dt("h1",{id:i.value,class:"fr-mb-2w fr-modal__title"},[n[3]||(n[3]=dt("span",{class:"fr-icon-image-line fr-icon--lg"},null,-1)),Tt(" "+pt(rt(o)("Add an image")),1)],8,vL),dt("p",null,pt(rt(o)("Paste a link of your image to add it to your description. It is recommended to also provide a textual alternative for an informative image and a title.")),1),ut(Xc),ut(ez,{label:rt(o)("Image link"),placeholder:rt(o)("Paste your link..."),required:!0,modelValue:l.src,"onUpdate:modelValue":n[0]||(n[0]=e=>l.src=e),type:"url",hasError:(r="src",p(g,r)),errorText:rt(u)("src")},null,8,["label","placeholder","modelValue","hasError","errorText"]),dt("details",null,[dt("summary",yL,pt(rt(o)("Customize accessibility options")),1),dt("div",wL,[ut(ez,{label:rt(o)("Image alternative text"),modelValue:l.alt,"onUpdate:modelValue":n[1]||(n[1]=e=>l.alt=e)},null,8,["label","modelValue"]),ut(ez,{label:rt(o)("Image title"),modelValue:l.title,"onUpdate:modelValue":n[2]||(n[2]=e=>l.title=e)},null,8,["label","modelValue"])])])]),dt("div",bL,[dt("div",kL,[dt("button",{class:"fr-btn",onClick:y,"data-testid":"add-image-button"},pt(rt(o)("Add image")),1)])])])])])])],16,uL)]);var r}}})),CL=Ye({__name:"ImageModalButton",emits:["send"],setup(e,{emit:t}){const n=t,{t:r}=H(),o=G("image-modal");function i(e){n("send",e)}return(e,t)=>(Ze(),Qe(Mt,null,[ut(cL,{"data-fr-opened":"false","aria-controls":rt(o),icon:"fr-icon-image-add-fill",title:rt(r)("Image"),"data-testid":"image-modal-button"},null,8,["aria-controls","title"]),ut(xL,{id:rt(o),multiple:!0,onSendModal:i},null,8,["id"])],64))}});class SL extends j${constructor(e,t){super(e,t),this.dom.className="fr-table fr-table--no-caption fr-table--layout-fixed"}ignoreMutation(e){return super.ignoreMutation(e)||"attributes"===e.type&&e.target===this.dom}}const ML=KN(()=>H$({View:SL})),TL=Math.min,OL=Math.max,_L=Math.round,NL=e=>({x:e,y:e}),EL={left:"right",right:"left",bottom:"top",top:"bottom"},DL={start:"end",end:"start"};function AL(e,t,n){return OL(e,TL(t,n))}function $L(e,t){return"function"==typeof e?e(t):e}function RL(e){return e.split("-")[0]}function LL(e){return e.split("-")[1]}function IL(e){return"x"===e?"y":"x"}function PL(e){return"y"===e?"height":"width"}const zL=new Set(["top","bottom"]);function BL(e){return zL.has(RL(e))?"y":"x"}function FL(e){return IL(BL(e))}function jL(e){return e.replace(/start|end/g,e=>DL[e])}const VL=["left","right"],qL=["right","left"],HL=["top","bottom"],UL=["bottom","top"];function WL(e,t,n,r){const o=LL(e);let i=function(e,t,n){switch(e){case"top":case"bottom":return n?t?qL:VL:t?VL:qL;case"left":case"right":return t?HL:UL;default:return[]}}(RL(e),"start"===n,r);return o&&(i=i.map(e=>e+"-"+o),t&&(i=i.concat(i.map(jL)))),i}function KL(e){return e.replace(/left|right|bottom|top/g,e=>EL[e])}function YL(e){return"number"!=typeof e?function(e){return M({top:0,right:0,bottom:0,left:0},e)}(e):{top:e,right:e,bottom:e,left:e}}function JL(e){const{x:t,y:n,width:r,height:o}=e;return{width:r,height:o,top:n,left:t,right:t+r,bottom:n+o,x:t,y:n}}function GL(e,t,n){let{reference:r,floating:o}=e;const i=BL(t),a=FL(t),s=PL(a),l=RL(t),c="y"===i,u=r.x+r.width/2-o.width/2,d=r.y+r.height/2-o.height/2,p=r[s]/2-o[s]/2;let h;switch(l){case"top":h={x:u,y:r.y-o.height};break;case"bottom":h={x:u,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-o.width,y:d};break;default:h={x:r.x,y:r.y}}switch(LL(t)){case"start":h[a]-=p*(n&&c?-1:1);break;case"end":h[a]+=p*(n&&c?-1:1)}return h}async function XL(e,t){var n;void 0===t&&(t={});const{x:r,y:o,platform:i,rects:a,elements:s,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:p=!1,padding:h=0}=$L(t,e),f=YL(h),m=s[p?"floating"===d?"reference":"floating":d],g=JL(await i.getClippingRect({element:null==(n=await(null==i.isElement?void 0:i.isElement(m)))||n?m:m.contextElement||await(null==i.getDocumentElement?void 0:i.getDocumentElement(s.floating)),boundary:c,rootBoundary:u,strategy:l})),v="floating"===d?{x:r,y:o,width:a.floating.width,height:a.floating.height}:a.reference,y=await(null==i.getOffsetParent?void 0:i.getOffsetParent(s.floating)),w=await(null==i.isElement?void 0:i.isElement(y))&&await(null==i.getScale?void 0:i.getScale(y))||{x:1,y:1},b=JL(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:v,offsetParent:y,strategy:l}):v);return{top:(g.top-b.top+f.top)/w.y,bottom:(b.bottom-g.bottom+f.bottom)/w.y,left:(g.left-b.left+f.left)/w.x,right:(b.right-g.right+f.right)/w.x}}const ZL=new Set(["left","top"]);function QL(){return"undefined"!=typeof window}function eI(e){return rI(e)?(e.nodeName||"").toLowerCase():"#document"}function tI(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function nI(e){var t;return null==(t=(rI(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function rI(e){return!!QL()&&(e instanceof Node||e instanceof tI(e).Node)}function oI(e){return!!QL()&&(e instanceof Element||e instanceof tI(e).Element)}function iI(e){return!!QL()&&(e instanceof HTMLElement||e instanceof tI(e).HTMLElement)}function aI(e){return!(!QL()||"undefined"==typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof tI(e).ShadowRoot)}const sI=new Set(["inline","contents"]);function lI(e){const{overflow:t,overflowX:n,overflowY:r,display:o}=bI(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!sI.has(o)}const cI=new Set(["table","td","th"]);function uI(e){return cI.has(eI(e))}const dI=[":popover-open",":modal"];function pI(e){return dI.some(t=>{try{return e.matches(t)}catch(n){return!1}})}const hI=["transform","translate","scale","rotate","perspective"],fI=["transform","translate","scale","rotate","perspective","filter"],mI=["paint","layout","strict","content"];function gI(e){const t=vI(),n=oI(e)?bI(e):e;return hI.some(e=>!!n[e]&&"none"!==n[e])||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||fI.some(e=>(n.willChange||"").includes(e))||mI.some(e=>(n.contain||"").includes(e))}function vI(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}const yI=new Set(["html","body","#document"]);function wI(e){return yI.has(eI(e))}function bI(e){return tI(e).getComputedStyle(e)}function kI(e){return oI(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function xI(e){if("html"===eI(e))return e;const t=e.assignedSlot||e.parentNode||aI(e)&&e.host||nI(e);return aI(t)?t.host:t}function CI(e){const t=xI(e);return wI(t)?e.ownerDocument?e.ownerDocument.body:e.body:iI(t)&&lI(t)?t:CI(t)}function SI(e,t,n){var r;void 0===t&&(t=[]),void 0===n&&(n=!0);const o=CI(e),i=o===(null==(r=e.ownerDocument)?void 0:r.body),a=tI(o);if(i){const e=MI(a);return t.concat(a,a.visualViewport||[],lI(o)?o:[],e&&n?SI(e):[])}return t.concat(o,SI(o,[],n))}function MI(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function TI(e){const t=bI(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const o=iI(e),i=o?e.offsetWidth:n,a=o?e.offsetHeight:r,s=_L(n)!==i||_L(r)!==a;return s&&(n=i,r=a),{width:n,height:r,$:s}}function OI(e){return oI(e)?e:e.contextElement}function _I(e){const t=OI(e);if(!iI(t))return NL(1);const n=t.getBoundingClientRect(),{width:r,height:o,$:i}=TI(t);let a=(i?_L(n.width):n.width)/r,s=(i?_L(n.height):n.height)/o;return a&&Number.isFinite(a)||(a=1),s&&Number.isFinite(s)||(s=1),{x:a,y:s}}const NI=NL(0);function EI(e){const t=tI(e);return vI()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:NI}function DI(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1);const o=e.getBoundingClientRect(),i=OI(e);let a=NL(1);t&&(r?oI(r)&&(a=_I(r)):a=_I(e));const s=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==tI(e))&&t}(i,n,r)?EI(i):NL(0);let l=(o.left+s.x)/a.x,c=(o.top+s.y)/a.y,u=o.width/a.x,d=o.height/a.y;if(i){const e=tI(i),t=r&&oI(r)?tI(r):r;let n=e,o=MI(n);for(;o&&r&&t!==n;){const e=_I(o),t=o.getBoundingClientRect(),r=bI(o),i=t.left+(o.clientLeft+parseFloat(r.paddingLeft))*e.x,a=t.top+(o.clientTop+parseFloat(r.paddingTop))*e.y;l*=e.x,c*=e.y,u*=e.x,d*=e.y,l+=i,c+=a,n=tI(o),o=MI(n)}}return JL({width:u,height:d,x:l,y:c})}function AI(e,t){const n=kI(e).scrollLeft;return t?t.left+n:DI(nI(e)).left+n}function $I(e,t){const n=e.getBoundingClientRect();return{x:n.left+t.scrollLeft-AI(e,n),y:n.top+t.scrollTop}}const RI=new Set(["absolute","fixed"]);function LI(e,t,n){let r;if("viewport"===t)r=function(e,t){const n=tI(e),r=nI(e),o=n.visualViewport;let i=r.clientWidth,a=r.clientHeight,s=0,l=0;if(o){i=o.width,a=o.height;const e=vI();(!e||e&&"fixed"===t)&&(s=o.offsetLeft,l=o.offsetTop)}const c=AI(r);if(c<=0){const e=r.ownerDocument,t=e.body,n=getComputedStyle(t),o="CSS1Compat"===e.compatMode&&parseFloat(n.marginLeft)+parseFloat(n.marginRight)||0,a=Math.abs(r.clientWidth-t.clientWidth-o);a<=25&&(i-=a)}else c<=25&&(i+=c);return{width:i,height:a,x:s,y:l}}(e,n);else if("document"===t)r=function(e){const t=nI(e),n=kI(e),r=e.ownerDocument.body,o=OL(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=OL(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+AI(e);const s=-n.scrollTop;return"rtl"===bI(r).direction&&(a+=OL(t.clientWidth,r.clientWidth)-o),{width:o,height:i,x:a,y:s}}(nI(e));else if(oI(t))r=function(e,t){const n=DI(e,!0,"fixed"===t),r=n.top+e.clientTop,o=n.left+e.clientLeft,i=iI(e)?_I(e):NL(1);return{width:e.clientWidth*i.x,height:e.clientHeight*i.y,x:o*i.x,y:r*i.y}}(t,n);else{const n=EI(e);r={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return JL(r)}function II(e,t){const n=xI(e);return!(n===t||!oI(n)||wI(n))&&("fixed"===bI(n).position||II(n,t))}function PI(e,t,n){const r=iI(t),o=nI(t),i="fixed"===n,a=DI(e,!0,i,t);let s={scrollLeft:0,scrollTop:0};const l=NL(0);function c(){l.x=AI(o)}if(r||!r&&!i)if(("body"!==eI(t)||lI(o))&&(s=kI(t)),r){const e=DI(t,!0,i,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else o&&c();i&&!r&&o&&c();const u=!o||r||i?NL(0):$I(o,s);return{x:a.left+s.scrollLeft-l.x-u.x,y:a.top+s.scrollTop-l.y-u.y,width:a.width,height:a.height}}function zI(e){return"static"===bI(e).position}function BI(e,t){if(!iI(e)||"fixed"===bI(e).position)return null;if(t)return t(e);let n=e.offsetParent;return nI(e)===n&&(n=n.ownerDocument.body),n}function FI(e,t){const n=tI(e);if(pI(e))return n;if(!iI(e)){let t=xI(e);for(;t&&!wI(t);){if(oI(t)&&!zI(t))return t;t=xI(t)}return n}let r=BI(e,t);for(;r&&uI(r)&&zI(r);)r=BI(r,t);return r&&wI(r)&&zI(r)&&!gI(r)?n:r||function(e){let t=xI(e);for(;iI(t)&&!wI(t);){if(gI(t))return t;if(pI(t))return null;t=xI(t)}return null}(e)||n}const jI={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:r,strategy:o}=e;const i="fixed"===o,a=nI(r),s=!!t&&pI(t.floating);if(r===a||s&&i)return n;let l={scrollLeft:0,scrollTop:0},c=NL(1);const u=NL(0),d=iI(r);if((d||!d&&!i)&&(("body"!==eI(r)||lI(a))&&(l=kI(r)),iI(r))){const e=DI(r);c=_I(r),u.x=e.x+r.clientLeft,u.y=e.y+r.clientTop}const p=!a||d||i?NL(0):$I(a,l);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+p.x,y:n.y*c.y-l.scrollTop*c.y+u.y+p.y}},getDocumentElement:nI,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:r,strategy:o}=e;const i="clippingAncestors"===n?pI(t)?[]:function(e,t){const n=t.get(e);if(n)return n;let r=SI(e,[],!1).filter(e=>oI(e)&&"body"!==eI(e)),o=null;const i="fixed"===bI(e).position;let a=i?xI(e):e;for(;oI(a)&&!wI(a);){const t=bI(a),n=gI(a);n||"fixed"!==t.position||(o=null),(i?!n&&!o:!n&&"static"===t.position&&o&&RI.has(o.position)||lI(a)&&!n&&II(e,a))?r=r.filter(e=>e!==a):o=t,a=xI(a)}return t.set(e,r),r}(t,this._c):[].concat(n),a=[...i,r],s=a[0],l=a.reduce((e,n)=>{const r=LI(t,n,o);return e.top=OL(r.top,e.top),e.right=TL(r.right,e.right),e.bottom=TL(r.bottom,e.bottom),e.left=OL(r.left,e.left),e},LI(t,s,o));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},getOffsetParent:FI,getElementRects:async function(e){const t=this.getOffsetParent||FI,n=this.getDimensions,r=await n(e.floating);return{reference:PI(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=TI(e);return{width:t,height:n}},getScale:_I,isElement:oI,isRTL:function(e){return"rtl"===bI(e).direction}},VI=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:o,y:i,placement:a,middlewareData:s}=t,l=await async function(e,t){const{placement:n,platform:r,elements:o}=e,i=await(null==r.isRTL?void 0:r.isRTL(o.floating)),a=RL(n),s=LL(n),l="y"===BL(n),c=ZL.has(a)?-1:1,u=i&&l?-1:1,d=$L(t,e);let{mainAxis:p,crossAxis:h,alignmentAxis:f}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return s&&"number"==typeof f&&(h="end"===s?-1*f:f),l?{x:h*u,y:p*c}:{x:p*c,y:h*u}}(t,e);return a===(null==(n=s.offset)?void 0:n.placement)&&null!=(r=s.arrow)&&r.alignmentOffset?{}:{x:o+l.x,y:i+l.y,data:M(M({},l),{},{placement:a})}}}},qI=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:o}=t,i=$L(e,t),{mainAxis:a=!0,crossAxis:s=!1,limiter:l={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}}}=i,c=C(i,f),u={x:n,y:r},d=await XL(t,c),p=BL(RL(o)),h=IL(p);let m=u[h],g=u[p];if(a){const e="y"===h?"bottom":"right";m=AL(m+d["y"===h?"top":"left"],m,m-d[e])}if(s){const e="y"===p?"bottom":"right";g=AL(g+d["y"===p?"top":"left"],g,g-d[e])}const v=l.fn(M(M({},t),{},{[h]:m,[p]:g}));return M(M({},v),{},{data:{x:v.x-n,y:v.y-r,enabled:{[h]:a,[p]:s}}})}}},HI=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:o,middlewareData:i,rects:a,initialPlacement:s,platform:l,elements:c}=t,u=$L(e,t),{mainAxis:d=!0,crossAxis:p=!0,fallbackPlacements:f,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:v=!0}=u,y=C(u,h);if(null!=(n=i.arrow)&&n.alignmentOffset)return{};const w=RL(o),b=BL(s),k=RL(s)===s,x=await(null==l.isRTL?void 0:l.isRTL(c.floating)),S=f||(k||!v?[KL(s)]:function(e){const t=KL(e);return[jL(e),t,jL(t)]}(s)),M="none"!==g;!f&&M&&S.push(...WL(s,v,g,x));const T=[s,...S],O=await XL(t,y),_=[];let N=(null==(r=i.flip)?void 0:r.overflows)||[];if(d&&_.push(O[w]),p){const e=function(e,t,n){void 0===n&&(n=!1);const r=LL(e),o=FL(e),i=PL(o);let a="x"===o?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[i]>t.floating[i]&&(a=KL(a)),[a,KL(a)]}(o,a,x);_.push(O[e[0]],O[e[1]])}if(N=[...N,{placement:o,overflows:_}],!_.every(e=>e<=0)){var E,D;const e=((null==(E=i.flip)?void 0:E.index)||0)+1,t=T[e];if(t){if(!("alignment"===p&&b!==BL(t))||N.every(e=>BL(e.placement)!==b||e.overflows[0]>0))return{data:{index:e,overflows:N},reset:{placement:t}}}let n=null==(D=N.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:D.placement;if(!n)switch(m){case"bestFit":{var A;const e=null==(A=N.filter(e=>{if(M){const t=BL(e.placement);return t===b||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:A[0];e&&(n=e);break}case"initialPlacement":n=s}if(o!==n)return{reset:{placement:n}}}return{}}}},UI=(e,t,n)=>{const r=new Map,o=M({platform:jI},n),i=M(M({},o.platform),{},{_c:r});return(async(e,t,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:i=[],platform:a}=n,s=i.filter(Boolean),l=await(null==a.isRTL?void 0:a.isRTL(t));let c=await a.getElementRects({reference:e,floating:t,strategy:o}),{x:u,y:d}=GL(c,r,l),p=r,h={},f=0;for(let m=0;m<s.length;m++){const{name:n,fn:i}=s[m],{x:g,y:v,data:y,reset:w}=await i({x:u,y:d,initialPlacement:r,placement:p,strategy:o,middlewareData:h,rects:c,platform:a,elements:{reference:e,floating:t}});u=null!=g?g:u,d=null!=v?v:d,h=M(M({},h),{},{[n]:M(M({},h[n]),y)}),w&&f<=50&&(f++,"object"==typeof w&&(w.placement&&(p=w.placement),w.rects&&(c=!0===w.rects?await a.getElementRects({reference:e,floating:t,strategy:o}):w.rects),({x:u,y:d}=GL(c,p,l))),m=-1)}return{x:u,y:d,placement:p,strategy:o,middlewareData:h}})(e,t,M(M({},o),{},{platform:i}))};var WI=new WeakMap,KI=new WeakMap,YI=new WeakMap,JI=new WeakMap,GI=new WeakMap,XI=new WeakMap,ZI=new WeakMap,QI=new WeakMap,eP=new WeakMap,tP=new WeakMap,nP=new WeakSet;class rP{constructor(e){var t,n,r,o;!function(e,t){y(e,t),t.add(e)}(this,nP),v(this,WI,void 0),v(this,KI,void 0),v(this,YI,void 0),v(this,JI,void 0),v(this,GI,void 0),v(this,XI,void 0),v(this,ZI,void 0),v(this,QI,void 0),v(this,eP,void 0),v(this,tP,void 0),b(XI,this,!1),this.onShow=()=>{},this.onHide=()=>{},b(tP,this,(e,t)=>{var n;const{state:r,composing:o}=e,{selection:i,doc:a}=r,{ranges:s}=i,l=Math.min(...s.map(e=>e.$from.pos)),c=Math.max(...s.map(e=>e.$to.pos)),u=t&&t.doc.eq(a)&&t.selection.eq(i);if(!w(XI,this)){var d,p;(null!==(d=null!==(p=w(GI,this))&&void 0!==p?p:e.dom.parentElement)&&void 0!==d?d:document.body).appendChild(this.element),b(XI,this,!0)}if(o||u)return;if(!w(KI,this).call(this,e,t))return void this.hide();UI({getBoundingClientRect:()=>LO(e,l,c)},this.element,{placement:null!==(n=w(JI,this).placement)&&void 0!==n?n:"top",middleware:[HI(),VI(w(ZI,this)),qI(w(QI,this)),...w(YI,this)]}).then(({x:e,y:t})=>{Object.assign(this.element.style,{left:`${e}px`,top:`${t}px`})}).catch(console.error),this.show()}),this.update=(e,t)=>{w(eP,this).call(this,e,t)},this.destroy=()=>{w(eP,this).cancel()},this.show=e=>{this.element.dataset.show="true",e&&UI(e,this.element,M({placement:"top",middleware:[HI(),VI(w(ZI,this)),qI(w(QI,this)),...w(YI,this)]},w(JI,this))).then(({x:e,y:t})=>{Object.assign(this.element.style,{left:`${e}px`,top:`${t}px`})}).catch(console.error),this.onShow()},this.hide=()=>{"false"!==this.element.dataset.show&&(this.element.dataset.show="false",this.onHide())},this.element=e.content,b(WI,this,null!==(t=e.debounce)&&void 0!==t?t:200),b(KI,this,null!==(n=e.shouldShow)&&void 0!==n?n:k(nP,this,oP)),b(ZI,this,e.offset),b(QI,this,e.shift),b(YI,this,null!==(r=e.middleware)&&void 0!==r?r:[]),b(JI,this,null!==(o=e.floatingUIOptions)&&void 0!==o?o:{}),b(GI,this,e.root),this.element.dataset.show="false",b(eP,this,function(e,t,n){var r=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return xE(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),DE(e,t,{leading:r,maxWait:t,trailing:o})}(w(tP,this),w(WI,this)))}}function oP(e){const{doc:t,selection:n}=e.state,{empty:r,from:o,to:i}=n,a=!t.textBetween(o,i).length&&e.state.selection instanceof Tk,s=this.element.contains(document.activeElement),l=!e.hasFocus()&&!s,c=!e.editable;return!(l||r||a||c)}function iP(e){const t=YN({},`${e}_TOOLTIP_SPEC`),n=KN(n=>{const r=n.get(t.key);return new jk(M({key:new Hk(`${e}_TOOLTIP`)},r))}),r=[t,n];return r.key=t.key,r.pluginKey=n.key,t.meta={package:"@milkdown/plugin-tooltip",displayName:`Ctx<tooltipSpec>|${e}`},n.meta={package:"@milkdown/plugin-tooltip",displayName:`Prose<tooltip>|${e}`},r}const aP=YN(null,"tableTooltip"),sP=iP("TABLE"),lP=["draggable"],cP=Ye({__name:"TableSelectorWidget",setup(e){var t;const{spec:n}=Je(vM),r=null==n?void 0:n.type,o=null!==(t=null==n?void 0:n.index)&&void 0!==t?t:0,[i,a]=hw(),s=ct(null),l=ct(!1),c=Xe(()=>"absolute bg-grey-200 "+(l.value?"border border-blue-400 border-2":"")),u=Xe(()=>"left"===r?"w-1w h-100 left-n3-5v top-0 fr-py-1v":"top"===r?"right-px h-1w w-100 left-0 top-n3-5v":"h-3v w-3v left-n2w top-n2w rounded-circle");function d(e){e.stopPropagation();const t=s.value;if(!t)return;if(i.value)return;a().action(e=>{var n;const i=e.get(aP.key);null==i||null===(n=i.getInstance())||void 0===n||n.setProps({getReferenceClientRect:()=>t.getBoundingClientRect()}),null==i||i.show();const a=e.get(k_);"left"===r?a.call(AR.key,o):"top"===r?a.call($R.key,o):a.call(RR.key)})}function p(e){e.stopPropagation();const t={index:null==n?void 0:n.index,type:null==n?void 0:n.type};e.dataTransfer&&(e.dataTransfer.setData("application/milkdown-table-sort",JSON.stringify(t)),e.dataTransfer.effectAllowed="move")}function h(e){l.value=!0,e.stopPropagation(),e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="move")}function f(){l.value=!1}function m(e){var t,o;if(l.value=!1,"top-left"===r)return;const s=null==n?void 0:n.index;if(i.value||null==s)return;const c=null!==(t=null===(o=e.dataTransfer)||void 0===o?void 0:o.getData("application/milkdown-table-sort"))&&void 0!==t?t:"";try{const{index:e,type:t}=JSON.parse(c);a().action(n=>{const r=n.get(k_),o={from:Number(e),to:s};r.call("left"===t?ER.key:DR.key,o)})}catch(u){}}return(e,t)=>(Ze(),Qe("button",{ref_key:"containerRef",ref:s,draggable:"top-left"!==rt(r),class:lt(["table-selector block fr-p-0",u.value+" "+c.value]),onClick:d,onDragstart:p,onDragover:h,onDragleave:f,onDrop:m},null,42,lP))}}),uP=An(cP,[["__scopeId","data-v-e26c3559"]]);function dP(e){return KN(()=>{const t=new Hk("MILKDOWN_TABLE_SELECTOR");return new jk({key:t,state:{init:()=>({decorations:ES.empty,pos:0}),apply(t,n,r,o){const i=function(e,t){const n=s$(t.$from);if(!n)return;const r=zA.get(n.node);return(Array.isArray(e)?e:[e]).filter(e=>e>=0&&e<=r.width-1).flatMap(e=>r.cellsInRect({left:e,right:e+1,top:0,bottom:r.height}).map(e=>{const t=n.node.nodeAt(e),r=e+n.start;return{pos:r,start:r+1,node:t,depth:n.depth+2}}))}(0,t.selection);if(!i)return{decorations:ES.empty,pos:0};const a=function(e,t){const n=s$(t.$from);if(!n)return;const r=zA.get(n.node);return(Array.isArray(e)?e:[e]).filter(e=>e>=0&&e<=r.height-1).flatMap(e=>r.cellsInRect({left:0,right:r.width,top:e,bottom:e+1}).map(e=>{const t=n.node.nodeAt(e),r=e+n.start;return{pos:r,start:r+1,node:t,depth:n.depth+2}}))}(0,t.selection);if(!a)return{decorations:ES.empty,pos:0};const s=e({as:"div",component:uP}),[l]=i;if(!l)return{decorations:ES.empty,pos:0};const c=[];return c.push(s(l.pos+1,{type:"top-left"})),i.forEach((e,t)=>{c.push(s(e.pos+1,{type:"left",index:t}))}),a.forEach((e,t)=>{c.push(s(e.pos+1,{type:"top",index:t}))}),n.pos===l.pos&&r.doc.eq(o.doc)?n:{decorations:ES.create(t.doc,c),pos:l.pos}}},props:{decorations:e=>t.getState(e).decorations}})})}const pP=YN(null,"linkEditTooltip"),hP=YN({from:-1,to:-1,mark:null},"linkTooltipStateCtx"),fP=iP("LINK_EDIT"),mP=qN("InsertLink",e=>()=>()=>gP(e));function gP(e){var t;const n=e.get(XO),{selection:r}=n.state;if(r.empty)return!1;e.update(hP.key,()=>({from:r.from,to:r.to,mark:null})),n.dispatch(n.state.tr.setSelection(Tk.create(n.state.doc,r.from,r.to)));const o=e.get(pP.key);return null==o||null===(t=o.getInstance())||void 0===t||t.setProps({getReferenceClientRect:()=>LO(n,r.from,r.to)}),null==o||o.show(),!0}const vP=[pP,fP,hP,mP].flat();function yP(e,t){const n=ct(null);return{tooltipProvider:n,setTooltipProvider:r=>{n.value=r;const o=rn(e());null!=o&&o.ctx&&o.ctx.isInjected(t)&&(o.ctx.set(t,r),n.value=r)}}}function wP(e,t){const{view:n}=hM(),[r,o]=hw(),{tooltipProvider:i,setTooltipProvider:a}=yP(o,e);return ft([t,r,i,n],([e,t,n,r],[o,i,s,l],c)=>{if(e&&!t&&!n&&r&&r.state){const t=Kr(e);if(t instanceof HTMLElement){const e=new rP({content:t,tippyOptions:{zIndex:30},shouldShow:()=>!1});e.update(r),a(e)}c(()=>null==s?void 0:s.destroy())}}),{tooltipProvider:i}}const bP={class:"bg-white border border-default-grey fr-py-1w fr-px-3v rounded-xxs drop-shadow fr-grid-row fr-grid-row--middle no-wrap"};const kP=An({},[["render",function(e,t){return Ze(),Qe("div",bP,[tt(e.$slots,"default")])}]]);function xP(){const e=Je(CP);return{link:Ft(e),updateLink(t){e.value=t}}}const CP=Symbol(),SP=["placeholder","onKeydown"],MP=Ye({__name:"LinkEditTooltip",setup(e){const{t:t}=H(),n=ct(null),{link:r,updateLink:o}=xP(),i=ct("");St(()=>{i.value=r.value});const{view:a}=hM(),[s,l]=hw(),{tooltipProvider:c}=wP(pP.key,n);function u(){var e;o(""),null===(e=c.value)||void 0===e||e.hide()}function d(){const e=rn(l());if(!e)return;const{mark:t}=e.ctx.get(hP.key),n=oD.type(e.ctx);t&&t.attrs.href===i.value||function(e,t,n){const r=e.state.tr;n&&r.removeMark(e.state.selection.from,e.state.selection.to,n),r.addMark(e.state.selection.from,e.state.selection.to,t),e.dispatch(r)}(a.value,n.create({href:i.value}),t),u()}function p(e){"Escape"===e.key&&u()}return(e,r)=>(Ze(),nt(kP,{ref_key:"toolTipRef",ref:n},{default:it(()=>[Vt(dt("input",{class:"input-area",placeholder:rt(t)("Paste link..."),ref:"linkInput",onKeydown:[Xt(zt(d,["stop","prevent"]),["enter"]),p],"onUpdate:modelValue":r[0]||(r[0]=e=>i.value=e)},null,40,SP),[[qt,i.value]]),dt("button",{class:lt(["fr-ml-1w fr-button fr-btn--sm fr-btn--tertiary-no-outline",{"fr-hidden":0===i.value.length}]),onClick:d},pt(rt(t)("Confirm ")),3)]),_:1},512))}});const TP=YN(null,"linkPreviewTooltip"),OP=iP("LINK_PREVIEW"),_P=[TP,OP].flat(),NP={class:"text-overflow-ellipsis"},EP=["href"],DP=["title"],AP=Ye({__name:"LinkPreviewTooltip",setup(e){const{t:t}=H(),n=ct(null),{tooltipProvider:r}=wP(TP.key,n),{view:o}=hM(),[i,a]=hw(),{link:s}=xP();function l(){var e;const t=rn(a());if(!t)return;const{from:n,to:i}=t.ctx.get(hP.key);null===(e=r.value)||void 0===e||e.hide(),o.value.dispatch(o.value.state.tr.setSelection(Tk.create(o.value.state.doc,n,i))),gP(t.ctx)}function c(){var e;const t=rn(a());if(!t)return;const{from:n,to:i,mark:s}=t.ctx.get(hP.key);s&&function(e,t,n,r){const o=e.state.tr;r&&o.removeMark(t,n,r),e.dispatch(o)}(o.value,n,i,s),null===(e=r.value)||void 0===e||e.hide()}return(e,r)=>(Ze(),nt(kP,{ref_key:"toolTipRef",ref:n,class:lt({"fr-hidden":0===rt(s).length})},{default:it(()=>[r[0]||(r[0]=dt("span",{"aria-hidden":"true",class:"fr-icon-link fr-mr-1w"},null,-1)),dt("div",NP,[dt("a",{class:"fr-link",href:rt(s)},pt(rt(s)),9,EP)]),dt("button",{class:"fr-btn fr-btn--secondary fr-btn--sm fr-icon-pencil-line fr-mx-1w",onClick:l},pt(rt(t)("Edit link")),1),dt("button",{class:"fr-btn fr-btn--tertiary fr-btn--sm fr-icon-link-unlink",title:rt(t)("Remove link"),onClick:c},pt(rt(t)("Remove link")),9,DP)]),_:1},8,["class"]))}});function $P(e,t){const n=mM(),r=ct(!1),o=()=>{r.value=!0},i=()=>{r.value=!1},a=vm((n,r)=>{if(!n.hasFocus())return;const a=function(e,t,n){const{node:r,pos:o}=function(e,t){const n=t.posAtCoords(e);if(!n)return{node:null,pos:null};const{pos:r}=n;return{node:t.state.doc.nodeAt(r),pos:r}}({left:n.clientX,top:n.clientY},t);if(!r)return;const i=function(e,t){return e.marks.find(e=>e.type===t)}(r,oD.mark.type(e));if(!i)return;return OP.pluginKey()?{show:!0,pos:o,node:r,mark:i}:void 0}(e,n,r),l=e.get(TP.key);if(a){var c,u,d;const r=n.state.doc.resolve(a.pos),s=function(e,t,n,r){let o={start:-1,end:-1};return t.nodesBetween(n,r,(t,n)=>{if(o.start>-1)return!1;-1===o.start&&e.isInSet(t.marks)&&(o={start:n,end:n+Math.max(t.textContent.length,1)})}),o}(a.mark,n.state.doc,r.before(),r.after()),p=e.get(OP.key);if(!p||!p.view)return;return null==l||null===(c=l.getInstance())||void 0===c||c.setProps({getReferenceClientRect:()=>LO(n,s.start,s.end)}),e.update(hP.key,()=>({from:s.start,to:s.end,mark:a.mark})),t(a.mark.attrs.href),null==l||l.show(),null==l||null===(u=l.getInstance())||void 0===u||u.popper.addEventListener("mouseenter",o),void(null==l||null===(d=l.getInstance())||void 0===d||d.popper.addEventListener("mouseleave",i))}s()},200),s=()=>{setTimeout(()=>{var n,a,s;if(r.value)return;const l=e.get(TP.key),c=e.get(pP.key);null==l||l.hide(),null!=c&&null!==(n=c.getInstance())&&void 0!==n&&n.state.isVisible||t(""),null==l||null===(a=l.getInstance())||void 0===a||a.popper.removeEventListener("mouseenter",o),null==l||null===(s=l.getInstance())||void 0===s||s.popper.removeEventListener("mouseleave",i)},200)};e.set(OP.key,{props:{handleDOMEvents:{mousemove:a,mouseleave:s}},view:n({component:AP})})}const RP=["innerHTML"],LP=Ye({__name:"TooltipButton",props:{icon:{},svg:{}},emits:["click"],setup(e,{emit:t}){const n=e,r=n.icon?n.icon:"fr-icon-svg",o=t;return(t,n)=>(Ze(),Qe("button",{class:lt(["fr-btn fr-btn--secondary fr-btn--sm bg-white",rt(r)]),onClick:n[0]||(n[0]=e=>o("click"))},[e.svg?(Ze(),Qe("div",{key:0,innerHTML:e.svg},null,8,RP)):st("",!0),tt(t.$slots,"default")],2))}}),IP={class:"fr-hidden"},PP=Ye({__name:"TableTooltip",setup(e){const{t:t}=H(),n=ct(null),{view:r}=hM(),[o,i]=hw(),{tooltipProvider:a}=wP(aP.key,n),s=Xe(()=>r.value.state.selection instanceof QA&&r.value.state.selection.isRowSelection()),l=Xe(()=>r.value.state.selection instanceof QA&&r.value.state.selection.isColSelection()),c=Xe(()=>s.value&&l.value),u=Xe(()=>s.value||l.value),d=Xe(()=>{var e;return s.value&&"table_header"===(null===(e=r.value.state.doc.nodeAt(r.value.state.selection.$headCell.pos))||void 0===e?void 0:e.type.name)});return(e,r)=>(Ze(),Qe("div",IP,[dt("div",{class:"fr-grid-row",ref_key:"toolTipRef",ref:n},[c.value||d.value||!s.value?st("",!0):(Ze(),nt(LP,{key:0,icon:"fr-icon-arrow-up-line",class:"fr-mr-1v",title:rt(t)("Add row before"),onClick:r[0]||(r[0]=()=>{var e,t;rt(o)||(null===(e=rt(i)())||void 0===e||e.action(e=>{e.get(rt(k_)).call(rt(zR).key)}),null===(t=rt(a))||void 0===t||t.hide())})},null,8,["title"])),!c.value&&l.value?(Ze(),nt(LP,{key:1,icon:"fr-icon-arrow-left-line",class:"fr-mr-1v",title:rt(t)("Add column before"),onClick:r[1]||(r[1]=()=>{var e,t;rt(o)||(null===(e=rt(i)())||void 0===e||e.action(e=>{e.get(rt(k_)).call(rt(IR).key)}),null===(t=rt(a))||void 0===t||t.hide())})},null,8,["title"])):st("",!0),c.value||!d.value&&u.value?(Ze(),nt(LP,{key:2,icon:"fr-icon-delete-line",class:"fr-mr-1v",title:rt(t)("Delete selected cells"),onClick:r[2]||(r[2]=()=>{var e,t;rt(o)||(null===(e=rt(i)())||void 0===e||e.action(e=>{e.get(rt(k_)).call(rt(LR).key)}),null===(t=rt(a))||void 0===t||t.hide())})},null,8,["title"])):st("",!0),!c.value&&s.value?(Ze(),nt(LP,{key:3,icon:"fr-icon-arrow-down-line",class:"fr-mr-1v",title:rt(t)("Add row after"),onClick:r[3]||(r[3]=()=>{var e,t;rt(o)||(null===(e=rt(i)())||void 0===e||e.action(e=>{e.get(rt(k_)).call(rt(BR).key)}),null===(t=rt(a))||void 0===t||t.hide())})},null,8,["title"])):st("",!0),!c.value&&l.value?(Ze(),Qe(Mt,{key:4},[ut(LP,{icon:"fr-icon-arrow-right-line",class:"fr-mr-1v",title:rt(t)("Add column after"),onClick:r[4]||(r[4]=()=>{var e,t;rt(o)||(null===(e=rt(i)())||void 0===e||e.action(e=>{e.get(rt(k_)).call(rt(PR).key)}),null===(t=rt(a))||void 0===t||t.hide())})},null,8,["title"]),ut(LP,{svg:rt('<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M3 10L17 10" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 6H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 18L17 18" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 14H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'),class:"fr-mr-1v",title:rt(t)("Align left"),onClick:r[5]||(r[5]=()=>{var e;rt(o)||null===(e=rt(i)())||void 0===e||e.action(e=>{e.get(rt(k_)).call(rt(FR).key,"left")})})},null,8,["svg","title"]),ut(LP,{class:"fr-mr-1v",svg:rt('<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M3 6H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 14H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M6 10L18 10" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M6 18L18 18" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'),title:rt(t)("Align center"),onClick:r[6]||(r[6]=()=>{var e;rt(o)||null===(e=rt(i)())||void 0===e||e.action(e=>{e.get(rt(k_)).call(rt(FR).key,"center")})})},null,8,["svg","title"]),ut(LP,{class:"fr-mr-1v",svg:rt('<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M7 10L21 10" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 6H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M7 18L21 18" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 14H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'),title:rt(t)("Align right"),onClick:r[7]||(r[7]=()=>{var e;rt(o)||null===(e=rt(i)())||void 0===e||e.action(e=>{e.get(rt(k_)).call(rt(FR).key,"right")})})},null,8,["svg","title"])],64)):st("",!0)],512)]))}}),zP={class:"editor__container"},BP={class:"fr-mx-auto fr-grid-row fr-pb-1v",role:"menubar"},FP={role:"group",class:"fr-pr-1w"},jP={role:"group",class:"fr-pr-1w"},VP={role:"group",class:"fr-px-1w"},qP={role:"group",class:"fr-pl-1w"},HP={class:"fr-p-1v"},UP=Ye({__name:"InternalEditor",props:{ariaLabel:{},ariaLabelledBy:{},id:{},disabled:{type:Boolean,default:!1},value:{default:""}},emits:["change","editorMounted"],setup(e,{emit:t}){const n=e,r=t,o=vm(e=>r("change",e),300),{t:i}=H(),a=mM(),s=Je(yM),{updateLink:l}=xP(),c=lL.findIndex(e=>e===nL);lL[c]=ML;const u=[lL,sP,aP,e=>async()=>{e.set(sP.key,{view:a({component:PP})})},dP(s)].flat(),d=function(e){const{editorFactory:t,loading:n,editor:r}=Je(uw);return t.value=e,{loading:n,get:()=>r.value}}(e=>xN.make().config(t=>{t.set(nN,e),function(e){const t=mM();e.set(fP.key,{view:t({component:MP})})}(t),$P(t,l),t.set(V_,n.value),t.set(gD.key,e=>{const t=e.attrs.level;return 1===t?{class:"fr-h1"}:2===t?{class:"fr-h2"}:3===t?{class:"fr-h3"}:4===t?{class:"fr-h4"}:5===t?{class:"fr-h5"}:6===t?{class:"fr-h6"}:{}}),t.update(tN,e=>{const t=e.attributes;return M(M({},e),{},{attributes:e=>{const r="function"==typeof t?t(e):null!=t?t:{};return r.id=n.id,r["data-testid"]="markdown-editor",n.ariaLabelledBy?r["aria-labelledby"]=n.ariaLabelledBy:n.ariaLabel&&(r.ariaLabel=n.ariaLabel),M({},r)},editable:()=>!n.disabled})}),t.set(uD.key,()=>({class:"text-lg"})),t.get($E).markdownUpdated((e,t,n)=>o(t)),t.get($E).mounted(e=>{r("editorMounted")})}).use(LA).use(u).use(sE).use(vP).use(_P).use(LE));function p(e,t){var n;return null===(n=d.get())||void 0===n?void 0:n.action(function(e,t){return n=>n.get(k_).call(e,t)}(e,t))}return(e,t)=>(Ze(),Qe("div",zP,[dt("div",BP,[dt("div",FP,[ut(cL,{icon:"fr-icon-arrow-go-back-line",onClick:t[0]||(t[0]=()=>p(rt(nE).key)),title:rt(i)("Undo")},null,8,["title"]),ut(cL,{icon:"fr-icon-arrow-go-forward-line",onClick:t[1]||(t[1]=()=>p(rt(rE).key)),title:rt(i)("Redo")},null,8,["title"])]),t[13]||(t[13]=dt("div",{role:"separator",class:"w-1px bg-grey-125 fr-my-1v"},null,-1)),dt("div",jP,[ut(cL,{icon:"fr-icon-bold",onClick:t[2]||(t[2]=()=>p(rt(JE).key)),title:rt(i)("Bold")},null,8,["title"]),ut(cL,{icon:"fr-icon-italic",onClick:t[3]||(t[3]=()=>p(rt(qE).key)),title:rt(i)("Italic")},null,8,["title"]),ut(cL,{icon:"fr-icon-h-1",onClick:t[4]||(t[4]=()=>p(rt(wD).key,3)),title:rt(i)("Title")},null,8,["title"]),ut(cL,{icon:"fr-icon-h-2",onClick:t[5]||(t[5]=()=>p(rt(wD).key,4)),title:rt(i)("Subtitle")},null,8,["title"])]),t[14]||(t[14]=dt("div",{role:"separator",class:"w-1px bg-grey-125 fr-my-1v"},null,-1)),dt("div",VP,[ut(cL,{icon:"fr-icon-table-2",onClick:t[6]||(t[6]=()=>p(rt(NR).key)),title:rt(i)("Table")},null,8,["title"]),ut(cL,{icon:"fr-icon-link",onClick:t[7]||(t[7]=()=>p(rt(mP).key)),title:rt(i)("Link")},null,8,["title"]),ut(CL,{onSend:t[8]||(t[8]=e=>p(rt(RD).key,e))})]),t[15]||(t[15]=dt("div",{role:"separator",class:"w-1px bg-grey-125 fr-my-1v"},null,-1)),dt("div",qP,[ut(cL,{icon:"fr-icon-list-unordered",onClick:t[9]||(t[9]=()=>p(rt(YD).key)),title:rt(i)("List unordered")},null,8,["title"]),ut(cL,{icon:"fr-icon-list-ordered",onClick:t[10]||(t[10]=()=>p(rt(QD).key)),title:rt(i)("List ordered")},null,8,["title"]),ut(cL,{icon:"fr-icon-code-s-slash-line",onClick:t[11]||(t[11]=()=>p(rt(ED).key)),title:rt(i)("Code block")},null,8,["title"]),ut(cL,{icon:"fr-icon-quote-line",onClick:t[12]||(t[12]=()=>p(rt(MD).key)),title:rt(i)("Quote")},null,8,["title"])])]),dt("div",HP,[ut(rt(dw))])]))}}),WP=Ye({__name:"MarkdownEditor",props:{ariaLabel:{},ariaLabelledBy:{},id:{},disabled:{type:Boolean},value:{}},emits:["change","editorMounted"],setup(e){const t=e;return function(){const e=ct("");Et(CP,e)}(),(e,n)=>(Ze(),nt(rt(pw),null,{default:it(()=>[ut(rt(bM),null,{default:it(()=>[ut(UP,et(t,{onChange:n[0]||(n[0]=t=>e.$emit("change",t)),onEditorMounted:n[1]||(n[1]=t=>e.$emit("editorMounted"))}),null,16)]),_:1})]),_:1}))}}),KP=["for"],YP={key:0,class:"fr-hint-text"},JP=["aria-describedby","id","disabled","type","value","placeholder","required"],GP={key:1,class:"fr-mt-1w"},XP=["aria-describedby","id","disabled","type","placeholder","value","required"],ZP=["id"],QP=["id"],ez=Ye({__name:"InputGroup",props:{ariaDescribedby:{default:""},disabled:{type:Boolean,default:!1},errorText:{default:""},hasError:{type:Boolean,default:!1},hasWarning:{type:Boolean,default:!1},hintText:{default:""},isValid:{type:Boolean,default:!1},label:{},modelValue:{default:void 0},placeholder:{default:""},required:{type:Boolean,default:!1},type:{default:"text"},validText:{default:""}},emits:["change","update:modelValue"],setup(e,{expose:t,emit:n}){const r=n,o=e,{id:i}=Bc("input");t({id:i});const a=Xe(()=>i+"-desc-error"),s=Xe(()=>i+"-desc-valid"),l=Xe(()=>{let e=o.ariaDescribedby?o.ariaDescribedby+" ":"";return o.isValid?e+=s.value:o.hasError&&(e+=a.value),e}),c=Xe(()=>({"fr-input-group--disabled":o.disabled,"fr-input-group--error":o.hasError,"fr-input-group--warning":!o.hasError&&o.hasWarning,"fr-input-group--valid":o.isValid})),u=Se(re);function d(e){let t;if(e instanceof Event){const n=e.target;t=null==n?void 0:n.value}else t=e;r("update:modelValue",t),r("change",t)}return(t,n)=>(Ze(),Qe("div",{class:lt(["fr-input-group",c.value])},[dt("label",{class:"fr-label",for:rt(i)},[Tt(pt(e.label)+" ",1),ut(rp,{required:e.required},null,8,["required"]),e.hintText?(Ze(),Qe("span",YP,pt(e.hintText),1)):st("",!0)],8,KP),"textarea"===e.type?(Ze(),Qe("textarea",{key:0,class:lt(["fr-input",{"fr-input--error":e.hasError,"fr-input--warning":!e.hasError&&rt(gy),"fr-input--valid":e.isValid}]),"aria-describedby":l.value,id:rt(i),disabled:e.disabled,type:e.type,value:e.modelValue,placeholder:e.placeholder,onChange:d,required:e.required},null,42,JP)):"date"===e.type?(Ze(),Qe("div",GP,[ut(rt(iw),{class:lt(["fr-input",{"fr-input--error":e.hasError,"fr-input--valid":e.isValid}]),"aria-describedby":l.value,id:rt(i),disabled:e.disabled,modelValue:e.modelValue,onChange:d,locale:rt(u),inputFormat:"P"},null,8,["class","aria-describedby","id","disabled","modelValue","locale"])])):"range"===e.type?(Ze(),nt(cw,{key:2,modelValue:e.modelValue,onChange:d},null,8,["modelValue"])):"markdown"===e.type?(Ze(),nt(WP,{key:3,class:lt(["fr-mt-1w",{"fr-input--error":e.hasError,"fr-input--warning":!e.hasError&&rt(gy),"fr-input--valid":e.isValid}]),"aria-describedby":l.value,id:rt(i),disabled:e.disabled,value:e.modelValue,placeholder:e.placeholder,onChange:d,required:e.required},null,8,["class","aria-describedby","id","disabled","value","placeholder","required"])):(Ze(),Qe("input",{key:4,class:lt(["fr-input",{"fr-input--error":e.hasError,"fr-input--valid":e.isValid}]),"aria-describedby":l.value,id:rt(i),disabled:e.disabled,type:e.type,placeholder:e.placeholder,value:e.modelValue,onChange:d,required:e.required},null,42,XP)),e.isValid?(Ze(),Qe("p",{key:5,id:s.value,class:"fr-valid-text"},pt(e.validText),9,ZP)):e.hasError?(Ze(),Qe("p",{key:6,id:a.value,class:"fr-error-text"},pt(e.errorText),9,QP)):st("",!0)],2))}}),tz=["aria-labelledby","id"],nz={class:"fr-container fr-container--fluid fr-container-md"},rz={class:"fr-grid-row fr-grid-row--center"},oz={class:"fr-col-12 fr-col-md-8"},iz={class:"fr-modal__body"},az={class:"fr-modal__header"},sz=["title","aria-controls","disabled"],lz={class:"fr-modal__content"},cz=["id"],uz=["href"],dz={class:"fr-modal__footer"},pz={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-lg fr-btns-group--icon-left"},hz=["aria-controls"],fz={class:"fr-modal__content"},mz=["id"],gz=["href"],vz={class:"fr-modal__footer"},yz={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-lg fr-btns-group--icon-left"},wz=["aria-controls","disabled"],bz=Ye({__name:"ReportModal",props:{id:{},loading:{type:Boolean},succeeded:{type:Boolean}},emits:["send"],setup(e,{emit:t}){const n=t,{t:r}=H(),o=G("modal-title"),i=ct(),a={reason:"",message:""},s=$t(M({},a)),l=ct([]),c={reason:{required:Ae},message:{required:Ae}},{getErrorText:u,getFunctionalState:d,hasError:p,reset:h,validateRequiredRules:f,v$:m}=hy(s,c,c),g=e=>p(v,e),v=Xe(()=>({reason:d(m.value.reason.$dirty,m.value.reason.$error,!1),message:d(m.value.message.$dirty,m.value.message.$error,!1)}));function y(){globalThis.dsfr(i.value).modal.conceal(),s.message=a.message,s.reason=a.reason,h()}function w(){f().then(e=>{e&&n("send",M({},s))})}return mt(async()=>{l.value=await async function(){return(await T.get(ye("reports/reasons/"))).data}()}),(t,n)=>{const a=jt("i18n-t");return Ze(),nt(At,{to:"body"},[dt("dialog",et(t.$attrs,{"aria-labelledby":rt(o),id:e.id,role:"dialog",class:"fr-modal",ref_key:"modalRef",ref:i}),[dt("div",nz,[dt("div",rz,[dt("div",oz,[dt("div",iz,[dt("div",az,[dt("button",{class:"fr-btn--close fr-btn",title:rt(r)("Close the modal dialog"),"aria-controls":e.id,target:"_self",disabled:e.loading,onClick:y},pt(rt(r)("Close")),9,sz)]),e.succeeded?(Ze(),Qe(Mt,{key:0},[dt("div",lz,[dt("h2",{id:rt(o),class:"fr-mb-2w"},[n[2]||(n[2]=dt("span",{class:"fr-icon-success-line fr-icon--lg"},null,-1)),Tt(pt(rt(r)("Thanks for reporting this content")),1)],8,cz),ut(a,{keypath:"{site} team will examine the content to check if it breaks our {markup}. Thanks for your help.",tag:"p",class:"fr-mt-0 fr-mb-1w fr-text--xs",scope:"global"},{site:it(()=>[Tt(pt(rt($e)),1)]),markup:it(()=>[dt("a",{href:rt(Re)},pt(rt(r)("usage policy")),9,uz)]),_:1})]),dt("div",dz,[dt("div",pz,[dt("button",{class:"fr-btn","aria-controls":e.id,target:"_self",onClickCapture:zt(y,["prevent","stop"])},pt(rt(r)("Close")),41,hz)])])],64)):(Ze(),Qe(Mt,{key:1},[dt("div",fz,[dt("h2",{id:rt(o),class:"fr-mb-2w"},pt(rt(r)("Report this content")),9,mz),ut(rt(Pc),{class:"fr-mb-2w",color:"warning",weight:"regular"},{default:it(()=>[n[3]||(n[3]=dt("span",{class:"fr-icon-warning-line fr-mr-1v","aria-hidden":"true"},null,-1)),Tt(" "+pt(rt(r)("Please only report in case of serious concern."))+" ",1),dt("a",{href:rt(Re)},pt(rt(r)("See our usage policy")),9,gz)]),_:1}),ut(Sy,{label:rt(r)("Report reason"),required:!0,modelValue:s.reason,"onUpdate:modelValue":n[0]||(n[0]=e=>s.reason=e),hasError:g("reason"),errorText:rt(u)("reason"),options:l.value},null,8,["label","modelValue","hasError","errorText","options"]),ut(ez,{type:"textarea",label:rt(r)("Message"),required:!0,hasError:g("message"),errorText:rt(u)("message"),modelValue:s.message,"onUpdate:modelValue":n[1]||(n[1]=e=>s.message=e),placeholder:rt(r)("Reason of your report.{newline}Don't include any personal data.")},null,8,["label","hasError","errorText","modelValue","placeholder"])]),dt("div",vz,[dt("div",yz,[dt("button",{class:"fr-btn","aria-controls":e.id,target:"_self",disabled:e.loading,onClickCapture:zt(w,["prevent","stop"])},pt(rt(r)("Send")),41,wz)])])],64))])])])])],16,tz)])}}}),kz=["aria-controls","disabled","title"],xz=Ye({__name:"ReportModalButton",props:{objectType:{},objectId:{}},setup(e){const t=e,{t:n}=H(),{toast:r}=_u(),o=ct(!1),i=ct(!1),a=G();async function s(e){try{o.value=!0,await async function(e,t,n,r){return(await T.post("/reports/",{subject:{id:t,class:e},reason:n,message:r})).data}(t.objectType,t.objectId,e.reason,e.message),i.value=!0}catch(Yo){r.error(n("An unexpected error occured while reporting this content."))}finally{o.value=!1}}return(e,t)=>(Ze(),Qe(Mt,null,[dt("button",et({class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 fr-icon-flag-line","data-fr-opened":"false","aria-controls":rt(a)},e.$attrs,{disabled:o.value,title:rt(n)("Make a report")}),pt(rt(n)("Make a report")),17,kz),ut(bz,{id:rt(a),loading:o.value,succeeded:i.value,onSend:s},null,8,["id","loading","succeeded"])],64))}}),Cz={class:"fr-grid-row fr-grid-row--middle justify-between","data-cy":"search"},Sz={class:"fr-search-bar fr-search-bar--lg w-100"},Mz=["for"],Tz=["id","aria-label","placeholder"],Oz={class:"fr-btn",type:"submit"},_z={class:"fr-grid-row fr-mt-1w fr-mt-md-5v"},Nz={class:"fr-col-12 fr-col-md-4 fr-col-lg-3"},Ez={class:"fr-sidemenu","aria-labelledby":"fr-sidemenu-title"},Dz={class:"fr-sidemenu__inner"},Az={class:"fr-sidemenu__btn fr-mt-1w",hidden:"","aria-controls":"fr-sidemenu-wrapper","aria-expanded":"false"},$z={class:"fr-collapse",id:"fr-sidemenu-wrapper"},Rz={class:"fr-sidemenu__title fr-mb-3v",id:"fr-sidemenu-title"},Lz={class:"fr-grid-row fr-grid-row--gutters"},Iz={key:0,class:"fr-col-12"},Pz={class:"fr-col-12"},zz={class:"fr-select-group"},Bz=["for"],Fz=["id"],jz={value:null},Vz={value:!1},qz={value:!0},Hz={key:1,class:"fr-col-12 fr-mb-3w text-align-center"},Uz={class:"fr-col-12 fr-col-md-8 fr-col-lg-9 fr-mt-2w fr-mt-md-0 search-results"},Wz={key:0},Kz={key:1,class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle justify-between fr-pb-1w"},Yz={class:"fr-col-auto fr-my-0",role:"status"},Jz={key:2},Gz={class:"fr-mt-1w border-default-grey border-top relative z-2"},Xz={key:3,class:"fr-mt-2w"},Zz=Ye({__name:"DataservicesSearch",props:{organization:{default:""}},setup(t){const n=t,{t:r}=H(),{toast:o}={toast:Ai},i=ct(null);ft(i,()=>l.value=1);const a=ct(null);ft(a,()=>l.value=1);const s=on(),l=ct(1),c=Xe(()=>i.value||null!==a.value),u=()=>{i.value="",a.value=null},d=()=>{h.value="",u(),g()},p=on(),h=ct(""),f=function(e,t=200,n={}){const r=ct(e.value),o=Hr(()=>{r.value=e.value},t,n);return ft(e,()=>o()),r}(h,500),m=an("searchInputRef"),g=()=>{m.value&&m.value.scrollIntoView({behavior:"smooth"})},v=Xe(()=>{const e={};return i.value&&(e.organization=i.value),f.value&&(e.q=f.value),null!==a.value&&(e.is_restricted=a.value.toString()),n.organization&&(e.organization=n.organization),l.value&&1!==l.value&&(e.page=l.value.toString()),new URLSearchParams(e)}),{ignoreUpdates:y}=function(t,n,r={}){const{eventFilter:o=qr}=r,i=C(r,e),a=Vr(o,n);let s,l,c;if("sync"===i.flush){const e=ct(!1);l=()=>{},s=t=>{e.value=!0,t(),e.value=!1},c=ft(t,(...t)=>{e.value||a(...t)},i)}else{const e=[],n=ct(0),r=ct(0);l=()=>{n.value=r.value},e.push(ft(t,()=>{r.value++},M(M({},i),{},{flush:"sync"}))),s=e=>{const t=r.value;e(),n.value+=r.value-t},e.push(ft(t,(...e)=>{const t=n.value>0&&n.value===r.value;n.value=0,r.value=0,t||a(...e)},i)),c=()=>{e.forEach(e=>e())}}return{stop:c,ignoreUpdates:s,ignorePrevAsyncUpdates:l}}(v,()=>{let e=new URL(window.location.href);e.search=v.value.toString(),window.history.pushState(null,"",e)}),w=Xe(()=>`/dataservices/search/?${v.value}`),b=ct(null),k=ct(null);ft(h,()=>{k.value&&k.value.abort(),l.value=1});const x=async()=>{b.value=null,k.value=new AbortController;try{const e=await we.get(w.value,{signal:k.value.signal});k.value=null,b.value=e.data}catch(Yo){X.isCancel(Yo)||o.error(r("Error getting search results."))}},S=()=>{const e=new URL(window.location.href);i.value=e.searchParams.get("organization"),h.value=e.searchParams.get("q")||"","true"===e.searchParams.get("is_restricted")?a.value=!0:"false"===e.searchParams.get("is_restricted")?a.value=!1:a.value=null,l.value=parseInt(e.searchParams.get("page")||"1")};mt(()=>{var e;S(),x(),null===(e=m.value)||void 0===e||e.focus(),window.addEventListener("popstate",()=>{y(()=>{S()})})}),ft(w,()=>{x()});const T=e=>{l.value=e};return(e,t)=>(Ze(),Qe("form",{class:"fr-pt-3v",onSubmit:zt(x,["prevent"])},[dt("div",Cz,[dt("section",Sz,[dt("label",{class:"fr-label",for:rt(p)},pt(rt(r)("Search")),9,Mz),Vt(dt("input",{id:rt(p),type:"search","onUpdate:modelValue":t[0]||(t[0]=e=>h.value=e),ref:"searchInputRef",class:"fr-input","aria-label":rt(r)("Search..."),placeholder:rt(r)("Search..."),"data-cy":"search-input","data-testid":"search-input"},null,8,Tz),[[qt,h.value]]),dt("button",Oz,pt(rt(r)("Search")),1)])]),dt("div",_z,[dt("div",Nz,[dt("nav",Ez,[dt("div",Dz,[dt("button",Az,pt(rt(r)("Filter results")),1),dt("div",$z,[dt("div",Rz,pt(rt(r)("Filters")),1),dt("div",Lz,[n.organization?st("",!0):(Ze(),Qe("div",Iz,[ut(gp,{placeholder:rt(r)("Organizations"),searchPlaceholder:rt(r)("Search an organization..."),allOption:rt(r)("All organizations"),listUrl:"/organizations/?sort=-followers",suggestUrl:"/organizations/suggest/",entityUrl:"/organizations/",values:i.value,onChange:t[1]||(t[1]=e=>i.value=e),isBlue:!0},null,8,["placeholder","searchPlaceholder","allOption","values"])])),dt("div",Pz,[dt("div",zz,[dt("label",{class:"fr-label",for:rt(s)},pt(rt(r)("Access terms")),9,Bz),Vt(dt("select",{class:lt(["fr-select",{"text-mention-grey":null===a.value}]),id:rt(s),"onUpdate:modelValue":t[2]||(t[2]=e=>a.value=e)},[dt("option",jz,pt(rt(r)("All access terms")),1),dt("option",Vz,pt(rt(r)("Open APIs to everyone")),1),dt("option",qz,pt(rt(r)("Restricted access APIs")),1)],10,Fz),[[Gt,a.value]])])]),c.value?(Ze(),Qe("div",Hz,[dt("button",{class:"fr-btn fr-btn--secondary fr-icon-close-circle-line fr-btn--icon-left justify-center w-100",onClick:u},pt(rt(r)("Reset filters")),1)])):st("",!0)])])])])]),dt("section",Uz,[null===b.value?(Ze(),Qe("div",Wz,[ut(Yd)])):st("",!0),null!==b.value?(Ze(),Qe("div",Kz,[dt("p",Yz,pt(rt(r)("{count} API",b.value.total)),1)])):st("",!0),null!==b.value&&b.value.data.length?(Ze(),Qe("div",Jz,[dt("ul",Gz,[(Ze(!0),Qe(Mt,null,Pt(b.value.data,e=>(Ze(),Qe("li",{key:e.id},[ut(rt(ha),{dataservice:e,dataserviceUrl:e.self_web_url},null,8,["dataservice","dataserviceUrl"])]))),128))]),null!==b.value&&b.value.total>b.value.page_size?(Ze(),nt(rt(Pa),{key:0,page:l.value,pageSize:b.value.page_size,totalResults:b.value.total,onChange:T,class:"fr-mt-2w"},null,8,["page","pageSize","totalResults"])):(Ze(),nt(Om,{key:1,onResetFilters:d}))])):st("",!0),null!==b.value&&0===b.value.data.length?(Ze(),Qe("div",Xz,[ut(Om,{onResetFilters:d})])):st("",!0)])])],32))}});Le({admin_root:Ie,api_root:Pe,api_2_root:ze,default_lang:Be.global.locale.value,only_locales:Be.global.locale.value,schema_documentation_url:Fe,schema_validata_url:je,show_copy_resource_permalink:!0,tabular_api_dataservice_id:Ve,tabular_api_url:qe,tabular_page_size:He,title:$e});document.querySelectorAll(".vuejs").forEach(e=>{const t=e.innerHTML;try{(async e=>{const t=sn({});if(Ue.dsn)try{const{default:e}=await U(()=>S.import("./sentry-legacy.6.2.4.js"),void 0);await e(t)}catch(n){console.warn("Failed to load Sentry:",n)}t.use(We),t.use(rv),t.use(Ke),t.use(Be),t.component("chart",Uc),t.component("dataset-resources",kv),t.component("dataset-resource-from-hash",Qg),t.component("dataservice-card",ha),t.component("dataservice-links",Hv),t.component("delete-button",fg),t.component("delete-user-button",Ng),t.component("discussion-threads",bd),t.component("discussion-create",hu),t.component("featured-button",Rg),t.component("follow-button",zg),t.component("menu-search",Rd),t.component("owner-type",Sa),t.component("owner-type-icon",Ir),t.component("read-more",Ba),t.component("report-button",xz),t.component("request-membership",Fg),t.component("reuse-card",ev),t.component("search",ng),t.component("dataservices-search",Zz),t.component("toggletip",xi),t.component("user-dataset-list",Mv),t.component("user-reuse-list",Ev),t.config.compilerOptions.delimiters=["",""],t.mount(e)})(e)}catch(Yo){throw e.innerHTML=t,console.log(`VueJS template compilation failed for element ${e.className}.\n      Aborted the process and rolled back the HTML.\n      See error(s) above and below (probably won't help you tho) :`),console.log(e),console.error(Yo),Yo}}),globalThis.dsfr.start(),console.log("JS is injected !"),function(){const e=document.querySelectorAll("[data-update-url]");window.addEventListener("hashchange",()=>{Kv(e)}),e.forEach(e=>{const t=Wv(e);e.addEventListener("click",()=>{if(!window.location.hash.includes(t)){var e;let n=new URL(window.location.href);n.hash=t,window.history.pushState(null,"",n),null===(e=globalThis._paq)||void 0===e||e.push(["trackEvent","Move page to hash",window.location.pathname,t])}})}),setTimeout(()=>{Kv(e)},100)}()}}})}();
