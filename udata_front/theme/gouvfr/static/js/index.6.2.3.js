var oC=Object.defineProperty;var aC=(n,e,t)=>e in n?oC(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var se=(n,e,t)=>(aC(n,typeof e!="symbol"?e+"":e,t),t);import{defineComponent as W,inject as dt,useAttrs as lC,computed as A,openBlock as _,createElementBlock as S,mergeProps as yr,renderSlot as et,createBlock as G,unref as v,normalizeProps as cC,withCtx as K,withAsyncContext as uC,createCommentVNode as V,normalizeClass as me,ref as E,createVNode as P,createElementVNode as y,toDisplayString as T,toValue as pt,watch as it,onMounted as Ke,nextTick as rl,getCurrentInstance as Ho,getCurrentScope as dC,onScopeDispose as fC,customRef as sb,onUpdated as ob,isRef as Mu,shallowRef as pi,watchEffect as zt,Fragment as X,createTextVNode as Y,cloneVNode as hC,h as Mt,provide as Dt,onUnmounted as Xn,Teleport as Li,reactive as Hs,Suspense as ab,normalizeStyle as Wo,resolveDynamicComponent as ys,renderList as Ye,withModifiers as $e,defineAsyncComponent as lb,readonly as dd,resolveComponent as yt,withDirectives as xt,vModelText as Di,onBeforeMount as zp,onBeforeUnmount as cb,Transition as Sl,vShow as di,render as mv,TransitionGroup as pC,vModelSelect as fd,withKeys as Bp,isReactive as mC,isReadonly as gC,pushScopeId as vC,popScopeId as yC,markRaw as hd,toRaw as Tu,useId as gv,useTemplateRef as bC,createApp as wC}from"vue";import{a as kt,g as _C,c as Ct,r as kC,R as xC,y as sn,b as Fp,d as mo,_ as Vp,e as ph,s as CC,p as Se,f as tr,h as Yi,i as rc,j as cf,k as vv,n as SC,t as Ou,l as $u,u as De,m as ls,Z as MC,o as pd,q as go,v as ub,w as Ws,x as hr,z as Ei,A as Dc,B as TC,C as OC,D as db,E as Hp,F as Ia,G as Ml,H as md,I as $C,J as DC,K as EC,L as AC,M as cs,N as gd,O as uf,P as PC,Q as NC,S as RC,T as LC,U as Wp,V as Tl,W as IC,X as yv,Y as mh,$ as zC,a0 as fb,a1 as gh,a2 as vh,a3 as yh,a4 as Ol,a5 as bv,a6 as BC,a7 as bh,a8 as hb,a9 as wv,aa as FC,ab as VC,ac as HC,ad as WC,ae as wh,af as jC,ag as UC,ah as qC,ai as YC,aj as KC,ak as GC,al as XC,am as JC}from"./sentry.6.2.3.js";import{ContentLoader as $l}from"vue-content-loader";import{c as ua,g as pb}from"./_commonjsHelpers.6.2.3.js";function aK(){import.meta.url,import("_").catch(()=>1);async function*n(){}}let ic=null;function ZC(){return _C("reuses/types/")}async function QC(){return ic||(ic=(await kt.get(ZC())).data,ic)}function e3(n,e){const t=n.find(r=>r.id===e);return t?t.label:""}let sc=null;async function mb(){return sc||(sc=kt.get("datasets/schemas/").then(n=>n.data),sc)}function t3(n,e){return n.find(t=>(e==null?void 0:e.name)===t.name)||null}function n3(n){return"".concat(Ct.schema_documentation_url).concat(n,"/")}function r3(n,e){var i;if(!n.schema||!n.schema.name)return null;let t={schema_name:"schema-datagouvfr.".concat(n.schema.name)};if(n.schema&&n.schema.version){const s=n.schema.version,o=(i=e.versions.find(a=>a.version_name===s))==null?void 0:i.schema_url;o&&(t={schema_url:o})}const r=new URLSearchParams({input:"url",url:n.url,"header-case":"on",...t}).toString();return"".concat(Ct.schema_validata_url,"/table-schema?").concat(r)}const i3=["href"],Co=W({__name:"AppLink",props:{to:{},custom:{type:Boolean},activeClass:{},exactActiveClass:{},ariaCurrentValue:{default:"page"},replace:{type:Boolean}},setup(n){const e=dt(kC,null),t=lC(),r=A(()=>({...t,target:e?"_blank":t.target}));function i(s){return!e||typeof s=="string"&&s.startsWith("http")}return(s,o)=>i(s.to)?(_(),S("a",yr({key:0},r.value,{href:s.to}),[et(s.$slots,"default")],16,i3)):(_(),G(v(xC),cC(yr({key:1},s.$props)),{default:K(()=>[et(s.$slots,"default")]),_:3},16))}}),gb=W({__name:"AsyncTextClamp",props:{maxLines:{},text:{}},async setup(n){let e,t;const r=n,i=([e,t]=uC(()=>r.text),e=await e,t(),e);return(s,o)=>v(i)?(_(),G(v(sn),{key:0,text:v(i),"max-lines":s.maxLines},null,8,["text","max-lines"])):V("",!0)}});function s3(n,e){const t=(r,i)=>"".concat(Ct.api_root,"avatars/").concat(r,"/").concat(i);return n.avatar_thumbnail||t(n.id,e)}const o3=["src","width","height"],vb=W({__name:"Avatar",props:{rounded:{type:Boolean,default:!1},size:{default:40},user:{}},setup(n){const e=n,t=A(()=>s3(e.user,e.size));return(r,i)=>(_(),S("img",{class:me({"rounded-circle border border-default-grey":r.rounded}),src:t.value,width:r.size,height:r.size,loading:"lazy",alt:""},null,10,o3))}}),a3={name:"ri-bank-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M2 20h20v2H2v-2zm2-8h2v7H4v-7zm5 0h2v7H9v-7zm4 0h2v7h-2v-7zm5 0h2v7h-2v-7zM2 7l10-5 10 5v4H2V7zm2 1.236V9h16v-.764l-8-4-8 4zM12 8a1 1 0 110-2 1 1 0 010 2z"/>'},l3={name:"ri-building-2-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M3 19V5.7a1 1 0 01.658-.94l9.671-3.516a.5.5 0 01.671.47v4.953l6.316 2.105a1 1 0 01.684.949V19h2v2H1v-2h2zm2 0h7V3.855L5 6.401V19zm14 0v-8.558l-5-1.667V19h5z"/>'},c3={name:"ri-check-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"/>'},u3={name:"ri-clipboard-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M7 4V2h10v2h3.007c.548 0 .993.445.993.993v16.014a.994.994 0 01-.993.993H3.993A.994.994 0 013 21.007V4.993C3 4.445 3.445 4 3.993 4H7zm0 2H5v14h14V6h-2v2H7V6zm2-2v2h6V4H9z"/>'},d3={name:"ri-community-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M21 21H3a1 1 0 01-1-1v-7.513a1 1 0 01.343-.754L6 8.544V4a1 1 0 011-1h14a1 1 0 011 1v16a1 1 0 01-1 1zM9 19h3v-6.058L8 9.454l-4 3.488V19h3v-4h2v4zm5 0h6V5H8v2.127c.234 0 .469.082.657.247l5 4.359a1 1 0 01.343.754V19zm2-8h2v2h-2v-2zm0 4h2v2h-2v-2zm0-8h2v2h-2V7zm-4 0h2v2h-2V7z"/>'},f3={name:"ri-download-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M3 19h18v2H3v-2zm10-5.828L19.071 7.1l1.414 1.414L12 17 3.515 8.515 4.929 7.1 11 13.17V2h2v11.172z"/>'},h3={name:"ri-file-copy-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M7 6V3a1 1 0 011-1h12a1 1 0 011 1v14a1 1 0 01-1 1h-3v3c0 .552-.45 1-1.007 1H4.007A1.001 1.001 0 013 21l.003-14c0-.552.45-1 1.007-1H7zM5.003 8L5 20h10V8H5.003zM9 6h8v10h2V4H9v2z"/>'},p3={name:"ri-file-warning-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M15 4H5v16h14V8h-4V4zM3 2.992C3 2.444 3.447 2 3.999 2H16l5 5v13.993A1 1 0 0120.007 22H3.993A1 1 0 013 21.008V2.992zM11 15h2v2h-2v-2zm0-8h2v6h-2V7z"/>'},m3={name:"ri-government-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M20 6h3v2h-1v11h1v2H1v-2h1V8H1V6h3V4a1 1 0 011-1h14a1 1 0 011 1v2zm0 2H4v11h3v-7h2v7h2v-7h2v7h2v-7h2v7h3V8zM6 5v1h12V5H6z"/>'},g3={name:"ri-user-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M4 22a8 8 0 1116 0h-2a6 6 0 10-12 0H4zm8-9c-3.315 0-6-2.685-6-6s2.685-6 6-6 6 2.685 6 6-2.685 6-6 6zm0-2c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4z"/>'},v3={key:0,style:{color:"#3558a2"}},y3={key:1},b3=W({__name:"CopyButton",props:{text:{},label:{},copiedLabel:{},hideLabel:{type:Boolean,default:!1}},setup(n){Fp(c3,u3,h3);const e=n,t=E(!1),r=()=>{navigator.clipboard.writeText(e.text),t.value=!0,setTimeout(()=>t.value=!1,2e3)};return(i,s)=>(_(),S("button",{type:"button",onClick:r,class:me(["fr-text--sm fr-mb-0 whitespace-nowrap relative fr-p-1v text-mention-grey line-height-1",{"border bg-white rounded-xxs text-grey-500":i.hideLabel}])},[t.value?(_(),S("span",v3,[P(v(mo),{height:16,width:16,name:"ri-check-line"}),y("span",{class:me(["fr-ml-1v copy-label",{"fr-sr-only":i.hideLabel}])},T(i.copiedLabel),3)])):V("",!0),t.value?V("",!0):(_(),S("span",y3,[P(v(mo),{height:16,width:16,name:i.hideLabel?"ri-clipboard-line":"ri-file-copy-line",class:"copy-icon"},null,8,["name"]),y("span",{class:me(["fr-ml-1v copy-link copy-label",{"fr-sr-only":i.hideLabel}])},T(i.label),3)]))],2))}}),Ne=(n,e)=>{const t=n.__vccOpts||n;for(const[r,i]of e)t[r]=i;return t},hs=Ne(b3,[["__scopeId","data-v-4d7d7e27"]]);var jp=function(n){var e=n.onRead,t=n.onRender,r=n.uncachedValues,i=r===void 0?new Set:r,s=n.useCache,o=s===void 0?!0:s;return function(a){a===void 0&&(a={});var l=Vp(a,[]),c={},u=[],d=!1;function f(p,m){p.startsWith("--")&&(l.hasCSSVariable=!0);var g=c[p];c[p]=m,c[p]!==g&&(u.indexOf(p)===-1&&u.push(p),d||(d=!0,CC.render(h.render)))}var h={get:function(p,m){m===void 0&&(m=!1);var g=!m&&o&&!i.has(p)&&c[p]!==void 0;return g?c[p]:e(p,l)},set:function(p,m){if(typeof p=="string")f(p,m);else for(var g in p)f(g,p[g]);return this},render:function(p){return p===void 0&&(p=!1),(d||p===!0)&&(t(c,l,u),d=!1,u.length=0),this}};return h}},w3=/([a-z])([A-Z])/g,_3="$1-$2",vd=function(n){return n.replace(w3,_3).toLowerCase()},yb=new Map,Up=new Map,bb=["Webkit","Moz","O","ms",""],k3=bb.length,x3=typeof document<"u",df,wb=function(n,e){return Up.set(n,vd(e))},C3=function(n){df=df||document.createElement("div");for(var e=0;e<k3;e++){var t=bb[e],r=t==="",i=r?n:t+n.charAt(0).toUpperCase()+n.slice(1);if(i in df.style||r){if(r&&n==="clipPath"&&Up.has(n))return;yb.set(n,i),wb(n,(r?"":"-")+vd(i))}}},S3=function(n){return wb(n,n)},_b=function(n,e){e===void 0&&(e=!1);var t=e?Up:yb;return t.has(n)||(x3?C3(n):S3(n)),t.get(n)||n},M3=["","X","Y","Z"],T3=["translate","scale","rotate","skew","transformPerspective"],_h=T3.reduce(function(n,e){return M3.reduce(function(t,r){return t.push(e+r),t},n)},["x","y","z"]),O3=_h.reduce(function(n,e){return n[e]=!0,n},{});function qp(n){return O3[n]===!0}function $3(n,e){return _h.indexOf(n)-_h.indexOf(e)}var D3=new Set(["originX","originY","originZ"]);function E3(n){return D3.has(n)}var _v=ph(ph({},SC),{transform:Math.round}),A3={color:tr,backgroundColor:tr,outlineColor:tr,fill:tr,stroke:tr,borderColor:tr,borderTopColor:tr,borderRightColor:tr,borderBottomColor:tr,borderLeftColor:tr,borderWidth:Se,borderTopWidth:Se,borderRightWidth:Se,borderBottomWidth:Se,borderLeftWidth:Se,borderRadius:Se,radius:Se,borderTopLeftRadius:Se,borderTopRightRadius:Se,borderBottomRightRadius:Se,borderBottomLeftRadius:Se,width:Se,maxWidth:Se,height:Se,maxHeight:Se,size:Se,top:Se,right:Se,bottom:Se,left:Se,padding:Se,paddingTop:Se,paddingRight:Se,paddingBottom:Se,paddingLeft:Se,margin:Se,marginTop:Se,marginRight:Se,marginBottom:Se,marginLeft:Se,rotate:Yi,rotateX:Yi,rotateY:Yi,rotateZ:Yi,scale:rc,scaleX:rc,scaleY:rc,scaleZ:rc,skew:Yi,skewX:Yi,skewY:Yi,distance:Se,translateX:Se,translateY:Se,translateZ:Se,x:Se,y:Se,z:Se,perspective:Se,opacity:cf,originX:vv,originY:vv,originZ:Se,zIndex:_v,fillOpacity:cf,strokeOpacity:cf,numOctaves:_v},Yp=function(n){return A3[n]},P3=function(n,e){return e&&typeof n=="number"?e.transform(n):n},za="scrollLeft",Ba="scrollTop",kb=new Set([za,Ba]),N3=new Set([za,Ba,"transform"]),R3={x:"translateX",y:"translateY",z:"translateZ"};function xb(n){return typeof n=="function"}function L3(n,e,t,r,i,s){s===void 0&&(s=!0);var o="",a=!1;t.sort($3);for(var l=t.length,c=0;c<l;c++){var u=t[c];o+=(R3[u]||u)+"("+e[u]+") ",a=u==="z"?!0:a}return!a&&i?o+="translateZ(0)":o=o.trim(),xb(n.transform)?o=n.transform(e,r?"":o):s&&r&&(o="none"),o}function I3(n,e,t,r,i,s,o,a){e===void 0&&(e=!0),t===void 0&&(t={}),r===void 0&&(r={}),i===void 0&&(i={}),s===void 0&&(s=[]),o===void 0&&(o=!1),a===void 0&&(a=!0);var l=!0,c=!1,u=!1;for(var d in n){var f=n[d],h=Yp(d),p=P3(f,h);qp(d)?(c=!0,r[d]=p,s.push(d),l&&(h.default&&f!==h.default||!h.default&&f!==0)&&(l=!1)):E3(d)?(i[d]=p,u=!0):(!N3.has(d)||!xb(p))&&(t[_b(d,o)]=p)}return(c||typeof n.transform=="function")&&(t.transform=L3(n,r,s,l,e,a)),u&&(t.transformOrigin=(i.originX||"50%")+" "+(i.originY||"50%")+" "+(i.originZ||0)),t}function Kp(n){var e=n===void 0?{}:n,t=e.enableHardwareAcceleration,r=t===void 0?!0:t,i=e.isDashCase,s=i===void 0?!0:i,o=e.allowTransformNone,a=o===void 0?!0:o,l={},c={},u={},d=[];return function(f){return d.length=0,I3(f,r,l,c,u,d,s,a),l}}function z3(n,e){var t=e.element,r=e.preparseOutput,i=Yp(n);if(qp(n))return i&&i.default||0;if(kb.has(n))return t[n];var s=window.getComputedStyle(t,null).getPropertyValue(_b(n,!0))||0;return r&&i&&i.test(s)&&i.parse?i.parse(s):s}function B3(n,e,t){var r=e.element,i=e.buildStyles,s=e.hasCSSVariable;if(Object.assign(r.style,i(n)),s)for(var o=t.length,a=0;a<o;a++){var l=t[a];l.startsWith("--")&&r.style.setProperty(l,n[l])}t.indexOf(za)!==-1&&(r[za]=n[za]),t.indexOf(Ba)!==-1&&(r[Ba]=n[Ba])}var F3=jp({onRead:z3,onRender:B3,uncachedValues:kb});function V3(n,e){e===void 0&&(e={});var t=e.enableHardwareAcceleration,r=e.allowTransformNone,i=Vp(e,["enableHardwareAcceleration","allowTransformNone"]);return F3(ph({element:n,buildStyles:Kp({enableHardwareAcceleration:t,allowTransformNone:r}),preparseOutput:!0},i))}var Cb=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues"]),kv=.5,Sb=function(){return{style:{}}},ff=function(n,e){return Se.transform(n*e)},H3={x:0,y:0,width:0,height:0};function xv(n,e,t){return typeof n=="string"?n:Se.transform(e+t*n)}function W3(n,e,t){return xv(e,n.x,n.width)+" "+xv(t,n.y,n.height)}var Mb={enableHardwareAcceleration:!1,isDashCase:!1};function j3(n,e,t,r,i,s){e===void 0&&(e=H3),r===void 0&&(r=Kp(Mb)),i===void 0&&(i=Sb()),s===void 0&&(s=!0);var o=n.attrX,a=n.attrY,l=n.originX,c=n.originY,u=n.pathLength,d=n.pathSpacing,f=d===void 0?1:d,h=n.pathOffset,p=h===void 0?0:h,m=Vp(n,["attrX","attrY","originX","originY","pathLength","pathSpacing","pathOffset"]),g=r(m);for(var w in g)if(w==="transform")i.style.transform=g[w];else{var x=s&&!Cb.has(w)?vd(w):w;i[x]=g[w]}return(l!==void 0||c!==void 0||g.transform)&&(i.style.transformOrigin=W3(e,l!==void 0?l:kv,c!==void 0?c:kv)),o!==void 0&&(i.x=o),a!==void 0&&(i.y=a),t!==void 0&&u!==void 0&&(i[s?"stroke-dashoffset":"strokeDashoffset"]=ff(-p,t),i[s?"stroke-dasharray":"strokeDasharray"]=ff(u,t)+" "+ff(f,t)),i}function U3(n,e,t){t===void 0&&(t=!0);var r=Sb(),i=Kp(Mb);return function(s){return j3(s,n,e,i,r,t)}}var q3=function(n){return typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()},Y3=function(n){try{return q3(n)}catch(e){return{x:0,y:0,width:0,height:0}}},K3=function(n){return n.tagName==="path"},G3=jp({onRead:function(n,e){var t=e.element;if(n=Cb.has(n)?n:vd(n),qp(n)){var r=Yp(n);return r&&r.default||0}else return t.getAttribute(n)},onRender:function(n,e){var t=e.element,r=e.buildAttrs,i=r(n);for(var s in i)s==="style"?Object.assign(t.style,i.style):t.setAttribute(s,i[s])}}),X3=function(n){var e=Y3(n),t=K3(n)&&n.getTotalLength?n.getTotalLength():void 0;return G3({element:n,buildAttrs:U3(e,t)})},J3=jp({useCache:!1,onRead:function(n){return n==="scrollTop"?window.pageYOffset:window.pageXOffset},onRender:function(n){var e=n.scrollTop,t=e===void 0?0:e,r=n.scrollLeft,i=r===void 0?0:r;return window.scrollTo(i,t)}}),kh=new WeakMap,Z3=function(n){return n instanceof HTMLElement||typeof n.click=="function"},Q3=function(n){return n instanceof SVGElement||"ownerSVGElement"in n},eS=function(n,e){var t;return n===window?t=J3(n):Z3(n)?t=V3(n,e):Q3(n)&&(t=X3(n)),kh.set(n,t),t},tS=function(n,e){return kh.has(n)?kh.get(n):eS(n,e)};function Tb(n,e){var t=typeof n=="string"?document.querySelector(n):n;return tS(t,e)}function Ob(n,e,t=0){if(n){const r=Tb(n);e?(r.set({display:"block"}),r.render(!0),Ou({from:{height:0,padding:0},to:{height:n.scrollHeight+2*t,padding:t},duration:300,ease:$u}).start({update:r.set,complete:()=>r.set({height:"auto"})})):Ou({from:{height:n.scrollHeight,padding:t},to:{height:0,padding:0},duration:300,ease:$u}).start({update:r.set,complete:()=>r.set({height:0,display:"none"})})}}const Du="public-service",xh="association",Ch="company",Eu="local-authority",yd="other",$b="user";function fo(n,e){return Db(n,e)}function Db(n,e){return pt(n).badges.some(t=>t.kind===e)}function Eb(){const{t:n}=De();return[{type:Du,label:n("Public service"),icon:"ri-bank-line"},{type:Eu,label:n("Local authority"),icon:"ri-government-line"},{type:xh,label:n("Association"),icon:"ri-community-line"},{type:Ch,label:n("Company"),icon:"ri-building-2-line"},{type:yd,label:n("Other"),icon:""},{type:$b,label:n("User"),icon:"ri-user-line"}]}function Ab(n){return Eb().find(e=>e.type===n)}function nS(n){const e=A(()=>fo(n,Du)),t=A(()=>fo(n,xh)),r=A(()=>fo(n,Eu)),i=A(()=>fo(n,Ch));return{type:A(()=>r.value?Eu:e.value?Du:t.value?xh:i.value?Ch:yd)}}const Cv=14,rS=W({__name:"OwnerTypeIcon",props:{type:{}},setup(n){Fp(a3,l3,d3,m3,g3);const e=n,t=A(()=>Ab(e.type).icon);return(r,i)=>t.value?(_(),G(v(mo),{key:0,height:Cv,width:Cv,name:t.value},null,8,["name"])):V("",!0)}}),Gp=Ne(rS,[["__scopeId","data-v-7acefa45"]]),iS="certified";function sS(n){return{organizationCertified:A(()=>{const t=pt(n);return t?Db(t,iS)&&(fo(t,Du)||fo(t,Eu)):!1})}}const oS=["title"],$s=W({__name:"OrganizationNameWithCertificate",props:{organization:{},showType:{type:Boolean,default:!0}},setup(n){const{t:e}=De(),t=n,{type:r}=nS(t.organization),{organizationCertified:i}=sS(t.organization);return(s,o)=>(_(),S("span",{class:me(["inline-flex",v(r)!==v(yd)||v(i)?"fr-grid-row--middle":"align-items-baseline"])},[y("span",null,[s.showType?(_(),G(Gp,{key:0,type:v(r)},null,8,["type"])):V("",!0)]),P(v(sn),{class:"fr-mx-1v","auto-resize":!0,text:s.organization.name,"max-lines":1},null,8,["text"]),v(i)?(_(),S("span",{key:0,class:"fr-icon-success-line fr-icon--sm",title:v(e)("The identity of this public service is certified by {certifier}",{certifier:v(Ct).title}),"aria-hidden":"true"},null,8,oS)):V("",!0)],2))}}),aS=(n,e)=>{const t=n[e];return t?typeof t=="function"?t():Promise.resolve(t):new Promise((r,i)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(i.bind(null,new Error("Unknown variable dynamic import: "+e)))})};function lS(n){return dC()?(fC(n),!0):!1}function Sh(n){return typeof n=="function"?n():v(n)}const cS=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Mh=()=>{};function Pb(n,e){function t(...r){return new Promise((i,s)=>{Promise.resolve(n(()=>e.apply(this,r),{fn:e,thisArg:this,args:r})).then(i).catch(s)})}return t}const uS=n=>n();function dS(n,e={}){let t,r,i=Mh;const s=a=>{clearTimeout(a),i(),i=Mh};return a=>{const l=Sh(n),c=Sh(e.maxWait);return t&&s(t),l<=0||c!==void 0&&c<=0?(r&&(s(r),r=null),Promise.resolve(a())):new Promise((u,d)=>{i=e.rejectOnCancel?d:u,c&&!r&&(r=setTimeout(()=>{t&&s(t),r=null,u(a())},c)),t=setTimeout(()=>{r&&s(r),r=null,u(a())},l)})}}function fS(n){return n||Ho()}function hS(n,e=200,t={}){return Pb(dS(e,t),n)}function pS(n,e=200,t={}){const r=E(n.value),i=hS(()=>{r.value=n.value},e,t);return it(n,()=>i()),r}function Nb(n,e=!0,t){fS()?Ke(n,t):e?n():rl(n)}function mS(n,e,t={}){const{eventFilter:r=uS,...i}=t,s=Pb(r,e);let o,a,l;if(i.flush==="sync"){const c=E(!1);a=()=>{},o=u=>{c.value=!0,u(),c.value=!1},l=it(n,(...u)=>{c.value||s(...u)},i)}else{const c=[],u=E(0),d=E(0);a=()=>{u.value=d.value},c.push(it(n,()=>{d.value++},{...i,flush:"sync"})),o=f=>{const h=d.value;f(),u.value+=d.value-h},c.push(it(n,(...f)=>{const h=u.value>0&&u.value===d.value;u.value=0,d.value=0,!h&&s(...f)},i)),l=()=>{c.forEach(f=>f())}}return{stop:l,ignoreUpdates:o,ignorePrevAsyncUpdates:a}}function Rb(n,e,t){let r;Mu(t)?r={evaluating:t}:r=t||{};const{lazy:i=!1,evaluating:s=void 0,shallow:o=!0,onError:a=Mh}=r,l=E(!i),c=o?pi(e):E(e);let u=0;return zt(async d=>{if(!l.value)return;u++;const f=u;let h=!1;s&&Promise.resolve().then(()=>{s.value=!0});try{const p=await n(m=>{d(()=>{s&&(s.value=!1),h||m()})});f===u&&(c.value=p)}catch(p){a(p)}finally{s&&f===u&&(s.value=!1),h=!0}}),i?A(()=>(l.value=!0,c.value)):c}function ps(n){var e;const t=Sh(n);return(e=t==null?void 0:t.$el)!=null?e:t}const Lb=cS?window:void 0;function il(n,e=null){const t=Ho();let r=()=>{};const i=sb((s,o)=>(r=o,{get(){var a,l;return s(),(l=(a=t==null?void 0:t.proxy)==null?void 0:a.$refs[n])!=null?l:e},set(){}}));return Nb(r),ob(r),i}function gS(){const n=E(!1),e=Ho();return e&&Ke(()=>{n.value=!0},e),n}function vS(n){const e=gS();return A(()=>(e.value,!!n()))}function yS(n,e,t={}){const{window:r=Lb,...i}=t;let s;const o=vS(()=>r&&"ResizeObserver"in r),a=()=>{s&&(s.disconnect(),s=void 0)},l=A(()=>Array.isArray(n)?n.map(d=>ps(d)):[ps(n)]),c=it(l,d=>{if(a(),o.value&&r){s=new ResizeObserver(e);for(const f of d)f&&s.observe(f,i)}},{immediate:!0,flush:"post"}),u=()=>{a(),c()};return lS(u),{isSupported:o,stop:u}}function bS(n,e={width:0,height:0},t={}){const{window:r=Lb,box:i="content-box"}=t,s=A(()=>{var d,f;return(f=(d=ps(n))==null?void 0:d.namespaceURI)==null?void 0:f.includes("svg")}),o=E(e.width),a=E(e.height),{stop:l}=yS(n,([d])=>{const f=i==="border-box"?d.borderBoxSize:i==="content-box"?d.contentBoxSize:d.devicePixelContentBoxSize;if(r&&s.value){const h=ps(n);if(h){const p=h.getBoundingClientRect();o.value=p.width,a.value=p.height}}else if(f){const h=Array.isArray(f)?f:[f];o.value=h.reduce((p,{inlineSize:m})=>p+m,0),a.value=h.reduce((p,{blockSize:m})=>p+m,0)}else o.value=d.contentRect.width,a.value=d.contentRect.height},t);Nb(()=>{const d=ps(n);d&&(o.value="offsetWidth"in d?d.offsetWidth:e.width,a.value="offsetHeight"in d?d.offsetHeight:e.height)});const c=it(()=>ps(n),d=>{o.value=d?e.width:0,a.value=d?e.height:0});function u(){l(),c()}return{width:o,height:a,stop:u}}const wS=["src","alt","width","height"],Th=W({__name:"Placeholder",props:{type:{},src:{},alt:{},size:{}},setup(n){const e=n,t=async()=>{const s=await aS(Object.assign({"../../assets/img/placeholders/author.png":()=>ls(()=>import("./author.6.2.3.js"),[]),"../../assets/img/placeholders/dataset.png":()=>ls(()=>import("./dataset.6.2.3.js"),[]),"../../assets/img/placeholders/news.png":()=>ls(()=>import("./news.6.2.3.js"),[]),"../../assets/img/placeholders/organization.png":()=>ls(()=>import("./organization.6.2.3.js"),[]),"../../assets/img/placeholders/reuse.png":()=>ls(()=>import("./reuse.6.2.3.js"),[])}),"../../assets/img/placeholders/".concat(e.type,".png"));return e.src?e.src:s.default},r=A(()=>e.src?e.alt:""),i=Rb(()=>t());return(s,o)=>(_(),S("img",yr({loading:"lazy",src:v(i),alt:r.value,width:s.size,height:s.size},s.$attrs),null,16,wS))}}),_S=["value"],hf=1,kS=W({__name:"QualityScore",props:{score:{},class:{default:""}},setup(n){const e=n,t=hf*2/3,{t:r,locale:i}=De(),s=A(()=>new Intl.NumberFormat(i.value,{style:"percent"}).format(e.score));return(o,a)=>(_(),S("meter",{class:me(["quality-score",e.class]),min:"0",low:"0",high:t,max:hf,optimum:hf,value:o.score},[o.score>=t?(_(),S(X,{key:0},[Y(T(v(r)("Good")),1)],64)):(_(),S(X,{key:1},[Y(T(v(r)("To improve")),1)],64)),Y("("+T(s.value)+") ",1)],10,_S))}}),xS={key:0,class:"fr-my-0"},CS={key:1,class:"fr-my-0 text-mention-grey"},Jr=W({__name:"QualityItem",props:{passed:{type:Boolean},messagePassed:{},messageFailed:{}},setup(n){return(e,t)=>(_(),S("li",null,[e.passed?(_(),S("p",xS,[t[0]||(t[0]=y("span",{class:"fr-icon-check-line","aria-hidden":"true"},null,-1)),Y(" "+T(e.messagePassed),1)])):(_(),S("p",CS,[t[1]||(t[1]=y("span",{class:"fr-icon-warning-line","aria-hidden":"true"},null,-1)),Y(" "+T(e.messageFailed),1)]))]))}});function SS(n){typeof queueMicrotask=="function"?queueMicrotask(n):Promise.resolve().then(n).catch(e=>setTimeout(()=>{throw e}))}let MS=Symbol("headlessui.useid"),TS=0;function ki(){return dt(MS,()=>"".concat(++TS))()}function oe(n){var e;if(n==null||n.value==null)return null;let t=(e=n.value.$el)!=null?e:n.value;return t instanceof Node?t:null}function _n(n,e,...t){if(n in e){let i=e[n];return typeof i=="function"?i(...t):i}let r=new Error('Tried to handle "'.concat(n,'" but there is no handler defined. Only defined handlers are: ').concat(Object.keys(e).map(i=>'"'.concat(i,'"')).join(", "),"."));throw Error.captureStackTrace&&Error.captureStackTrace(r,_n),r}var OS=Object.defineProperty,$S=(n,e,t)=>e in n?OS(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Sv=(n,e,t)=>($S(n,typeof e!="symbol"?e+"":e,t),t);let DS=class{constructor(){Sv(this,"current",this.detect()),Sv(this,"currentId",0)}set(e){this.current!==e&&(this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}},bd=new DS;function jr(n){if(bd.isServer)return null;if(n instanceof Node)return n.ownerDocument;if(n!=null&&n.hasOwnProperty("value")){let e=oe(n);if(e)return e.ownerDocument}return document}let Oh=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(n=>"".concat(n,":not([tabindex='-1'])")).join(",");var Ot=(n=>(n[n.First=1]="First",n[n.Previous=2]="Previous",n[n.Next=4]="Next",n[n.Last=8]="Last",n[n.WrapAround=16]="WrapAround",n[n.NoScroll=32]="NoScroll",n))(Ot||{}),mi=(n=>(n[n.Error=0]="Error",n[n.Overflow=1]="Overflow",n[n.Success=2]="Success",n[n.Underflow=3]="Underflow",n))(mi||{}),ES=(n=>(n[n.Previous=-1]="Previous",n[n.Next=1]="Next",n))(ES||{});function wd(n=document.body){return n==null?[]:Array.from(n.querySelectorAll(Oh)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}var Xp=(n=>(n[n.Strict=0]="Strict",n[n.Loose=1]="Loose",n))(Xp||{});function Ib(n,e=0){var t;return n===((t=jr(n))==null?void 0:t.body)?!1:_n(e,{0(){return n.matches(Oh)},1(){let r=n;for(;r!==null;){if(r.matches(Oh))return!0;r=r.parentElement}return!1}})}var AS=(n=>(n[n.Keyboard=0]="Keyboard",n[n.Mouse=1]="Mouse",n))(AS||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",n=>{n.metaKey||n.altKey||n.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",n=>{n.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:n.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));let PS=["textarea","input"].join(",");function NS(n){var e,t;return(t=(e=n==null?void 0:n.matches)==null?void 0:e.call(n,PS))!=null?t:!1}function eo(n,e=t=>t){return n.slice().sort((t,r)=>{let i=e(t),s=e(r);if(i===null||s===null)return 0;let o=i.compareDocumentPosition(s);return o&Node.DOCUMENT_POSITION_FOLLOWING?-1:o&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function yn(n,e,{sorted:t=!0,relativeTo:r=null,skipElements:i=[]}={}){var s;let o=(s=Array.isArray(n)?n.length>0?n[0].ownerDocument:document:n==null?void 0:n.ownerDocument)!=null?s:document,a=Array.isArray(n)?t?eo(n):n:wd(n);i.length>0&&a.length>1&&(a=a.filter(p=>!i.includes(p))),r=r!=null?r:o.activeElement;let l=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,a.indexOf(r))-1;if(e&4)return Math.max(0,a.indexOf(r))+1;if(e&8)return a.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=e&32?{preventScroll:!0}:{},d=0,f=a.length,h;do{if(d>=f||d+f<=0)return 0;let p=c+d;if(e&16)p=(p+f)%f;else{if(p<0)return 3;if(p>=f)return 1}h=a[p],h==null||h.focus(u),d+=l}while(h!==o.activeElement);return e&6&&NS(h)&&h.select(),2}function RS(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function LS(){return/Android/gi.test(window.navigator.userAgent)}function IS(){return RS()||LS()}function oc(n,e,t){bd.isServer||zt(r=>{document.addEventListener(n,e,t),r(()=>document.removeEventListener(n,e,t))})}function zb(n,e,t){bd.isServer||zt(r=>{window.addEventListener(n,e,t),r(()=>window.removeEventListener(n,e,t))})}function zS(n,e,t=A(()=>!0)){function r(s,o){if(!t.value||s.defaultPrevented)return;let a=o(s);if(a===null||!a.getRootNode().contains(a))return;let l=function c(u){return typeof u=="function"?c(u()):Array.isArray(u)||u instanceof Set?u:[u]}(n);for(let c of l){if(c===null)continue;let u=c instanceof HTMLElement?c:oe(c);if(u!=null&&u.contains(a)||s.composed&&s.composedPath().includes(u))return}return!Ib(a,Xp.Loose)&&a.tabIndex!==-1&&s.preventDefault(),e(s,a)}let i=E(null);oc("pointerdown",s=>{var o,a;t.value&&(i.value=((a=(o=s.composedPath)==null?void 0:o.call(s))==null?void 0:a[0])||s.target)},!0),oc("mousedown",s=>{var o,a;t.value&&(i.value=((a=(o=s.composedPath)==null?void 0:o.call(s))==null?void 0:a[0])||s.target)},!0),oc("click",s=>{IS()||i.value&&(r(s,()=>i.value),i.value=null)},!0),oc("touchend",s=>r(s,()=>s.target instanceof HTMLElement?s.target:null),!0),zb("blur",s=>r(s,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function Mv(n,e){if(n)return n;let t=e!=null?e:"button";if(typeof t=="string"&&t.toLowerCase()==="button")return"button"}function Bb(n,e){let t=E(Mv(n.value.type,n.value.as));return Ke(()=>{t.value=Mv(n.value.type,n.value.as)}),zt(()=>{var r;t.value||oe(e)&&oe(e)instanceof HTMLButtonElement&&!((r=oe(e))!=null&&r.hasAttribute("type"))&&(t.value="button")}),t}var Ds=(n=>(n[n.None=0]="None",n[n.RenderStrategy=1]="RenderStrategy",n[n.Static=2]="Static",n))(Ds||{}),BS=(n=>(n[n.Unmount=0]="Unmount",n[n.Hidden=1]="Hidden",n))(BS||{});function un({visible:n=!0,features:e=0,ourProps:t,theirProps:r,...i}){var s;let o=Vb(r,t),a=Object.assign(i,{props:o});if(n||e&2&&o.static)return pf(a);if(e&1){let l=(s=o.unmount)==null||s?0:1;return _n(l,{0(){return null},1(){return pf({...i,props:{...o,hidden:!0,style:{display:"none"}}})}})}return pf(a)}function pf({props:n,attrs:e,slots:t,slot:r,name:i}){var s,o;let{as:a,...l}=Hb(n,["unmount","static"]),c=(s=t.default)==null?void 0:s.call(t,r),u={};if(r){let d=!1,f=[];for(let[h,p]of Object.entries(r))typeof p=="boolean"&&(d=!0),p===!0&&f.push(h);d&&(u["data-headlessui-state"]=f.join(" "))}if(a==="template"){if(c=Fb(c!=null?c:[]),Object.keys(l).length>0||Object.keys(e).length>0){let[d,...f]=c!=null?c:[];if(!FS(d)||f.length>0)throw new Error(['Passing props on "template"!',"","The current component <".concat(i,' /> is rendering a "template".'),"However we need to passthrough the following props:",Object.keys(l).concat(Object.keys(e)).map(m=>m.trim()).filter((m,g,w)=>w.indexOf(m)===g).sort((m,g)=>m.localeCompare(g)).map(m=>"  - ".concat(m)).join("\n"),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "template".',"Render a single element as the child so that we can forward the props onto that element."].map(m=>"  - ".concat(m)).join("\n")].join("\n"));let h=Vb((o=d.props)!=null?o:{},l,u),p=hC(d,h,!0);for(let m in h)m.startsWith("on")&&(p.props||(p.props={}),p.props[m]=h[m]);return p}return Array.isArray(c)&&c.length===1?c[0]:c}return Mt(a,Object.assign({},l,u),{default:()=>c})}function Fb(n){return n.flatMap(e=>e.type===X?Fb(e.children):[e])}function Vb(...n){if(n.length===0)return{};if(n.length===1)return n[0];let e={},t={};for(let r of n)for(let i in r)i.startsWith("on")&&typeof r[i]=="function"?(t[i]!=null||(t[i]=[]),t[i].push(r[i])):e[i]=r[i];if(e.disabled||e["aria-disabled"])return Object.assign(e,Object.fromEntries(Object.keys(t).map(r=>[r,void 0])));for(let r in t)Object.assign(e,{[r](i,...s){let o=t[r];for(let a of o){if(i instanceof Event&&i.defaultPrevented)return;a(i,...s)}}});return e}function Hb(n,e=[]){let t=Object.assign({},n);for(let r of e)r in t&&delete t[r];return t}function FS(n){return n==null?!1:typeof n.type=="string"||typeof n.type=="object"||typeof n.type=="function"}var Es=(n=>(n[n.None=1]="None",n[n.Focusable=2]="Focusable",n[n.Hidden=4]="Hidden",n))(Es||{});let As=W({name:"Hidden",props:{as:{type:[Object,String],default:"div"},features:{type:Number,default:1}},setup(n,{slots:e,attrs:t}){return()=>{var r;let{features:i,...s}=n,o={"aria-hidden":(i&2)===2?!0:(r=s["aria-hidden"])!=null?r:void 0,hidden:(i&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(i&4)===4&&(i&2)!==2&&{display:"none"}}};return un({ourProps:o,theirProps:s,slot:{},attrs:t,slots:e,name:"Hidden"})}}}),Wb=Symbol("Context");var Ps=(n=>(n[n.Open=1]="Open",n[n.Closed=2]="Closed",n[n.Closing=4]="Closing",n[n.Opening=8]="Opening",n))(Ps||{});function jb(){return dt(Wb,null)}function VS(n){Dt(Wb,n)}var Et=(n=>(n.Space=" ",n.Enter="Enter",n.Escape="Escape",n.Backspace="Backspace",n.Delete="Delete",n.ArrowLeft="ArrowLeft",n.ArrowUp="ArrowUp",n.ArrowRight="ArrowRight",n.ArrowDown="ArrowDown",n.Home="Home",n.End="End",n.PageUp="PageUp",n.PageDown="PageDown",n.Tab="Tab",n))(Et||{});function HS(n,e,t,r){bd.isServer||zt(i=>{n=n!=null?n:window,n.addEventListener(e,t,r),i(()=>n.removeEventListener(e,t,r))})}var Ir=(n=>(n[n.Forwards=0]="Forwards",n[n.Backwards=1]="Backwards",n))(Ir||{});function Ub(){let n=E(0);return zb("keydown",e=>{e.key==="Tab"&&(n.value=e.shiftKey?1:0)}),n}function WS({defaultContainers:n=[],portals:e,mainTreeNodeRef:t}={}){let r=E(null),i=jr(r);function s(){var o,a,l;let c=[];for(let u of n)u!==null&&(u instanceof HTMLElement?c.push(u):"value"in u&&u.value instanceof HTMLElement&&c.push(u.value));if(e!=null&&e.value)for(let u of e.value)c.push(u);for(let u of(o=i==null?void 0:i.querySelectorAll("html > *, body > *"))!=null?o:[])u!==document.body&&u!==document.head&&u instanceof HTMLElement&&u.id!=="headlessui-portal-root"&&(u.contains(oe(r))||u.contains((l=(a=oe(r))==null?void 0:a.getRootNode())==null?void 0:l.host)||c.some(d=>u.contains(d))||c.push(u));return c}return{resolveContainers:s,contains(o){return s().some(a=>a.contains(o))},mainTreeNodeRef:r,MainTreeNode(){return t!=null?null:Mt(As,{features:Es.Hidden,ref:r})}}}function jS(){let n=E(null);return{mainTreeNodeRef:n,MainTreeNode(){return Mt(As,{features:Es.Hidden,ref:n})}}}let qb=Symbol("ForcePortalRootContext");function US(){return dt(qb,!1)}W({name:"ForcePortalRoot",props:{as:{type:[Object,String],default:"template"},force:{type:Boolean,default:!1}},setup(n,{slots:e,attrs:t}){return Dt(qb,n.force),()=>{let{force:r,...i}=n;return un({theirProps:i,ourProps:{},slot:{},slots:e,attrs:t,name:"ForcePortalRoot"})}}});function qS(n){let e=jr(n);if(!e){if(n===null)return null;throw new Error("[Headless UI]: Cannot find ownerDocument for contextElement: ".concat(n))}let t=e.getElementById("headlessui-portal-root");if(t)return t;let r=e.createElement("div");return r.setAttribute("id","headlessui-portal-root"),e.body.appendChild(r)}const $h=new WeakMap;function YS(n){var e;return(e=$h.get(n))!=null?e:0}function Tv(n,e){let t=e(YS(n));return t<=0?$h.delete(n):$h.set(n,t),t}W({name:"Portal",props:{as:{type:[Object,String],default:"div"}},setup(n,{slots:e,attrs:t}){let r=E(null),i=A(()=>jr(r)),s=US(),o=dt(Yb,null),a=E(s===!0||o==null?qS(r.value):o.resolveTarget());a.value&&Tv(a.value,f=>f+1);let l=E(!1);Ke(()=>{l.value=!0}),zt(()=>{s||o!=null&&(a.value=o.resolveTarget())});let c=dt(Dh,null),u=!1,d=Ho();return it(r,()=>{if(u||!c)return;let f=oe(r);f&&(Xn(c.register(f),d),u=!0)}),Xn(()=>{var f,h;let p=(f=i.value)==null?void 0:f.getElementById("headlessui-portal-root");!p||a.value!==p||Tv(a.value,m=>m-1)||a.value.children.length>0||(h=a.value.parentElement)==null||h.removeChild(a.value)}),()=>{if(!l.value||a.value===null)return null;let f={ref:r,"data-headlessui-portal":""};return Mt(Li,{to:a.value},un({ourProps:f,theirProps:n,slot:{},attrs:t,slots:e,name:"Portal"}))}}});let Dh=Symbol("PortalParentContext");function KS(){let n=dt(Dh,null),e=E([]);function t(s){return e.value.push(s),n&&n.register(s),()=>r(s)}function r(s){let o=e.value.indexOf(s);o!==-1&&e.value.splice(o,1),n&&n.unregister(s)}let i={register:t,unregister:r,portals:e};return[e,W({name:"PortalWrapper",setup(s,{slots:o}){return Dt(Dh,i),()=>{var a;return(a=o.default)==null?void 0:a.call(o)}}})]}let Yb=Symbol("PortalGroupContext");W({name:"PortalGroup",props:{as:{type:[Object,String],default:"template"},target:{type:Object,default:null}},setup(n,{attrs:e,slots:t}){let r=Hs({resolveTarget(){return n.target}});return Dt(Yb,r),()=>{let{target:i,...s}=n;return un({theirProps:s,ourProps:{},slot:{},attrs:e,slots:t,name:"PortalGroup"})}}});var GS=(n=>(n[n.Open=0]="Open",n[n.Closed=1]="Closed",n))(GS||{});let Kb=Symbol("PopoverContext");function _d(n){let e=dt(Kb,null);if(e===null){let t=new Error("<".concat(n," /> is missing a parent <").concat(Zb.name," /> component."));throw Error.captureStackTrace&&Error.captureStackTrace(t,_d),t}return e}let Gb=Symbol("PopoverGroupContext");function Xb(){return dt(Gb,null)}let Jb=Symbol("PopoverPanelContext");function XS(){return dt(Jb,null)}let Zb=W({name:"Popover",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"}},setup(n,{slots:e,attrs:t,expose:r}){var i;let s=E(null);r({el:s,$el:s});let o=E(1),a=E(null),l=E(null),c=E(null),u=E(null),d=A(()=>jr(s)),f=A(()=>{var C,k;if(!oe(a)||!oe(u))return!1;for(let le of document.querySelectorAll("body > *"))if(Number(le==null?void 0:le.contains(oe(a)))^Number(le==null?void 0:le.contains(oe(u))))return!0;let $=wd(),O=$.indexOf(oe(a)),D=(O+$.length-1)%$.length,N=(O+1)%$.length,B=$[D],U=$[N];return!((C=oe(u))!=null&&C.contains(B))&&!((k=oe(u))!=null&&k.contains(U))}),h={popoverState:o,buttonId:E(null),panelId:E(null),panel:u,button:a,isPortalled:f,beforePanelSentinel:l,afterPanelSentinel:c,togglePopover(){o.value=_n(o.value,{0:1,1:0})},closePopover(){o.value!==1&&(o.value=1)},close(C){h.closePopover();let k=(()=>C?C instanceof HTMLElement?C:C.value instanceof HTMLElement?oe(C):oe(h.button):oe(h.button))();k==null||k.focus()}};Dt(Kb,h),VS(A(()=>_n(o.value,{0:Ps.Open,1:Ps.Closed})));let p={buttonId:h.buttonId,panelId:h.panelId,close(){h.closePopover()}},m=Xb(),g=m==null?void 0:m.registerPopover,[w,x]=KS(),M=WS({mainTreeNodeRef:m==null?void 0:m.mainTreeNodeRef,portals:w,defaultContainers:[a,u]});function b(){var C,k,$,O;return(O=m==null?void 0:m.isFocusWithinPopoverGroup())!=null?O:((C=d.value)==null?void 0:C.activeElement)&&(((k=oe(a))==null?void 0:k.contains(d.value.activeElement))||(($=oe(u))==null?void 0:$.contains(d.value.activeElement)))}return zt(()=>g==null?void 0:g(p)),HS((i=d.value)==null?void 0:i.defaultView,"focus",C=>{var k,$;C.target!==window&&C.target instanceof HTMLElement&&o.value===0&&(b()||a&&u&&(M.contains(C.target)||(k=oe(h.beforePanelSentinel))!=null&&k.contains(C.target)||($=oe(h.afterPanelSentinel))!=null&&$.contains(C.target)||h.closePopover()))},!0),zS(M.resolveContainers,(C,k)=>{var $;h.closePopover(),Ib(k,Xp.Loose)||(C.preventDefault(),($=oe(a))==null||$.focus())},A(()=>o.value===0)),()=>{let C={open:o.value===0,close:h.close};return Mt(X,[Mt(x,{},()=>un({theirProps:{...n,...t},ourProps:{ref:s},slot:C,slots:e,attrs:t,name:"Popover"})),Mt(M.MainTreeNode)])}}}),JS=W({name:"PopoverButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(n,{attrs:e,slots:t,expose:r}){var i;let s=(i=n.id)!=null?i:"headlessui-popover-button-".concat(ki()),o=_d("PopoverButton"),a=A(()=>jr(o.button));r({el:o.button,$el:o.button}),Ke(()=>{o.buttonId.value=s}),Xn(()=>{o.buttonId.value=null});let l=Xb(),c=l==null?void 0:l.closeOthers,u=XS(),d=A(()=>u===null?!1:u.value===o.panelId.value),f=E(null),h="headlessui-focus-sentinel-".concat(ki());d.value||zt(()=>{o.button.value=oe(f)});let p=Bb(A(()=>({as:n.as,type:e.type})),f);function m(C){var k,$,O,D,N;if(d.value){if(o.popoverState.value===1)return;switch(C.key){case Et.Space:case Et.Enter:C.preventDefault(),($=(k=C.target).click)==null||$.call(k),o.closePopover(),(O=oe(o.button))==null||O.focus();break}}else switch(C.key){case Et.Space:case Et.Enter:C.preventDefault(),C.stopPropagation(),o.popoverState.value===1&&(c==null||c(o.buttonId.value)),o.togglePopover();break;case Et.Escape:if(o.popoverState.value!==0)return c==null?void 0:c(o.buttonId.value);if(!oe(o.button)||(D=a.value)!=null&&D.activeElement&&!((N=oe(o.button))!=null&&N.contains(a.value.activeElement)))return;C.preventDefault(),C.stopPropagation(),o.closePopover();break}}function g(C){d.value||C.key===Et.Space&&C.preventDefault()}function w(C){var k,$;n.disabled||(d.value?(o.closePopover(),(k=oe(o.button))==null||k.focus()):(C.preventDefault(),C.stopPropagation(),o.popoverState.value===1&&(c==null||c(o.buttonId.value)),o.togglePopover(),($=oe(o.button))==null||$.focus()))}function x(C){C.preventDefault(),C.stopPropagation()}let M=Ub();function b(){let C=oe(o.panel);if(!C)return;function k(){_n(M.value,{[Ir.Forwards]:()=>yn(C,Ot.First),[Ir.Backwards]:()=>yn(C,Ot.Last)})===mi.Error&&yn(wd().filter($=>$.dataset.headlessuiFocusGuard!=="true"),_n(M.value,{[Ir.Forwards]:Ot.Next,[Ir.Backwards]:Ot.Previous}),{relativeTo:oe(o.button)})}k()}return()=>{let C=o.popoverState.value===0,k={open:C},{...$}=n,O=d.value?{ref:f,type:p.value,onKeydown:m,onClick:w}:{ref:f,id:s,type:p.value,"aria-expanded":o.popoverState.value===0,"aria-controls":oe(o.panel)?o.panelId.value:void 0,disabled:n.disabled?!0:void 0,onKeydown:m,onKeyup:g,onClick:w,onMousedown:x};return Mt(X,[un({ourProps:O,theirProps:{...e,...$},slot:k,attrs:e,slots:t,name:"PopoverButton"}),C&&!d.value&&o.isPortalled.value&&Mt(As,{id:h,features:Es.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:b})])}}});W({name:"PopoverOverlay",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0}},setup(n,{attrs:e,slots:t}){let r=_d("PopoverOverlay"),i="headlessui-popover-overlay-".concat(ki()),s=jb(),o=A(()=>s!==null?(s.value&Ps.Open)===Ps.Open:r.popoverState.value===0);function a(){r.closePopover()}return()=>{let l={open:r.popoverState.value===0};return un({ourProps:{id:i,"aria-hidden":!0,onClick:a},theirProps:n,slot:l,attrs:e,slots:t,features:Ds.RenderStrategy|Ds.Static,visible:o.value,name:"PopoverOverlay"})}}});let ZS=W({name:"PopoverPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},focus:{type:Boolean,default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(n,{attrs:e,slots:t,expose:r}){var i;let s=(i=n.id)!=null?i:"headlessui-popover-panel-".concat(ki()),{focus:o}=n,a=_d("PopoverPanel"),l=A(()=>jr(a.panel)),c="headlessui-focus-sentinel-before-".concat(ki()),u="headlessui-focus-sentinel-after-".concat(ki());r({el:a.panel,$el:a.panel}),Ke(()=>{a.panelId.value=s}),Xn(()=>{a.panelId.value=null}),Dt(Jb,a.panelId),zt(()=>{var x,M;if(!o||a.popoverState.value!==0||!a.panel)return;let b=(x=l.value)==null?void 0:x.activeElement;(M=oe(a.panel))!=null&&M.contains(b)||yn(oe(a.panel),Ot.First)});let d=jb(),f=A(()=>d!==null?(d.value&Ps.Open)===Ps.Open:a.popoverState.value===0);function h(x){var M,b;switch(x.key){case Et.Escape:if(a.popoverState.value!==0||!oe(a.panel)||l.value&&!((M=oe(a.panel))!=null&&M.contains(l.value.activeElement)))return;x.preventDefault(),x.stopPropagation(),a.closePopover(),(b=oe(a.button))==null||b.focus();break}}function p(x){var M,b,C,k,$;let O=x.relatedTarget;O&&oe(a.panel)&&((M=oe(a.panel))!=null&&M.contains(O)||(a.closePopover(),((C=(b=oe(a.beforePanelSentinel))==null?void 0:b.contains)!=null&&C.call(b,O)||($=(k=oe(a.afterPanelSentinel))==null?void 0:k.contains)!=null&&$.call(k,O))&&O.focus({preventScroll:!0})))}let m=Ub();function g(){let x=oe(a.panel);if(!x)return;function M(){_n(m.value,{[Ir.Forwards]:()=>{var b;yn(x,Ot.First)===mi.Error&&((b=oe(a.afterPanelSentinel))==null||b.focus())},[Ir.Backwards]:()=>{var b;(b=oe(a.button))==null||b.focus({preventScroll:!0})}})}M()}function w(){let x=oe(a.panel);if(!x)return;function M(){_n(m.value,{[Ir.Forwards]:()=>{let b=oe(a.button),C=oe(a.panel);if(!b)return;let k=wd(),$=k.indexOf(b),O=k.slice(0,$+1),D=[...k.slice($+1),...O];for(let N of D.slice())if(N.dataset.headlessuiFocusGuard==="true"||C!=null&&C.contains(N)){let B=D.indexOf(N);B!==-1&&D.splice(B,1)}yn(D,Ot.First,{sorted:!1})},[Ir.Backwards]:()=>{var b;yn(x,Ot.Previous)===mi.Error&&((b=oe(a.button))==null||b.focus())}})}M()}return()=>{let x={open:a.popoverState.value===0,close:a.close},{focus:M,...b}=n,C={ref:a.panel,id:s,onKeydown:h,onFocusout:o&&a.popoverState.value===0?p:void 0,tabIndex:-1};return un({ourProps:C,theirProps:{...e,...b},attrs:e,slot:x,slots:{...t,default:(...k)=>{var $;return[Mt(X,[f.value&&a.isPortalled.value&&Mt(As,{id:c,ref:a.beforePanelSentinel,features:Es.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:g}),($=t.default)==null?void 0:$.call(t,...k),f.value&&a.isPortalled.value&&Mt(As,{id:u,ref:a.afterPanelSentinel,features:Es.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:w})])]}},features:Ds.RenderStrategy|Ds.Static,visible:f.value,name:"PopoverPanel"})}}});W({name:"PopoverGroup",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"}},setup(n,{attrs:e,slots:t,expose:r}){let i=E(null),s=pi([]),o=A(()=>jr(i)),a=jS();r({el:i,$el:i});function l(f){let h=s.value.indexOf(f);h!==-1&&s.value.splice(h,1)}function c(f){return s.value.push(f),()=>{l(f)}}function u(){var f;let h=o.value;if(!h)return!1;let p=h.activeElement;return(f=oe(i))!=null&&f.contains(p)?!0:s.value.some(m=>{var g,w;return((g=h.getElementById(m.buttonId.value))==null?void 0:g.contains(p))||((w=h.getElementById(m.panelId.value))==null?void 0:w.contains(p))})}function d(f){for(let h of s.value)h.buttonId.value!==f&&h.close()}return Dt(Gb,{registerPopover:c,unregisterPopover:l,isFocusWithinPopoverGroup:u,closeOthers:d,mainTreeNodeRef:a.mainTreeNodeRef}),()=>Mt(X,[un({ourProps:{ref:i},theirProps:{...n,...e},slot:{},attrs:e,slots:t,name:"PopoverGroup"}),Mt(a.MainTreeNode)])}});let QS=W({props:{onFocus:{type:Function,required:!0}},setup(n){let e=E(!0);return()=>e.value?Mt(As,{as:"button",type:"button",features:Es.Focusable,onFocus(t){t.preventDefault();let r,i=50;function s(){var o;if(i--<=0){r&&cancelAnimationFrame(r);return}if((o=n.onFocus)!=null&&o.call(n)){e.value=!1,cancelAnimationFrame(r);return}r=requestAnimationFrame(s)}r=requestAnimationFrame(s)}}):null}});var e4=(n=>(n[n.Forwards=0]="Forwards",n[n.Backwards=1]="Backwards",n))(e4||{}),t4=(n=>(n[n.Less=-1]="Less",n[n.Equal=0]="Equal",n[n.Greater=1]="Greater",n))(t4||{});let Qb=Symbol("TabsContext");function Dl(n){let e=dt(Qb,null);if(e===null){let t=new Error("<".concat(n," /> is missing a parent <TabGroup /> component."));throw Error.captureStackTrace&&Error.captureStackTrace(t,Dl),t}return e}let Jp=Symbol("TabsSSRContext"),n4=W({name:"TabGroup",emits:{change:n=>!0},props:{as:{type:[Object,String],default:"template"},selectedIndex:{type:[Number],default:null},defaultIndex:{type:[Number],default:0},vertical:{type:[Boolean],default:!1},manual:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(n,{slots:e,attrs:t,emit:r}){var i;let s=E((i=n.selectedIndex)!=null?i:n.defaultIndex),o=E([]),a=E([]),l=A(()=>n.selectedIndex!==null),c=A(()=>l.value?n.selectedIndex:s.value);function u(m){var g;let w=eo(d.tabs.value,oe),x=eo(d.panels.value,oe),M=w.filter(b=>{var C;return!((C=oe(b))!=null&&C.hasAttribute("disabled"))});if(m<0||m>w.length-1){let b=_n(s.value===null?0:Math.sign(m-s.value),{[-1]:()=>1,0:()=>_n(Math.sign(m),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0}),C=_n(b,{0:()=>w.indexOf(M[0]),1:()=>w.indexOf(M[M.length-1])});C!==-1&&(s.value=C),d.tabs.value=w,d.panels.value=x}else{let b=w.slice(0,m),C=[...w.slice(m),...b].find($=>M.includes($));if(!C)return;let k=(g=w.indexOf(C))!=null?g:d.selectedIndex.value;k===-1&&(k=d.selectedIndex.value),s.value=k,d.tabs.value=w,d.panels.value=x}}let d={selectedIndex:A(()=>{var m,g;return(g=(m=s.value)!=null?m:n.defaultIndex)!=null?g:null}),orientation:A(()=>n.vertical?"vertical":"horizontal"),activation:A(()=>n.manual?"manual":"auto"),tabs:o,panels:a,setSelectedIndex(m){c.value!==m&&r("change",m),l.value||u(m)},registerTab(m){var g;if(o.value.includes(m))return;let w=o.value[s.value];if(o.value.push(m),o.value=eo(o.value,oe),!l.value){let x=(g=o.value.indexOf(w))!=null?g:s.value;x!==-1&&(s.value=x)}},unregisterTab(m){let g=o.value.indexOf(m);g!==-1&&o.value.splice(g,1)},registerPanel(m){a.value.includes(m)||(a.value.push(m),a.value=eo(a.value,oe))},unregisterPanel(m){let g=a.value.indexOf(m);g!==-1&&a.value.splice(g,1)}};Dt(Qb,d);let f=E({tabs:[],panels:[]}),h=E(!1);Ke(()=>{h.value=!0}),Dt(Jp,A(()=>h.value?null:f.value));let p=A(()=>n.selectedIndex);return Ke(()=>{it([p],()=>{var m;return u((m=n.selectedIndex)!=null?m:n.defaultIndex)},{immediate:!0})}),zt(()=>{if(!l.value||c.value==null||d.tabs.value.length<=0)return;let m=eo(d.tabs.value,oe);m.some((g,w)=>oe(d.tabs.value[w])!==oe(g))&&d.setSelectedIndex(m.findIndex(g=>oe(g)===oe(d.tabs.value[c.value])))}),()=>{let m={selectedIndex:s.value};return Mt(X,[o.value.length<=0&&Mt(QS,{onFocus:()=>{for(let g of o.value){let w=oe(g);if((w==null?void 0:w.tabIndex)===0)return w.focus(),!0}return!1}}),un({theirProps:{...t,...Hb(n,["selectedIndex","defaultIndex","manual","vertical","onChange"])},ourProps:{},slot:m,slots:e,attrs:t,name:"TabGroup"})])}}}),r4=W({name:"TabList",props:{as:{type:[Object,String],default:"div"}},setup(n,{attrs:e,slots:t}){let r=Dl("TabList");return()=>{let i={selectedIndex:r.selectedIndex.value},s={role:"tablist","aria-orientation":r.orientation.value};return un({ourProps:s,theirProps:n,slot:i,attrs:e,slots:t,name:"TabList"})}}}),i4=W({name:"Tab",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},setup(n,{attrs:e,slots:t,expose:r}){var i;let s=(i=n.id)!=null?i:"headlessui-tabs-tab-".concat(ki()),o=Dl("Tab"),a=E(null);r({el:a,$el:a}),Ke(()=>o.registerTab(a)),Xn(()=>o.unregisterTab(a));let l=dt(Jp),c=A(()=>{if(l.value){let x=l.value.tabs.indexOf(s);return x===-1?l.value.tabs.push(s)-1:x}return-1}),u=A(()=>{let x=o.tabs.value.indexOf(a);return x===-1?c.value:x}),d=A(()=>u.value===o.selectedIndex.value);function f(x){var M;let b=x();if(b===mi.Success&&o.activation.value==="auto"){let C=(M=jr(a))==null?void 0:M.activeElement,k=o.tabs.value.findIndex($=>oe($)===C);k!==-1&&o.setSelectedIndex(k)}return b}function h(x){let M=o.tabs.value.map(b=>oe(b)).filter(Boolean);if(x.key===Et.Space||x.key===Et.Enter){x.preventDefault(),x.stopPropagation(),o.setSelectedIndex(u.value);return}switch(x.key){case Et.Home:case Et.PageUp:return x.preventDefault(),x.stopPropagation(),f(()=>yn(M,Ot.First));case Et.End:case Et.PageDown:return x.preventDefault(),x.stopPropagation(),f(()=>yn(M,Ot.Last))}if(f(()=>_n(o.orientation.value,{vertical(){return x.key===Et.ArrowUp?yn(M,Ot.Previous|Ot.WrapAround):x.key===Et.ArrowDown?yn(M,Ot.Next|Ot.WrapAround):mi.Error},horizontal(){return x.key===Et.ArrowLeft?yn(M,Ot.Previous|Ot.WrapAround):x.key===Et.ArrowRight?yn(M,Ot.Next|Ot.WrapAround):mi.Error}}))===mi.Success)return x.preventDefault()}let p=E(!1);function m(){var x;p.value||(p.value=!0,!n.disabled&&((x=oe(a))==null||x.focus({preventScroll:!0}),o.setSelectedIndex(u.value),SS(()=>{p.value=!1})))}function g(x){x.preventDefault()}let w=Bb(A(()=>({as:n.as,type:e.type})),a);return()=>{var x,M;let b={selected:d.value,disabled:(x=n.disabled)!=null?x:!1},{...C}=n,k={ref:a,onKeydown:h,onMousedown:g,onClick:m,id:s,role:"tab",type:w.value,"aria-controls":(M=oe(o.panels.value[u.value]))==null?void 0:M.id,"aria-selected":d.value,tabIndex:d.value?0:-1,disabled:n.disabled?!0:void 0};return un({ourProps:k,theirProps:C,slot:b,attrs:e,slots:t,name:"Tab"})}}}),s4=W({name:"TabPanels",props:{as:{type:[Object,String],default:"div"}},setup(n,{slots:e,attrs:t}){let r=Dl("TabPanels");return()=>{let i={selectedIndex:r.selectedIndex.value};return un({theirProps:n,ourProps:{},slot:i,attrs:t,slots:e,name:"TabPanels"})}}}),o4=W({name:"TabPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null},tabIndex:{type:Number,default:0}},setup(n,{attrs:e,slots:t,expose:r}){var i;let s=(i=n.id)!=null?i:"headlessui-tabs-panel-".concat(ki()),o=Dl("TabPanel"),a=E(null);r({el:a,$el:a}),Ke(()=>o.registerPanel(a)),Xn(()=>o.unregisterPanel(a));let l=dt(Jp),c=A(()=>{if(l.value){let f=l.value.panels.indexOf(s);return f===-1?l.value.panels.push(s)-1:f}return-1}),u=A(()=>{let f=o.panels.value.indexOf(a);return f===-1?c.value:f}),d=A(()=>u.value===o.selectedIndex.value);return()=>{var f;let h={selected:d.value},{tabIndex:p,...m}=n,g={ref:a,id:s,role:"tabpanel","aria-labelledby":(f=oe(o.tabs.value[u.value]))==null?void 0:f.id,tabIndex:d.value?p:-1};return!d.value&&n.unmount&&!n.static?Mt(As,{as:"span","aria-hidden":!0,...g}):un({ourProps:g,theirProps:m,slot:h,attrs:e,slots:t,features:Ds.Static|Ds.RenderStrategy,visible:d.value,name:"TabPanel"})}}});const a4=W({__name:"ToggletipButton",props:{size:{default:"xs"},icon:{default:"fr-icon-information-line"}},setup(n){const e=n,t=A(()=>e.size==="md"?"":e.size==="xs"?"fr-btn--".concat(e.size," fr-icon--sm"):"fr-btn--".concat(e.size));return(r,i)=>(_(),S("button",{class:me("fr-btn fr-btn--tertiary-no-outline text-grey-380 fr-btn--darker-hover align-middle ".concat(t.value," ").concat(r.icon))},null,2))}}),l4=W({inheritAttrs:!1,__name:"Toggletip",props:{noMargin:{type:Boolean,default:!1},position:{default:"left"}},setup(n){return(e,t)=>(_(),G(v(Zb),{class:"relative text-grey-500",focus:!0},{default:K(()=>[P(v(JS),yr(e.$attrs,{ref:"button",as:a4}),{default:K(()=>[et(e.$slots,"default",{},void 0,!0)]),_:3},16),P(v(ZS),{class:me(["toggletip",{"fr-p-0":e.noMargin,"left-0":e.position==="right"}]),ref:"toggletip"},{default:K(({close:r})=>[et(e.$slots,"toggletip",{close:r},void 0,!0)]),_:3},8,["class"])]),_:3}))}}),Zp=Ne(l4,[["__scopeId","data-v-3bf812ef"]]),c4={class:"fr-m-0 fr-grid-row fr-grid-row--middle fr-text--sm text-mention-grey"},u4={class:"fr-grid-row fr-grid-row--middle"},d4={class:"fr-text--sm fr-my-0"},f4={class:"list-style-none fr-m-0 fr-p-0"},h4={class:"fr-grid-row fr-grid-row--right not-enlarged"},p4=["href","title"],m4={class:"fr-my-0 fr-mr-1v text-mention-grey fr-text--sm"},g4={class:"fr-grid-row fr-grid-row--middle fr-mr-1v"},v4=W({__name:"QualityComponentInline",props:{quality:{}},setup(n){return(e,t)=>(_(),S("div",c4,[y("div",u4,[P(v(Zp),{class:"relative z-2"},{toggletip:K(()=>[y("h5",d4,T(e.$t("Metadata quality:")),1),y("ul",f4,[P(v(Jr),{passed:e.quality.dataset_description_quality,messagePassed:e.$t("Data description filled"),messageFailed:e.$t("Data description empty"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),P(v(Jr),{passed:e.quality.resources_documentation,messagePassed:e.$t("Files documented"),messageFailed:e.$t("Files documentation missing"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),P(v(Jr),{passed:e.quality.license,messagePassed:e.$t("License filled"),messageFailed:e.$t("No license set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),P(v(Jr),{passed:e.quality.update_frequency&&!!e.quality.update_fulfilled_in_time,messagePassed:e.$t("Update frequency followed"),messageFailed:e.quality.update_frequency?e.$t("Update frequency not followed"):e.$t("Update frequency not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),P(v(Jr),{passed:e.quality.has_open_format,messagePassed:e.$t("File formats are open"),messageFailed:e.$t("File formats are closed"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),P(v(Jr),{passed:e.quality.temporal_coverage,messagePassed:e.$t("Temporal coverage filled"),messageFailed:e.$t("Temporal coverage not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),P(v(Jr),{passed:e.quality.spatial,messagePassed:e.$t("Spatial coverage filled"),messageFailed:e.$t("Spatial coverage not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),P(v(Jr),{passed:e.quality.all_resources_available,messagePassed:e.$t("All files are available"),messageFailed:e.$t("Some files are unavailable"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"])]),y("div",h4,[y("a",{href:v(Ct).guides_quality_url,target:"_blank",rel:"noopener",title:e.$t("Learn more about this indicator - opens a new window")},T(e.$t("Learn more about this indicator")),9,p4)])]),_:1}),y("p",m4,T(e.$t("Metadata :")),1),y("div",g4,[P(v(kS),{score:e.quality.score},null,8,["score"])])])]))}});function y4(n){const e=E(!1);function t(){e.value=!e.value;const r=document.getElementById(n);r&&Ob(r,e.value)}return{expanded:e,expand:t}}const b4=MC({duration:!1,dismissible:!0});function w4(){return{toast:b4}}function kd(n){return A(()=>{const t=pt(n);if(t)return t.organization?t.organization.name:t.owner.first_name+" "+t.owner.last_name})}const _4={class:"fr-my-2w fr-p-2w border border-default-grey fr-enlarge-link"},k4={key:0,class:"absolute top-0 fr-grid-row fr-grid-row--middle fr-mt-n3v fr-ml-n1v"},x4={key:0,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},C4={key:1,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},S4={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--top"},M4={class:"fr-col-auto"},T4={class:"logo"},O4={class:"fr-col-12 fr-col-sm"},$4={class:"fr-text--md fr-mb-0 fr-grid-row"},D4={key:0,class:"fr-col-auto fr-ml-1w"},E4={key:0,class:"fr-text--sm fr-m-0 inline-flex"},A4={key:0,class:"not-enlarged fr-mr-1v"},P4={class:"text-mention-grey dash-before-sm whitespace-nowrap"},N4={class:"fr-mx-0 fr-mb-n1v fr-grid-row fr-grid-row--middle fr-text--sm text-mention-grey"},R4={class:"fr-hidden flex-sm dash-after-sm text-grey-500"},L4={class:"fr-grid-row fr-grid-row--middle fr-mr-1v"},I4=["aria-label"],z4=["aria-label"],B4=["aria-label"],F4=W({__name:"DatasetCard",props:{dataset:{},datasetUrl:{},organizationUrl:{},showDescription:{type:Boolean,default:!0}},setup(n){const e=n,{t}=De(),r=kd(e.dataset);return(i,s)=>(_(),S("div",_4,[i.dataset.private||i.dataset.archived?(_(),S("div",k4,[i.dataset.private?(_(),S("p",x4,[s[0]||(s[0]=y("span",{class:"fr-icon-lock-line fr-icon--sm","aria-hidden":"true"},null,-1)),Y(" "+T(v(t)("Draft")),1)])):V("",!0),i.dataset.archived?(_(),S("p",C4,[s[1]||(s[1]=y("span",{class:"fr-icon-archive-line fr-icon--sm","aria-hidden":"true"},null,-1)),Y(" "+T(v(t)("Archived")),1)])):V("",!0)])):V("",!0),y("div",S4,[y("div",M4,[y("div",T4,[i.dataset.organization?(_(),G(v(Th),{key:0,type:"dataset",src:i.dataset.organization.logo_thumbnail,alt:"",size:40},null,8,["src"])):i.dataset.owner?(_(),G(vb,{key:1,user:i.dataset.owner,size:40},null,8,["user"])):(_(),G(v(Th),{key:2,type:"dataset",size:40}))])]),y("div",O4,[y("h4",$4,[et(i.$slots,"datasetUrl",{dataset:i.dataset,datasetUrl:i.datasetUrl},()=>[P(Co,{to:i.datasetUrl,class:"text-grey-500 fr-grid-row"},{default:K(()=>[P(v(sn),{class:"fr-col","auto-resize":!0,text:i.dataset.title,"max-lines":1},null,8,["text"]),i.dataset.acronym?(_(),S("small",D4,T(i.dataset.acronym),1)):V("",!0)]),_:1},8,["to"])])]),i.dataset.organization||i.dataset.owner?(_(),S("div",E4,[i.dataset.organization?(_(),S("span",A4,[i.organizationUrl?(_(),G(Co,{key:0,class:"fr-link fr-text--sm inline-flex items-center",to:i.organizationUrl},{default:K(()=>[P($s,{organization:i.dataset.organization},null,8,["organization"])]),_:1},8,["to"])):(_(),G($s,{key:1,organization:i.dataset.organization},null,8,["organization"]))])):(_(),G(v(sn),{key:1,class:"not-enlarged fr-mr-1v","auto-resize":!0,text:v(r),"max-lines":1},null,8,["text"])),y("span",P4,T(i.$t("Updated {date}",{date:v(pd)(i.dataset.last_update)})),1)])):V("",!0),y("div",N4,[y("div",R4,[P(v(v4),{quality:i.dataset.quality},null,8,["quality"])]),y("div",L4,[y("p",{class:"fr-text--sm fr-my-0","aria-label":v(t)("{n} resources downloads",i.dataset.metrics.resources_downloads)},[s[2]||(s[2]=y("span",{class:"fr-icon-download-line fr-icon--sm fr-px-1v","aria-hidden":"true"},null,-1)),Y(T(v(go)(i.dataset.metrics.resources_downloads)),1)],8,I4),y("p",{class:"fr-text--sm fr-my-0","aria-label":v(t)("{n} followers",i.dataset.metrics.followers)},[s[3]||(s[3]=y("span",{class:"fr-icon-star-line fr-icon--sm fr-px-1v","aria-hidden":"true"},null,-1)),Y(T(v(go)(i.dataset.metrics.followers)),1)],8,z4),y("p",{class:"fr-text--sm fr-my-0","aria-label":v(t)("{n} reuses",i.dataset.metrics.reuses)},[s[4]||(s[4]=y("span",{class:"fr-icon-line-chart-line fr-icon--sm fr-px-1v","aria-hidden":"true"},null,-1)),Y(T(v(go)(i.dataset.metrics.reuses)),1)],8,B4)])]),i.showDescription?(_(),G(ab,{key:1},{default:K(()=>[P(gb,{class:"fr-text--sm fr-mt-1w fr-mb-0 overflow-wrap-anywhere","auto-resize":!0,text:v(ub)(i.dataset.description),"max-lines":2},null,8,["text"])]),_:1})):V("",!0)])])]))}}),V4={key:0,class:"absolute top-0 fr-grid-row fr-grid-row--middle fr-mt-n3v fr-ml-n1v"},H4={key:0,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},W4={key:1,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},j4={key:2,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},U4={class:"fr-text--md fr-mb-0"},q4={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",class:"fr-mr-1v",style:{width:"1rem"}},Y4={key:1,class:"fr-icon-terminal-line fr-icon--sm fr-mr-1v","aria-hidden":"true"},K4={key:1,class:"fr-text--sm text-mention-grey inline-flex fr-mt-1v fr-mb-0"},G4={key:0,class:"not-enlarged"},X4={class:"dash-before whitespace-nowrap"},J4={class:"fr-text--sm text-mention-grey fr-my-0 fr-mt-1v"},Z4={class:"text-grey-400"},Q4=W({__name:"DataserviceCard",props:{dataservice:{},dataserviceUrl:{},organizationUrl:{},showDescription:{type:Boolean,default:!0}},setup(n){const e=n,{t}=De(),r=kd(e.dataservice),i=A(()=>Ct.tabular_api_dataservice_id===e.dataservice.id);return(s,o)=>(_(),S("article",{class:me(["fr-my-2w fr-p-2w border fr-enlarge-link",{"border-tabular-api":i.value}]),style:Wo(e.style)},[s.dataservice.access_type==="restricted"||s.dataservice.private||s.dataservice.archived_at?(_(),S("div",V4,[s.dataservice.access_type==="restricted"?(_(),S("p",H4,[o[0]||(o[0]=y("span",{class:"fr-icon-lock-line fr-icon--sm","aria-hidden":"true"},null,-1)),Y(" "+T(v(t)("Restricted access")),1)])):V("",!0),s.dataservice.private?(_(),S("p",W4,[o[1]||(o[1]=y("span",{class:"fr-icon-lock-line fr-icon--sm","aria-hidden":"true"},null,-1)),Y(" "+T(v(t)("Draft")),1)])):V("",!0),s.dataservice.archived_at?(_(),S("p",j4,[o[2]||(o[2]=y("span",{class:"fr-icon-lock-line fr-icon--sm","aria-hidden":"true"},null,-1)),Y(" "+T(v(t)("Archived")),1)])):V("",!0)])):V("",!0),y("h4",U4,[et(s.$slots,"dataserviceUrl",{dataservice:s.dataservice,dataserviceUrl:s.dataserviceUrl},()=>[i.value?(_(),S("svg",q4,o[3]||(o[3]=[y("path",{d:"M17.0007 1.20825 18.3195 3.68108 20.7923 4.99992 18.3195 6.31876 17.0007 8.79159 15.6818 6.31876 13.209 4.99992 15.6818 3.68108 17.0007 1.20825ZM10.6673 9.33325 15.6673 11.9999 10.6673 14.6666 8.00065 19.6666 5.33398 14.6666.333984 11.9999 5.33398 9.33325 8.00065 4.33325 10.6673 9.33325ZM11.4173 11.9999 9.18905 10.8115 8.00065 8.58325 6.81224 10.8115 4.58398 11.9999 6.81224 13.1883 8.00065 15.4166 9.18905 13.1883 11.4173 11.9999ZM19.6673 16.3333 18.0007 13.2083 16.334 16.3333 13.209 17.9999 16.334 19.6666 18.0007 22.7916 19.6673 19.6666 22.7923 17.9999 19.6673 16.3333Z"},null,-1)]))):(_(),S("span",Y4)),P(Co,{class:"inline-flex",to:s.dataserviceUrl},{default:K(()=>[P(v(sn),{"auto-resize":!0,text:s.dataservice.title,"max-lines":1},null,8,["text"])]),_:1},8,["to"])],!0)]),s.dataservice.organization||s.dataservice.owner?(_(),S("p",K4,[s.dataservice.organization?(_(),S("span",G4,[s.organizationUrl?(_(),G(Co,{key:0,class:"fr-link fr-text--sm",to:s.organizationUrl},{default:K(()=>[P($s,{organization:s.dataservice.organization},null,8,["organization"])]),_:1},8,["to"])):(_(),G($s,{key:1,organization:s.dataservice.organization},null,8,["organization"]))])):(_(),G(v(sn),{key:1,class:"not-enlarged fr-mr-1v","auto-resize":!0,text:v(r),"max-lines":1},null,8,["text"])),y("span",X4,T(v(t)("Updated {date}",{date:v(pd)(s.dataservice.metadata_modified_at)})),1)])):V("",!0),y("p",J4,[o[4]||(o[4]=y("span",{class:"fr-icon-information-line fr-icon--sm text-grey-380"},null,-1)),Y(" "+T(v(t)("Availability :"))+" ",1),y("span",Z4,[s.dataservice.availability?(_(),S(X,{key:0},[Y(T(v(t)("{n}%",s.dataservice.availability)),1)],64)):(_(),S(X,{key:1},[Y(T(v(t)("unknown")),1)],64))])]),s.showDescription?(_(),G(ab,{key:2},{default:K(()=>[P(gb,{class:"fr-text--sm fr-mt-1w fr-mb-0 overflow-wrap-anywhere","auto-resize":!0,text:v(ub)(s.dataservice.description),"max-lines":2},null,8,["text"])]),_:1})):V("",!0)],6))}}),ew=Ne(Q4,[["__scopeId","data-v-47254e37"]]),eM={class:"fr-grid-row fr-grid-row--middle fr-pb-3w fr-mb-3w border-bottom border-default-grey"},tM={class:"fr-col"},nM={class:"fr-col-auto"},rM=["aria-expanded","aria-controls"],iM=["id"],sM={class:"fr-pb-3w fr-mb-3w border-bottom border-default-grey"},oM={class:"fr-grid-row fr-grid-row--gutters fr-text--sm fr-m-0","data-testid":"extra-list"},aM={class:"subtitle fr-mb-1v"},lM={class:"fr-text--sm fr-m-0 text-mention-grey overflow-wrap-anywhere"},cM=W({__name:"ExtraAccordion",props:{buttonText:{},titleText:{},extra:{},titleLevel:{}},setup(n){const e=Ws("accordion"),{expanded:t,expand:r}=y4(e);return(i,s)=>(_(),S("div",null,[y("header",eM,[y("div",tM,[(_(),G(ys(i.titleLevel),{class:"subtitle subtitle--uppercase fr-m-0"},{default:K(()=>[Y(T(i.titleText),1)]),_:1}))]),y("div",nM,[y("button",{onClick:s[0]||(s[0]=(...o)=>v(r)&&v(r)(...o)),role:"button","aria-expanded":v(t),"aria-controls":v(e),class:me(["fr-btn fr-btn--tertiary-no-outline fr-btn--icon-left fr-btn--secondary-grey-500",{"fr-icon-arrow-up-s-line":v(t),"fr-icon-arrow-down-s-line":!v(t)}]),"data-testid":"button"},[v(t)?(_(),S(X,{key:0},[Y(T(i.$t("Close details")),1)],64)):(_(),S(X,{key:1},[Y(T(i.buttonText),1)],64))],10,rM)])]),y("div",{class:"accordion-content",id:v(e)},[y("div",sM,[y("div",oM,[(_(!0),S(X,null,Ye(i.extra,(o,a)=>(_(),S("div",{key:a,class:"fr-col-12 fr-col-sm-6 fr-col-md-4"},[y("h3",aM,T(a),1),y("p",lM,T(o),1)]))),128))])])],8,iM)]))}}),uM=W({__name:"OwnerType",props:{type:{},size:{default:"sm"},color:{default:"grey"}},setup(n){const e=n,t=A(()=>{switch(e.color){case"black":return"text-grey-500";case"grey":return"text-mention-grey"}}),r=A(()=>Ab(e.type).label);return(i,s)=>(_(),S("p",{class:me("".concat(t.value," fr-text--").concat(i.size," fr-my-0"))},[P(Gp,{type:i.type},null,8,["type"]),Y(" "+T(r.value),1)],2))}}),Ec=3;function tw(n,e=1){return[...Array(n).keys()].map(t=>t+e)}function dM(n){return tw(n)}function fM(n,e){return Math.min(Ec*2+1,n.length-2,Ec+e-1,Ec+n.length-e)}function hM(n){return Math.max(n-Ec,2)}function pM(n,e){const t=dM(e),r=hM(n);if(e<=2)return[];let i=tw(fM(t,n),r);return i.includes(2)||i.unshift(null),i.includes(e-1)||i.push(null),i}const mM=["aria-label"],gM={class:"fr-pagination__list"},vM=["href"],yM=["href"],bM=["aria-current","href","title"],wM=["aria-current","href","title","onClick","data-testid"],_M={key:1,class:"fr-pagination__link fr-hidden fr-unhidden-lg"},kM=["aria-current","href","title","data-testid"],xM=["href"],CM=["href"],js=W({__name:"Pagination",props:{page:{default:1},pageSize:{default:20},totalResults:{}},emits:["change"],setup(n,{emit:e}){const t=e,r=n,{t:i}=De(),s=A(()=>Math.ceil(r.totalResults/r.pageSize)),o=A(()=>pM(r.page,s.value)),a=u=>{if(u!==r.page)return t("change",u)},l=()=>{const u=r.page+1;if(u<=s.value)return t("change",u)},c=()=>{const u=r.page-1;if(u>0)return t("change",u)};return(u,d)=>u.totalResults>u.pageSize?(_(),S("nav",{key:0,role:"navigation",class:"fr-pagination fr-pagination--centered","aria-label":v(i)("Pagination")},[y("ul",gM,[y("li",null,[y("a",{href:u.page===1?void 0:"#",class:"fr-pagination__link fr-pagination__link--first",onClick:d[0]||(d[0]=$e(f=>a(1),["prevent"])),"data-testid":"first-page"},T(v(i)("First page")),9,vM)]),y("li",null,[y("a",{href:u.page===1?void 0:"#",class:"fr-pagination__link fr-pagination__link--prev fr-pagination__link--lg-label",onClick:$e(c,["prevent"]),"data-testid":"previous-page"},T(v(i)("Previous page")),9,yM)]),y("li",null,[y("a",{"aria-current":u.page===1?"page":void 0,href:u.page===1?void 0:"#",class:me(["fr-pagination__link",{"fr-hidden fr-unhidden-sm":u.page>1}]),title:v(i)("Page {nb}",{nb:1}),onClick:d[1]||(d[1]=$e(f=>a(1),["prevent"])),"data-testid":1}," 1 ",10,bM)]),(_(!0),S(X,null,Ye(o.value,f=>(_(),S("li",null,[f?(_(),S("a",{key:0,class:me(["fr-pagination__link",{"fr-hidden fr-unhidden-lg":f<u.page-1||f>u.page+1}]),"aria-current":u.page===f?"page":void 0,href:u.page===f?void 0:"#",title:v(i)("Page {nb}",{nb:f}),onClick:$e(h=>a(f),["prevent"]),"data-testid":f},T(f),11,wM)):(_(),S("a",_M," … "))]))),256)),y("li",null,[y("a",{class:"fr-pagination__link","aria-current":u.page===s.value?"page":void 0,href:u.page===s.value?void 0:"#",title:v(i)("Page {nb}",{nb:s.value}),onClick:d[2]||(d[2]=$e(f=>a(s.value),["prevent"])),"data-testid":s.value},T(s.value),9,kM)]),y("li",null,[y("a",{class:"fr-pagination__link fr-pagination__link--next fr-pagination__link--lg-label",href:u.page===s.value?void 0:"#",onClick:$e(l,["prevent"]),"data-testid":"next-page"},T(v(i)("Next page")),9,xM)]),y("li",null,[y("a",{class:"fr-pagination__link fr-pagination__link--last",href:u.page===s.value?void 0:"#",onClick:d[3]||(d[3]=$e(f=>a(s.value),["prevent"])),"data-testid":"last-page"},T(v(i)("Last page")),9,CM)])])],8,mM)):V("",!0)}}),SM={class:"relative"},Ov=284,nw=W({__name:"ReadMore",props:{maxHeight:{default:""}},setup(n){const e=n,t=E(!1),r=E(!1),i=il("containerRef"),s=il("readMoreRef"),{height:o}=bS(i),a=E(Ov),l=f=>{const h=getComputedStyle(f);return parseFloat(h.getPropertyValue("height"))+parseFloat(h.getPropertyValue("margin-top"))+parseFloat(h.getPropertyValue("margin-bottom"))},c=()=>{const f=document.querySelector('[data-read-more-max-height="'.concat(e.maxHeight,'"]'));return f?Array.from(f.children).map(l).reduce((h,p)=>h+p,0):Ov},u=f=>{a.value=c(),r.value=f>a.value,r.value||(a.value=f)},d=()=>{if(!s.value)return;const f=Tb(s.value);t.value?Ou({from:{height:s.value.scrollHeight},to:{height:c()},duration:300,ease:$u}).start({update:f.set,complete:()=>{var h;return(h=s.value)==null?void 0:h.scrollIntoView({behavior:"smooth"})}}):Ou({from:{height:c()},to:{height:s.value.scrollHeight},duration:300,ease:$u}).start({update:f.set,complete:()=>f.set({height:"auto"})}),t.value=!t.value};return it(o,u),(f,h)=>(_(),S("div",SM,[y("div",{class:me(["read-more",{expand:t.value}]),ref_key:"readMoreRef",ref:s,style:Wo({height:a.value+"px"})},[y("div",{ref_key:"containerRef",ref:i},[et(f.$slots,"default")],512)],6),r.value?(_(),S("div",{key:0,class:"read-more__bottom",onClick:$e(d,["prevent"])},[y("button",{role:"button",class:"fr-btn fr-btn--tertiary-no-outline",onClick:$e(d,["prevent","stop"])},[t.value?(_(),S(X,{key:0},[Y(T(f.$t("Read less")),1)],64)):(_(),S(X,{key:1},[Y(T(f.$t("Read more")),1)],64))])])):V("",!0)]))}}),MM=["y"],TM=["y"],OM=["y"],$M=["y"],DM=["y"],EM=["y"],AM=["y"],rw=W({__name:"Loader",setup(n){function e(t){return 16+4+t*(32+24)}return(t,r)=>(_(),G(v($l),{width:1124,height:300,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},{default:K(()=>[r[0]||(r[0]=y("rect",{x:"16",y:"16",rx:"4",ry:"4",width:"112",height:"24"},null,-1)),r[1]||(r[1]=y("rect",{x:"160",y:"16",rx:"4",ry:"4",width:"116",height:"24"},null,-1)),r[2]||(r[2]=y("rect",{x:"308",y:"16",rx:"4",ry:"4",width:"140",height:"24"},null,-1)),r[3]||(r[3]=y("rect",{x:"480",y:"16",rx:"4",ry:"4",width:"106",height:"24"},null,-1)),r[4]||(r[4]=y("rect",{x:"618",y:"16",rx:"4",ry:"4",width:"140",height:"24"},null,-1)),r[5]||(r[5]=y("rect",{x:"790",y:"16",rx:"4",ry:"4",width:"144",height:"24"},null,-1)),r[6]||(r[6]=y("rect",{x:"966",y:"16",rx:"4",ry:"4",width:"142",height:"24"},null,-1)),r[7]||(r[7]=y("rect",{x:"4",y:"56",rx:"4",ry:"4",width:"1116",height:"4"},null,-1)),(_(),S(X,null,Ye(5,i=>(_(),S(X,null,[y("rect",{x:"16",y:e(i),rx:"4",ry:"4",width:"112",height:"32"},null,8,MM),y("rect",{x:"160",y:e(i),rx:"4",ry:"4",width:"116",height:"32"},null,8,TM),y("rect",{x:"308",y:e(i),rx:"4",ry:"4",width:"140",height:"32"},null,8,OM),y("rect",{x:"480",y:e(i),rx:"4",ry:"4",width:"106",height:"32"},null,8,$M),y("rect",{x:"618",y:e(i),rx:"4",ry:"4",width:"140",height:"32"},null,8,DM),y("rect",{x:"790",y:e(i),rx:"4",ry:"4",width:"144",height:"32"},null,8,EM),y("rect",{x:"966",y:e(i),rx:"4",ry:"4",width:"142",height:"32"},null,8,AM)],64))),64))]),_:1}))}});function PM(n,e,t){let r="".concat(Ct.tabular_api_url,"/api/resources/").concat(n,"/data/?page=").concat(e,"&page_size=").concat(Ct.tabular_page_size);return t&&(r=r+"&".concat(t.column,"__sort=").concat(t.type)),hr.get(r)}function NM(n){const e="".concat(Ct.tabular_api_url,"/api/resources/").concat(n,"/profile/");return hr.get(e)}const RM={key:0,class:"bg-alt-green-tilleul-verveine fr-p-3v fr-mb-2w"},LM={class:"fr-grid-row fr-m-0"},IM={key:2,class:"fr-grid-row fr-grid-row--gutters"},zM={key:0,class:"bg-alt-green-tilleul-verveine fr-p-3v fr-mb-2w"},BM={class:"fr-grid-row fr-m-0"},FM={class:"fr-col-12 fr-col-sm-6 fr-col-md-4 fr-col-lg-3"},VM={class:"fr-text--sm fr-text--bold fr-mt-0 fr-mb-1v"},HM={class:"code"},WM=W({__name:"DataStructure",props:{resource:{}},setup(n){const e=n,t=E([]),r=E({}),i=E(!0),s=E(!1),o=E(!1);return Ke(async()=>{try{const{data:a}=await NM(e.resource.id);"profile"in a&&a.profile?(t.value=Object.keys(a.profile.columns),r.value=a.profile.columns,o.value=!0,i.value=!1):(s.value=!0,i.value=!1)}catch(a){s.value=!0,i.value=!1}}),(a,l)=>s.value?(_(),S("div",RM,[y("p",LM,[l[0]||(l[0]=y("span",{class:"fr-icon-warning-line","aria-hidden":"true"},null,-1)),Y(" "+T(a.$t("The data structure of this file failed to load.")),1)])])):i.value?(_(),G(rw,{key:1})):(_(),S("div",IM,[o.value?V("",!0):(_(),S("div",zM,[y("p",BM,[l[1]||(l[1]=y("span",{class:"fr-icon-warning-line","aria-hidden":"true"},null,-1)),Y(" "+T(a.$t("No data structure found for this file.")),1)])])),o.value?(_(!0),S(X,{key:1},Ye(t.value,c=>(_(),S("div",FM,[y("h5",VM,T(c),1),y("code",HM,T(r.value[c].format),1)]))),256)):V("",!0)]))}}),jM='<svg width="64" height="64" viewBox="0 0 64 64" aria-hidden="true" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="path-1-inside-1_677_1834" fill="white"><path d="M47.6364 31.7323C47.8391 31.8153 48.0153 31.8812 48.1901 31.9556C49.3599 32.4569 50.0394 33.3352 50.1277 34.6162C50.1983 35.6647 50.2292 36.7158 50.2371 37.7685C50.2523 39.8635 51.2789 41.4763 52.6657 42.8981C53.5865 43.842 53.6661 44.3716 52.7286 45.2974C51.1332 46.8812 49.3827 48.2165 47.1329 48.7665C44.8819 49.3216 42.5083 49.0548 40.4357 48.0138C39.4892 47.5604 38.5265 47.3019 37.5309 47.7071C37.071 47.9103 36.6618 48.214 36.3331 48.596C36.0111 48.9977 35.7367 49.4357 35.5154 49.9011C35.0548 50.75 34.2981 51.2484 33.4773 51.6648C33.2122 51.7978 32.9196 51.8661 32.6233 51.8641C32.3271 51.862 32.0355 51.7897 31.7724 51.653C31.4776 51.521 31.2044 51.3451 30.9618 51.1313C29.8211 50.0656 28.445 49.7385 26.9352 49.6965C24.2186 49.5962 21.5474 48.9671 19.0698 47.8441C18.4504 47.5532 17.8641 47.1957 17.3213 46.7778C16.6911 46.3217 16.5988 45.9152 16.8344 45.1807C17.1056 44.3195 17.3992 43.4821 17.6453 42.6226C17.6638 42.5251 17.6598 42.4247 17.6338 42.329C17.6077 42.2333 17.5603 42.1449 17.495 42.0705C16.4777 41.1564 16.4698 41.1632 15.3346 41.8919C12.2675 43.8671 9.1983 45.8419 6.12697 47.816C5.39573 48.2874 5.04746 48.1891 4.61497 47.4308C4.33147 46.9348 4.052 46.4365 3.77656 45.9357C3.18563 44.8787 3.26602 44.5782 4.27115 43.9407C7.48797 41.9067 10.6834 39.8658 13.9015 37.8507C14.3035 37.5956 14.4007 37.3572 14.3108 36.8936C13.6776 33.714 14.5417 30.9795 16.8278 28.6954C16.9816 28.5764 17.0894 28.4073 17.1328 28.2171C17.1763 28.027 17.1526 27.8277 17.0658 27.6532C16.5668 26.2486 15.7792 25.1355 14.3525 24.5233C13.5227 24.1467 12.7175 23.7178 11.9416 23.2391C10.7864 22.5922 9.89092 21.5619 9.40841 20.3243C9.31335 20.0822 9.28169 19.8197 9.31644 19.5617C9.3512 19.3037 9.45121 19.059 9.60692 18.8509C10.6377 17.2552 12.2625 16.7311 13.9773 16.7337C15.3337 16.7378 16.6957 17.1374 18.0435 17.418C19.2594 17.6697 19.3451 17.666 19.9235 16.5752C20.1987 16.055 20.4163 15.4882 20.7251 14.9994C21.2758 14.1191 21.9105 13.926 22.8624 14.3348C23.2938 14.516 23.7286 14.7474 24.1486 14.9462C24.9684 15.324 25.7026 15.2084 26.3461 14.585C26.6077 14.3351 26.842 14.0578 27.045 13.7578C27.8829 12.5231 28.9904 11.4969 30.2827 10.7576C31.7264 9.85971 32.9011 8.58535 33.6818 7.07013C34.0043 6.47507 34.6284 6.37336 35.1547 6.87449C36.1787 7.85765 37.2353 8.82594 38.1708 9.8952C39.6137 11.5828 41.5324 12.7905 43.6733 13.3587C45.1679 13.7661 46.5788 14.4553 48.045 14.97C49.8289 15.5957 51.624 16.1995 53.4326 16.7561C54.4429 17.0682 54.7071 17.4125 54.4318 18.4614C53.8032 20.8525 53.1633 23.2416 52.512 25.6287C52.2313 26.6591 51.5044 27.3829 50.6757 27.9621C49.3363 28.9134 48.2845 30.2182 47.6364 31.7323ZM19.0829 43.0845C18.8621 43.7906 18.688 44.4745 18.4321 45.1261C18.2675 45.546 18.3981 45.7414 18.7452 45.9473C21.1132 47.3103 23.6962 47.8813 26.3813 48.163C27.5256 48.2847 28.6999 48.356 29.785 48.6883C30.5876 48.9346 31.287 49.5481 32.0035 50.0404C32.41 50.3202 32.7838 50.4547 33.176 50.0845C33.6071 49.6961 34.0124 49.2799 34.3896 48.8386C34.6545 48.4664 34.8964 48.0784 35.1142 47.6767C35.6541 46.8224 36.438 46.3537 37.4121 46.1269C38.6063 45.8473 39.8607 46.0113 40.9435 46.5887C43.5843 47.9246 46.236 47.8653 48.8 46.4721C49.8779 45.8886 50.796 44.9852 51.8339 44.1811C49.2935 41.8756 48.4762 39.073 48.724 35.8709C48.7321 35.4135 48.6838 34.9569 48.5801 34.5115C48.4556 33.8144 47.9893 33.425 47.3285 33.2617C47.0897 33.2022 46.8401 33.1982 46.5981 33.1537C45.8078 32.9971 45.5014 32.4304 45.8734 31.7287C46.8901 29.7991 47.9735 27.9259 49.8707 26.6837C50.2318 26.4528 50.5403 26.1477 50.7759 25.7885C51.0114 25.4292 51.1688 25.0241 51.2375 24.5995C51.4742 23.351 51.8317 22.1215 52.1618 20.8919C52.3982 20.012 52.6732 19.1464 52.9439 18.2473C52.0883 17.992 51.2364 17.7912 50.4176 17.4913C48.2143 16.6752 46.0306 15.8094 43.8326 14.9782C42.7874 14.5843 41.7022 14.2815 40.6869 13.8328C38.9215 13.0457 37.6898 11.5944 36.4238 10.1918C35.887 9.59656 35.273 9.06983 34.7665 8.58209C33.7652 9.61965 32.9772 10.7416 31.9168 11.4609C30.2571 12.5878 28.7721 13.8207 27.6019 15.4618C27.008 16.2924 26.1005 16.6368 25.0653 16.6718C24.1996 16.7016 23.4937 16.3034 22.7614 15.9491C22.0637 15.6113 22.0795 15.6271 21.7115 16.3264C21.3435 17.0257 20.9463 17.727 20.5177 18.3967C20.3427 18.6865 20.0779 18.9105 19.764 19.0344C19.45 19.1582 19.1044 19.1751 18.7801 19.0823C17.7876 18.8694 16.7939 18.6383 15.799 18.389C14.442 18.0468 13.0074 18.2086 11.7591 18.8447C10.8519 19.286 10.659 19.8764 11.3125 20.6174C11.7995 21.1706 12.3573 21.6566 12.9713 22.0626C13.7107 22.5281 14.4823 22.9399 15.2802 23.2949C16.2898 23.744 17.1328 24.5015 17.6895 25.4597C18.0248 26.0498 18.3157 26.6661 18.629 27.2724C23.4786 24.8338 27.9071 26.9763 29.9508 29.657C31.1027 31.1657 31.7438 33.0057 31.7801 34.9075C31.8164 36.8093 31.2461 38.6732 30.1526 40.2264C28.1536 43.0702 23.9809 45.1654 19.0829 43.0845ZM23.4376 42.3861C27.4778 42.1222 30.5404 38.6684 30.2798 34.6712C30.16 32.7164 29.2747 30.8892 27.8175 29.5894C26.3603 28.2897 24.4499 27.6232 22.5043 27.7359C21.536 27.7825 20.5865 28.0224 19.7111 28.4416C18.8358 28.8608 18.0522 29.4508 17.4059 30.1773C16.7596 30.9039 16.2636 31.7523 15.9469 32.6733C15.6301 33.5943 15.4988 34.5693 15.5608 35.5416C15.6227 36.5139 15.8766 37.4639 16.3076 38.3364C16.7387 39.2089 17.3382 39.9863 18.0714 40.6234C18.8045 41.2604 19.6566 41.7444 20.5779 42.047C21.4992 42.3497 22.4713 42.465 23.4376 42.3861ZM5.73574 46.2692L15.5443 39.9311L14.9626 38.9176L5.11278 45.1722L5.73574 46.2692Z"/></mask><path d="M47.6364 31.7323C47.8391 31.8153 48.0153 31.8812 48.1901 31.9556C49.3599 32.4569 50.0394 33.3352 50.1277 34.6162C50.1983 35.6647 50.2292 36.7158 50.2371 37.7685C50.2523 39.8635 51.2789 41.4763 52.6657 42.8981C53.5865 43.842 53.6661 44.3716 52.7286 45.2974C51.1332 46.8812 49.3827 48.2165 47.1329 48.7665C44.8819 49.3216 42.5083 49.0548 40.4357 48.0138C39.4892 47.5604 38.5265 47.3019 37.5309 47.7071C37.071 47.9103 36.6618 48.214 36.3331 48.596C36.0111 48.9977 35.7367 49.4357 35.5154 49.9011C35.0548 50.75 34.2981 51.2484 33.4773 51.6648C33.2122 51.7978 32.9196 51.8661 32.6233 51.8641C32.3271 51.862 32.0355 51.7897 31.7724 51.653C31.4776 51.521 31.2044 51.3451 30.9618 51.1313C29.8211 50.0656 28.445 49.7385 26.9352 49.6965C24.2186 49.5962 21.5474 48.9671 19.0698 47.8441C18.4504 47.5532 17.8641 47.1957 17.3213 46.7778C16.6911 46.3217 16.5988 45.9152 16.8344 45.1807C17.1056 44.3195 17.3992 43.4821 17.6453 42.6226C17.6638 42.5251 17.6598 42.4247 17.6338 42.329C17.6077 42.2333 17.5603 42.1449 17.495 42.0705C16.4777 41.1564 16.4698 41.1632 15.3346 41.8919C12.2675 43.8671 9.1983 45.8419 6.12697 47.816C5.39573 48.2874 5.04746 48.1891 4.61497 47.4308C4.33147 46.9348 4.052 46.4365 3.77656 45.9357C3.18563 44.8787 3.26602 44.5782 4.27115 43.9407C7.48797 41.9067 10.6834 39.8658 13.9015 37.8507C14.3035 37.5956 14.4007 37.3572 14.3108 36.8936C13.6776 33.714 14.5417 30.9795 16.8278 28.6954C16.9816 28.5764 17.0894 28.4073 17.1328 28.2171C17.1763 28.027 17.1526 27.8277 17.0658 27.6532C16.5668 26.2486 15.7792 25.1355 14.3525 24.5233C13.5227 24.1467 12.7175 23.7178 11.9416 23.2391C10.7864 22.5922 9.89092 21.5619 9.40841 20.3243C9.31335 20.0822 9.28169 19.8197 9.31644 19.5617C9.3512 19.3037 9.45121 19.059 9.60692 18.8509C10.6377 17.2552 12.2625 16.7311 13.9773 16.7337C15.3337 16.7378 16.6957 17.1374 18.0435 17.418C19.2594 17.6697 19.3451 17.666 19.9235 16.5752C20.1987 16.055 20.4163 15.4882 20.7251 14.9994C21.2758 14.1191 21.9105 13.926 22.8624 14.3348C23.2938 14.516 23.7286 14.7474 24.1486 14.9462C24.9684 15.324 25.7026 15.2084 26.3461 14.585C26.6077 14.3351 26.842 14.0578 27.045 13.7578C27.8829 12.5231 28.9904 11.4969 30.2827 10.7576C31.7264 9.85971 32.9011 8.58535 33.6818 7.07013C34.0043 6.47507 34.6284 6.37336 35.1547 6.87449C36.1787 7.85765 37.2353 8.82594 38.1708 9.8952C39.6137 11.5828 41.5324 12.7905 43.6733 13.3587C45.1679 13.7661 46.5788 14.4553 48.045 14.97C49.8289 15.5957 51.624 16.1995 53.4326 16.7561C54.4429 17.0682 54.7071 17.4125 54.4318 18.4614C53.8032 20.8525 53.1633 23.2416 52.512 25.6287C52.2313 26.6591 51.5044 27.3829 50.6757 27.9621C49.3363 28.9134 48.2845 30.2182 47.6364 31.7323ZM19.0829 43.0845C18.8621 43.7906 18.688 44.4745 18.4321 45.1261C18.2675 45.546 18.3981 45.7414 18.7452 45.9473C21.1132 47.3103 23.6962 47.8813 26.3813 48.163C27.5256 48.2847 28.6999 48.356 29.785 48.6883C30.5876 48.9346 31.287 49.5481 32.0035 50.0404C32.41 50.3202 32.7838 50.4547 33.176 50.0845C33.6071 49.6961 34.0124 49.2799 34.3896 48.8386C34.6545 48.4664 34.8964 48.0784 35.1142 47.6767C35.6541 46.8224 36.438 46.3537 37.4121 46.1269C38.6063 45.8473 39.8607 46.0113 40.9435 46.5887C43.5843 47.9246 46.236 47.8653 48.8 46.4721C49.8779 45.8886 50.796 44.9852 51.8339 44.1811C49.2935 41.8756 48.4762 39.073 48.724 35.8709C48.7321 35.4135 48.6838 34.9569 48.5801 34.5115C48.4556 33.8144 47.9893 33.425 47.3285 33.2617C47.0897 33.2022 46.8401 33.1982 46.5981 33.1537C45.8078 32.9971 45.5014 32.4304 45.8734 31.7287C46.8901 29.7991 47.9735 27.9259 49.8707 26.6837C50.2318 26.4528 50.5403 26.1477 50.7759 25.7885C51.0114 25.4292 51.1688 25.0241 51.2375 24.5995C51.4742 23.351 51.8317 22.1215 52.1618 20.8919C52.3982 20.012 52.6732 19.1464 52.9439 18.2473C52.0883 17.992 51.2364 17.7912 50.4176 17.4913C48.2143 16.6752 46.0306 15.8094 43.8326 14.9782C42.7874 14.5843 41.7022 14.2815 40.6869 13.8328C38.9215 13.0457 37.6898 11.5944 36.4238 10.1918C35.887 9.59656 35.273 9.06983 34.7665 8.58209C33.7652 9.61965 32.9772 10.7416 31.9168 11.4609C30.2571 12.5878 28.7721 13.8207 27.6019 15.4618C27.008 16.2924 26.1005 16.6368 25.0653 16.6718C24.1996 16.7016 23.4937 16.3034 22.7614 15.9491C22.0637 15.6113 22.0795 15.6271 21.7115 16.3264C21.3435 17.0257 20.9463 17.727 20.5177 18.3967C20.3427 18.6865 20.0779 18.9105 19.764 19.0344C19.45 19.1582 19.1044 19.1751 18.7801 19.0823C17.7876 18.8694 16.7939 18.6383 15.799 18.389C14.442 18.0468 13.0074 18.2086 11.7591 18.8447C10.8519 19.286 10.659 19.8764 11.3125 20.6174C11.7995 21.1706 12.3573 21.6566 12.9713 22.0626C13.7107 22.5281 14.4823 22.9399 15.2802 23.2949C16.2898 23.744 17.1328 24.5015 17.6895 25.4597C18.0248 26.0498 18.3157 26.6661 18.629 27.2724C23.4786 24.8338 27.9071 26.9763 29.9508 29.657C31.1027 31.1657 31.7438 33.0057 31.7801 34.9075C31.8164 36.8093 31.2461 38.6732 30.1526 40.2264C28.1536 43.0702 23.9809 45.1654 19.0829 43.0845ZM23.4376 42.3861C27.4778 42.1222 30.5404 38.6684 30.2798 34.6712C30.16 32.7164 29.2747 30.8892 27.8175 29.5894C26.3603 28.2897 24.4499 27.6232 22.5043 27.7359C21.536 27.7825 20.5865 28.0224 19.7111 28.4416C18.8358 28.8608 18.0522 29.4508 17.4059 30.1773C16.7596 30.9039 16.2636 31.7523 15.9469 32.6733C15.6301 33.5943 15.4988 34.5693 15.5608 35.5416C15.6227 36.5139 15.8766 37.4639 16.3076 38.3364C16.7387 39.2089 17.3382 39.9863 18.0714 40.6234C18.8045 41.2604 19.6566 41.7444 20.5779 42.047C21.4992 42.3497 22.4713 42.465 23.4376 42.3861ZM5.73574 46.2692L15.5443 39.9311L14.9626 38.9176L5.11278 45.1722L5.73574 46.2692Z" fill="#e4794a" stroke="#e4794a" stroke-width="1.47127" mask="url(#path-1-inside-1_677_1834)"/><path d="M55.8056 54.9357L55.8053 54.9356C53.9679 53.7622 53.1178 52.0475 53.3058 49.8972C53.3294 49.6381 53.4447 49.3591 53.6234 49.051C53.749 48.8346 53.8901 48.6287 54.0361 48.4157C54.1014 48.3203 54.1677 48.2235 54.2341 48.1238L54.2342 48.1235C54.8237 47.2354 55.4726 46.374 56.1353 45.5437C56.3434 45.2859 56.6122 45.0845 56.9172 44.9578L56.9172 44.9579L56.923 44.9553C56.9599 44.9393 57 44.9321 57.04 44.9343C57.0801 44.9366 57.1192 44.9482 57.1542 44.9684L57.3381 44.6496L57.1542 44.9684C57.1892 44.9885 57.2192 45.0168 57.2417 45.0509C57.2643 45.0851 57.2786 45.1242 57.2835 45.1651L57.2856 45.1826L57.2894 45.1999C57.6104 46.6687 57.9003 48.1378 58.1967 49.6402C58.2648 49.9854 58.3332 50.3324 58.4025 50.6815C58.3661 51.0327 58.3381 51.3785 58.3105 51.7205C58.2462 52.5158 58.1835 53.291 58.0196 54.0677C58.0039 54.1413 57.9855 54.2112 57.9646 54.2774L57.2274 53.9288C57.2588 53.8551 57.2859 53.7789 57.3096 53.7024C57.3862 53.4552 57.4388 53.1657 57.4739 52.8556C57.5443 52.235 57.5488 51.4924 57.5128 50.7585C57.4768 50.0228 57.3995 49.2844 57.3024 48.6685C57.2079 48.0695 57.0879 47.5396 56.9499 47.2536L56.7354 46.8089L56.3706 47.1425C56.2548 47.2485 56.1361 47.3593 56.0145 47.4728C55.7638 47.7069 55.5007 47.9526 55.2238 48.1917C54.6795 48.6593 54.3018 49.1965 54.1288 49.809C53.9559 50.4209 53.997 51.0746 54.2336 51.7594C54.4146 52.3383 54.7129 52.8734 55.1098 53.331C55.3952 53.66 55.7272 53.9438 56.0944 54.1737L55.7471 54.522L56.7235 54.4551L56.7277 54.4549L57.9319 54.3724C57.7731 54.799 57.5043 55.0583 57.2051 55.1753C56.8363 55.3195 56.3419 55.2789 55.8056 54.9357Z" fill="#e4794a" stroke="#e4794a" stroke-width="0.735634"/><path d="M32.0098 27.4033C31.8698 27.2844 31.5731 27.1425 31.4612 26.9121C31.1579 26.3001 30.8869 25.6725 30.6493 25.0318C30.3973 24.4023 29.9882 24.0238 29.3023 23.9844C29.1123 23.9917 28.9234 23.9526 28.7517 23.8704C28.5172 23.7179 28.2081 23.5158 28.1586 23.2791C28.1439 23.1349 28.1632 22.9893 28.2149 22.854C28.2666 22.7187 28.3493 22.5976 28.4562 22.5003C29.5039 21.7777 29.8084 20.7899 29.7264 19.5716C29.7065 19.276 29.9189 18.7875 30.1499 18.7C30.4334 18.5837 30.8707 18.7286 31.1946 18.8687C31.3888 18.9523 31.5044 19.2372 31.6316 19.4454C32.1339 20.2747 32.7479 20.9278 33.7881 21.0293C34.2101 21.07 34.6257 21.2037 34.763 21.6872C34.9004 22.1708 34.6307 22.4926 34.3129 22.7861C33.2433 23.7735 32.6731 24.9564 32.828 26.4478C32.8683 26.9232 32.6691 27.2634 32.0098 27.4033ZM30.4794 22.663L30.6854 22.453L31.8104 23.5978L32.5667 22.3769L31.0835 21.3304C30.8875 21.782 30.6846 22.2235 30.4795 22.6651L30.4794 22.663Z" fill="white"/><path d="M35.3139 40.5875C35.3348 40.8978 35.3563 41.2165 35.3777 41.5352C35.4082 41.9882 35.3326 42.3915 34.814 42.5028C34.3801 42.5957 34.023 42.3042 33.8949 41.7716C33.8565 41.6057 33.8531 41.4311 33.8311 41.2599C33.8091 41.0886 33.7922 40.9613 33.7682 40.7923C33.2267 40.6882 32.6052 40.6718 32.5854 39.9106C32.5739 39.4901 32.8465 39.305 33.5825 39.1535C33.56 38.818 33.5204 38.4794 33.5144 38.1407C33.5097 37.5722 33.777 37.2148 34.2023 37.1815C34.6277 37.1481 34.9354 37.4536 35.0143 38.0338C35.0584 38.3467 35.0566 38.6628 35.0807 39.0214C35.6566 38.982 36.1913 38.8927 36.3436 39.5669C36.4511 40.0125 36.158 40.2979 35.3139 40.5875Z" fill="white"/><path d="M21.4362 21.894C21.9395 21.8975 22.3991 21.9376 22.4815 22.5071C22.5739 23.1327 22.0685 23.2853 21.6171 23.4615C21.6054 23.6919 21.6696 23.9614 21.5678 24.1305C21.4188 24.3767 21.1636 24.6954 20.9321 24.7133C20.7847 24.6985 20.6431 24.6475 20.5199 24.5649C20.3966 24.4822 20.2955 24.3704 20.2253 24.2393C20.0438 23.8157 19.9873 23.413 19.4798 23.1592C19.0311 22.9392 19.1104 22.3418 19.5218 22.0082C19.6613 21.8997 19.8457 21.7754 19.8794 21.6214C19.9716 21.217 20.1775 20.9438 20.5923 20.9406C21.0443 20.9286 21.2544 21.2471 21.3591 21.6507C21.3761 21.7169 21.4017 21.7868 21.4362 21.894Z" fill="white"/><path d="M25.7339 38.1494L25.5118 38.0538L23.9878 37.3977L23.6345 37.2455L23.8028 36.8992C24.223 36.035 24.0136 35.2562 23.5068 34.3769L25.7339 38.1494ZM25.7339 38.1494L25.9099 37.9831M25.7339 38.1494L25.9099 37.9831M25.9099 37.9831C28.053 35.958 27.6901 32.4635 25.1777 31.0098L25.9099 37.9831ZM24.2421 30.9358L24.2421 30.9358C24.3489 30.8623 24.4644 30.8442 24.5434 30.8403C24.6273 30.8362 24.7094 30.8464 24.7803 30.8608C24.9203 30.8893 25.0655 30.9447 25.1776 31.0097L24.2421 30.9358ZM24.2421 30.9358L24.2401 30.9372M24.2421 30.9358L24.2401 30.9372M24.2401 30.9372C23.7609 31.2718 23.4531 31.907 23.3201 32.5212M24.2401 30.9372L23.3201 32.5212M23.3201 32.5212C23.1867 33.1377 23.2036 33.8514 23.5067 34.3768L23.3201 32.5212ZM23.0591 40.1014L23.0591 40.1013L23.0499 40.1021C22.3684 40.1591 21.6825 40.0799 21.0317 39.8689C20.381 39.6578 19.7782 39.3192 19.2584 38.8724C18.7385 38.4257 18.3119 37.8796 18.0032 37.2658C17.6946 36.6521 17.5101 35.9827 17.4603 35.2966L17.4603 35.2965C17.2504 32.4087 19.5441 29.8094 22.5065 29.6066C25.4646 29.4041 27.8677 31.4988 28.0702 34.4116C28.1146 35.1162 28.0201 35.8228 27.792 36.4907C27.5638 37.1589 27.2066 37.7751 26.7408 38.3039C26.275 38.8327 25.7099 39.2637 25.0781 39.5721C24.4462 39.8806 23.7601 40.0605 23.0591 40.1014ZM23.9612 38.251C23.9505 38.2473 23.9397 38.2436 23.9291 38.2399C23.7969 38.1945 23.6718 38.1514 23.5454 38.1032C23.2053 37.9729 23.0039 37.7713 22.9151 37.5596C22.8289 37.3541 22.8275 37.0893 22.9832 36.7792C23.1516 36.4926 23.2326 36.1628 23.2164 35.8306C23.2 35.4964 23.0859 35.1745 22.8883 34.9051C22.5891 34.4641 22.4159 33.9488 22.3879 33.4153C22.3597 32.8796 22.479 32.3466 22.7324 31.8747L22.7326 31.8747L22.7378 31.8643C22.8467 31.6451 22.9491 31.418 23.0581 31.1762C23.1023 31.0783 23.1475 30.9779 23.1948 30.8747L23.436 30.3474L22.8564 30.3542C21.7919 30.3667 20.7629 30.7392 19.935 31.4108C19.7356 31.5393 19.5844 31.7309 19.5054 31.9551C19.4256 32.1818 19.4243 32.4286 19.5012 32.6557C19.6015 33.0536 19.7317 33.4432 19.8905 33.8213L19.8952 33.8325L19.9006 33.8433C20.5091 35.0609 20.4616 36.3277 20.0864 37.6368C20.0145 37.8854 19.9917 38.1472 20.1124 38.3899C20.23 38.6262 20.4455 38.7653 20.6559 38.8634L20.6565 38.8637C21.7133 39.3545 22.8172 39.5094 23.9887 39.04L24.387 39.1796L24.3495 38.6228L24.3493 38.6186L24.314 38.0951L23.9612 38.251ZM19.11 34.067L18.7841 34.1721L18.7448 33.9013L18.5019 33.9369L18.1413 33.9898L18.1904 34.3509L18.514 36.7302L18.5633 37.0933L18.9267 37.0448L19.1531 37.0145L19.3869 36.9833L19.4563 36.7577C19.594 36.3104 19.6343 35.8386 19.5745 35.3744C19.5148 34.9102 19.3564 34.4643 19.11 34.067Z" fill="#e4794a" stroke="#e4794a" stroke-width="0.735634"/><path d="M25.6571 37.7115L24.1331 37.0554C24.6319 36.027 24.3565 35.1105 23.8249 34.1884C23.3498 33.3573 23.7072 31.7529 24.4499 31.2344C24.56 31.1574 24.8398 31.2351 24.9925 31.3237C27.2847 32.6497 27.6341 35.8488 25.6571 37.7115Z" fill="#F2F7FF"/><path d="M18.7969 34.2611C19.0149 34.6133 19.1551 35.0084 19.2081 35.4198C19.2611 35.8312 19.2256 36.2492 19.104 36.6457L18.8776 36.676L18.554 34.2967L18.7969 34.2611Z" fill="#F2F7FF"/></svg>\n',UM={key:0,class:"bg-alt-green-tilleul-verveine fr-p-3v fr-mt-4w fr-mx-4w fr-mb-3v"},qM={class:"fr-grid-row fr-m-0"},YM={class:"bg-blue-100 text-blue-400 fr-hidden fr-unhidden-md fr-p-2w"},KM={class:"fr-grid-row fr-grid-row--middle fr-grid-row--gutters"},GM=["innerHTML"],XM={class:"fr-col"},JM={class:"fr-text--bold fr-m-0"},ZM={class:"fr-text--sm fr-m-0 f-italic"},QM={class:"fr-col-auto fr-my-0"},eT=["href"],tT={class:"fr-table fr-table--no-background fr-p-0 fr-pt-0-5v fr-m-0"},nT={class:"fr-mb-3w"},rT={class:"fr-sr-only"},iT={scope:"col"},sT={class:"fr-grid-row fr-grid-row--middle col-width"},oT=["onClick"],aT={class:"fr-sr-only"},lT={class:"cell-padding"},cT={class:"fr-grid-row fr-grid-row--middle fr-text--xs w-100 style-cell"},uT={class:"fr-my-auto"},dT={class:"fr-px-5v"},fT=W({__name:"Preview",props:{resource:{}},setup(n){const e=n,{t}=De(),r=E([]),i=E([]),s=E(!0),o=E(!1),a=E(null),l=E(0),c=Ct.tabular_page_size,u=E(1);function d(g){var w;return g===((w=a.value)==null?void 0:w.column)}async function f(g,w){try{const{data:x}=await PM(e.resource.id,g,w);"data"in x&&x.data&&x.data.length>0?(r.value=x.data,i.value=Object.keys(x.data[0]).filter(M=>M!=="__id"),l.value=x.meta.total,u.value=g,s.value=!1):(o.value=!0,s.value=!1)}catch(x){o.value=!0,s.value=!1}}function h(g){f(g,a.value)}function p(g){a.value&&a.value.column==g?a.value.type=="asc"?a.value.type="desc":a.value.type="asc":a.value?(a.value.column=g,a.value.type="asc"):a.value={column:g,type:"asc"},u.value=1,f(u.value,a.value)}const m=Ei(e.resource.extras["analysis:parsing:finished_at"]);return Ke(()=>{f(u.value)}),(g,w)=>(_(),S("div",null,[o.value?(_(),S("div",UM,[y("p",qM,[w[0]||(w[0]=y("span",{class:"fr-icon-warning-line","aria-hidden":"true"},null,-1)),Y(" "+T(v(t)("The preview of this file failed to load.")),1)])])):s.value?(_(),G(rw,{key:1})):(_(),S(X,{key:2},[y("div",YM,[y("div",KM,[y("div",{class:"fr-col-auto",innerHTML:v(jM)},null,8,GM),y("div",XM,[y("p",JM,T(v(t)("Explore data in detail")),1),y("p",ZM,T(v(t)("Use our tool to get an overview of data, learn about different columns or perform filters and sorts.")),1)]),y("p",QM,[y("a",{href:g.resource.preview_url,class:"fr-btn",target:"_blank"},T(v(t)("Explore data")),9,eT)])])]),y("div",tT,[y("table",nT,[y("caption",rT,T(v(t)("Preview of {name}",{name:g.resource.title})),1),y("thead",null,[y("tr",null,[(_(!0),S(X,null,Ye(i.value,x=>(_(),S("th",iT,[y("div",sT,[y("button",{class:me(["fr-btn fr-btn--sm fr-btn--tertiary-no-outline fr-my-n1w",{"fr-btn--secondary-grey-500":!d(x),"fr-btn--icon-right":d(x),"fr-icon-arrow-down-line":d(x)&&a.value&&a.value.type=="desc","fr-icon-arrow-up-line":d(x)&&a.value&&a.value.type=="asc"}]),onClick:M=>p(x)},[Y(T(x)+" ",1),y("span",aT,T(a.value&&a.value.type=="desc"?v(t)("Sort ascending"):v(t)("Sort descending")),1)],10,oT)])]))),256))])]),y("tbody",null,[(_(!0),S(X,null,Ye(r.value,x=>(_(),S("tr",null,[(_(!0),S(X,null,Ye(i.value,M=>(_(),S("td",lT,[y("div",cT,[y("div",uT,T(x[M]),1)])]))),256))]))),256))])])]),P(v(js),{class:"fr-mt-3w",page:u.value,pageSize:v(c),totalResults:l.value,onChange:h},null,8,["page","pageSize","totalResults"]),y("div",dT,T(v(t)("Preview updated on {date}",{date:v(m)}))+" — "+T(v(t)("{count} columns",i.value.length))+" — "+T(v(t)("{count} rows",l.value)),1)],64))]))}}),hT=Ne(fT,[["__scopeId","data-v-90a6d6fe"]]),pT=["href"],mT=W({__name:"EditButton",props:{datasetId:{},isCommunityResource:{type:Boolean,default:!1},resource:{}},setup(n){const e=n,{t}=De(),r=A(()=>Ct.new_admin?"owner"in e.resource&&e.resource.owner?"".concat(Ct.admin_root,"users/").concat(e.resource.owner.id,"/community-resources/?resource_id=").concat(e.resource.id):"organization"in e.resource&&e.resource.organization?"".concat(Ct.admin_root,"organization/").concat(e.resource.organization.id,"/community-resources/?resource_id=").concat(e.resource.id):"".concat(Ct.admin_root,"datasets/").concat(e.datasetId,"/files/?resource_id=").concat(e.resource.id):"".concat(Ct.admin_root,"dataset/").concat(e.datasetId,"/").concat(e.isCommunityResource?"community-resource":"resource","/").concat(e.resource.id));return(i,s)=>(_(),S("a",{href:r.value,class:"fr-btn fr-btn--secondary fr-btn--secondary-warning-425 fr-icon-pencil-line fr-icon--sm","data-testid":"edit-button"},T(v(t)("Edit file")),9,pT))}}),gT="/_themes/gouvfr/assets/file.svg",vT="/_themes/gouvfr/assets/code.svg",yT="/_themes/gouvfr/assets/archive.svg",bT="/_themes/gouvfr/assets/documentation.svg",wT="/_themes/gouvfr/assets/link2.svg",_T="/_themes/gouvfr/assets/table.svg",kT="/_themes/gouvfr/assets/map.svg",xT="/_themes/gouvfr/assets/globe.svg";function iw(n){var e,t;switch((t=(e=n.format)==null?void 0:e.trim())==null?void 0:t.toLowerCase()){case"txt":case"pdf":case"rtf":case"odt":case"doc":case"docx":case"epub":return bT;case"json":case"sql":case"xml":case"xsd":case"shp":case"kml":case"kmz":case"gpx":case"shx":case"ovr":case"gpkg":case"grib2":case"dbf":case"prj":case"sqlite":case"db":case"sbn":case"sbx":case"cpg":case"lyr":case"owl":case"dxf":case"ics":case"rdf":case"ttl":case"n3":return vT;case"tar":case"gz":case"tgz":case"rar":case"zip":case"7z":case"xz":case"bz2":return yT;case"url":return wT;case"csv":case"ods":case"xls":case"xlsx":case"parquet":case"csv.gz":return _T;case"geojson":return kT;case"ogc:wfs":case"ogc:wms":case"wfs":case"wms":return xT;default:return null}}function sw(n){return"resource-"+n.id+"-title"}const CT={class:"fr-icon-svg flex items-center"},ST=["src"],MT=W({__name:"ResourceIcon",props:{resource:{}},setup(n){const e=n,t=A(()=>iw(e.resource)||gT);return(r,i)=>(_(),S("div",CT,[y("img",{src:t.value,alt:""},null,8,ST)]))}}),TT={key:0,class:"inline-flex fr-mb-0 align-items-baseline fr-text--xs"},OT={class:"flex justify-between border-bottom"},$T={class:"fr-text--sm fr-my-0 fr-p-2v"},DT=["onClick","title"],ET={class:"fr-p-3v"},AT={key:0},PT={key:1},NT={key:2},RT={key:3,class:"text-default-warning flex items-center fr-mt-4v"},LT={key:4,class:"text-default-warning flex items-center fr-mt-4v"},IT={key:5,class:"text-default-warning flex items-center fr-mt-4v"},zT={key:6,class:"w-100 text-align-right fr-mt-5v",target:"_blank"},BT=["href"],FT={class:"fr-mr-1v text-grey-380"},VT={class:"flex items-center bg-error-950 rounded-sm"},HT={class:"fr-tag fr-tag--sm"},WT={key:0,class:"flex items-center padding-sm"},jT={key:1,class:"flex items-center text-warning-425 padding-sm"},UT=W({__name:"SchemaBadge",props:{resource:{}},setup(n){const e=n,{t}=De(),r=E(null);Ke(async()=>{r.value=await mb()});const i=A(()=>r.value?t3(r.value,e.resource.schema):null),s=A(()=>i.value?r3(e.resource,i.value):null),o=A(()=>i.value?n3(i.value.name):null),a=A(()=>e.resource.schema?e.resource.schema.name||e.resource.schema.url:null),l=A(()=>e.resource.extras["validation-report:errors"]||[]),c=A(()=>l.value.filter(h=>[""].includes(h.code))),u=A(()=>l.value.filter(h=>["#body","#cell","#content","#row","#table"].some(p=>h.tags.includes(p)))),d=A(()=>l.value.filter(h=>["#head","#structure","#header"].some(p=>h.tags.includes(p)))),f=A(()=>l.value.length===0?"ok":l.value.length===c.value.length?"warnings":"ko");return(h,p)=>a.value?(_(),S("span",TT,[P(Zp,{position:"right",noMargin:"",class:"relative z-2"},{toggletip:K(({close:m})=>[y("div",OT,[y("h5",$T,T(h.$t("Data schema")),1),y("button",{type:"button",onClick:m,title:v(t)("Close"),class:"border-left close-button flex items-center justify-center"},"×",8,DT)]),y("div",ET,[f.value==="ok"?(_(),S("div",AT,[Y(T(v(t)("This file is valid for the shema:"))+" ",1),(_(),G(ys(o.value?"a":"span"),{href:o.value,class:"fr-link fr-text--sm"},{default:K(()=>[Y(T(a.value),1)]),_:1},8,["href"])),p[0]||(p[0]=Y(". "))])):V("",!0),f.value==="warnings"?(_(),S("div",PT,[Y(T(v(t)("This file is valid for the shema:"))+" ",1),(_(),G(ys(o.value?"a":"span"),{href:o.value,class:"fr-link fr-text--sm"},{default:K(()=>[Y(T(a.value),1)]),_:1},8,["href"])),Y(". "+T(v(t)("But its compliance could be improved.")),1)])):V("",!0),f.value==="ko"?(_(),S("div",NT,[Y(T(v(t)("This file indicates to follow the schema:"))+" ",1),(_(),G(ys(o.value?"a":"span"),{href:o.value,class:"fr-link fr-text--sm"},{default:K(()=>[Y(T(a.value),1)]),_:1},8,["href"])),Y(". "+T(v(t)("But is not compliant.")),1)])):V("",!0),c.value.length?(_(),S("div",RT,[p[1]||(p[1]=y("span",{class:"fr-icon-alert-line fr-icon--sm fr-mr-1v"},null,-1)),y("span",null,T(c.value.length)+" "+T(v(t)("advices")),1)])):V("",!0),d.value.length?(_(),S("div",LT,[p[2]||(p[2]=y("span",{class:"fr-icon-alert-line fr-icon--sm fr-mr-1v"},null,-1)),y("span",null,T(d.value.length)+" "+T(v(t)("structure errors")),1)])):V("",!0),u.value.length?(_(),S("div",IT,[p[3]||(p[3]=y("span",{class:"fr-icon-alert-line fr-icon--sm fr-mr-1v"},null,-1)),y("span",null,T(u.value.length)+" "+T(v(t)("body errors")),1)])):V("",!0),s.value?(_(),S("div",zT,[y("a",{href:s.value},T(v(t)("See validation report")),9,BT)])):V("",!0)])]),_:1}),y("span",FT,T(v(t)("Schema:")),1),y("span",VT,[y("span",HT,T(a.value),1),f.value==="warnings"?(_(),S("span",WT,[p[4]||(p[4]=y("span",{class:"fr-icon-alert-line fr-icon--sm fr-mr-1v"},null,-1)),y("span",null,T(v(t)("Invalid")),1)])):V("",!0),f.value==="ko"?(_(),S("span",jT,[p[5]||(p[5]=y("span",{class:"fr-icon-error-line fr-icon--sm fr-mr-1v"},null,-1)),y("span",null,T(v(t)("Invalid")),1)])):V("",!0)])])):V("",!0)}}),qT=Ne(UT,[["__scopeId","data-v-bf96ce2f"]]),YT={class:"fr-text--sm fr-ml-0 fr-mt-0 fr-mb-2w text-mention-grey h-4w fr-grid-row fr-grid-row--middle"},KT={key:0,class:"text-overflow-ellipsis"},Sr=W({__name:"DescriptionDetails",props:{withEllipsis:{type:Boolean,default:!0}},setup(n){return(e,t)=>(_(),S("dd",YT,[e.withEllipsis?(_(),S("div",KT,[et(e.$slots,"default")])):et(e.$slots,"default",{key:1})]))}}),GT={},XT={class:"fr-my-0"};function JT(n,e){return _(),S("dl",XT,[et(n.$slots,"default")])}const mf=Ne(GT,[["render",JT]]),ZT={},QT={class:"fr-text--sm fr-my-0 fr-text--bold"};function eO(n,e){return _(),S("dt",QT,[et(n.$slots,"default")])}const Mr=Ne(ZT,[["render",eO]]),tO={class:"flex gap-3rem flex-col-on-small"},nO={class:"code"},rO=["href"],iO={class:"code"},sO=["href"],oO={class:"code"},aO={class:"code"},lO={class:"code text-overflow-ellipsis"},cO=W({__name:"Metadata",props:{resource:{}},setup(n){const e=n,t=A(()=>Object.keys(e.resource.extras).length),r=A(()=>sw(e.resource)),{t:i}=De();return(s,o)=>(_(),S("div",null,[y("div",tO,[P(mf,{class:"flex-1"},{default:K(()=>[P(Mr,null,{default:K(()=>[Y(T(v(i)("URL"))+" ",1),P(hs,{label:s.$t("Copy URL"),"copied-label":s.$t("URL copied!"),text:s.resource.url,"aria-describedby":r.value},null,8,["label","copied-label","text","aria-describedby"])]),_:1}),P(Sr,{"with-ellipsis":!1},{default:K(()=>[y("code",nO,[y("a",{href:s.resource.url},[P(v(sn),{"max-lines":1,autoresize:!0,text:s.resource.url},null,8,["text"])],8,rO)])]),_:1}),P(Mr,null,{default:K(()=>[Y(T(v(i)("Stable URL"))+" ",1),P(hs,{label:s.$t("Copy stable URL"),"copied-label":s.$t("Stable URL copied!"),text:s.resource.latest,"aria-describedby":r.value},null,8,["label","copied-label","text","aria-describedby"])]),_:1}),P(Sr,{"with-ellipsis":!1},{default:K(()=>[y("code",iO,[y("a",{href:s.resource.latest},[P(v(sn),{"max-lines":1,autoresize:!0,text:s.resource.latest},null,8,["text"])],8,sO)])]),_:1}),P(Mr,null,{default:K(()=>[Y(T(v(i)("Identifier"))+" ",1),P(hs,{label:s.$t("Copy ID"),"copied-label":s.$t("ID copied!"),text:s.resource.id,"aria-describedby":r.value},null,8,["label","copied-label","text","aria-describedby"])]),_:1}),P(Sr,{"with-ellipsis":!1},{default:K(()=>[y("code",oO,[P(v(sn),{"max-lines":1,autoresize:!0,text:s.resource.id},null,8,["text"])])]),_:1}),s.resource.checksum?(_(),S(X,{key:0},[P(Mr,null,{default:K(()=>[Y(T(s.resource.checksum.type)+" ",1),P(hs,{label:s.$t("Copy checksum"),"copied-label":s.$t("Checksum copied!"),text:s.resource.checksum.value,"aria-describedby":r.value},null,8,["label","copied-label","text","aria-describedby"])]),_:1}),P(Sr,{"with-ellipsis":!1},{default:K(()=>[y("code",aO,[P(v(sn),{"max-lines":1,autoresize:!0,text:s.resource.checksum.value},null,8,["text"])])]),_:1})],64)):V("",!0)]),_:1}),P(mf,{style:{"flex-shrink":"0"}},{default:K(()=>[P(Mr,null,{default:K(()=>[Y(T(v(i)("Created on")),1)]),_:1}),P(Sr,null,{default:K(()=>[Y(T(v(Ei)(s.resource.created_at)),1)]),_:1}),P(Mr,null,{default:K(()=>[Y(T(v(i)("Modified on")),1)]),_:1}),P(Sr,null,{default:K(()=>[Y(T(v(Ei)(s.resource.last_modified)),1)]),_:1})]),_:1}),P(mf,{style:{"flex-shrink":"0"}},{default:K(()=>[s.resource.filesize?(_(),S(X,{key:0},[P(Mr,null,{default:K(()=>[Y(T(v(i)("Size")),1)]),_:1}),P(Sr,null,{default:K(()=>[Y(T(v(Dc)(s.resource.filesize)),1)]),_:1})],64)):V("",!0),s.resource.mime?(_(),S(X,{key:1},[P(Mr,null,{default:K(()=>[Y(T(v(i)("Type")),1)]),_:1}),P(Sr,null,{default:K(()=>[Y(T(v(TC)(s.resource.type)),1)]),_:1})],64)):V("",!0),s.resource.mime?(_(),S(X,{key:2},[P(Mr,null,{default:K(()=>[Y(T(v(i)("MIME Type")),1)]),_:1}),P(Sr,null,{default:K(()=>[y("code",lO,T(s.resource.mime),1)]),_:1})],64)):V("",!0)]),_:1})]),y("div",null,[t.value?(_(),G(cM,{key:0,class:"fr-pt-3w fr-mt-3w border-top border-default-grey","button-text":v(i)("See extras"),"title-text":v(i)("Resource Extras"),"title-level":"h5",extra:s.resource.extras},null,8,["button-text","title-text","extra"])):V("",!0)])]))}}),uO=Ne(cO,[["__scopeId","data-v-f2a0bf07"]]),dO=W({__name:"TabGroup",props:{size:{default:"md"}},setup(n){return(e,t)=>(_(),G(v(n4),{as:"div",class:me({"tabs-sm":e.size==="sm"})},{default:K(()=>[et(e.$slots,"default")]),_:3},8,["class"]))}}),fO=W({__name:"TabList",setup(n){return(e,t)=>(_(),G(v(r4),{class:"fr-segmented__elements"},{default:K(()=>[et(e.$slots,"default",{},void 0,!0)]),_:3}))}}),hO=Ne(fO,[["__scopeId","data-v-999cc2d0"]]),pO={class:"inner"},mO=W({__name:"Tab",setup(n){return(e,t)=>(_(),G(v(i4),{as:"template"},{default:K(({selected:r})=>[y("button",{class:me(["fr-segmented__element",{selected:r}])},[y("div",pO,[et(e.$slots,"default",{},void 0,!0)])],2)]),_:3}))}}),gO=Ne(mO,[["__scopeId","data-v-80aca752"]]),vO=W({__name:"TabPanels",setup(n){return(e,t)=>(_(),G(v(s4),null,{default:K(()=>[et(e.$slots,"default")]),_:3}))}}),yO=W({__name:"TabPanel",setup(n){return(e,t)=>(_(),G(v(o4),null,{default:K(()=>[et(e.$slots,"default")]),_:3}))}});function ea(n){var e;(e=globalThis._paq)==null||e.push(["trackEvent",...n])}const bO={class:"flex items-center fr-mb-1v"},wO=["id"],_O=["aria-expanded"],kO={class:"text-grey-380 subheaders-infos"},xO={class:"fr-text--xs fr-mb-0 dash-after"},CO={key:0,class:"fr-text--xs fr-mb-0 dash-after"},SO={class:"hidden show-on-small"},MO={key:0},TO=["aria-label"],OO={class:"hidden show-on-small"},$O={key:0,class:"fr-mb-0 fr-mt-1v fr-text--xs text-grey-380"},DO=["href"],EO={class:"flex items-center fr-ml-4v buttons"},AO={key:0,class:"fr-col-auto fr-ml-3v fr-m-0 z-2"},PO=["href","title","aria-describedby"],NO={key:1,class:"fr-col-auto fr-ml-3v fr-m-0 z-2"},RO=["id","data-clipboard-text","aria-describedby"],LO={key:2,class:"fr-col-auto fr-ml-3v fr-m-0"},IO=["href","title","aria-describedby"],zO={class:"fr-sr-only"},BO={key:3,class:"fr-col-auto fr-ml-3v fr-m-0 z-2"},FO=["aria-labelledby"],VO={class:"fr-pl-4v fr-pr-4v fr-pb-4v"},HO={key:0},WO={key:1,class:"fr-pl-4v fr-pr-4v"},jO=["innerHTML"],UO={key:2,class:"fr-pl-4v fr-pr-4v"},qO={key:3,class:"fr-pl-4v fr-pr-4v"},YO={key:4,class:"fr-pl-4v fr-pr-4v"},KO={class:"fr-pl-0"},GO={key:0,class:"font-bold fr-text--sm fr-mb-0"},XO={key:1,class:"font-bold fr-text--sm fr-mb-0"},JO={class:"fr-text--sm fr-ml-0 fr-mt-0 fr-mb-2w text-mention-grey h-4w fr-grid-row fr-grid-row--middle"},ZO={key:0},QO=["href"],e$={key:1},t$=["href"],n$={key:0},r$={class:"font-bold fr-text--sm fr-mb-0"},i$={class:"fr-text--sm fr-ml-0 fr-mt-0 fr-mb-2w text-mention-grey h-4w fr-grid-row fr-grid-row--middle"},s$=["href"],o$={key:0},a$={key:5,class:"fr-pl-4v fr-pr-4v"},l$=W({__name:"ResourceAccordion",props:{datasetId:{},expandedOnMount:{type:Boolean,default:!1},isCommunityResource:{type:Boolean,default:!1},resource:{},canEdit:{type:Boolean,default:!1}},setup(n){Fp(p3,f3);const e=["ogc:wfs","ogc:wms","wfs","wms"],t=n,r=lb(()=>ls(()=>import("./Swagger.6.2.3.js"),["js/Swagger.6.2.3.js","js/_commonjsHelpers.6.2.3.js","js/sentry.6.2.3.js"])),{t:i}=De(),s=A(()=>Ct.tabular_api_url&&t.resource.extras["analysis:parsing:finished_at"]&&!t.resource.extras["analysis:parsing:error"]&&(Ct.tabular_allow_remote||t.resource.filetype==="file")),o=A(()=>iw(t.resource)?t.resource.format:i("File")),a=A(()=>e.includes(t.resource.format)),l=E(t.expandedOnMount),c=()=>{l.value=!l.value,l.value?ea(["Open resource",t.resource.id]):ea(["Close resource",t.resource.id])},u=A(()=>{let k=[];return s.value&&k.push({key:"data",label:i("Data")}),t.resource.description&&k.push({key:"description",label:i("Description")}),s.value&&k.push({key:"data-structure",label:i("Data structure")}),k.push({key:"metadata",label:i("Metadata")}),k.push({key:"downloads",label:i("Downloads")}),s.value&&k.push({key:"swagger",label:i("Swagger")}),k}),d=k=>{const $=u.value[k];ea(["View resource tab",t.resource.id,$.label]),$.key==="data"&&ea(["Show preview",t.resource.id]),$.key==="data-structure"&&ea(["Show data structure",t.resource.id])},f=A(()=>t.isCommunityResource?t.resource:null),h=kd(f.value),p=t.resource.last_modified,g=t.resource.extras&&"check:available"in t.resource.extras&&t.resource.extras["check:available"]===!1,w=g?i("The {certifier} robot failed to access this file - Download file as {format}",{certifier:Ct.title,format:o.value}):i("Download file as {format}",{format:o.value}),x=A(()=>"".concat(window.location.origin).concat(window.location.pathname,"#/").concat(t.isCommunityResource?"community-resources":"resources","/").concat(t.resource.id)),M="resource-"+t.resource.id,b="resource-"+t.resource.id+"-header",C=sw(t.resource);return(k,$)=>(_(),S("div",{class:me(["border border-default-grey",{"fr-pb-4v":l.value}])},[y("header",{class:"fr-p-4v flex items-center justify-between relative",id:b},[y("div",null,[y("div",bO,[y("h4",{class:"fr-m-0",id:v(C)},[y("button",{type:"button",onClick:c,class:"fr-p-0 flex items-center","data-testid":"expand-button","aria-expanded":l.value},[P(MT,{resource:k.resource,class:"fr-icon--xs fr-mr-1v"},null,8,["resource"]),y("span",{class:me({"font-bold":l.value})},[P(v(sn),{"max-lines":1,text:k.resource.title||v(i)("Nameless file")},null,8,["text"])],2),$[0]||($[0]=y("span",{class:"absolute inset-0 z-1"},null,-1))],8,_O)],8,wO),P(hs,{label:k.$t("Copy link"),"copied-label":k.$t("Link copied!"),text:x.value,class:"z-2"},null,8,["label","copied-label","text"])]),y("div",kO,[P(qT,{resource:k.resource,class:"dash-after"},null,8,["resource"]),y("span",xO,T(v(i)("Updated {date}",{date:v(pd)(v(p))})),1),k.resource.format?(_(),S("span",CO,[y("span",SO,T(v(i)("Format")),1),Y(" "+T(k.resource.format.trim().toLowerCase())+" ",1),k.resource.filesize?(_(),S("span",MO,"("+T(v(Dc)(k.resource.filesize))+")",1)):V("",!0)])):V("",!0),y("span",{class:"inline-flex items-center fr-text--xs fr-mb-0","aria-label":v(i)("{n} downloads",k.resource.metrics.views)},[$[1]||($[1]=y("span",{class:"fr-icon-download-line fr-icon--xs fr-mr-1v"},null,-1)),y("span",null,[Y(T(v(go)(k.resource.metrics.views))+" ",1),y("span",OO,T(v(i)("downloads")),1)])],8,TO)]),f.value?(_(),S("p",$O,[Y(T(v(i)("From"))+" ",1),f.value.organization?(_(),S("a",{key:0,class:"fr-link fr-text--xs",href:f.value.organization.page},[P($s,{organization:f.value.organization},null,8,["organization"])],8,DO)):v(h)?(_(),S(X,{key:1},[Y(T(v(h)),1)],64)):V("",!0)])):V("",!0)]),y("div",EO,[k.resource.format==="url"?(_(),S("p",AO,[y("a",{href:k.resource.latest,title:v(i)("File link - opens a new window"),"aria-describedby":v(C),rel:"ugc nofollow noopener",target:"_blank",class:"fr-btn fr-btn--sm"},T(k.$t("Visit")),9,PO)])):a.value?(_(),S("p",NO,[y("button",{id:k.resource.id+"-copy","data-clipboard-text":k.resource.url,"aria-describedby":v(C),class:"fr-btn fr-btn--sm"},[y("span",null,[P(v(mo),{height:16,width:16,name:"ri-file-copy-line",class:"copy-icon fr-mr-2v"})]),Y(" "+T(v(i)("Copy link")),1)],8,RO)])):(_(),S("p",LO,[y("a",{href:k.resource.latest,rel:"ugc nofollow noopener",title:v(w),download:"",class:"relative text-transform-uppercase fr-btn fr-btn--sm matomo_download z-2","aria-describedby":v(C)},[v(g)?(_(),G(v(mo),{key:0,height:16,width:16,name:"ri-file-warning-line",class:"fr-mr-2v"})):(_(),G(v(mo),{key:1,height:16,width:16,name:"ri-download-line",class:"fr-mr-2v"})),y("span",zO,T(v(i)("Download file as ")),1),Y(T(o.value),1)],8,IO)])),k.canEdit?(_(),S("p",BO,[P(mT,{"dataset-id":k.datasetId,resource:k.resource,"is-community-resource":k.isCommunityResource},null,8,["dataset-id","resource","is-community-resource"])])):V("",!0),y("div",{class:me(["fr-icon--sm fr-ml-4v",{"fr-icon-arrow-up-s-line":l.value,"fr-icon-arrow-down-s-line":!l.value}])},null,2)])]),l.value?(_(),S("section",{key:0,"aria-labelledby":v(C),id:M},[P(dO,{size:"sm",onChange:d},{default:K(()=>[y("div",VO,[P(hO,{style:{"max-width":"100%","overflow-y":"auto"}},{default:K(()=>[(_(!0),S(X,null,Ye(u.value,O=>(_(),G(gO,{key:O.key},{default:K(()=>[Y(T(O.label),1)]),_:2},1024))),128))]),_:1})]),P(vO,null,{default:K(()=>[(_(!0),S(X,null,Ye(u.value,O=>(_(),G(yO,{key:O.key},{default:K(()=>[O.key==="data"?(_(),S("div",HO,[P(hT,{resource:k.resource},null,8,["resource"])])):V("",!0),O.key==="description"?(_(),S("div",WO,[y("div",{class:"fr-mt-0 markdown fr-text--sm text-mention-grey",innerHTML:v(OC)(k.resource.description||"")},null,8,jO)])):V("",!0),O.key==="data-structure"?(_(),S("div",UO,[s.value?(_(),G(WM,{key:0,resource:k.resource},null,8,["resource"])):V("",!0)])):V("",!0),O.key==="metadata"?(_(),S("div",qO,[P(uO,{resource:k.resource},null,8,["resource"])])):V("",!0),O.key==="downloads"?(_(),S("div",YO,[y("dl",KO,[k.resource.format==="url"?(_(),S("dt",GO,T(k.$t("Original URL")),1)):(_(),S("dt",XO,T(k.$t("Original format")),1)),y("dd",JO,[k.resource.format==="url"?(_(),S("span",ZO,[y("a",{href:k.resource.latest,class:"fr-link no-icon-after",rel:"ugc nofollow noopener",target:"_blank"},[P(v(sn),{"auto-resize":!0,"max-lines":1,text:k.resource.url},{after:K(()=>$[2]||($[2]=[y("span",{class:"fr-ml-1v fr-icon-external-link-line fr-icon--sm"},null,-1)])),_:1},8,["text"])],8,QO)])):(_(),S("span",e$,[$[3]||($[3]=y("span",{class:"text-blue-400 fr-icon-download-line fr-icon--sm fr-mr-1v fr-mt-1v"},null,-1)),y("a",{href:k.resource.latest,class:"fr-link",rel:"ugc nofollow noopener"},[y("span",null,[Y(T(k.$t("Format {format}",{format:k.resource.format})),1),k.resource.filesize?(_(),S("span",n$," - "+T(v(Dc)(k.resource.filesize)),1)):V("",!0)])],8,t$)])),P(hs,{label:k.$t("Copy link"),"copied-label":k.$t("Link copied!"),text:k.resource.latest,class:"relative"},null,8,["label","copied-label","text"])]),k.resource.extras["analysis:parsing:parquet_url"]?(_(),S(X,{key:2},[y("dt",r$,T(k.$t("Auto-generated formats from {platform}",{platform:v(Ct).title})),1),y("dd",i$,[y("span",null,[$[4]||($[4]=y("span",{class:"text-blue-400 fr-icon-download-line fr-icon--sm fr-mr-1v fr-mt-1v"},null,-1)),y("a",{href:k.resource.extras["analysis:parsing:parquet_url"],class:"fr-link",rel:"ugc nofollow noopener"},[y("span",null,[Y(T(k.$t("Format {format}",{format:"parquet"})),1),k.resource.extras["analysis:parsing:parquet_size"]?(_(),S("span",o$," - "+T(v(Dc)(k.resource.extras["analysis:parsing:parquet_size"])),1)):V("",!0)])],8,s$)]),P(hs,{label:k.$t("Copy link"),"copied-label":k.$t("Link copied!"),text:k.resource.extras["analysis:parsing:parquet_url"],class:"relative"},null,8,["label","copied-label","text"])])],64)):V("",!0)])])):V("",!0),O.key==="swagger"?(_(),S("div",a$,[y("div",null,T(v(i)("Swagger automatically generated by data.gouv.fr. This swagger allows you to query data by API by filtering it by column value.")),1),s.value?(_(),G(v(r),{key:0,url:"".concat(v(Ct).tabular_api_url,"/api/resources/").concat(t.resource.id,"/swagger/")},null,8,["url"])):V("",!0)])):V("",!0)]),_:2},1024))),128))]),_:1})]),_:1})],8,FO)):V("",!0)],2))}}),ow=Ne(l$,[["__scopeId","data-v-1eb41db2"]]),c$=88,aw=W({__name:"Loader",setup(n){return(e,t)=>(_(),G(v($l),{width:1200,height:c$,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},{default:K(()=>t[0]||(t[0]=[y("rect",{x:"20",y:"24",rx:"4",ry:"4",width:"16",height:"16"},null,-1),y("rect",{x:"52",y:"20",rx:"4",ry:"4",width:"536",height:"22"},null,-1),y("rect",{x:"52",y:"52",rx:"4",ry:"4",width:"374",height:"16"},null,-1),y("rect",{x:"1052",y:"30",rx:"4",ry:"4",width:"80",height:"20"},null,-1),y("rect",{x:"1154",y:"20",rx:"20",ry:"20",width:"40",height:"40"},null,-1)])),_:1}))}});function u$(n){return{label:Rb(async()=>{const t=pt(n),r=await QC();return e3(r,t)},"")}}const d$={class:"fr-card fr-card--no-icon fr-enlarge-link"},f$={class:"fr-card__body"},h$={class:"fr-card__content fr-px-2w fr-py-1v"},p$={class:"fr-card__title fr-text--md fr-mt-1v fr-mb-0"},m$={class:"fr-card__desc fr-mt-0 text-mention-grey"},g$={class:"fr-text--sm fr-mb-0 flex"},v$={key:0,class:"not-enlarged"},y$={class:"dash-before-sm text-overflow-ellipsis"},b$={class:"fr-grid-row fr-grid-row--middle"},w$={class:"fr-text--sm fr-my-0 dash-after-sm"},_$=["aria-label"],k$=["aria-label"],x$={class:"fr-card__header"},C$={class:"fr-card__img"},S$={key:0,class:"fr-badges-group"},M$={key:0},T$={class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380"},O$={key:1},$$={class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380"},D$=W({__name:"ReuseCard",props:{reuse:{},reuseUrl:{},organizationUrl:{}},setup(n){const e=n,{t}=De(),r=kd(e.reuse),{label:i}=u$(()=>e.reuse.type);return(s,o)=>(_(),S("article",d$,[y("div",f$,[y("div",h$,[y("h3",p$,[P(Co,{class:"text-grey-500",to:s.reuseUrl},{default:K(()=>[P(v(sn),{"auto-resize":!0,text:s.reuse.title,"max-lines":1},null,8,["text"])]),_:1},8,["to"])]),y("div",m$,[y("p",g$,[s.reuse.organization?(_(),S("span",v$,[s.organizationUrl?(_(),G(Co,{key:0,class:"fr-link",to:s.organizationUrl},{default:K(()=>[P(v($s),{organization:s.reuse.organization},null,8,["organization"])]),_:1},8,["to"])):(_(),G(v($s),{key:1,organization:s.reuse.organization},null,8,["organization"]))])):(_(),G(v(sn),{key:1,class:"not-enlarged fr-mr-1v","auto-resize":!0,text:v(r),"max-lines":1},null,8,["text"])),y("span",y$,T(v(t)("published {date}",{date:v(pd)(s.reuse.created_at)})),1)]),y("div",b$,[y("p",w$,T(v(i)),1),y("p",{class:"fr-text--sm fr-my-0","aria-label":v(t)("{n} views",s.reuse.metrics.views)},[o[0]||(o[0]=y("span",{class:"fr-icon-eye-line fr-icon--xs fr-px-1v","aria-hidden":"true"},null,-1)),Y(T(v(go)(s.reuse.metrics.views)),1)],8,_$),y("p",{class:"fr-text--sm fr-my-0","aria-label":v(t)("{n} followers",s.reuse.metrics.followers)},[o[1]||(o[1]=y("span",{class:"fr-icon-star-line fr-icon--xs fr-px-1v","aria-hidden":"true"},null,-1)),Y(T(v(go)(s.reuse.metrics.followers)),1)],8,k$)])])])]),y("div",x$,[y("div",C$,[P(Th,{class:"fr-responsive-img reuse-ratio",alt:"",type:"reuse",src:s.reuse.image,size:320},null,8,["src"])]),s.reuse.private||s.reuse.archived?(_(),S("ul",S$,[s.reuse.private?(_(),S("li",M$,[y("p",T$,[o[2]||(o[2]=y("span",{class:"fr-icon-lock-line fr-icon--xs"},null,-1)),Y(" "+T(v(t)("Draft")),1)])])):V("",!0),s.reuse.archived?(_(),S("li",O$,[y("p",$$,[o[3]||(o[3]=y("span",{class:"fr-icon-lock-line fr-icon--xs"},null,-1)),Y(" "+T(v(t)("Archived")),1)])])):V("",!0)])):V("",!0)])]))}}),E$=Ne(D$,[["__scopeId","data-v-81c3bbfa"]]),Au=W({__name:"Well",props:{type:{default:"primary"},color:{default:"grey-100"},weight:{default:"semi-bold"}},setup(n){const e=n,t=A(()=>"well".concat(e.type==="primary"?"":"-"+e.type,"-").concat(e.color)),r=A(()=>"fr-text--".concat(e.weight)),i=A(()=>r.value+" "+t.value);return(s,o)=>(_(),S("div",{class:me(["well",i.value])},[et(s.$slots,"default")],2))}});/*!
 * Chart.js v4.2.1
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */function Tr(){}const A$=(()=>{let n=0;return()=>n++})();function Be(n){return n===null||typeof n>"u"}function rt(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Ee(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function mt(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function gn(n,e){return mt(n)?n:e}function Ce(n,e){return typeof n>"u"?e:n}const P$=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,lw=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function nt(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function Je(n,e,t,r){let i,s,o;if(rt(n))if(s=n.length,r)for(i=s-1;i>=0;i--)e.call(t,n[i],i);else for(i=0;i<s;i++)e.call(t,n[i],i);else if(Ee(n))for(o=Object.keys(n),s=o.length,i=0;i<s;i++)e.call(t,n[o[i]],o[i])}function Pu(n,e){let t,r,i,s;if(!n||!e||n.length!==e.length)return!1;for(t=0,r=n.length;t<r;++t)if(i=n[t],s=e[t],i.datasetIndex!==s.datasetIndex||i.index!==s.index)return!1;return!0}function Nu(n){if(rt(n))return n.map(Nu);if(Ee(n)){const e=Object.create(null),t=Object.keys(n),r=t.length;let i=0;for(;i<r;++i)e[t[i]]=Nu(n[t[i]]);return e}return n}function cw(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function N$(n,e,t,r){if(!cw(n))return;const i=e[n],s=t[n];Ee(i)&&Ee(s)?sl(i,s,r):e[n]=Nu(s)}function sl(n,e,t){const r=rt(e)?e:[e],i=r.length;if(!Ee(n))return n;t=t||{};const s=t.merger||N$;let o;for(let a=0;a<i;++a){if(o=r[a],!Ee(o))continue;const l=Object.keys(o);for(let c=0,u=l.length;c<u;++c)s(l[c],n,o,t)}return n}function Fa(n,e){return sl(n,e,{merger:R$})}function R$(n,e,t){if(!cw(n))return;const r=e[n],i=t[n];Ee(r)&&Ee(i)?Fa(r,i):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=Nu(i))}const $v={"":n=>n,x:n=>n.x,y:n=>n.y};function L$(n){const e=n.split("."),t=[];let r="";for(const i of e)r+=i,r.endsWith("\\")?r=r.slice(0,-1)+".":(t.push(r),r="");return t}function I$(n){const e=L$(n);return t=>{for(const r of e){if(r==="")break;t=t&&t[r]}return t}}function Ai(n,e){return($v[e]||($v[e]=I$(e)))(n)}function Qp(n){return n.charAt(0).toUpperCase()+n.slice(1)}const Nn=n=>typeof n<"u",Pi=n=>typeof n=="function",Dv=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function z$(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const at=Math.PI,st=2*at,B$=st+at,Ru=Number.POSITIVE_INFINITY,F$=at/180,gt=at/2,Ki=at/4,Ev=at*2/3,gi=Math.log10,mr=Math.sign;function Va(n,e,t){return Math.abs(n-e)<t}function Av(n){const e=Math.round(n);n=Va(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(gi(n))),r=n/t;return(r<=1?1:r<=2?2:r<=5?5:10)*t}function V$(n){const e=[],t=Math.sqrt(n);let r;for(r=1;r<t;r++)n%r===0&&(e.push(r),e.push(n/r));return t===(t|0)&&e.push(t),e.sort((i,s)=>i-s).pop(),e}function So(n){return!isNaN(parseFloat(n))&&isFinite(n)}function H$(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function uw(n,e,t){let r,i,s;for(r=0,i=n.length;r<i;r++)s=n[r][t],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function Yn(n){return n*(at/180)}function em(n){return n*(180/at)}function Pv(n){if(!mt(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function dw(n,e){const t=e.x-n.x,r=e.y-n.y,i=Math.sqrt(t*t+r*r);let s=Math.atan2(r,t);return s<-.5*at&&(s+=st),{angle:s,distance:i}}function Eh(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function W$(n,e){return(n-e+B$)%st-at}function vn(n){return(n%st+st)%st}function ol(n,e,t,r){const i=vn(n),s=vn(e),o=vn(t),a=vn(s-i),l=vn(o-i),c=vn(i-s),u=vn(i-o);return i===s||i===o||r&&s===o||a>l&&c<u}function At(n,e,t){return Math.max(e,Math.min(t,n))}function j$(n){return At(n,-32768,32767)}function zr(n,e,t,r=1e-6){return n>=Math.min(e,t)-r&&n<=Math.max(e,t)+r}function tm(n,e,t){t=t||(o=>n[o]<e);let r=n.length-1,i=0,s;for(;r-i>1;)s=i+r>>1,t(s)?i=s:r=s;return{lo:i,hi:r}}const Br=(n,e,t,r)=>tm(n,t,r?i=>{const s=n[i][e];return s<t||s===t&&n[i+1][e]===t}:i=>n[i][e]<t),U$=(n,e,t)=>tm(n,t,r=>n[r][e]>=t);function q$(n,e,t){let r=0,i=n.length;for(;r<i&&n[r]<e;)r++;for(;i>r&&n[i-1]>t;)i--;return r>0||i<n.length?n.slice(r,i):n}const fw=["push","pop","shift","splice","unshift"];function Y$(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),fw.forEach(t=>{const r="_onData"+Qp(t),i=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...s){const o=i.apply(this,s);return n._chartjs.listeners.forEach(a=>{typeof a[r]=="function"&&a[r](...s)}),o}})})}function Nv(n,e){const t=n._chartjs;if(!t)return;const r=t.listeners,i=r.indexOf(e);i!==-1&&r.splice(i,1),!(r.length>0)&&(fw.forEach(s=>{delete n[s]}),delete n._chartjs)}function hw(n){const e=new Set;let t,r;for(t=0,r=n.length;t<r;++t)e.add(n[t]);return e.size===r?n:Array.from(e)}const pw=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function mw(n,e){let t=[],r=!1;return function(...i){t=i,r||(r=!0,pw.call(window,()=>{r=!1,n.apply(e,t)}))}}function K$(n,e){let t;return function(...r){return e?(clearTimeout(t),t=setTimeout(n,e,r)):n.apply(this,r),e}}const nm=n=>n==="start"?"left":n==="end"?"right":"center",Vt=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,G$=(n,e,t,r)=>n===(r?"left":"right")?t:n==="center"?(e+t)/2:e;function gw(n,e,t){const r=e.length;let i=0,s=r;if(n._sorted){const{iScale:o,_parsed:a}=n,l=o.axis,{min:c,max:u,minDefined:d,maxDefined:f}=o.getUserBounds();d&&(i=At(Math.min(Br(a,o.axis,c).lo,t?r:Br(e,l,o.getPixelForValue(c)).lo),0,r-1)),f?s=At(Math.max(Br(a,o.axis,u,!0).hi+1,t?0:Br(e,l,o.getPixelForValue(u),!0).hi+1),i,r)-i:s=r-i}return{start:i,count:s}}function vw(n){const{xScale:e,yScale:t,_scaleRanges:r}=n,i={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!r)return n._scaleRanges=i,!0;const s=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==t.min||r.ymax!==t.max;return Object.assign(r,i),s}const ac=n=>n===0||n===1,Rv=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*st/t)),Lv=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*st/t)+1,Ha={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*gt)+1,easeOutSine:n=>Math.sin(n*gt),easeInOutSine:n=>-.5*(Math.cos(at*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>ac(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>ac(n)?n:Rv(n,.075,.3),easeOutElastic:n=>ac(n)?n:Lv(n,.075,.3),easeInOutElastic(n){return ac(n)?n:n<.5?.5*Rv(n*2,.1125,.45):.5+.5*Lv(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-Ha.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Ha.easeInBounce(n*2)*.5:Ha.easeOutBounce(n*2-1)*.5+.5};function yw(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function Iv(n){return yw(n)?n:new db(n)}function gf(n){return yw(n)?n:new db(n).saturate(.5).darken(.1).hexString()}const X$=["x","y","borderWidth","radius","tension"],J$=["color","borderColor","backgroundColor"];function Z$(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:J$},numbers:{type:"number",properties:X$}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Q$(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const zv=new Map;function e5(n,e){e=e||{};const t=n+JSON.stringify(e);let r=zv.get(t);return r||(r=new Intl.NumberFormat(n,e),zv.set(t,r)),r}function El(n,e,t){return e5(e,t).format(n)}const bw={values(n){return rt(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const r=this.chart.options.locale;let i,s=n;if(t.length>1){const c=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(c<1e-4||c>1e15)&&(i="scientific"),s=t5(n,t)}const o=gi(Math.abs(s)),a=Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:i,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),El(n,r,l)},logarithmic(n,e,t){if(n===0)return"0";const r=t[e].significand||n/Math.pow(10,Math.floor(gi(n)));return[1,2,3,5,10,15].includes(r)||e>.8*t.length?bw.numeric.call(this,n,e,t):""}};function t5(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var xd={formatters:bw};function n5(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:xd.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Ns=Object.create(null),Ah=Object.create(null);function Wa(n,e){if(!e)return n;const t=e.split(".");for(let r=0,i=t.length;r<i;++r){const s=t[r];n=n[s]||(n[s]=Object.create(null))}return n}function vf(n,e,t){return typeof e=="string"?sl(Wa(n,e),t):sl(Wa(n,""),e)}class r5{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,i)=>gf(i.backgroundColor),this.hoverBorderColor=(r,i)=>gf(i.borderColor),this.hoverColor=(r,i)=>gf(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return vf(this,e,t)}get(e){return Wa(this,e)}describe(e,t){return vf(Ah,e,t)}override(e,t){return vf(Ns,e,t)}route(e,t,r,i){const s=Wa(this,e),o=Wa(this,r),a="_"+t;Object.defineProperties(s,{[a]:{value:s[t],writable:!0},[t]:{enumerable:!0,get(){const l=this[a],c=o[i];return Ee(l)?Object.assign({},c,l):Ce(l,c)},set(l){this[a]=l}}})}apply(e){e.forEach(t=>t(this))}}var bt=new r5({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Z$,Q$,n5]);function i5(n){return!n||Be(n.size)||Be(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function Lu(n,e,t,r,i){let s=e[i];return s||(s=e[i]=n.measureText(i).width,t.push(i)),s>r&&(r=s),r}function s5(n,e,t,r){r=r||{};let i=r.data=r.data||{},s=r.garbageCollect=r.garbageCollect||[];r.font!==e&&(i=r.data={},s=r.garbageCollect=[],r.font=e),n.save(),n.font=e;let o=0;const a=t.length;let l,c,u,d,f;for(l=0;l<a;l++)if(d=t[l],d!=null&&rt(d)!==!0)o=Lu(n,i,s,o,d);else if(rt(d))for(c=0,u=d.length;c<u;c++)f=d[c],f!=null&&!rt(f)&&(o=Lu(n,i,s,o,f));n.restore();const h=s.length/2;if(h>t.length){for(l=0;l<h;l++)delete i[s[l]];s.splice(0,h)}return o}function Gi(n,e,t){const r=n.currentDevicePixelRatio,i=t!==0?Math.max(t/2,.5):0;return Math.round((e-i)*r)/r+i}function Bv(n,e){e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore()}function Ph(n,e,t,r){ww(n,e,t,r,null)}function ww(n,e,t,r,i){let s,o,a,l,c,u,d,f;const h=e.pointStyle,p=e.rotation,m=e.radius;let g=(p||0)*F$;if(h&&typeof h=="object"&&(s=h.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){n.save(),n.translate(t,r),n.rotate(g),n.drawImage(h,-h.width/2,-h.height/2,h.width,h.height),n.restore();return}if(!(isNaN(m)||m<=0)){switch(n.beginPath(),h){default:i?n.ellipse(t,r,i/2,m,0,0,st):n.arc(t,r,m,0,st),n.closePath();break;case"triangle":u=i?i/2:m,n.moveTo(t+Math.sin(g)*u,r-Math.cos(g)*m),g+=Ev,n.lineTo(t+Math.sin(g)*u,r-Math.cos(g)*m),g+=Ev,n.lineTo(t+Math.sin(g)*u,r-Math.cos(g)*m),n.closePath();break;case"rectRounded":c=m*.516,l=m-c,o=Math.cos(g+Ki)*l,d=Math.cos(g+Ki)*(i?i/2-c:l),a=Math.sin(g+Ki)*l,f=Math.sin(g+Ki)*(i?i/2-c:l),n.arc(t-d,r-a,c,g-at,g-gt),n.arc(t+f,r-o,c,g-gt,g),n.arc(t+d,r+a,c,g,g+gt),n.arc(t-f,r+o,c,g+gt,g+at),n.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*m,u=i?i/2:l,n.rect(t-u,r-l,2*u,2*l);break}g+=Ki;case"rectRot":d=Math.cos(g)*(i?i/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,f=Math.sin(g)*(i?i/2:m),n.moveTo(t-d,r-a),n.lineTo(t+f,r-o),n.lineTo(t+d,r+a),n.lineTo(t-f,r+o),n.closePath();break;case"crossRot":g+=Ki;case"cross":d=Math.cos(g)*(i?i/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,f=Math.sin(g)*(i?i/2:m),n.moveTo(t-d,r-a),n.lineTo(t+d,r+a),n.moveTo(t+f,r-o),n.lineTo(t-f,r+o);break;case"star":d=Math.cos(g)*(i?i/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,f=Math.sin(g)*(i?i/2:m),n.moveTo(t-d,r-a),n.lineTo(t+d,r+a),n.moveTo(t+f,r-o),n.lineTo(t-f,r+o),g+=Ki,d=Math.cos(g)*(i?i/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,f=Math.sin(g)*(i?i/2:m),n.moveTo(t-d,r-a),n.lineTo(t+d,r+a),n.moveTo(t+f,r-o),n.lineTo(t-f,r+o);break;case"line":o=i?i/2:Math.cos(g)*m,a=Math.sin(g)*m,n.moveTo(t-o,r-a),n.lineTo(t+o,r+a);break;case"dash":n.moveTo(t,r),n.lineTo(t+Math.cos(g)*(i?i/2:m),r+Math.sin(g)*m);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function al(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function Cd(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function Sd(n){n.restore()}function o5(n,e,t,r,i){if(!e)return n.lineTo(t.x,t.y);if(i==="middle"){const s=(e.x+t.x)/2;n.lineTo(s,e.y),n.lineTo(s,t.y)}else i==="after"!=!!r?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function a5(n,e,t,r){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?t.cp2x:t.cp1x,r?t.cp2y:t.cp1y,t.x,t.y)}function Rs(n,e,t,r,i,s={}){const o=rt(e)?e:[e],a=s.strokeWidth>0&&s.strokeColor!=="";let l,c;for(n.save(),n.font=i.string,l5(n,s),l=0;l<o.length;++l)c=o[l],s.backdrop&&u5(n,s.backdrop),a&&(s.strokeColor&&(n.strokeStyle=s.strokeColor),Be(s.strokeWidth)||(n.lineWidth=s.strokeWidth),n.strokeText(c,t,r,s.maxWidth)),n.fillText(c,t,r,s.maxWidth),c5(n,t,r,c,s),r+=i.lineHeight;n.restore()}function l5(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),Be(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function c5(n,e,t,r,i){if(i.strikethrough||i.underline){const s=n.measureText(r),o=e-s.actualBoundingBoxLeft,a=e+s.actualBoundingBoxRight,l=t-s.actualBoundingBoxAscent,c=t+s.actualBoundingBoxDescent,u=i.strikethrough?(l+c)/2:c;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=i.decorationWidth||2,n.moveTo(o,u),n.lineTo(a,u),n.stroke()}}function u5(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function ll(n,e){const{x:t,y:r,w:i,h:s,radius:o}=e;n.arc(t+o.topLeft,r+o.topLeft,o.topLeft,-gt,at,!0),n.lineTo(t,r+s-o.bottomLeft),n.arc(t+o.bottomLeft,r+s-o.bottomLeft,o.bottomLeft,at,gt,!0),n.lineTo(t+i-o.bottomRight,r+s),n.arc(t+i-o.bottomRight,r+s-o.bottomRight,o.bottomRight,gt,0,!0),n.lineTo(t+i,r+o.topRight),n.arc(t+i-o.topRight,r+o.topRight,o.topRight,0,-gt,!0),n.lineTo(t+o.topLeft,r)}const d5=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,f5=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function h5(n,e){const t=(""+n).match(d5);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const p5=n=>+n||0;function rm(n,e){const t={},r=Ee(e),i=r?Object.keys(e):e,s=Ee(n)?r?o=>Ce(n[o],n[e[o]]):o=>n[o]:()=>n;for(const o of i)t[o]=p5(s(o));return t}function _w(n){return rm(n,{top:"y",right:"x",bottom:"y",left:"x"})}function bs(n){return rm(n,["topLeft","topRight","bottomLeft","bottomRight"])}function Yt(n){const e=_w(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function $t(n,e){n=n||{},e=e||bt.font;let t=Ce(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let r=Ce(n.style,e.style);r&&!(""+r).match(f5)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const i={family:Ce(n.family,e.family),lineHeight:h5(Ce(n.lineHeight,e.lineHeight),t),size:t,style:r,weight:Ce(n.weight,e.weight),string:""};return i.string=i5(i),i}function da(n,e,t,r){let i=!0,s,o,a;for(s=0,o=n.length;s<o;++s)if(a=n[s],a!==void 0&&(e!==void 0&&typeof a=="function"&&(a=a(e),i=!1),t!==void 0&&rt(a)&&(a=a[t%a.length],i=!1),a!==void 0))return r&&!i&&(r.cacheable=!1),a}function m5(n,e,t){const{min:r,max:i}=n,s=lw(e,(i-r)/2),o=(a,l)=>t&&a===0?0:a+l;return{min:o(r,-Math.abs(s)),max:o(i,s)}}function Ii(n,e){return Object.assign(Object.create(n),e)}function im(n,e=[""],t=n,r,i=()=>n[0]){Nn(r)||(r=Sw("_fallback",n));const s={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:t,_fallback:r,_getTarget:i,override:o=>im([o,...n],e,t,r)};return new Proxy(s,{deleteProperty(o,a){return delete o[a],delete o._keys,delete n[0][a],!0},get(o,a){return xw(o,a,()=>x5(a,e,n,o))},getOwnPropertyDescriptor(o,a){return Reflect.getOwnPropertyDescriptor(o._scopes[0],a)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(o,a){return Vv(o).includes(a)},ownKeys(o){return Vv(o)},set(o,a,l){const c=o._storage||(o._storage=i());return o[a]=c[a]=l,delete o._keys,!0}})}function Mo(n,e,t,r){const i={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:kw(n,r),setContext:s=>Mo(n,s,t,r),override:s=>Mo(n.override(s),e,t,r)};return new Proxy(i,{deleteProperty(s,o){return delete s[o],delete n[o],!0},get(s,o,a){return xw(s,o,()=>v5(s,o,a))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(s,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(s,o,a){return n[o]=a,delete s[o],!0}})}function kw(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:r=e.indexable,_allKeys:i=e.allKeys}=n;return{allKeys:i,scriptable:t,indexable:r,isScriptable:Pi(t)?t:()=>t,isIndexable:Pi(r)?r:()=>r}}const g5=(n,e)=>n?n+Qp(e):e,sm=(n,e)=>Ee(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function xw(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e))return n[e];const r=t();return n[e]=r,r}function v5(n,e,t){const{_proxy:r,_context:i,_subProxy:s,_descriptors:o}=n;let a=r[e];return Pi(a)&&o.isScriptable(e)&&(a=y5(e,a,n,t)),rt(a)&&a.length&&(a=b5(e,a,n,o.isIndexable)),sm(e,a)&&(a=Mo(a,i,s&&s[e],o)),a}function y5(n,e,t,r){const{_proxy:i,_context:s,_subProxy:o,_stack:a}=t;if(a.has(n))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+n);return a.add(n),e=e(s,o||r),a.delete(n),sm(n,e)&&(e=om(i._scopes,i,n,e)),e}function b5(n,e,t,r){const{_proxy:i,_context:s,_subProxy:o,_descriptors:a}=t;if(Nn(s.index)&&r(n))e=e[s.index%e.length];else if(Ee(e[0])){const l=e,c=i._scopes.filter(u=>u!==l);e=[];for(const u of l){const d=om(c,i,n,u);e.push(Mo(d,s,o&&o[n],a))}}return e}function Cw(n,e,t){return Pi(n)?n(e,t):n}const w5=(n,e)=>n===!0?e:typeof n=="string"?Ai(e,n):void 0;function _5(n,e,t,r,i){for(const s of e){const o=w5(t,s);if(o){n.add(o);const a=Cw(o._fallback,t,i);if(Nn(a)&&a!==t&&a!==r)return a}else if(o===!1&&Nn(r)&&t!==r)return null}return!1}function om(n,e,t,r){const i=e._rootScopes,s=Cw(e._fallback,t,r),o=[...n,...i],a=new Set;a.add(r);let l=Fv(a,o,t,s||t,r);return l===null||Nn(s)&&s!==t&&(l=Fv(a,o,s,l,r),l===null)?!1:im(Array.from(a),[""],i,s,()=>k5(e,t,r))}function Fv(n,e,t,r,i){for(;t;)t=_5(n,e,t,r,i);return t}function k5(n,e,t){const r=n._getTarget();e in r||(r[e]={});const i=r[e];return rt(i)&&Ee(t)?t:i||{}}function x5(n,e,t,r){let i;for(const s of e)if(i=Sw(g5(s,n),t),Nn(i))return sm(n,i)?om(t,r,n,i):i}function Sw(n,e){for(const t of e){if(!t)continue;const r=t[n];if(Nn(r))return r}}function Vv(n){let e=n._keys;return e||(e=n._keys=C5(n._scopes)),e}function C5(n){const e=new Set;for(const t of n)for(const r of Object.keys(t).filter(i=>!i.startsWith("_")))e.add(r);return Array.from(e)}function Mw(n,e,t,r){const{iScale:i}=n,{key:s="r"}=this._parsing,o=new Array(r);let a,l,c,u;for(a=0,l=r;a<l;++a)c=a+t,u=e[c],o[a]={r:i.parse(Ai(u,s),c)};return o}const S5=Number.EPSILON||1e-14,To=(n,e)=>e<n.length&&!n[e].skip&&n[e],Tw=n=>n==="x"?"y":"x";function M5(n,e,t,r){const i=n.skip?e:n,s=e,o=t.skip?e:t,a=Eh(s,i),l=Eh(o,s);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const d=r*c,f=r*u;return{previous:{x:s.x-d*(o.x-i.x),y:s.y-d*(o.y-i.y)},next:{x:s.x+f*(o.x-i.x),y:s.y+f*(o.y-i.y)}}}function T5(n,e,t){const r=n.length;let i,s,o,a,l,c=To(n,0);for(let u=0;u<r-1;++u)if(l=c,c=To(n,u+1),!(!l||!c)){if(Va(e[u],0,S5)){t[u]=t[u+1]=0;continue}i=t[u]/e[u],s=t[u+1]/e[u],a=Math.pow(i,2)+Math.pow(s,2),!(a<=9)&&(o=3/Math.sqrt(a),t[u]=i*o*e[u],t[u+1]=s*o*e[u])}}function O5(n,e,t="x"){const r=Tw(t),i=n.length;let s,o,a,l=To(n,0);for(let c=0;c<i;++c){if(o=a,a=l,l=To(n,c+1),!a)continue;const u=a[t],d=a[r];o&&(s=(u-o[t])/3,a["cp1".concat(t)]=u-s,a["cp1".concat(r)]=d-s*e[c]),l&&(s=(l[t]-u)/3,a["cp2".concat(t)]=u+s,a["cp2".concat(r)]=d+s*e[c])}}function $5(n,e="x"){const t=Tw(e),r=n.length,i=Array(r).fill(0),s=Array(r);let o,a,l,c=To(n,0);for(o=0;o<r;++o)if(a=l,l=c,c=To(n,o+1),!!l){if(c){const u=c[e]-l[e];i[o]=u!==0?(c[t]-l[t])/u:0}s[o]=a?c?mr(i[o-1])!==mr(i[o])?0:(i[o-1]+i[o])/2:i[o-1]:i[o]}T5(n,i,s),O5(n,s,e)}function lc(n,e,t){return Math.max(Math.min(n,t),e)}function D5(n,e){let t,r,i,s,o,a=al(n[0],e);for(t=0,r=n.length;t<r;++t)o=s,s=a,a=t<r-1&&al(n[t+1],e),s&&(i=n[t],o&&(i.cp1x=lc(i.cp1x,e.left,e.right),i.cp1y=lc(i.cp1y,e.top,e.bottom)),a&&(i.cp2x=lc(i.cp2x,e.left,e.right),i.cp2y=lc(i.cp2y,e.top,e.bottom)))}function E5(n,e,t,r,i){let s,o,a,l;if(e.spanGaps&&(n=n.filter(c=>!c.skip)),e.cubicInterpolationMode==="monotone")$5(n,i);else{let c=r?n[n.length-1]:n[0];for(s=0,o=n.length;s<o;++s)a=n[s],l=M5(c,a,n[Math.min(s+1,o-(r?0:1))%o],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}e.capBezierPoints&&D5(n,t)}function Ow(){return typeof window<"u"&&typeof document<"u"}function am(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Iu(n,e,t){let r;return typeof n=="string"?(r=parseInt(n,10),n.indexOf("%")!==-1&&(r=r/100*e.parentNode[t])):r=n,r}const Md=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function A5(n,e){return Md(n).getPropertyValue(e)}const P5=["top","right","bottom","left"];function ws(n,e,t){const r={};t=t?"-"+t:"";for(let i=0;i<4;i++){const s=P5[i];r[s]=parseFloat(n[e+"-"+s+t])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const N5=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function R5(n,e){const t=n.touches,r=t&&t.length?t[0]:n,{offsetX:i,offsetY:s}=r;let o=!1,a,l;if(N5(i,s,n.target))a=i,l=s;else{const c=e.getBoundingClientRect();a=r.clientX-c.left,l=r.clientY-c.top,o=!0}return{x:a,y:l,box:o}}function Zi(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:r}=e,i=Md(t),s=i.boxSizing==="border-box",o=ws(i,"padding"),a=ws(i,"border","width"),{x:l,y:c,box:u}=R5(n,t),d=o.left+(u&&a.left),f=o.top+(u&&a.top);let{width:h,height:p}=e;return s&&(h-=o.width+a.width,p-=o.height+a.height),{x:Math.round((l-d)/h*t.width/r),y:Math.round((c-f)/p*t.height/r)}}function L5(n,e,t){let r,i;if(e===void 0||t===void 0){const s=am(n);if(!s)e=n.clientWidth,t=n.clientHeight;else{const o=s.getBoundingClientRect(),a=Md(s),l=ws(a,"border","width"),c=ws(a,"padding");e=o.width-c.width-l.width,t=o.height-c.height-l.height,r=Iu(a.maxWidth,s,"clientWidth"),i=Iu(a.maxHeight,s,"clientHeight")}}return{width:e,height:t,maxWidth:r||Ru,maxHeight:i||Ru}}const cc=n=>Math.round(n*10)/10;function I5(n,e,t,r){const i=Md(n),s=ws(i,"margin"),o=Iu(i.maxWidth,n,"clientWidth")||Ru,a=Iu(i.maxHeight,n,"clientHeight")||Ru,l=L5(n,e,t);let{width:c,height:u}=l;if(i.boxSizing==="content-box"){const f=ws(i,"border","width"),h=ws(i,"padding");c-=h.width+f.width,u-=h.height+f.height}return c=Math.max(0,c-s.width),u=Math.max(0,r?c/r:u-s.height),c=cc(Math.min(c,o,l.maxWidth)),u=cc(Math.min(u,a,l.maxHeight)),c&&!u&&(u=cc(c/2)),(e!==void 0||t!==void 0)&&r&&l.height&&u>l.height&&(u=l.height,c=cc(Math.floor(u*r))),{width:c,height:u}}function Hv(n,e,t){const r=e||1,i=Math.floor(n.height*r),s=Math.floor(n.width*r);n.height=Math.floor(n.height),n.width=Math.floor(n.width);const o=n.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height="".concat(n.height,"px"),o.style.width="".concat(n.width,"px")),n.currentDevicePixelRatio!==r||o.height!==i||o.width!==s?(n.currentDevicePixelRatio=r,o.height=i,o.width=s,n.ctx.setTransform(r,0,0,r,0,0),!0):!1}const z5=function(){let n=!1;try{const e={get passive(){return n=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){}return n}();function Wv(n,e){const t=A5(n,e),r=t&&t.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function Qi(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function B5(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:r==="middle"?t<.5?n.y:e.y:r==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function F5(n,e,t,r){const i={x:n.cp2x,y:n.cp2y},s={x:e.cp1x,y:e.cp1y},o=Qi(n,i,t),a=Qi(i,s,t),l=Qi(s,e,t),c=Qi(o,a,t),u=Qi(a,l,t);return Qi(c,u,t)}const V5=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,r){return t-r},leftForLtr(t,r){return t-r}}},H5=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function vo(n,e,t){return n?V5(e,t):H5()}function $w(n,e){let t,r;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,r=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=r)}function Dw(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function Ew(n){return n==="angle"?{between:ol,compare:W$,normalize:vn}:{between:zr,compare:(e,t)=>e-t,normalize:e=>e}}function jv({start:n,end:e,count:t,loop:r,style:i}){return{start:n%t,end:e%t,loop:r&&(e-n+1)%t===0,style:i}}function W5(n,e,t){const{property:r,start:i,end:s}=t,{between:o,normalize:a}=Ew(r),l=e.length;let{start:c,end:u,loop:d}=n,f,h;if(d){for(c+=l,u+=l,f=0,h=l;f<h&&o(a(e[c%l][r]),i,s);++f)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:d,style:n.style}}function Aw(n,e,t){if(!t)return[n];const{property:r,start:i,end:s}=t,o=e.length,{compare:a,between:l,normalize:c}=Ew(r),{start:u,end:d,loop:f,style:h}=W5(n,e,t),p=[];let m=!1,g=null,w,x,M;const b=()=>l(i,M,w)&&a(i,M)!==0,C=()=>a(s,w)===0||l(s,M,w),k=()=>m||b(),$=()=>!m||C();for(let O=u,D=u;O<=d;++O)x=e[O%o],!x.skip&&(w=c(x[r]),w!==M&&(m=l(w,i,s),g===null&&k()&&(g=a(w,i)===0?O:D),g!==null&&$()&&(p.push(jv({start:g,end:O,loop:f,count:o,style:h})),g=null),D=O,M=w));return g!==null&&p.push(jv({start:g,end:d,loop:f,count:o,style:h})),p}function Pw(n,e){const t=[],r=n.segments;for(let i=0;i<r.length;i++){const s=Aw(r[i],n.points,e);s.length&&t.push(...s)}return t}function j5(n,e,t,r){let i=0,s=e-1;if(t&&!r)for(;i<e&&!n[i].skip;)i++;for(;i<e&&n[i].skip;)i++;for(i%=e,t&&(s+=i);s>i&&n[s%e].skip;)s--;return s%=e,{start:i,end:s}}function U5(n,e,t,r){const i=n.length,s=[];let o=e,a=n[e],l;for(l=e+1;l<=t;++l){const c=n[l%i];c.skip||c.stop?a.skip||(r=!1,s.push({start:e%i,end:(l-1)%i,loop:r}),e=o=c.stop?l:null):(o=l,a.skip&&(e=l)),a=c}return o!==null&&s.push({start:e%i,end:o%i,loop:r}),s}function q5(n,e){const t=n.points,r=n.options.spanGaps,i=t.length;if(!i)return[];const s=!!n._loop,{start:o,end:a}=j5(t,i,s,r);if(r===!0)return Uv(n,[{start:o,end:a,loop:s}],t,e);const l=a<o?a+i:a,c=!!n._fullLoop&&o===0&&a===i-1;return Uv(n,U5(t,o,l,c),t,e)}function Uv(n,e,t,r){return!r||!r.setContext||!t?e:Y5(n,e,t,r)}function Y5(n,e,t,r){const i=n._chart.getContext(),s=qv(n.options),{_datasetIndex:o,options:{spanGaps:a}}=n,l=t.length,c=[];let u=s,d=e[0].start,f=d;function h(p,m,g,w){const x=a?-1:1;if(p!==m){for(p+=l;t[p%l].skip;)p-=x;for(;t[m%l].skip;)m+=x;p%l!==m%l&&(c.push({start:p%l,end:m%l,loop:g,style:w}),u=w,d=m%l)}}for(const p of e){d=a?d:p.start;let m=t[d%l],g;for(f=d+1;f<=p.end;f++){const w=t[f%l];g=qv(r.setContext(Ii(i,{type:"segment",p0:m,p1:w,p0DataIndex:(f-1)%l,p1DataIndex:f%l,datasetIndex:o}))),K5(g,u)&&h(d,f-1,p.loop,u),m=w,u=g}d<f-1&&h(d,f-1,p.loop,u)}return c}function qv(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function K5(n,e){return e&&JSON.stringify(n)!==JSON.stringify(e)}/*!
 * Chart.js v4.2.1
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */class G5{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,r,i){const s=t.listeners[i],o=t.duration;s.forEach(a=>a({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(r-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=pw.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((r,i)=>{if(!r.running||!r.items.length)return;const s=r.items;let o=s.length-1,a=!1,l;for(;o>=0;--o)l=s[o],l._active?(l._total>r.duration&&(r.duration=l._total),l.tick(e),a=!0):(s[o]=s[s.length-1],s.pop());a&&(i.draw(),this._notify(i,r,e,"progress")),s.length||(r.running=!1,this._notify(i,r,e,"complete"),r.initial=!1),t+=s.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let r=t.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,r)),r}listen(e,t,r){this._getAnims(e).listeners[t].push(r)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((r,i)=>Math.max(r,i._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const r=t.items;let i=r.length-1;for(;i>=0;--i)r[i].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var $r=new G5;const Yv="transparent",X5={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const r=Iv(n||Yv),i=r.valid&&Iv(e||Yv);return i&&i.valid?i.mix(r,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class J5{constructor(e,t,r,i){const s=t[r];i=da([e.to,i,s,e.from]);const o=da([e.from,s,i]);this._active=!0,this._fn=e.fn||X5[e.type||typeof o],this._easing=Ha[e.easing]||Ha.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=r,this._from=o,this._to=i,this._promises=void 0}active(){return this._active}update(e,t,r){if(this._active){this._notify(!1);const i=this._target[this._prop],s=r-this._start,o=this._duration-s;this._start=r,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=da([e.to,t,i,e.from]),this._from=da([e.from,i,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,r=this._duration,i=this._prop,s=this._from,o=this._loop,a=this._to;let l;if(this._active=s!==a&&(o||t<r),!this._active){this._target[i]=a,this._notify(!0);return}if(t<0){this._target[i]=s;return}l=t/r%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[i]=this._fn(s,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,r)=>{e.push({res:t,rej:r})})}_notify(e){const t=e?"res":"rej",r=this._promises||[];for(let i=0;i<r.length;i++)r[i][t]()}}class Nw{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!Ee(e))return;const t=Object.keys(bt.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const s=e[i];if(!Ee(s))return;const o={};for(const a of t)o[a]=s[a];(rt(s.properties)&&s.properties||[i]).forEach(a=>{(a===i||!r.has(a))&&r.set(a,o)})})}_animateOptions(e,t){const r=t.options,i=Q5(e,r);if(!i)return[];const s=this._createAnimations(i,r);return r.$shared&&Z5(e.options.$animations,r).then(()=>{e.options=r},()=>{}),s}_createAnimations(e,t){const r=this._properties,i=[],s=e.$animations||(e.$animations={}),o=Object.keys(t),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if(c.charAt(0)==="$")continue;if(c==="options"){i.push(...this._animateOptions(e,t));continue}const u=t[c];let d=s[c];const f=r.get(c);if(d)if(f&&d.active()){d.update(f,u,a);continue}else d.cancel();if(!f||!f.duration){e[c]=u;continue}s[c]=d=new J5(f,e,c,u),i.push(d)}return i}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const r=this._createAnimations(e,t);if(r.length)return $r.add(this._chart,r),!0}}function Z5(n,e){const t=[],r=Object.keys(e);for(let i=0;i<r.length;i++){const s=n[r[i]];s&&s.active()&&t.push(s.wait())}return Promise.all(t)}function Q5(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function Kv(n,e){const t=n&&n.options||{},r=t.reverse,i=t.min===void 0?e:0,s=t.max===void 0?e:0;return{start:r?s:i,end:r?i:s}}function eD(n,e,t){if(t===!1)return!1;const r=Kv(n,t),i=Kv(e,t);return{top:i.end,right:r.end,bottom:i.start,left:r.start}}function tD(n){let e,t,r,i;return Ee(n)?(e=n.top,t=n.right,r=n.bottom,i=n.left):e=t=r=i=n,{top:e,right:t,bottom:r,left:i,disabled:n===!1}}function Rw(n,e){const t=[],r=n._getSortedDatasetMetas(e);let i,s;for(i=0,s=r.length;i<s;++i)t.push(r[i].index);return t}function Gv(n,e,t,r={}){const i=n.keys,s=r.mode==="single";let o,a,l,c;if(e!==null){for(o=0,a=i.length;o<a;++o){if(l=+i[o],l===t){if(r.all)continue;break}c=n.values[l],mt(c)&&(s||e===0||mr(e)===mr(c))&&(e+=c)}return e}}function nD(n){const e=Object.keys(n),t=new Array(e.length);let r,i,s;for(r=0,i=e.length;r<i;++r)s=e[r],t[r]={x:s,y:n[s]};return t}function Xv(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function rD(n,e,t){return"".concat(n.id,".").concat(e.id,".").concat(t.stack||t.type)}function iD(n){const{min:e,max:t,minDefined:r,maxDefined:i}=n.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:i?t:Number.POSITIVE_INFINITY}}function sD(n,e,t){const r=n[e]||(n[e]={});return r[t]||(r[t]={})}function Jv(n,e,t,r){for(const i of e.getMatchingVisibleMetas(r).reverse()){const s=n[i.index];if(t&&s>0||!t&&s<0)return i.index}return null}function Zv(n,e){const{chart:t,_cachedMeta:r}=n,i=t._stacks||(t._stacks={}),{iScale:s,vScale:o,index:a}=r,l=s.axis,c=o.axis,u=rD(s,o,r),d=e.length;let f;for(let h=0;h<d;++h){const p=e[h],{[l]:m,[c]:g}=p,w=p._stacks||(p._stacks={});f=w[c]=sD(i,u,m),f[a]=g,f._top=Jv(f,o,!0,r.type),f._bottom=Jv(f,o,!1,r.type);const x=f._visualValues||(f._visualValues={});x[a]=g}}function yf(n,e){const t=n.scales;return Object.keys(t).filter(r=>t[r].axis===e).shift()}function oD(n,e){return Ii(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function aD(n,e,t){return Ii(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function ta(n,e){const t=n.controller.index,r=n.vScale&&n.vScale.axis;if(r){e=e||n._parsed;for(const i of e){const s=i._stacks;if(!s||s[r]===void 0||s[r][t]===void 0)return;delete s[r][t],s[r]._visualValues!==void 0&&s[r]._visualValues[t]!==void 0&&delete s[r]._visualValues[t]}}}const bf=n=>n==="reset"||n==="none",Qv=(n,e)=>e?n:Object.assign({},n),lD=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:Rw(t,!0),values:null};class Gn{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Xv(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&ta(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,r=this.getDataset(),i=(d,f,h,p)=>d==="x"?f:d==="r"?p:h,s=t.xAxisID=Ce(r.xAxisID,yf(e,"x")),o=t.yAxisID=Ce(r.yAxisID,yf(e,"y")),a=t.rAxisID=Ce(r.rAxisID,yf(e,"r")),l=t.indexAxis,c=t.iAxisID=i(l,s,o,a),u=t.vAxisID=i(l,o,s,a);t.xScale=this.getScaleForId(s),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(a),t.iScale=this.getScaleForId(c),t.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&Nv(this._data,this),e._stacked&&ta(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),r=this._data;if(Ee(t))this._data=nD(t);else if(r!==t){if(r){Nv(r,this);const i=this._cachedMeta;ta(i),i._parsed=[]}t&&Object.isExtensible(t)&&Y$(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,r=this.getDataset();let i=!1;this._dataCheck();const s=t._stacked;t._stacked=Xv(t.vScale,t),t.stack!==r.stack&&(i=!0,ta(t),t.stack=r.stack),this._resyncElements(e),(i||s!==t._stacked)&&Zv(this,t._parsed)}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:r,_data:i}=this,{iScale:s,_stacked:o}=r,a=s.axis;let l=e===0&&t===i.length?!0:r._sorted,c=e>0&&r._parsed[e-1],u,d,f;if(this._parsing===!1)r._parsed=i,r._sorted=!0,f=i;else{rt(i[e])?f=this.parseArrayData(r,i,e,t):Ee(i[e])?f=this.parseObjectData(r,i,e,t):f=this.parsePrimitiveData(r,i,e,t);const h=()=>d[a]===null||c&&d[a]<c[a];for(u=0;u<t;++u)r._parsed[u+e]=d=f[u],l&&(h()&&(l=!1),c=d);r._sorted=l}o&&Zv(this,f)}parsePrimitiveData(e,t,r,i){const{iScale:s,vScale:o}=e,a=s.axis,l=o.axis,c=s.getLabels(),u=s===o,d=new Array(i);let f,h,p;for(f=0,h=i;f<h;++f)p=f+r,d[f]={[a]:u||s.parse(c[p],p),[l]:o.parse(t[p],p)};return d}parseArrayData(e,t,r,i){const{xScale:s,yScale:o}=e,a=new Array(i);let l,c,u,d;for(l=0,c=i;l<c;++l)u=l+r,d=t[u],a[l]={x:s.parse(d[0],u),y:o.parse(d[1],u)};return a}parseObjectData(e,t,r,i){const{xScale:s,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(i);let u,d,f,h;for(u=0,d=i;u<d;++u)f=u+r,h=t[f],c[u]={x:s.parse(Ai(h,a),f),y:o.parse(Ai(h,l),f)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,r){const i=this.chart,s=this._cachedMeta,o=t[e.axis],a={keys:Rw(i,!0),values:t._stacks[e.axis]._visualValues};return Gv(a,o,s.index,{mode:r})}updateRangeFromParsed(e,t,r,i){const s=r[t.axis];let o=s===null?NaN:s;const a=i&&r._stacks[t.axis];i&&a&&(i.values=a,o=Gv(i,s,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const r=this._cachedMeta,i=r._parsed,s=r._sorted&&e===r.iScale,o=i.length,a=this._getOtherScale(e),l=lD(t,r,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:d}=iD(a);let f,h;function p(){h=i[f];const m=h[a.axis];return!mt(h[e.axis])||u>m||d<m}for(f=0;f<o&&!(!p()&&(this.updateRangeFromParsed(c,e,h,l),s));++f);if(s){for(f=o-1;f>=0;--f)if(!p()){this.updateRangeFromParsed(c,e,h,l);break}}return c}getAllParsedValues(e){const t=this._cachedMeta._parsed,r=[];let i,s,o;for(i=0,s=t.length;i<s;++i)o=t[i][e.axis],mt(o)&&r.push(o);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,r=t.iScale,i=t.vScale,s=this.getParsed(e);return{label:r?""+r.getLabelForValue(s[r.axis]):"",value:i?""+i.getLabelForValue(s[i.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=tD(Ce(this.options.clip,eD(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,r=this._cachedMeta,i=r.data||[],s=t.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||i.length-a,c=this.options.drawActiveElementsOnTop;let u;for(r.dataset&&r.dataset.draw(e,s,a,l),u=a;u<a+l;++u){const d=i[u];d.hidden||(d.active&&c?o.push(d):d.draw(e,s))}for(u=0;u<o.length;++u)o[u].draw(e,s)}getStyle(e,t){const r=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,t,r){const i=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];s=o.$context||(o.$context=aD(this.getContext(),e,o)),s.parsed=this.getParsed(e),s.raw=i.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=oD(this.chart.getContext(),this.index)),s.dataset=i,s.index=s.datasetIndex=this.index;return s.active=!!t,s.mode=r,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",r){const i=t==="active",s=this._cachedDataOpts,o=e+"-"+t,a=s[o],l=this.enableOptionSharing&&Nn(r);if(a)return Qv(a,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,e),d=i?["".concat(e,"Hover"),"hover",e,""]:[e,""],f=c.getOptionScopes(this.getDataset(),u),h=Object.keys(bt.elements[e]),p=()=>this.getContext(r,i,t),m=c.resolveNamedOptions(f,h,p,d);return m.$shared&&(m.$shared=l,s[o]=Object.freeze(Qv(m,l))),m}_resolveAnimations(e,t,r){const i=this.chart,s=this._cachedDataOpts,o="animation-".concat(t),a=s[o];if(a)return a;let l;if(i.options.animation!==!1){const u=this.chart.config,d=u.datasetAnimationScopeKeys(this._type,t),f=u.getOptionScopes(this.getDataset(),d);l=u.createResolver(f,this.getContext(e,r,t))}const c=new Nw(i,l&&l.animations);return l&&l._cacheable&&(s[o]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||bf(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const r=this.resolveDataElementOptions(e,t),i=this._sharedOptions,s=this.getSharedOptions(r),o=this.includeOptions(t,s)||s!==i;return this.updateSharedOptions(s,t,r),{sharedOptions:s,includeOptions:o}}updateElement(e,t,r,i){bf(i)?Object.assign(e,r):this._resolveAnimations(t,i).update(e,r)}updateSharedOptions(e,t,r){e&&!bf(t)&&this._resolveAnimations(void 0,t).update(e,r)}_setStyle(e,t,r,i){e.active=i;const s=this.getStyle(t,i);this._resolveAnimations(t,r,i).update(e,{options:!i&&this.getSharedOptions(s)||s})}removeHoverStyle(e,t,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,t,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,r=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const i=r.length,s=t.length,o=Math.min(s,i);o&&this.parse(0,o),s>i?this._insertElements(i,s-i,e):s<i&&this._removeElements(s,i-s)}_insertElements(e,t,r=!0){const i=this._cachedMeta,s=i.data,o=e+t;let a;const l=c=>{for(c.length+=t,a=c.length-1;a>=o;a--)c[a]=c[a-t]};for(l(s),a=e;a<o;++a)s[a]=new this.dataElementType;this._parsing&&l(i._parsed),this.parse(e,t),r&&this.updateElements(s,e,t,"reset")}updateElements(e,t,r,i){}_removeElements(e,t){const r=this._cachedMeta;if(this._parsing){const i=r._parsed.splice(e,t);r._stacked&&ta(r,i)}r.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,r,i]=e;this[t](r,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}se(Gn,"defaults",{}),se(Gn,"datasetElementType",null),se(Gn,"dataElementType",null);function cD(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let r=[];for(let i=0,s=t.length;i<s;i++)r=r.concat(t[i].controller.getAllParsedValues(n));n._cache.$bar=hw(r.sort((i,s)=>i-s))}return n._cache.$bar}function uD(n){const e=n.iScale,t=cD(e,n.type);let r=e._length,i,s,o,a;const l=()=>{o===32767||o===-32768||(Nn(a)&&(r=Math.min(r,Math.abs(o-a)||r)),a=o)};for(i=0,s=t.length;i<s;++i)o=e.getPixelForValue(t[i]),l();for(a=void 0,i=0,s=e.ticks.length;i<s;++i)o=e.getPixelForTick(i),l();return r}function dD(n,e,t,r){const i=t.barThickness;let s,o;return Be(i)?(s=e.min*t.categoryPercentage,o=t.barPercentage):(s=i*r,o=1),{chunk:s/r,ratio:o,start:e.pixels[n]-s/2}}function fD(n,e,t,r){const i=e.pixels,s=i[n];let o=n>0?i[n-1]:null,a=n<i.length-1?i[n+1]:null;const l=t.categoryPercentage;o===null&&(o=s-(a===null?e.end-e.start:a-s)),a===null&&(a=s+s-o);const c=s-(s-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/r,ratio:t.barPercentage,start:c}}function hD(n,e,t,r){const i=t.parse(n[0],r),s=t.parse(n[1],r),o=Math.min(i,s),a=Math.max(i,s);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),e[t.axis]=c,e._custom={barStart:l,barEnd:c,start:i,end:s,min:o,max:a}}function Lw(n,e,t,r){return rt(n)?hD(n,e,t,r):e[t.axis]=t.parse(n,r),e}function ey(n,e,t,r){const i=n.iScale,s=n.vScale,o=i.getLabels(),a=i===s,l=[];let c,u,d,f;for(c=t,u=t+r;c<u;++c)f=e[c],d={},d[i.axis]=a||i.parse(o[c],c),l.push(Lw(f,d,s,c));return l}function wf(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function pD(n,e,t){return n!==0?mr(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function mD(n){let e,t,r,i,s;return n.horizontal?(e=n.base>n.x,t="left",r="right"):(e=n.base<n.y,t="bottom",r="top"),e?(i="end",s="start"):(i="start",s="end"),{start:t,end:r,reverse:e,top:i,bottom:s}}function gD(n,e,t,r){let i=e.borderSkipped;const s={};if(!i){n.borderSkipped=s;return}if(i===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:c,bottom:u}=mD(n);i==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===r?i=c:(t._bottom||0)===r?i=u:(s[ty(u,o,a,l)]=!0,i=c)),s[ty(i,o,a,l)]=!0,n.borderSkipped=s}function ty(n,e,t,r){return r?(n=vD(n,e,t),n=ny(n,t,e)):n=ny(n,e,t),n}function vD(n,e,t){return n===e?t:n===t?e:n}function ny(n,e,t){return n==="start"?e:n==="end"?t:n}function yD(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class Ac extends Gn{parsePrimitiveData(e,t,r,i){return ey(e,t,r,i)}parseArrayData(e,t,r,i){return ey(e,t,r,i)}parseObjectData(e,t,r,i){const{iScale:s,vScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=s.axis==="x"?a:l,u=o.axis==="x"?a:l,d=[];let f,h,p,m;for(f=r,h=r+i;f<h;++f)m=t[f],p={},p[s.axis]=s.parse(Ai(m,c),f),d.push(Lw(Ai(m,u),p,o,f));return d}updateRangeFromParsed(e,t,r,i){super.updateRangeFromParsed(e,t,r,i);const s=r._custom;s&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:r,vScale:i}=t,s=this.getParsed(e),o=s._custom,a=wf(o)?"["+o.start+", "+o.end+"]":""+i.getLabelForValue(s[i.axis]);return{label:""+r.getLabelForValue(s[r.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,r,i){const s=i==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),u=this._getRuler(),{sharedOptions:d,includeOptions:f}=this._getSharedOptions(t,i);for(let h=t;h<t+r;h++){const p=this.getParsed(h),m=s||Be(p[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(h),g=this._calculateBarIndexPixels(h,u),w=(p._stacks||{})[a.axis],x={horizontal:c,base:m.base,enableBorderRadius:!w||wf(p._custom)||o===w._top||o===w._bottom,x:c?m.head:g.center,y:c?g.center:m.head,height:c?g.size:Math.abs(m.size),width:c?Math.abs(m.size):g.size};f&&(x.options=d||this.resolveDataElementOptions(h,e[h].active?"active":i));const M=x.options||e[h].options;gD(x,M,w,o),yD(x,M,u.ratio),this.updateElement(e[h],h,x,i)}}_getStacks(e,t){const{iScale:r}=this._cachedMeta,i=r.getMatchingVisibleMetas(this._type).filter(l=>l.controller.options.grouped),s=r.options.stacked,o=[],a=l=>{const c=l.controller.getParsed(t),u=c&&c[l.vScale.axis];if(Be(u)||isNaN(u))return!0};for(const l of i)if(!(t!==void 0&&a(l))&&((s===!1||o.indexOf(l.stack)===-1||s===void 0&&l.stack===void 0)&&o.push(l.stack),l.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,r){const i=this._getStacks(e,r),s=t!==void 0?i.indexOf(t):-1;return s===-1?i.length-1:s}_getRuler(){const e=this.options,t=this._cachedMeta,r=t.iScale,i=[];let s,o;for(s=0,o=t.data.length;s<o;++s)i.push(r.getPixelForValue(this.getParsed(s)[r.axis],s));const a=e.barThickness;return{min:a||uD(t),pixels:i,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:a?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:r,index:i},options:{base:s,minBarLength:o}}=this,a=s||0,l=this.getParsed(e),c=l._custom,u=wf(c);let d=l[t.axis],f=0,h=r?this.applyStack(t,l,r):d,p,m;h!==d&&(f=h-d,h=d),u&&(d=c.barStart,h=c.barEnd-c.barStart,d!==0&&mr(d)!==mr(c.barEnd)&&(f=0),f+=d);const g=!Be(s)&&!u?s:f;let w=t.getPixelForValue(g);if(this.chart.getDataVisibility(e)?p=t.getPixelForValue(f+h):p=w,m=p-w,Math.abs(m)<o){m=pD(m,t,a)*o,d===a&&(w-=m/2);const x=t.getPixelForDecimal(0),M=t.getPixelForDecimal(1),b=Math.min(x,M),C=Math.max(x,M);w=Math.max(Math.min(w,C),b),p=w+m,r&&!u&&(l._stacks[t.axis]._visualValues[i]=t.getValueForPixel(p)-t.getValueForPixel(w))}if(w===t.getPixelForValue(a)){const x=mr(m)*t.getLineWidthForValue(a)/2;w+=x,m-=x}return{size:m,base:w,head:p,center:p+m/2}}_calculateBarIndexPixels(e,t){const r=t.scale,i=this.options,s=i.skipNull,o=Ce(i.maxBarThickness,1/0);let a,l;if(t.grouped){const c=s?this._getStackCount(e):t.stackCount,u=i.barThickness==="flex"?fD(e,t,i,c):dD(e,t,i,c),d=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0);a=u.start+u.chunk*d+u.chunk/2,l=Math.min(o,u.chunk*u.ratio)}else a=r.getPixelForValue(this.getParsed(e)[r.axis],e),l=Math.min(o,t.min*t.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this._cachedMeta,t=e.vScale,r=e.data,i=r.length;let s=0;for(;s<i;++s)this.getParsed(s)[t.axis]!==null&&r[s].draw(this._ctx)}}se(Ac,"id","bar"),se(Ac,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),se(Ac,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class Pc extends Gn{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,r,i){const s=super.parsePrimitiveData(e,t,r,i);for(let o=0;o<s.length;o++)s[o]._custom=this.resolveDataElementOptions(o+r).radius;return s}parseArrayData(e,t,r,i){const s=super.parseArrayData(e,t,r,i);for(let o=0;o<s.length;o++){const a=t[r+o];s[o]._custom=Ce(a[2],this.resolveDataElementOptions(o+r).radius)}return s}parseObjectData(e,t,r,i){const s=super.parseObjectData(e,t,r,i);for(let o=0;o<s.length;o++){const a=t[r+o];s[o]._custom=Ce(a&&a.r&&+a.r,this.resolveDataElementOptions(o+r).radius)}return s}getMaxOverflow(){const e=this._cachedMeta.data;let t=0;for(let r=e.length-1;r>=0;--r)t=Math.max(t,e[r].size(this.resolveDataElementOptions(r))/2);return t>0&&t}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart.data.labels||[],{xScale:i,yScale:s}=t,o=this.getParsed(e),a=i.getLabelForValue(o.x),l=s.getLabelForValue(o.y),c=o._custom;return{label:r[e]||"",value:"("+a+", "+l+(c?", "+c:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(e,t,r,i){const s=i==="reset",{iScale:o,vScale:a}=this._cachedMeta,{sharedOptions:l,includeOptions:c}=this._getSharedOptions(t,i),u=o.axis,d=a.axis;for(let f=t;f<t+r;f++){const h=e[f],p=!s&&this.getParsed(f),m={},g=m[u]=s?o.getPixelForDecimal(.5):o.getPixelForValue(p[u]),w=m[d]=s?a.getBasePixel():a.getPixelForValue(p[d]);m.skip=isNaN(g)||isNaN(w),c&&(m.options=l||this.resolveDataElementOptions(f,h.active?"active":i),s&&(m.options.radius=0)),this.updateElement(h,f,m,i)}}resolveDataElementOptions(e,t){const r=this.getParsed(e);let i=super.resolveDataElementOptions(e,t);i.$shared&&(i=Object.assign({},i,{$shared:!1}));const s=i.radius;return t!=="active"&&(i.radius=0),i.radius+=Ce(r&&r._custom,s),i}}se(Pc,"id","bubble"),se(Pc,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),se(Pc,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function bD(n,e,t){let r=1,i=1,s=0,o=0;if(e<st){const a=n,l=a+e,c=Math.cos(a),u=Math.sin(a),d=Math.cos(l),f=Math.sin(l),h=(M,b,C)=>ol(M,a,l,!0)?1:Math.max(b,b*t,C,C*t),p=(M,b,C)=>ol(M,a,l,!0)?-1:Math.min(b,b*t,C,C*t),m=h(0,c,d),g=h(gt,u,f),w=p(at,c,d),x=p(at+gt,u,f);r=(m-w)/2,i=(g-x)/2,s=-(m+w)/2,o=-(g+x)/2}return{ratioX:r,ratioY:i,offsetX:s,offsetY:o}}class ms extends Gn{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const r=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=r;else{let s=l=>+r[l];if(Ee(r[e])){const{key:l="value"}=this._parsing;s=c=>+Ai(r[c],l)}let o,a;for(o=e,a=e+t;o<a;++o)i._parsed[o]=s(o)}}_getRotation(){return Yn(this.options.rotation-90)}_getCircumference(){return Yn(this.options.circumference)}_getRotationExtents(){let e=st,t=-st;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const i=this.chart.getDatasetMeta(r).controller,s=i._getRotation(),o=i._getCircumference();e=Math.min(e,s),t=Math.max(t,s+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:r}=t,i=this._cachedMeta,s=i.data,o=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,a=Math.max((Math.min(r.width,r.height)-o)/2,0),l=Math.min(P$(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:u,rotation:d}=this._getRotationExtents(),{ratioX:f,ratioY:h,offsetX:p,offsetY:m}=bD(d,u,l),g=(r.width-o)/f,w=(r.height-o)/h,x=Math.max(Math.min(g,w)/2,0),M=lw(this.options.radius,x),b=Math.max(M*l,0),C=(M-b)/this._getVisibleDatasetWeightTotal();this.offsetX=p*M,this.offsetY=m*M,i.total=this.calculateTotal(),this.outerRadius=M-C*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-C*c,0),this.updateElements(s,0,s.length,e)}_circumference(e,t){const r=this.options,i=this._cachedMeta,s=this._getCircumference();return t&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||i._parsed[e]===null||i.data[e].hidden?0:this.calculateCircumference(i._parsed[e]*s/st)}updateElements(e,t,r,i){const s=i==="reset",o=this.chart,a=o.chartArea,c=o.options.animation,u=(a.left+a.right)/2,d=(a.top+a.bottom)/2,f=s&&c.animateScale,h=f?0:this.innerRadius,p=f?0:this.outerRadius,{sharedOptions:m,includeOptions:g}=this._getSharedOptions(t,i);let w=this._getRotation(),x;for(x=0;x<t;++x)w+=this._circumference(x,s);for(x=t;x<t+r;++x){const M=this._circumference(x,s),b=e[x],C={x:u+this.offsetX,y:d+this.offsetY,startAngle:w,endAngle:w+M,circumference:M,outerRadius:p,innerRadius:h};g&&(C.options=m||this.resolveDataElementOptions(x,b.active?"active":i)),w+=M,this.updateElement(b,x,C,i)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let r=0,i;for(i=0;i<t.length;i++){const s=e._parsed[i];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(i)&&!t[i].hidden&&(r+=Math.abs(s))}return r}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?st*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart,i=r.data.labels||[],s=El(t._parsed[e],r.options.locale);return{label:i[e]||"",value:s}}getMaxBorderWidth(e){let t=0;const r=this.chart;let i,s,o,a,l;if(!e){for(i=0,s=r.data.datasets.length;i<s;++i)if(r.isDatasetVisible(i)){o=r.getDatasetMeta(i),e=o.data,a=o.controller;break}}if(!e)return 0;for(i=0,s=e.length;i<s;++i)l=a.resolveDataElementOptions(i),l.borderAlign!=="inner"&&(t=Math.max(t,l.borderWidth||0,l.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let r=0,i=e.length;r<i;++r){const s=this.resolveDataElementOptions(r);t=Math.max(t,s.offset||0,s.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(t+=this._getRingWeight(r));return t}_getRingWeight(e){return Math.max(Ce(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}se(ms,"id","doughnut"),se(ms,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),se(ms,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"}),se(ms,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:r,color:i}}=e.legend.options;return t.labels.map((s,o)=>{const l=e.getDatasetMeta(0).controller.getStyle(o);return{text:s,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:i,lineWidth:l.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,t,r){r.chart.toggleDataVisibility(t.index),r.chart.update()}}}});class Nc extends Gn{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:r,data:i=[],_dataset:s}=t,o=this.chart._animationsDisabled;let{start:a,count:l}=gw(t,i,o);this._drawStart=a,this._drawCount=l,vw(t)&&(a=0,l=i.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!s._decimated,r.points=i;const c=this.resolveDatasetElementOptions(e);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(r,void 0,{animated:!o,options:c},e),this.updateElements(i,a,l,e)}updateElements(e,t,r,i){const s=i==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:d}=this._getSharedOptions(t,i),f=o.axis,h=a.axis,{spanGaps:p,segment:m}=this.options,g=So(p)?p:Number.POSITIVE_INFINITY,w=this.chart._animationsDisabled||s||i==="none",x=t+r,M=e.length;let b=t>0&&this.getParsed(t-1);for(let C=0;C<M;++C){const k=e[C],$=w?k:{};if(C<t||C>=x){$.skip=!0;continue}const O=this.getParsed(C),D=Be(O[h]),N=$[f]=o.getPixelForValue(O[f],C),B=$[h]=s||D?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,O,l):O[h],C);$.skip=isNaN(N)||isNaN(B)||D,$.stop=C>0&&Math.abs(O[f]-b[f])>g,m&&($.parsed=O,$.raw=c.data[C]),d&&($.options=u||this.resolveDataElementOptions(C,k.active?"active":i)),w||this.updateElement(k,C,$,i),b=O}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,r=t.options&&t.options.borderWidth||0,i=e.data||[];if(!i.length)return r;const s=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(r,s,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}se(Nc,"id","line"),se(Nc,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),se(Nc,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class ja extends Gn{constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart,i=r.data.labels||[],s=El(t._parsed[e].r,r.options.locale);return{label:i[e]||"",value:s}}parseObjectData(e,t,r,i){return Mw.bind(this)(e,t,r,i)}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){const e=this._cachedMeta,t={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((r,i)=>{const s=this.getParsed(i).r;!isNaN(s)&&this.chart.getDataVisibility(i)&&(s<t.min&&(t.min=s),s>t.max&&(t.max=s))}),t}_updateRadius(){const e=this.chart,t=e.chartArea,r=e.options,i=Math.min(t.right-t.left,t.bottom-t.top),s=Math.max(i/2,0),o=Math.max(r.cutoutPercentage?s/100*r.cutoutPercentage:1,0),a=(s-o)/e.getVisibleDatasetCount();this.outerRadius=s-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(e,t,r,i){const s=i==="reset",o=this.chart,l=o.options.animation,c=this._cachedMeta.rScale,u=c.xCenter,d=c.yCenter,f=c.getIndexAngle(0)-.5*at;let h=f,p;const m=360/this.countVisibleElements();for(p=0;p<t;++p)h+=this._computeAngle(p,i,m);for(p=t;p<t+r;p++){const g=e[p];let w=h,x=h+this._computeAngle(p,i,m),M=o.getDataVisibility(p)?c.getDistanceFromCenterForValue(this.getParsed(p).r):0;h=x,s&&(l.animateScale&&(M=0),l.animateRotate&&(w=x=f));const b={x:u,y:d,innerRadius:0,outerRadius:M,startAngle:w,endAngle:x,options:this.resolveDataElementOptions(p,g.active?"active":i)};this.updateElement(g,p,b,i)}}countVisibleElements(){const e=this._cachedMeta;let t=0;return e.data.forEach((r,i)=>{!isNaN(this.getParsed(i).r)&&this.chart.getDataVisibility(i)&&t++}),t}_computeAngle(e,t,r){return this.chart.getDataVisibility(e)?Yn(this.resolveDataElementOptions(e,t).angle||r):0}}se(ja,"id","polarArea"),se(ja,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),se(ja,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:r,color:i}}=e.legend.options;return t.labels.map((s,o)=>{const l=e.getDatasetMeta(0).controller.getStyle(o);return{text:s,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:i,lineWidth:l.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,t,r){r.chart.toggleDataVisibility(t.index),r.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class Nh extends ms{}se(Nh,"id","pie"),se(Nh,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class Rc extends Gn{getLabelAndValue(e){const t=this._cachedMeta.vScale,r=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(r[t.axis])}}parseObjectData(e,t,r,i){return Mw.bind(this)(e,t,r,i)}update(e){const t=this._cachedMeta,r=t.dataset,i=t.data||[],s=t.iScale.getLabels();if(r.points=i,e!=="resize"){const o=this.resolveDatasetElementOptions(e);this.options.showLine||(o.borderWidth=0);const a={_loop:!0,_fullLoop:s.length===i.length,options:o};this.updateElement(r,void 0,a,e)}this.updateElements(i,0,i.length,e)}updateElements(e,t,r,i){const s=this._cachedMeta.rScale,o=i==="reset";for(let a=t;a<t+r;a++){const l=e[a],c=this.resolveDataElementOptions(a,l.active?"active":i),u=s.getPointPositionForValue(a,this.getParsed(a).r),d=o?s.xCenter:u.x,f=o?s.yCenter:u.y,h={x:d,y:f,angle:u.angle,skip:isNaN(d)||isNaN(f),options:c};this.updateElement(l,a,h,i)}}}se(Rc,"id","radar"),se(Rc,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),se(Rc,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class Lc extends Gn{getLabelAndValue(e){const t=this._cachedMeta,r=this.chart.data.labels||[],{xScale:i,yScale:s}=t,o=this.getParsed(e),a=i.getLabelForValue(o.x),l=s.getLabelForValue(o.y);return{label:r[e]||"",value:"("+a+", "+l+")"}}update(e){const t=this._cachedMeta,{data:r=[]}=t,i=this.chart._animationsDisabled;let{start:s,count:o}=gw(t,r,i);if(this._drawStart=s,this._drawCount=o,vw(t)&&(s=0,o=r.length),this.options.showLine){const{dataset:a,_dataset:l}=t;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!l._decimated,a.points=r;const c=this.resolveDatasetElementOptions(e);c.segment=this.options.segment,this.updateElement(a,void 0,{animated:!i,options:c},e)}this.updateElements(r,s,o,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,t,r,i){const s=i==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,u=this.resolveDataElementOptions(t,i),d=this.getSharedOptions(u),f=this.includeOptions(i,d),h=o.axis,p=a.axis,{spanGaps:m,segment:g}=this.options,w=So(m)?m:Number.POSITIVE_INFINITY,x=this.chart._animationsDisabled||s||i==="none";let M=t>0&&this.getParsed(t-1);for(let b=t;b<t+r;++b){const C=e[b],k=this.getParsed(b),$=x?C:{},O=Be(k[p]),D=$[h]=o.getPixelForValue(k[h],b),N=$[p]=s||O?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,k,l):k[p],b);$.skip=isNaN(D)||isNaN(N)||O,$.stop=b>0&&Math.abs(k[h]-M[h])>w,g&&($.parsed=k,$.raw=c.data[b]),f&&($.options=d||this.resolveDataElementOptions(b,C.active?"active":i)),x||this.updateElement(C,b,$,i),M=k}this.updateSharedOptions(d,i,u)}getMaxOverflow(){const e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){let a=0;for(let l=t.length-1;l>=0;--l)a=Math.max(a,t[l].size(this.resolveDataElementOptions(l))/2);return a>0&&a}const r=e.dataset,i=r.options&&r.options.borderWidth||0;if(!t.length)return i;const s=t[0].size(this.resolveDataElementOptions(0)),o=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(i,s,o)/2}}se(Lc,"id","scatter"),se(Lc,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),se(Lc,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var wD=Object.freeze({__proto__:null,BarController:Ac,BubbleController:Pc,DoughnutController:ms,LineController:Nc,PolarAreaController:ja,PieController:Nh,RadarController:Rc,ScatterController:Lc});function Xi(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class lm{static override(e){Object.assign(lm.prototype,e)}constructor(e){this.options=e||{}}init(){}formats(){return Xi()}parse(){return Xi()}format(){return Xi()}add(){return Xi()}diff(){return Xi()}startOf(){return Xi()}endOf(){return Xi()}}var _D={_date:lm};function kD(n,e,t,r){const{controller:i,data:s,_sorted:o}=n,a=i._cachedMeta.iScale;if(a&&e===a.axis&&e!=="r"&&o&&s.length){const l=a._reversePixels?U$:Br;if(r){if(i._sharedOptions){const c=s[0],u=typeof c.getRange=="function"&&c.getRange(e);if(u){const d=l(s,e,t-u),f=l(s,e,t+u);return{lo:d.lo,hi:f.hi}}}}else return l(s,e,t)}return{lo:0,hi:s.length-1}}function Al(n,e,t,r,i){const s=n.getSortedVisibleDatasetMetas(),o=t[e];for(let a=0,l=s.length;a<l;++a){const{index:c,data:u}=s[a],{lo:d,hi:f}=kD(s[a],e,o,i);for(let h=d;h<=f;++h){const p=u[h];p.skip||r(p,c,h)}}}function xD(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(r,i){const s=e?Math.abs(r.x-i.x):0,o=t?Math.abs(r.y-i.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function _f(n,e,t,r,i){const s=[];return!i&&!n.isPointInArea(e)||Al(n,t,e,function(a,l,c){!i&&!al(a,n.chartArea,0)||a.inRange(e.x,e.y,r)&&s.push({element:a,datasetIndex:l,index:c})},!0),s}function CD(n,e,t,r){let i=[];function s(o,a,l){const{startAngle:c,endAngle:u}=o.getProps(["startAngle","endAngle"],r),{angle:d}=dw(o,{x:e.x,y:e.y});ol(d,c,u)&&i.push({element:o,datasetIndex:a,index:l})}return Al(n,t,e,s),i}function SD(n,e,t,r,i,s){let o=[];const a=xD(t);let l=Number.POSITIVE_INFINITY;function c(u,d,f){const h=u.inRange(e.x,e.y,i);if(r&&!h)return;const p=u.getCenterPoint(i);if(!(!!s||n.isPointInArea(p))&&!h)return;const g=a(e,p);g<l?(o=[{element:u,datasetIndex:d,index:f}],l=g):g===l&&o.push({element:u,datasetIndex:d,index:f})}return Al(n,t,e,c),o}function kf(n,e,t,r,i,s){return!s&&!n.isPointInArea(e)?[]:t==="r"&&!r?CD(n,e,t,i):SD(n,e,t,r,i,s)}function ry(n,e,t,r,i){const s=[],o=t==="x"?"inXRange":"inYRange";let a=!1;return Al(n,t,e,(l,c,u)=>{l[o](e[t],i)&&(s.push({element:l,datasetIndex:c,index:u}),a=a||l.inRange(e.x,e.y,i))}),r&&!a?[]:s}var MD={evaluateInteractionItems:Al,modes:{index(n,e,t,r){const i=Zi(e,n),s=t.axis||"x",o=t.includeInvisible||!1,a=t.intersect?_f(n,i,s,r,o):kf(n,i,s,!1,r,o),l=[];return a.length?(n.getSortedVisibleDatasetMetas().forEach(c=>{const u=a[0].index,d=c.data[u];d&&!d.skip&&l.push({element:d,datasetIndex:c.index,index:u})}),l):[]},dataset(n,e,t,r){const i=Zi(e,n),s=t.axis||"xy",o=t.includeInvisible||!1;let a=t.intersect?_f(n,i,s,r,o):kf(n,i,s,!1,r,o);if(a.length>0){const l=a[0].datasetIndex,c=n.getDatasetMeta(l).data;a=[];for(let u=0;u<c.length;++u)a.push({element:c[u],datasetIndex:l,index:u})}return a},point(n,e,t,r){const i=Zi(e,n),s=t.axis||"xy",o=t.includeInvisible||!1;return _f(n,i,s,r,o)},nearest(n,e,t,r){const i=Zi(e,n),s=t.axis||"xy",o=t.includeInvisible||!1;return kf(n,i,s,t.intersect,r,o)},x(n,e,t,r){const i=Zi(e,n);return ry(n,i,"x",t.intersect,r)},y(n,e,t,r){const i=Zi(e,n);return ry(n,i,"y",t.intersect,r)}}};const Iw=["left","top","right","bottom"];function na(n,e){return n.filter(t=>t.pos===e)}function iy(n,e){return n.filter(t=>Iw.indexOf(t.pos)===-1&&t.box.axis===e)}function ra(n,e){return n.sort((t,r)=>{const i=e?r:t,s=e?t:r;return i.weight===s.weight?i.index-s.index:i.weight-s.weight})}function TD(n){const e=[];let t,r,i,s,o,a;for(t=0,r=(n||[]).length;t<r;++t)i=n[t],{position:s,options:{stack:o,stackWeight:a=1}}=i,e.push({index:t,box:i,pos:s,horizontal:i.isHorizontal(),weight:i.weight,stack:o&&s+o,stackWeight:a});return e}function OD(n){const e={};for(const t of n){const{stack:r,pos:i,stackWeight:s}=t;if(!r||!Iw.includes(i))continue;const o=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return e}function $D(n,e){const t=OD(n),{vBoxMaxWidth:r,hBoxMaxHeight:i}=e;let s,o,a;for(s=0,o=n.length;s<o;++s){a=n[s];const{fullSize:l}=a.box,c=t[a.stack],u=c&&a.stackWeight/c.weight;a.horizontal?(a.width=u?u*r:l&&e.availableWidth,a.height=i):(a.width=r,a.height=u?u*i:l&&e.availableHeight)}return t}function DD(n){const e=TD(n),t=ra(e.filter(c=>c.box.fullSize),!0),r=ra(na(e,"left"),!0),i=ra(na(e,"right")),s=ra(na(e,"top"),!0),o=ra(na(e,"bottom")),a=iy(e,"x"),l=iy(e,"y");return{fullSize:t,leftAndTop:r.concat(s),rightAndBottom:i.concat(l).concat(o).concat(a),chartArea:na(e,"chartArea"),vertical:r.concat(i).concat(l),horizontal:s.concat(o).concat(a)}}function sy(n,e,t,r){return Math.max(n[t],e[t])+Math.max(n[r],e[r])}function zw(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function ED(n,e,t,r){const{pos:i,box:s}=t,o=n.maxPadding;if(!Ee(i)){t.size&&(n[i]-=t.size);const d=r[t.stack]||{size:0,count:1};d.size=Math.max(d.size,t.horizontal?s.height:s.width),t.size=d.size/d.count,n[i]+=t.size}s.getPadding&&zw(o,s.getPadding());const a=Math.max(0,e.outerWidth-sy(o,n,"left","right")),l=Math.max(0,e.outerHeight-sy(o,n,"top","bottom")),c=a!==n.w,u=l!==n.h;return n.w=a,n.h=l,t.horizontal?{same:c,other:u}:{same:u,other:c}}function AD(n){const e=n.maxPadding;function t(r){const i=Math.max(e[r]-n[r],0);return n[r]+=i,i}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function PD(n,e){const t=e.maxPadding;function r(i){const s={left:0,top:0,right:0,bottom:0};return i.forEach(o=>{s[o]=Math.max(e[o],t[o])}),s}return r(n?["left","right"]:["top","bottom"])}function fa(n,e,t,r){const i=[];let s,o,a,l,c,u;for(s=0,o=n.length,c=0;s<o;++s){a=n[s],l=a.box,l.update(a.width||e.w,a.height||e.h,PD(a.horizontal,e));const{same:d,other:f}=ED(e,t,a,r);c|=d&&i.length,u=u||f,l.fullSize||i.push(a)}return c&&fa(i,e,t,r)||u}function uc(n,e,t,r,i){n.top=t,n.left=e,n.right=e+r,n.bottom=t+i,n.width=r,n.height=i}function oy(n,e,t,r){const i=t.padding;let{x:s,y:o}=e;for(const a of n){const l=a.box,c=r[a.stack]||{count:1,placed:0,weight:1},u=a.stackWeight/c.weight||1;if(a.horizontal){const d=e.w*u,f=c.size||l.height;Nn(c.start)&&(o=c.start),l.fullSize?uc(l,i.left,o,t.outerWidth-i.right-i.left,f):uc(l,e.left+c.placed,o,d,f),c.start=o,c.placed+=d,o=l.bottom}else{const d=e.h*u,f=c.size||l.width;Nn(c.start)&&(s=c.start),l.fullSize?uc(l,s,i.top,f,t.outerHeight-i.bottom-i.top):uc(l,s,e.top+c.placed,f,d),c.start=s,c.placed+=d,s=l.right}}e.x=s,e.y=o}var jt={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,r){if(!n)return;const i=Yt(n.options.layout.padding),s=Math.max(e-i.width,0),o=Math.max(t-i.height,0),a=DD(n.boxes),l=a.vertical,c=a.horizontal;Je(n.boxes,m=>{typeof m.beforeLayout=="function"&&m.beforeLayout()});const u=l.reduce((m,g)=>g.box.options&&g.box.options.display===!1?m:m+1,0)||1,d=Object.freeze({outerWidth:e,outerHeight:t,padding:i,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/u,hBoxMaxHeight:o/2}),f=Object.assign({},i);zw(f,Yt(r));const h=Object.assign({maxPadding:f,w:s,h:o,x:i.left,y:i.top},i),p=$D(l.concat(c),d);fa(a.fullSize,h,d,p),fa(l,h,d,p),fa(c,h,d,p)&&fa(l,h,d,p),AD(h),oy(a.leftAndTop,h,d,p),h.x+=h.w,h.y+=h.h,oy(a.rightAndBottom,h,d,p),n.chartArea={left:h.left,top:h.top,right:h.left+h.w,bottom:h.top+h.h,height:h.h,width:h.w},Je(a.chartArea,m=>{const g=m.box;Object.assign(g,n.chartArea),g.update(h.w,h.h,{left:0,top:0,right:0,bottom:0})})}};class Bw{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,r){}removeEventListener(e,t,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,r,i){return t=Math.max(0,t||e.width),r=r||e.height,{width:t,height:Math.max(0,i?Math.floor(t/i):r)}}isAttached(e){return!0}updateConfig(e){}}class ND extends Bw{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Ic="$chartjs",RD={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},ay=n=>n===null||n==="";function LD(n,e){const t=n.style,r=n.getAttribute("height"),i=n.getAttribute("width");if(n[Ic]={initial:{height:r,width:i,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",ay(i)){const s=Wv(n,"width");s!==void 0&&(n.width=s)}if(ay(r))if(n.style.height==="")n.height=n.width/(e||2);else{const s=Wv(n,"height");s!==void 0&&(n.height=s)}return n}const Fw=z5?{passive:!0}:!1;function ID(n,e,t){n.addEventListener(e,t,Fw)}function zD(n,e,t){n.canvas.removeEventListener(e,t,Fw)}function BD(n,e){const t=RD[n.type]||n.type,{x:r,y:i}=Zi(n,e);return{type:t,chart:e,native:n,x:r!==void 0?r:null,y:i!==void 0?i:null}}function zu(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function FD(n,e,t){const r=n.canvas,i=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||zu(a.addedNodes,r),o=o&&!zu(a.removedNodes,r);o&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}function VD(n,e,t){const r=n.canvas,i=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||zu(a.removedNodes,r),o=o&&!zu(a.addedNodes,r);o&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}const cl=new Map;let ly=0;function Vw(){const n=window.devicePixelRatio;n!==ly&&(ly=n,cl.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function HD(n,e){cl.size||window.addEventListener("resize",Vw),cl.set(n,e)}function WD(n){cl.delete(n),cl.size||window.removeEventListener("resize",Vw)}function jD(n,e,t){const r=n.canvas,i=r&&am(r);if(!i)return;const s=mw((a,l)=>{const c=i.clientWidth;t(a,l),c<i.clientWidth&&t()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||s(c,u)});return o.observe(i),HD(n,s),o}function xf(n,e,t){t&&t.disconnect(),e==="resize"&&WD(n)}function UD(n,e,t){const r=n.canvas,i=mw(s=>{n.ctx!==null&&t(BD(s,n))},n);return ID(r,e,i),i}class qD extends Bw{acquireContext(e,t){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(LD(e,t),r):null}releaseContext(e){const t=e.canvas;if(!t[Ic])return!1;const r=t[Ic].initial;["height","width"].forEach(s=>{const o=r[s];Be(o)?t.removeAttribute(s):t.setAttribute(s,o)});const i=r.style||{};return Object.keys(i).forEach(s=>{t.style[s]=i[s]}),t.width=t.width,delete t[Ic],!0}addEventListener(e,t,r){this.removeEventListener(e,t);const i=e.$proxies||(e.$proxies={}),o={attach:FD,detach:VD,resize:jD}[t]||UD;i[t]=o(e,t,r)}removeEventListener(e,t){const r=e.$proxies||(e.$proxies={}),i=r[t];if(!i)return;({attach:xf,detach:xf,resize:xf}[t]||zD)(e,t,i),r[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,r,i){return I5(e,t,r,i)}isAttached(e){const t=am(e);return!!(t&&t.isConnected)}}function YD(n){return!Ow()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?ND:qD}var $c;let Ur=($c=class{constructor(){se(this,"active",!1)}tooltipPosition(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}hasValue(){return So(this.x)&&So(this.y)}getProps(e,t){const r=this.$animations;if(!t||!r)return this;const i={};return e.forEach(s=>{i[s]=r[s]&&r[s].active()?r[s]._to:this[s]}),i}},se($c,"defaults",{}),se($c,"defaultRoutes"),$c);function KD(n,e){const t=n.options.ticks,r=GD(n),i=Math.min(t.maxTicksLimit||r,r),s=t.major.enabled?JD(e):[],o=s.length,a=s[0],l=s[o-1],c=[];if(o>i)return ZD(e,c,s,o/i),c;const u=XD(s,e,i);if(o>0){let d,f;const h=o>1?Math.round((l-a)/(o-1)):null;for(dc(e,c,u,Be(h)?0:a-h,a),d=0,f=o-1;d<f;d++)dc(e,c,u,s[d],s[d+1]);return dc(e,c,u,l,Be(h)?e.length:l+h),c}return dc(e,c,u),c}function GD(n){const e=n.options.offset,t=n._tickSize(),r=n._length/t+(e?0:1),i=n._maxLength/t;return Math.floor(Math.min(r,i))}function XD(n,e,t){const r=QD(n),i=e.length/t;if(!r)return Math.max(i,1);const s=V$(r);for(let o=0,a=s.length-1;o<a;o++){const l=s[o];if(l>i)return l}return Math.max(i,1)}function JD(n){const e=[];let t,r;for(t=0,r=n.length;t<r;t++)n[t].major&&e.push(t);return e}function ZD(n,e,t,r){let i=0,s=t[0],o;for(r=Math.ceil(r),o=0;o<n.length;o++)o===s&&(e.push(n[o]),i++,s=t[i*r])}function dc(n,e,t,r,i){const s=Ce(r,0),o=Math.min(Ce(i,n.length),n.length);let a=0,l,c,u;for(t=Math.ceil(t),i&&(l=i-r,t=l/Math.floor(l/t)),u=s;u<0;)a++,u=Math.round(s+a*t);for(c=Math.max(s,0);c<o;c++)c===u&&(e.push(n[c]),a++,u=Math.round(s+a*t))}function QD(n){const e=n.length;let t,r;if(e<2)return!1;for(r=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==r)return!1;return r}const eE=n=>n==="left"?"right":n==="right"?"left":n,cy=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,uy=(n,e)=>Math.min(e||n,n);function dy(n,e){const t=[],r=n.length/e,i=n.length;let s=0;for(;s<i;s+=r)t.push(n[Math.floor(s)]);return t}function tE(n,e,t){const r=n.ticks.length,i=Math.min(e,r-1),s=n._startPixel,o=n._endPixel,a=1e-6;let l=n.getPixelForTick(i),c;if(!(t&&(r===1?c=Math.max(l-s,o-l):e===0?c=(n.getPixelForTick(1)-l)/2:c=(l-n.getPixelForTick(i-1))/2,l+=i<e?c:-c,l<s-a||l>o+a)))return l}function nE(n,e){Je(n,t=>{const r=t.gc,i=r.length/2;let s;if(i>e){for(s=0;s<i;++s)delete t.data[r[s]];r.splice(0,i)}})}function ia(n){return n.drawTicks?n.tickLength:0}function fy(n,e){if(!n.display)return 0;const t=$t(n.font,e),r=Yt(n.padding);return(rt(n.text)?n.text.length:1)*t.lineHeight+r.height}function rE(n,e){return Ii(n,{scale:e,type:"scale"})}function iE(n,e,t){return Ii(n,{tick:t,index:e,type:"tick"})}function sE(n,e,t){let r=nm(n);return(t&&e!=="right"||!t&&e==="right")&&(r=eE(r)),r}function oE(n,e,t,r){const{top:i,left:s,bottom:o,right:a,chart:l}=n,{chartArea:c,scales:u}=l;let d=0,f,h,p;const m=o-i,g=a-s;if(n.isHorizontal()){if(h=Vt(r,s,a),Ee(t)){const w=Object.keys(t)[0],x=t[w];p=u[w].getPixelForValue(x)+m-e}else t==="center"?p=(c.bottom+c.top)/2+m-e:p=cy(n,t,e);f=a-s}else{if(Ee(t)){const w=Object.keys(t)[0],x=t[w];h=u[w].getPixelForValue(x)-g+e}else t==="center"?h=(c.left+c.right)/2-g+e:h=cy(n,t,e);p=Vt(r,o,i),d=t==="left"?-gt:gt}return{titleX:h,titleY:p,maxWidth:f,rotation:d}}class Us extends Ur{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:r,_suggestedMax:i}=this;return e=gn(e,Number.POSITIVE_INFINITY),t=gn(t,Number.NEGATIVE_INFINITY),r=gn(r,Number.POSITIVE_INFINITY),i=gn(i,Number.NEGATIVE_INFINITY),{min:gn(e,r),max:gn(t,i),minDefined:mt(e),maxDefined:mt(t)}}getMinMax(e){let{min:t,max:r,minDefined:i,maxDefined:s}=this.getUserBounds(),o;if(i&&s)return{min:t,max:r};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,e),i||(t=Math.min(t,o.min)),s||(r=Math.max(r,o.max));return t=s&&t>r?r:t,r=i&&t>r?t:r,{min:gn(t,gn(r,t)),max:gn(r,gn(t,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){nt(this.options.beforeUpdate,[this])}update(e,t,r){const{beginAtZero:i,grace:s,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=m5(this,s,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?dy(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=KD(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,r;this.isHorizontal()?(t=this.left,r=this.right):(t=this.top,r=this.bottom,e=!e),this._startPixel=t,this._endPixel=r,this._reversePixels=e,this._length=r-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){nt(this.options.afterUpdate,[this])}beforeSetDimensions(){nt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){nt(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),nt(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){nt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let r,i,s;for(r=0,i=e.length;r<i;r++)s=e[r],s.label=nt(t.callback,[s.value,r,e],this)}afterTickToLabelConversion(){nt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){nt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,r=uy(this.ticks.length,e.ticks.maxTicksLimit),i=t.minRotation||0,s=t.maxRotation;let o=i,a,l,c;if(!this._isVisible()||!t.display||i>=s||r<=1||!this.isHorizontal()){this.labelRotation=i;return}const u=this._getLabelSizes(),d=u.widest.width,f=u.highest.height,h=At(this.chart.width-d,0,this.maxWidth);a=e.offset?this.maxWidth/r:h/(r-1),d+6>a&&(a=h/(r-(e.offset?.5:1)),l=this.maxHeight-ia(e.grid)-t.padding-fy(e.title,this.chart.options.font),c=Math.sqrt(d*d+f*f),o=em(Math.min(Math.asin(At((u.highest.height+6)/a,-1,1)),Math.asin(At(l/c,-1,1))-Math.asin(At(f/c,-1,1)))),o=Math.max(i,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){nt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){nt(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:r,title:i,grid:s}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=fy(i,t.options.font);if(a?(e.width=this.maxWidth,e.height=ia(s)+l):(e.height=this.maxHeight,e.width=ia(s)+l),r.display&&this.ticks.length){const{first:c,last:u,widest:d,highest:f}=this._getLabelSizes(),h=r.padding*2,p=Yn(this.labelRotation),m=Math.cos(p),g=Math.sin(p);if(a){const w=r.mirror?0:g*d.width+m*f.height;e.height=Math.min(this.maxHeight,e.height+w+h)}else{const w=r.mirror?0:m*d.width+g*f.height;e.width=Math.min(this.maxWidth,e.width+w+h)}this._calculatePadding(c,u,g,m)}}this._handleMargins(),a?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,r,i){const{ticks:{align:s,padding:o},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,h=0;l?c?(f=i*e.width,h=r*t.height):(f=r*e.height,h=i*t.width):s==="start"?h=t.width:s==="end"?f=e.width:s!=="inner"&&(f=e.width/2,h=t.width/2),this.paddingLeft=Math.max((f-u+o)*this.width/(this.width-u),0),this.paddingRight=Math.max((h-d+o)*this.width/(this.width-d),0)}else{let u=t.height/2,d=e.height/2;s==="start"?(u=0,d=e.height):s==="end"&&(u=t.height,d=0),this.paddingTop=u+o,this.paddingBottom=d+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){nt(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,r;for(t=0,r=e.length;t<r;t++)Be(e[t].label)&&(e.splice(t,1),r--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let r=this.ticks;t<r.length&&(r=dy(r,t)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,r){const{ctx:i,_longestTextCache:s}=this,o=[],a=[],l=Math.floor(t/uy(t,r));let c=0,u=0,d,f,h,p,m,g,w,x,M,b,C;for(d=0;d<t;d+=l){if(p=e[d].label,m=this._resolveTickFontOptions(d),i.font=g=m.string,w=s[g]=s[g]||{data:{},gc:[]},x=m.lineHeight,M=b=0,!Be(p)&&!rt(p))M=Lu(i,w.data,w.gc,M,p),b=x;else if(rt(p))for(f=0,h=p.length;f<h;++f)C=p[f],!Be(C)&&!rt(C)&&(M=Lu(i,w.data,w.gc,M,C),b+=x);o.push(M),a.push(b),c=Math.max(M,c),u=Math.max(b,u)}nE(s,t);const k=o.indexOf(c),$=a.indexOf(u),O=D=>({width:o[D]||0,height:a[D]||0});return{first:O(0),last:O(t-1),widest:O(k),highest:O($),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return j$(this._alignToPixels?Gi(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const r=t[e];return r.$context||(r.$context=iE(this.getContext(),e,r))}return this.$context||(this.$context=rE(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=Yn(this.labelRotation),r=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t)),s=this._getLabelSizes(),o=e.autoSkipPadding||0,a=s?s.widest.width+o:0,l=s?s.highest.height+o:0;return this.isHorizontal()?l*r>a*i?a/r:l/i:l*i<a*r?l/r:a/i}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,r=this.chart,i=this.options,{grid:s,position:o,border:a}=i,l=s.offset,c=this.isHorizontal(),d=this.ticks.length+(l?1:0),f=ia(s),h=[],p=a.setContext(this.getContext()),m=p.display?p.width:0,g=m/2,w=function(ie){return Gi(r,ie,m)};let x,M,b,C,k,$,O,D,N,B,U,le;if(o==="top")x=w(this.bottom),$=this.bottom-f,D=x-g,B=w(e.top)+g,le=e.bottom;else if(o==="bottom")x=w(this.top),B=e.top,le=w(e.bottom)-g,$=x+g,D=this.top+f;else if(o==="left")x=w(this.right),k=this.right-f,O=x-g,N=w(e.left)+g,U=e.right;else if(o==="right")x=w(this.left),N=e.left,U=w(e.right)-g,k=x+g,O=this.left+f;else if(t==="x"){if(o==="center")x=w((e.top+e.bottom)/2+.5);else if(Ee(o)){const ie=Object.keys(o)[0],he=o[ie];x=w(this.chart.scales[ie].getPixelForValue(he))}B=e.top,le=e.bottom,$=x+g,D=$+f}else if(t==="y"){if(o==="center")x=w((e.left+e.right)/2);else if(Ee(o)){const ie=Object.keys(o)[0],he=o[ie];x=w(this.chart.scales[ie].getPixelForValue(he))}k=x-g,O=k-f,N=e.left,U=e.right}const Te=Ce(i.ticks.maxTicksLimit,d),ee=Math.max(1,Math.ceil(d/Te));for(M=0;M<d;M+=ee){const ie=this.getContext(M),he=s.setContext(ie),be=a.setContext(ie),ke=he.lineWidth,ge=he.color,je=be.dash||[],F=be.dashOffset,L=he.tickWidth,I=he.tickColor,Q=he.tickBorderDash||[],ae=he.tickBorderDashOffset;b=tE(this,M,l),b!==void 0&&(C=Gi(r,b,ke),c?k=O=N=U=C:$=D=B=le=C,h.push({tx1:k,ty1:$,tx2:O,ty2:D,x1:N,y1:B,x2:U,y2:le,width:ke,color:ge,borderDash:je,borderDashOffset:F,tickWidth:L,tickColor:I,tickBorderDash:Q,tickBorderDashOffset:ae}))}return this._ticksLength=d,this._borderValue=x,h}_computeLabelItems(e){const t=this.axis,r=this.options,{position:i,ticks:s}=r,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:u,mirror:d}=s,f=ia(r.grid),h=f+u,p=d?-u:h,m=-Yn(this.labelRotation),g=[];let w,x,M,b,C,k,$,O,D,N,B,U,le="middle";if(i==="top")k=this.bottom-p,$=this._getXAxisLabelAlignment();else if(i==="bottom")k=this.top+p,$=this._getXAxisLabelAlignment();else if(i==="left"){const ee=this._getYAxisLabelAlignment(f);$=ee.textAlign,C=ee.x}else if(i==="right"){const ee=this._getYAxisLabelAlignment(f);$=ee.textAlign,C=ee.x}else if(t==="x"){if(i==="center")k=(e.top+e.bottom)/2+h;else if(Ee(i)){const ee=Object.keys(i)[0],ie=i[ee];k=this.chart.scales[ee].getPixelForValue(ie)+h}$=this._getXAxisLabelAlignment()}else if(t==="y"){if(i==="center")C=(e.left+e.right)/2-h;else if(Ee(i)){const ee=Object.keys(i)[0],ie=i[ee];C=this.chart.scales[ee].getPixelForValue(ie)}$=this._getYAxisLabelAlignment(f).textAlign}t==="y"&&(l==="start"?le="top":l==="end"&&(le="bottom"));const Te=this._getLabelSizes();for(w=0,x=a.length;w<x;++w){M=a[w],b=M.label;const ee=s.setContext(this.getContext(w));O=this.getPixelForTick(w)+s.labelOffset,D=this._resolveTickFontOptions(w),N=D.lineHeight,B=rt(b)?b.length:1;const ie=B/2,he=ee.color,be=ee.textStrokeColor,ke=ee.textStrokeWidth;let ge=$;o?(C=O,$==="inner"&&(w===x-1?ge=this.options.reverse?"left":"right":w===0?ge=this.options.reverse?"right":"left":ge="center"),i==="top"?c==="near"||m!==0?U=-B*N+N/2:c==="center"?U=-Te.highest.height/2-ie*N+N:U=-Te.highest.height+N/2:c==="near"||m!==0?U=N/2:c==="center"?U=Te.highest.height/2-ie*N:U=Te.highest.height-B*N,d&&(U*=-1),m!==0&&!ee.showLabelBackdrop&&(C+=N/2*Math.sin(m))):(k=O,U=(1-B)*N/2);let je;if(ee.showLabelBackdrop){const F=Yt(ee.backdropPadding),L=Te.heights[w],I=Te.widths[w];let Q=U-F.top,ae=0-F.left;switch(le){case"middle":Q-=L/2;break;case"bottom":Q-=L;break}switch($){case"center":ae-=I/2;break;case"right":ae-=I;break}je={left:ae,top:Q,width:I+F.width,height:L+F.height,color:ee.backdropColor}}g.push({label:b,font:D,textOffset:U,options:{rotation:m,color:he,strokeColor:be,strokeWidth:ke,textAlign:ge,textBaseline:le,translation:[C,k],backdrop:je}})}return g}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-Yn(this.labelRotation))return e==="top"?"left":"right";let i="center";return t.align==="start"?i="left":t.align==="end"?i="right":t.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:r,mirror:i,padding:s}}=this.options,o=this._getLabelSizes(),a=e+s,l=o.widest.width;let c,u;return t==="left"?i?(u=this.right+s,r==="near"?c="left":r==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-a,r==="near"?c="right":r==="center"?(c="center",u-=l/2):(c="left",u=this.left)):t==="right"?i?(u=this.left+s,r==="near"?c="right":r==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+a,r==="near"?c="left":r==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:r,top:i,width:s,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(r,i,s,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const i=this.ticks.findIndex(s=>s.value===e);return i>=0?t.setContext(this.getContext(i)).lineWidth:0}drawGrid(e){const t=this.options.grid,r=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,o;const a=(l,c,u)=>{!u.width||!u.color||(r.save(),r.lineWidth=u.width,r.strokeStyle=u.color,r.setLineDash(u.borderDash||[]),r.lineDashOffset=u.borderDashOffset,r.beginPath(),r.moveTo(l.x,l.y),r.lineTo(c.x,c.y),r.stroke(),r.restore())};if(t.display)for(s=0,o=i.length;s<o;++s){const l=i[s];t.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),t.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:r,grid:i}}=this,s=r.setContext(this.getContext()),o=r.display?s.width:0;if(!o)return;const a=i.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,d,f;this.isHorizontal()?(c=Gi(e,this.left,o)-o/2,u=Gi(e,this.right,a)+a/2,d=f=l):(d=Gi(e,this.top,o)-o/2,f=Gi(e,this.bottom,a)+a/2,c=u=l),t.save(),t.lineWidth=s.width,t.strokeStyle=s.color,t.beginPath(),t.moveTo(c,d),t.lineTo(u,f),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const r=this.ctx,i=this._computeLabelArea();i&&Cd(r,i);const s=this.getLabelItems(e);for(const o of s){const a=o.options,l=o.font,c=o.label,u=o.textOffset;Rs(r,c,0,u,l,a)}i&&Sd(r)}drawTitle(){const{ctx:e,options:{position:t,title:r,reverse:i}}=this;if(!r.display)return;const s=$t(r.font),o=Yt(r.padding),a=r.align;let l=s.lineHeight/2;t==="bottom"||t==="center"||Ee(t)?(l+=o.bottom,rt(r.text)&&(l+=s.lineHeight*(r.text.length-1))):l+=o.top;const{titleX:c,titleY:u,maxWidth:d,rotation:f}=oE(this,l,t,a);Rs(e,r.text,0,0,s,{color:r.color,maxWidth:d,rotation:f,textAlign:sE(a,t,i),textBaseline:"middle",translation:[c,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,r=Ce(e.grid&&e.grid.z,-1),i=Ce(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Us.prototype.draw?[{z:t,draw:s=>{this.draw(s)}}]:[{z:r,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:t,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",i=[];let s,o;for(s=0,o=t.length;s<o;++s){const a=t[s];a[r]===this.id&&(!e||a.type===e)&&i.push(a)}return i}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return $t(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class fc{constructor(e,t,r){this.type=e,this.scope=t,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let r;cE(t)&&(r=this.register(t));const i=this.items,s=e.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in i||(i[s]=e,aE(e,o,r),this.override&&bt.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,r=e.id,i=this.scope;r in t&&delete t[r],i&&r in bt[i]&&(delete bt[i][r],this.override&&delete Ns[r])}}function aE(n,e,t){const r=sl(Object.create(null),[t?bt.get(t):{},bt.get(e),n.defaults]);bt.set(e,r),n.defaultRoutes&&lE(e,n.defaultRoutes),n.descriptors&&bt.describe(e,n.descriptors)}function lE(n,e){Object.keys(e).forEach(t=>{const r=t.split("."),i=r.pop(),s=[n].concat(r).join("."),o=e[t].split("."),a=o.pop(),l=o.join(".");bt.route(s,i,l,a)})}function cE(n){return"id"in n&&"defaults"in n}class uE{constructor(){this.controllers=new fc(Gn,"datasets",!0),this.elements=new fc(Ur,"elements"),this.plugins=new fc(Object,"plugins"),this.scales=new fc(Us,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,r){[...t].forEach(i=>{const s=r||this._getRegistryForType(i);r||s.isForType(i)||s===this.plugins&&i.id?this._exec(e,s,i):Je(i,o=>{const a=r||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,t,r){const i=Qp(e);nt(r["before"+i],[],r),t[e](r),nt(r["after"+i],[],r)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const r=this._typedRegistries[t];if(r.isForType(e))return r}return this.plugins}_get(e,t,r){const i=t.get(e);if(i===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return i}}var or=new uE;class dE{constructor(){this._init=[]}notify(e,t,r,i){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const s=i?this._descriptors(e).filter(i):this._descriptors(e),o=this._notify(s,e,t,r);return t==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall")),o}_notify(e,t,r,i){i=i||{};for(const s of e){const o=s.plugin,a=o[r],l=[t,i,s.options];if(nt(a,l,o)===!1&&i.cancelable)return!1}return!0}invalidate(){Be(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const r=e&&e.config,i=Ce(r.options&&r.options.plugins,{}),s=fE(r);return i===!1&&!t?[]:pE(e,s,i,t)}_notifyStateChanges(e){const t=this._oldCache||[],r=this._cache,i=(s,o)=>s.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(i(t,r),e,"stop"),this._notify(i(r,t),e,"start")}}function fE(n){const e={},t=[],r=Object.keys(or.plugins.items);for(let s=0;s<r.length;s++)t.push(or.getPlugin(r[s]));const i=n.plugins||[];for(let s=0;s<i.length;s++){const o=i[s];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function hE(n,e){return!e&&n===!1?null:n===!0?{}:n}function pE(n,{plugins:e,localIds:t},r,i){const s=[],o=n.getContext();for(const a of e){const l=a.id,c=hE(r[l],i);c!==null&&s.push({plugin:a,options:mE(n.config,{plugin:a,local:t[l]},c,o)})}return s}function mE(n,{plugin:e,local:t},r,i){const s=n.pluginScopeKeys(e),o=n.getOptionScopes(r,s);return t&&e.defaults&&o.push(e.defaults),n.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Rh(n,e){const t=bt.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function gE(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function vE(n,e){return n===e?"_index_":"_value_"}function yE(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function Bu(n,e){if(n==="x"||n==="y"||n==="r"||(n=e.axis||yE(e.position)||n.length>1&&Bu(n[0].toLowerCase(),e),n))return n;throw new Error("Cannot determine type of '".concat(name,"' axis. Please provide 'axis' or 'position' option."))}function bE(n,e){const t=Ns[n.type]||{scales:{}},r=e.scales||{},i=Rh(n.type,e),s=Object.create(null);return Object.keys(r).forEach(o=>{const a=r[o];if(!Ee(a))return console.error("Invalid scale configuration for scale: ".concat(o));if(a._proxy)return console.warn("Ignoring resolver passed as options for scale: ".concat(o));const l=Bu(o,a),c=vE(l,i),u=t.scales||{};s[o]=Fa(Object.create(null),[{axis:l},a,u[l],u[c]])}),n.data.datasets.forEach(o=>{const a=o.type||n.type,l=o.indexAxis||Rh(a,e),u=(Ns[a]||{}).scales||{};Object.keys(u).forEach(d=>{const f=gE(d,l),h=o[f+"AxisID"]||f;s[h]=s[h]||Object.create(null),Fa(s[h],[{axis:f},r[h],u[d]])})}),Object.keys(s).forEach(o=>{const a=s[o];Fa(a,[bt.scales[a.type],bt.scale])}),s}function Hw(n){const e=n.options||(n.options={});e.plugins=Ce(e.plugins,{}),e.scales=bE(n,e)}function Ww(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function wE(n){return n=n||{},n.data=Ww(n.data),Hw(n),n}const hy=new Map,jw=new Set;function hc(n,e){let t=hy.get(n);return t||(t=e(),hy.set(n,t),jw.add(t)),t}const sa=(n,e,t)=>{const r=Ai(e,t);r!==void 0&&n.add(r)};class _E{constructor(e){this._config=wE(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Ww(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Hw(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return hc(e,()=>[["datasets.".concat(e),""]])}datasetAnimationScopeKeys(e,t){return hc("".concat(e,".transition.").concat(t),()=>[["datasets.".concat(e,".transitions.").concat(t),"transitions.".concat(t)],["datasets.".concat(e),""]])}datasetElementScopeKeys(e,t){return hc("".concat(e,"-").concat(t),()=>[["datasets.".concat(e,".elements.").concat(t),"datasets.".concat(e),"elements.".concat(t),""]])}pluginScopeKeys(e){const t=e.id,r=this.type;return hc("".concat(r,"-plugin-").concat(t),()=>[["plugins.".concat(t),...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const r=this._scopeCache;let i=r.get(e);return(!i||t)&&(i=new Map,r.set(e,i)),i}getOptionScopes(e,t,r){const{options:i,type:s}=this,o=this._cachedScopes(e,r),a=o.get(t);if(a)return a;const l=new Set;t.forEach(u=>{e&&(l.add(e),u.forEach(d=>sa(l,e,d))),u.forEach(d=>sa(l,i,d)),u.forEach(d=>sa(l,Ns[s]||{},d)),u.forEach(d=>sa(l,bt,d)),u.forEach(d=>sa(l,Ah,d))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),jw.has(t)&&o.set(t,c),c}chartOptionScopes(){const{options:e,type:t}=this;return[e,Ns[t]||{},bt.datasets[t]||{},{type:t},bt,Ah]}resolveNamedOptions(e,t,r,i=[""]){const s={$shared:!0},{resolver:o,subPrefixes:a}=py(this._resolverCache,e,i);let l=o;if(xE(o,t)){s.$shared=!1,r=Pi(r)?r():r;const c=this.createResolver(e,r,a);l=Mo(o,r,c)}for(const c of t)s[c]=l[c];return s}createResolver(e,t,r=[""],i){const{resolver:s}=py(this._resolverCache,e,r);return Ee(t)?Mo(s,t,void 0,i):s}}function py(n,e,t){let r=n.get(e);r||(r=new Map,n.set(e,r));const i=t.join();let s=r.get(i);return s||(s={resolver:im(e,t),subPrefixes:t.filter(a=>!a.toLowerCase().includes("hover"))},r.set(i,s)),s}const kE=n=>Ee(n)&&Object.getOwnPropertyNames(n).reduce((e,t)=>e||Pi(n[t]),!1);function xE(n,e){const{isScriptable:t,isIndexable:r}=kw(n);for(const i of e){const s=t(i),o=r(i),a=(o||s)&&n[i];if(s&&(Pi(a)||kE(a))||o&&rt(a))return!0}return!1}var CE="4.2.1";const SE=["top","bottom","left","right","chartArea"];function my(n,e){return n==="top"||n==="bottom"||SE.indexOf(n)===-1&&e==="x"}function gy(n,e){return function(t,r){return t[n]===r[n]?t[e]-r[e]:t[n]-r[n]}}function vy(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),nt(t&&t.onComplete,[n],e)}function ME(n){const e=n.chart,t=e.options.animation;nt(t&&t.onProgress,[n],e)}function Uw(n){return Ow()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const zc={},yy=n=>{const e=Uw(n);return Object.values(zc).filter(t=>t.canvas===e).pop()};function TE(n,e,t){const r=Object.keys(n);for(const i of r){const s=+i;if(s>=e){const o=n[i];delete n[i],(t>0||s>e)&&(n[s+t]=o)}}}function OE(n,e,t,r){return!t||n.type==="mouseout"?null:r?e:n}function $E(n){const{xScale:e,yScale:t}=n;if(e&&t)return{left:e.left,right:e.right,top:t.top,bottom:t.bottom}}var ei;let cm=(ei=class{static register(...e){or.add(...e),by()}static unregister(...e){or.remove(...e),by()}constructor(e,t){const r=this.config=new _E(t),i=Uw(e),s=yy(i);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const o=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||YD(i)),this.platform.updateConfig(r);const a=this.platform.acquireContext(i,o.aspectRatio),l=a&&a.canvas,c=l&&l.height,u=l&&l.width;if(this.id=A$(),this.ctx=a,this.canvas=l,this.width=u,this.height=c,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new dE,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=K$(d=>this.update(d),o.resizeDelay||0),this._dataChanges=[],zc[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}$r.listen(this,"complete",vy),$r.listen(this,"progress",ME),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:r,height:i,_aspectRatio:s}=this;return Be(e)?t&&s?s:i?r/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return or}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Hv(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Bv(this.canvas,this.ctx),this}stop(){return $r.stop(this),this}resize(e,t){$r.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const r=this.options,i=this.canvas,s=r.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(i,e,t,s),a=r.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,Hv(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),nt(r.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};Je(t,(r,i)=>{r.id=i})}buildOrUpdateScales(){const e=this.options,t=e.scales,r=this.scales,i=Object.keys(r).reduce((o,a)=>(o[a]=!1,o),{});let s=[];t&&(s=s.concat(Object.keys(t).map(o=>{const a=t[o],l=Bu(o,a),c=l==="r",u=l==="x";return{options:a,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),Je(s,o=>{const a=o.options,l=a.id,c=Bu(l,a),u=Ce(a.type,o.dtype);(a.position===void 0||my(a.position,c)!==my(o.dposition))&&(a.position=o.dposition),i[l]=!0;let d=null;if(l in r&&r[l].type===u)d=r[l];else{const f=or.getScale(u);d=new f({id:l,type:u,ctx:this.ctx,chart:this}),r[d.id]=d}d.init(a,e)}),Je(i,(o,a)=>{o||delete r[a]}),Je(r,o=>{jt.configure(this,o,o.options),jt.addBox(this,o)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,r=e.length;if(e.sort((i,s)=>i.index-s.index),r>t){for(let i=t;i<r;++i)this._destroyDatasetMeta(i);e.splice(t,r-t)}this._sortedMetasets=e.slice(0).sort(gy("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((r,i)=>{t.filter(s=>s===r._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let r,i;for(this._removeUnreferencedMetasets(),r=0,i=t.length;r<i;r++){const s=t[r];let o=this.getDatasetMeta(r);const a=s.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(r),o=this.getDatasetMeta(r)),o.type=a,o.indexAxis=s.indexAxis||Rh(a,this.options),o.order=s.order||0,o.index=r,o.label=""+s.label,o.visible=this.isDatasetVisible(r),o.controller)o.controller.updateIndex(r),o.controller.linkScales();else{const l=or.getController(a),{datasetElementType:c,dataElementType:u}=bt.datasets[a];Object.assign(l,{dataElementType:or.getElement(u),datasetElementType:c&&or.getElement(c)}),o.controller=new l(this,r),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){Je(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const r=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:d}=this.getDatasetMeta(c),f=!i&&s.indexOf(d)===-1;d.buildOrUpdateElements(f),o=Math.max(+d.getMaxOverflow(),o)}o=this._minPadding=r.layout.autoPadding?o:0,this._updateLayout(o),i||Je(s,c=>{c.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(gy("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){Je(this.scales,e=>{jt.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!Dv(t,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:r,start:i,count:s}of t){const o=r==="_removeElements"?-s:s;TE(e,i,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,r=s=>new Set(e.filter(o=>o[0]===s).map((o,a)=>a+","+o.splice(1).join(","))),i=r(0);for(let s=1;s<t;s++)if(!Dv(i,r(s)))return;return Array.from(i).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;jt.update(this,this.width,this.height,e);const t=this.chartArea,r=t.width<=0||t.height<=0;this._layers=[],Je(this.boxes,i=>{r&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,s)=>{i._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,r=this.data.datasets.length;t<r;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,r=this.data.datasets.length;t<r;++t)this._updateDataset(t,Pi(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const r=this.getDatasetMeta(e),i={meta:r,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(r.controller._update(t),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&($r.has(this)?this.attached&&!$r.running(this)&&$r.start(this):(this.draw(),vy({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:i}=this._resizeBeforeDraw;this._resize(r,i),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,r=[];let i,s;for(i=0,s=t.length;i<s;++i){const o=t[i];(!e||o.visible)&&r.push(o)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,r=e._clip,i=!r.disabled,s=$E(e)||this.chartArea,o={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",o)!==!1&&(i&&Cd(t,{left:r.left===!1?0:s.left-r.left,right:r.right===!1?this.width:s.right+r.right,top:r.top===!1?0:s.top-r.top,bottom:r.bottom===!1?this.height:s.bottom+r.bottom}),e.controller.draw(),i&&Sd(t),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}isPointInArea(e){return al(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,r,i){const s=MD.modes[t];return typeof s=="function"?s(this,e,r,i):[]}getDatasetMeta(e){const t=this.data.datasets[e],r=this._metasets;let i=r.filter(s=>s&&s._dataset===t).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},r.push(i)),i}getContext(){return this.$context||(this.$context=Ii(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!t.hidden}setDatasetVisibility(e,t){const r=this.getDatasetMeta(e);r.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,r){const i=r?"show":"hide",s=this.getDatasetMeta(e),o=s.controller._resolveAnimations(void 0,i);Nn(t)?(s.data[t].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),o.update(s,{visible:r}),this.update(a=>a.datasetIndex===e?i:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),$r.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Bv(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete zc[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,r=(s,o)=>{t.addEventListener(this,s,o),e[s]=o},i=(s,o,a)=>{s.offsetX=o,s.offsetY=a,this._eventHandler(s)};Je(this.options.events,s=>r(s,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,r=(l,c)=>{t.addEventListener(this,l,c),e[l]=c},i=(l,c)=>{e[l]&&(t.removeEventListener(this,l,c),delete e[l])},s=(l,c)=>{this.canvas&&this.resize(l,c)};let o;const a=()=>{i("attach",a),this.attached=!0,this.resize(),r("resize",s),r("detach",o)};o=()=>{this.attached=!1,i("resize",s),this._stop(),this._resize(0,0),r("attach",a)},t.isAttached(this.canvas)?a():o()}unbindEvents(){Je(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},Je(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,r){const i=r?"set":"remove";let s,o,a,l;for(t==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+i+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const c=o&&this.getDatasetMeta(o.datasetIndex).controller;c&&c[i+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],r=e.map(({datasetIndex:s,index:o})=>{const a=this.getDatasetMeta(s);if(!a)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:a.data[o],index:o}});!Pu(r,t)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,t))}notifyPlugins(e,t,r){return this._plugins.notify(this,e,t,r)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,r){const i=this.options.hover,s=(l,c)=>l.filter(u=>!c.some(d=>u.datasetIndex===d.datasetIndex&&u.index===d.index)),o=s(t,e),a=r?e:s(e,t);o.length&&this.updateHoverStyle(o,i.mode,!1),a.length&&i.mode&&this.updateHoverStyle(a,i.mode,!0)}_eventHandler(e,t){const r={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},i=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,i)===!1)return;const s=this._handleEvent(e,t,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,i),(s||r.changed)&&this.render(),this}_handleEvent(e,t,r){const{_active:i=[],options:s}=this,o=t,a=this._getActiveElements(e,i,r,o),l=z$(e),c=OE(e,this._lastEvent,r,l);r&&(this._lastEvent=null,nt(s.onHover,[e,a,this],this),l&&nt(s.onClick,[e,a,this],this));const u=!Pu(a,i);return(u||t)&&(this._active=a,this._updateHoverStyles(a,i,t)),this._lastEvent=c,u}_getActiveElements(e,t,r,i){if(e.type==="mouseout")return[];if(!r)return t;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,i)}},se(ei,"defaults",bt),se(ei,"instances",zc),se(ei,"overrides",Ns),se(ei,"registry",or),se(ei,"version",CE),se(ei,"getChart",yy),ei);function by(){return Je(cm.instances,n=>n._plugins.invalidate())}function DE(n,e,t){const{startAngle:r,pixelMargin:i,x:s,y:o,outerRadius:a,innerRadius:l}=e;let c=i/a;n.beginPath(),n.arc(s,o,a,r-c,t+c),l>i?(c=i/l,n.arc(s,o,l,t+c,r-c,!0)):n.arc(s,o,i,t+gt,r-gt),n.closePath(),n.clip()}function EE(n){return rm(n,["outerStart","outerEnd","innerStart","innerEnd"])}function AE(n,e,t,r){const i=EE(n.options.borderRadius),s=(t-e)/2,o=Math.min(s,r*e/2),a=l=>{const c=(t-Math.min(s,l))*r/2;return At(l,0,Math.min(s,c))};return{outerStart:a(i.outerStart),outerEnd:a(i.outerEnd),innerStart:At(i.innerStart,0,o),innerEnd:At(i.innerEnd,0,o)}}function Gs(n,e,t,r){return{x:t+n*Math.cos(e),y:r+n*Math.sin(e)}}function Fu(n,e,t,r,i,s){const{x:o,y:a,startAngle:l,pixelMargin:c,innerRadius:u}=e,d=Math.max(e.outerRadius+r+t-c,0),f=u>0?u+r+t+c:0;let h=0;const p=i-l;if(r){const ee=u>0?u-r:0,ie=d>0?d-r:0,he=(ee+ie)/2,be=he!==0?p*he/(he+r):p;h=(p-be)/2}const m=Math.max(.001,p*d-t/at)/d,g=(p-m)/2,w=l+g+h,x=i-g-h,{outerStart:M,outerEnd:b,innerStart:C,innerEnd:k}=AE(e,f,d,x-w),$=d-M,O=d-b,D=w+M/$,N=x-b/O,B=f+C,U=f+k,le=w+C/B,Te=x-k/U;if(n.beginPath(),s){const ee=(D+N)/2;if(n.arc(o,a,d,D,ee),n.arc(o,a,d,ee,N),b>0){const ke=Gs(O,N,o,a);n.arc(ke.x,ke.y,b,N,x+gt)}const ie=Gs(U,x,o,a);if(n.lineTo(ie.x,ie.y),k>0){const ke=Gs(U,Te,o,a);n.arc(ke.x,ke.y,k,x+gt,Te+Math.PI)}const he=(x-k/f+(w+C/f))/2;if(n.arc(o,a,f,x-k/f,he,!0),n.arc(o,a,f,he,w+C/f,!0),C>0){const ke=Gs(B,le,o,a);n.arc(ke.x,ke.y,C,le+Math.PI,w-gt)}const be=Gs($,w,o,a);if(n.lineTo(be.x,be.y),M>0){const ke=Gs($,D,o,a);n.arc(ke.x,ke.y,M,w-gt,D)}}else{n.moveTo(o,a);const ee=Math.cos(D)*d+o,ie=Math.sin(D)*d+a;n.lineTo(ee,ie);const he=Math.cos(N)*d+o,be=Math.sin(N)*d+a;n.lineTo(he,be)}n.closePath()}function PE(n,e,t,r,i){const{fullCircles:s,startAngle:o,circumference:a}=e;let l=e.endAngle;if(s){Fu(n,e,t,r,l,i);for(let c=0;c<s;++c)n.fill();isNaN(a)||(l=o+(a%st||st))}return Fu(n,e,t,r,l,i),n.fill(),l}function NE(n,e,t,r,i){const{fullCircles:s,startAngle:o,circumference:a,options:l}=e,{borderWidth:c,borderJoinStyle:u}=l,d=l.borderAlign==="inner";if(!c)return;d?(n.lineWidth=c*2,n.lineJoin=u||"round"):(n.lineWidth=c,n.lineJoin=u||"bevel");let f=e.endAngle;if(s){Fu(n,e,t,r,f,i);for(let h=0;h<s;++h)n.stroke();isNaN(a)||(f=o+(a%st||st))}d&&DE(n,e,f),s||(Fu(n,e,t,r,f,i),n.stroke())}class Bc extends Ur{constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,r){const i=this.getProps(["x","y"],r),{angle:s,distance:o}=dw(i,{x:e,y:t}),{startAngle:a,endAngle:l,innerRadius:c,outerRadius:u,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),f=this.options.spacing/2,p=Ce(d,l-a)>=st||ol(s,a,l),m=zr(o,c+f,u+f);return p&&m}getCenterPoint(e){const{x:t,y:r,startAngle:i,endAngle:s,innerRadius:o,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:l,spacing:c}=this.options,u=(i+s)/2,d=(o+a+c+l)/2;return{x:t+Math.cos(u)*d,y:r+Math.sin(u)*d}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:r}=this,i=(t.offset||0)/4,s=(t.spacing||0)/2,o=t.circular;if(this.pixelMargin=t.borderAlign==="inner"?.33:0,this.fullCircles=r>st?Math.floor(r/st):0,r===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const a=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(a)*i,Math.sin(a)*i);const l=1-Math.sin(Math.min(at,r||0)),c=i*l;e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,PE(e,this,c,s,o),NE(e,this,c,s,o),e.restore()}}se(Bc,"id","arc"),se(Bc,"defaults",{borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),se(Bc,"defaultRoutes",{backgroundColor:"backgroundColor"});function qw(n,e,t=e){n.lineCap=Ce(t.borderCapStyle,e.borderCapStyle),n.setLineDash(Ce(t.borderDash,e.borderDash)),n.lineDashOffset=Ce(t.borderDashOffset,e.borderDashOffset),n.lineJoin=Ce(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=Ce(t.borderWidth,e.borderWidth),n.strokeStyle=Ce(t.borderColor,e.borderColor)}function RE(n,e,t){n.lineTo(t.x,t.y)}function LE(n){return n.stepped?o5:n.tension||n.cubicInterpolationMode==="monotone"?a5:RE}function Yw(n,e,t={}){const r=n.length,{start:i=0,end:s=r-1}=t,{start:o,end:a}=e,l=Math.max(i,o),c=Math.min(s,a),u=i<o&&s<o||i>a&&s>a;return{count:r,start:l,loop:e.loop,ilen:c<l&&!u?r+c-l:c-l}}function IE(n,e,t,r){const{points:i,options:s}=e,{count:o,start:a,loop:l,ilen:c}=Yw(i,t,r),u=LE(s);let{move:d=!0,reverse:f}=r||{},h,p,m;for(h=0;h<=c;++h)p=i[(a+(f?c-h:h))%o],!p.skip&&(d?(n.moveTo(p.x,p.y),d=!1):u(n,m,p,f,s.stepped),m=p);return l&&(p=i[(a+(f?c:0))%o],u(n,m,p,f,s.stepped)),!!l}function zE(n,e,t,r){const i=e.points,{count:s,start:o,ilen:a}=Yw(i,t,r),{move:l=!0,reverse:c}=r||{};let u=0,d=0,f,h,p,m,g,w;const x=b=>(o+(c?a-b:b))%s,M=()=>{m!==g&&(n.lineTo(u,g),n.lineTo(u,m),n.lineTo(u,w))};for(l&&(h=i[x(0)],n.moveTo(h.x,h.y)),f=0;f<=a;++f){if(h=i[x(f)],h.skip)continue;const b=h.x,C=h.y,k=b|0;k===p?(C<m?m=C:C>g&&(g=C),u=(d*u+b)/++d):(M(),n.lineTo(b,C),p=k,d=0,m=g=C),w=C}M()}function Lh(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?zE:IE}function BE(n){return n.stepped?B5:n.tension||n.cubicInterpolationMode==="monotone"?F5:Qi}function FE(n,e,t,r){let i=e._path;i||(i=e._path=new Path2D,e.path(i,t,r)&&i.closePath()),qw(n,e.options),n.stroke(i)}function VE(n,e,t,r){const{segments:i,options:s}=e,o=Lh(e);for(const a of i)qw(n,s,a.style),n.beginPath(),o(n,e,a,{start:t,end:t+r-1})&&n.closePath(),n.stroke()}const HE=typeof Path2D=="function";function WE(n,e,t,r){HE&&!e.options.segment?FE(n,e,t,r):VE(n,e,t,r)}class vi extends Ur{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){const i=r.spanGaps?this._loop:this._fullLoop;E5(this._points,r,e,i,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=q5(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,r=e.length;return r&&t[e[r-1].end]}interpolate(e,t){const r=this.options,i=e[t],s=this.points,o=Pw(this,{property:t,start:i,end:i});if(!o.length)return;const a=[],l=BE(r);let c,u;for(c=0,u=o.length;c<u;++c){const{start:d,end:f}=o[c],h=s[d],p=s[f];if(h===p){a.push(h);continue}const m=Math.abs((i-h[t])/(p[t]-h[t])),g=l(h,p,m,r.stepped);g[t]=e[t],a.push(g)}return a.length===1?a[0]:a}pathSegment(e,t,r){return Lh(this)(e,this,t,r)}path(e,t,r){const i=this.segments,s=Lh(this);let o=this._loop;t=t||0,r=r||this.points.length-t;for(const a of i)o&=s(e,this,a,{start:t,end:t+r-1});return!!o}draw(e,t,r,i){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),WE(e,this,r,i),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}se(vi,"id","line"),se(vi,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),se(vi,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),se(vi,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function wy(n,e,t,r){const i=n.options,{[t]:s}=n.getProps([t],r);return Math.abs(e-s)<i.radius+i.hitRadius}class Fc extends Ur{constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,r){const i=this.options,{x:s,y:o}=this.getProps(["x","y"],r);return Math.pow(e-s,2)+Math.pow(t-o,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(e,t){return wy(this,e,"x",t)}inYRange(e,t){return wy(this,e,"y",t)}getCenterPoint(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}size(e){e=e||this.options||{};let t=e.radius||0;t=Math.max(t,t&&e.hoverRadius||0);const r=t&&e.borderWidth||0;return(t+r)*2}draw(e,t){const r=this.options;this.skip||r.radius<.1||!al(this,t,this.size(r)/2)||(e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.fillStyle=r.backgroundColor,Ph(e,r,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}se(Fc,"id","point"),se(Fc,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),se(Fc,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function Kw(n,e){const{x:t,y:r,base:i,width:s,height:o}=n.getProps(["x","y","base","width","height"],e);let a,l,c,u,d;return n.horizontal?(d=o/2,a=Math.min(t,i),l=Math.max(t,i),c=r-d,u=r+d):(d=s/2,a=t-d,l=t+d,c=Math.min(r,i),u=Math.max(r,i)),{left:a,top:c,right:l,bottom:u}}function yi(n,e,t,r){return n?0:At(e,t,r)}function jE(n,e,t){const r=n.options.borderWidth,i=n.borderSkipped,s=_w(r);return{t:yi(i.top,s.top,0,t),r:yi(i.right,s.right,0,e),b:yi(i.bottom,s.bottom,0,t),l:yi(i.left,s.left,0,e)}}function UE(n,e,t){const{enableBorderRadius:r}=n.getProps(["enableBorderRadius"]),i=n.options.borderRadius,s=bs(i),o=Math.min(e,t),a=n.borderSkipped,l=r||Ee(i);return{topLeft:yi(!l||a.top||a.left,s.topLeft,0,o),topRight:yi(!l||a.top||a.right,s.topRight,0,o),bottomLeft:yi(!l||a.bottom||a.left,s.bottomLeft,0,o),bottomRight:yi(!l||a.bottom||a.right,s.bottomRight,0,o)}}function qE(n){const e=Kw(n),t=e.right-e.left,r=e.bottom-e.top,i=jE(n,t/2,r/2),s=UE(n,t/2,r/2);return{outer:{x:e.left,y:e.top,w:t,h:r,radius:s},inner:{x:e.left+i.l,y:e.top+i.t,w:t-i.l-i.r,h:r-i.t-i.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,s.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(i.b,i.r))}}}}function Cf(n,e,t,r){const i=e===null,s=t===null,a=n&&!(i&&s)&&Kw(n,r);return a&&(i||zr(e,a.left,a.right))&&(s||zr(t,a.top,a.bottom))}function YE(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function KE(n,e){n.rect(e.x,e.y,e.w,e.h)}function Sf(n,e,t={}){const r=n.x!==t.x?-e:0,i=n.y!==t.y?-e:0,s=(n.x+n.w!==t.x+t.w?e:0)-r,o=(n.y+n.h!==t.y+t.h?e:0)-i;return{x:n.x+r,y:n.y+i,w:n.w+s,h:n.h+o,radius:n.radius}}class Vc extends Ur{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:r,backgroundColor:i}}=this,{inner:s,outer:o}=qE(this),a=YE(o.radius)?ll:KE;e.save(),(o.w!==s.w||o.h!==s.h)&&(e.beginPath(),a(e,Sf(o,t,s)),e.clip(),a(e,Sf(s,-t,o)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),a(e,Sf(s,t)),e.fillStyle=i,e.fill(),e.restore()}inRange(e,t,r){return Cf(this,e,t,r)}inXRange(e,t){return Cf(this,e,null,t)}inYRange(e,t){return Cf(this,null,e,t)}getCenterPoint(e){const{x:t,y:r,base:i,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(t+i)/2:t,y:s?r:(r+i)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}se(Vc,"id","bar"),se(Vc,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),se(Vc,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var GE=Object.freeze({__proto__:null,ArcElement:Bc,LineElement:vi,PointElement:Fc,BarElement:Vc});const Ih=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],_y=Ih.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function Gw(n){return Ih[n%Ih.length]}function Xw(n){return _y[n%_y.length]}function XE(n,e){return n.borderColor=Gw(e),n.backgroundColor=Xw(e),++e}function JE(n,e){return n.backgroundColor=n.data.map(()=>Gw(e++)),e}function ZE(n,e){return n.backgroundColor=n.data.map(()=>Xw(e++)),e}function QE(n){let e=0;return(t,r)=>{const i=n.getDatasetMeta(r).controller;i instanceof ms?e=JE(t,e):i instanceof ja?e=ZE(t,e):i&&(e=XE(t,e))}}function ky(n){let e;for(e in n)if(n[e].borderColor||n[e].backgroundColor)return!0;return!1}function e8(n){return n&&(n.borderColor||n.backgroundColor)}var t8={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,e,t){if(!t.enabled)return;const{data:{datasets:r},options:i}=n.config,{elements:s}=i;if(!t.forceOverride&&(ky(r)||e8(i)||s&&ky(s)))return;const o=QE(n);r.forEach(o)}};function n8(n,e,t,r,i){const s=i.samples||r;if(s>=t)return n.slice(e,e+t);const o=[],a=(t-2)/(s-2);let l=0;const c=e+t-1;let u=e,d,f,h,p,m;for(o[l++]=n[u],d=0;d<s-2;d++){let g=0,w=0,x;const M=Math.floor((d+1)*a)+1+e,b=Math.min(Math.floor((d+2)*a)+1,t)+e,C=b-M;for(x=M;x<b;x++)g+=n[x].x,w+=n[x].y;g/=C,w/=C;const k=Math.floor(d*a)+1+e,$=Math.min(Math.floor((d+1)*a)+1,t)+e,{x:O,y:D}=n[u];for(h=p=-1,x=k;x<$;x++)p=.5*Math.abs((O-g)*(n[x].y-D)-(O-n[x].x)*(w-D)),p>h&&(h=p,f=n[x],m=x);o[l++]=f,u=m}return o[l++]=n[c],o}function r8(n,e,t,r){let i=0,s=0,o,a,l,c,u,d,f,h,p,m;const g=[],w=e+t-1,x=n[e].x,b=n[w].x-x;for(o=e;o<e+t;++o){a=n[o],l=(a.x-x)/b*r,c=a.y;const C=l|0;if(C===u)c<p?(p=c,d=o):c>m&&(m=c,f=o),i=(s*i+a.x)/++s;else{const k=o-1;if(!Be(d)&&!Be(f)){const $=Math.min(d,f),O=Math.max(d,f);$!==h&&$!==k&&g.push({...n[$],x:i}),O!==h&&O!==k&&g.push({...n[O],x:i})}o>0&&k!==h&&g.push(n[k]),g.push(a),u=C,s=0,p=m=c,d=f=h=o}}return g}function Jw(n){if(n._decimated){const e=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function xy(n){n.data.datasets.forEach(e=>{Jw(e)})}function i8(n,e){const t=e.length;let r=0,i;const{iScale:s}=n,{min:o,max:a,minDefined:l,maxDefined:c}=s.getUserBounds();return l&&(r=At(Br(e,s.axis,o).lo,0,t-1)),c?i=At(Br(e,s.axis,a).hi+1,r,t)-r:i=t-r,{start:r,count:i}}var s8={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,e,t)=>{if(!t.enabled){xy(n);return}const r=n.width;n.data.datasets.forEach((i,s)=>{const{_data:o,indexAxis:a}=i,l=n.getDatasetMeta(s),c=o||i.data;if(da([a,n.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const u=n.scales[l.xAxisID];if(u.type!=="linear"&&u.type!=="time"||n.options.parsing)return;let{start:d,count:f}=i8(l,c);const h=t.threshold||4*r;if(f<=h){Jw(i);return}Be(o)&&(i._data=c,delete i.data,Object.defineProperty(i,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(m){this._data=m}}));let p;switch(t.algorithm){case"lttb":p=n8(c,d,f,r,t);break;case"min-max":p=r8(c,d,f,r);break;default:throw new Error("Unsupported decimation algorithm '".concat(t.algorithm,"'"))}i._decimated=p})},destroy(n){xy(n)}};function o8(n,e,t){const r=n.segments,i=n.points,s=e.points,o=[];for(const a of r){let{start:l,end:c}=a;c=um(l,c,i);const u=zh(t,i[l],i[c],a.loop);if(!e.segments){o.push({source:a,target:u,start:i[l],end:i[c]});continue}const d=Pw(e,u);for(const f of d){const h=zh(t,s[f.start],s[f.end],f.loop),p=Aw(a,i,h);for(const m of p)o.push({source:m,target:f,start:{[t]:Cy(u,h,"start",Math.max)},end:{[t]:Cy(u,h,"end",Math.min)}})}}return o}function zh(n,e,t,r){if(r)return;let i=e[n],s=t[n];return n==="angle"&&(i=vn(i),s=vn(s)),{property:n,start:i,end:s}}function a8(n,e){const{x:t=null,y:r=null}=n||{},i=e.points,s=[];return e.segments.forEach(({start:o,end:a})=>{a=um(o,a,i);const l=i[o],c=i[a];r!==null?(s.push({x:l.x,y:r}),s.push({x:c.x,y:r})):t!==null&&(s.push({x:t,y:l.y}),s.push({x:t,y:c.y}))}),s}function um(n,e,t){for(;e>n;e--){const r=t[e];if(!isNaN(r.x)&&!isNaN(r.y))break}return e}function Cy(n,e,t,r){return n&&e?r(n[t],e[t]):n?n[t]:e?e[t]:0}function Zw(n,e){let t=[],r=!1;return rt(n)?(r=!0,t=n):t=a8(n,e),t.length?new vi({points:t,options:{tension:0},_loop:r,_fullLoop:r}):null}function Sy(n){return n&&n.fill!==!1}function l8(n,e,t){let i=n[e].fill;const s=[e];let o;if(!t)return i;for(;i!==!1&&s.indexOf(i)===-1;){if(!mt(i))return i;if(o=n[i],!o)return!1;if(o.visible)return i;s.push(i),i=o.fill}return!1}function c8(n,e,t){const r=h8(n);if(Ee(r))return isNaN(r.value)?!1:r;let i=parseFloat(r);return mt(i)&&Math.floor(i)===i?u8(r[0],e,i,t):["origin","start","end","stack","shape"].indexOf(r)>=0&&r}function u8(n,e,t,r){return(n==="-"||n==="+")&&(t=e+t),t===e||t<0||t>=r?!1:t}function d8(n,e){let t=null;return n==="start"?t=e.bottom:n==="end"?t=e.top:Ee(n)?t=e.getPixelForValue(n.value):e.getBasePixel&&(t=e.getBasePixel()),t}function f8(n,e,t){let r;return n==="start"?r=t:n==="end"?r=e.options.reverse?e.min:e.max:Ee(n)?r=n.value:r=e.getBaseValue(),r}function h8(n){const e=n.options,t=e.fill;let r=Ce(t&&t.target,t);return r===void 0&&(r=!!e.backgroundColor),r===!1||r===null?!1:r===!0?"origin":r}function p8(n){const{scale:e,index:t,line:r}=n,i=[],s=r.segments,o=r.points,a=m8(e,t);a.push(Zw({x:null,y:e.bottom},r));for(let l=0;l<s.length;l++){const c=s[l];for(let u=c.start;u<=c.end;u++)g8(i,o[u],a)}return new vi({points:i,options:{}})}function m8(n,e){const t=[],r=n.getMatchingVisibleMetas("line");for(let i=0;i<r.length;i++){const s=r[i];if(s.index===e)break;s.hidden||t.unshift(s.dataset)}return t}function g8(n,e,t){const r=[];for(let i=0;i<t.length;i++){const s=t[i],{first:o,last:a,point:l}=v8(s,e,"x");if(!(!l||o&&a)){if(o)r.unshift(l);else if(n.push(l),!a)break}}n.push(...r)}function v8(n,e,t){const r=n.interpolate(e,t);if(!r)return{};const i=r[t],s=n.segments,o=n.points;let a=!1,l=!1;for(let c=0;c<s.length;c++){const u=s[c],d=o[u.start][t],f=o[u.end][t];if(zr(i,d,f)){a=i===d,l=i===f;break}}return{first:a,last:l,point:r}}class Qw{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,r){const{x:i,y:s,radius:o}=this;return t=t||{start:0,end:st},e.arc(i,s,o,t.end,t.start,!0),!r.bounds}interpolate(e){const{x:t,y:r,radius:i}=this,s=e.angle;return{x:t+Math.cos(s)*i,y:r+Math.sin(s)*i,angle:s}}}function y8(n){const{chart:e,fill:t,line:r}=n;if(mt(t))return b8(e,t);if(t==="stack")return p8(n);if(t==="shape")return!0;const i=w8(n);return i instanceof Qw?i:Zw(i,r)}function b8(n,e){const t=n.getDatasetMeta(e);return t&&n.isDatasetVisible(e)?t.dataset:null}function w8(n){return(n.scale||{}).getPointPositionForValue?k8(n):_8(n)}function _8(n){const{scale:e={},fill:t}=n,r=d8(t,e);if(mt(r)){const i=e.isHorizontal();return{x:i?r:null,y:i?null:r}}return null}function k8(n){const{scale:e,fill:t}=n,r=e.options,i=e.getLabels().length,s=r.reverse?e.max:e.min,o=f8(t,e,s),a=[];if(r.grid.circular){const l=e.getPointPositionForValue(0,s);return new Qw({x:l.x,y:l.y,radius:e.getDistanceFromCenterForValue(o)})}for(let l=0;l<i;++l)a.push(e.getPointPositionForValue(l,o));return a}function Mf(n,e,t){const r=y8(e),{line:i,scale:s,axis:o}=e,a=i.options,l=a.fill,c=a.backgroundColor,{above:u=c,below:d=c}=l||{};r&&i.points.length&&(Cd(n,t),x8(n,{line:i,target:r,above:u,below:d,area:t,scale:s,axis:o}),Sd(n))}function x8(n,e){const{line:t,target:r,above:i,below:s,area:o,scale:a}=e,l=t._loop?"angle":e.axis;n.save(),l==="x"&&s!==i&&(My(n,r,o.top),Ty(n,{line:t,target:r,color:i,scale:a,property:l}),n.restore(),n.save(),My(n,r,o.bottom)),Ty(n,{line:t,target:r,color:s,scale:a,property:l}),n.restore()}function My(n,e,t){const{segments:r,points:i}=e;let s=!0,o=!1;n.beginPath();for(const a of r){const{start:l,end:c}=a,u=i[l],d=i[um(l,c,i)];s?(n.moveTo(u.x,u.y),s=!1):(n.lineTo(u.x,t),n.lineTo(u.x,u.y)),o=!!e.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(d.x,t)}n.lineTo(e.first().x,t),n.closePath(),n.clip()}function Ty(n,e){const{line:t,target:r,property:i,color:s,scale:o}=e,a=o8(t,r,i);for(const{source:l,target:c,start:u,end:d}of a){const{style:{backgroundColor:f=s}={}}=l,h=r!==!0;n.save(),n.fillStyle=f,C8(n,o,h&&zh(i,u,d)),n.beginPath();const p=!!t.pathSegment(n,l);let m;if(h){p?n.closePath():Oy(n,r,d,i);const g=!!r.pathSegment(n,c,{move:p,reverse:!0});m=p&&g,m||Oy(n,r,u,i)}n.closePath(),n.fill(m?"evenodd":"nonzero"),n.restore()}}function C8(n,e,t){const{top:r,bottom:i}=e.chart.chartArea,{property:s,start:o,end:a}=t||{};s==="x"&&(n.beginPath(),n.rect(o,r,a-o,i-r),n.clip())}function Oy(n,e,t,r){const i=e.interpolate(t,r);i&&n.lineTo(i.x,i.y)}var S8={id:"filler",afterDatasetsUpdate(n,e,t){const r=(n.data.datasets||[]).length,i=[];let s,o,a,l;for(o=0;o<r;++o)s=n.getDatasetMeta(o),a=s.dataset,l=null,a&&a.options&&a instanceof vi&&(l={visible:n.isDatasetVisible(o),index:o,fill:c8(a,o,r),chart:n,axis:s.controller.options.indexAxis,scale:s.vScale,line:a}),s.$filler=l,i.push(l);for(o=0;o<r;++o)l=i[o],!(!l||l.fill===!1)&&(l.fill=l8(i,o,t.propagate))},beforeDraw(n,e,t){const r=t.drawTime==="beforeDraw",i=n.getSortedVisibleDatasetMetas(),s=n.chartArea;for(let o=i.length-1;o>=0;--o){const a=i[o].$filler;a&&(a.line.updateControlPoints(s,a.axis),r&&a.fill&&Mf(n.ctx,a,s))}},beforeDatasetsDraw(n,e,t){if(t.drawTime!=="beforeDatasetsDraw")return;const r=n.getSortedVisibleDatasetMetas();for(let i=r.length-1;i>=0;--i){const s=r[i].$filler;Sy(s)&&Mf(n.ctx,s,n.chartArea)}},beforeDatasetDraw(n,e,t){const r=e.meta.$filler;!Sy(r)||t.drawTime!=="beforeDatasetDraw"||Mf(n.ctx,r,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const $y=(n,e)=>{let{boxHeight:t=e,boxWidth:r=e}=n;return n.usePointStyle&&(t=Math.min(t,e),r=n.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:t,itemHeight:Math.max(e,t)}},M8=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class Dy extends Ur{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,r){this.maxWidth=e,this.maxHeight=t,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=nt(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(r=>e.filter(r,this.chart.data))),e.sort&&(t=t.sort((r,i)=>e.sort(r,i,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const r=e.labels,i=$t(r.font),s=i.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=$y(r,s);let c,u;t.font=i.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(o,s,a,l)+10):(u=this.maxHeight,c=this._fitCols(o,i,a,l)+10),this.width=Math.min(c,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,t,r,i){const{ctx:s,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=i+a;let d=e;s.textAlign="left",s.textBaseline="middle";let f=-1,h=-u;return this.legendItems.forEach((p,m)=>{const g=r+t/2+s.measureText(p.text).width;(m===0||c[c.length-1]+g+2*a>o)&&(d+=u,c[c.length-(m>0?0:1)]=0,h+=u,f++),l[m]={left:0,top:h,row:f,width:g,height:i},c[c.length-1]+=g+a}),d}_fitCols(e,t,r,i){const{ctx:s,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=o-e;let d=a,f=0,h=0,p=0,m=0;return this.legendItems.forEach((g,w)=>{const{itemWidth:x,itemHeight:M}=T8(r,t,s,g,i);w>0&&h+M+2*a>u&&(d+=f+a,c.push({width:f,height:h}),p+=f+a,m++,f=h=0),l[w]={left:p,top:h,col:m,width:x,height:M},f=Math.max(f,x),h+=M+a}),d+=f,c.push({width:f,height:h}),d}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:r,labels:{padding:i},rtl:s}}=this,o=vo(s,this.left,this.width);if(this.isHorizontal()){let a=0,l=Vt(r,this.left+i,this.right-this.lineWidths[a]);for(const c of t)a!==c.row&&(a=c.row,l=Vt(r,this.left+i,this.right-this.lineWidths[a])),c.top+=this.top+e+i,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+i}else{let a=0,l=Vt(r,this.top+e+i,this.bottom-this.columnSizes[a].height);for(const c of t)c.col!==a&&(a=c.col,l=Vt(r,this.top+e+i,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+i,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Cd(e,this),this._draw(),Sd(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:r,ctx:i}=this,{align:s,labels:o}=e,a=bt.color,l=vo(e.rtl,this.left,this.width),c=$t(o.font),{padding:u}=o,d=c.size,f=d/2;let h;this.drawTitle(),i.textAlign=l.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=c.string;const{boxWidth:p,boxHeight:m,itemHeight:g}=$y(o,d),w=function(k,$,O){if(isNaN(p)||p<=0||isNaN(m)||m<0)return;i.save();const D=Ce(O.lineWidth,1);if(i.fillStyle=Ce(O.fillStyle,a),i.lineCap=Ce(O.lineCap,"butt"),i.lineDashOffset=Ce(O.lineDashOffset,0),i.lineJoin=Ce(O.lineJoin,"miter"),i.lineWidth=D,i.strokeStyle=Ce(O.strokeStyle,a),i.setLineDash(Ce(O.lineDash,[])),o.usePointStyle){const N={radius:m*Math.SQRT2/2,pointStyle:O.pointStyle,rotation:O.rotation,borderWidth:D},B=l.xPlus(k,p/2),U=$+f;ww(i,N,B,U,o.pointStyleWidth&&p)}else{const N=$+Math.max((d-m)/2,0),B=l.leftForLtr(k,p),U=bs(O.borderRadius);i.beginPath(),Object.values(U).some(le=>le!==0)?ll(i,{x:B,y:N,w:p,h:m,radius:U}):i.rect(B,N,p,m),i.fill(),D!==0&&i.stroke()}i.restore()},x=function(k,$,O){Rs(i,O.text,k,$+g/2,c,{strikethrough:O.hidden,textAlign:l.textAlign(O.textAlign)})},M=this.isHorizontal(),b=this._computeTitleHeight();M?h={x:Vt(s,this.left+u,this.right-r[0]),y:this.top+u+b,line:0}:h={x:this.left+u,y:Vt(s,this.top+b+u,this.bottom-t[0].height),line:0},$w(this.ctx,e.textDirection);const C=g+u;this.legendItems.forEach((k,$)=>{i.strokeStyle=k.fontColor,i.fillStyle=k.fontColor;const O=i.measureText(k.text).width,D=l.textAlign(k.textAlign||(k.textAlign=o.textAlign)),N=p+f+O;let B=h.x,U=h.y;l.setWidth(this.width),M?$>0&&B+N+u>this.right&&(U=h.y+=C,h.line++,B=h.x=Vt(s,this.left+u,this.right-r[h.line])):$>0&&U+C>this.bottom&&(B=h.x=B+t[h.line].width+u,h.line++,U=h.y=Vt(s,this.top+b+u,this.bottom-t[h.line].height));const le=l.x(B);if(w(le,U,k),B=G$(D,B+p+f,M?B+N:this.right,e.rtl),x(l.x(B),U,k),M)h.x+=N+u;else if(typeof k.text!="string"){const Te=c.lineHeight;h.y+=e_(k,Te)}else h.y+=C}),Dw(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,r=$t(t.font),i=Yt(t.padding);if(!t.display)return;const s=vo(e.rtl,this.left,this.width),o=this.ctx,a=t.position,l=r.size/2,c=i.top+l;let u,d=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),u=this.top+c,d=Vt(e.align,d,this.right-f);else{const p=this.columnSizes.reduce((m,g)=>Math.max(m,g.height),0);u=c+Vt(e.align,this.top,this.bottom-p-e.labels.padding-this._computeTitleHeight())}const h=Vt(a,d,d+f);o.textAlign=s.textAlign(nm(a)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=r.string,Rs(o,t.text,h,u,r)}_computeTitleHeight(){const e=this.options.title,t=$t(e.font),r=Yt(e.padding);return e.display?t.lineHeight+r.height:0}_getLegendItemAt(e,t){let r,i,s;if(zr(e,this.left,this.right)&&zr(t,this.top,this.bottom)){for(s=this.legendHitBoxes,r=0;r<s.length;++r)if(i=s[r],zr(e,i.left,i.left+i.width)&&zr(t,i.top,i.top+i.height))return this.legendItems[r]}return null}handleEvent(e){const t=this.options;if(!D8(e.type,t))return;const r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const i=this._hoveredItem,s=M8(i,r);i&&!s&&nt(t.onLeave,[e,i,this],this),this._hoveredItem=r,r&&!s&&nt(t.onHover,[e,r,this],this)}else r&&nt(t.onClick,[e,r,this],this)}}function T8(n,e,t,r,i){const s=O8(r,n,e,t),o=$8(i,r,e.lineHeight);return{itemWidth:s,itemHeight:o}}function O8(n,e,t,r){let i=n.text;return i&&typeof i!="string"&&(i=i.reduce((s,o)=>s.length>o.length?s:o)),e+t.size/2+r.measureText(i).width}function $8(n,e,t){let r=n;return typeof e.text!="string"&&(r=e_(e,t)),r}function e_(n,e){const t=n.text?n.text.length+.5:0;return e*t}function D8(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var E8={id:"legend",_element:Dy,start(n,e,t){const r=n.legend=new Dy({ctx:n.ctx,options:t,chart:n});jt.configure(n,r,t),jt.addBox(n,r)},stop(n){jt.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const r=n.legend;jt.configure(n,r,t),r.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const r=e.datasetIndex,i=t.chart;i.isDatasetVisible(r)?(i.hide(r),e.hidden=!0):(i.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:r,textAlign:i,color:s,useBorderRadius:o,borderRadius:a}}=n.legend.options;return n._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(t?0:void 0),u=Yt(c.borderWidth);return{text:e[l.index].label,fillStyle:c.backgroundColor,fontColor:s,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:r||c.pointStyle,rotation:c.rotation,textAlign:i||c.textAlign,borderRadius:o&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class dm extends Ur{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const r=this.options;if(this.left=0,this.top=0,!r.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const i=rt(r.text)?r.text.length:1;this._padding=Yt(r.padding);const s=i*$t(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:r,bottom:i,right:s,options:o}=this,a=o.align;let l=0,c,u,d;return this.isHorizontal()?(u=Vt(a,r,s),d=t+e,c=s-r):(o.position==="left"?(u=r+e,d=Vt(a,i,t),l=at*-.5):(u=s-e,d=Vt(a,t,i),l=at*.5),c=i-t),{titleX:u,titleY:d,maxWidth:c,rotation:l}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const r=$t(t.font),s=r.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(s);Rs(e,t.text,0,0,r,{color:t.color,maxWidth:l,rotation:c,textAlign:nm(t.align),textBaseline:"middle",translation:[o,a]})}}function A8(n,e){const t=new dm({ctx:n.ctx,options:e,chart:n});jt.configure(n,t,e),jt.addBox(n,t),n.titleBlock=t}var P8={id:"title",_element:dm,start(n,e,t){A8(n,t)},stop(n){const e=n.titleBlock;jt.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,t){const r=n.titleBlock;jt.configure(n,r,t),r.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const pc=new WeakMap;var N8={id:"subtitle",start(n,e,t){const r=new dm({ctx:n.ctx,options:t,chart:n});jt.configure(n,r,t),jt.addBox(n,r),pc.set(n,r)},stop(n){jt.removeBox(n,pc.get(n)),pc.delete(n)},beforeUpdate(n,e,t){const r=pc.get(n);jt.configure(n,r,t),r.options=t},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const ha={average(n){if(!n.length)return!1;let e,t,r=0,i=0,s=0;for(e=0,t=n.length;e<t;++e){const o=n[e].element;if(o&&o.hasValue()){const a=o.tooltipPosition();r+=a.x,i+=a.y,++s}}return{x:r/s,y:i/s}},nearest(n,e){if(!n.length)return!1;let t=e.x,r=e.y,i=Number.POSITIVE_INFINITY,s,o,a;for(s=0,o=n.length;s<o;++s){const l=n[s].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=Eh(e,c);u<i&&(i=u,a=l)}}if(a){const l=a.tooltipPosition();t=l.x,r=l.y}return{x:t,y:r}}};function rr(n,e){return e&&(rt(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function Dr(n){return(typeof n=="string"||n instanceof String)&&n.indexOf("\n")>-1?n.split("\n"):n}function R8(n,e){const{element:t,datasetIndex:r,index:i}=e,s=n.getDatasetMeta(r).controller,{label:o,value:a}=s.getLabelAndValue(i);return{chart:n,label:o,parsed:s.getParsed(i),raw:n.data.datasets[r].data[i],formattedValue:a,dataset:s.getDataset(),dataIndex:i,datasetIndex:r,element:t}}function Ey(n,e){const t=n.chart.ctx,{body:r,footer:i,title:s}=n,{boxWidth:o,boxHeight:a}=e,l=$t(e.bodyFont),c=$t(e.titleFont),u=$t(e.footerFont),d=s.length,f=i.length,h=r.length,p=Yt(e.padding);let m=p.height,g=0,w=r.reduce((b,C)=>b+C.before.length+C.lines.length+C.after.length,0);if(w+=n.beforeBody.length+n.afterBody.length,d&&(m+=d*c.lineHeight+(d-1)*e.titleSpacing+e.titleMarginBottom),w){const b=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;m+=h*b+(w-h)*l.lineHeight+(w-1)*e.bodySpacing}f&&(m+=e.footerMarginTop+f*u.lineHeight+(f-1)*e.footerSpacing);let x=0;const M=function(b){g=Math.max(g,t.measureText(b).width+x)};return t.save(),t.font=c.string,Je(n.title,M),t.font=l.string,Je(n.beforeBody.concat(n.afterBody),M),x=e.displayColors?o+2+e.boxPadding:0,Je(r,b=>{Je(b.before,M),Je(b.lines,M),Je(b.after,M)}),x=0,t.font=u.string,Je(n.footer,M),t.restore(),g+=p.width,{width:g,height:m}}function L8(n,e){const{y:t,height:r}=e;return t<r/2?"top":t>n.height-r/2?"bottom":"center"}function I8(n,e,t,r){const{x:i,width:s}=r,o=t.caretSize+t.caretPadding;if(n==="left"&&i+s+o>e.width||n==="right"&&i-s-o<0)return!0}function z8(n,e,t,r){const{x:i,width:s}=t,{width:o,chartArea:{left:a,right:l}}=n;let c="center";return r==="center"?c=i<=(a+l)/2?"left":"right":i<=s/2?c="left":i>=o-s/2&&(c="right"),I8(c,n,e,t)&&(c="center"),c}function Ay(n,e,t){const r=t.yAlign||e.yAlign||L8(n,t);return{xAlign:t.xAlign||e.xAlign||z8(n,e,t,r),yAlign:r}}function B8(n,e){let{x:t,width:r}=n;return e==="right"?t-=r:e==="center"&&(t-=r/2),t}function F8(n,e,t){let{y:r,height:i}=n;return e==="top"?r+=t:e==="bottom"?r-=i+t:r-=i/2,r}function Py(n,e,t,r){const{caretSize:i,caretPadding:s,cornerRadius:o}=n,{xAlign:a,yAlign:l}=t,c=i+s,{topLeft:u,topRight:d,bottomLeft:f,bottomRight:h}=bs(o);let p=B8(e,a);const m=F8(e,l,c);return l==="center"?a==="left"?p+=c:a==="right"&&(p-=c):a==="left"?p-=Math.max(u,f)+i:a==="right"&&(p+=Math.max(d,h)+i),{x:At(p,0,r.width-e.width),y:At(m,0,r.height-e.height)}}function mc(n,e,t){const r=Yt(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-r.right:n.x+r.left}function Ny(n){return rr([],Dr(n))}function V8(n,e,t){return Ii(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function Ry(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const t_={beforeTitle:Tr,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,r=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return t[e.dataIndex]}return""},afterTitle:Tr,beforeBody:Tr,beforeLabel:Tr,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return Be(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:Tr,afterBody:Tr,beforeFooter:Tr,footer:Tr,afterFooter:Tr};function nn(n,e,t,r){const i=n[e].call(t,r);return typeof i>"u"?t_[e].call(t,r):i}class Bh extends Ur{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,r=this.options.setContext(this.getContext()),i=r.enabled&&t.options.animation&&r.animations,s=new Nw(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=V8(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:r}=t,i=nn(r,"beforeTitle",this,e),s=nn(r,"title",this,e),o=nn(r,"afterTitle",this,e);let a=[];return a=rr(a,Dr(i)),a=rr(a,Dr(s)),a=rr(a,Dr(o)),a}getBeforeBody(e,t){return Ny(nn(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:r}=t,i=[];return Je(e,s=>{const o={before:[],lines:[],after:[]},a=Ry(r,s);rr(o.before,Dr(nn(a,"beforeLabel",this,s))),rr(o.lines,nn(a,"label",this,s)),rr(o.after,Dr(nn(a,"afterLabel",this,s))),i.push(o)}),i}getAfterBody(e,t){return Ny(nn(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:r}=t,i=nn(r,"beforeFooter",this,e),s=nn(r,"footer",this,e),o=nn(r,"afterFooter",this,e);let a=[];return a=rr(a,Dr(i)),a=rr(a,Dr(s)),a=rr(a,Dr(o)),a}_createItems(e){const t=this._active,r=this.chart.data,i=[],s=[],o=[];let a=[],l,c;for(l=0,c=t.length;l<c;++l)a.push(R8(this.chart,t[l]));return e.filter&&(a=a.filter((u,d,f)=>e.filter(u,d,f,r))),e.itemSort&&(a=a.sort((u,d)=>e.itemSort(u,d,r))),Je(a,u=>{const d=Ry(e.callbacks,u);i.push(nn(d,"labelColor",this,u)),s.push(nn(d,"labelPointStyle",this,u)),o.push(nn(d,"labelTextColor",this,u))}),this.labelColors=i,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=a,a}update(e,t){const r=this.options.setContext(this.getContext()),i=this._active;let s,o=[];if(!i.length)this.opacity!==0&&(s={opacity:0});else{const a=ha[r.position].call(this,i,this._eventPosition);o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r);const l=this._size=Ey(this,r),c=Object.assign({},a,l),u=Ay(this.chart,r,c),d=Py(r,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,s={opacity:1,x:d.x,y:d.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,r,i){const s=this.getCaretPosition(e,r,i);t.lineTo(s.x1,s.y1),t.lineTo(s.x2,s.y2),t.lineTo(s.x3,s.y3)}getCaretPosition(e,t,r){const{xAlign:i,yAlign:s}=this,{caretSize:o,cornerRadius:a}=r,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:d}=bs(a),{x:f,y:h}=e,{width:p,height:m}=t;let g,w,x,M,b,C;return s==="center"?(b=h+m/2,i==="left"?(g=f,w=g-o,M=b+o,C=b-o):(g=f+p,w=g+o,M=b-o,C=b+o),x=g):(i==="left"?w=f+Math.max(l,u)+o:i==="right"?w=f+p-Math.max(c,d)-o:w=this.caretX,s==="top"?(M=h,b=M-o,g=w-o,x=w+o):(M=h+m,b=M+o,g=w+o,x=w-o),C=M),{x1:g,x2:w,x3:x,y1:M,y2:b,y3:C}}drawTitle(e,t,r){const i=this.title,s=i.length;let o,a,l;if(s){const c=vo(r.rtl,this.x,this.width);for(e.x=mc(this,r.titleAlign,r),t.textAlign=c.textAlign(r.titleAlign),t.textBaseline="middle",o=$t(r.titleFont),a=r.titleSpacing,t.fillStyle=r.titleColor,t.font=o.string,l=0;l<s;++l)t.fillText(i[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===s&&(e.y+=r.titleMarginBottom-a)}}_drawColorBox(e,t,r,i,s){const o=this.labelColors[r],a=this.labelPointStyles[r],{boxHeight:l,boxWidth:c,boxPadding:u}=s,d=$t(s.bodyFont),f=mc(this,"left",s),h=i.x(f),p=l<d.lineHeight?(d.lineHeight-l)/2:0,m=t.y+p;if(s.usePointStyle){const g={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},w=i.leftForLtr(h,c)+c/2,x=m+l/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,Ph(e,g,w,x),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,Ph(e,g,w,x)}else{e.lineWidth=Ee(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const g=i.leftForLtr(h,c-u),w=i.leftForLtr(i.xPlus(h,1),c-u-2),x=bs(o.borderRadius);Object.values(x).some(M=>M!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,ll(e,{x:g,y:m,w:c,h:l,radius:x}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),ll(e,{x:w,y:m+1,w:c-2,h:l-2,radius:x}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(g,m,c,l),e.strokeRect(g,m,c,l),e.fillStyle=o.backgroundColor,e.fillRect(w,m+1,c-2,l-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,t,r){const{body:i}=this,{bodySpacing:s,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:u}=r,d=$t(r.bodyFont);let f=d.lineHeight,h=0;const p=vo(r.rtl,this.x,this.width),m=function(O){t.fillText(O,p.x(e.x+h),e.y+f/2),e.y+=f+s},g=p.textAlign(o);let w,x,M,b,C,k,$;for(t.textAlign=o,t.textBaseline="middle",t.font=d.string,e.x=mc(this,g,r),t.fillStyle=r.bodyColor,Je(this.beforeBody,m),h=a&&g!=="right"?o==="center"?c/2+u:c+2+u:0,b=0,k=i.length;b<k;++b){for(w=i[b],x=this.labelTextColors[b],t.fillStyle=x,Je(w.before,m),M=w.lines,a&&M.length&&(this._drawColorBox(t,e,b,p,r),f=Math.max(d.lineHeight,l)),C=0,$=M.length;C<$;++C)m(M[C]),f=d.lineHeight;Je(w.after,m)}h=0,f=d.lineHeight,Je(this.afterBody,m),e.y-=s}drawFooter(e,t,r){const i=this.footer,s=i.length;let o,a;if(s){const l=vo(r.rtl,this.x,this.width);for(e.x=mc(this,r.footerAlign,r),e.y+=r.footerMarginTop,t.textAlign=l.textAlign(r.footerAlign),t.textBaseline="middle",o=$t(r.footerFont),t.fillStyle=r.footerColor,t.font=o.string,a=0;a<s;++a)t.fillText(i[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+r.footerSpacing}}drawBackground(e,t,r,i){const{xAlign:s,yAlign:o}=this,{x:a,y:l}=e,{width:c,height:u}=r,{topLeft:d,topRight:f,bottomLeft:h,bottomRight:p}=bs(i.cornerRadius);t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.beginPath(),t.moveTo(a+d,l),o==="top"&&this.drawCaret(e,t,r,i),t.lineTo(a+c-f,l),t.quadraticCurveTo(a+c,l,a+c,l+f),o==="center"&&s==="right"&&this.drawCaret(e,t,r,i),t.lineTo(a+c,l+u-p),t.quadraticCurveTo(a+c,l+u,a+c-p,l+u),o==="bottom"&&this.drawCaret(e,t,r,i),t.lineTo(a+h,l+u),t.quadraticCurveTo(a,l+u,a,l+u-h),o==="center"&&s==="left"&&this.drawCaret(e,t,r,i),t.lineTo(a,l+d),t.quadraticCurveTo(a,l,a+d,l),t.closePath(),t.fill(),i.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,r=this.$animations,i=r&&r.x,s=r&&r.y;if(i||s){const o=ha[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=Ey(this,e),l=Object.assign({},o,this._size),c=Ay(t,e,l),u=Py(e,l,c,t);(i._to!==u.x||s._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(t);const i={width:this.width,height:this.height},s={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const o=Yt(t.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&a&&(e.save(),e.globalAlpha=r,this.drawBackground(s,e,i,t),$w(e,t.textDirection),s.y+=o.top,this.drawTitle(s,e,t),this.drawBody(s,e,t),this.drawFooter(s,e,t),Dw(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const r=this._active,i=e.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),s=!Pu(r,i),o=this._positionChanged(i,t);(s||o)&&(this._active=i,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,r=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,s=this._active||[],o=this._getActiveElements(e,s,t,r),a=this._positionChanged(o,e),l=t||!Pu(o,s)||a;return l&&(this._active=o,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),l}_getActiveElements(e,t,r,i){const s=this.options;if(e.type==="mouseout")return[];if(!i)return t;const o=this.chart.getElementsAtEventForMode(e,s.mode,s,r);return s.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:r,caretY:i,options:s}=this,o=ha[s.position].call(this,e,t);return o!==!1&&(r!==o.x||i!==o.y)}}se(Bh,"positioners",ha);var H8={id:"tooltip",_element:Bh,positioners:ha,afterInit(n,e,t){t&&(n.tooltip=new Bh({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:t_},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},W8=Object.freeze({__proto__:null,Colors:t8,Decimation:s8,Filler:S8,Legend:E8,SubTitle:N8,Title:P8,Tooltip:H8});const j8=(n,e,t,r)=>(typeof e=="string"?(t=n.push(e)-1,r.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function U8(n,e,t,r){const i=n.indexOf(e);if(i===-1)return j8(n,e,t,r);const s=n.lastIndexOf(e);return i!==s?t:i}const q8=(n,e)=>n===null?null:At(Math.round(n),0,e);function Ly(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class Fh extends Us{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const r=this.getLabels();for(const{index:i,label:s}of t)r[i]===s&&r.splice(i,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(Be(e))return null;const r=this.getLabels();return t=isFinite(t)&&r[t]===e?t:U8(r,e,Ce(t,e),this._addedLabels),q8(t,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:r,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),t||(i=this.getLabels().length-1)),this.min=r,this.max=i}buildTicks(){const e=this.min,t=this.max,r=this.options.offset,i=[];let s=this.getLabels();s=e===0&&t===s.length-1?s:s.slice(e,t+1),this._valueRange=Math.max(s.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let o=e;o<=t;o++)i.push({value:o});return i}getLabelForValue(e){return Ly.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}se(Fh,"id","category"),se(Fh,"defaults",{ticks:{callback:Ly}});function Y8(n,e){const t=[],{bounds:i,step:s,min:o,max:a,precision:l,count:c,maxTicks:u,maxDigits:d,includeBounds:f}=n,h=s||1,p=u-1,{min:m,max:g}=e,w=!Be(o),x=!Be(a),M=!Be(c),b=(g-m)/(d+1);let C=Av((g-m)/p/h)*h,k,$,O,D;if(C<1e-14&&!w&&!x)return[{value:m},{value:g}];D=Math.ceil(g/C)-Math.floor(m/C),D>p&&(C=Av(D*C/p/h)*h),Be(l)||(k=Math.pow(10,l),C=Math.ceil(C*k)/k),i==="ticks"?($=Math.floor(m/C)*C,O=Math.ceil(g/C)*C):($=m,O=g),w&&x&&s&&H$((a-o)/s,C/1e3)?(D=Math.round(Math.min((a-o)/C,u)),C=(a-o)/D,$=o,O=a):M?($=w?o:$,O=x?a:O,D=c-1,C=(O-$)/D):(D=(O-$)/C,Va(D,Math.round(D),C/1e3)?D=Math.round(D):D=Math.ceil(D));const N=Math.max(Pv(C),Pv($));k=Math.pow(10,Be(l)?N:l),$=Math.round($*k)/k,O=Math.round(O*k)/k;let B=0;for(w&&(f&&$!==o?(t.push({value:o}),$<o&&B++,Va(Math.round(($+B*C)*k)/k,o,Iy(o,b,n))&&B++):$<o&&B++);B<D;++B)t.push({value:Math.round(($+B*C)*k)/k});return x&&f&&O!==a?t.length&&Va(t[t.length-1].value,a,Iy(a,b,n))?t[t.length-1].value=a:t.push({value:a}):(!x||O===a)&&t.push({value:O}),t}function Iy(n,e,{horizontal:t,minRotation:r}){const i=Yn(r),s=(t?Math.sin(i):Math.cos(i))||.001,o=.75*e*(""+n).length;return Math.min(e/s,o)}class Vu extends Us{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return Be(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:i,max:s}=this;const o=l=>i=t?i:l,a=l=>s=r?s:l;if(e){const l=mr(i),c=mr(s);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(i===s){let l=s===0?1:Math.abs(s*.05);a(s+l),e||o(i-l)}this.min=i,this.max=s}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:r}=e,i;return r?(i=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,i>1e3&&(console.warn("scales.".concat(this.id,".ticks.stepSize: ").concat(r," would result generating up to ").concat(i," ticks. Limiting to 1000.")),i=1e3)):(i=this.computeTickLimit(),t=t||11),t&&(i=Math.min(t,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const i={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},s=this._range||this,o=Y8(i,s);return e.bounds==="ticks"&&uw(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let t=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const i=(r-t)/Math.max(e.length-1,1)/2;t-=i,r+=i}this._startValue=t,this._endValue=r,this._valueRange=r-t}getLabelForValue(e){return El(e,this.chart.options.locale,this.options.ticks.format)}}class Vh extends Vu{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=mt(e)?e:0,this.max=mt(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,r=Yn(this.options.ticks.minRotation),i=(e?Math.sin(r):Math.cos(r))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,s.lineHeight/i))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}se(Vh,"id","linear"),se(Vh,"defaults",{ticks:{callback:xd.formatters.numeric}});const ul=n=>Math.floor(gi(n)),Ji=(n,e)=>Math.pow(10,ul(n)+e);function zy(n){return n/Math.pow(10,ul(n))===1}function By(n,e,t){const r=Math.pow(10,t),i=Math.floor(n/r);return Math.ceil(e/r)-i}function K8(n,e){const t=e-n;let r=ul(t);for(;By(n,e,r)>10;)r++;for(;By(n,e,r)<10;)r--;return Math.min(r,ul(n))}function G8(n,{min:e,max:t}){e=gn(n.min,e);const r=[],i=ul(e);let s=K8(e,t),o=s<0?Math.pow(10,Math.abs(s)):1;const a=Math.pow(10,s),l=i>s?Math.pow(10,i):0,c=Math.round((e-l)*o)/o,u=Math.floor((e-l)/a/10)*a*10;let d=Math.floor((c-u)/Math.pow(10,s)),f=gn(n.min,Math.round((l+u+d*Math.pow(10,s))*o)/o);for(;f<t;)r.push({value:f,major:zy(f),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(s++,d=2,o=s>=0?1:o),f=Math.round((l+u+d*Math.pow(10,s))*o)/o;const h=gn(n.max,f);return r.push({value:h,major:zy(h),significand:d}),r}class Hh extends Us{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const r=Vu.prototype.parse.apply(this,[e,t]);if(r===0){this._zero=!0;return}return mt(r)&&r>0?r:null}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=mt(e)?Math.max(0,e):null,this.max=mt(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!mt(this._userMin)&&(this.min=e===Ji(this.min,0)?Ji(this.min,-1):Ji(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let r=this.min,i=this.max;const s=a=>r=e?r:a,o=a=>i=t?i:a;r===i&&(r<=0?(s(1),o(10)):(s(Ji(r,-1)),o(Ji(i,1)))),r<=0&&s(Ji(i,-1)),i<=0&&o(Ji(r,1)),this.min=r,this.max=i}buildTicks(){const e=this.options,t={min:this._userMin,max:this._userMax},r=G8(t,this);return e.bounds==="ticks"&&uw(r,this,"value"),e.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}getLabelForValue(e){return e===void 0?"0":El(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=gi(e),this._valueRange=gi(this.max)-gi(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(gi(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}se(Hh,"id","logarithmic"),se(Hh,"defaults",{ticks:{callback:xd.formatters.logarithmic,major:{enabled:!0}}});function Wh(n){const e=n.ticks;if(e.display&&n.display){const t=Yt(e.backdropPadding);return Ce(e.font&&e.font.size,bt.font.size)+t.height}return 0}function X8(n,e,t){return t=rt(t)?t:[t],{w:s5(n,e.string,t),h:t.length*e.lineHeight}}function Fy(n,e,t,r,i){return n===r||n===i?{start:e-t/2,end:e+t/2}:n<r||n>i?{start:e-t,end:e}:{start:e,end:e+t}}function J8(n){const e={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},t=Object.assign({},e),r=[],i=[],s=n._pointLabels.length,o=n.options.pointLabels,a=o.centerPointLabels?at/s:0;for(let l=0;l<s;l++){const c=o.setContext(n.getPointLabelContext(l));i[l]=c.padding;const u=n.getPointPosition(l,n.drawingArea+i[l],a),d=$t(c.font),f=X8(n.ctx,d,n._pointLabels[l]);r[l]=f;const h=vn(n.getIndexAngle(l)+a),p=Math.round(em(h)),m=Fy(p,u.x,f.w,0,180),g=Fy(p,u.y,f.h,90,270);Z8(t,e,h,m,g)}n.setCenterPoint(e.l-t.l,t.r-e.r,e.t-t.t,t.b-e.b),n._pointLabelItems=Q8(n,r,i)}function Z8(n,e,t,r,i){const s=Math.abs(Math.sin(t)),o=Math.abs(Math.cos(t));let a=0,l=0;r.start<e.l?(a=(e.l-r.start)/s,n.l=Math.min(n.l,e.l-a)):r.end>e.r&&(a=(r.end-e.r)/s,n.r=Math.max(n.r,e.r+a)),i.start<e.t?(l=(e.t-i.start)/o,n.t=Math.min(n.t,e.t-l)):i.end>e.b&&(l=(i.end-e.b)/o,n.b=Math.max(n.b,e.b+l))}function Q8(n,e,t){const r=[],i=n._pointLabels.length,s=n.options,o=Wh(s)/2,a=n.drawingArea,l=s.pointLabels.centerPointLabels?at/i:0;for(let c=0;c<i;c++){const u=n.getPointPosition(c,a+o+t[c],l),d=Math.round(em(vn(u.angle+gt))),f=e[c],h=n6(u.y,f.h,d),p=e6(d),m=t6(u.x,f.w,p);r.push({x:u.x,y:h,textAlign:p,left:m,top:h,right:m+f.w,bottom:h+f.h})}return r}function e6(n){return n===0||n===180?"center":n<180?"left":"right"}function t6(n,e,t){return t==="right"?n-=e:t==="center"&&(n-=e/2),n}function n6(n,e,t){return t===90||t===270?n-=e/2:(t>270||t<90)&&(n-=e),n}function r6(n,e){const{ctx:t,options:{pointLabels:r}}=n;for(let i=e-1;i>=0;i--){const s=r.setContext(n.getPointLabelContext(i)),o=$t(s.font),{x:a,y:l,textAlign:c,left:u,top:d,right:f,bottom:h}=n._pointLabelItems[i],{backdropColor:p}=s;if(!Be(p)){const m=bs(s.borderRadius),g=Yt(s.backdropPadding);t.fillStyle=p;const w=u-g.left,x=d-g.top,M=f-u+g.width,b=h-d+g.height;Object.values(m).some(C=>C!==0)?(t.beginPath(),ll(t,{x:w,y:x,w:M,h:b,radius:m}),t.fill()):t.fillRect(w,x,M,b)}Rs(t,n._pointLabels[i],a,l+o.lineHeight/2,o,{color:s.color,textAlign:c,textBaseline:"middle"})}}function n_(n,e,t,r){const{ctx:i}=n;if(t)i.arc(n.xCenter,n.yCenter,e,0,st);else{let s=n.getPointPosition(0,e);i.moveTo(s.x,s.y);for(let o=1;o<r;o++)s=n.getPointPosition(o,e),i.lineTo(s.x,s.y)}}function i6(n,e,t,r,i){const s=n.ctx,o=e.circular,{color:a,lineWidth:l}=e;!o&&!r||!a||!l||t<0||(s.save(),s.strokeStyle=a,s.lineWidth=l,s.setLineDash(i.dash),s.lineDashOffset=i.dashOffset,s.beginPath(),n_(n,t,o,r),s.closePath(),s.stroke(),s.restore())}function s6(n,e,t){return Ii(n,{label:t,index:e,type:"pointLabel"})}class pa extends Vu{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=Yt(Wh(this.options)/2),t=this.width=this.maxWidth-e.width,r=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+r/2+e.top),this.drawingArea=Math.floor(Math.min(t,r)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=mt(e)&&!isNaN(e)?e:0,this.max=mt(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Wh(this.options))}generateTickLabels(e){Vu.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((t,r)=>{const i=nt(this.options.pointLabels.callback,[t,r],this);return i||i===0?i:""}).filter((t,r)=>this.chart.getDataVisibility(r))}fit(){const e=this.options;e.display&&e.pointLabels.display?J8(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,r,i){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((r-i)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,r,i))}getIndexAngle(e){const t=st/(this._pointLabels.length||1),r=this.options.startAngle||0;return vn(e*t+Yn(r))}getDistanceFromCenterForValue(e){if(Be(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(Be(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const r=t[e];return s6(this.getContext(),e,r)}}getPointPosition(e,t,r=0){const i=this.getIndexAngle(e)-gt+r;return{x:Math.cos(i)*t+this.xCenter,y:Math.sin(i)*t+this.yCenter,angle:i}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:r,right:i,bottom:s}=this._pointLabelItems[e];return{left:t,top:r,right:i,bottom:s}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const r=this.ctx;r.save(),r.beginPath(),n_(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),r.closePath(),r.fillStyle=e,r.fill(),r.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:r,grid:i,border:s}=t,o=this._pointLabels.length;let a,l,c;if(t.pointLabels.display&&r6(this,o),i.display&&this.ticks.forEach((u,d)=>{if(d!==0){l=this.getDistanceFromCenterForValue(u.value);const f=this.getContext(d),h=i.setContext(f),p=s.setContext(f);i6(this,h,l,o,p)}}),r.display){for(e.save(),a=o-1;a>=0;a--){const u=r.setContext(this.getPointLabelContext(a)),{color:d,lineWidth:f}=u;!f||!d||(e.lineWidth=f,e.strokeStyle=d,e.setLineDash(u.borderDash),e.lineDashOffset=u.borderDashOffset,l=this.getDistanceFromCenterForValue(t.ticks.reverse?this.min:this.max),c=this.getPointPosition(a,l),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(c.x,c.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,r=t.ticks;if(!r.display)return;const i=this.getIndexAngle(0);let s,o;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(i),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((a,l)=>{if(l===0&&!t.reverse)return;const c=r.setContext(this.getContext(l)),u=$t(c.font);if(s=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){e.font=u.string,o=e.measureText(a.label).width,e.fillStyle=c.backdropColor;const d=Yt(c.backdropPadding);e.fillRect(-o/2-d.left,-s-u.size/2-d.top,o+d.width,u.size+d.height)}Rs(e,a.label,0,-s,u,{color:c.color})}),e.restore()}drawTitle(){}}se(pa,"id","radialLinear"),se(pa,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:xd.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}}),se(pa,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),se(pa,"descriptors",{angleLines:{_fallback:"grid"}});const Td={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},rn=Object.keys(Td);function o6(n,e){return n-e}function Vy(n,e){if(Be(e))return null;const t=n._adapter,{parser:r,round:i,isoWeekday:s}=n._parseOpts;let o=e;return typeof r=="function"&&(o=r(o)),mt(o)||(o=typeof r=="string"?t.parse(o,r):t.parse(o)),o===null?null:(i&&(o=i==="week"&&(So(s)||s===!0)?t.startOf(o,"isoWeek",s):t.startOf(o,i)),+o)}function Hy(n,e,t,r){const i=rn.length;for(let s=rn.indexOf(n);s<i-1;++s){const o=Td[rn[s]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(a*o.size))<=r)return rn[s]}return rn[i-1]}function a6(n,e,t,r,i){for(let s=rn.length-1;s>=rn.indexOf(t);s--){const o=rn[s];if(Td[o].common&&n._adapter.diff(i,r,o)>=e-1)return o}return rn[t?rn.indexOf(t):0]}function l6(n){for(let e=rn.indexOf(n)+1,t=rn.length;e<t;++e)if(Td[rn[e]].common)return rn[e]}function Wy(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:r,hi:i}=tm(t,e),s=t[r]>=e?t[r]:t[i];n[s]=!0}}function c6(n,e,t,r){const i=n._adapter,s=+i.startOf(e[0].value,r),o=e[e.length-1].value;let a,l;for(a=s;a<=o;a=+i.add(a,1,r))l=t[a],l>=0&&(e[l].major=!0);return e}function jy(n,e,t){const r=[],i={},s=e.length;let o,a;for(o=0;o<s;++o)a=e[o],i[a]=o,r.push({value:a,major:!1});return s===0||!t?r:c6(n,r,i,t)}class dl extends Us{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const r=e.time||(e.time={}),i=this._adapter=new _D._date(e.adapters.date);i.init(t),Fa(r.displayFormats,i.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:Vy(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,r=e.time.unit||"day";let{min:i,max:s,minDefined:o,maxDefined:a}=this.getUserBounds();function l(c){!o&&!isNaN(c.min)&&(i=Math.min(i,c.min)),!a&&!isNaN(c.max)&&(s=Math.max(s,c.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),i=mt(i)&&!isNaN(i)?i:+t.startOf(Date.now(),r),s=mt(s)&&!isNaN(s)?s:+t.endOf(Date.now(),r)+1,this.min=Math.min(i,s-1),this.max=Math.max(i+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],r=e[e.length-1]),{min:t,max:r}}buildTicks(){const e=this.options,t=e.time,r=e.ticks,i=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const s=this.min,o=this.max,a=q$(i,s,o);return this._unit=t.unit||(r.autoSkip?Hy(t.minUnit,this.min,this.max,this._getLabelCapacity(s)):a6(this,a.length,t.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:l6(this._unit),this.initOffsets(i),e.reverse&&a.reverse(),jy(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,r=0,i,s;this.options.offset&&e.length&&(i=this.getDecimalForValue(e[0]),e.length===1?t=1-i:t=(this.getDecimalForValue(e[1])-i)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?r=s:r=(s-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;t=At(t,0,o),r=At(r,0,o),this._offsets={start:t,end:r,factor:1/(t+1+r)}}_generate(){const e=this._adapter,t=this.min,r=this.max,i=this.options,s=i.time,o=s.unit||Hy(s.minUnit,t,r,this._getLabelCapacity(t)),a=Ce(i.ticks.stepSize,1),l=o==="week"?s.isoWeekday:!1,c=So(l)||l===!0,u={};let d=t,f,h;if(c&&(d=+e.startOf(d,"isoWeek",l)),d=+e.startOf(d,c?"day":o),e.diff(r,t,o)>1e5*a)throw new Error(t+" and "+r+" are too far apart with stepSize of "+a+" "+o);const p=i.ticks.source==="data"&&this.getDataTimestamps();for(f=d,h=0;f<r;f=+e.add(f,a,o),h++)Wy(u,f,p);return(f===r||i.bounds==="ticks"||h===1)&&Wy(u,f,p),Object.keys(u).sort((m,g)=>m-g).map(m=>+m)}getLabelForValue(e){const t=this._adapter,r=this.options.time;return r.tooltipFormat?t.format(e,r.tooltipFormat):t.format(e,r.displayFormats.datetime)}format(e,t){const i=this.options.time.displayFormats,s=this._unit,o=t||i[s];return this._adapter.format(e,o)}_tickFormatFunction(e,t,r,i){const s=this.options,o=s.ticks.callback;if(o)return nt(o,[e,t,r],this);const a=s.time.displayFormats,l=this._unit,c=this._majorUnit,u=l&&a[l],d=c&&a[c],f=r[t],h=c&&d&&f&&f.major;return this._adapter.format(e,i||(h?d:u))}generateTickLabels(e){let t,r,i;for(t=0,r=e.length;t<r;++t)i=e[t],i.label=this._tickFormatFunction(i.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+r)*t.factor)}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,r=this.ctx.measureText(e).width,i=Yn(this.isHorizontal()?t.maxRotation:t.minRotation),s=Math.cos(i),o=Math.sin(i),a=this._resolveTickFontOptions(0).size;return{w:r*s+a*o,h:r*o+a*s}}_getLabelCapacity(e){const t=this.options.time,r=t.displayFormats,i=r[t.unit]||r.millisecond,s=this._tickFormatFunction(e,0,jy(this,[e],this._majorUnit),i),o=this._getLabelSize(s),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],t,r;if(e.length)return e;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(t=0,r=i.length;t<r;++t)e=e.concat(i[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,r;if(e.length)return e;const i=this.getLabels();for(t=0,r=i.length;t<r;++t)e.push(Vy(this,i[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return hw(e.sort(o6))}}se(dl,"id","time"),se(dl,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function gc(n,e,t){let r=0,i=n.length-1,s,o,a,l;t?(e>=n[r].pos&&e<=n[i].pos&&({lo:r,hi:i}=Br(n,"pos",e)),{pos:s,time:a}=n[r],{pos:o,time:l}=n[i]):(e>=n[r].time&&e<=n[i].time&&({lo:r,hi:i}=Br(n,"time",e)),{time:s,pos:a}=n[r],{time:o,pos:l}=n[i]);const c=o-s;return c?a+(l-a)*(e-s)/c:a}class jh extends dl{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=gc(t,this.min),this._tableRange=gc(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:r}=this,i=[],s=[];let o,a,l,c,u;for(o=0,a=e.length;o<a;++o)c=e[o],c>=t&&c<=r&&i.push(c);if(i.length<2)return[{time:t,pos:0},{time:r,pos:1}];for(o=0,a=i.length;o<a;++o)u=i[o+1],l=i[o-1],c=i[o],Math.round((u+l)/2)!==c&&s.push({time:c,pos:o/(a-1)});return s}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),r=this.getLabelTimestamps();return t.length&&r.length?e=this.normalize(t.concat(r)):e=t.length?t:r,e=this._cache.all=e,e}getDecimalForValue(e){return(gc(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return gc(this._table,r*this._tableRange+this._minPos,!0)}}se(jh,"id","timeseries"),se(jh,"defaults",dl.defaults);var u6=Object.freeze({__proto__:null,CategoryScale:Fh,LinearScale:Vh,LogarithmicScale:Hh,RadialLinearScale:pa,TimeScale:dl,TimeSeriesScale:jh});const d6=[wD,GE,W8,u6];cm.register(...d6);let Uy=0;function jo(n="id"){return Uy++,dd({id:"".concat(n,"-").concat(Uy)})}const f6=W({props:{data:{type:Object,required:!0},type:{type:String,default:"bar"}},setup(n){const{id:e}=jo("bar-chart"),t=Object.keys(n.data),r="MM/YY",i=Ei(t.shift()||"",r),s=Ei(t.pop()||"",r);return Ke(()=>{const o=document.getElementById(e),a=o==null?void 0:o.getContext("2d");if(!a)return;const l="#B6CFFB",c="#3558A2";let u={data:Object.values(n.data),type:n.type};if(n.type==="bar"){const d=u;d.barPercentage=1,d.categoryPercentage=.9,d.backgroundColor=d.data.map((f,h)=>h===d.data.length-1?c:l),u=d}new cm(a,{data:{labels:Object.keys(n.data),datasets:[u]},options:{animation:!1,responsive:!0,locale:Hp,plugins:{legend:{display:!1},tooltip:{enabled:!1}},elements:{bar:{backgroundColor:l,borderRadius:2,hoverBackgroundColor:c},line:{backgroundColor:c,borderColor:c,borderJoinStyle:"round",tension:.35},point:{radius:0}},scales:{x:{display:!1,grid:{display:!1},ticks:{display:!1}},y:{display:!1,grid:{display:!1},ticks:{display:!1}}},layout:{padding:{top:1.5}}}})}),{id:e,startDate:i,endDate:s}}}),h6=["id"],p6={class:"fr-grid-row justify-between"},m6={class:"text-xxs fr-m-0 text-mention-grey"},g6={class:"text-xxs fr-m-0 text-mention-grey"};function v6(n,e,t,r,i,s){return _(),S(X,null,[y("canvas",{id:n.id,width:"120",height:"30"},null,8,h6),y("div",p6,[y("p",m6,T(n.startDate),1),y("p",g6,T(n.endDate),1)])],64)}const y6=Ne(f6,[["render",v6]]),b6=W({props:{author:{type:Object,required:!0},badge:Boolean}}),w6={class:"fr-text--sm fr-mb-0"},_6={key:0,class:"fr-badge fr-ml-3v"};function k6(n,e,t,r,i,s){return _(),S("span",w6,[Y(T(n.author.first_name+" "+n.author.last_name)+" ",1),n.badge?(_(),S("span",_6,T(n.$t("Admin")),1)):V("",!0)])}const Hu=Ne(b6,[["render",k6]]),x6=W({emits:["click"],props:{primary:{type:Boolean,default:!1}}});function C6(n,e,t,r,i,s){return _(),S("button",{type:"button",class:me(["fr-btn",{"fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 fr-icon-add-line fr-btn--icon-left":!n.primary}]),onClick:e[0]||(e[0]=$e(o=>n.$emit("click"),["prevent"]))},T(n.$t("Start a new discussion")),3)}const Uh=Ne(x6,[["render",C6]]),S6={};function M6(n,e){const t=yt("i18n-t");return _(),G(t,{keypath:"Fields preceded by a star ({markup}) are required.",tag:"p",class:"fr-mt-0 fr-mb-1w fr-text--xs",scope:"global"},{markup:K(()=>e[0]||(e[0]=[y("span",{class:"required-field-star"},"*",-1)])),_:1})}const fm=Ne(S6,[["render",M6]]),T6=W({expose:["displayForm"],components:{ThreadCreateButton:Uh,Author:Hu,RequiredExplanation:fm},props:{showCreateButton:{type:Boolean,default:!1},subjectId:{type:String,required:!0},subjectClass:{type:String,required:!0},onSubmit:{type:Function,required:!0}},setup(n){const e=E(!1),t=E(!1),r=E(""),i=E("");return{loading:e,showForm:t,title:r,comment:i,user:Ia,displayForm:()=>{Ml(),t.value=!0},hideForm:()=>{t.value=!1},submit:()=>{e.value=!0;const l={title:r.value,comment:i.value,subject:{id:n.subjectId,class:n.subjectClass}};n.onSubmit(l).finally(()=>{var c;e.value=!1,t.value=!1,r.value=i.value="",(c=document.querySelector("[data-no-discussion]"))==null||c.remove()})}}}}),O6={class:"thread-create fr-mt-2w"},$6={key:1,class:"bg-contrast-grey"},D6={class:"fr-grid-row fr-grid-row--middle fr-py-2w fr-px-3w"},E6={class:"fr-col fr-h6 fr-mb-0"},A6={class:"thread-comment fr-pb-3w fr-px-3w"},P6={class:"fr-input-group"},N6={for:"thread-title",class:"fr-label required"},R6=["placeholder"],L6={class:"fr-input-group"},I6={for:"thread-comment",class:"fr-label required"},z6=["placeholder"],B6={class:"fr-grid-row justify-between fr-grid-row--middle"},F6={class:"text-mention-grey fr-text--sm fr-mb-0"},V6=["value"];function H6(n,e,t,r,i,s){const o=yt("ThreadCreateButton"),a=yt("RequiredExplanation"),l=yt("Author");return _(),S("div",O6,[n.showCreateButton&&!n.showForm?(_(),G(o,{key:0,onClick:n.displayForm},null,8,["onClick"])):V("",!0),n.showForm?(_(),S("div",$6,[y("div",D6,[y("div",E6,T(n.$t("New discussion")),1),y("div",null,[y("button",{class:"fr-btn--close fr-btn text-grey-500 fr-mr-0",onClick:e[0]||(e[0]=(...c)=>n.hideForm&&n.hideForm(...c))},T(n.$t("Close")),1)])]),y("div",A6,[y("form",{class:"form fr-p-0",onSubmit:e[3]||(e[3]=$e((...c)=>n.submit&&n.submit(...c),["prevent"]))},[P(a),y("div",P6,[y("label",N6,T(n.$t("Title")),1),xt(y("input",{class:"fr-input",type:"text",id:"thread-title","onUpdate:modelValue":e[1]||(e[1]=c=>n.title=c),placeholder:n.$t("Title"),required:!0},null,8,R6),[[Di,n.title]])]),y("div",L6,[y("label",I6,T(n.$t("Message")),1),xt(y("textarea",{id:"thread-comment","onUpdate:modelValue":e[2]||(e[2]=c=>n.comment=c),placeholder:n.$t("Comment"),class:"fr-input",required:!0},null,8,z6),[[Di,n.comment]])]),y("footer",B6,[y("span",F6,[Y(T(n.$t("Reply as"))+" ",1),P(l,{author:n.user},null,8,["author"])]),y("input",{type:"submit",value:n.$t("Submit"),class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500"},null,8,V6)])],32)])])):V("",!0)])}const r_=Ne(T6,[["render",H6]]);var W6=Object.defineProperty,j6=(n,e,t)=>e in n?W6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,vc=(n,e,t)=>(j6(n,typeof e!="symbol"?e+"":e,t),t);const es={TOP_RIGHT:"top-right",TOP:"top",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",BOTTOM:"bottom",BOTTOM_LEFT:"bottom-left"};function qy(n,e,t){let r=e;switch(n){case es.TOP:case es.TOP_RIGHT:case es.TOP_LEFT:r=e;break;case es.BOTTOM:case es.BOTTOM_RIGHT:case es.BOTTOM_LEFT:r=t;break}return r}const U6=n=>{typeof n.remove<"u"?n.remove():n.parentNode&&n.parentNode.removeChild(n)};let q6=class{constructor(e,t){vc(this,"startedAt"),vc(this,"callback"),vc(this,"delay"),vc(this,"timer"),this.startedAt=Date.now(),this.callback=e,this.delay=t,this.timer=setTimeout(e,t)}pause(){this.stop(),this.delay-=Date.now()-this.startedAt}resume(){this.stop(),this.startedAt=Date.now(),this.timer=setTimeout(this.callback,this.delay)}stop(){clearTimeout(this.timer)}};function Y6(n){return{all:n=n||new Map,on:function(e,t){var r=n.get(e);r?r.push(t):n.set(e,[t])},off:function(e,t){var r=n.get(e);r&&(t?r.splice(r.indexOf(t)>>>0,1):n.set(e,[]))},emit:function(e,t){var r=n.get(e);r&&r.slice().map(function(i){i(t)}),(r=n.get("*"))&&r.slice().map(function(i){i(e,t)})}}}const qh=Y6(),K6=W({__name:"Toaster",props:{message:{},type:{default:"default"},position:{default:es.BOTTOM_RIGHT},maxToasts:{type:[Number,Boolean],default:!1},duration:{type:[Number,Boolean],default:4e3},dismissible:{type:Boolean,default:!0},queue:{type:Boolean,default:!1},props:{type:Boolean,default:!0},useDefaultCss:{type:Boolean,default:!0},onClose:{type:Function,default:()=>{}},onClick:{type:Function,default:()=>{}}},setup(n){const e=n;let t=null,r=null,i=null,s;const o=E(null),a=E(!1);zp(()=>{l(),c(),u()}),Ke(()=>{f(),qh.on("toast-clear",g)});function l(){t=document.querySelector(".c-toast-container--top"),r=document.querySelector(".c-toast-container--bottom"),!(t&&r)&&(t||(t=document.createElement("div"),t.className="c-toast-container c-toast-container--top"),r||(r=document.createElement("div"),r.className="c-toast-container c-toast-container--bottom"))}function c(){const b=e.useDefaultCss?"add":"remove";t&&t.classList[b]("v--default-css"),r&&r.classList[b]("v--default-css")}function u(){const b=document.body;t&&b.appendChild(t),r&&b.appendChild(r)}function d(){if(!e.queue&&e.maxToasts===!1)return!1;let b=0;t&&(b=t.childElementCount);let C=0;return r&&(C=r.childElementCount),e.maxToasts!==!1?e.maxToasts<=b+C:b>0||C>0}function f(){if(d()){s=window.setTimeout(f,250);return}const b=w();b&&o.value&&(b.insertAdjacentElement("afterbegin",o.value),a.value=!0,i=e.duration!==!1?new q6(g,e.duration):null)}function h(){e.onClick.apply(null,arguments),e.dismissible&&g()}function p(b){i&&(b?i.pause():i.resume())}function m(){i&&i.stop(),clearTimeout(s)}function g(){m(),a.value=!1,setTimeout(()=>{e.onClose.apply(null,arguments),o.value&&U6(o.value)},150)}function w(){return!t||!r?null:qy(e.position,t,r)}const x=A(()=>qy(e.position,{enter:"fadeInDown",leave:"fadeOut"},{enter:"fadeInUp",leave:"fadeOut"})),M=A(()=>e.dismissible?"button":"div");return cb(()=>{qh.off("toast-clear",g)}),(b,C)=>(_(),G(Sl,{"enter-active-class":x.value.enter,"leave-active-class":x.value.leave,ref_key:"el",ref:o},{default:K(()=>[xt((_(),G(ys(M.value),{class:me(["c-toast","c-toast--".concat(b.type),"c-toast--".concat(b.position)]),onMouseover:C[0]||(C[0]=k=>p(!0)),onMouseleave:C[1]||(C[1]=k=>p(!1)),onClick:h,role:"alert"},{default:K(()=>[Y(T(b.message),1)]),_:1},40,["class"])),[[di,a.value]])]),_:1},8,["enter-active-class","leave-active-class"]))}}),G6=()=>typeof document<"u"?document.createElement("div"):null;function X6(n,{props:e}={}){let t=G6(),r=Mt(n,e);return t&&mv(r,t),{vNode:r,destroy:()=>{t&&mv(null,t),t=null,r=null},el:t}}function J6(n={}){return{show(e,t={}){let r={message:e,...t};return X6(K6,{props:{...n,...r}})},clear(){qh.emit("toast-clear")},success(e,t={}){return t.type="success",this.show(e,t)},error(e,t={}){return t.type="error",this.show(e,t)},info(e,t={}){return t.type="info",this.show(e,t)},warning(e,t={}){return t.type="warning",this.show(e,t)}}}const Z6=J6({duration:!1,dismissible:!0});function Bn(){return{toast:Z6}}const Q6=W({components:{Author:Hu,RequiredExplanation:fm},emits:["close"],props:{onSubmit:{type:Function,required:!0}},setup(n){const{t:e}=De(),{toast:t}=Bn(),r=E(!1),i=E("");return{comment:i,loading:r,submit:()=>{r.value=!0,n.onSubmit(i.value).catch(o=>{t.error(e("Error sending response"))}).finally(()=>{r.value=!1,i.value=""})},user:Ia}}}),eA={class:"thread-reply"},tA={class:"fr-grid-row fr-grid-row--middle fr-mb-3v"},nA={class:"fr-col fr-text--bold fr-mb-0"},rA={class:"fr-col-auto"},iA={class:"fr-input-group"},sA={class:"fr-label required",for:"textarea"},oA={class:"fr-grid-row justify-between fr-grid-row--middle"},aA={class:"text-mention-grey fr-text--sm fr-m-0"},lA=["value"];function cA(n,e,t,r,i,s){const o=yt("RequiredExplanation"),a=yt("Author");return _(),S("div",eA,[y("div",tA,[y("h4",nA,T(n.$t("Reply to the discussion")),1),y("div",rA,[y("button",{class:"fr-btn--close fr-btn text-grey-500 fr-mr-0",onClick:e[0]||(e[0]=l=>n.$emit("close"))},T(n.$t("Close")),1)])]),y("form",{class:"form fr-p-0",onSubmit:e[2]||(e[2]=$e((...l)=>n.submit&&n.submit(...l),["prevent"]))},[P(o),y("div",iA,[y("label",sA,T(n.$t("Comment")),1),xt(y("textarea",{"onUpdate:modelValue":e[1]||(e[1]=l=>n.comment=l),required:"",class:"fr-input",id:"textarea"},null,512),[[Di,n.comment]])]),y("footer",oA,[y("p",aA,[Y(T(n.$t("Reply as"))+" ",1),P(a,{author:n.user},null,8,["author"])]),y("input",{type:"submit",value:n.$t("Submit"),class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500"},null,8,lA)])],32)])}const uA=Ne(Q6,[["render",cA]]),Yy=W({__name:"MarkAsNoSpam",props:{url:{},spam:{}},setup(n){const e=n,t=()=>kt.delete(e.url).then(()=>{window.location.reload()}),r=A(()=>e.spam&&e.spam.status&&e.spam.status==="potential_spam"&&Ia&&Ia.roles&&Ia.roles.includes("admin"));return(i,s)=>r.value?(_(),S("button",{key:0,class:"fr-btn fr-btn--sm fr-btn--icon-right fr-icon-feedback-fill",onClick:t},T(i.$t("Mark as no spam")),1)):V("",!0)}}),dA=["id"],fA={class:"fr-grid-row fr-grid-row--middle justify-between fr-py-2w fr-px-3w no-wrap wrap-md"},hA={key:0,class:"fr-col-auto text-default-warning fr-text--bold fr-pr-2w fr-my-0"},pA={class:"fr-col fr-mx-3v fr-mx-md-0 fr-h6 fr-mb-0"},mA={class:"fr-col-auto text-align-right"},gA=["id","data-clipboard-text"],vA={class:"fr-grid-row fr-grid-row--gutters"},yA={class:"fr-col-auto"},bA={class:"fr-col"},wA={class:"fr-my-0"},_A={class:"fr-text--sm text-mention-grey fr-m-0"},kA={class:"white-space-pre-wrap overflow-wrap-anywhere"},xA={class:"fr-my-0"},CA={key:0,class:"fr-py-2w fr-px-3w"},SA={class:"fr-py-2w fr-px-3w"},MA={key:1,class:"text-grey-380"},TA={class:"fr-px-1v"},Ky=W({__name:"Thread",props:{thread:{}},setup(n){const e=n,{t}=De(),r=E(!1),i=E([...e.thread.discussion]),s=E(!!e.thread.closed),o=A(()=>"discussions/"+e.thread.id),a=A(()=>{const u="#/"+o.value;return window.location.origin+window.location.pathname+u}),l=()=>{Ml(),r.value=!0},c=u=>kt.post("/discussions/"+e.thread.id+"/",{comment:u}).then(d=>d.data).then(d=>{i.value=d.discussion,r.value=!1});return(u,d)=>(_(),S("div",{class:"bg-contrast-grey fr-mt-2w",id:o.value},[y("header",fA,[u.thread.closed?(_(),S("p",hA,[y("span",null,T(v(t)("Discussion closed")),1)])):V("",!0),y("h3",pA,T(u.thread.title),1),y("div",mA,[P(Yy,{url:"discussions/".concat(u.thread.id,"/spam"),spam:u.thread.spam,class:"fr-mr-3v"},null,8,["url","spam"]),y("button",{id:u.thread.id+"-copy","data-clipboard-text":a.value,class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 fr-btn--icon-right fr-icon-links-fill"},T(v(t)("Copy discussion permalink")),9,gA)])]),y("div",null,[P(pC,{name:"list"},{default:K(()=>[s.value?V("",!0):(_(!0),S(X,{key:0},Ye(i.value,(f,h)=>(_(),S("article",{class:"thread-comment fr-py-3w fr-px-3w fr-pr-5w",key:"comment-".concat(u.thread.id,"-").concat(h)},[y("div",vA,[y("div",yA,[P(v(vb),{user:f.posted_by},null,8,["user"])]),y("div",bA,[y("p",wA,[P(Hu,{author:f.posted_by,badge:!1},null,8,["author"])]),y("p",_A,T(v(Ei)(f.posted_on)),1),P(v(nw),{class:"fr-mt-3v"},{default:K(()=>[y("div",kA,[y("p",xA,T(f.content),1)])]),_:2},1024),P(Yy,{url:"discussions/".concat(u.thread.id,"/comments/").concat(h,"/spam"),spam:f.spam,class:"fr-mt-3v"},null,8,["url","spam"])])])]))),128))]),_:1}),s.value?(_(),S("div",CA,[y("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500",onClick:d[0]||(d[0]=$e(f=>s.value=!1,["prevent"]))},T(v(t)("See {n} messages",i.value.length)),1)])):V("",!0)]),y("footer",SA,[!u.thread.closed&&!v(md)?(_(),S(X,{key:0},[r.value?(_(),G(uA,{key:1,subjectId:u.thread.id,onSubmit:c,onClose:d[1]||(d[1]=f=>r.value=!1)},null,8,["subjectId"])):(_(),S("button",{key:0,class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500 fr-btn--icon-right fr-icon-arrow-right-s-line",onClick:$e(l,["stop"])},T(v(t)("Reply")),1))],64)):V("",!0),u.thread.closed?(_(),S("div",MA,[Y(T(v(t)("The discussion was closed by"))+" ",1),y("strong",TA,[P(Hu,{author:u.thread.closed_by},null,8,["author"])]),Y(" "+T(v(t)("on"))+" "+T(v(Ei)(u.thread.closed)),1)])):V("",!0)])],8,dA))}}),OA={components:{ContentLoader:$l}};function $A(n,e,t,r,i,s){const o=yt("ContentLoader");return _(),G(o,{width:280,height:180,speed:2,primaryColor:"#7c7c7c",secondaryColor:"#2d2d2d"},{default:K(()=>e[0]||(e[0]=[y("rect",{x:"104",y:"41",rx:"3",ry:"3",width:"162",height:"10"},null,-1),y("rect",{x:"105",y:"63",rx:"3",ry:"3",width:"139",height:"5"},null,-1),y("rect",{x:"26",y:"99",rx:"5",ry:"5",width:"60",height:"60"},null,-1),y("rect",{x:"104",y:"113",rx:"3",ry:"3",width:"162",height:"10"},null,-1),y("rect",{x:"105",y:"135",rx:"3",ry:"3",width:"139",height:"5"},null,-1),y("rect",{x:"26",y:"24",rx:"5",ry:"5",width:"60",height:"60"},null,-1)])),_:1})}const DA=Ne(OA,[["render",$A]]);function EA(n){const e=E(null),t=()=>{const i=window.location.hash;for(const s of n){let[o,a,l]=s.exec(i)||[];if(a)return e.value=a}e.value=null},r=()=>{history.pushState(null,""," "),window.dispatchEvent(new HashChangeEvent("hashchange"))};return Ke(()=>{t(),window.addEventListener("hashchange",()=>t())}),{id:dd(e),resetHash:r}}const AA={key:0,class:"fr-grid-row fr-grid-row--middle"},PA={class:"fr-col"},NA={id:"community-discussions",class:"subtitle subtitle--uppercase"},RA={key:0,class:"fr-col-12 fr-col-md-6 fr-grid-row fr-grid-row--gutters fr-grid-row--middle fr-grid-row--right"},LA={class:"fr-col-auto"},IA=["aria-label"],zA=["value","selected"],BA={class:"fr-col-auto"},FA={key:1,class:"fr-grid-row fr-grid-row--center"},VA={key:0},HA={class:"fr-grid-row fr-grid-row--middle justify-between"},WA={class:"text-decoration-underline"},jA={key:1},UA={class:"fr-mb-5v"},Tf=5,qA=W({__name:"Threads",props:{subjectId:{},subjectClass:{}},setup(n,{expose:e}){const t=n,{t:r}=De(),{toast:i}=Bn(),s=E([]),o=/discussions\/([a-f0-9]{24})-?([0-9]+)?$/i,a=/discussion-([a-f0-9]{24})-?([0-9]+)?$/i,{id:l,resetHash:c}=EA([o,a]),u=E(null),d=E(1),f=E(0),h=E(!0),p=[{name:r("Discussion creation"),key:"-created"},{name:r("Last reply"),key:"-discussion.posted_on"}],m=E(p[0]),g=E(null),w=()=>{x(l.value)},x=N=>{if(N)return h.value=!0,setTimeout(()=>{g.value&&g.value.scrollIntoView({behavior:"smooth"})},500),kt.get("/discussions/"+N).then(B=>B.data).then(B=>{B&&(u.value=B,f.value=1)}).catch(()=>{i.error(r("An error occurred while fetching the discussion ")+N),M(1)}).finally(()=>{h.value=!1})},M=(N=1,B=!1)=>(N=pt(N),h.value=!0,B&&setTimeout(()=>{g.value&&g.value.scrollIntoView({behavior:"smooth"})},500),kt.get("/discussions/",{params:{page:N,for:t.subjectId,sort:m.value.key,page_size:Tf}}).then(U=>U.data).then(U=>{U.data&&(s.value=U.data,f.value=U.total)}).catch(()=>{i.error(r("An error occurred while fetching discussions")),s.value=[]}).finally(()=>{h.value=!1})),b=E(null),C=()=>{k(),b.value&&b.value.$el.scrollIntoView()},k=()=>{b.value&&b.value.displayForm()},$=N=>kt.post("/discussions/",N).then(()=>{d.value=1,M(1,!0)}).catch(B=>i.error(r("An error occurred while creating the discussion "),B)),O=(N,B=!0)=>{d.value=N,M(N,B)},D=N=>{m.value=N,M(d)};return Ke(()=>{M()}),zt(()=>{l.value&&w()}),it(f,N=>{const B=document.querySelectorAll(".discussions-count");B&&B.forEach(U=>U.innerHTML=N.toFixed(0))}),e({startThread:C}),(N,B)=>(_(),S("section",{class:"discussions-wrapper",ref_key:"top",ref:g},[f.value?(_(),S("div",AA,[y("div",PA,[y("h2",NA,T(v(r)("{n} discussions",f.value)),1)]),v(l)?V("",!0):(_(),S("div",RA,[y("div",LA,[xt(y("select",{name:"sortBy",id:"sortBy","aria-label":v(r)("Sort discussions by"),onChange:B[0]||(B[0]=U=>D(m.value)),"onUpdate:modelValue":B[1]||(B[1]=U=>m.value=U),class:"fr-select fr-select--no-border fr-select--blue"},[(_(),S(X,null,Ye(p,U=>y("option",{value:U,selected:U===m.value},T(U.name),9,zA)),64))],40,IA),[[fd,m.value]])]),y("div",BA,[P(Uh,{onClick:k})])]))])):(_(),S("div",FA,[P(Uh,{class:"fr-col--bottom",primary:!0,onClick:k})])),P(Sl,{mode:"out-in"},{default:K(()=>[h.value?(_(),G(DA,{key:0,class:"fr-mt-2w"})):(_(),S(X,{key:1},[v(l)?(_(),S("div",VA,[P(v(Au),{type:"secondary",color:"success",class:"fr-mt-2w","data-cy":"threadFromURL"},{default:K(()=>[y("div",HA,[Y(T(v(r)("You are seeing a specific discussion about this dataset."))+" ",1),y("button",{class:"fr-btn--close fr-btn fr-mr-0",onClick:B[2]||(B[2]=$e((...U)=>v(c)&&v(c)(...U),["prevent"]))},T(v(r)("Close")),1)])]),_:1}),u.value?(_(),G(Ky,{key:0,thread:u.value},null,8,["thread"])):(_(),G(v(Au),{key:1,type:"secondary",color:"warning",class:"fr-mt-2w"},{default:K(()=>[Y(T(N.$t("This discussion doesn't exist or was deleted.")),1)]),_:1})),y("button",{class:"nav-link nav-link--no-icon text-decoration-none fr-link fr-mt-9v fr-link--icon-left fr-icon-arrow-right-s-line",onClick:B[3]||(B[3]=$e((...U)=>v(c)&&v(c)(...U),["prevent"]))},[y("span",WA,T(v(r)("See all discussions about this dataset")),1)])])):(_(),S("div",jA,[v(md)?V("",!0):(_(),G(r_,{key:0,ref_key:"createThread",ref:b,onSubmit:$,subjectId:N.subjectId,subjectClass:N.subjectClass},null,8,["subjectId","subjectClass"])),y("ul",UA,[(_(!0),S(X,null,Ye(s.value,U=>(_(),S("li",null,[P(Ky,{thread:U},null,8,["thread"])]))),256))]),f.value>Tf?(_(),G(v(js),{key:1,page:d.value,"page-size":Tf,"total-results":f.value,onChange:O},null,8,["page","total-results"])):V("",!0)]))],64))]),_:1})],512))}}),YA=["href"],KA={class:"fr-grid-row fr-grid-row--middle"},GA=W({__name:"MenuSearchOption",props:{icon:{},query:{},link:{},type:{}},setup(n){return(e,t)=>{const r=yt("i18n-t");return _(),S("a",{class:"fr-nav__link unstyled",href:e.link},[y("div",KA,[y("span",{class:me(["fr-icon--sm align-[-1px] fr-mr-1w",e.icon]),"aria-hidden":"true"},null,2),e.query?(_(),G(r,{key:0,keypath:"Search {query} in {type}",class:"fr-col",tag:"div",scope:"global"},{query:K(()=>[y("em",null,T(e.query),1)]),type:K(()=>[y("strong",null,T(e.type),1)]),_:1})):(_(),G(r,{key:1,keypath:"Start typing to search in X",class:"fr-col",tag:"div",scope:"global"},{type:K(()=>[y("strong",null,T(e.type),1)]),_:1})),t[0]||(t[0]=y("div",{"aria-hidden":"true",class:"fr-col-auto"},[y("span",{class:"fr-icon-arrow-right-s-line fr-icon--sm","aria-hidden":"true"})],-1))])],8,YA)}}});function i_(n){const e=A(()=>"".concat($C,"?q=").concat(pt(n))),t=A(()=>"".concat(DC,"?q=").concat(pt(n))),r=A(()=>"".concat(EC,"?q=").concat(pt(n))),i=A(()=>"".concat(AC,"?q=").concat(pt(n)));return{dataserviceUrl:t,datasetUrl:e,organizationUrl:r,reuseUrl:i}}function XA(){const n=Ws("collapse"),e=E(!1),t=()=>e.value=!0,r=()=>e.value=!1,i=()=>e.value=!e.value;let s=null;const o=(d,f,h)=>{const p=pt(d),m=pt(f),g=pt(h);s=c(p,m,g),document.body.addEventListener("pointerup",s,!0)},a=()=>{s&&document.body.removeEventListener("pointerup",s,!0)},l=(d,f)=>d?!d.contains(f):!0,c=(d,f,h)=>p=>{const m=p.target;l(d,m)&&l(f,m)&&l(h,m)&&r()};return{expanded:e,uid:n,show:t,hide:r,toggle:i,registerBackgroundEvent:o,removeBackgroundEvent:a,handleKeyPressForCollapse:d=>{switch(d.key){case"Alt":case"Control":case"Shift":case"CapsLock":break;case"Escape":case"Tab":r();break;default:t()}}}}function JA(n){const e=E(),t=A(()=>pt(n).find(f=>f.id===e.value)),r=f=>e.value===f,i=f=>{if(f===void 0)return o(0);e.value=f},s=()=>{e.value=void 0},o=f=>{let h=pt(n);h[f]&&i(h[f].id)},a=()=>{let f=0;e.value&&(f=pt(n).findIndex(h=>h.id===e.value),f++,f===pt(n).length&&(f=0)),o(f)},l=()=>{const f=pt(n).length-1;let h=f;e.value&&(h=pt(n).findIndex(p=>p.id===e.value),h--,h<0&&(h=f)),o(h)};return{select:i,selected:e,selectedOption:t,isSelected:r,focusOut:s,handleKeyPressForActiveDescendant:(f,h=!1)=>{switch(f.key){case"ArrowDown":!h&&!f.altKey&&a();break;case"ArrowUp":l();break;case"ArrowLeft":case"ArrowRight":case"Home":case"End":case"Escape":s();break}},ALREADY_MOVED_DOWN:!0,NOT_MOVED_YET:!1}}function ZA(n,e){const t=E(null),r=E(null),i=E(null),{expanded:s,handleKeyPressForCollapse:o,hide:a,registerBackgroundEvent:l,removeBackgroundEvent:c,show:u,uid:d}=XA(),{focusOut:f,handleKeyPressForActiveDescendant:h,isSelected:p,select:m,selected:g,selectedOption:w,NOT_MOVED_YET:x,ALREADY_MOVED_DOWN:M}=JA(n);function b(){pt(e)&&(u(),m(g.value))}function C(){var D;s.value?k():((D=t.value)==null||D.focus(),b())}function k(){w.value&&(window.location.href=w.value.link)}function $(D){b();let N=x;s.value||(N=M),o(D),h(D,N)}function O(){f(),a()}return Ke(()=>{l(t,r,i)}),Xn(()=>{c()}),{buttonRef:i,expanded:s,focusOut:f,handleFocusOut:O,handleKeyDown:$,handleKeyPressForActiveDescendant:h,handleKeyPressForCollapse:o,hide:a,inputRef:t,isSelected:p,listRef:r,registerBackgroundEvent:l,removeBackgroundEvent:c,searchSelectedOption:k,select:m,selected:g,show:u,showAndFocus:C,showAndSelectIfQuery:b,uid:d,NOT_MOVED_YET:x,ALREADY_MOVED_DOWN:M}}const QA=["id"],eP=["for","id"],tP=["placeholder","aria-controls","aria-expanded","id","aria-activedescendant"],nP=["aria-controls","aria-expanded"],rP=["id","aria-labelledby"],iP={class:"fr-menu__list",role:"listbox"},sP=["id","aria-selected"],oP=W({__name:"MenuSearch",setup(n){const{t:e}=De(),t=E(""),{datasetUrl:r,dataserviceUrl:i,reuseUrl:s,organizationUrl:o}=i_(t),{id:a}=jo("search"),l=A(()=>"".concat(a,"-input")),c=A(()=>"".concat(a,"-label")),u=E([{id:"dataset-option",icon:"fr-icon-database-line",type:e("datasets"),link:r},{id:"dataservice-option",icon:"fr-icon-code-s-slash-line",type:e("dataservices"),link:i},{id:"reuse-option",icon:"fr-icon-line-chart-line",type:e("reuses"),link:s},{id:"organization-option",icon:"fr-icon-government-line",type:e("organizations"),link:o}]),{buttonRef:d,expanded:f,handleFocusOut:h,handleKeyDown:p,inputRef:m,isSelected:g,listRef:w,searchSelectedOption:x,selected:M,showAndFocus:b,showAndSelectIfQuery:C,uid:k}=ZA(u,t);return($,O)=>(_(),S("div",{id:v(a),class:"fr-col fr-search-bar wrap",role:"search"},[y("label",{class:"fr-label",for:l.value,id:c.value},T(v(e)("Search for data")),9,eP),xt(y("input",{class:"fr-input fr-col",placeholder:v(e)("Search"),ref_key:"inputRef",ref:m,autocomplete:"off",role:"combobox","aria-autocomplete":"list","aria-controls":v(k),"aria-expanded":v(f),id:l.value,"data-cy":"search-input","aria-activedescendant":v(M),name:"q","onUpdate:modelValue":O[0]||(O[0]=D=>t.value=D),onClickCapture:O[1]||(O[1]=$e((...D)=>v(C)&&v(C)(...D),["stop"])),onKeydown:O[2]||(O[2]=(...D)=>v(p)&&v(p)(...D)),onKeypress:O[3]||(O[3]=Bp($e((...D)=>v(x)&&v(x)(...D),["prevent"]),["enter"])),onBlur:O[4]||(O[4]=(...D)=>v(h)&&v(h)(...D))},null,40,tP),[[Di,t.value]]),y("button",{type:"button",ref_key:"buttonRef",ref:d,class:"fr-btn",tabindex:"-1","aria-controls":v(k),"aria-expanded":v(f),onClickCapture:O[5]||(O[5]=$e((...D)=>v(b)&&v(b)(...D),["prevent","stop"]))},T(v(e)("Search")),41,nP),y("div",{class:"fr-menu fr-collapse autocomplete",id:v(k),ref_key:"listRef",ref:w,role:"listbox","aria-labelledby":c.value,onMousedown:O[6]||(O[6]=$e(()=>{},["prevent"]))},[y("ul",iP,[(_(!0),S(X,null,Ye(u.value,D=>(_(),S("li",{key:D.id,id:D.id,role:"option","aria-selected":v(g)(D.id)},[P(GA,{icon:D.icon,query:t.value,type:D.type,link:D.link},null,8,["icon","query","type","link"])],8,sP))),128))])],40,rP)],8,QA))}}),aP=W({emits:["change"],props:{value:{type:String,required:!0},placeholder:{type:String,required:!0}},setup(n,{emit:e}){const{id:t}=jo("search-input"),r=E(n.value),i=E(null),s=()=>{var l;(l=i.value)==null||l.focus({preventScroll:!0})},o=()=>{r.value===""&&e("change",r.value)},a=l=>{const c=l.target;e("change",c.value)};return Ke(async()=>{await rl(),s()}),zt(()=>{r.value=n.value}),{id:t,input:i,onDelete:o,onInput:a,queryString:r}}}),lP={class:"fr-search-bar fr-search-bar--lg w-100"},cP=["for"],uP=["id","value","aria-label","placeholder"],dP={class:"fr-btn",type:"submit"};function fP(n,e,t,r,i,s){return _(),S("section",lP,[y("label",{class:"fr-label",for:n.id},T(n.$t("Search")),9,cP),y("input",{id:n.id,type:"search",name:"q",value:n.queryString,onInput:e[0]||(e[0]=(...o)=>n.onInput&&n.onInput(...o)),onKeydown:e[1]||(e[1]=Bp((...o)=>n.onDelete&&n.onDelete(...o),["delete"])),ref:"input",class:"fr-input","aria-label":n.placeholder||n.$t("Search..."),placeholder:n.placeholder||n.$t("Search..."),"data-cy":"search-input","data-testid":"search-input"},null,40,uP),y("button",dP,T(n.$t("Search")),1)])}const hP=Ne(aP,[["render",fP]]),s_=W({__name:"card-lg",props:{dataset:{},style:{type:[Boolean,null,String,Object,Array]},showDescription:{type:Boolean,default:!0}},setup(n){return(e,t)=>{var r;return _(),G(v(F4),{dataset:e.dataset,style:Wo(e.style),showDescription:e.showDescription,"dataset-url":e.dataset.page,"organization-url":(r=e.dataset.organization)==null?void 0:r.page},null,8,["dataset","style","showDescription","dataset-url","organization-url"])}}}),pP=W({components:{ContentLoader:$l},setup(n){const e=cs.resources_default_page_size,t=88;return{pageSize:e,height:t,getPosition:(i,s)=>(i-1)*t+s}}}),mP=["y"],gP=["y"],vP=["y"],yP=["y"],bP=["y"];function wP(n,e,t,r,i,s){const o=yt("ContentLoader");return _(),G(o,{width:1200,height:n.height*n.pageSize,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},{default:K(()=>[(_(!0),S(X,null,Ye(n.pageSize,a=>(_(),S(X,null,[y("rect",{x:"20",y:n.getPosition(a,24),rx:"4",ry:"4",width:"16",height:"16"},null,8,mP),y("rect",{x:"52",y:n.getPosition(a,20),rx:"4",ry:"4",width:"536",height:"22"},null,8,gP),y("rect",{x:"52",y:n.getPosition(a,52),rx:"4",ry:"4",width:"374",height:"16"},null,8,vP),y("rect",{x:"1052",y:n.getPosition(a,30),rx:"4",ry:"4",width:"80",height:"20"},null,8,yP),y("rect",{x:"1154",y:n.getPosition(a,20),rx:"20",ry:"20",width:"40",height:"40"},null,8,bP)],64))),256))]),_:1},8,["height"])}const hm=Ne(pP,[["render",wP]]),_P={help:"Utilisez la tabulation (ou les touches flèches) pour naviguer dans la liste des suggestions",placeholder:"Rechercher dans la liste",noResult:"Aucun résultat",results:"{x} suggestion(s) disponibles",deleteItem:"Supprimer {t}",delete:"Supprimer",clear:"Vider"},kP=Element.prototype.matches;let ho=Element.prototype.closest;ho||(ho=function(n){var e=this;do{if(kP.call(e,n))return e;e=e.parentElement||e.parentNode}while(e!==null&&e.nodeType===1);return null});const xP=!0,CP=!1;function oa(n){return Array.from(n).map(e=>e.cloneNode(xP))}function SP(n){return n.parentNode.tagName==="OPTGROUP"&&(n.dataset.group=n.parentNode.label),n}let MP=class{constructor(e,t){var o;var r;this.el=e,this.label=document.querySelector("label[for=".concat(e.id,"]")),this.id=e.id,this.open=!1,this.multiple=this.el.multiple,this.search="",this.suggestions=[],this.focusIndex=null;const i=Object.assign({},t),s=Object.assign({},_P,i.text);if(delete i.text,this._defaultSearch=this._defaultSearch.bind(this),this._options=Object.assign({text:s,showSelected:!0,fillSuggestions:this._defaultSearch,useLabelAsButton:!1,clearable:!1},i),this._handleFocus=this._handleFocus.bind(this),this._handleInput=this._handleInput.bind(this),this._handleKeyboard=this._handleKeyboard.bind(this),this._handleOpener=this._handleOpener.bind(this),this._handleClear=this._handleClear.bind(this),this._handleReset=this._handleReset.bind(this),this._handleSuggestionClick=this._handleSuggestionClick.bind(this),this._positionCursor=this._positionCursor.bind(this),this._removeOption=this._removeOption.bind(this),this.setText=this.setText.bind(this),this._setButtonText=this._setButtonText.bind(this),!this.multiple){const a=Array.from(this.el.options).some(l=>l.selected);if(this._options.useLabelAsButton&&!a){const l=document.createElement("option");l.innerText=(o=(r=this.label)==null?void 0:r.innerText)!=null?o:"",l.setAttribute("value",""),l.setAttribute("selected","selected"),l.setAttribute("disabled","disabled"),l.setAttribute("hidden","hidden"),this.el.options.add(l,0)}}this.originalOptions=oa(Array.from(this.el.options).map(SP)),this.updatedOriginalOptions=oa(this.originalOptions),this.currentOptions=oa(this.originalOptions),this._disable(),this.button=this._createButton(),this._setButtonText(),this.clearButton=this._createClearButton(),this.liveZone=this._createLiveZone(),this.overlay=this._createOverlay(),this.wrap=this._wrap(),this.multiple&&this._options.showSelected&&(this.selectedList=this._createSelectedList(),this._updateSelectedList(),this.selectedList.addEventListener("click",this._removeOption)),this.button.addEventListener("click",this._handleOpener),this.clearButton.addEventListener("click",this._handleClear),this.wrap.addEventListener("keydown",this._handleKeyboard),document.addEventListener("blur",this._handleFocus,!0),this.el.form&&this.el.form.addEventListener("reset",this._handleReset)}setText(e){Object.assign(this._options.text,e)}selectOption(e,t=!0){const r=this.currentOptions.findIndex(s=>s.value===e);if(r===-1)return;const i=!this.multiple;this._toggleSelection(r,i,t)}selectOptionSilently(e){this.selectOption(e,CP)}_createButton(){var e;const t=document.createElement("button");t.setAttribute("type","button"),t.setAttribute("aria-expanded",this.open?"true":"false"),t.className="select-a11y-button";const r=document.createElement("span");return r.className="select-a11y-button__text",this.label&&!this.label.id&&(this.label.id="".concat(this.el.id,"-label")),t.setAttribute("id",this.el.id+"-button"),t.setAttribute("aria-labelledby",((e=this.label)==null?void 0:e.id)+" "+t.id),r.innerHTML="&nbsp;",t.appendChild(r),t.insertAdjacentHTML("beforeend",'<span class="select-a11y-button__icon" aria-hidden="true"></span>'),t}_createClearButton(){const e=document.createElement("button");return e.setAttribute("type","button"),e.setAttribute("aria-label",this._options.text.clear),e.className="select-a11y-button__clear",e}_createLiveZone(){const e=document.createElement("p");return e.setAttribute("aria-live","polite"),e.classList.add("sr-only"),e}_createOverlay(){const e=document.createElement("div");e.classList.add("select-a11y__overlay");const t=document.createElement("div");return t.classList.add("select-a11y-suggestions"),t.id="a11y-".concat(this.id,"-suggestions"),e.innerHTML='\n      <p id="a11y-usage-'.concat(this.id,'-js" class="sr-only">').concat(this._options.text.help,'</p>\n      <label for="a11y-').concat(this.id,'-js" class="sr-only">').concat(this._options.text.placeholder,'</label>\n      <input type="search" id="a11y-').concat(this.id,'-js" class="select-a11y__input ').concat(this.el.className,'" autocomplete="off" autocapitalize="off" spellcheck="false" placeholder="').concat(this._options.text.placeholder,'" aria-describedby="a11y-usage-').concat(this.id,'-js">\n    '),e.appendChild(t),this.list=t,this.list.addEventListener("click",this._handleSuggestionClick),this.input=e.querySelector("input"),this.input&&(this.input.addEventListener("input",this._handleInput),this.input.addEventListener("focus",this._positionCursor,!0)),e}_createSelectedList(){const e=document.createElement("ul");return e.className="select-a11y__selected-list",e}_disable(){this.el.setAttribute("tabindex","-1")}_mapToSuggestion(e){return{hidden:e.hidden,disabled:e.disabled,selected:e.hasAttribute("selected"),label:e.label,value:e.value,image:e.dataset.image,alt:e.dataset.alt,helper:e.dataset.helper,description:e.dataset.description,showIcon:e.dataset.showIcon,group:e.dataset.group,link:e.dataset.link,linkText:e.dataset.linkText}}_mapToOption(e){const t=document.createElement("option");return t.label=e.label,t.value=e.value,e.hidden&&t.setAttribute("hidden","hidden"),e.disabled&&t.setAttribute("disabled","disabled"),e.selected&&t.setAttribute("selected","selected"),e.image&&(t.dataset.image=e.image),e.alt&&(t.dataset.alt=e.alt),e.description&&(t.dataset.description=e.description),e.helper&&(t.dataset.helper=e.helper),e.showIcon&&(t.dataset.showIcon=e.showIcon),e.group&&(t.dataset.group=e.group),e.link&&(t.dataset.link=e.link),e.linkText&&(t.dataset.linkText=e.linkText),t}_defaultSearch(e,t){const r=t.filter(i=>(i.label||i.value).toLocaleLowerCase().indexOf(e)!==-1).map(this._mapToSuggestion);return Promise.resolve(r)}async _fillSuggestions(){const e=this.search.toLowerCase(),t=await this._options.fillSuggestions(e,this.updatedOriginalOptions);this.currentOptions=t.map(this._mapToOption),this.el.replaceChildren(...this._fillSelect(this.currentOptions));const r=t.map((o,a)=>{const l=document.createElement("div");l.setAttribute("role","option"),l.setAttribute("tabindex","0"),l.setAttribute("data-index",a.toString()),o.hidden&&l.setAttribute("data-hidden","hidden"),o.disabled&&l.setAttribute("data-disabled","disabled"),l.classList.add("select-a11y-suggestion");const c=document.createElement("div");c.classList.add("select-a11y-column"),l.appendChild(c);const u=document.createElement("div");if(u.classList.add("select-a11y-suggestion__label"),u.innerText=o.label||o.value,c.appendChild(u),o.selected&&l.setAttribute("aria-selected","true"),o.description){const d=document.createElement("div");d.classList.add("select-a11y-suggestion__description"),o.showIcon&&d.setAttribute("data-show-icon","true"),d.innerText=o.description,c.appendChild(d)}if(o.helper){const d=document.createElement("div");d.classList.add("column--right"),l.appendChild(d);const f=document.createElement("code");f.classList.add("select-a11y-suggestion__helper"),f.innerText=o.helper,d.appendChild(f)}else if(o.link){const d=document.createElement("div");d.classList.add("column--right"),l.appendChild(d);const f=document.createElement("a");f.target="_blank",f.innerText=o.linkText,f.href=o.link,d.appendChild(f)}if(o.image){const d=document.createElement("img");d.setAttribute("src",o.image),d.setAttribute("alt",o.alt?o.alt:""),d.classList.add("select-a11y-suggestion__image"),l.prepend(d)}return{suggestionElement:l,group:o.group}}).filter(o=>!o.suggestionElement.dataset.disabled&&!o.suggestionElement.dataset.hidden),i=[],s={};if(r.forEach(({suggestionElement:o,group:a})=>{if(a){if(!s[a]){const l=document.createElement("div");l.setAttribute("role","group"),s[a]=l;const c=document.createElement("div");c.setAttribute("role","presentation"),c.innerHTML=a,l.appendChild(c)}s[a].appendChild(o)}else i.push(o)}),this.suggestions=r.map(({suggestionElement:o})=>o),this.list)if(!this.suggestions.length)this.list.innerHTML='<p class="select-a11y__no-suggestion">'.concat(this._options.text.noResult,"</p>");else{const o=document.createElement("div");o.setAttribute("role","listbox"),this.multiple&&o.setAttribute("aria-multiselectable","true"),Object.values(i).forEach(a=>{o.appendChild(a)}),Object.values(s).forEach(a=>{o.appendChild(a)}),this.list.innerHTML="",this.list.appendChild(o)}return this._setLiveZone(),t}_fillSelect(e){const t=[];return e.forEach(r=>{const i=r.dataset.group;if(i){if(!t.find(s=>s.tagName==="OPTGROUP"&&s.label===i)){const s=document.createElement("optgroup");s.label=i,t.push(s)}t[t.length-1].appendChild(r)}else t.push(r)}),t}_handleOpener(e){this._toggleOverlay()}_handleFocus(){this.open&&(clearTimeout(this._focusTimeout),this._focusTimeout=setTimeout(()=>{if(!this.overlay.contains(document.activeElement)&&this.button!==document.activeElement)this._toggleOverlay(!1,document.activeElement===document.body);else if(document.activeElement===this.input)this.focusIndex=null;else{const e=this.suggestions.indexOf(document.activeElement);e!==-1&&(this.focusIndex=e)}},10))}_handleClear(){this.el.value="",this._handleReset()}_handleReset(){clearTimeout(this._resetTimeout),this._resetTimeout=setTimeout(async()=>{this.search="",this.updatedOriginalOptions=oa(this.originalOptions),this.currentOptions=oa(this.originalOptions),this.el.dispatchEvent(new Event("reset")),await this._fillSuggestions(),this.el.dispatchEvent(new Event("change")),this._setButtonText(),this.multiple&&this._options.showSelected&&this._updateSelectedList()},10)}_handleSuggestionClick(e){const t=ho.call(e.target,'[role="option"]');if(!t)return;const r=parseInt(t.getAttribute("data-index"),10),i=!(this.multiple&&e.metaKey);this._toggleSelection(r,i)}_handleInput(){var r;var e,t;this.search!==((e=this.input)==null?void 0:e.value)&&(this.search=(r=(t=this.input)==null?void 0:t.value)!=null?r:"",this._fillSuggestions())}_handleKeyboard(e){const t=ho.call(e.target,'[role="option"]'),r=ho.call(e.target,"input");if(e.keyCode===27){this._toggleOverlay();return}if(r&&e.keyCode===13){e.preventDefault();return}if(e.keyCode===40){e.preventDefault(),this._moveIndex(1);return}if(t){if(e.keyCode===39){e.preventDefault(),this._moveIndex(1);return}if(e.keyCode===37||e.keyCode===38){e.preventDefault(),this._moveIndex(-1);return}(!this.multiple&&e.keyCode===13||e.keyCode===32)&&(e.preventDefault(),this._toggleSelection(parseInt(t.getAttribute("data-index"),10),!this.multiple)),this.multiple&&e.keyCode===13&&this._toggleOverlay()}}_moveIndex(e){if(this.focusIndex===null)this.focusIndex=0;else{const t=this.focusIndex+e,r=this.suggestions.length-1;t>r?this.focusIndex=0:t<0?this.focusIndex=r:this.focusIndex=t}this.suggestions[this.focusIndex].focus()}_positionCursor(){setTimeout(()=>{var e;if(this.input){const t=(e=this.input.value.length)!=null?e:0;this.input.setSelectionRange(t,t)}})}_removeOption(e){var t,r;const i=ho.call(e.target,"button");if(!i)return;const s=(t=this.selectedList)==null?void 0:t.querySelectorAll("button"),o=Array.prototype.indexOf.call(s,i)-1,a=parseInt(i.getAttribute("data-index"),10);if(this._toggleSelection(a),(r=this.selectedList)!=null&&r.parentElement){const l=this.selectedList.querySelectorAll("button");l[o]?l[o].focus():l[0].focus()}else this.button.focus()}_setButtonText(){var e;const t=this.el.item(this.el.selectedIndex),r=this.button.firstElementChild;t&&t.value?this.button.classList.remove("select-a11y-button--no-selected-option"):this.button.classList.add("select-a11y-button--no-selected-option"),this.multiple?this._options.useLabelAsButton?r.innerText=((e=this.label)==null?void 0:e.innerText)||"":r.innerHTML="&nbsp;":t&&(r.innerText=t.label||t.value)}_setLiveZone(){const e=this.suggestions.length;let t="";this.open&&(e?t=this._options.text.results.replace("{x}",e):t=this._options.text.noResult),this.liveZone.innerText=t}_toggleOverlay(e,t){var r;this.open=e!==void 0?e:!this.open,this.button.setAttribute("aria-expanded",this.open?"true":"false"),this.open?(this._fillSuggestions(),this.button.insertAdjacentElement("afterend",this.overlay),(r=this.input)==null||r.focus()):this.wrap.contains(this.overlay)&&(this.wrap.removeChild(this.overlay),this.focusIndex=null,this.input&&this._options.fillSuggestions===this._defaultSearch&&(this.input.value=""),this.search="",this._setLiveZone(),(e===void 0||t)&&setTimeout(()=>{this.button.focus()}))}_toggleSelection(e,t=!0,r=!0){const i=this.el.item(e);this.multiple?i!=null&&i.hasAttribute("selected")?i.removeAttribute("selected"):i==null||i.setAttribute("selected","selected"):(i==null||i.setAttribute("selected","selected"),this.el.selectedIndex=e),this.updatedOriginalOptions=this.updatedOriginalOptions.map(s=>(s.value===(i==null?void 0:i.value)&&(i.hasAttribute("selected")?s.setAttribute("selected","selected"):s.removeAttribute("selected")),!this.multiple&&s.value!==(i==null?void 0:i.value)&&s.removeAttribute("selected"),s)),this.currentOptions=this.currentOptions.map(s=>(s.value===(i==null?void 0:i.value)&&(i.hasAttribute("selected")?s.setAttribute("selected","selected"):s.removeAttribute("selected")),!this.multiple&&s.value!==(i==null?void 0:i.value)&&s.removeAttribute("selected"),s)),this.suggestions=this.suggestions.map(s=>{var l;const o=parseInt((l=s.getAttribute("data-index"))!=null?l:"",10),a=this.el.item(o);return a&&a.selected?s.setAttribute("aria-selected","true"):s.removeAttribute("aria-selected"),s}),r&&this.el.dispatchEvent(new Event("change")),this._setButtonText(),this.multiple&&this._options.showSelected&&this._updateSelectedList(),t&&this.open&&this._toggleOverlay()}_updateSelectedList(){var e;const t=this.currentOptions.map((r,i)=>{if(!r.selected||r.hidden)return;const s=r.label||r.value;return'\n        <li class="select-a11y__selected-item">\n          <span>'.concat(s,'</span>\n          <button class="select-a11y-delete" title="').concat(this._options.text.deleteItem.replace("{t}",s),'" type="button" data-index="').concat(i,'">\n            <span class="sr-only">').concat(this._options.text.delete,'</span>\n            <span class="select-a11y-delete__icon" aria-hidden="true"></span>\n          </button>\n        </li>')}).filter(Boolean);this.selectedList&&(this.selectedList.innerHTML=t.join(""),t.length?(e=this.selectedList)!=null&&e.parentElement||this.wrap.appendChild(this.selectedList):this.selectedList.parentElement&&this.wrap.removeChild(this.selectedList))}_wrap(){var e;const t=document.createElement("div");t.classList.add("select-a11y"),(e=this.el.parentElement)==null||e.appendChild(t);const r=document.createElement("div");return r.classList.add("select-a11y__hidden"),r.setAttribute("aria-hidden","true"),this._options.useLabelAsButton&&r.appendChild(this.label),r.appendChild(this.el),t.appendChild(r),t.appendChild(this.liveZone),t.appendChild(this.button),this._options.clearable&&t.appendChild(this.clearButton),t}};const TP=W({props:{required:{type:Boolean,required:!0}}}),OP={key:0,class:"required-field-star"};function $P(n,e,t,r,i,s){return n.required?(_(),S("span",OP,"*")):V("",!0)}const pm=Ne(TP,[["render",$P]]);const DP=W({components:{Required:pm},emits:["change"],props:{addAllOption:{type:Boolean,default:!0},allOption:{type:String,default:""},emptyPlaceholder:{type:String},entityUrl:{type:String},errorText:{type:String,default:""},explanation:{type:String,default:""},hasError:{type:Boolean,default:!1},hasWarning:{type:Boolean,default:!1},hintText:{type:String,default:""},isBlue:{type:Boolean,default:!1},initialOptions:Promise,isValid:{type:Boolean,default:!1},listUrl:{type:String},minimumCharacterBeforeSuggest:{type:Number,default:1},placeholder:{type:String,required:!0},required:{type:Boolean,default:!1},searchPlaceholder:{type:String,required:!0},suggestUrl:{type:String},values:{type:[Array,String]},multiple:{type:Boolean,default:!1},addNewOption:{type:Boolean,default:!1},helperLabel:{type:String,default:""},groups:{type:Array,default:null},onSuggest:{type:Function,default:null},showDescription:{type:Boolean,default:!1},roundedImages:{type:Boolean,default:!1}},setup(n,{emit:e}){const{t}=De(),{toast:r}=Bn(),{id:i}=jo("multiselect"),s=A(()=>i+"-desc-error"),o=A(()=>i+"-desc-valid"),a=A(()=>({"fr-select-group--error":n.hasError,"fr-select-group--warning":!n.hasError&&n.hasWarning,"fr-select-group--valid":n.isValid,"multiselect--rounded-images":n.roundedImages,"multiselect--align-center":!n.showDescription})),l=il("selectRef"),c=E(null),u=E(0),d=350,f=20,h=E([]),p=E([]),m=A(()=>h.value.slice(0,f)),g=E(n.multiple?[]:null),w="",x=E(null),M=E(null),b=A(()=>n.emptyPlaceholder||t("No results found.")),C=Hs({help:t("Use tab (or arrow down) to move between suggestions"),placeholder:n.searchPlaceholder,noResult:b.value,results:t("{x} available suggestion"),deleteItem:t("Delete {t}"),delete:t("Delete")}),k=async()=>n.initialOptions?n.initialOptions:n.listUrl?kt.get(n.listUrl).then(R=>{let Z=R.data;if(Array.isArray(Z)||(Z=Z.data),n.groups){const ne=Z.map(Ie=>{const lt=n.groups.find(ft=>ft.values.some(Xt=>Xt.value===Ie.id));if(lt){const ft=lt.values.find(Xt=>Xt.value===Ie.id);if(ft)return{...Ie,group:lt.name,description:ft.description||null,recommended:ft.recommended,code:ft.code}}return Ie});return $(ne)}else return $(Z)}).catch(R=>(hr.isCancel(R)||r.error(t("Error getting {type}.",{type:n.placeholder})),[])):p.value,$=j=>j.map(R=>{var Z,ne,Ie,lt,ft,Xt,Qn,Kr,Gr,ji,Ui,Mn,Hn,Xr,er;return{label:(Xt=(ft=(lt=(ne=(Z=R.name)!=null?Z:R.title)!=null?ne:R.text)!=null?lt:(Ie=R==null?void 0:R.properties)==null?void 0:Ie.name)!=null?ft:R.label)!=null?Xt:R,value:(Gr=(Kr=(Qn=R.id)!=null?Qn:R.text)!=null?Kr:R.value)!=null?Gr:R,image:(Xr=(Hn=(Mn=(Ui=(ji=R.logo_thumbnail)!=null?ji:R.logo)!=null?Ui:R.image_url)!=null?Mn:R.image)!=null?Hn:R.avatar_thumbnail)!=null?Xr:R.avatar,hidden:R.hidden,selected:!!R.selected,helper:R!=null&&R.code?n.helperLabel+R.code:R==null?void 0:R.helper,description:n.showDescription&&(er=R==null?void 0:R.description)!=null?er:"",group:R==null?void 0:R.group,recommended:R==null?void 0:R.recommended}}),O=async(j="")=>{const Z=h.value.filter(ne=>(ne.label||ne.value).toLocaleLowerCase().indexOf(j)!==-1).slice(0,f);return $(Z)},D=j=>j.length<n.minimumCharacterBeforeSuggest?k():n.suggestUrl?(x.value&&x.value.cancel(),x.value=gd(),kt.get(n.suggestUrl,{params:{q:j,size:f},cancelToken:x.value.token}).then(R=>n.onSuggest?n.onSuggest(R.data):R.data).then(R=>(n.addNewOption&&!R.some(ne=>ne.text===j)&&R.push({text:j}),$(R))).catch(R=>(hr.isCancel(R)||r.error(t("Error getting {type}.",{type:n.placeholder})),[]))):O(j),N=(j="")=>D(j).then(U),B=(j="")=>N(j).then(R=>(p.value=R,R.slice(0,f))),U=j=>{const R=[...j].map(ne=>(ne.selected=!1,ne));n.allOption&&(R.find(Ie=>!Ie.value)||R.unshift({label:n.allOption,value:"",hidden:!n.addAllOption}));let Z=[];Array.isArray(g.value)?Z=g.value:Z=[g.value];for(let ne of Z)if(typeof ne=="string"){const Ie=R.findIndex(ft=>ft.value===ne),lt=p.value.find(ft=>ft.value===ne);lt&&(lt.selected=!0,Ie===-1?R.unshift(lt):R[Ie].selected=!0)}return $(R)},le=j=>(h.value=j,p.value=j,j),Te=j=>{const R=E(null);return(typeof j=="string"||Array.isArray(j))&&(R.value=j),R},ee=()=>{let j=[],R=pt(Te(n.values));if(Array.isArray(R))for(let Z of R)j.push(ie(Z));else j.push(ie(R));return Promise.all(j).then(Z=>(n.multiple?g.value=Z.filter(ne=>ne!==null):g.value=Z[0],g.value)).catch(Z=>(hr.isCancel(Z)||r.error(t("Error getting {type}.",{type:n.placeholder})),[]))},ie=j=>{var Z;let R=null;if(j&&n.entityUrl)R=kt.get("".concat(n.entityUrl).concat(j,"/")).then(ne=>ne.data).then(ne=>$([ne])).then(ne=>{var Ie,lt;return(lt=(Ie=ne[0])==null?void 0:Ie.label)!=null?lt:j}).then(ne=>{p.value.every(lt=>lt.value!==j)&&p.value.push({label:ne,value:j})}).then(()=>j);else{let ne=p.value.find(Ie=>Ie.value===j);j&&!ne&&(ne={label:j,value:j},p.value.push(ne)),R=Promise.resolve((Z=ne==null?void 0:ne.value)!=null?Z:null)}return R.then(ne=>ne!=null?ne:w).catch(ne=>(hr.isCancel(ne)||r.error(t("Error getting {type}.",{type:n.placeholder})),""))},he=()=>{if(l.value)if(n.multiple){const j=Array.from(l.value.selectedOptions).map(R=>R.value);g.value=j,e("change",j)}else g.value=l.value.value,e("change",l.value.value)},be=()=>{l.value&&(n.multiple?g.value=[]:g.value=null)},ke=()=>{ge(),je(),F()},ge=()=>{if(!c.value)return;let j=c.value.getBoundingClientRect(),R=d;window.innerWidth<R&&(R=Math.min(d,j.width));let ne=window.innerWidth-j.x<R;u.value=ne?R-j.width:0;const Ie=c.value.style;Ie.setProperty("--offset-select-a11y__overlay","-".concat(u.value,"px")),Ie.setProperty("--min-width-select-a11y__overlay","".concat(R,"px"))},je=()=>{if(!c.value)return;const j=c.value.querySelector(".select-a11y");j&&(j.classList.add("fr-select"),n.isBlue&&j.classList.add("fr-select--blue"));const R=c.value.querySelector("label");R&&R.classList.add("fr-label");const Z=c.value.querySelector(".select-a11y-button__text");Z&&!Z.innerHTML&&(Z.innerHTML="&nbsp;")},F=()=>{c.value&&l.value&&(l.value.removeEventListener("change",he),l.value.addEventListener("change",he),l.value.removeEventListener("reset",be),l.value.addEventListener("reset",be))},L=()=>{const j={text:C,clearable:!0};j.fillSuggestions=B;try{M.value=new MP(l.value,j),ke()}catch(R){console.log(R)}};function I(j,R){return Array.isArray(j)&&Array.isArray(R)?[...j.filter(Z=>!R.includes(Z))]:j===R?[]:[j]}async function Q(j){var R;await B(j),(R=M.value)==null||R.selectOptionSilently(j),g.value=j}it(()=>n.values,async()=>{var Z;const j=g.value;await ee();const R=I(g.value,j);for(const ne of R)(Z=M.value)==null||Z.selectOptionSilently(ne)});const ae=N().then(le).then(ee);return Ke(()=>ae.then(L)),ob(ke),{container:c,displayedOptions:m,errorTextId:s,id:i,offset:u,selected:g,selectGroupClass:a,selectOption:Q,validTextId:o}}}),EP=["data-selected"],AP=["for","title"],PP={key:0,class:"fr-icon-information-line","aria-hidden":"true"},NP={key:1,class:"fr-hint-text"},RP=["id","required","multiple"],LP=["label"],IP=["value","data-image","hidden","data-helper","data-description","data-show-icon"],zP=["value","data-image","hidden","data-helper","data-description","data-show-icon"],BP=["value","data-image","hidden","data-helper","data-description","data-show-icon"],FP=["id"],VP=["id"];function HP(n,e,t,r,i,s){const o=yt("Required");return _(),S("div",{class:me(["multiselect w-100 fr-select-group",n.selectGroupClass]),ref:"container","data-selected":!!n.selected},[y("div",null,[y("label",{for:n.id,title:n.explanation},[Y(T(n.placeholder)+" ",1),P(o,{required:n.required},null,8,["required"]),n.explanation?(_(),S("span",PP)):V("",!0),n.hintText?(_(),S("span",NP,T(n.hintText),1)):V("",!0)],8,AP),xt(y("select",{class:"multiselect__input",id:n.id,ref:"selectRef","onUpdate:modelValue":e[0]||(e[0]=a=>n.selected=a),required:n.required,multiple:n.multiple},[n.groups?(_(),S(X,{key:0},[(_(!0),S(X,null,Ye(n.groups,a=>(_(),S("optgroup",{label:a.name},[(_(!0),S(X,null,Ye(n.displayedOptions,l=>(_(),S(X,{key:l.value},[a.name==l.group?(_(),S("option",{key:0,value:l.value,"data-image":l.image,hidden:l.hidden,"data-helper":l.helper,"data-description":l.description,"data-show-icon":l.recommended},T(l.label),9,IP)):V("",!0)],64))),128))],8,LP))),256)),(_(!0),S(X,null,Ye(n.displayedOptions,a=>(_(),S(X,{key:a.value},[a.group?V("",!0):(_(),S("option",{key:0,value:a.value,"data-image":a.image,hidden:a.hidden,"data-helper":a.helper,"data-description":a.description,"data-show-icon":a.recommended},T(a.label),9,zP))],64))),128))],64)):(_(!0),S(X,{key:1},Ye(n.displayedOptions,a=>(_(),S("option",{key:a.value,value:a.value,"data-image":a.image,hidden:a.hidden,"data-helper":a.helper,"data-description":a.description,"data-show-icon":a.recommended},T(a.label),9,BP))),128))],8,RP),[[fd,n.selected]])]),n.isValid?(_(),S("p",{key:0,id:n.validTextId,class:"fr-valid-text"},T(n.validText),9,FP)):n.hasError?(_(),S("p",{key:1,id:n.errorTextId,class:"fr-error-text"},T(n.errorText),9,VP)):V("",!0)],10,EP)}const Nr=Ne(DP,[["render",HP],["__scopeId","data-v-9b8f38b5"]]),WP=W({__name:"SchemaSelect",props:{allOption:{default:""},isBlue:{type:Boolean,default:!1},showExplanation:{type:Boolean,default:!0},values:{}},emits:["change"],setup(n,{emit:e}){const t=e,r=mb().then(s=>s.map(o=>({label:o.name,value:o.name}))),i=s=>t("change",s);return(s,o)=>(_(),G(Nr,{placeholder:s.$t("Schema"),explanation:s.showExplanation?s.$t("Data schemas describe data models: what are the fields, how are data shown, what are the available values, etc. See schema.data.gouv.fr"):"",searchPlaceholder:s.$t("Search a schema..."),allOption:s.allOption?s.allOption:s.$t("All schemas"),initialOptions:v(r),values:s.values,onChange:i,isBlue:s.isBlue},null,8,["placeholder","explanation","searchPlaceholder","allOption","initialOptions","values","isBlue"]))}});function Rn(n){"@babel/helpers - typeof";return Rn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rn(n)}function Ze(n){if(n===null||n===!0||n===!1)return NaN;var e=Number(n);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function fe(n,e){if(e.length<n)throw new TypeError(n+" argument"+(n>1?"s":"")+" required, but only "+e.length+" present")}function de(n){fe(1,arguments);var e=Object.prototype.toString.call(n);return n instanceof Date||Rn(n)==="object"&&e==="[object Date]"?new Date(n.getTime()):typeof n=="number"||e==="[object Number]"?new Date(n):((typeof n=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function jP(n,e){fe(2,arguments);var t=de(n),r=Ze(e);return isNaN(r)?new Date(NaN):(r&&t.setDate(t.getDate()+r),t)}function mm(n,e){fe(2,arguments);var t=de(n),r=Ze(e);if(isNaN(r))return new Date(NaN);if(!r)return t;var i=t.getDate(),s=new Date(t.getTime());s.setMonth(t.getMonth()+r+1,0);var o=s.getDate();return i>=o?s:(t.setFullYear(s.getFullYear(),s.getMonth(),i),t)}function UP(n,e){fe(2,arguments);var t=de(n).getTime(),r=Ze(e);return new Date(t+r)}var qP={};function qr(){return qP}function YP(n,e){var t,r,i,s,o,a,l,c;fe(1,arguments);var u=qr(),d=Ze((t=(r=(i=(s=e==null?void 0:e.weekStartsOn)!==null&&s!==void 0?s:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.weekStartsOn)!==null&&i!==void 0?i:u.weekStartsOn)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&t!==void 0?t:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=de(n),h=f.getDay(),p=(h<d?7:0)+h-d;return f.setDate(f.getDate()-p),f.setHours(0,0,0,0),f}function o_(n){var e=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return e.setUTCFullYear(n.getFullYear()),n.getTime()-e.getTime()}function Yh(n){fe(1,arguments);var e=de(n);return e.setHours(0,0,0,0),e}function gm(n,e){fe(2,arguments);var t=Ze(e);return mm(n,t*12)}function KP(n){fe(1,arguments);var e;if(n&&typeof n.forEach=="function")e=n;else if(Rn(n)==="object"&&n!==null)e=Array.prototype.slice.call(n);else return new Date(NaN);var t;return e.forEach(function(r){var i=de(r);(t===void 0||t<i||isNaN(Number(i)))&&(t=i)}),t||new Date(NaN)}function GP(n){fe(1,arguments);var e;if(n&&typeof n.forEach=="function")e=n;else if(Rn(n)==="object"&&n!==null)e=Array.prototype.slice.call(n);else return new Date(NaN);var t;return e.forEach(function(r){var i=de(r);(t===void 0||t>i||isNaN(i.getDate()))&&(t=i)}),t||new Date(NaN)}var XP=6e4,JP=36e5,ZP=1e3;function Of(n,e){fe(2,arguments);var t=Yh(n),r=Yh(e);return t.getTime()===r.getTime()}function QP(n){return fe(1,arguments),n instanceof Date||Rn(n)==="object"&&Object.prototype.toString.call(n)==="[object Date]"}function wn(n){if(fe(1,arguments),!QP(n)&&typeof n!="number")return!1;var e=de(n);return!isNaN(Number(e))}function e7(n){fe(1,arguments);var e=de(n);return e.setHours(23,59,59,999),e}function a_(n){fe(1,arguments);var e=de(n),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function t7(n,e){var t;fe(1,arguments);var r=n||{},i=de(r.start),s=de(r.end),o=s.getTime();if(!(i.getTime()<=o))throw new RangeError("Invalid interval");var a=[],l=i;l.setHours(0,0,0,0);var c=Number((t=e==null?void 0:e.step)!==null&&t!==void 0?t:1);if(c<1||isNaN(c))throw new RangeError("`options.step` must be a number greater than 1");for(;l.getTime()<=o;)a.push(de(l)),l.setDate(l.getDate()+c),l.setHours(0,0,0,0);return a}function Gy(n){fe(1,arguments);var e=de(n);return e.setSeconds(0,0),e}function n7(n){fe(1,arguments);var e=n||{},t=de(e.start),r=de(e.end),i=r.getTime(),s=[];if(!(t.getTime()<=i))throw new RangeError("Invalid interval");var o=t;for(o.setHours(0,0,0,0),o.setDate(1);o.getTime()<=i;)s.push(de(o)),o.setMonth(o.getMonth()+1);return s}function l_(n){fe(1,arguments);var e=de(n);return e.setDate(1),e.setHours(0,0,0,0),e}function r7(n){fe(1,arguments);var e=de(n),t=e.getFullYear();return e.setFullYear(t+1,0,0),e.setHours(23,59,59,999),e}function i7(n){fe(1,arguments);var e=de(n),t=new Date(0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}function s7(n){fe(1,arguments);var e=n||{},t=de(e.start),r=de(e.end),i=r.getTime();if(!(t.getTime()<=i))throw new RangeError("Invalid interval");var s=[],o=t;for(o.setHours(0,0,0,0),o.setMonth(0,1);o.getTime()<=i;)s.push(de(o)),o.setFullYear(o.getFullYear()+1);return s}function o7(n){fe(1,arguments);var e=de(n),t=e.getFullYear(),r=9+Math.floor(t/10)*10;return e.setFullYear(r,11,31),e.setHours(23,59,59,999),e}function a7(n,e){var t,r,i,s,o,a,l,c;fe(1,arguments);var u=qr(),d=Ze((t=(r=(i=(s=e==null?void 0:e.weekStartsOn)!==null&&s!==void 0?s:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.weekStartsOn)!==null&&i!==void 0?i:u.weekStartsOn)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&t!==void 0?t:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=de(n),h=f.getDay(),p=(h<d?-7:0)+6-(h-d);return f.setDate(f.getDate()+p),f.setHours(23,59,59,999),f}function c_(n,e){fe(2,arguments);var t=Ze(e);return UP(n,-t)}var l7=864e5;function c7(n){fe(1,arguments);var e=de(n),t=e.getTime();e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0);var r=e.getTime(),i=t-r;return Math.floor(i/l7)+1}function Oo(n){fe(1,arguments);var e=1,t=de(n),r=t.getUTCDay(),i=(r<e?7:0)+r-e;return t.setUTCDate(t.getUTCDate()-i),t.setUTCHours(0,0,0,0),t}function u_(n){fe(1,arguments);var e=de(n),t=e.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(t+1,0,4),r.setUTCHours(0,0,0,0);var i=Oo(r),s=new Date(0);s.setUTCFullYear(t,0,4),s.setUTCHours(0,0,0,0);var o=Oo(s);return e.getTime()>=i.getTime()?t+1:e.getTime()>=o.getTime()?t:t-1}function u7(n){fe(1,arguments);var e=u_(n),t=new Date(0);t.setUTCFullYear(e,0,4),t.setUTCHours(0,0,0,0);var r=Oo(t);return r}var d7=6048e5;function d_(n){fe(1,arguments);var e=de(n),t=Oo(e).getTime()-u7(e).getTime();return Math.round(t/d7)+1}function Ls(n,e){var t,r,i,s,o,a,l,c;fe(1,arguments);var u=qr(),d=Ze((t=(r=(i=(s=e==null?void 0:e.weekStartsOn)!==null&&s!==void 0?s:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.weekStartsOn)!==null&&i!==void 0?i:u.weekStartsOn)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&t!==void 0?t:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=de(n),h=f.getUTCDay(),p=(h<d?7:0)+h-d;return f.setUTCDate(f.getUTCDate()-p),f.setUTCHours(0,0,0,0),f}function vm(n,e){var t,r,i,s,o,a,l,c;fe(1,arguments);var u=de(n),d=u.getUTCFullYear(),f=qr(),h=Ze((t=(r=(i=(s=e==null?void 0:e.firstWeekContainsDate)!==null&&s!==void 0?s:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.firstWeekContainsDate)!==null&&i!==void 0?i:f.firstWeekContainsDate)!==null&&r!==void 0?r:(l=f.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&t!==void 0?t:1);if(!(h>=1&&h<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var p=new Date(0);p.setUTCFullYear(d+1,0,h),p.setUTCHours(0,0,0,0);var m=Ls(p,e),g=new Date(0);g.setUTCFullYear(d,0,h),g.setUTCHours(0,0,0,0);var w=Ls(g,e);return u.getTime()>=m.getTime()?d+1:u.getTime()>=w.getTime()?d:d-1}function f7(n,e){var t,r,i,s,o,a,l,c;fe(1,arguments);var u=qr(),d=Ze((t=(r=(i=(s=e==null?void 0:e.firstWeekContainsDate)!==null&&s!==void 0?s:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.firstWeekContainsDate)!==null&&i!==void 0?i:u.firstWeekContainsDate)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&t!==void 0?t:1),f=vm(n,e),h=new Date(0);h.setUTCFullYear(f,0,d),h.setUTCHours(0,0,0,0);var p=Ls(h,e);return p}var h7=6048e5;function f_(n,e){fe(1,arguments);var t=de(n),r=Ls(t,e).getTime()-f7(t,e).getTime();return Math.round(r/h7)+1}function Xe(n,e){for(var t=n<0?"-":"",r=Math.abs(n).toString();r.length<e;)r="0"+r;return t+r}var p7={y:function(e,t){var r=e.getUTCFullYear(),i=r>0?r:1-r;return Xe(t==="yy"?i%100:i,t.length)},M:function(e,t){var r=e.getUTCMonth();return t==="M"?String(r+1):Xe(r+1,2)},d:function(e,t){return Xe(e.getUTCDate(),t.length)},a:function(e,t){var r=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h:function(e,t){return Xe(e.getUTCHours()%12||12,t.length)},H:function(e,t){return Xe(e.getUTCHours(),t.length)},m:function(e,t){return Xe(e.getUTCMinutes(),t.length)},s:function(e,t){return Xe(e.getUTCSeconds(),t.length)},S:function(e,t){var r=t.length,i=e.getUTCMilliseconds(),s=Math.floor(i*Math.pow(10,r-3));return Xe(s,t.length)}};const Zr=p7;var Xs={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},m7={G:function(e,t,r){var i=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(i,{width:"abbreviated"});case"GGGGG":return r.era(i,{width:"narrow"});case"GGGG":default:return r.era(i,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){var i=e.getUTCFullYear(),s=i>0?i:1-i;return r.ordinalNumber(s,{unit:"year"})}return Zr.y(e,t)},Y:function(e,t,r,i){var s=vm(e,i),o=s>0?s:1-s;if(t==="YY"){var a=o%100;return Xe(a,2)}return t==="Yo"?r.ordinalNumber(o,{unit:"year"}):Xe(o,t.length)},R:function(e,t){var r=u_(e);return Xe(r,t.length)},u:function(e,t){var r=e.getUTCFullYear();return Xe(r,t.length)},Q:function(e,t,r){var i=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return Xe(i,2);case"Qo":return r.ordinalNumber(i,{unit:"quarter"});case"QQQ":return r.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,t,r){var i=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return Xe(i,2);case"qo":return r.ordinalNumber(i,{unit:"quarter"});case"qqq":return r.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,t,r){var i=e.getUTCMonth();switch(t){case"M":case"MM":return Zr.M(e,t);case"Mo":return r.ordinalNumber(i+1,{unit:"month"});case"MMM":return r.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(i,{width:"wide",context:"formatting"})}},L:function(e,t,r){var i=e.getUTCMonth();switch(t){case"L":return String(i+1);case"LL":return Xe(i+1,2);case"Lo":return r.ordinalNumber(i+1,{unit:"month"});case"LLL":return r.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(i,{width:"wide",context:"standalone"})}},w:function(e,t,r,i){var s=f_(e,i);return t==="wo"?r.ordinalNumber(s,{unit:"week"}):Xe(s,t.length)},I:function(e,t,r){var i=d_(e);return t==="Io"?r.ordinalNumber(i,{unit:"week"}):Xe(i,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getUTCDate(),{unit:"date"}):Zr.d(e,t)},D:function(e,t,r){var i=c7(e);return t==="Do"?r.ordinalNumber(i,{unit:"dayOfYear"}):Xe(i,t.length)},E:function(e,t,r){var i=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return r.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(i,{width:"short",context:"formatting"});case"EEEE":default:return r.day(i,{width:"wide",context:"formatting"})}},e:function(e,t,r,i){var s=e.getUTCDay(),o=(s-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(o);case"ee":return Xe(o,2);case"eo":return r.ordinalNumber(o,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,r,i){var s=e.getUTCDay(),o=(s-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(o);case"cc":return Xe(o,t.length);case"co":return r.ordinalNumber(o,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,r){var i=e.getUTCDay(),s=i===0?7:i;switch(t){case"i":return String(s);case"ii":return Xe(s,t.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(i,{width:"short",context:"formatting"});case"iiii":default:return r.day(i,{width:"wide",context:"formatting"})}},a:function(e,t,r){var i=e.getUTCHours(),s=i/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,r){var i=e.getUTCHours(),s;switch(i===12?s=Xs.noon:i===0?s=Xs.midnight:s=i/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,r){var i=e.getUTCHours(),s;switch(i>=17?s=Xs.evening:i>=12?s=Xs.afternoon:i>=4?s=Xs.morning:s=Xs.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){var i=e.getUTCHours()%12;return i===0&&(i=12),r.ordinalNumber(i,{unit:"hour"})}return Zr.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getUTCHours(),{unit:"hour"}):Zr.H(e,t)},K:function(e,t,r){var i=e.getUTCHours()%12;return t==="Ko"?r.ordinalNumber(i,{unit:"hour"}):Xe(i,t.length)},k:function(e,t,r){var i=e.getUTCHours();return i===0&&(i=24),t==="ko"?r.ordinalNumber(i,{unit:"hour"}):Xe(i,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):Zr.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):Zr.s(e,t)},S:function(e,t){return Zr.S(e,t)},X:function(e,t,r,i){var s=i._originalDate||e,o=s.getTimezoneOffset();if(o===0)return"Z";switch(t){case"X":return Jy(o);case"XXXX":case"XX":return ts(o);case"XXXXX":case"XXX":default:return ts(o,":")}},x:function(e,t,r,i){var s=i._originalDate||e,o=s.getTimezoneOffset();switch(t){case"x":return Jy(o);case"xxxx":case"xx":return ts(o);case"xxxxx":case"xxx":default:return ts(o,":")}},O:function(e,t,r,i){var s=i._originalDate||e,o=s.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Xy(o,":");case"OOOO":default:return"GMT"+ts(o,":")}},z:function(e,t,r,i){var s=i._originalDate||e,o=s.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Xy(o,":");case"zzzz":default:return"GMT"+ts(o,":")}},t:function(e,t,r,i){var s=i._originalDate||e,o=Math.floor(s.getTime()/1e3);return Xe(o,t.length)},T:function(e,t,r,i){var s=i._originalDate||e,o=s.getTime();return Xe(o,t.length)}};function Xy(n,e){var t=n>0?"-":"+",r=Math.abs(n),i=Math.floor(r/60),s=r%60;if(s===0)return t+String(i);var o=e||"";return t+String(i)+o+Xe(s,2)}function Jy(n,e){if(n%60===0){var t=n>0?"-":"+";return t+Xe(Math.abs(n)/60,2)}return ts(n,e)}function ts(n,e){var t=e||"",r=n>0?"-":"+",i=Math.abs(n),s=Xe(Math.floor(i/60),2),o=Xe(i%60,2);return r+s+t+o}const g7=m7;var Zy=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},h_=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},v7=function(e,t){var r=e.match(/(P+)(p+)?/)||[],i=r[1],s=r[2];if(!s)return Zy(e,t);var o;switch(i){case"P":o=t.dateTime({width:"short"});break;case"PP":o=t.dateTime({width:"medium"});break;case"PPP":o=t.dateTime({width:"long"});break;case"PPPP":default:o=t.dateTime({width:"full"});break}return o.replace("{{date}}",Zy(i,t)).replace("{{time}}",h_(s,t))},y7={p:h_,P:v7};const Kh=y7;var b7=["D","DD"],w7=["YY","YYYY"];function p_(n){return b7.indexOf(n)!==-1}function m_(n){return w7.indexOf(n)!==-1}function Wu(n,e,t){if(n==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(e,"`) for formatting years to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(e,"`) for formatting years to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(e,"`) for formatting days of the month to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(e,"`) for formatting days of the month to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var _7={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},k7={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},x7={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},C7={date:uf({formats:_7,defaultWidth:"full"}),time:uf({formats:k7,defaultWidth:"full"}),dateTime:uf({formats:x7,defaultWidth:"full"})};const S7=C7;var M7={code:"en-US",formatDistance:PC,formatLong:S7,formatRelative:NC,localize:RC,match:LC,options:{weekStartsOn:0,firstWeekContainsDate:1}};const g_=M7;var T7=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,O7=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,$7=/^'([^]*?)'?$/,D7=/''/g,E7=/[a-zA-Z]/;function $o(n,e,t){var r,i,s,o,a,l,c,u,d,f,h,p,m,g,w,x,M,b;fe(2,arguments);var C=String(e),k=qr(),$=(r=(i=t==null?void 0:t.locale)!==null&&i!==void 0?i:k.locale)!==null&&r!==void 0?r:g_,O=Ze((s=(o=(a=(l=t==null?void 0:t.firstWeekContainsDate)!==null&&l!==void 0?l:t==null||(c=t.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&a!==void 0?a:k.firstWeekContainsDate)!==null&&o!==void 0?o:(d=k.locale)===null||d===void 0||(f=d.options)===null||f===void 0?void 0:f.firstWeekContainsDate)!==null&&s!==void 0?s:1);if(!(O>=1&&O<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var D=Ze((h=(p=(m=(g=t==null?void 0:t.weekStartsOn)!==null&&g!==void 0?g:t==null||(w=t.locale)===null||w===void 0||(x=w.options)===null||x===void 0?void 0:x.weekStartsOn)!==null&&m!==void 0?m:k.weekStartsOn)!==null&&p!==void 0?p:(M=k.locale)===null||M===void 0||(b=M.options)===null||b===void 0?void 0:b.weekStartsOn)!==null&&h!==void 0?h:0);if(!(D>=0&&D<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!$.localize)throw new RangeError("locale must contain localize property");if(!$.formatLong)throw new RangeError("locale must contain formatLong property");var N=de(n);if(!wn(N))throw new RangeError("Invalid time value");var B=o_(N),U=c_(N,B),le={firstWeekContainsDate:O,weekStartsOn:D,locale:$,_originalDate:N},Te=C.match(O7).map(function(ee){var ie=ee[0];if(ie==="p"||ie==="P"){var he=Kh[ie];return he(ee,$.formatLong)}return ee}).join("").match(T7).map(function(ee){if(ee==="''")return"'";var ie=ee[0];if(ie==="'")return A7(ee);var he=g7[ie];if(he)return!(t!=null&&t.useAdditionalWeekYearTokens)&&m_(ee)&&Wu(ee,e,String(n)),!(t!=null&&t.useAdditionalDayOfYearTokens)&&p_(ee)&&Wu(ee,e,String(n)),he(U,ee,$.localize,le);if(ie.match(E7))throw new RangeError("Format string contains an unescaped latin alphabet character `"+ie+"`");return ee}).join("");return Te}function A7(n){var e=n.match($7);return e?e[1].replace(D7,"'"):n}function P7(n,e){if(n==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n}function N7(n){fe(1,arguments);var e=de(n),t=e.getFullYear(),r=e.getMonth(),i=new Date(0);return i.setFullYear(t,r+1,0),i.setHours(0,0,0,0),i.getDate()}function yc(n){fe(1,arguments);var e=de(n),t=e.getFullYear(),r=Math.floor(t/10)*10;return r}function Wn(n){return fe(1,arguments),de(n).getFullYear()}function fl(n,e){fe(2,arguments);var t=de(n),r=de(e);return t.getTime()>r.getTime()}function hl(n,e){fe(2,arguments);var t=de(n),r=de(e);return t.getTime()<r.getTime()}function Qy(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function R7(n,e){if(n){if(typeof n=="string")return Qy(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Qy(n,e)}}function e1(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=R7(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,i=function(){};return{s:i,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(c){throw c},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s=!0,o=!1,a;return{s:function(){t=t.call(n)},n:function(){var c=t.next();return s=c.done,c},e:function(c){o=!0,a=c},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(o)throw a}}}}function re(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Gh(n,e){return Gh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Gh(n,e)}function Fe(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&Gh(n,e)}function ju(n){return ju=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ju(n)}function L7(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function I7(n,e){if(e&&(Rn(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return re(n)}function Ve(n){var e=L7();return function(){var r=ju(n),i;if(e){var s=ju(this).constructor;i=Reflect.construct(r,arguments,s)}else i=r.apply(this,arguments);return I7(this,i)}}function Re(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function z7(n,e){if(Rn(n)!=="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(Rn(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function v_(n){var e=z7(n,"string");return Rn(e)==="symbol"?e:String(e)}function t1(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,v_(r.key),r)}}function Le(n,e,t){return e&&t1(n.prototype,e),t&&t1(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function te(n,e,t){return e=v_(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var B7=10,y_=function(){function n(){Re(this,n),te(this,"priority",void 0),te(this,"subPriority",0)}return Le(n,[{key:"validate",value:function(t,r){return!0}}]),n}(),F7=function(n){Fe(t,n);var e=Ve(t);function t(r,i,s,o,a){var l;return Re(this,t),l=e.call(this),l.value=r,l.validateValue=i,l.setValue=s,l.priority=o,a&&(l.subPriority=a),l}return Le(t,[{key:"validate",value:function(i,s){return this.validateValue(i,this.value,s)}},{key:"set",value:function(i,s,o){return this.setValue(i,s,this.value,o)}}]),t}(y_),V7=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",B7),te(re(r),"subPriority",-1),r}return Le(t,[{key:"set",value:function(i,s){if(s.timestampIsSet)return i;var o=new Date(0);return o.setFullYear(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()),o.setHours(i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds(),i.getUTCMilliseconds()),o}}]),t}(y_),Ue=function(){function n(){Re(this,n),te(this,"incompatibleTokens",void 0),te(this,"priority",void 0),te(this,"subPriority",void 0)}return Le(n,[{key:"run",value:function(t,r,i,s){var o=this.parse(t,r,i,s);return o?{setter:new F7(o.value,this.validate,this.set,this.priority,this.subPriority),rest:o.rest}:null}},{key:"validate",value:function(t,r,i){return!0}}]),n}(),H7=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",140),te(re(r),"incompatibleTokens",["R","u","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){switch(s){case"G":case"GG":case"GGG":return o.era(i,{width:"abbreviated"})||o.era(i,{width:"narrow"});case"GGGGG":return o.era(i,{width:"narrow"});case"GGGG":default:return o.era(i,{width:"wide"})||o.era(i,{width:"abbreviated"})||o.era(i,{width:"narrow"})}}},{key:"set",value:function(i,s,o){return s.era=o,i.setUTCFullYear(o,0,1),i.setUTCHours(0,0,0,0),i}}]),t}(Ue),wt={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},ur={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function _t(n,e){return n&&{value:e(n.value),rest:n.rest}}function ut(n,e){var t=e.match(n);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function dr(n,e){var t=e.match(n);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};var r=t[1]==="+"?1:-1,i=t[2]?parseInt(t[2],10):0,s=t[3]?parseInt(t[3],10):0,o=t[5]?parseInt(t[5],10):0;return{value:r*(i*JP+s*XP+o*ZP),rest:e.slice(t[0].length)}}function b_(n){return ut(wt.anyDigitsSigned,n)}function vt(n,e){switch(n){case 1:return ut(wt.singleDigit,e);case 2:return ut(wt.twoDigits,e);case 3:return ut(wt.threeDigits,e);case 4:return ut(wt.fourDigits,e);default:return ut(new RegExp("^\\d{1,"+n+"}"),e)}}function Uu(n,e){switch(n){case 1:return ut(wt.singleDigitSigned,e);case 2:return ut(wt.twoDigitsSigned,e);case 3:return ut(wt.threeDigitsSigned,e);case 4:return ut(wt.fourDigitsSigned,e);default:return ut(new RegExp("^-?\\d{1,"+n+"}"),e)}}function ym(n){switch(n){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function w_(n,e){var t=e>0,r=t?e:1-e,i;if(r<=50)i=n||100;else{var s=r+50,o=Math.floor(s/100)*100,a=n>=s%100;i=n+o-(a?100:0)}return t?i:1-i}function __(n){return n%400===0||n%4===0&&n%100!==0}var W7=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",130),te(re(r),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){var a=function(c){return{year:c,isTwoDigitYear:s==="yy"}};switch(s){case"y":return _t(vt(4,i),a);case"yo":return _t(o.ordinalNumber(i,{unit:"year"}),a);default:return _t(vt(s.length,i),a)}}},{key:"validate",value:function(i,s){return s.isTwoDigitYear||s.year>0}},{key:"set",value:function(i,s,o){var a=i.getUTCFullYear();if(o.isTwoDigitYear){var l=w_(o.year,a);return i.setUTCFullYear(l,0,1),i.setUTCHours(0,0,0,0),i}var c=!("era"in s)||s.era===1?o.year:1-o.year;return i.setUTCFullYear(c,0,1),i.setUTCHours(0,0,0,0),i}}]),t}(Ue),j7=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",130),te(re(r),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){var a=function(c){return{year:c,isTwoDigitYear:s==="YY"}};switch(s){case"Y":return _t(vt(4,i),a);case"Yo":return _t(o.ordinalNumber(i,{unit:"year"}),a);default:return _t(vt(s.length,i),a)}}},{key:"validate",value:function(i,s){return s.isTwoDigitYear||s.year>0}},{key:"set",value:function(i,s,o,a){var l=vm(i,a);if(o.isTwoDigitYear){var c=w_(o.year,l);return i.setUTCFullYear(c,0,a.firstWeekContainsDate),i.setUTCHours(0,0,0,0),Ls(i,a)}var u=!("era"in s)||s.era===1?o.year:1-o.year;return i.setUTCFullYear(u,0,a.firstWeekContainsDate),i.setUTCHours(0,0,0,0),Ls(i,a)}}]),t}(Ue),U7=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",130),te(re(r),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s){return Uu(s==="R"?4:s.length,i)}},{key:"set",value:function(i,s,o){var a=new Date(0);return a.setUTCFullYear(o,0,4),a.setUTCHours(0,0,0,0),Oo(a)}}]),t}(Ue),q7=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",130),te(re(r),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s){return Uu(s==="u"?4:s.length,i)}},{key:"set",value:function(i,s,o){return i.setUTCFullYear(o,0,1),i.setUTCHours(0,0,0,0),i}}]),t}(Ue),Y7=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",120),te(re(r),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){switch(s){case"Q":case"QQ":return vt(s.length,i);case"Qo":return o.ordinalNumber(i,{unit:"quarter"});case"QQQ":return o.quarter(i,{width:"abbreviated",context:"formatting"})||o.quarter(i,{width:"narrow",context:"formatting"});case"QQQQQ":return o.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return o.quarter(i,{width:"wide",context:"formatting"})||o.quarter(i,{width:"abbreviated",context:"formatting"})||o.quarter(i,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(i,s){return s>=1&&s<=4}},{key:"set",value:function(i,s,o){return i.setUTCMonth((o-1)*3,1),i.setUTCHours(0,0,0,0),i}}]),t}(Ue),K7=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",120),te(re(r),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){switch(s){case"q":case"qq":return vt(s.length,i);case"qo":return o.ordinalNumber(i,{unit:"quarter"});case"qqq":return o.quarter(i,{width:"abbreviated",context:"standalone"})||o.quarter(i,{width:"narrow",context:"standalone"});case"qqqqq":return o.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return o.quarter(i,{width:"wide",context:"standalone"})||o.quarter(i,{width:"abbreviated",context:"standalone"})||o.quarter(i,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(i,s){return s>=1&&s<=4}},{key:"set",value:function(i,s,o){return i.setUTCMonth((o-1)*3,1),i.setUTCHours(0,0,0,0),i}}]),t}(Ue),G7=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),te(re(r),"priority",110),r}return Le(t,[{key:"parse",value:function(i,s,o){var a=function(c){return c-1};switch(s){case"M":return _t(ut(wt.month,i),a);case"MM":return _t(vt(2,i),a);case"Mo":return _t(o.ordinalNumber(i,{unit:"month"}),a);case"MMM":return o.month(i,{width:"abbreviated",context:"formatting"})||o.month(i,{width:"narrow",context:"formatting"});case"MMMMM":return o.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return o.month(i,{width:"wide",context:"formatting"})||o.month(i,{width:"abbreviated",context:"formatting"})||o.month(i,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(i,s){return s>=0&&s<=11}},{key:"set",value:function(i,s,o){return i.setUTCMonth(o,1),i.setUTCHours(0,0,0,0),i}}]),t}(Ue),X7=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",110),te(re(r),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){var a=function(c){return c-1};switch(s){case"L":return _t(ut(wt.month,i),a);case"LL":return _t(vt(2,i),a);case"Lo":return _t(o.ordinalNumber(i,{unit:"month"}),a);case"LLL":return o.month(i,{width:"abbreviated",context:"standalone"})||o.month(i,{width:"narrow",context:"standalone"});case"LLLLL":return o.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return o.month(i,{width:"wide",context:"standalone"})||o.month(i,{width:"abbreviated",context:"standalone"})||o.month(i,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(i,s){return s>=0&&s<=11}},{key:"set",value:function(i,s,o){return i.setUTCMonth(o,1),i.setUTCHours(0,0,0,0),i}}]),t}(Ue);function J7(n,e,t){fe(2,arguments);var r=de(n),i=Ze(e),s=f_(r,t)-i;return r.setUTCDate(r.getUTCDate()-s*7),r}var Z7=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",100),te(re(r),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){switch(s){case"w":return ut(wt.week,i);case"wo":return o.ordinalNumber(i,{unit:"week"});default:return vt(s.length,i)}}},{key:"validate",value:function(i,s){return s>=1&&s<=53}},{key:"set",value:function(i,s,o,a){return Ls(J7(i,o,a),a)}}]),t}(Ue);function Q7(n,e){fe(2,arguments);var t=de(n),r=Ze(e),i=d_(t)-r;return t.setUTCDate(t.getUTCDate()-i*7),t}var e9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",100),te(re(r),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){switch(s){case"I":return ut(wt.week,i);case"Io":return o.ordinalNumber(i,{unit:"week"});default:return vt(s.length,i)}}},{key:"validate",value:function(i,s){return s>=1&&s<=53}},{key:"set",value:function(i,s,o){return Oo(Q7(i,o))}}]),t}(Ue),t9=[31,28,31,30,31,30,31,31,30,31,30,31],n9=[31,29,31,30,31,30,31,31,30,31,30,31],r9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",90),te(re(r),"subPriority",1),te(re(r),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){switch(s){case"d":return ut(wt.date,i);case"do":return o.ordinalNumber(i,{unit:"date"});default:return vt(s.length,i)}}},{key:"validate",value:function(i,s){var o=i.getUTCFullYear(),a=__(o),l=i.getUTCMonth();return a?s>=1&&s<=n9[l]:s>=1&&s<=t9[l]}},{key:"set",value:function(i,s,o){return i.setUTCDate(o),i.setUTCHours(0,0,0,0),i}}]),t}(Ue),i9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",90),te(re(r),"subpriority",1),te(re(r),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){switch(s){case"D":case"DD":return ut(wt.dayOfYear,i);case"Do":return o.ordinalNumber(i,{unit:"date"});default:return vt(s.length,i)}}},{key:"validate",value:function(i,s){var o=i.getUTCFullYear(),a=__(o);return a?s>=1&&s<=366:s>=1&&s<=365}},{key:"set",value:function(i,s,o){return i.setUTCMonth(0,o),i.setUTCHours(0,0,0,0),i}}]),t}(Ue);function bm(n,e,t){var r,i,s,o,a,l,c,u;fe(2,arguments);var d=qr(),f=Ze((r=(i=(s=(o=t==null?void 0:t.weekStartsOn)!==null&&o!==void 0?o:t==null||(a=t.locale)===null||a===void 0||(l=a.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&s!==void 0?s:d.weekStartsOn)!==null&&i!==void 0?i:(c=d.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=de(n),p=Ze(e),m=h.getUTCDay(),g=p%7,w=(g+7)%7,x=(w<f?7:0)+p-m;return h.setUTCDate(h.getUTCDate()+x),h}var s9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",90),te(re(r),"incompatibleTokens",["D","i","e","c","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){switch(s){case"E":case"EE":case"EEE":return o.day(i,{width:"abbreviated",context:"formatting"})||o.day(i,{width:"short",context:"formatting"})||o.day(i,{width:"narrow",context:"formatting"});case"EEEEE":return o.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return o.day(i,{width:"short",context:"formatting"})||o.day(i,{width:"narrow",context:"formatting"});case"EEEE":default:return o.day(i,{width:"wide",context:"formatting"})||o.day(i,{width:"abbreviated",context:"formatting"})||o.day(i,{width:"short",context:"formatting"})||o.day(i,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(i,s){return s>=0&&s<=6}},{key:"set",value:function(i,s,o,a){return i=bm(i,o,a),i.setUTCHours(0,0,0,0),i}}]),t}(Ue),o9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",90),te(re(r),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o,a){var l=function(u){var d=Math.floor((u-1)/7)*7;return(u+a.weekStartsOn+6)%7+d};switch(s){case"e":case"ee":return _t(vt(s.length,i),l);case"eo":return _t(o.ordinalNumber(i,{unit:"day"}),l);case"eee":return o.day(i,{width:"abbreviated",context:"formatting"})||o.day(i,{width:"short",context:"formatting"})||o.day(i,{width:"narrow",context:"formatting"});case"eeeee":return o.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return o.day(i,{width:"short",context:"formatting"})||o.day(i,{width:"narrow",context:"formatting"});case"eeee":default:return o.day(i,{width:"wide",context:"formatting"})||o.day(i,{width:"abbreviated",context:"formatting"})||o.day(i,{width:"short",context:"formatting"})||o.day(i,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(i,s){return s>=0&&s<=6}},{key:"set",value:function(i,s,o,a){return i=bm(i,o,a),i.setUTCHours(0,0,0,0),i}}]),t}(Ue),a9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",90),te(re(r),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o,a){var l=function(u){var d=Math.floor((u-1)/7)*7;return(u+a.weekStartsOn+6)%7+d};switch(s){case"c":case"cc":return _t(vt(s.length,i),l);case"co":return _t(o.ordinalNumber(i,{unit:"day"}),l);case"ccc":return o.day(i,{width:"abbreviated",context:"standalone"})||o.day(i,{width:"short",context:"standalone"})||o.day(i,{width:"narrow",context:"standalone"});case"ccccc":return o.day(i,{width:"narrow",context:"standalone"});case"cccccc":return o.day(i,{width:"short",context:"standalone"})||o.day(i,{width:"narrow",context:"standalone"});case"cccc":default:return o.day(i,{width:"wide",context:"standalone"})||o.day(i,{width:"abbreviated",context:"standalone"})||o.day(i,{width:"short",context:"standalone"})||o.day(i,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(i,s){return s>=0&&s<=6}},{key:"set",value:function(i,s,o,a){return i=bm(i,o,a),i.setUTCHours(0,0,0,0),i}}]),t}(Ue);function l9(n,e){fe(2,arguments);var t=Ze(e);t%7===0&&(t=t-7);var r=1,i=de(n),s=i.getUTCDay(),o=t%7,a=(o+7)%7,l=(a<r?7:0)+t-s;return i.setUTCDate(i.getUTCDate()+l),i}var c9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",90),te(re(r),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){var a=function(c){return c===0?7:c};switch(s){case"i":case"ii":return vt(s.length,i);case"io":return o.ordinalNumber(i,{unit:"day"});case"iii":return _t(o.day(i,{width:"abbreviated",context:"formatting"})||o.day(i,{width:"short",context:"formatting"})||o.day(i,{width:"narrow",context:"formatting"}),a);case"iiiii":return _t(o.day(i,{width:"narrow",context:"formatting"}),a);case"iiiiii":return _t(o.day(i,{width:"short",context:"formatting"})||o.day(i,{width:"narrow",context:"formatting"}),a);case"iiii":default:return _t(o.day(i,{width:"wide",context:"formatting"})||o.day(i,{width:"abbreviated",context:"formatting"})||o.day(i,{width:"short",context:"formatting"})||o.day(i,{width:"narrow",context:"formatting"}),a)}}},{key:"validate",value:function(i,s){return s>=1&&s<=7}},{key:"set",value:function(i,s,o){return i=l9(i,o),i.setUTCHours(0,0,0,0),i}}]),t}(Ue),u9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",80),te(re(r),"incompatibleTokens",["b","B","H","k","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){switch(s){case"a":case"aa":case"aaa":return o.dayPeriod(i,{width:"abbreviated",context:"formatting"})||o.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaaa":return o.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return o.dayPeriod(i,{width:"wide",context:"formatting"})||o.dayPeriod(i,{width:"abbreviated",context:"formatting"})||o.dayPeriod(i,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(i,s,o){return i.setUTCHours(ym(o),0,0,0),i}}]),t}(Ue),d9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",80),te(re(r),"incompatibleTokens",["a","B","H","k","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){switch(s){case"b":case"bb":case"bbb":return o.dayPeriod(i,{width:"abbreviated",context:"formatting"})||o.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbbb":return o.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return o.dayPeriod(i,{width:"wide",context:"formatting"})||o.dayPeriod(i,{width:"abbreviated",context:"formatting"})||o.dayPeriod(i,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(i,s,o){return i.setUTCHours(ym(o),0,0,0),i}}]),t}(Ue),f9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",80),te(re(r),"incompatibleTokens",["a","b","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){switch(s){case"B":case"BB":case"BBB":return o.dayPeriod(i,{width:"abbreviated",context:"formatting"})||o.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBBB":return o.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return o.dayPeriod(i,{width:"wide",context:"formatting"})||o.dayPeriod(i,{width:"abbreviated",context:"formatting"})||o.dayPeriod(i,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(i,s,o){return i.setUTCHours(ym(o),0,0,0),i}}]),t}(Ue),h9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",70),te(re(r),"incompatibleTokens",["H","K","k","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){switch(s){case"h":return ut(wt.hour12h,i);case"ho":return o.ordinalNumber(i,{unit:"hour"});default:return vt(s.length,i)}}},{key:"validate",value:function(i,s){return s>=1&&s<=12}},{key:"set",value:function(i,s,o){var a=i.getUTCHours()>=12;return a&&o<12?i.setUTCHours(o+12,0,0,0):!a&&o===12?i.setUTCHours(0,0,0,0):i.setUTCHours(o,0,0,0),i}}]),t}(Ue),p9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",70),te(re(r),"incompatibleTokens",["a","b","h","K","k","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){switch(s){case"H":return ut(wt.hour23h,i);case"Ho":return o.ordinalNumber(i,{unit:"hour"});default:return vt(s.length,i)}}},{key:"validate",value:function(i,s){return s>=0&&s<=23}},{key:"set",value:function(i,s,o){return i.setUTCHours(o,0,0,0),i}}]),t}(Ue),m9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",70),te(re(r),"incompatibleTokens",["h","H","k","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){switch(s){case"K":return ut(wt.hour11h,i);case"Ko":return o.ordinalNumber(i,{unit:"hour"});default:return vt(s.length,i)}}},{key:"validate",value:function(i,s){return s>=0&&s<=11}},{key:"set",value:function(i,s,o){var a=i.getUTCHours()>=12;return a&&o<12?i.setUTCHours(o+12,0,0,0):i.setUTCHours(o,0,0,0),i}}]),t}(Ue),g9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",70),te(re(r),"incompatibleTokens",["a","b","h","H","K","t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){switch(s){case"k":return ut(wt.hour24h,i);case"ko":return o.ordinalNumber(i,{unit:"hour"});default:return vt(s.length,i)}}},{key:"validate",value:function(i,s){return s>=1&&s<=24}},{key:"set",value:function(i,s,o){var a=o<=24?o%24:o;return i.setUTCHours(a,0,0,0),i}}]),t}(Ue),v9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",60),te(re(r),"incompatibleTokens",["t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){switch(s){case"m":return ut(wt.minute,i);case"mo":return o.ordinalNumber(i,{unit:"minute"});default:return vt(s.length,i)}}},{key:"validate",value:function(i,s){return s>=0&&s<=59}},{key:"set",value:function(i,s,o){return i.setUTCMinutes(o,0,0),i}}]),t}(Ue),y9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",50),te(re(r),"incompatibleTokens",["t","T"]),r}return Le(t,[{key:"parse",value:function(i,s,o){switch(s){case"s":return ut(wt.second,i);case"so":return o.ordinalNumber(i,{unit:"second"});default:return vt(s.length,i)}}},{key:"validate",value:function(i,s){return s>=0&&s<=59}},{key:"set",value:function(i,s,o){return i.setUTCSeconds(o,0),i}}]),t}(Ue),b9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",30),te(re(r),"incompatibleTokens",["t","T"]),r}return Le(t,[{key:"parse",value:function(i,s){var o=function(l){return Math.floor(l*Math.pow(10,-s.length+3))};return _t(vt(s.length,i),o)}},{key:"set",value:function(i,s,o){return i.setUTCMilliseconds(o),i}}]),t}(Ue),w9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",10),te(re(r),"incompatibleTokens",["t","T","x"]),r}return Le(t,[{key:"parse",value:function(i,s){switch(s){case"X":return dr(ur.basicOptionalMinutes,i);case"XX":return dr(ur.basic,i);case"XXXX":return dr(ur.basicOptionalSeconds,i);case"XXXXX":return dr(ur.extendedOptionalSeconds,i);case"XXX":default:return dr(ur.extended,i)}}},{key:"set",value:function(i,s,o){return s.timestampIsSet?i:new Date(i.getTime()-o)}}]),t}(Ue),_9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",10),te(re(r),"incompatibleTokens",["t","T","X"]),r}return Le(t,[{key:"parse",value:function(i,s){switch(s){case"x":return dr(ur.basicOptionalMinutes,i);case"xx":return dr(ur.basic,i);case"xxxx":return dr(ur.basicOptionalSeconds,i);case"xxxxx":return dr(ur.extendedOptionalSeconds,i);case"xxx":default:return dr(ur.extended,i)}}},{key:"set",value:function(i,s,o){return s.timestampIsSet?i:new Date(i.getTime()-o)}}]),t}(Ue),k9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",40),te(re(r),"incompatibleTokens","*"),r}return Le(t,[{key:"parse",value:function(i){return b_(i)}},{key:"set",value:function(i,s,o){return[new Date(o*1e3),{timestampIsSet:!0}]}}]),t}(Ue),x9=function(n){Fe(t,n);var e=Ve(t);function t(){var r;Re(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=e.call.apply(e,[this].concat(s)),te(re(r),"priority",20),te(re(r),"incompatibleTokens","*"),r}return Le(t,[{key:"parse",value:function(i){return b_(i)}},{key:"set",value:function(i,s,o){return[new Date(o),{timestampIsSet:!0}]}}]),t}(Ue),C9={G:new H7,y:new W7,Y:new j7,R:new U7,u:new q7,Q:new Y7,q:new K7,M:new G7,L:new X7,w:new Z7,I:new e9,d:new r9,D:new i9,E:new s9,e:new o9,c:new a9,i:new c9,a:new u9,b:new d9,B:new f9,h:new h9,H:new p9,K:new m9,k:new g9,m:new v9,s:new y9,S:new b9,X:new w9,x:new _9,t:new k9,T:new x9},S9=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,M9=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,T9=/^'([^]*?)'?$/,O9=/''/g,$9=/\S/,D9=/[a-zA-Z]/;function n1(n,e,t,r){var i,s,o,a,l,c,u,d,f,h,p,m,g,w,x,M,b,C;fe(3,arguments);var k=String(n),$=String(e),O=qr(),D=(i=(s=r==null?void 0:r.locale)!==null&&s!==void 0?s:O.locale)!==null&&i!==void 0?i:g_;if(!D.match)throw new RangeError("locale must contain match property");var N=Ze((o=(a=(l=(c=r==null?void 0:r.firstWeekContainsDate)!==null&&c!==void 0?c:r==null||(u=r.locale)===null||u===void 0||(d=u.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&l!==void 0?l:O.firstWeekContainsDate)!==null&&a!==void 0?a:(f=O.locale)===null||f===void 0||(h=f.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&o!==void 0?o:1);if(!(N>=1&&N<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var B=Ze((p=(m=(g=(w=r==null?void 0:r.weekStartsOn)!==null&&w!==void 0?w:r==null||(x=r.locale)===null||x===void 0||(M=x.options)===null||M===void 0?void 0:M.weekStartsOn)!==null&&g!==void 0?g:O.weekStartsOn)!==null&&m!==void 0?m:(b=O.locale)===null||b===void 0||(C=b.options)===null||C===void 0?void 0:C.weekStartsOn)!==null&&p!==void 0?p:0);if(!(B>=0&&B<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if($==="")return k===""?de(t):new Date(NaN);var U={firstWeekContainsDate:N,weekStartsOn:B,locale:D},le=[new V7],Te=$.match(M9).map(function(R){var Z=R[0];if(Z in Kh){var ne=Kh[Z];return ne(R,D.formatLong)}return R}).join("").match(S9),ee=[],ie=e1(Te),he;try{var be=function(){var Z=he.value;!(r!=null&&r.useAdditionalWeekYearTokens)&&m_(Z)&&Wu(Z,$,n),!(r!=null&&r.useAdditionalDayOfYearTokens)&&p_(Z)&&Wu(Z,$,n);var ne=Z[0],Ie=C9[ne];if(Ie){var lt=Ie.incompatibleTokens;if(Array.isArray(lt)){var ft=ee.find(function(Qn){return lt.includes(Qn.token)||Qn.token===ne});if(ft)throw new RangeError("The format string mustn't contain `".concat(ft.fullToken,"` and `").concat(Z,"` at the same time"))}else if(Ie.incompatibleTokens==="*"&&ee.length>0)throw new RangeError("The format string mustn't contain `".concat(Z,"` and any other token at the same time"));ee.push({token:ne,fullToken:Z});var Xt=Ie.run(k,Z,D.match,U);if(!Xt)return{v:new Date(NaN)};le.push(Xt.setter),k=Xt.rest}else{if(ne.match(D9))throw new RangeError("Format string contains an unescaped latin alphabet character `"+ne+"`");if(Z==="''"?Z="'":ne==="'"&&(Z=E9(Z)),k.indexOf(Z)===0)k=k.slice(Z.length);else return{v:new Date(NaN)}}};for(ie.s();!(he=ie.n()).done;){var ke=be();if(Rn(ke)==="object")return ke.v}}catch(R){ie.e(R)}finally{ie.f()}if(k.length>0&&$9.test(k))return new Date(NaN);var ge=le.map(function(R){return R.priority}).sort(function(R,Z){return Z-R}).filter(function(R,Z,ne){return ne.indexOf(R)===Z}).map(function(R){return le.filter(function(Z){return Z.priority===R}).sort(function(Z,ne){return ne.subPriority-Z.subPriority})}).map(function(R){return R[0]}),je=de(t);if(isNaN(je.getTime()))return new Date(NaN);var F=c_(je,o_(je)),L={},I=e1(ge),Q;try{for(I.s();!(Q=I.n()).done;){var ae=Q.value;if(!ae.validate(F,U))return new Date(NaN);var j=ae.set(F,L,U);Array.isArray(j)?(F=j[0],P7(L,j[1])):F=j}}catch(R){I.e(R)}finally{I.f()}return F}function E9(n){return n.match(T9)[1].replace(O9,"'")}function r1(n){fe(1,arguments);var e=de(n);return e.setMinutes(0,0,0),e}function A9(n,e){fe(2,arguments);var t=r1(n),r=r1(e);return t.getTime()===r.getTime()}function P9(n,e){fe(2,arguments);var t=Gy(n),r=Gy(e);return t.getTime()===r.getTime()}function Xh(n,e){fe(2,arguments);var t=de(n),r=de(e);return t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth()}function i1(n,e){fe(2,arguments);var t=de(n),r=de(e);return t.getFullYear()===r.getFullYear()}function N9(n,e){fe(2,arguments);var t=de(n).getTime(),r=de(e.start).getTime(),i=de(e.end).getTime();if(!(r<=i))throw new RangeError("Invalid interval");return t>=r&&t<=i}function R9(n,e){fe(2,arguments);var t=de(n),r=Ze(e),i=t.getFullYear(),s=t.getDate(),o=new Date(0);o.setFullYear(i,r,15),o.setHours(0,0,0,0);var a=N7(o);return t.setMonth(r,Math.min(s,a)),t}function s1(n,e){if(fe(2,arguments),Rn(e)!=="object"||e===null)throw new RangeError("values parameter must be an object");var t=de(n);return isNaN(t.getTime())?new Date(NaN):(e.year!=null&&t.setFullYear(e.year),e.month!=null&&(t=R9(t,e.month)),e.date!=null&&t.setDate(Ze(e.date)),e.hours!=null&&t.setHours(Ze(e.hours)),e.minutes!=null&&t.setMinutes(Ze(e.minutes)),e.seconds!=null&&t.setSeconds(Ze(e.seconds)),e.milliseconds!=null&&t.setMilliseconds(Ze(e.milliseconds)),t)}function L9(n,e,t){var r,i,s,o,a,l,c,u;fe(2,arguments);var d=qr(),f=Ze((r=(i=(s=(o=t==null?void 0:t.weekStartsOn)!==null&&o!==void 0?o:t==null||(a=t.locale)===null||a===void 0||(l=a.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&s!==void 0?s:d.weekStartsOn)!==null&&i!==void 0?i:(c=d.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=de(n),p=Ze(e),m=h.getDay(),g=p%7,w=(g+7)%7,x=7-f,M=p<0||p>6?p-(m+x)%7:(w+x)%7-(m+x)%7;return jP(h,M)}function I9(n){fe(1,arguments);var e=de(n),t=e.getFullYear(),r=Math.floor(t/10)*10;return e.setFullYear(r,0,1),e.setHours(0,0,0,0),e}function z9(n,e){fe(2,arguments);var t=Ze(e);return mm(n,-t)}function k_(n,e){fe(2,arguments);var t=Ze(e);return gm(n,-t)}function B9(){return Wp("datasets/licenses/")}async function F9(n,e,t,r,i){return(await Tl.get("/datasets/"+n+"/resources/",{params:{page:t,type:e,page_size:r,q:i}})).data}async function V9(n,e,t){return(await kt.get("datasets/community_resources/",{params:{page:e,dataset:n,page_size:t}})).data}function H9(){return Wp("datasets/extensions/")}const Od=(n,e=0,t=!1)=>{let r;return(...i)=>{t&&!r&&n(...i),clearTimeout(r),r=setTimeout(()=>{n(...i)},e)}};function W9(n,e=0,t=!1){const r=E(n);return sb((i,s)=>({get(){return i(),r.value},set:Od(o=>{r.value=o,s()},e,t)}))}const j9="/_themes/gouvfr/assets/magnifying_glass.svg",U9=W({props:{actionsAlignment:{type:String,default:""},heading:{type:String,default:"h2"},icon:{type:String,required:!0},stretchHeight:{type:Boolean,default:!1},title:{type:String,required:!0},content:{type:String},type:{type:String,default:"default"}},setup(n){const e=A(()=>"fr-grid-row--".concat(IC(n.actionsAlignment))),t=A(()=>n.type==="primary"?"bg-contrast-blue-cumulus":"bg-white"),r=A(()=>n.type==="primary"),i=A(()=>n.type==="default");return{alignment:e,isDefault:i,isPrimary:r,type:t}}}),q9={class:"fr-col-auto"},Y9=["src"],K9={class:"fr-col-12 fr-col-sm fr-grid-row flex-direction-column justify-between"},G9={class:"fr-mb-1w"},X9={key:0,class:"fr-my-1w"};function J9(n,e,t,r,i,s){return _(),S("div",{class:me(["rounded-xxs fr-p-3w fr-grid-row flex-direction-column",{"h-100":n.stretchHeight,[n.type]:n.type,"border border-default-grey":!n.isPrimary}])},[y("div",{class:me(["fr-col fr-grid-row fr-grid-row--gutters",{"text-blue-400":n.isPrimary}])},[y("div",q9,[y("img",{class:"w-100",src:n.icon,alt:""},null,8,Y9)]),y("div",K9,[y("div",G9,[(_(),G(ys(n.heading),{class:me(["fr-m-0 fr-mb-1w",{"fr-text--bold fr-text--md":n.isPrimary,"fr--h5":!n.isPrimary}])},{default:K(()=>[Y(T(n.title),1)]),_:1},8,["class"])),n.content?(_(),S("p",X9,T(n.content),1)):et(n.$slots,"default",{key:1})]),y("div",{class:me(["fr-grid-row",n.alignment])},[et(n.$slots,"actions")],2)])],2)],2)}const Z9=Ne(U9,[["render",J9]]),Q9={class:"fr-mt-1v fr-mb-3v"},eN=["href"],qu=W({__name:"NoSearchResults",emits:["resetFilters"],setup(n){const{t:e}=De();return(t,r)=>(_(),G(Z9,{title:v(e)("Didn't find what you are looking for?"),icon:v(j9),type:"primary"},{actions:K(()=>[y("button",{onClick:r[0]||(r[0]=i=>t.$emit("resetFilters")),class:"fr-btn fr-btn--secondary"},T(v(e)("Reset filters")),1),v(yv)?(_(),S("a",{key:0,href:v(yv),class:"fr-btn fr-btn--tertiary-no-outline fr-btn--icon-left fr-icon-lightbulb-line fr-ml-1w"},T(v(e)("Check our forum")),9,eN)):V("",!0)]),default:K(()=>[y("p",Q9,[Y(T(v(e)("Try resetting the filters to broaden your search.")),1),r[1]||(r[1]=y("br",null,null,-1)),Y(" "+T(v(e)("You can also check ongoing requests and submit your own on our forum dedicated to data discovery and openness.")),1)])]),_:1},8,["title","icon"]))}}),tN={class:"fr-grid-row fr-mt-1w fr-mt-md-5v"},nN={class:"fr-col-12 fr-col-md-4 fr-col-lg-3"},rN={class:"fr-sidemenu","aria-labelledby":"fr-sidemenu-title"},iN={class:"fr-sidemenu__inner"},sN={class:"fr-sidemenu__btn fr-mt-1w",hidden:"","aria-controls":"fr-sidemenu-wrapper","aria-expanded":"false"},oN={class:"fr-collapse",id:"fr-sidemenu-wrapper"},aN={class:"fr-sidemenu__title fr-mb-3v",id:"fr-sidemenu-title"},lN={class:"fr-grid-row fr-grid-row--gutters"},cN={key:0,class:"fr-col-12"},uN={class:"fr-col-12"},dN={class:"fr-col-12"},fN={class:"fr-col-12"},hN={class:"fr-col-12"},pN={class:"fr-col-12"},mN={class:"fr-col-12"},gN={key:1,class:"fr-col-12 fr-mb-3w text-align-center"},vN=["href"],yN={key:0,class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle justify-between fr-pb-1w"},bN={class:"fr-col-auto fr-my-0",role:"status"},wN={class:"fr-col-auto fr-grid-row fr-grid-row--middle"},_N={for:"sort-search",class:"fr-col-auto fr-text--sm fr-m-0 fr-mr-1w"},kN={class:"fr-col"},xN={value:""},CN=["value"],SN={key:0},MN={key:1},TN={class:"fr-mt-1w border-default-grey border-top relative z-2"},ON={key:2,class:"fr-mt-2w"},$f=20,bc=!0,$N=!1,DN=W({inheritAttrs:!1,__name:"Search",props:{downloadLink:{default:""},disableFirstSearch:{type:Boolean,default:!1},organization:{default:""},sorts:{default:()=>[]}},setup(n){const e=n,{t}=De(),{toast:r}=Bn(),i=new URL(window.location.href),s=new URLSearchParams(i.search),o=H9(),a=B9(),l=Eb().filter(F=>F.type!==yd&&F.type!==$b).map(F=>({label:F.label,value:F.type})),c=Promise.resolve(l),u=E(""),{reuseUrl:d}=i_(u),f=E(""),h=E([]),p=E(0),m=E(1),g=E({organization:e.organization}),w=E(!1),x=E(null),M=E(null),b=E(null),C=(F=bc)=>{let L=new URL(window.location.href);const I={...be.value};e.organization&&(delete I.organization,delete I.organization_badge),L.search=new URLSearchParams(I).toString(),F&&window.history.pushState(null,"",L);let Q=document.querySelectorAll("[data-q]");for(let ae of Q)ae.href=d.value},k=Od((F=bc)=>{w.value=!0,x.value&&x.value.cancel(),x.value=gd(),Tl.get("/datasets/search/",{cancelToken:x.value.token,params:{...be.value,page_size:$f}}).then(L=>L.data).then(L=>{h.value=L.data,p.value=L.total,w.value=!1,C(F)}).catch(L=>{hr.isCancel(L)||(r.error(t("Error getting search results.")),w.value=!1)})},mh),$=F=>{u.value=F,m.value=1,k()},O=(F,L)=>{L?g.value[F]=L:g.value[F]=void 0,e.organization&&(g.value.organization=e.organization,g.value.organization_badge=void 0),m.value=1,k()},D=()=>{m.value=1,k()},N=F=>{m.value=F,k(),B()},B=()=>{b.value&&b.value.scrollIntoView({behavior:"smooth"})},U=({page:F=1,sort:L="",...I},Q=bc)=>{g.value={...I,organization:e.organization||I.organization},m.value=F,f.value=L,k(Q)},le=()=>{U({})},Te=()=>{ee(),B()},ee=({q:F="",...L}={},I=bc)=>{u.value=F,U(L,I)},ie=A(()=>Object.keys(g.value).some(L=>{var I;return((I=g.value[L])==null?void 0:I.length)&&(e.organization?L!=="organization":!0)})),he=A(()=>e.sorts.map(F=>({value:F.order=="asc"?F.value:"-"+F.value,label:F.label}))),be=A(()=>{let F={},L;for(L in g.value){const I=g.value[L];I&&(F[L]=I)}return m.value>1&&(F.page=m.value.toString()),u.value&&(F.q=u.value),f.value&&(F.sort=f.value),F}),ke=s.get("q");ke&&(u.value=ke,s.delete("q"));const ge=s.get("page");ge&&(m.value=parseInt(ge),s.delete("page"));const je=s.get("sort");return je&&(f.value=je,s.delete("sort")),g.value={...Object.fromEntries(s),organization:e.organization||s.get("organization")||""},e.disableFirstSearch?w.value=!0:k(),Ke(()=>{if(e.disableFirstSearch&&M.value){let F=M.value.dataset.totalResults;if(F&&parseInt(F)>0){let L=M.value.dataset.results;L&&(h.value=JSON.parse(L)),p.value=JSON.parse(F)}w.value=!1}addEventListener("popstate",()=>{const F=new URL(window.location.href),L={};for(const[I,Q]of F.searchParams)L[I]=Q;ee(L,$N)})}),(F,L)=>(_(),S("form",{class:"fr-pt-3v",onSubmit:L[9]||(L[9]=$e((...I)=>v(k)&&v(k)(...I),["prevent"]))},[y("div",{class:"fr-grid-row fr-grid-row--middle justify-between",ref_key:"searchRef",ref:b,"data-cy":"search"},[P(hP,{onChange:$,value:u.value,placeholder:v(t)("Ex. 2022 presidential election")},null,8,["value","placeholder"])],512),y("div",tN,[y("div",nN,[y("nav",rN,[y("div",iN,[y("button",sN,T(v(t)("Filter results")),1),y("div",oN,[y("div",aN,T(v(t)("Filters")),1),y("div",lN,[F.organization?V("",!0):(_(),S("div",cN,[P(Nr,{placeholder:v(t)("Organizations"),searchPlaceholder:v(t)("Search an organization..."),allOption:v(t)("All organizations"),listUrl:"/organizations/?sort=-followers",suggestUrl:"/organizations/suggest/",entityUrl:"/organizations/",values:g.value.organization,onChange:L[0]||(L[0]=I=>O("organization",I)),isBlue:!0},null,8,["placeholder","searchPlaceholder","allOption","values"]),P(Nr,{initialOptions:v(c),placeholder:v(t)("Organization type"),searchPlaceholder:v(t)("Search an organization type..."),allOption:v(t)("All types"),values:g.value.organization_badge,onChange:L[1]||(L[1]=I=>O("organization_badge",I)),isBlue:!0},null,8,["initialOptions","placeholder","searchPlaceholder","allOption","values"])])),y("div",uN,[P(Nr,{placeholder:v(t)("Tags"),searchPlaceholder:v(t)("Search a tag..."),allOption:v(t)("All tags"),suggestUrl:"/tags/suggest/",values:g.value.tag,onChange:L[2]||(L[2]=I=>O("tag",I)),minimumCharacterBeforeSuggest:2,isBlue:!0},null,8,["placeholder","searchPlaceholder","allOption","values"])]),y("div",dN,[P(Nr,{placeholder:v(t)("Formats"),searchPlaceholder:v(t)("Search a format..."),allOption:v(t)("All formats"),listUrl:v(o),values:g.value.format,onChange:L[3]||(L[3]=I=>O("format",I)),isBlue:!0},null,8,["placeholder","searchPlaceholder","allOption","listUrl","values"])]),y("div",fN,[P(Nr,{placeholder:v(t)("Licenses"),explanation:v(t)("Licenses define reuse rules for published datasets. See page data.gouv.fr/licences"),searchPlaceholder:v(t)("Search a license..."),allOption:v(t)("All licenses"),listUrl:v(a),values:g.value.license,onChange:L[4]||(L[4]=I=>O("license",I)),isBlue:!0},null,8,["placeholder","explanation","searchPlaceholder","allOption","listUrl","values"])]),y("div",hN,[P(WP,{values:g.value.schema||"",onChange:L[5]||(L[5]=I=>O("schema",I)),isBlue:!0},null,8,["values"])]),y("div",pN,[P(Nr,{placeholder:v(t)("Spatial coverage"),explanation:v(t)("Geographic areas covered by data and for which they are relevant."),searchPlaceholder:v(t)("Search a spatial coverage..."),allOption:v(t)("All coverages"),suggestUrl:"/spatial/zones/suggest/",entityUrl:"/spatial/zone/",values:g.value.geozone,onChange:L[6]||(L[6]=I=>O("geozone",I)),isBlue:!0},null,8,["placeholder","explanation","searchPlaceholder","allOption","values"])]),y("div",mN,[P(Nr,{placeholder:v(t)("Spatial granularity"),explanation:v(t)("Finest level of geographic detail covered by data."),searchPlaceholder:v(t)("Search a granularity..."),allOption:v(t)("All granularities"),listUrl:"/spatial/granularities/",values:g.value.granularity,onChange:L[7]||(L[7]=I=>O("granularity",I)),isBlue:!0},null,8,["placeholder","explanation","searchPlaceholder","allOption","values"])]),ie.value||F.downloadLink?(_(),S("div",gN,[ie.value?(_(),S("button",{key:0,class:"fr-btn fr-btn--secondary fr-icon-close-circle-line fr-btn--icon-left justify-center w-100",onClick:le},T(v(t)("Reset filters")),1)):F.downloadLink?(_(),S("a",{key:1,class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500 fr-icon-download-line fr-btn--icon-left justify-center w-100 matomo_download",href:F.downloadLink},T(v(t)("Download list as CSV")),9,vN)):V("",!0)])):V("",!0)])])])])]),y("section",yr({class:"fr-col-12 fr-col-md-8 fr-col-lg-9 fr-mt-2w fr-mt-md-0 search-results",ref_key:"resultsRef",ref:M},F.$attrs),[p.value?(_(),S("div",yN,[y("p",bN,T(v(t)("{count} results",p.value)),1),y("div",wN,[y("label",_N,T(v(t)("Sort by:")),1),y("div",kN,[xt(y("select",{id:"sort-search",class:"fr-select fr-select--blue",name:"sort","onUpdate:modelValue":L[8]||(L[8]=I=>f.value=I),onChange:D},[y("option",xN,T(v(t)("Relevance")),1),(_(!0),S(X,null,Ye(he.value,({value:I,label:Q})=>(_(),S("option",{value:I},T(Q),9,CN))),256))],544),[[fd,f.value]])])])])):V("",!0),P(Sl,{mode:"out-in"},{default:K(()=>[w.value?(_(),S("div",SN,[P(hm)])):h.value.length?(_(),S("div",MN,[y("ul",TN,[(_(!0),S(X,null,Ye(h.value,I=>(_(),S("li",{key:I.id},[P(s_,{dataset:I},null,8,["dataset"])]))),128))]),p.value>$f?(_(),G(v(js),{key:0,page:m.value,pageSize:$f,totalResults:p.value,onChange:N,class:"fr-mt-2w"},null,8,["page","totalResults"])):(_(),G(qu,{key:1,onResetFilters:Te}))])):(_(),S("div",ON,[P(qu,{onResetFilters:Te})]))]),_:1})],16)])],32))}}),EN=["disabled","aria-controls"],AN=["id"],PN={class:"fr-container fr-container--fluid fr-container-md"},NN={class:"fr-grid-row fr-grid-row--center"},RN={class:"fr-col-12 fr-col-md-8 fr-col-lg-6"},LN={class:"fr-modal__body"},IN={class:"fr-modal__header"},zN=["aria-controls"],BN={class:"fr-modal__content"},FN={class:"fr-modal__footer"},VN={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-reverse fr-btns-group--inline-lg fr-btns-group--icon-left"},HN=W({__name:"DeleteButton",props:{url:{}},setup(n){const e=n,{t}=De(),{toast:r}=Bn(),i=md,s=Ws("delete-modal"),o=s+"-title";function a(){return Ml(),kt.delete(e.url).then(()=>window.location.reload()).catch(()=>r.error(t("An error occured during the deletion.")))}return(l,c)=>(_(),S(X,null,[y("button",{type:"button",class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-warning-425 fr-btn--icon-left fr-icon-delete-line",disabled:v(i),"data-fr-opened":"false","aria-controls":v(s)},T(v(t)("Delete")),9,EN),(_(),G(Li,{to:"body"},[y("dialog",{"aria-labelledby":o,id:v(s),class:"fr-modal",role:"dialog"},[y("div",PN,[y("div",NN,[y("div",RN,[y("div",LN,[y("div",IN,[y("button",{class:"fr-btn--close fr-btn","aria-controls":v(s)},T(v(t)("Close")),9,zN)]),y("div",BN,[y("h1",{id:o,class:"fr-modal__title"},[c[0]||(c[0]=y("span",{class:"fr-icon-delete-line fr-icon--lg"},null,-1)),Y(" "+T(v(t)("Are you sure ?")),1)]),y("p",null,T(v(t)("The content will be permanently deleted.")),1)]),y("div",FN,[y("div",VN,[y("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-warning-425 fr-btn--icon-left fr-icon-delete-line",role:"button",onClick:a},T(v(t)("Delete")),1)])])])])])])],8,AN)]))],64))}});function WN(n){return kt.delete("users/".concat(n,"/"))}function jN(n){return kt.delete("users/".concat(n,"/?no_mail=true&delete_comments=true"))}const UN=["disabled","aria-controls"],qN=["id"],YN={class:"fr-container fr-container--fluid fr-container-md"},KN={class:"fr-grid-row fr-grid-row--center"},GN={class:"fr-col-12 fr-col-md-8 fr-col-lg-6"},XN={class:"fr-modal__body"},JN={class:"fr-modal__header"},ZN=["aria-controls"],QN={class:"fr-modal__content"},eR={class:"fr-grid-row fr-grid-row--middle fr-mb-2w"},tR={class:"avatar fr-mr-1w"},nR=["src"],rR={class:"fr-modal__footer"},iR={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-reverse fr-btns-group--inline-lg fr-btns-group--icon-left"},sR=W({__name:"DeleteUserButton",props:{id:{},full_name:{},avatar_thumbnail:{}},setup(n){const e=n,{t}=De(),{toast:r}=Bn(),i=md,s=Ws("delete-modal"),o=s+"-title";function a(){return WN(e.id).then(()=>window.location.reload()).catch(()=>r.error(t("An error occured during the deletion.")))}function l(){return jN(e.id).then(()=>window.location.reload()).catch(()=>r.error(t("An error occured during the deletion.")))}return(c,u)=>(_(),S(X,null,[y("button",{type:"button",class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-warning-425 fr-btn--icon-left fr-icon-delete-line",disabled:v(i),"data-fr-opened":"false","aria-controls":v(s)},T(v(t)("Delete")),9,UN),(_(),G(Li,{to:"body"},[y("dialog",{"aria-labelledby":o,id:v(s),class:"fr-modal",role:"dialog"},[y("div",YN,[y("div",KN,[y("div",GN,[y("div",XN,[y("div",JN,[y("button",{class:"fr-btn--close fr-btn","aria-controls":v(s)},T(v(t)("Close")),9,ZN)]),y("div",QN,[y("h1",{id:o,class:"fr-modal__title"},[u[0]||(u[0]=y("span",{class:"fr-icon-delete-line fr-icon--lg"},null,-1)),Y(" "+T(v(t)("Are you sure ?")),1)]),y("p",eR,[y("div",tR,[y("img",{class:"rounded-circle border border-default-grey",src:e.avatar_thumbnail,width:"40",height:"40",loading:"lazy",alt:""},null,8,nR)]),Y(" "+T(e.full_name)+" "+T(v(t)("will be permanently deleted.")),1)])]),y("div",rR,[y("div",iR,[y("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-warning-425 fr-btn--icon-left fr-icon-delete-line",role:"button",onClick:l},T(v(t)("Delete without as spam (no mail sent and discussions are deleted)")),1),y("button",{class:"fr-btn bg-warning-425 fr-btn--icon-left fr-icon-delete-line",role:"button",onClick:a},T(v(t)("Delete")),1)])])])])])])],8,qN)]))],64))}}),oR=W({name:"featured-button",props:{subjectId:{type:String,required:!0},subjectType:{type:String,required:!0},featured:{type:Boolean,required:!0}},setup(n){const{t:e}=De(),{toast:t}=Bn(),r=E(n.featured),i=E(null),s=()=>{const o=r.value?"delete":"post",a="".concat(n.subjectType.toLowerCase(),"s/").concat(n.subjectId,"/featured/");kt[o](a).then(l=>{r.value=!r.value}).catch(()=>t.error(e("An error occurred while featuring this subject.")))};return Ke(()=>{var o;return(o=i.value)==null?void 0:o.toggleAttribute("checked",r.value)}),{isFeatured:r,t:e,toggleFeatured:s,toggleInput:i}}}),aR={class:"fr-toggle fr-toggle--label-left"},lR=["checked"],cR=["data-fr-checked-label","data-fr-unchecked-label"];function uR(n,e,t,r,i,s){return _(),S("div",aR,[y("input",{ref:"toggleInput",onClick:e[0]||(e[0]=(...o)=>n.toggleFeatured&&n.toggleFeatured(...o)),type:"checkbox",class:"fr-toggle__input",id:"featured-toggle",checked:n.isFeatured},null,8,lR),y("label",{class:"fr-toggle__label",for:"featured-toggle","data-fr-checked-label":n.t("Featured"),"data-fr-unchecked-label":n.t("Standard")},T(n.t("Feature this content")),9,cR)])}const dR=Ne(oR,[["render",uR]]),fR=W({props:{followers:Number,url:{type:String,required:!0},following:Boolean},setup(n){const e=E(!1),t=E(n.following),r=cs.read_only_enabled;return{following:t,animating:e,readOnlyEnabled:r,toggleFollow:()=>{Ml();let s;t.value?s=kt.delete(n.url):s=kt.post(n.url),s.then(()=>{t.value=!t.value,t.value&&(e.value=!0,setTimeout(()=>e.value=!1,1300))})}}}}),hR=["disabled"],pR={class:"fr-ml-1w"};function mR(n,e,t,r,i,s){return _(),S("button",{onClick:e[0]||(e[0]=$e((...o)=>n.toggleFollow&&n.toggleFollow(...o),["prevent"])),type:"button",class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 follow-button",disabled:n.readOnlyEnabled},[y("span",{class:me(["magic fr-grid-row",{active:n.animating}]),style:Wo({color:n.following?"inherit":"transparent"})},e[1]||(e[1]=[y("svg",{"aria-hidden":"true",width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},[y("path",{d:"M7.20703 1.24224L5.42968 4.87896L1.41015 5.45318C0.699214 5.56255 0.425776 6.43755 0.945308 6.95709L3.8164 9.77349L3.13281 13.7383C3.02343 14.4493 3.78906 14.9961 4.41796 14.668L8 12.7813L11.5547 14.668C12.1836 14.9961 12.9492 14.4493 12.8398 13.7383L12.1562 9.77349L15.0273 6.95709C15.5469 6.43755 15.2734 5.56255 14.5625 5.45318L10.5703 4.87896L8.76562 1.24224C8.46484 0.613336 7.53515 0.585992 7.20703 1.24224Z",stroke:"#161616"})],-1)]),6),y("span",pR,[n.following?(_(),S(X,{key:0},[Y(T(n.$t("Remove from favourites")),1)],64)):(_(),S(X,{key:1},[Y(T(n.$t("Add to favourites")),1)],64))])],8,hR)}const gR=Ne(fR,[["render",mR]]),vR=W({props:{organization:{type:String,required:!0}},setup(n){const{t:e}=De(),t=E("");return{askToJoinOrganization:()=>{Ml(),t.value=prompt(e("You can add some details here for your membership request"))||"",kt.post("organizations/"+n.organization+"/membership/",{comment:t.value}).then(i=>{alert(e("A request has been sent to the administrators")),window.location.reload()}).catch(i=>{alert(e("Error while requesting membership")),console.error(i)})},comment:t}}});function yR(n,e,t,r,i,s){return _(),S("button",{onClick:e[0]||(e[0]=$e((...o)=>n.askToJoinOrganization&&n.askToJoinOrganization(...o),["prevent"])),class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500 fr-btn--icon-left fr-icon-team-line"},T(n.$t("Ask to join the organization as a producer")),1)}const bR=Ne(vR,[["render",yR]]);dd(["pdf","doc","docx","word","xls","excel","xlsx"]);const Do=/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/i,wR=new RegExp("/resources/("+Do.source+")?$",Do.flags),_R=new RegExp("/resource-("+Do.source+")?$",Do.flags),kR=new RegExp("/community-resources/("+Do.source+")?$",Do.flags),x_=(n,e)=>{for(const t of e?[kR]:[wR,_R]){let[r,i,s]=t.exec(n)||[];if(i)return i}return null};function C_(){const n=E(window.location.hash),e=()=>n.value=window.location.hash;return Ke(()=>window.addEventListener("hashchange",e)),Xn(()=>window.removeEventListener("hashchange",e)),{hash:n}}function o1(){history.pushState(null,""," "),window.dispatchEvent(new HashChangeEvent("hashchange"))}const xR={key:0},CR={key:1},SR={class:"fr-grid-row fr-grid-row--middle justify-between"},MR={key:0},TR={key:1},OR=W({__name:"resourceFromHash",props:{canEdit:{type:Boolean},datasetId:{},communityResource:{type:Boolean,default:!1}},setup(n){const e=n,{t}=De(),{toast:r}=Bn(),i=E(null),s=E(null),o=E(!1),{hash:a}=C_(),l=A(()=>x_(a.value,e.communityResource)),c=A(()=>e.communityResource?"/datasets/community_resources/".concat(l.value):"/datasets/".concat(e.datasetId,"/resources/").concat(l.value));return zt(async()=>{if(l.value){o.value=!0;try{const d=await(await kt.get(c.value)).data;d&&(s.value=d,i.value&&i.value.scrollIntoView())}catch(u){console.error(u),r.error(t("An error occurred while fetching the file ")+l.value)}finally{o.value=!1}}}),(u,d)=>l.value?(_(),S("section",{key:0,ref_key:"top",ref:i},[P(Sl,{mode:"out-in"},{default:K(()=>[o.value?(_(),S("div",xR,[P(v(aw))])):(_(),S("div",CR,[P(v(Au),{type:"secondary",color:"success",class:"fr-mb-2w"},{default:K(()=>[y("div",SR,[u.communityResource?(_(),S("span",MR,T(v(t)("You are seeing a specific community resource of this dataset")),1)):(_(),S("span",TR,T(v(t)("You are seeing a specific file of this dataset")),1)),y("button",{class:"fr-btn--close fr-btn fr-mr-0",onClick:d[0]||(d[0]=$e((...f)=>v(o1)&&v(o1)(...f),["prevent"]))},T(v(t)("Close")),1)])]),_:1}),s.value?(_(),G(v(ow),{key:0,id:"resource-"+l.value,datasetId:u.datasetId,expandedOnMount:!0,resource:s.value,canEdit:u.canEdit,isCommunityResource:u.communityResource},null,8,["id","datasetId","resource","canEdit","isCommunityResource"])):V("",!0)]))]),_:1})],512)):V("",!0)}}),S_=W({__name:"Reuse",props:{reuse:{}},setup(n){return(e,t)=>{var r;return _(),G(v(E$),{reuse:e.reuse,reuseUrl:e.reuse.page,organizationUrl:(r=e.reuse.organization)==null?void 0:r.page},null,8,["reuse","reuseUrl","organizationUrl"])}}});function $R(n){return{all:n=n||new Map,on:function(e,t){var r=n.get(e);r?r.push(t):n.set(e,[t])},off:function(e,t){var r=n.get(e);r&&(t?r.splice(r.indexOf(t)>>>0,1):n.set(e,[]))},emit:function(e,t){var r=n.get(e);r&&r.slice().map(function(i){i(t)}),(r=n.get("*"))&&r.slice().map(function(i){i(e,t)})}}}const Jh="resourcesSearch",wm=$R(),DR=n=>{n.config.globalProperties.$bus=wm},ER=W({props:{eventName:{type:String,default:Jh},type:{type:String}},setup(n){const e=W9("",mh),t=()=>{wm.emit(n.eventName,{type:n.type,value:e.value})};zC&&it(e,t);let r;const i=()=>{r=setTimeout(()=>{t()},mh)};return Xn(()=>clearTimeout(r)),{search:t,searchWithoutAutocomplete:i,searchValue:e}}}),AR=["aria-label"],PR=["for"],NR=["id"],RR={class:"fr-btn",type:"submit"};function LR(n,e,t,r,i,s){return _(),S("form",{onSubmit:e[1]||(e[1]=$e((...o)=>n.searchWithoutAutocomplete&&n.searchWithoutAutocomplete(...o),["prevent"]))},[y("div",{class:"fr-search-bar",role:"search","aria-label":n.$t("Search files")},[y("label",{class:"fr-label",for:n.eventName},T(n.$t("Search files")),9,PR),xt(y("input",{class:"fr-input",placeholder:"Rechercher",type:"search",id:n.eventName,"onUpdate:modelValue":e[0]||(e[0]=o=>n.searchValue=o)},null,8,NR),[[Di,n.searchValue]]),y("button",RR,T(n.$t("Search")),1)],8,AR)],32)}const IR=Ne(ER,[["render",LR]]),zR={class:"fr-grid-row"},BR={class:"fr-col"},FR={key:0,class:"fr-col-auto"},VR=["href"],HR={key:0,class:"fr-my-3v"},WR={key:0},jR={key:1,class:"flex flex-direction-column gap-10px"},UR={key:0,class:"fr-my-0 fr-text--sm border-bottom",role:"status"},qR={key:1},a1=!1,YR=W({__name:"resources",props:{canEdit:{type:Boolean,default:!1},canEditResources:{default:()=>({})},datasetId:{},showTotal:{type:Boolean,default:!0},type:{},typeLabel:{},firstGroup:{type:Boolean,default:!0}},setup(n){var O;const e=n,{t}=De(),{toast:r}=Bn(),i=E(1),{hash:s}=C_(),o=A(()=>x_(s.value,e.type==="community")),a=E([]),l=cs.resources_default_page_size,c=new URL((O=cs.admin_root)!=null&&O.startsWith("http")?cs.admin_root:"".concat(document.location.origin).concat(cs.admin_root,"community-resource/new/")),u=new URLSearchParams({dataset_id:e.datasetId});c.search=u.toString();const d=c.toString(),f=E(0),h=E(0),p=E(!0),m=E(null),g=E(""),w=E(e.type==="community"),x=A(()=>!w.value&&f.value>cs.resources_min_count_to_show_search),M=A(()=>f.value!=h.value),b=(D=1,N=!1)=>{p.value=!0,N&&m.value&&m.value.scrollIntoView({behavior:"smooth"});let B;return w.value?B=V9(e.datasetId,D,l):B=F9(e.datasetId,e.type,D,l,g.value),B.then(U=>(U.data&&(a.value=U.data,h.value=U.total),U.total||0)).catch(()=>(r.error(t("An error occurred while fetching resources")),a.value=[],0)).finally(()=>{p.value=!1})},C=(D,N=!0)=>(i.value=D,b(D,N)),k=D=>e.canEdit?e.canEdit:e.canEditResources[D.id];w.value||wm.on(Jh,({type:D,value:N})=>{D===e.type&&(g.value=N,C(1,a1))});const $=()=>{C(1,a1).then(D=>f.value=D)};return Ke(()=>$()),(D,N)=>o.value?V("",!0):(_(),S("section",{key:0,class:"fr-mb-3v",ref_key:"top",ref:m},[y("div",zR,[y("div",BR,[y("h2",{class:me([{"fr-mt-4w":!D.firstGroup},"fr-mb-0 subtitle subtitle--uppercase"])},T(D.typeLabel),3)]),w.value?(_(),S("div",FR,[y("a",{class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 fr-icon-add-line fr-btn--icon-left",href:v(d)},T(v(t)("Add a community resource")),9,VR)])):V("",!0)]),x.value?(_(),S("div",HR,[P(IR,{eventName:v(Jh),type:D.type},null,8,["eventName","type"])])):V("",!0),P(Sl,{mode:"out-in"},{default:K(()=>[p.value?(_(),S("div",WR,[(_(!0),S(X,null,Ye(v(l),B=>(_(),G(v(aw),{class:"fr-mt-2w"}))),256))])):(_(),S("div",jR,[M.value?(_(),S("p",UR,T(v(t)("{count} results",h.value)),1)):V("",!0),(_(!0),S(X,null,Ye(a.value,B=>(_(),G(v(ow),{id:"resource-"+B.id,datasetId:D.datasetId,isCommunityResource:w.value,resource:B,canEdit:k(B)},null,8,["id","datasetId","isCommunityResource","resource","canEdit"]))),256)),h.value?h.value>v(l)?(_(),G(v(js),{key:2,class:"fr-mt-3w",page:i.value,"page-size":v(l),"total-results":h.value,onChange:C},null,8,["page","page-size","total-results"])):V("",!0):(_(),S("p",qR,T(v(t)("No files match your search.")),1))]))]),_:1})],512))}});const KR=Ne(YR,[["__scopeId","data-v-4aa480fc"]]),GR={key:0},XR=20,JR=W({__name:"CardList",props:{datasets:{},loading:{type:Boolean,default:!1},totalResults:{},pageSize:{default:XR}},emits:["changePage"],setup(n,{emit:e}){const t=e,r=E(1),i=E();function s(){i.value&&i.value.scrollIntoView({behavior:"smooth"})}function o(a){r.value=a,t("changePage",a),s()}return(a,l)=>a.loading?(_(),S("div",GR,[P(hm)])):a.totalResults?(_(),S(X,{key:1},[y("ul",{ref_key:"listRef",ref:i},[(_(!0),S(X,null,Ye(a.datasets,c=>(_(),S("li",{key:c.id},[P(s_,{dataset:c},null,8,["dataset"])]))),128))],512),a.totalResults>a.pageSize?(_(),G(v(js),{key:0,page:r.value,pageSize:a.pageSize,totalResults:a.totalResults,onChange:o,class:"fr-mt-2w"},null,8,["page","pageSize","totalResults"])):V("",!0)],64)):V("",!0)}}),ZR={key:0,class:"subtitle subtitle--uppercase fr-mb-5v"},QR=W({__name:"UserDatasetList",props:{owner:{}},setup(n){const{t:e}=De(),{toast:t}=Bn(),r=n,i=E([]),s=E(0),o=E(!1),a=E(null),l=3;function c(u){o.value=!0,a.value&&a.value.cancel(),a.value=gd(),Tl.get("/datasets/search/",{cancelToken:a.value.token,params:{page:u,owner:r.owner,page_size:l}}).then(d=>d.data).then(d=>{i.value=d.data,s.value=d.total,o.value=!1}).catch(d=>{hr.isCancel(d)||(t.error(e("Error getting search results.")),o.value=!1)})}return Ke(()=>{c(1)}),(u,d)=>(_(),S(X,null,[s.value?(_(),S("h2",ZR,T(v(e)("{n} datasets",s.value)),1)):V("",!0),P(JR,{"page-size":l,datasets:i.value,loading:o.value,"total-results":s.value,onChangePage:c},null,8,["datasets","loading","total-results"])],64))}}),eL={components:{ContentLoader:$l}};function tL(n,e,t,r,i,s){const o=yt("ContentLoader");return _(),G(o,{width:350,height:180,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},{default:K(()=>e[0]||(e[0]=[y("rect",{x:"43",y:"153",rx:"3",ry:"3",width:"97",height:"6"},null,-1),y("rect",{x:"44",y:"166",rx:"3",ry:"3",width:"97",height:"5"},null,-1),y("rect",{x:"184",y:"7",rx:"5",ry:"5",width:"130",height:"130"},null,-1),y("rect",{x:"198",y:"153",rx:"3",ry:"3",width:"97",height:"6"},null,-1),y("rect",{x:"199",y:"166",rx:"3",ry:"3",width:"97",height:"5"},null,-1),y("rect",{x:"27",y:"8",rx:"5",ry:"5",width:"130",height:"130"},null,-1)])),_:1})}const nL=Ne(eL,[["render",tL]]),rL={key:0},iL=20,sL=W({__name:"ReuseList",props:{reuses:{},loading:{type:Boolean,default:!1},totalResults:{},pageSize:{default:iL}},emits:["changePage"],setup(n,{emit:e}){const t=e,r=E(1),i=E();function s(){i.value&&i.value.scrollIntoView({behavior:"smooth"})}function o(a){r.value=a,t("changePage",a),s()}return(a,l)=>a.loading?(_(),S("div",rL,[P(nL)])):a.totalResults?(_(),S(X,{key:1},[y("ul",{ref_key:"listRef",ref:i,class:"fr-grid-row fr-grid-row--gutters"},[(_(!0),S(X,null,Ye(a.reuses,c=>(_(),S("li",{class:me(["fr-col-12",{"fr-col-md-6":a.reuses.length<=2,"fr-col-md-4":a.reuses.length>=3}]),key:c.id},[P(S_,{reuse:c},null,8,["reuse"])],2))),128))],512),a.totalResults>a.pageSize?(_(),G(v(js),{key:0,page:r.value,pageSize:a.pageSize,totalResults:a.totalResults,onChange:o,class:"fr-mt-2w"},null,8,["page","pageSize","totalResults"])):V("",!0)],64)):V("",!0)}}),oL={key:0,class:"subtitle subtitle--uppercase fr-mb-5v"},aL=W({__name:"UserReuseList",props:{owner:{}},setup(n){const{t:e}=De(),{toast:t}=Bn(),r=n,i=E([]),s=E(0),o=E(!1),a=E(null),l=6;function c(u){o.value=!0,a.value&&a.value.cancel(),a.value=gd(),Tl.get("/reuses/search/",{cancelToken:a.value.token,params:{page:u,owner:r.owner,page_size:l}}).then(d=>d.data).then(d=>{i.value=d.data,s.value=d.total,o.value=!1}).catch(d=>{hr.isCancel(d)||(t.error(e("Error getting search results.")),o.value=!1)})}return Ke(()=>{c(1)}),(u,d)=>(_(),S(X,null,[s.value?(_(),S("h2",oL,T(v(e)("{n} reuses",s.value)),1)):V("",!0),P(sL,{"page-size":l,reuses:i.value,loading:o.value,"total-results":s.value,onChangePage:c},null,8,["reuses","loading","total-results"])],64))}}),lL={key:0,class:"border border-blue-400 fr-p-2w bg-alt-grey"},cL={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},uL={class:"fr-col-12 fr-col-sm"},dL={class:"fr-h6 fr-mb-0 text-blue-400"},fL={class:"fr-col-auto flex"},hL=["href"],pL=["href"],mL=["href"],gL={key:1,class:"border border-blue-400 fr-p-2w fr-dataservice__box fr-dataservice__swagger"},vL={class:"fr-h6 fr-mb-0 text-blue-400"},yL={class:"flex items-center fr-ml-4v"},bL={key:0},wL=W({__name:"DataserviceLinks",props:{dataservice:{}},setup(n){const e=n,{t}=De(),r=E(!1),i=E(!1),s=lb(()=>ls(()=>import("./Swagger.6.2.3.js"),["js/Swagger.6.2.3.js","js/_commonjsHelpers.6.2.3.js","js/sentry.6.2.3.js"])),o=()=>{r.value=!r.value};function a(l){return l.endsWith(".json")||l.endsWith(".yaml")||l.endsWith(".yml")}return Ke(async()=>{e.dataservice.machine_documentation_url&&(i.value=a(e.dataservice.machine_documentation_url))}),(l,c)=>(_(),S("div",null,[!i.value&&l.dataservice.machine_documentation_url||l.dataservice.technical_documentation_url||l.dataservice.business_documentation_url?(_(),S("div",lL,[y("div",cL,[y("div",uL,[y("h2",dL,T(v(t)("API documentation")),1)]),y("div",fL,[l.dataservice.technical_documentation_url?(_(),S("a",{key:0,class:"fr-btn fr-ml-3v",href:l.dataservice.technical_documentation_url,target:"_blank",rel:"ugc nofollow noopener"},T(v(t)("Technical documentation")),9,hL)):V("",!0),!i.value&&l.dataservice.machine_documentation_url?(_(),S("a",{key:1,class:"fr-btn fr-ml-3v",href:l.dataservice.machine_documentation_url,target:"_blank",rel:"ugc nofollow noopener"},T(v(t)("Machine readable documentation")),9,pL)):V("",!0),l.dataservice.business_documentation_url?(_(),S("a",{key:2,class:me(["fr-btn fr-ml-3v",i.value?"":"fr-btn--secondary"]),href:l.dataservice.business_documentation_url,target:"_blank",rel:"ugc nofollow noopener"},T(v(t)("Business documentation")),11,mL)):V("",!0)])])])):V("",!0),c[0]||(c[0]=y("br",null,null,-1)),i.value?(_(),S("div",gL,[y("header",{class:"fr-p-2v flex items-center justify-between",onClick:o},[y("h2",vL,T(v(t)("Swagger")),1),y("div",yL,[y("div",{class:me(["fr-icon--sm fr-ml-4v",{"fr-icon-arrow-up-s-line":r.value,"fr-icon-arrow-down-s-line":!r.value}])},null,2)])]),r.value&&l.dataservice.machine_documentation_url?(_(),S("div",bL,[P(v(s),{url:l.dataservice.machine_documentation_url},null,8,["url"])])):V("",!0)])):V("",!0)]))}});const _L=Ne(wL,[["__scopeId","data-v-67dee39c"]]),kL=document.querySelectorAll("[data-tabs]");kL.forEach(n=>{const e=n.querySelectorAll("[role=tab]");e.forEach(t=>{t.addEventListener("click",r=>{var a,l,c;r.preventDefault();const i=r.target,s=Array.from(e).find(u=>u.getAttribute("aria-selected")==="true");if(s){s.setAttribute("aria-selected","false");const u=s.getAttribute("aria-controls")||"";(a=document.getElementById(u))==null||a.classList.remove("fr-unhidden")}const o=i.getAttribute("aria-controls")||"";i.setAttribute("aria-selected","true"),(l=document.getElementById(o))==null||l.classList.add("fr-unhidden"),(c=globalThis._paq)==null||c.push(["trackEvent","Move page to tab",window.location.pathname,t.textContent])})})});const xL=document.querySelectorAll("[data-accordion-button]");xL.forEach(n=>{n.addEventListener("click",e=>{e.preventDefault();const t=e.target;if(t instanceof HTMLElement){t.toggleAttribute("aria-expanded");const r=document.querySelector("#"+t.getAttribute("aria-controls"));r&&(r.classList.toggle("active"),Ob(r,t.hasAttribute("aria-expanded")))}})});var M_={exports:{}};/*!
 * clipboard.js v2.0.11
 * https://clipboardjs.com/
 *
 * Licensed MIT © Zeno Rocha
 */(function(n,e){(function(r,i){n.exports=i()})(ua,function(){return function(){var t={686:function(s,o,a){a.d(o,{default:function(){return je}});var l=a(279),c=a.n(l),u=a(370),d=a.n(u),f=a(817),h=a.n(f);function p(F){try{return document.execCommand(F)}catch(L){return!1}}var m=function(L){var I=h()(L);return p("cut"),I},g=m;function w(F){var L=document.documentElement.getAttribute("dir")==="rtl",I=document.createElement("textarea");I.style.fontSize="12pt",I.style.border="0",I.style.padding="0",I.style.margin="0",I.style.position="absolute",I.style[L?"right":"left"]="-9999px";var Q=window.pageYOffset||document.documentElement.scrollTop;return I.style.top="".concat(Q,"px"),I.setAttribute("readonly",""),I.value=F,I}var x=function(L,I){var Q=w(L);I.container.appendChild(Q);var ae=h()(Q);return p("copy"),Q.remove(),ae},M=function(L){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body},Q="";return typeof L=="string"?Q=x(L,I):L instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(L==null?void 0:L.type)?Q=x(L.value,I):(Q=h()(L),p("copy")),Q},b=M;function C(F){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?C=function(I){return typeof I}:C=function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},C(F)}var k=function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},I=L.action,Q=I===void 0?"copy":I,ae=L.container,j=L.target,R=L.text;if(Q!=="copy"&&Q!=="cut")throw new Error('Invalid "action" value, use either "copy" or "cut"');if(j!==void 0)if(j&&C(j)==="object"&&j.nodeType===1){if(Q==="copy"&&j.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if(Q==="cut"&&(j.hasAttribute("readonly")||j.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes')}else throw new Error('Invalid "target" value, use a valid Element');if(R)return b(R,{container:ae});if(j)return Q==="cut"?g(j):b(j,{container:ae})},$=k;function O(F){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?O=function(I){return typeof I}:O=function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},O(F)}function D(F,L){if(!(F instanceof L))throw new TypeError("Cannot call a class as a function")}function N(F,L){for(var I=0;I<L.length;I++){var Q=L[I];Q.enumerable=Q.enumerable||!1,Q.configurable=!0,"value"in Q&&(Q.writable=!0),Object.defineProperty(F,Q.key,Q)}}function B(F,L,I){return L&&N(F.prototype,L),I&&N(F,I),F}function U(F,L){if(typeof L!="function"&&L!==null)throw new TypeError("Super expression must either be null or a function");F.prototype=Object.create(L&&L.prototype,{constructor:{value:F,writable:!0,configurable:!0}}),L&&le(F,L)}function le(F,L){return le=Object.setPrototypeOf||function(Q,ae){return Q.__proto__=ae,Q},le(F,L)}function Te(F){var L=he();return function(){var Q=be(F),ae;if(L){var j=be(this).constructor;ae=Reflect.construct(Q,arguments,j)}else ae=Q.apply(this,arguments);return ee(this,ae)}}function ee(F,L){return L&&(O(L)==="object"||typeof L=="function")?L:ie(F)}function ie(F){if(F===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F}function he(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(F){return!1}}function be(F){return be=Object.setPrototypeOf?Object.getPrototypeOf:function(I){return I.__proto__||Object.getPrototypeOf(I)},be(F)}function ke(F,L){var I="data-clipboard-".concat(F);if(L.hasAttribute(I))return L.getAttribute(I)}var ge=function(F){U(I,F);var L=Te(I);function I(Q,ae){var j;return D(this,I),j=L.call(this),j.resolveOptions(ae),j.listenClick(Q),j}return B(I,[{key:"resolveOptions",value:function(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.action=typeof ae.action=="function"?ae.action:this.defaultAction,this.target=typeof ae.target=="function"?ae.target:this.defaultTarget,this.text=typeof ae.text=="function"?ae.text:this.defaultText,this.container=O(ae.container)==="object"?ae.container:document.body}},{key:"listenClick",value:function(ae){var j=this;this.listener=d()(ae,"click",function(R){return j.onClick(R)})}},{key:"onClick",value:function(ae){var j=ae.delegateTarget||ae.currentTarget,R=this.action(j)||"copy",Z=$({action:R,container:this.container,target:this.target(j),text:this.text(j)});this.emit(Z?"success":"error",{action:R,text:Z,trigger:j,clearSelection:function(){j&&j.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(ae){return ke("action",ae)}},{key:"defaultTarget",value:function(ae){var j=ke("target",ae);if(j)return document.querySelector(j)}},{key:"defaultText",value:function(ae){return ke("text",ae)}},{key:"destroy",value:function(){this.listener.destroy()}}],[{key:"copy",value:function(ae){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body};return b(ae,j)}},{key:"cut",value:function(ae){return g(ae)}},{key:"isSupported",value:function(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["copy","cut"],j=typeof ae=="string"?[ae]:ae,R=!!document.queryCommandSupported;return j.forEach(function(Z){R=R&&!!document.queryCommandSupported(Z)}),R}}]),I}(c()),je=ge},828:function(s){var o=9;if(typeof Element<"u"&&!Element.prototype.matches){var a=Element.prototype;a.matches=a.matchesSelector||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector||a.webkitMatchesSelector}function l(c,u){for(;c&&c.nodeType!==o;){if(typeof c.matches=="function"&&c.matches(u))return c;c=c.parentNode}}s.exports=l},438:function(s,o,a){var l=a(828);function c(f,h,p,m,g){var w=d.apply(this,arguments);return f.addEventListener(p,w,g),{destroy:function(){f.removeEventListener(p,w,g)}}}function u(f,h,p,m,g){return typeof f.addEventListener=="function"?c.apply(null,arguments):typeof p=="function"?c.bind(null,document).apply(null,arguments):(typeof f=="string"&&(f=document.querySelectorAll(f)),Array.prototype.map.call(f,function(w){return c(w,h,p,m,g)}))}function d(f,h,p,m){return function(g){g.delegateTarget=l(g.target,h),g.delegateTarget&&m.call(f,g)}}s.exports=u},879:function(s,o){o.node=function(a){return a!==void 0&&a instanceof HTMLElement&&a.nodeType===1},o.nodeList=function(a){var l=Object.prototype.toString.call(a);return a!==void 0&&(l==="[object NodeList]"||l==="[object HTMLCollection]")&&"length"in a&&(a.length===0||o.node(a[0]))},o.string=function(a){return typeof a=="string"||a instanceof String},o.fn=function(a){var l=Object.prototype.toString.call(a);return l==="[object Function]"}},370:function(s,o,a){var l=a(879),c=a(438);function u(p,m,g){if(!p&&!m&&!g)throw new Error("Missing required arguments");if(!l.string(m))throw new TypeError("Second argument must be a String");if(!l.fn(g))throw new TypeError("Third argument must be a Function");if(l.node(p))return d(p,m,g);if(l.nodeList(p))return f(p,m,g);if(l.string(p))return h(p,m,g);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function d(p,m,g){return p.addEventListener(m,g),{destroy:function(){p.removeEventListener(m,g)}}}function f(p,m,g){return Array.prototype.forEach.call(p,function(w){w.addEventListener(m,g)}),{destroy:function(){Array.prototype.forEach.call(p,function(w){w.removeEventListener(m,g)})}}}function h(p,m,g){return c(document.body,p,m,g)}s.exports=u},817:function(s){function o(a){var l;if(a.nodeName==="SELECT")a.focus(),l=a.value;else if(a.nodeName==="INPUT"||a.nodeName==="TEXTAREA"){var c=a.hasAttribute("readonly");c||a.setAttribute("readonly",""),a.select(),a.setSelectionRange(0,a.value.length),c||a.removeAttribute("readonly"),l=a.value}else{a.hasAttribute("contenteditable")&&a.focus();var u=window.getSelection(),d=document.createRange();d.selectNodeContents(a),u.removeAllRanges(),u.addRange(d),l=u.toString()}return l}s.exports=o},279:function(s){function o(){}o.prototype={on:function(a,l,c){var u=this.e||(this.e={});return(u[a]||(u[a]=[])).push({fn:l,ctx:c}),this},once:function(a,l,c){var u=this;function d(){u.off(a,d),l.apply(c,arguments)}return d._=l,this.on(a,d,c)},emit:function(a){var l=[].slice.call(arguments,1),c=((this.e||(this.e={}))[a]||[]).slice(),u=0,d=c.length;for(u;u<d;u++)c[u].fn.apply(c[u].ctx,l);return this},off:function(a,l){var c=this.e||(this.e={}),u=c[a],d=[];if(u&&l)for(var f=0,h=u.length;f<h;f++)u[f].fn!==l&&u[f].fn._!==l&&d.push(u[f]);return d.length?c[a]=d:delete c[a],this}},s.exports=o,s.exports.TinyEmitter=o}},r={};function i(s){if(r[s])return r[s].exports;var o=r[s]={exports:{}};return t[s](o,o.exports,i),o.exports}return function(){i.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(o,{a:o}),o}}(),function(){i.d=function(s,o){for(var a in o)i.o(o,a)&&!i.o(s,a)&&Object.defineProperty(s,a,{enumerable:!0,get:o[a]})}}(),function(){i.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)}}(),i(686)}().default})})(M_);var CL=M_.exports;const SL=pb(CL);new SL('[id$="-copy"]');function ML(n){n&&n.classList.remove("fr-hidden")}function TL(n){n&&n.classList.add("fr-hidden"),window.localStorage.setItem(n.id,"true")}function OL(n,e=3,t="/"){const r=window.location.pathname,i=n.id;if(window.localStorage.getItem(i)||!1||r.indexOf(t)===-1)return;const o="pv-"+i;let a=parseInt(window.sessionStorage.getItem(o)||"0",10);a>=e&&ML(n),a++,window.sessionStorage.setItem(o,a.toFixed(0))}const $L=document.querySelectorAll("[data-dialogs]");$L.forEach(n=>{OL(n),n.querySelectorAll("[data-dialogs-close]").forEach(t=>{t instanceof HTMLElement&&t.addEventListener("click",()=>TL(n))})});const DL=document.querySelectorAll("[data-select-sort]");DL.forEach(n=>{n.querySelectorAll("option").forEach(t=>{t.disabled=!1}),n.form&&(n.addEventListener("change",t=>{var r;(r=n.form)==null||r.dispatchEvent(new Event("submit"))}),n.form.addEventListener("submit",t=>{var r,i;t.preventDefault(),n.value||(n.disabled=!0),(r=n.form)==null||r.submit(),(i=globalThis._paq)==null||i.push(["trackEvent","Search","Sort",n.value])}))});function T_(n){return"#/".concat(n.dataset.updateUrl||n.getAttribute("aria-controls"))}function l1(n){n.forEach(e=>{const t=T_(e),r="#".concat(e.dataset.previousUrl);if(r&&window.location.hash.startsWith(r)){const i=window.location.hash.slice(r.length);window.location.hash="".concat(t,"/").concat(i)}if(window.location.hash.includes(t)){const i=e.getAttribute("aria-controls");i||console.error("TabButton without `aria-controls` ID.",e);const s=document.getElementById(i);s||console.error("Unknown TabPanel with id '".concat(i,"'."),e),dsfr(s).tabPanel.disclose()}})}function EL(){const n=document.querySelectorAll("[data-update-url]");window.addEventListener("hashchange",()=>{l1(n)}),n.forEach(e=>{const t=T_(e);e.addEventListener("click",()=>{var r;if(!window.location.hash.includes(t)){let i=new URL(window.location.href);i.hash=t,window.history.pushState(null,"",i),(r=globalThis._paq)==null||r.push(["trackEvent","Move page to hash",window.location.pathname,t])}})}),setTimeout(()=>{l1(n)},100)}async function AL(){return(await kt.get(Wp("reports/reasons/"))).data}async function PL(n,e,t,r){return(await kt.post("/reports/",{subject:{id:e,class:n},reason:t,message:r})).data}function c1(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function li(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?c1(Object(t),!0).forEach(function(r){NL(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):c1(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function NL(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function u1(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Object.keys(n).reduce((t,r)=>(e.includes(r)||(t[r]=v(n[r])),t),{})}function Yu(n){return typeof n=="function"}function RL(n){return mC(n)||gC(n)}function O_(n,e,t){let r=n;const i=e.split(".");for(let s=0;s<i.length;s++){if(!r[i[s]])return t;r=r[i[s]]}return r}function Df(n,e,t){return A(()=>n.some(r=>O_(e,r,{[t]:!1})[t]))}function d1(n,e,t){return A(()=>n.reduce((r,i)=>{const s=O_(e,i,{[t]:!1})[t]||[];return r.concat(s)},[]))}function $_(n,e,t,r){return n.call(r,v(e),v(t),r)}function D_(n){return n.$valid!==void 0?!n.$valid:!n}function LL(n,e,t,r,i,s,o){let{$lazy:a,$rewardEarly:l}=i,c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:[],u=arguments.length>8?arguments[8]:void 0,d=arguments.length>9?arguments[9]:void 0,f=arguments.length>10?arguments[10]:void 0;const h=E(!!r.value),p=E(0);t.value=!1;const m=it([e,r].concat(c,f),()=>{if(a&&!r.value||l&&!d.value&&!t.value)return;let g;try{g=$_(n,e,u,o)}catch(w){g=Promise.reject(w)}p.value++,t.value=!!p.value,h.value=!1,Promise.resolve(g).then(w=>{p.value--,t.value=!!p.value,s.value=w,h.value=D_(w)}).catch(w=>{p.value--,t.value=!!p.value,s.value=w,h.value=!0})},{immediate:!0,deep:typeof e=="object"});return{$invalid:h,$unwatch:m}}function IL(n,e,t,r,i,s,o,a){let{$lazy:l,$rewardEarly:c}=r;const u=()=>({}),d=A(()=>{if(l&&!t.value||c&&!a.value)return!1;let f=!0;try{const h=$_(n,e,o,s);i.value=h,f=D_(h)}catch(h){i.value=h}return f});return{$unwatch:u,$invalid:d}}function zL(n,e,t,r,i,s,o,a,l,c,u){const d=E(!1),f=n.$params||{},h=E(null);let p,m;n.$async?{$invalid:p,$unwatch:m}=LL(n.$validator,e,d,t,r,h,i,n.$watchTargets,l,c,u):{$invalid:p,$unwatch:m}=IL(n.$validator,e,t,r,h,i,l,c);const g=n.$message;return{$message:Yu(g)?A(()=>g(u1({$pending:d,$invalid:p,$params:u1(f),$model:e,$response:h,$validator:s,$propertyPath:a,$property:o}))):g||"",$params:f,$pending:d,$invalid:p,$response:h,$unwatch:m}}function BL(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=v(n),t=Object.keys(e),r={},i={},s={};let o=null;return t.forEach(a=>{const l=e[a];switch(!0){case Yu(l.$validator):r[a]=l;break;case Yu(l):r[a]={$validator:l};break;case a==="$validationGroups":o=l;break;case a.startsWith("$"):s[a]=l;break;default:i[a]=l}}),{rules:r,nestedValidators:i,config:s,validationGroups:o}}const FL="__root";function VL(n,e,t,r,i,s,o,a,l){const c=Object.keys(n),u=r.get(i,n),d=E(!1),f=E(!1),h=E(0);if(u){if(!u.$partial)return u;u.$unwatch(),d.value=u.$dirty.value}const p={$dirty:d,$path:i,$touch:()=>{d.value||(d.value=!0)},$reset:()=>{d.value&&(d.value=!1)},$commit:()=>{}};return c.length?(c.forEach(m=>{p[m]=zL(n[m],e,p.$dirty,s,o,m,t,i,l,f,h)}),p.$externalResults=A(()=>a.value?[].concat(a.value).map((m,g)=>({$propertyPath:i,$property:t,$validator:"$externalResults",$uid:"".concat(i,"-externalResult-").concat(g),$message:m,$params:{},$response:null,$pending:!1})):[]),p.$invalid=A(()=>{const m=c.some(g=>v(p[g].$invalid));return f.value=m,!!p.$externalResults.value.length||m}),p.$pending=A(()=>c.some(m=>v(p[m].$pending))),p.$error=A(()=>p.$dirty.value?p.$pending.value||p.$invalid.value:!1),p.$silentErrors=A(()=>c.filter(m=>v(p[m].$invalid)).map(m=>{const g=p[m];return Hs({$propertyPath:i,$property:t,$validator:m,$uid:"".concat(i,"-").concat(m),$message:g.$message,$params:g.$params,$response:g.$response,$pending:g.$pending})}).concat(p.$externalResults.value)),p.$errors=A(()=>p.$dirty.value?p.$silentErrors.value:[]),p.$unwatch=()=>c.forEach(m=>{p[m].$unwatch()}),p.$commit=()=>{f.value=!0,h.value=Date.now()},r.set(i,n,p),p):(u&&r.set(i,n,p),p)}function HL(n,e,t,r,i,s,o){const a=Object.keys(n);return a.length?a.reduce((l,c)=>(l[c]=Zh({validations:n[c],state:e,key:c,parentKey:t,resultsCache:r,globalConfig:i,instance:s,externalResults:o}),l),{}):{}}function WL(n,e,t){const r=A(()=>[e,t].filter(p=>p).reduce((p,m)=>p.concat(Object.values(v(m))),[])),i=A({get(){return n.$dirty.value||(r.value.length?r.value.every(p=>p.$dirty):!1)},set(p){n.$dirty.value=p}}),s=A(()=>{const p=v(n.$silentErrors)||[],m=r.value.filter(g=>(v(g).$silentErrors||[]).length).reduce((g,w)=>g.concat(...w.$silentErrors),[]);return p.concat(m)}),o=A(()=>{const p=v(n.$errors)||[],m=r.value.filter(g=>(v(g).$errors||[]).length).reduce((g,w)=>g.concat(...w.$errors),[]);return p.concat(m)}),a=A(()=>r.value.some(p=>p.$invalid)||v(n.$invalid)||!1),l=A(()=>r.value.some(p=>v(p.$pending))||v(n.$pending)||!1),c=A(()=>r.value.some(p=>p.$dirty)||r.value.some(p=>p.$anyDirty)||i.value),u=A(()=>i.value?l.value||a.value:!1),d=()=>{n.$touch(),r.value.forEach(p=>{p.$touch()})},f=()=>{n.$commit(),r.value.forEach(p=>{p.$commit()})},h=()=>{n.$reset(),r.value.forEach(p=>{p.$reset()})};return r.value.length&&r.value.every(p=>p.$dirty)&&d(),{$dirty:i,$errors:o,$invalid:a,$anyDirty:c,$error:u,$pending:l,$touch:d,$reset:h,$silentErrors:s,$commit:f}}function Zh(n){let{validations:e,state:t,key:r,parentKey:i,childResults:s,resultsCache:o,globalConfig:a={},instance:l,externalResults:c}=n;const u=i?"".concat(i,".").concat(r):r,{rules:d,nestedValidators:f,config:h,validationGroups:p}=BL(e),m=li(li({},a),h),g=r?A(()=>{const ge=v(t);return ge?v(ge[r]):void 0}):t,w=li({},v(c)||{}),x=A(()=>{const ge=v(c);return r?ge?v(ge[r]):void 0:ge}),M=VL(d,g,r,o,u,m,l,x,t),b=HL(f,g,u,o,m,l,x),C={};p&&Object.entries(p).forEach(ge=>{let[je,F]=ge;C[je]={$invalid:Df(F,b,"$invalid"),$error:Df(F,b,"$error"),$pending:Df(F,b,"$pending"),$errors:d1(F,b,"$errors"),$silentErrors:d1(F,b,"$silentErrors")}});const{$dirty:k,$errors:$,$invalid:O,$anyDirty:D,$error:N,$pending:B,$touch:U,$reset:le,$silentErrors:Te,$commit:ee}=WL(M,b,s),ie=r?A({get:()=>v(g),set:ge=>{k.value=!0;const je=v(t),F=v(c);F&&(F[r]=w[r]),Mu(je[r])?je[r].value=ge:je[r]=ge}}):null;r&&m.$autoDirty&&it(g,()=>{k.value||U();const ge=v(c);ge&&(ge[r]=w[r])},{flush:"sync"});async function he(){return U(),m.$rewardEarly&&(ee(),await rl()),await rl(),new Promise(ge=>{if(!B.value)return ge(!O.value);const je=it(B,()=>{ge(!O.value),je()})})}function be(ge){return(s.value||{})[ge]}function ke(){Mu(c)?c.value=w:Object.keys(w).length===0?Object.keys(c).forEach(ge=>{delete c[ge]}):Object.assign(c,w)}return Hs(li(li(li({},M),{},{$model:ie,$dirty:k,$error:N,$errors:$,$invalid:O,$anyDirty:D,$pending:B,$touch:U,$reset:le,$path:u||FL,$silentErrors:Te,$validate:he,$commit:ee},s&&{$getResultsForChild:be,$clearExternalResults:ke,$validationGroups:C}),b))}class jL{constructor(){this.storage=new Map}set(e,t,r){this.storage.set(e,{rules:t,result:r})}checkRulesValidity(e,t,r){const i=Object.keys(r),s=Object.keys(t);return s.length!==i.length||!s.every(a=>i.includes(a))?!1:s.every(a=>t[a].$params?Object.keys(t[a].$params).every(l=>v(r[a].$params[l])===v(t[a].$params[l])):!0)}get(e,t){const r=this.storage.get(e);if(!r)return;const{rules:i,result:s}=r,o=this.checkRulesValidity(e,t,i),a=s.$unwatch?s.$unwatch:()=>({});return o?s:{$dirty:s.$dirty,$partial:!0,$unwatch:a}}}const Hc={COLLECT_ALL:!0,COLLECT_NONE:!1},f1=Symbol("vuelidate#injectChildResults"),h1=Symbol("vuelidate#removeChildResults");function UL(n){let{$scope:e,instance:t}=n;const r={},i=E([]),s=A(()=>i.value.reduce((u,d)=>(u[d]=v(r[d]),u),{}));function o(u,d){let{$registerAs:f,$scope:h,$stopPropagation:p}=d;p||e===Hc.COLLECT_NONE||h===Hc.COLLECT_NONE||e!==Hc.COLLECT_ALL&&e!==h||(r[f]=u,i.value.push(f))}t.__vuelidateInjectInstances=[].concat(t.__vuelidateInjectInstances||[],o);function a(u){i.value=i.value.filter(d=>d!==u),delete r[u]}t.__vuelidateRemoveInstances=[].concat(t.__vuelidateRemoveInstances||[],a);const l=dt(f1,[]);Dt(f1,t.__vuelidateInjectInstances);const c=dt(h1,[]);return Dt(h1,t.__vuelidateRemoveInstances),{childResults:s,sendValidationResultsToParent:l,removeValidationResultsFromParent:c}}function E_(n){return new Proxy(n,{get(e,t){return typeof e[t]=="object"?E_(e[t]):A(()=>e[t])}})}let p1=0;function m1(n,e){var t;let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};arguments.length===1&&(r=n,n=void 0,e=void 0);let{$registerAs:i,$scope:s=Hc.COLLECT_ALL,$stopPropagation:o,$externalResults:a,currentVueInstance:l}=r;const c=l||((t=Ho())===null||t===void 0?void 0:t.proxy),u=c?c.$options:{};i||(p1+=1,i="_vuelidate_".concat(p1));const d=E({}),f=new jL,{childResults:h,sendValidationResultsToParent:p,removeValidationResultsFromParent:m}=c?UL({$scope:s,instance:c}):{childResults:E({})};if(!n&&u.validations){const g=u.validations;e=E({}),zp(()=>{e.value=c,it(()=>Yu(g)?g.call(e.value,new E_(e.value)):g,w=>{d.value=Zh({validations:w,state:e,childResults:h,resultsCache:f,globalConfig:r,instance:c,externalResults:a||c.vuelidateExternalResults})},{immediate:!0})}),r=u.validationsConfig||r}else{const g=Mu(n)||RL(n)?n:Hs(n||{});it(g,w=>{d.value=Zh({validations:w,state:e,childResults:h,resultsCache:f,globalConfig:r,instance:c!=null?c:{},externalResults:a})},{immediate:!0})}return c&&(p.forEach(g=>g(d,{$registerAs:i,$scope:s,$stopPropagation:o})),cb(()=>m.forEach(g=>g(i)))),A(()=>li(li({},v(d.value)),h.value))}function A_(n,e,t,r=!1){const i=m1(e,n,{$scope:r}),s=m1(t,n,{$scope:"warning"});return{getErrorText:u=>(s.value[u].$dirty&&i.value[u].$touch(),i.value[u].$errors.map(d=>d.$message).join("\n")),getFunctionalState:qL,getWarningText:u=>s.value[u].$errors.map(d=>d.$message).join("\n"),hasError:YL,hasWarning:Qh,reset:()=>{s.value.$reset(),i.value.$reset()},validateRequiredRules:()=>(s.value.$validate(),i.value.$validate(),i.value.$validate()),v$:i,vWarning$:s}}const qL=(n,e,t)=>n?e?"error":t?"warning":"success":"disabled",YL=(n,e)=>pt(n)[e]==="error",Qh=(n,e)=>pt(n)[e]==="warning",KL=["for"],GL={key:0,class:"fr-hint-text"},XL=["aria-describedby","id","required","disabled"],JL=["selected"],ZL=["value","selected","disabled","hidden"],QL=["id"],eI=["id"],tI=W({__name:"SelectGroup",props:{disabled:{type:Boolean,default:!1},errorText:{default:""},hasError:{type:Boolean,default:!1},hintText:{default:""},isValid:{type:Boolean,default:!1},label:{},modelValue:{default:void 0},options:{},required:{type:Boolean,default:!1},validText:{default:""}},emits:["update:modelValue"],setup(n,{emit:e}){const t=e,r=n,{id:i}=jo("select"),s=A(()=>i+"-desc-error"),o=A(()=>i+"-desc-valid"),a=A(()=>{let u="";return r.isValid?u+=" "+o:r.hasError&&(u+=" "+s),u}),l=A(()=>({"fr-select-group--disabled":r.disabled,"fr-select-group--error":r.hasError,"fr-select-group--valid":r.isValid})),c=u=>{var f;const d=u.target;t("update:modelValue",(f=d==null?void 0:d.value)!=null?f:"")};return(u,d)=>(_(),S("div",{class:me(["fr-select-group",l.value])},[y("label",{class:"fr-label",for:v(i)},[Y(T(u.label)+" ",1),P(pm,{required:u.required},null,8,["required"]),u.hintText?(_(),S("span",GL,T(u.hintText),1)):V("",!0)],8,KL),y("select",{class:me(["fr-select",{"fr-select--error":u.hasError,"fr-select--valid":u.isValid}]),"aria-describedby":a.value,id:v(i),required:u.required,disabled:u.disabled,onChange:c},[y("option",{value:"",selected:!u.modelValue,disabled:"",hidden:""},T(u.$t("Select an option")),9,JL),(_(!0),S(X,null,Ye(u.options,f=>(_(),S("option",{value:f.value,selected:f.selected,disabled:f.disabled,hidden:f.hidden},T(f.label),9,ZL))),256))],42,XL),u.isValid?(_(),S("p",{key:0,id:o.value,class:"fr-valid-text"},T(u.validText),9,QL)):u.hasError?(_(),S("p",{key:1,id:s.value,class:"fr-error-text"},T(u.errorText),9,eI)):V("",!0)],2))}});(function(){try{if(typeof document<"u"){var n=document.createElement("style");n.appendChild(document.createTextNode(".v3dp__popout[data-v-65eb861b]{z-index:10;position:absolute;text-align:center;width:17.5em;background-color:var(--popout-bg-color);box-shadow:var(--box-shadow);border-radius:var(--border-radius);padding:8px 0 1em;color:var(--text-color)}.v3dp__popout *[data-v-65eb861b]{color:inherit;font-size:inherit;font-weight:inherit}.v3dp__popout[data-v-65eb861b] button{background:none;border:none;outline:none}.v3dp__popout[data-v-65eb861b] button:not(:disabled){cursor:pointer}.v3dp__heading[data-v-65eb861b]{width:100%;display:flex;height:var(--heading-size);line-height:var(--heading-size);font-weight:var(--heading-weight)}.v3dp__heading__button[data-v-65eb861b]{background:none;border:none;padding:0;display:flex;justify-content:center;align-items:center;width:var(--heading-size)}button.v3dp__heading__center[data-v-65eb861b]:hover,.v3dp__heading__button[data-v-65eb861b]:not(:disabled):hover{background-color:var(--heading-hover-color)}.v3dp__heading__center[data-v-65eb861b]{flex:1}.v3dp__heading__icon[data-v-65eb861b]{height:12px;stroke:var(--arrow-color)}.v3dp__heading__button:disabled .v3dp__heading__icon[data-v-65eb861b]{stroke:var(--elem-disabled-color)}.v3dp__subheading[data-v-65eb861b],.v3dp__elements[data-v-65eb861b]{display:grid;grid-template-columns:var(--popout-column-definition);font-size:var(--elem-font-size)}.v3dp__subheading[data-v-65eb861b]{margin-top:1em}.v3dp__divider[data-v-65eb861b]{border:1px solid var(--divider-color);border-radius:3px}.v3dp__elements[data-v-65eb861b] button:disabled{color:var(--elem-disabled-color)}.v3dp__elements[data-v-65eb861b] button{padding:.3em .6em}.v3dp__elements[data-v-65eb861b] button span{display:block;line-height:1.9em;height:1.8em;border-radius:var(--elem-border-radius)}.v3dp__elements[data-v-65eb861b] button:not(:disabled):hover span{background-color:var(--elem-hover-bg-color);color:var(--elem-hover-color)}.v3dp__elements[data-v-65eb861b] button.selected span{background-color:var(--elem-selected-bg-color);color:var(--elem-selected-color)}.v3dp__elements[data-v-65eb861b] button.current span{font-weight:var(--elem-current-font-weight);outline:1px solid var(--elem-current-outline-color)}.v3dp__column[data-v-81ac698d]{display:flex;flex-direction:column;overflow-y:auto;height:190px}.v3dp__datepicker{--popout-bg-color: var(--vdp-bg-color, #fff);--box-shadow: var( --vdp-box-shadow, 0 4px 10px 0 rgba(128, 144, 160, .1), 0 0 1px 0 rgba(128, 144, 160, .81) );--text-color: var(--vdp-text-color, #000000);--border-radius: var(--vdp-border-radius, 3px);--heading-size: var(--vdp-heading-size, 2.5em);--heading-weight: var(--vdp-heading-weight, bold);--heading-hover-color: var(--vdp-heading-hover-color, #eeeeee);--arrow-color: var(--vdp-arrow-color, currentColor);--elem-color: var(--vdp-elem-color, currentColor);--elem-disabled-color: var(--vdp-disabled-color, #d5d9e0);--elem-hover-color: var(--vdp-hover-color, #fff);--elem-hover-bg-color: var(--vdp-hover-bg-color, #0baf74);--elem-selected-color: var(--vdp-selected-color, #fff);--elem-selected-bg-color: var(--vdp-selected-bg-color, #0baf74);--elem-current-outline-color: var(--vdp-current-date-outline-color, #888);--elem-current-font-weight: var(--vdp-current-date-font-weight, bold);--elem-font-size: var(--vdp-elem-font-size, .8em);--elem-border-radius: var(--vdp-elem-border-radius, 3px);--divider-color: var(--vdp-divider-color, var(--elem-disabled-color));position:relative}.v3dp__clearable{display:inline;position:relative;left:-15px;cursor:pointer}")),document.head.appendChild(n)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();const nI=["year","month","day","time","custom"],rI=W({emits:{elementClick:n=>wn(n),left:()=>!0,right:()=>!0,heading:()=>!0},props:{headingClickable:{type:Boolean,default:!1},leftDisabled:{type:Boolean,default:!1},rightDisabled:{type:Boolean,default:!1},columnCount:{type:Number,default:7},items:{type:Array,default:()=>[]},viewMode:{type:String,required:!0,validate:n=>typeof n=="string"&&nI.includes(n)}}}),Uo=(n,e)=>{const t=n.__vccOpts||n;for(const[r,i]of e)t[r]=i;return t},_m=n=>(vC("data-v-65eb861b"),n=n(),yC(),n),iI={class:"v3dp__heading"},sI=["disabled"],oI=_m(()=>y("svg",{class:"v3dp__heading__icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 6 8"},[y("g",{fill:"none","fill-rule":"evenodd"},[y("path",{stroke:"none",d:"M-9 16V-8h24v24z"}),y("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 0L1 4l4 4"})])],-1)),aI=["disabled"],lI=_m(()=>y("svg",{class:"v3dp__heading__icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 6 8"},[y("g",{fill:"none","fill-rule":"evenodd"},[y("path",{stroke:"none",d:"M15-8v24H-9V-8z"}),y("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M1 8l4-4-4-4"})])],-1)),cI={class:"v3dp__body"},uI={class:"v3dp__subheading"},dI=_m(()=>y("hr",{class:"v3dp__divider"},null,-1)),fI={class:"v3dp__elements"},hI=["disabled","onClick"];function pI(n,e,t,r,i,s){return _(),S("div",{class:me(["v3dp__popout","v3dp__popout-".concat(n.viewMode)]),style:Wo({"--popout-column-definition":"repeat(".concat(n.columnCount,", 1fr)")}),onMousedown:e[3]||(e[3]=$e(()=>{},["prevent"]))},[y("div",iI,[y("button",{class:"v3dp__heading__button v3dp__heading__button__left",disabled:n.leftDisabled,onClick:e[0]||(e[0]=$e(o=>n.$emit("left"),["stop","prevent"]))},[et(n.$slots,"arrow-left",{},()=>[oI],!0)],8,sI),(_(),G(ys(n.headingClickable?"button":"span"),{class:"v3dp__heading__center",onClick:e[1]||(e[1]=$e(o=>n.$emit("heading"),["stop","prevent"]))},{default:K(()=>[et(n.$slots,"heading",{},void 0,!0)]),_:3})),y("button",{class:"v3dp__heading__button v3dp__heading__button__right",disabled:n.rightDisabled,onClick:e[2]||(e[2]=$e(o=>n.$emit("right"),["stop","prevent"]))},[et(n.$slots,"arrow-right",{},()=>[lI],!0)],8,aI)]),y("div",cI,["subheading"in n.$slots?(_(),S(X,{key:0},[y("div",uI,[et(n.$slots,"subheading",{},void 0,!0)]),dI],64)):V("",!0),y("div",fI,[et(n.$slots,"body",{},()=>[(_(!0),S(X,null,Ye(n.items,o=>(_(),S("button",{key:o.key,disabled:o.disabled,class:me([{selected:o.selected,current:o.current},"v3dp__element__button__".concat(n.viewMode)]),onClick:$e(a=>n.$emit("elementClick",o.value),["stop","prevent"])},[y("span",null,T(o.display),1)],10,hI))),128))],!0)])])],38)}const $d=Uo(rI,[["render",pI],["__scopeId","data-v-65eb861b"]]),mI=W({components:{PickerPopup:$d},emits:{"update:pageDate":n=>wn(n),select:n=>wn(n)},props:{selected:{type:Date,required:!1},pageDate:{type:Date,required:!0},lowerLimit:{type:Date,required:!1},upperLimit:{type:Date,required:!1}},setup(n,{emit:e}){const t=A(()=>I9(n.pageDate)),r=A(()=>o7(n.pageDate)),i=(c,u,d)=>!u&&!d?!0:!(u&&Wn(c)<Wn(u)||d&&Wn(c)>Wn(d)),s=A(()=>s7({start:t.value,end:r.value}).map(c=>({value:c,key:String(Wn(c)),display:Wn(c),selected:!!n.selected&&Wn(c)===Wn(n.selected),disabled:!i(c,n.lowerLimit,n.upperLimit)}))),o=A(()=>{const c=Wn(t.value),u=Wn(r.value);return"".concat(c," - ").concat(u)}),a=A(()=>n.lowerLimit&&(yc(n.lowerLimit)===yc(n.pageDate)||hl(n.pageDate,n.lowerLimit))),l=A(()=>n.upperLimit&&(yc(n.upperLimit)===yc(n.pageDate)||fl(n.pageDate,n.upperLimit)));return{years:s,heading:o,leftDisabled:a,rightDisabled:l,previousPage:()=>e("update:pageDate",k_(n.pageDate,10)),nextPage:()=>e("update:pageDate",gm(n.pageDate,10))}}});function gI(n,e,t,r,i,s){const o=yt("picker-popup");return _(),G(o,{columnCount:3,leftDisabled:n.leftDisabled,rightDisabled:n.rightDisabled,items:n.years,viewMode:"year",onLeft:n.previousPage,onRight:n.nextPage,onElementClick:e[0]||(e[0]=a=>n.$emit("select",a))},{heading:K(()=>[Y(T(n.heading),1)]),_:1},8,["leftDisabled","rightDisabled","items","onLeft","onRight"])}const vI=Uo(mI,[["render",gI]]),yI=W({components:{PickerPopup:$d},emits:{"update:pageDate":n=>wn(n),select:n=>wn(n),back:()=>!0},props:{selected:{type:Date,required:!1},pageDate:{type:Date,required:!0},format:{type:String,required:!1,default:"LLL"},locale:{type:Object,required:!1},lowerLimit:{type:Date,required:!1},upperLimit:{type:Date,required:!1}},setup(n,{emit:e}){const t=A(()=>i7(n.pageDate)),r=A(()=>r7(n.pageDate)),i=A(()=>u=>$o(u,n.format,{locale:n.locale})),s=(u,d,f)=>!d&&!f?!0:!(d&&hl(u,l_(d))||f&&fl(u,a_(f))),o=A(()=>n7({start:t.value,end:r.value}).map(u=>({value:u,display:i.value(u),key:i.value(u),selected:!!n.selected&&Xh(n.selected,u),disabled:!s(u,n.lowerLimit,n.upperLimit)}))),a=A(()=>Wn(t.value)),l=A(()=>n.lowerLimit&&(i1(n.lowerLimit,n.pageDate)||hl(n.pageDate,n.lowerLimit))),c=A(()=>n.upperLimit&&(i1(n.upperLimit,n.pageDate)||fl(n.pageDate,n.upperLimit)));return{months:o,heading:a,leftDisabled:l,rightDisabled:c,previousPage:()=>e("update:pageDate",k_(n.pageDate,1)),nextPage:()=>e("update:pageDate",gm(n.pageDate,1))}}});function bI(n,e,t,r,i,s){const o=yt("picker-popup");return _(),G(o,{headingClickable:"",columnCount:3,items:n.months,leftDisabled:n.leftDisabled,rightDisabled:n.rightDisabled,viewMode:"month",onLeft:n.previousPage,onRight:n.nextPage,onHeading:e[0]||(e[0]=a=>n.$emit("back")),onElementClick:e[1]||(e[1]=a=>n.$emit("select",a))},{heading:K(()=>[Y(T(n.heading),1)]),_:1},8,["items","leftDisabled","rightDisabled","onLeft","onRight"])}const wI=Uo(yI,[["render",bI]]),_I=W({components:{PickerPopup:$d},emits:{"update:pageDate":n=>wn(n),select:n=>wn(n),back:()=>!0},props:{selected:{type:Date,required:!1},pageDate:{type:Date,required:!0},format:{type:String,required:!1,default:"dd"},headingFormat:{type:String,required:!1,default:"LLLL yyyy"},weekdayFormat:{type:String,required:!1,default:"EE"},locale:{type:Object,required:!1},weekStartsOn:{type:Number,required:!1,default:1,validator:n=>typeof n=="number"&&Number.isInteger(n)&&n>=0&&n<=6},lowerLimit:{type:Date,required:!1},upperLimit:{type:Date,required:!1},disabledDates:{type:Object,required:!1},allowOutsideInterval:{type:Boolean,required:!1,default:!1}},setup(n,{emit:e}){const t=A(()=>h=>p=>$o(p,h,{locale:n.locale,weekStartsOn:n.weekStartsOn})),r=A(()=>l_(n.pageDate)),i=A(()=>a_(n.pageDate)),s=A(()=>({start:r.value,end:i.value})),o=A(()=>({start:YP(r.value,{weekStartsOn:n.weekStartsOn}),end:a7(i.value,{weekStartsOn:n.weekStartsOn})})),a=A(()=>{const h=n.weekStartsOn,p=t.value(n.weekdayFormat);return Array.from(Array(7)).map((m,g)=>(h+g)%7).map(m=>L9(new Date,m,{weekStartsOn:n.weekStartsOn})).map(p)}),l=(h,p,m,g)=>{var w,x;return(w=g==null?void 0:g.dates)!=null&&w.some(M=>Of(h,M))||(x=g==null?void 0:g.predicate)!=null&&x.call(g,h)?!1:!p&&!m?!0:!(p&&hl(h,Yh(p))||m&&fl(h,e7(m)))},c=A(()=>{const h=new Date,p=t.value(n.format);return t7(o.value).map(m=>({value:m,display:p(m),selected:!!n.selected&&Of(n.selected,m),current:Of(h,m),disabled:!n.allowOutsideInterval&&!N9(m,s.value)||!l(m,n.lowerLimit,n.upperLimit,n.disabledDates),key:t.value("yyyy-MM-dd")(m)}))}),u=A(()=>t.value(n.headingFormat)(n.pageDate)),d=A(()=>n.lowerLimit&&(Xh(n.lowerLimit,n.pageDate)||hl(n.pageDate,n.lowerLimit))),f=A(()=>n.upperLimit&&(Xh(n.upperLimit,n.pageDate)||fl(n.pageDate,n.upperLimit)));return{weekDays:a,days:c,heading:u,leftDisabled:d,rightDisabled:f,previousPage:()=>e("update:pageDate",z9(n.pageDate,1)),nextPage:()=>e("update:pageDate",mm(n.pageDate,1))}}});function kI(n,e,t,r,i,s){const o=yt("picker-popup");return _(),G(o,{headingClickable:"",leftDisabled:n.leftDisabled,rightDisabled:n.rightDisabled,items:n.days,viewMode:"day",onLeft:n.previousPage,onRight:n.nextPage,onHeading:e[0]||(e[0]=a=>n.$emit("back")),onElementClick:e[1]||(e[1]=a=>n.$emit("select",a))},{heading:K(()=>[Y(T(n.heading),1)]),subheading:K(()=>[(_(!0),S(X,null,Ye(n.weekDays,(a,l)=>(_(),S("span",{key:a,class:me("v3dp__subheading__weekday__".concat(l))},T(a),3))),128))]),_:1},8,["leftDisabled","rightDisabled","items","onLeft","onRight"])}const xI=Uo(_I,[["render",kI]]);function g1(n,e){const t=n.getBoundingClientRect(),r={height:n.clientHeight,width:n.clientWidth},i=e.getBoundingClientRect();if(!(i.top>=t.top&&i.bottom<=t.top+r.height)){const s=i.top-t.top,o=i.bottom-t.bottom;Math.abs(s)<Math.abs(o)?n.scrollTop+=s:n.scrollTop+=o}}const CI=W({components:{PickerPopup:$d},emits:{select:n=>wn(n),back:()=>!0},props:{selected:{type:Date,required:!1},pageDate:{type:Date,required:!0},visible:{type:Boolean,required:!0},disabledTime:{type:Object,required:!1}},setup(n,{emit:e}){const t=E(null),r=E(null),i=A(()=>{var d;return(d=n.pageDate)!=null?d:n.selected}),s=E(i.value.getHours()),o=E(i.value.getMinutes());it(()=>n.selected,d=>{let f=0,h=0;d&&(f=d.getHours(),h=d.getMinutes()),s.value=f,o.value=h});const a=A(()=>[...Array(24).keys()].map(d=>({value:d,date:s1(new Date(i.value.getTime()),{hours:d,minutes:o.value,seconds:0}),selected:s.value===d,ref:E(null)}))),l=A(()=>[...Array(60).keys()].map(d=>({value:d,date:s1(new Date(i.value.getTime()),{hours:s.value,minutes:d,seconds:0}),selected:o.value===d,ref:E(null)}))),c=d=>{o.value=d.value,e("select",d.date)},u=()=>{const d=a.value.find(h=>{var g;var p,m;return(g=(m=(p=h.ref.value)==null?void 0:p.classList)==null?void 0:m.contains("selected"))!=null?g:!1}),f=l.value.find(h=>{var g;var p,m;return(g=(m=(p=h.ref.value)==null?void 0:p.classList)==null?void 0:m.contains("selected"))!=null?g:!1});d&&f&&(g1(t.value,d.ref.value),g1(r.value,f.ref.value))};return it(()=>n.visible,d=>{d&&rl(u)}),{hoursListRef:t,minutesListRef:r,hours:s,minutes:o,hoursList:a,minutesList:l,padStartZero:d=>"0".concat(d).substr(-2),selectMinutes:c,isEnabled:d=>{var f,h,p,m;return!((h=(f=n.disabledTime)==null?void 0:f.dates)!=null&&h.some(g=>A9(d,g)&&P9(d,g))||(m=(p=n.disabledTime)==null?void 0:p.predicate)!=null&&m.call(p,d))},scroll:u}}}),SI={ref:"hoursListRef",class:"v3dp__column"},MI=["disabled","onClick"],TI={ref:"minutesListRef",class:"v3dp__column"},OI=["disabled","onClick"];function $I(n,e,t,r,i,s){const o=yt("picker-popup");return _(),G(o,{headingClickable:"",columnCount:2,leftDisabled:!0,rightDisabled:!0,viewMode:"time",onHeading:e[0]||(e[0]=a=>n.$emit("back"))},{heading:K(()=>[Y(T(n.padStartZero(n.hours))+":"+T(n.padStartZero(n.minutes)),1)]),body:K(()=>[y("div",SI,[(_(!0),S(X,null,Ye(n.hoursList,a=>(_(),S("button",{key:a.value,ref_for:!0,ref:a.ref,class:me([{selected:a.selected},"v3dp__element_button__hour"]),disabled:!n.isEnabled(a.date),onClick:$e(l=>n.hours=a.value,["stop","prevent"])},[y("span",null,T(n.padStartZero(a.value)),1)],10,MI))),128))],512),y("div",TI,[(_(!0),S(X,null,Ye(n.minutesList,a=>(_(),S("button",{key:a.value,ref_for:!0,ref:a.ref,class:me([{selected:a.selected},"v3dp__element_button__minute"]),disabled:!n.isEnabled(a.date),onClick:$e(l=>n.selectMinutes(a),["stop","prevent"])},[y("span",null,T(n.padStartZero(a.value)),1)],10,OI))),128))],512)]),_:1})}const DI=Uo(CI,[["render",$I],["__scopeId","data-v-81ac698d"]]),wc=["time","day","month","year"],EI=(n,e,t=void 0)=>{let r=t||new Date;return n&&(r=KP([n,r])),e&&(r=GP([e,r])),r},AI=W({components:{YearPicker:vI,MonthPicker:wI,DayPicker:xI,TimePicker:DI},inheritAttrs:!1,props:{placeholder:{type:String,default:""},modelValue:{type:Date,required:!1},disabledDates:{type:Object,required:!1},allowOutsideInterval:{type:Boolean,required:!1,default:!1},disabledTime:{type:Object,required:!1},upperLimit:{type:Date,required:!1},lowerLimit:{type:Date,required:!1},startingView:{type:String,required:!1,default:"day",validate:n=>typeof n=="string"&&wc.includes(n)},startingViewDate:{type:Date,required:!1,default:()=>new Date},dayPickerHeadingFormat:{type:String,required:!1,default:"LLLL yyyy"},monthListFormat:{type:String,required:!1,default:"LLL"},weekdayFormat:{type:String,required:!1,default:"EE"},dayFormat:{type:String,required:!1,default:"dd"},inputFormat:{type:String,required:!1,default:"yyyy-MM-dd"},locale:{type:Object,required:!1},weekStartsOn:{type:Number,required:!1,default:1,validator:n=>[0,1,2,3,4,5,6].includes(n)},disabled:{type:Boolean,required:!1,default:!1},clearable:{type:Boolean,required:!1,default:!1},typeable:{type:Boolean,required:!1,default:!1},minimumView:{type:String,required:!1,default:"day",validate:n=>typeof n=="string"&&wc.includes(n)}},emits:{"update:modelValue":n=>n==null||wn(n),decadePageChanged:n=>!0,yearPageChanged:n=>!0,monthPageChanged:n=>!0,opened:()=>!0,closed:()=>!0},setup(n,{emit:e,attrs:t}){const r=E("none"),i=E(n.startingViewDate),s=E(null),o=E(!1),a=E("");zt(()=>{const b=n1(a.value,n.inputFormat,new Date,{locale:n.locale});wn(b)&&(i.value=b)}),zt(()=>a.value=n.modelValue&&wn(n.modelValue)?$o(n.modelValue,n.inputFormat,{locale:n.locale}):"");const l=(b="none")=>{n.disabled||(b!=="none"&&r.value==="none"&&(i.value=n.modelValue||EI(n.lowerLimit,n.upperLimit,i.value)),r.value=b,e(b!=="none"?"opened":"closed"))};zt(()=>{n.disabled&&(r.value="none")});const c=(b,C)=>{i.value=C,b==="year"?e("decadePageChanged",C):b==="month"?e("yearPageChanged",C):b==="day"&&e("monthPageChanged",C)},u=b=>{i.value=b,n.minimumView==="year"?(l("none"),e("update:modelValue",b)):r.value="month"},d=b=>{i.value=b,n.minimumView==="month"?(l("none"),e("update:modelValue",b)):r.value="day"},f=b=>{i.value=b,n.minimumView==="day"?(l("none"),e("update:modelValue",b)):r.value="time"},h=b=>{l("none"),e("update:modelValue",b)},p=()=>{n.clearable&&(l("none"),e("update:modelValue",null),i.value=n.startingViewDate)},m=()=>o.value=!0,g=()=>l(M.value),w=()=>{o.value=!1,l()},x=b=>{const C=b.keyCode?b.keyCode:b.which;if([27,13].includes(C)&&s.value.blur(),n.typeable){const k=n1(s.value.value,n.inputFormat,new Date,{locale:n.locale});wn(k)&&a.value===$o(k,n.inputFormat,{locale:n.locale})&&(a.value=s.value.value,e("update:modelValue",k))}},M=A(()=>{const b=wc.indexOf(n.startingView),C=wc.indexOf(n.minimumView);return b<C?n.minimumView:n.startingView});return{blur:w,focus:g,click:m,input:a,inputRef:s,pageDate:i,renderView:l,updatePageDate:c,selectYear:u,selectMonth:d,selectDay:f,selectTime:h,keyUp:x,viewShown:r,goBackFromTimepicker:()=>n.startingView==="time"&&n.minimumView==="time"?null:r.value="day",clearModelValue:p,initialView:M,log:b=>console.log(b),variables:b=>Object.fromEntries(Object.entries(b!=null?b:{}).filter(([C,k])=>C.startsWith("--")))}}}),PI={class:"v3dp__input_wrapper"},NI=["readonly","placeholder","disabled","tabindex"],RI={class:"v3dp__clearable"};function LI(n,e,t,r,i,s){const o=yt("year-picker"),a=yt("month-picker"),l=yt("day-picker"),c=yt("time-picker");return _(),S("div",{class:"v3dp__datepicker",style:Wo(n.variables(n.$attrs.style))},[y("div",PI,[xt(y("input",yr({type:"text",ref:"inputRef",readonly:!n.typeable,"onUpdate:modelValue":e[0]||(e[0]=u=>n.input=u)},n.$attrs,{placeholder:n.placeholder,disabled:n.disabled,tabindex:n.disabled?-1:0,onKeyup:e[1]||(e[1]=(...u)=>n.keyUp&&n.keyUp(...u)),onBlur:e[2]||(e[2]=(...u)=>n.blur&&n.blur(...u)),onFocus:e[3]||(e[3]=(...u)=>n.focus&&n.focus(...u)),onClick:e[4]||(e[4]=(...u)=>n.click&&n.click(...u))}),null,16,NI),[[Di,n.input]]),xt(y("div",RI,[et(n.$slots,"clear",{onClear:n.clearModelValue},()=>[y("i",{onClick:e[5]||(e[5]=u=>n.clearModelValue())},"x")])],512),[[di,n.clearable&&n.modelValue]])]),xt(P(o,{pageDate:n.pageDate,"onUpdate:pageDate":e[6]||(e[6]=u=>n.updatePageDate("year",u)),selected:n.modelValue,lowerLimit:n.lowerLimit,upperLimit:n.upperLimit,onSelect:n.selectYear},null,8,["pageDate","selected","lowerLimit","upperLimit","onSelect"]),[[di,n.viewShown==="year"]]),xt(P(a,{pageDate:n.pageDate,"onUpdate:pageDate":e[7]||(e[7]=u=>n.updatePageDate("month",u)),selected:n.modelValue,onSelect:n.selectMonth,lowerLimit:n.lowerLimit,upperLimit:n.upperLimit,format:n.monthListFormat,locale:n.locale,onBack:e[8]||(e[8]=u=>n.viewShown="year")},null,8,["pageDate","selected","onSelect","lowerLimit","upperLimit","format","locale"]),[[di,n.viewShown==="month"]]),xt(P(l,{pageDate:n.pageDate,"onUpdate:pageDate":e[9]||(e[9]=u=>n.updatePageDate("day",u)),selected:n.modelValue,weekStartsOn:n.weekStartsOn,lowerLimit:n.lowerLimit,upperLimit:n.upperLimit,headingFormat:n.dayPickerHeadingFormat,disabledDates:n.disabledDates,locale:n.locale,weekdayFormat:n.weekdayFormat,"allow-outside-interval":n.allowOutsideInterval,format:n.dayFormat,onSelect:n.selectDay,onBack:e[10]||(e[10]=u=>n.viewShown="month")},null,8,["pageDate","selected","weekStartsOn","lowerLimit","upperLimit","headingFormat","disabledDates","locale","weekdayFormat","allow-outside-interval","format","onSelect"]),[[di,n.viewShown==="day"]]),xt(P(c,{pageDate:n.pageDate,visible:n.viewShown==="time",selected:n.modelValue,disabledTime:n.disabledTime,onSelect:n.selectTime,onBack:n.goBackFromTimepicker},null,8,["pageDate","visible","selected","disabledTime","onSelect","onBack"]),[[di,n.viewShown==="time"]])],4)}const P_=Uo(AI,[["render",LI]]),II=W({components:{Datepicker:P_},emits:["change","update:modelValue"],props:{modelValue:{type:Object,default:()=>({start:null,end:null})}},setup(n,{emit:e}){const t=E(n.modelValue.start),r=E(n.modelValue.end),i=il("startRef"),s=il("endRef"),o=E(null),a="START",l="END",c="L";it([t,r],()=>{let m={start:null,end:null};t.value&&r.value&&(m={start:$o(t.value,"yyyy-MM-dd"),end:$o(r.value,"yyyy-MM-dd")}),e("update:modelValue",m),e("change",m)});const u=()=>{t.value=null,r.value=null},d=m=>{m.value&&m.value.renderView(m.value.initialView)};return{start:t,end:r,showStartSelector:()=>{o.value=a,d(i)},showEndSelector:()=>{o.value=l,d(s)},hideSelector:()=>{o.value=null},selectorShown:o,selectorShownStart:a,selectorShownEnd:l,locale:fb(Hp),clear:u,formatDate:Ei,formatTemplate:c}}}),zI={class:"rangepicker__hint fr-m-0"},BI={class:"rangepicker__hint fr-m-0"};function FI(n,e,t,r,i,s){const o=yt("Datepicker");return _(),S("div",{class:me(["rangepicker fr-select",{"rangepicker--selected":n.start}])},[xt(y("div",null,[y("p",zI,T(n.$t("Select lower bound:")),1),P(o,{modelValue:n.start,"onUpdate:modelValue":[e[0]||(e[0]=a=>n.start=a),n.showEndSelector],upperLimit:n.end,locale:n.locale,ref:"startRef"},null,8,["modelValue","upperLimit","locale","onUpdate:modelValue"])],512),[[di,n.selectorShown===n.selectorShownStart]]),xt(y("div",null,[y("p",BI,T(n.$t("Select upper bound:")),1),P(o,{modelValue:n.end,"onUpdate:modelValue":[e[1]||(e[1]=a=>n.end=a),n.hideSelector],lowerLimit:n.start,locale:n.locale,ref:"endRef"},null,8,["modelValue","lowerLimit","locale","onUpdate:modelValue"])],512),[[di,n.selectorShown===n.selectorShownEnd]]),n.selectorShown===null?(_(),S("button",{key:0,class:"rangepicker__button w-100 text-align-left",onClick:e[3]||(e[3]=$e((...a)=>n.showStartSelector&&n.showStartSelector(...a),["prevent"]))},[n.start?(_(),S(X,{key:1},[Y(T(n.formatDate(n.start,n.formatTemplate)),1),n.end?(_(),S(X,{key:0},[Y("–"+T(n.formatDate(n.end,n.formatTemplate)),1)],64)):V("",!0),n.start?(_(),S("button",{key:1,class:"fr-fi-close-line clear",onClick:e[2]||(e[2]=$e((...a)=>n.clear&&n.clear(...a),["stop"]))})):V("",!0)],64)):(_(),S(X,{key:0},[Y(T(n.$t("from dd/mm/yyyy to dd/mm/yyyy")),1)],64))])):V("",!0)],2)}const VI=Ne(II,[["render",FI]]);function HI(){const{dom:n,loading:e,editor:t,editorFactory:r}=dt(Dd,{});return Ke(()=>{if(!n.value)return;const i=r.value(n.value);i&&(e.value=!0,i.create().then(s=>{t.value=s}).finally(()=>{e.value=!1}).catch(console.error))}),Xn(()=>{var i;(i=t.value)==null||i.destroy()}),n}const Dd=Symbol("editorInfoCtxKey"),WI=W({name:"Milkdown",setup:()=>{const n=HI();return()=>P("div",{"data-milkdown-root":!0,ref:n},null)}}),jI=W({name:"MilkdownProvider",setup:(n,{slots:e})=>{const t=E(null),r=E(void 0),i=E(void 0),s=E(!0);return Dt(Dd,{loading:s,dom:t,editor:i,editorFactory:r}),()=>{var o;return P(X,null,[(o=e.default)==null?void 0:o.call(e)])}}});function UI(n){const{editorFactory:e,loading:t,editor:r}=dt(Dd);return e.value=n,{loading:t,get:()=>r.value}}function Pl(){const n=dt(Dd);return[n.loading,()=>n.editor.value]}var qI=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},N_=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},ep=(n,e,t)=>(qI(n,e,"access private method"),t),Wc,tp;let YI=class{constructor({node:e,view:t,getPos:r,decorations:i,innerDecorations:s,options:o}){N_(this,Wc),this.selected=!1,this.selectNode=()=>{var a,l;this.selected=!0,(l=(a=this.options).selectNode)==null||l.call(a)},this.deselectNode=()=>{var a,l;this.selected=!1,(l=(a=this.options).deselectNode)==null||l.call(a)},this.shouldUpdate=a=>!(a.type!==this.node.type||a.sameMarkup(this.node)&&a.content.eq(this.node.content)),this.update=(a,l,c)=>{var u,d;const f=this.options.update;let h;return f&&(h=f(a,l,c)),typeof h!="boolean"&&(h=this.shouldUpdate(a)),this.node=a,this.decorations=l,this.innerDecorations=c,h&&((d=(u=this.options).onUpdate)==null||d.call(u)),h},this.shouldIgnoreMutation=a=>!this.dom||!this.contentDOM||this.node.isLeaf||this.node.isAtom?!0:a.type==="selection"?!1:this.contentDOM===a.target&&a.type==="attributes"?!0:!this.contentDOM.contains(a.target),this.ignoreMutation=a=>{if(!this.dom||!this.contentDOM)return!0;let l;const c=this.options.ignoreMutation;return c&&(l=c(a)),typeof l!="boolean"&&(l=this.shouldIgnoreMutation(a)),l},this.destroy=()=>{var a,l,c;(l=(a=this.options).destroy)==null||l.call(a),this.dom.remove(),(c=this.contentDOM)==null||c.remove()},this.setAttrs=a=>{const{dispatch:l,state:c}=this.view,u=this.getPos();if(typeof u=="number")return l(c.tr.setNodeMarkup(u,void 0,{...this.node.attrs,...a}))},this.node=e,this.view=t,this.getPos=r,this.decorations=i,this.innerDecorations=s,this.options=o,this.dom=this.createDOM(o.as),this.contentDOM=e.isLeaf?null:this.createContentDOM(o.contentAs),this.dom.setAttribute("data-node-view-root","true"),this.contentDOM&&(this.contentDOM.setAttribute("data-node-view-content","true"),this.contentDOM.style.whiteSpace="inherit"),this.setSelection=o.setSelection,this.stopEvent=o.stopEvent}createDOM(e){return ep(this,Wc,tp).call(this,e)}createContentDOM(e){return ep(this,Wc,tp).call(this,e)}get component(){return this.options.component}};Wc=new WeakSet,tp=function(n){const{node:e}=this;return n==null?document.createElement(e.isInline?"span":"div"):n instanceof HTMLElement?n:n instanceof Function?n(e):document.createElement(n)};let KI=class{constructor(e){this.view=e.view,this.options=e.options}get component(){return this.options.component}get root(){var i;var e,t;let r=(t=(e=this.options).root)==null?void 0:t.call(e,this.view.dom);return r||(r=(i=this.view.dom.parentElement)!=null?i:document.body),r}update(e,t){var r,i;this.view=e,this.prevState=t,(i=(r=this.options).update)==null||i.call(r,e,t)}destroy(){var e,t;(t=(e=this.options).destroy)==null||t.call(e)}};var np,R_;let GI=class{constructor({pos:e,spec:t,options:r}){N_(this,np),this.pos=e,this.options=r,this.spec=t,this.dom=ep(this,np,R_).call(this,r.as),this.dom.setAttribute("data-widget-view-root","true")}bind(e,t){this.view=e,this.getPos=t}get component(){return this.options.component}};np=new WeakSet,R_=function(n){return n instanceof HTMLElement?n:document.createElement(n)};let km=(n=21)=>crypto.getRandomValues(new Uint8Array(n)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");function Rt(n){this.content=n}Rt.prototype={constructor:Rt,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,i=r.find(n),s=r.content.slice();return i==-1?s.push(t||n,e):(s[i+1]=e,t&&(s[i]=t)),new Rt(s)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new Rt(t)},addToStart:function(n,e){return new Rt([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new Rt(t)},addBefore:function(n,e,t){var r=this.remove(e),i=r.content.slice(),s=r.find(n);return i.splice(s==-1?i.length:s,0,e,t),new Rt(i)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=Rt.from(n),n.size?new Rt(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=Rt.from(n),n.size?new Rt(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=Rt.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};Rt.from=function(n){if(n instanceof Rt)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new Rt(e)};function L_(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),s=e.child(r);if(i==s){t+=i.nodeSize;continue}if(!i.sameMarkup(s))return t;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)t++;return t}if(i.content.size||s.content.size){let o=L_(i.content,s.content,t+1);if(o!=null)return o}t+=i.nodeSize}}function I_(n,e,t,r){for(let i=n.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:t,b:r};let o=n.child(--i),a=e.child(--s),l=o.nodeSize;if(o==a){t-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:t,b:r};if(o.isText&&o.text!=a.text){let c=0,u=Math.min(o.text.length,a.text.length);for(;c<u&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(o.content.size||a.content.size){let c=I_(o.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}class q{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,s){for(let o=0,a=0;a<t;o++){let l=this.content[o],c=a+l.nodeSize;if(c>e&&r(l,i+a,s||null,o)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,i+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let s="",o=!0;return this.nodesBetween(e,t,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,t-l):a.isLeaf?i?typeof i=="function"?i(a):i:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(o?o=!1:s+=r),s+=c},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),s=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new q(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let s=0,o=0;o<t;s++){let a=this.content[s],l=o+a.nodeSize;l>e&&((o<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-o),Math.min(a.text.length,t-o)):a=a.cut(Math.max(0,e-o-1),Math.min(a.content.size,t-o-1))),r.push(a),i+=a.nodeSize),o=l}return new q(r,i)}cutByIndex(e,t){return e==t?q.empty:e==0&&t==this.content.length?this:new q(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),s=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new q(i,s)}addToStart(e){return new q([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new q(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return L_(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return I_(this,e,t,r)}findIndex(e,t=-1){if(e==0)return _c(0,e);if(e==this.size)return _c(this.content.length,e);if(e>this.size||e<0)throw new RangeError("Position ".concat(e," outside of fragment (").concat(this,")"));for(let r=0,i=0;;r++){let s=this.child(r),o=i+s.nodeSize;if(o>=e)return o==e||t>0?_c(r+1,o):_c(r,i);i=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return q.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new q(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return q.empty;let t,r=0;for(let i=0;i<e.length;i++){let s=e[i];r+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(t||(t=e.slice(0,i)),t[t.length-1]=s.withText(t[t.length-1].text+s.text)):t&&t.push(s)}return new q(t||e,r)}static from(e){if(!e)return q.empty;if(e instanceof q)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new q([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}q.empty=new q([],0);const Ef={index:0,offset:0};function _c(n,e){return Ef.index=n,Ef.offset=e,Ef}function Ku(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!Ku(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!Ku(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}class Pe{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let i=0;i<e.length;i++){let s=e[i];if(this.eq(s))return e;if(this.type.excludes(s.type))t||(t=e.slice(0,i));else{if(s.type.excludes(this.type))return e;!r&&s.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),r=!0),t&&t.push(s)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Ku(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError("There is no mark type ".concat(t.type," in this schema"));return r.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Pe.none;if(e instanceof Pe)return[e];let t=e.slice();return t.sort((r,i)=>r.type.rank-i.type.rank),t}}Pe.none=[];class Gu extends Error{}class J{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=B_(this.content,e+this.openStart,t);return r&&new J(r,this.openStart,this.openEnd)}removeBetween(e,t){return new J(z_(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return J.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new J(q.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=e.lastChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.lastChild)i++;return new J(e,r,i)}}J.empty=new J(q.empty,0,0);function z_(n,e,t){let{index:r,offset:i}=n.findIndex(e),s=n.maybeChild(r),{index:o,offset:a}=n.findIndex(t);if(i==e||s.isText){if(a!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,s.copy(z_(s.content,e-i-1,t-i-1)))}function B_(n,e,t,r){let{index:i,offset:s}=n.findIndex(e),o=n.maybeChild(i);if(s==e||o.isText)return r&&!r.canReplace(i,i,t)?null:n.cut(0,e).append(t).append(n.cut(e));let a=B_(o.content,e-s-1,t);return a&&n.replaceChild(i,o.copy(a))}function XI(n,e,t){if(t.openStart>n.depth)throw new Gu("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new Gu("Inconsistent open depths");return F_(n,e,t,0)}function F_(n,e,t,r){let i=n.index(r),s=n.node(r);if(i==e.index(r)&&r<n.depth-t.openStart){let o=F_(n,e,t,r+1);return s.copy(s.content.replaceChild(i,o))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let o=n.parent,a=o.content;return ks(o,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:o,end:a}=JI(t,n);return ks(s,H_(n,o,a,e,r))}else return ks(s,Xu(n,e,r))}function V_(n,e){if(!e.type.compatibleContent(n.type))throw new Gu("Cannot join "+e.type.name+" onto "+n.type.name)}function rp(n,e,t){let r=n.node(t);return V_(r,e.node(t)),r}function _s(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function Ua(n,e,t,r){let i=(e||n).node(t),s=0,o=e?e.index(t):i.childCount;n&&(s=n.index(t),n.depth>t?s++:n.textOffset&&(_s(n.nodeAfter,r),s++));for(let a=s;a<o;a++)_s(i.child(a),r);e&&e.depth==t&&e.textOffset&&_s(e.nodeBefore,r)}function ks(n,e){return n.type.checkContent(e),n.copy(e)}function H_(n,e,t,r,i){let s=n.depth>i&&rp(n,e,i+1),o=r.depth>i&&rp(t,r,i+1),a=[];return Ua(null,n,i,a),s&&o&&e.index(i)==t.index(i)?(V_(s,o),_s(ks(s,H_(n,e,t,r,i+1)),a)):(s&&_s(ks(s,Xu(n,e,i+1)),a),Ua(e,t,i,a),o&&_s(ks(o,Xu(t,r,i+1)),a)),Ua(r,null,i,a),new q(a)}function Xu(n,e,t){let r=[];if(Ua(null,n,t,r),n.depth>t){let i=rp(n,e,t+1);_s(ks(i,Xu(n,e,t+1)),r)}return Ua(e,null,t,r),new q(r)}function JI(n,e){let t=e.depth-n.openStart,i=e.node(t).copy(n.content);for(let s=t-1;s>=0;s--)i=e.node(s).copy(q.from(i));return{start:i.resolveNoCache(n.openStart+t),end:i.resolveNoCache(i.content.size-n.openEnd-t)}}class pl{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(t);return r?e.child(t).cut(r):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],i=t==0?0:this.path[t*3-1]+1;for(let s=0;s<e;s++)i+=r.child(s).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return Pe.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),i=e.maybeChild(t);if(!r){let a=r;r=i,i=a}let s=r.marks;for(var o=0;o<s.length;o++)s[o].type.spec.inclusive===!1&&(!i||!s[o].isInSet(i.marks))&&(s=s[o--].removeFromSet(s));return s}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,i=e.parent.maybeChild(e.index());for(var s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!i||!r[s].isInSet(i.marks))&&(r=r[s--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new W_(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],i=0,s=t;for(let o=e;;){let{index:a,offset:l}=o.content.findIndex(s),c=s-l;if(r.push(o,a,i+l),!c||(o=o.child(a),o.isText))break;s=c-1,i+=l+1}return new pl(t,r,s)}static resolveCached(e,t){for(let i=0;i<Af.length;i++){let s=Af[i];if(s.pos==t&&s.doc==e)return s}let r=Af[Pf]=pl.resolve(e,t);return Pf=(Pf+1)%ZI,r}}let Af=[],Pf=0,ZI=12;class W_{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const QI=Object.create(null);let xi=class ip{constructor(e,t,r,i=Pe.none){this.type=e,this.attrs=t,this.marks=i,this.content=r||q.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,i=0){this.content.nodesBetween(e,t,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,i){return this.content.textBetween(e,t,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&Ku(this.attrs,t||e.defaultAttrs||QI)&&Pe.sameSet(this.marks,r||Pe.none)}copy(e=null){return e==this.content?this:new ip(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new ip(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return J.empty;let i=this.resolve(e),s=this.resolve(t),o=r?0:i.sharedDepth(t),a=i.start(o),c=i.node(o).content.cut(i.pos-a,s.pos-a);return new J(c,i.depth-o,s.depth-o)}replace(e,t,r){return XI(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let i=this.content.child(t-1);return{node:i,index:t-1,offset:r-i.nodeSize}}resolve(e){return pl.resolveCached(this,e)}resolveNoCache(e){return pl.resolve(this,e)}rangeHasMark(e,t,r){let i=!1;return t>e&&this.nodesBetween(e,t,s=>(r.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),j_(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=q.empty,i=0,s=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,i,s),a=o&&o.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=i;l<s;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,t,r,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(e).matchType(r),o=s&&s.matchFragment(this.content,t);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content);let e=Pe.none;for(let t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!Pe.sameSet(e,this.marks))throw new RangeError("Invalid collection of marks for node ".concat(this.type.name,": ").concat(this.marks.map(t=>t.type.name)));this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let i=q.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,i,r)}};xi.prototype.text=void 0;class Ju extends xi{constructor(e,t,r,i){if(super(e,t,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):j_(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Ju(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Ju(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function j_(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class Is{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new ez(e,t);if(r.next==null)return Is.empty;let i=U_(r);r.next&&r.err("Unexpected trailing text");let s=az(oz(i));return lz(s,r),s}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let i=this;for(let s=t;i&&s<r;s++)i=i.matchType(e.child(s).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let i=[this];function s(o,a){let l=o.matchFragment(e,r);if(l&&(!t||l.validEnd))return q.from(a.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:u,next:d}=o.next[c];if(!(u.isText||u.hasRequiredAttrs())&&i.indexOf(d)==-1){i.push(d);let f=s(d,a.concat(u));if(f)return f}}return null}return s(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),s=i.match;if(s.matchType(e)){let o=[];for(let a=i;a.type;a=a.via)o.push(a.type);return o.reverse()}for(let o=0;o<s.next.length;o++){let{type:a,next:l}=s.next[o];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!i.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:i}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError("There's no ".concat(e,"th edge in this content match"));return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&t(r.next[i].next)}return t(this),e.map((r,i)=>{let s=i+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)s+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return s}).join("\n")}}Is.empty=new Is(!0);class ez{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function U_(n){let e=[];do e.push(tz(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function tz(n){let e=[];do e.push(nz(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function nz(n){let e=sz(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=rz(n,e);else break;return e}function v1(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function rz(n,e){let t=v1(n),r=t;return n.eat(",")&&(n.next!="}"?r=v1(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function iz(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let i=[];for(let s in t){let o=t[s];o.groups.indexOf(e)>-1&&i.push(o)}return i.length==0&&n.err("No node type or group '"+e+"' found"),i}function sz(n){if(n.eat("(")){let e=U_(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=iz(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function oz(n){let e=[[]];return i(s(n,0),t()),e;function t(){return e.push([])-1}function r(o,a,l){let c={term:l,to:a};return e[o].push(c),c}function i(o,a){o.forEach(l=>l.to=a)}function s(o,a){if(o.type=="choice")return o.exprs.reduce((l,c)=>l.concat(s(c,a)),[]);if(o.type=="seq")for(let l=0;;l++){let c=s(o.exprs[l],a);if(l==o.exprs.length-1)return c;i(c,a=t())}else if(o.type=="star"){let l=t();return r(a,l),i(s(o.expr,l),l),[r(l)]}else if(o.type=="plus"){let l=t();return i(s(o.expr,a),l),i(s(o.expr,l),l),[r(l)]}else{if(o.type=="opt")return[r(a)].concat(s(o.expr,a));if(o.type=="range"){let l=a;for(let c=0;c<o.min;c++){let u=t();i(s(o.expr,l),u),l=u}if(o.max==-1)i(s(o.expr,l),l);else for(let c=o.min;c<o.max;c++){let u=t();r(l,u),i(s(o.expr,l),u),l=u}return[r(l)]}else{if(o.type=="name")return[r(a,void 0,o.value)];throw new Error("Unknown expr type")}}}}function q_(n,e){return e-n}function y1(n,e){let t=[];return r(e),t.sort(q_);function r(i){let s=n[i];if(s.length==1&&!s[0].term)return r(s[0].to);t.push(i);for(let o=0;o<s.length;o++){let{term:a,to:l}=s[o];!a&&t.indexOf(l)==-1&&r(l)}}}function az(n){let e=Object.create(null);return t(y1(n,0));function t(r){let i=[];r.forEach(o=>{n[o].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<i.length;u++)i[u][0]==a&&(c=i[u][1]);y1(n,l).forEach(u=>{c||i.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let s=e[r.join(",")]=new Is(r.indexOf(n.length-1)>-1);for(let o=0;o<i.length;o++){let a=i[o][1].sort(q_);s.next.push({type:i[o][0],next:e[a.join(",")]||t(a)})}return s}}function lz(n,e){for(let t=0,r=[n];t<r.length;t++){let i=r[t],s=!i.validEnd,o=[];for(let a=0;a<i.next.length;a++){let{type:l,next:c}=i.next[a];o.push(l.name),s&&!(l.isText||l.hasRequiredAttrs())&&(s=!1),r.indexOf(c)==-1&&r.push(c)}s&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Y_(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function K_(n,e){let t=Object.create(null);for(let r in n){let i=e&&e[r];if(i===void 0){let s=n[r];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=i}return t}function G_(n){let e=Object.create(null);if(n)for(let t in n)e[t]=new cz(n[t]);return e}let b1=class X_{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=G_(r.attrs),this.defaultAttrs=Y_(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Is.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:K_(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new xi(this,this.computeAttrs(e),q.from(t),Pe.setFrom(r))}createChecked(e=null,t,r){return t=q.from(t),this.checkContent(t),new xi(this,this.computeAttrs(e),t,Pe.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=q.from(t),t.size){let o=this.contentMatch.fillBefore(t);if(!o)return null;t=o.append(t)}let i=this.contentMatch.matchFragment(t),s=i&&i.fillBefore(q.empty,!0);return s?new xi(this,e,t.append(s),Pe.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError("Invalid content for node ".concat(this.name,": ").concat(e.toString().slice(0,50)))}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:Pe.none:e}static compile(e,t){let r=Object.create(null);e.forEach((s,o)=>r[s]=new X_(s,t,o));let i=t.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let s in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};class cz{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}}class Ed{constructor(e,t,r,i){this.name=e,this.rank=t,this.schema=r,this.spec=i,this.attrs=G_(i.attrs),this.excluded=null;let s=Y_(this.attrs);this.instance=s?new Pe(this,s):null}create(e=null){return!e&&this.instance?this.instance:new Pe(this,K_(this.attrs,e))}static compile(e,t){let r=Object.create(null),i=0;return e.forEach((s,o)=>r[s]=new Ed(s,i++,t,o)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}excludes(e){return this.excluded.indexOf(e)>-1}}class uz{constructor(e){this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=Rt.from(e.nodes),t.marks=Rt.from(e.marks||{}),this.nodes=b1.compile(this.spec.nodes,this),this.marks=Ed.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],o=s.spec.content||"",a=s.spec.marks;s.contentMatch=r[o]||(r[o]=Is.parse(o,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.markSet=a=="_"?null:a?w1(this,a.split(" ")):a==""||!s.inlineContent?[]:null}for(let i in this.marks){let s=this.marks[i],o=s.spec.excludes;s.excluded=o==null?[s]:o==""?[]:w1(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof b1){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,i)}text(e,t){let r=this.nodes.text;return new Ju(r,r.defaultAttrs,e,Pe.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return xi.fromJSON(this,e)}markFromJSON(e){return Pe.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function w1(n,e){let t=[];for(let r=0;r<e.length;r++){let i=e[r],s=n.marks[i],o=s;if(s)t.push(s);else for(let a in n.marks){let l=n.marks[a];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&t.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}class Eo{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach(r=>{r.tag?this.tags.push(r):r.style&&this.styles.push(r)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let i=e.nodes[r.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let r=new k1(this,t,!1);return r.addAll(e,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new k1(this,t,!0);return r.addAll(e,t.from,t.to),J.maxOpen(r.finish())}matchTag(e,t,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(hz(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||t.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(e);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(e,t,r,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],a=o.style;if(!(a.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(o.getAttrs){let l=o.getAttrs(t);if(l===!1)continue;o.attrs=l||void 0}return o}}}static schemaRules(e){let t=[];function r(i){let s=i.priority==null?50:i.priority,o=0;for(;o<t.length;o++){let a=t[o];if((a.priority==null?50:a.priority)<s)break}t.splice(o,0,i)}for(let i in e.marks){let s=e.marks[i].spec.parseDOM;s&&s.forEach(o=>{r(o=x1(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in e.nodes){let s=e.nodes[i].spec.parseDOM;s&&s.forEach(o=>{r(o=x1(o)),o.node||o.ignore||o.mark||(o.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Eo(e,Eo.schemaRules(e)))}}const J_={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},dz={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Z_={ol:!0,ul:!0},Zu=1,Qu=2,qa=4;function _1(n,e,t){return e!=null?(e?Zu:0)|(e==="full"?Qu:0):n&&n.whitespace=="pre"?Zu|Qu:t&~qa}class kc{constructor(e,t,r,i,s,o,a){this.type=e,this.attrs=t,this.marks=r,this.pendingMarks=i,this.solid=s,this.options=a,this.content=[],this.activeMarks=Pe.none,this.stashMarks=[],this.match=o||(a&qa?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(q.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Zu)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let t=q.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(q.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,r=this.pendingMarks;t<r.length;t++){let i=r[t];(this.type?this.type.allowsMarkType(i.type):mz(i.type,e))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!J_.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class k1{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0;let i=t.topNode,s,o=_1(null,t.preserveWhitespace,0)|(r?qa:0);i?s=new kc(i.type,i.attrs,Pe.none,Pe.none,!0,t.topMatch||i.type.contentMatch,o):r?s=new kc(null,null,Pe.none,Pe.none,!0,null,o):s=new kc(e.schema.topNodeType,null,Pe.none,Pe.none,!0,null,o),this.nodes=[s],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){e.nodeType==3?this.addTextNode(e):e.nodeType==1&&this.addElement(e)}withStyleRules(e,t){let r=e.getAttribute("style");if(!r)return t();let i=this.readStyles(pz(r));if(!i)return;let[s,o]=i,a=this.top;for(let l=0;l<o.length;l++)this.removePendingMark(o[l],a);for(let l=0;l<s.length;l++)this.addPendingMark(s[l]);t();for(let l=0;l<s.length;l++)this.removePendingMark(s[l],a);for(let l=0;l<o.length;l++)this.addPendingMark(o[l])}addTextNode(e){let t=e.nodeValue,r=this.top;if(r.options&Qu||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(r.options&Zu)r.options&Qu?t=t.replace(/\r\n?/g,"\n"):t=t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let i=r.content[r.content.length-1],s=e.previousSibling;(!i||s&&s.nodeName=="BR"||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let r=e.nodeName.toLowerCase(),i;Z_.hasOwnProperty(r)&&this.parser.normalizeLists&&fz(e);let s=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(i=this.parser.matchTag(e,this,t));if(s?s.ignore:dz.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!s||s.skip||s.closeParent){s&&s.closeParent?this.open=Math.max(0,this.open-1):s&&s.skip.nodeType&&(e=s.skip);let o,a=this.top,l=this.needsBlock;if(J_.hasOwnProperty(r))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),o=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}s&&s.skip?this.addAll(e):this.withStyleRules(e,()=>this.addAll(e)),o&&this.sync(a),this.needsBlock=l}else this.withStyleRules(e,()=>{this.addElementByRule(e,s,s.consuming===!1?i:void 0)})}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=Pe.none,r=Pe.none;for(let i=0;i<e.length;i+=2)for(let s=void 0;;){let o=this.parser.matchStyle(e[i],e[i+1],this,s);if(!o)break;if(o.ignore)return null;if(o.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach(a=>{o.clearMark(a)&&(r=a.addToSet(r))}):t=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(t),o.consuming===!1)s=o;else break}return[t,r]}addElementByRule(e,t,r){let i,s,o;t.node?(s=this.parser.schema.nodes[t.node],s.isLeaf?this.insertNode(s.create(t.attrs))||this.leafFallback(e):i=this.enter(s,t.attrs||null,t.preserveWhitespace)):(o=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(o));let a=this.top;if(s&&s.isLeaf)this.findInside(e);else if(r)this.addElement(e,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l)}i&&this.sync(a)&&this.open--,o&&this.removePendingMark(o,a)}addAll(e,t,r){let i=t||0;for(let s=t?e.childNodes[t]:e.firstChild,o=r==null?null:e.childNodes[r];s!=o;s=s.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(s);this.findAtPoint(e,i)}findPlace(e){let t,r;for(let i=this.open;i>=0;i--){let s=this.nodes[i],o=s.findWrapping(e);if(o&&(!t||t.length>o.length)&&(t=o,r=s,!o.length)||s.solid)break}if(!t)return!1;this.sync(r);for(let i=0;i<t.length;i++)this.enterInner(t[i],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let r=t.activeMarks;for(let i=0;i<e.marks.length;i++)(!t.type||t.type.allowsMarkType(e.marks[i].type))&&(r=e.marks[i].addToSet(r));return t.content.push(e.mark(r)),!0}return!1}enter(e,t,r){let i=this.findPlace(e.create(t));return i&&this.enterInner(e,t,!0,r),i}enterInner(e,t=null,r=!1,i){this.closeExtra();let s=this.top;s.applyPending(e),s.match=s.match&&s.match.matchType(e);let o=_1(e,i,s.options);s.options&qa&&s.content.length==0&&(o|=qa),this.nodes.push(new kc(e,t,s.activeMarks,s.pendingMarks,r,null,o)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),s=-(r?r.depth+1:0)+(i?0:1),o=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=s;l--)if(o(a-1,l))return!0;return!1}else{let u=l>0||l==0&&i?this.nodes[l].type:r&&l>=s?r.node(l-s).type:null;if(!u||u.name!=c&&u.groups.indexOf(c)==-1)return!1;l--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(e){let t=gz(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let r=this.open;r>=0;r--){let i=this.nodes[r];if(i.pendingMarks.lastIndexOf(e)>-1)i.pendingMarks=e.removeFromSet(i.pendingMarks);else{i.activeMarks=e.removeFromSet(i.activeMarks);let o=i.popFromStashMark(e);o&&i.type&&i.type.allowsMarkType(o.type)&&(i.activeMarks=o.addToSet(i.activeMarks))}if(i==t)break}}}function fz(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&Z_.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function hz(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function pz(n){let e=/\s*([\w-]+)\s*:\s*([^;]+)/g,t,r=[];for(;t=e.exec(n);)r.push(t[1],t[2].trim());return r}function x1(n){let e={};for(let t in n)e[t]=n[t];return e}function mz(n,e){let t=e.schema.nodes;for(let r in t){let i=t[r];if(!i.allowsMarkType(n))continue;let s=[],o=a=>{s.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||s.indexOf(u)<0&&o(u))return!0}};if(o(i.contentMatch))return!0}}function gz(n,e){for(let t=0;t<e.length;t++)if(n.eq(e[t]))return e[t]}class Fr{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=Nf(t).createDocumentFragment());let i=r,s=[];return e.forEach(o=>{if(s.length||o.marks.length){let a=0,l=0;for(;a<s.length&&l<o.marks.length;){let c=o.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(s[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<s.length;)i=s.pop()[1];for(;l<o.marks.length;){let c=o.marks[l++],u=this.serializeMark(c,o.isInline,t);u&&(s.push([c,i]),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(this.serializeNodeInner(o,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:i}=Fr.renderSpec(Nf(t),this.nodes[e.type.name](e));if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let s=this.serializeMark(e.marks[i],e.isInline,t);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(e,t,r={}){let i=this.marks[e.type.name];return i&&Fr.renderSpec(Nf(r),i(e,t))}static renderSpec(e,t,r=null){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let i=t[0],s=i.indexOf(" ");s>0&&(r=i.slice(0,s),i=i.slice(s+1));let o,a=r?e.createElementNS(r,i):e.createElement(i),l=t[1],c=1;if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){c=2;for(let u in l)if(l[u]!=null){let d=u.indexOf(" ");d>0?a.setAttributeNS(u.slice(0,d),u.slice(d+1),l[u]):a.setAttribute(u,l[u])}}for(let u=c;u<t.length;u++){let d=t[u];if(d===0){if(u<t.length-1||u>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:f,contentDOM:h}=Fr.renderSpec(e,d,r);if(a.appendChild(f),h){if(o)throw new RangeError("Multiple content holes");o=h}}}return{dom:a,contentDOM:o}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Fr(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=C1(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return C1(e.marks)}}function C1(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function Nf(n){return n.document||window.document}const Q_=65535,ek=Math.pow(2,16);function vz(n,e){return n+e*ek}function S1(n){return n&Q_}function yz(n){return(n-(n&Q_))/ek}const tk=1,nk=2,jc=4,rk=8;class sp{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&rk)>0}get deletedBefore(){return(this.delInfo&(tk|jc))>0}get deletedAfter(){return(this.delInfo&(nk|jc))>0}get deletedAcross(){return(this.delInfo&jc)>0}}class bn{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&bn.empty)return bn.empty}recover(e){let t=0,r=S1(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+yz(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>e)break;let c=this.ranges[a+s],u=this.ranges[a+o],d=l+c;if(e<=d){let f=c?e==l?-1:e==d?1:t:t,h=l+i+(f<0?0:u);if(r)return h;let p=e==(t<0?l:d)?null:vz(a/3,e-l),m=e==l?nk:e==d?tk:jc;return(t<0?e!=l:e!=d)&&(m|=rk),new sp(h,m,p)}i+=u-c}return r?e+i:new sp(e+i,0,null)}touches(e,t){let r=0,i=S1(t),s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+s],u=l+c;if(e<=u&&a==i*3)return!0;r+=this.ranges[a+o]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],a=o-(this.inverted?s:0),l=o+(this.inverted?0:s),c=this.ranges[i+t],u=this.ranges[i+r];e(a,a+c,l,l+u),s+=u-c}}invert(){return new bn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?bn.empty:new bn(e<0?[0,-e,0]:[0,0,e])}}bn.empty=new bn([]);class yo{constructor(e=[],t,r=0,i=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=i}slice(e=0,t=this.maps.length){return new yo(this.maps,this.mirror,e,t)}copy(){return new yo(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let i=e.getMirror(t);this.appendMap(e.maps[t],i!=null&&i<t?r+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e.maps[t].invert(),i!=null&&i>t?r-i-1:void 0)}}invert(){let e=new yo;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let i=0;for(let s=this.from;s<this.to;s++){let o=this.maps[s],a=o.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(s);if(l!=null&&l>s&&l<this.to){s=l,e=this.maps[l].recover(a.recover);continue}}i|=a.delInfo,e=a.pos}return r?e:new sp(e,i,null)}}const Rf=Object.create(null);class Kt{getMap(){return bn.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Rf[t.stepType];if(!r)throw new RangeError("No step type ".concat(t.stepType," defined"));return r.fromJSON(e,t)}static jsonID(e,t){if(e in Rf)throw new RangeError("Duplicate use of step JSON ID "+e);return Rf[e]=t,t.prototype.jsonID=e,t}}class St{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new St(e,null)}static fail(e){return new St(null,e)}static fromReplace(e,t,r,i){try{return St.ok(e.replace(t,r,i))}catch(s){if(s instanceof Gu)return St.fail(s.message);throw s}}}function xm(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let s=n.child(i);s.content.size&&(s=s.copy(xm(s.content,e,s))),s.isInline&&(s=e(s,t,i)),r.push(s)}return q.fromArray(r)}class Vr extends Kt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new J(xm(t.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),t.openStart,t.openEnd);return St.fromReplace(e,this.from,this.to,s)}invert(){return new pr(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Vr(t.pos,r.pos,this.mark)}merge(e){return e instanceof Vr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Vr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Vr(t.from,t.to,e.markFromJSON(t.mark))}}Kt.jsonID("addMark",Vr);class pr extends Kt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new J(xm(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return St.fromReplace(e,this.from,this.to,r)}invert(){return new Vr(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new pr(t.pos,r.pos,this.mark)}merge(e){return e instanceof pr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new pr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new pr(t.from,t.to,e.markFromJSON(t.mark))}}Kt.jsonID("removeMark",pr);class bi extends Kt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return St.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return St.fromReplace(e,this.pos,this.pos+1,new J(q.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new bi(this.pos,t.marks[i]);return new bi(this.pos,this.mark)}}return new Ao(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new bi(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new bi(t.pos,e.markFromJSON(t.mark))}}Kt.jsonID("addNodeMark",bi);class Ao extends Kt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return St.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return St.fromReplace(e,this.pos,this.pos+1,new J(q.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new bi(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ao(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Ao(t.pos,e.markFromJSON(t.mark))}}Kt.jsonID("removeNodeMark",Ao);class Lt extends Kt{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&op(e,this.from,this.to)?St.fail("Structure replace would overwrite content"):St.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new bn([this.from,this.to-this.from,this.slice.size])}invert(e){return new Lt(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new Lt(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof Lt)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?J.empty:new J(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Lt(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?J.empty:new J(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Lt(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Lt(t.from,t.to,J.fromJSON(e,t.slice),!!t.structure)}}Kt.jsonID("replace",Lt);class qt extends Kt{constructor(e,t,r,i,s,o,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=o,this.structure=a}apply(e){if(this.structure&&(op(e,this.from,this.gapFrom)||op(e,this.gapTo,this.to)))return St.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return St.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?St.fromReplace(e,this.from,this.to,r):St.fail("Content does not fit in gap")}getMap(){return new bn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new qt(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),s=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||s>r.pos?null:new qt(t.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new qt(t.from,t.to,t.gapFrom,t.gapTo,J.fromJSON(e,t.slice),t.insert,!!t.structure)}}Kt.jsonID("replaceAround",qt);function op(n,e,t){let r=n.resolve(e),i=t-e,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let o=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function bz(n,e,t,r){let i=[],s=[],o,a;n.doc.nodesBetween(e,t,(l,c,u)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let f=Math.max(c,e),h=Math.min(c+l.nodeSize,t),p=r.addToSet(d);for(let m=0;m<d.length;m++)d[m].isInSet(p)||(o&&o.to==f&&o.mark.eq(d[m])?o.to=h:i.push(o=new pr(f,h,d[m])));a&&a.to==f?a.to=h:s.push(a=new Vr(f,h,r))}}),i.forEach(l=>n.step(l)),s.forEach(l=>n.step(l))}function wz(n,e,t,r){let i=[],s=0;n.doc.nodesBetween(e,t,(o,a)=>{if(!o.isInline)return;s++;let l=null;if(r instanceof Ed){let c=o.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(o.marks)&&(l=[r]):l=o.marks;if(l&&l.length){let c=Math.min(a+o.nodeSize,t);for(let u=0;u<l.length;u++){let d=l[u],f;for(let h=0;h<i.length;h++){let p=i[h];p.step==s-1&&d.eq(i[h].style)&&(f=p)}f?(f.to=c,f.step=s):i.push({style:d,from:Math.max(a,e),to:c,step:s})}}}),i.forEach(o=>n.step(new pr(o.from,o.to,o.style)))}function _z(n,e,t,r=t.contentMatch){let i=n.doc.nodeAt(e),s=[],o=e+1;for(let a=0;a<i.childCount;a++){let l=i.child(a),c=o+l.nodeSize,u=r.matchType(l.type);if(!u)s.push(new Lt(o,c,J.empty));else{r=u;for(let d=0;d<l.marks.length;d++)t.allowsMarkType(l.marks[d].type)||n.step(new pr(o,c,l.marks[d]));if(l.isText&&!t.spec.code){let d,f=/\r?\n|\r/g,h;for(;d=f.exec(l.text);)h||(h=new J(q.from(t.schema.text(" ",t.allowedMarks(l.marks))),0,0)),s.push(new Lt(o+d.index,o+d.index+d[0].length,h))}}o=c}if(!r.validEnd){let a=r.fillBefore(q.empty,!0);n.replace(o,o,new J(a,0,0))}for(let a=s.length-1;a>=0;a--)n.step(s[a])}function kz(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function Ad(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let i=n.$from.node(r),s=n.$from.index(r),o=n.$to.indexAfter(r);if(r<n.depth&&i.canReplace(s,o,t))return r;if(r==0||i.type.spec.isolating||!kz(i,s,o))break}return null}function xz(n,e,t){let{$from:r,$to:i,depth:s}=e,o=r.before(s+1),a=i.after(s+1),l=o,c=a,u=q.empty,d=0;for(let p=s,m=!1;p>t;p--)m||r.index(p)>0?(m=!0,u=q.from(r.node(p).copy(u)),d++):l--;let f=q.empty,h=0;for(let p=s,m=!1;p>t;p--)m||i.after(p+1)<i.end(p)?(m=!0,f=q.from(i.node(p).copy(f)),h++):c++;n.step(new qt(l,c,o,a,new J(u.append(f),d,h),u.size-d,!0))}function ik(n,e,t=null,r=n){let i=Cz(n,e),s=i&&Sz(r,e);return s?i.map(M1).concat({type:e,attrs:t}).concat(s.map(M1)):null}function M1(n){return{type:n,attrs:null}}function Cz(n,e){let{parent:t,startIndex:r,endIndex:i}=n,s=t.contentMatchAt(r).findWrapping(e);if(!s)return null;let o=s.length?s[0]:e;return t.canReplaceWith(r,i,o)?s:null}function Sz(n,e){let{parent:t,startIndex:r,endIndex:i}=n,s=t.child(r),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let l=(o.length?o[o.length-1]:e).contentMatch;for(let c=r;l&&c<i;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:o}function Mz(n,e,t){let r=q.empty;for(let o=t.length-1;o>=0;o--){if(r.size){let a=t[o].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=q.from(t[o].type.create(t[o].attrs,r))}let i=e.start,s=e.end;n.step(new qt(i,s,i,s,new J(r,0,0),t.length,!0))}function Tz(n,e,t,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=n.steps.length;n.doc.nodesBetween(e,t,(o,a)=>{if(o.isTextblock&&!o.hasMarkup(r,i)&&Oz(n.doc,n.mapping.slice(s).map(a),r)){n.clearIncompatible(n.mapping.slice(s).map(a,1),r);let l=n.mapping.slice(s),c=l.map(a,1),u=l.map(a+o.nodeSize,1);return n.step(new qt(c,u,c+1,u-1,new J(q.from(r.create(i,null,o.marks)),0,0),1,!0)),!1}})}function Oz(n,e,t){let r=n.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,t)}function $z(n,e,t,r,i){let s=n.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");t||(t=s.type);let o=t.create(r,null,i||s.marks);if(s.isLeaf)return n.replaceWith(e,e+s.nodeSize,o);if(!t.validContent(s.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new qt(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new J(q.from(o),0,0),1,!0))}function Ya(n,e,t=1,r){let i=n.resolve(e),s=i.depth-t,o=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=t-2;c>s;c--,u--){let d=i.node(c),f=i.index(c);if(d.type.spec.isolating)return!1;let h=d.content.cutByIndex(f,d.childCount),p=r&&r[u+1];p&&(h=h.replaceChild(0,p.type.create(p.attrs)));let m=r&&r[u]||d;if(!d.canReplace(f+1,d.childCount)||!m.type.validContent(h))return!1}let a=i.indexAfter(s),l=r&&r[0];return i.node(s).canReplaceWith(a,a,l?l.type:i.node(s+1).type)}function Dz(n,e,t=1,r){let i=n.doc.resolve(e),s=q.empty,o=q.empty;for(let a=i.depth,l=i.depth-t,c=t-1;a>l;a--,c--){s=q.from(i.node(a).copy(s));let u=r&&r[c];o=q.from(u?u.type.create(u.attrs,o):i.node(a).copy(o))}n.step(new Lt(e,e,new J(s.append(o),t,t),!0))}function Pd(n,e){let t=n.resolve(e),r=t.index();return Ez(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function Ez(n,e){return!!(n&&e&&!n.isLeaf&&n.canAppend(e))}function Az(n,e,t){let r=new Lt(e-t,e+t,J.empty,!0);n.step(r)}function Pz(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let s=r.index(i);if(r.node(i).canReplaceWith(s,s,t))return r.before(i+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let s=r.indexAfter(i);if(r.node(i).canReplaceWith(s,s,t))return r.after(i+1);if(s<r.node(i).childCount)return null}return null}function Nz(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let i=t.content;for(let s=0;s<t.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(t.openStart==0&&t.size?2:1);s++)for(let o=r.depth;o>=0;o--){let a=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,l=r.index(o)+(a>0?1:0),c=r.node(o),u=!1;if(s==1)u=c.canReplace(l,l,i);else{let d=c.contentMatchAt(l).findWrapping(i.firstChild.type);u=d&&c.canReplaceWith(l,l,d[0])}if(u)return a==0?r.pos:a<0?r.before(o+1):r.after(o+1)}return null}function Cm(n,e,t=e,r=J.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),s=n.resolve(t);return sk(i,s,r)?new Lt(e,t,r):new Rz(i,s,r).fit()}function sk(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class Rz{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=q.empty;for(let i=0;i<=e.depth;i++){let s=e.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=q.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let s=this.placed,o=r.depth,a=i.depth;for(;o&&a&&s.childCount==1;)s=s.firstChild.content,o--,a--;let l=new J(s,o,a);return e>-1?new qt(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new Lt(r.pos,i.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let s=t.firstChild;if(t.childCount>1&&(i=0),s.type.spec.isolating&&i<=r){e=r;break}t=s.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,s=null;r?(s=Lf(this.unplaced.content,r-1).firstChild,i=s.content):i=this.unplaced.content;let o=i.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,d=null;if(t==1&&(o?c.matchType(o.type)||(d=c.fillBefore(q.from(o),!1)):s&&l.compatibleContent(s.type)))return{sliceDepth:r,frontierDepth:a,parent:s,inject:d};if(t==2&&o&&(u=c.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:a,parent:s,wrap:u};if(s&&c.matchType(s.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Lf(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new J(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Lf(e,t);if(i.childCount<=1&&t>0){let s=e.size-t<=t+i.size;this.unplaced=new J(ma(e,t-1,1),t-1,s?t-1:r)}else this.unplaced=new J(ma(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:s}){for(;this.depth>t;)this.closeFrontierNode();if(s)for(let m=0;m<s.length;m++)this.openFrontierNode(s[m]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-e,c=0,u=[],{match:d,type:f}=this.frontier[t];if(i){for(let m=0;m<i.childCount;m++)u.push(i.child(m));d=d.matchFragment(i)}let h=a.size+e-(o.content.size-o.openEnd);for(;c<a.childCount;){let m=a.child(c),g=d.matchType(m.type);if(!g)break;c++,(c>1||l==0||m.content.size)&&(d=g,u.push(ok(m.mark(f.allowedMarks(m.marks)),c==1?l:0,c==a.childCount?h:-1)))}let p=c==a.childCount;p||(h=-1),this.placed=ga(this.placed,t,q.from(u)),this.frontier[t].match=d,p&&h<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,g=a;m<h;m++){let w=g.lastChild;this.frontier.push({type:w.type,match:w.contentMatchAt(w.childCount)}),g=w.content}this.unplaced=p?e==0?J.empty:new J(ma(o.content,e-1,1),e-1,h<0?o.openEnd:e-1):new J(ma(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!If(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],s=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=If(e,t,i,r,s);if(o){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=If(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:o,move:s?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=ga(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),s=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,s)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=ga(this.placed,this.depth,q.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(q.empty,!0);t.childCount&&(this.placed=ga(this.placed,this.frontier.length,t))}}function ma(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(ma(n.firstChild.content,e-1,t)))}function ga(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(ga(n.lastChild.content,e-1,t)))}function Lf(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function ok(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,ok(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(q.empty,!0)))),n.copy(r)}function If(n,e,t,r,i){let s=n.node(e),o=i?n.indexAfter(e):n.index(e);if(o==s.childCount&&!t.compatibleContent(s.type))return null;let a=r.fillBefore(s.content,!0,o);return a&&!Lz(t,s.content,o)?a:null}function Lz(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function Iz(n){return n.spec.defining||n.spec.definingForContent}function zz(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let i=n.doc.resolve(e),s=n.doc.resolve(t);if(sk(i,s,r))return n.step(new Lt(e,t,r));let o=lk(i,n.doc.resolve(t));o[o.length-1]==0&&o.pop();let a=-(i.depth+1);o.unshift(a);for(let f=i.depth,h=i.pos-1;f>0;f--,h--){let p=i.node(f).type.spec;if(p.defining||p.definingAsContext||p.isolating)break;o.indexOf(f)>-1?a=f:i.before(f)==h&&o.splice(1,0,-f)}let l=o.indexOf(a),c=[],u=r.openStart;for(let f=r.content,h=0;;h++){let p=f.firstChild;if(c.push(p),h==r.openStart)break;f=p.content}for(let f=u-1;f>=0;f--){let h=c[f],p=Iz(h.type);if(p&&!h.sameMarkup(i.node(Math.abs(a)-1)))u=f;else if(p||!h.type.isTextblock)break}for(let f=r.openStart;f>=0;f--){let h=(f+u+1)%(r.openStart+1),p=c[h];if(p)for(let m=0;m<o.length;m++){let g=o[(m+l)%o.length],w=!0;g<0&&(w=!1,g=-g);let x=i.node(g-1),M=i.index(g-1);if(x.canReplaceWith(M,M,p.type,p.marks))return n.replace(i.before(g),w?s.after(g):t,new J(ak(r.content,0,r.openStart,h),h,r.openEnd))}}let d=n.steps.length;for(let f=o.length-1;f>=0&&(n.replace(e,t,r),!(n.steps.length>d));f--){let h=o[f];h<0||(e=i.before(h),t=s.after(h))}}function ak(n,e,t,r,i){if(e<t){let s=n.firstChild;n=n.replaceChild(0,s.copy(ak(s.content,e+1,t,r,s)))}if(e>r){let s=i.contentMatchAt(0),o=s.fillBefore(n).append(n);n=o.append(s.matchFragment(o).fillBefore(q.empty,!0))}return n}function Bz(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let i=Pz(n.doc,e,r.type);i!=null&&(e=t=i)}n.replaceRange(e,t,new J(q.from(r),0,0))}function Fz(n,e,t){let r=n.doc.resolve(e),i=n.doc.resolve(t),s=lk(r,i);for(let o=0;o<s.length;o++){let a=s[o],l=o==s.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),i.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),i.indexAfter(a-1))))return n.delete(r.before(a),i.after(a))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(e-r.start(o)==r.depth-o&&t>r.end(o)&&i.end(o)-t!=i.depth-o)return n.delete(r.before(o),t);n.delete(e,t)}function lk(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let i=r;i>=0;i--){let s=n.start(i);if(s<n.pos-(n.depth-i)||e.end(i)>e.pos+(e.depth-i)||n.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(s==e.start(i)||i==n.depth&&i==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==s-1)&&t.push(i)}return t}class bo extends Kt{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return St.fail("No node at attribute step's position");let r=Object.create(null);for(let s in t.attrs)r[s]=t.attrs[s];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return St.fromReplace(e,this.pos,this.pos+1,new J(q.from(i),0,t.isLeaf?0:1))}getMap(){return bn.empty}invert(e){return new bo(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new bo(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new bo(t.pos,t.attr,t.value)}}Kt.jsonID("attr",bo);class ml extends Kt{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return St.ok(r)}getMap(){return bn.empty}invert(e){return new ml(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new ml(t.attr,t.value)}}Kt.jsonID("docAttr",ml);let Po=class extends Error{};Po=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Po.prototype=Object.create(Error.prototype);Po.prototype.constructor=Po;Po.prototype.name="TransformError";class ck{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new yo}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Po(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=J.empty){let i=Cm(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new J(q.from(r),0,0))}delete(e,t){return this.replace(e,t,J.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return zz(this,e,t,r),this}replaceRangeWith(e,t,r){return Bz(this,e,t,r),this}deleteRange(e,t){return Fz(this,e,t),this}lift(e,t){return xz(this,e,t),this}join(e,t=1){return Az(this,e,t),this}wrap(e,t){return Mz(this,e,t),this}setBlockType(e,t=e,r,i=null){return Tz(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i){return $z(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new bo(e,t,r)),this}setDocAttribute(e,t){return this.step(new ml(e,t)),this}addNodeMark(e,t){return this.step(new bi(e,t)),this}removeNodeMark(e,t){if(!(t instanceof Pe)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t=t.isInSet(r.marks),!t)return this}return this.step(new Ao(e,t)),this}split(e,t=1,r){return Dz(this,e,t,r),this}addMark(e,t,r){return bz(this,e,t,r),this}removeMark(e,t,r){return wz(this,e,t,r),this}clearIncompatible(e,t,r){return _z(this,e,t,r),this}}const zf=Object.create(null);class we{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new uk(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=J.empty){let r=t.content.lastChild,i=null;for(let a=0;a<t.openEnd;a++)i=r,r=r.lastChild;let s=e.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:c}=o[a],u=e.mapping.slice(s);e.replaceRange(u.map(l.pos),u.map(c.pos),a?J.empty:t),a==0&&$1(e,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:a}=i[s],l=e.mapping.slice(r),c=l.map(o.pos),u=l.map(a.pos);s?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),$1(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let i=e.parent.inlineContent?new Me(e):to(e.node(0),e.parent,e.pos,e.index(),t,r);if(i)return i;for(let s=e.depth-1;s>=0;s--){let o=t<0?to(e.node(0),e.node(s),e.before(s+1),e.index(s),t,r):to(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,t,r);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new kn(e.node(0))}static atStart(e){return to(e,e,0,0,1)||new kn(e)}static atEnd(e){return to(e,e,e.content.size,e.childCount,-1)||new kn(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=zf[t.type];if(!r)throw new RangeError("No selection type ".concat(t.type," defined"));return r.fromJSON(e,t)}static jsonID(e,t){if(e in zf)throw new RangeError("Duplicate use of selection JSON ID "+e);return zf[e]=t,t.prototype.jsonID=e,t}getBookmark(){return Me.between(this.$anchor,this.$head).getBookmark()}}we.prototype.visible=!0;class uk{constructor(e,t){this.$from=e,this.$to=t}}let T1=!1;function O1(n){!T1&&!n.parent.inlineContent&&(T1=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class Me extends we{constructor(e,t=e){O1(e),O1(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return we.near(r);let i=e.resolve(t.map(this.anchor));return new Me(i.parent.inlineContent?i:r,r)}replace(e,t=J.empty){if(super.replace(e,t),t==J.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof Me&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Nd(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Me(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let i=e.resolve(t);return new this(i,r==t?i:e.resolve(r))}static between(e,t,r){let i=e.pos-t.pos;if((!r||i)&&(r=i>=0?1:-1),!t.parent.inlineContent){let s=we.findFrom(t,r,!0)||we.findFrom(t,-r,!0);if(s)t=s.$head;else return we.near(t,r)}return e.parent.inlineContent||(i==0?e=t:(e=(we.findFrom(e,-r,!0)||we.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new Me(e,t)}}we.jsonID("text",Me);class Nd{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Nd(e.map(this.anchor),e.map(this.head))}resolve(e){return Me.between(e.resolve(this.anchor),e.resolve(this.head))}}class ye extends we{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:i}=t.mapResult(this.anchor),s=e.resolve(i);return r?we.near(s):new ye(s)}content(){return new J(q.from(this.node),0,0)}eq(e){return e instanceof ye&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Sm(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new ye(e.resolve(t.anchor))}static create(e,t){return new ye(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}ye.prototype.visible=!1;we.jsonID("node",ye);class Sm{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new Nd(r,r):new Sm(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&ye.isSelectable(r)?new ye(t):we.near(t)}}class kn extends we{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=J.empty){if(t==J.empty){e.delete(0,e.doc.content.size);let r=we.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new kn(e)}map(e){return new kn(e)}eq(e){return e instanceof kn}getBookmark(){return Vz}}we.jsonID("all",kn);const Vz={map(){return this},resolve(n){return new kn(n)}};function to(n,e,t,r,i,s=!1){if(e.inlineContent)return Me.create(n,t);for(let o=r-(i>0?0:1);i>0?o<e.childCount:o>=0;o+=i){let a=e.child(o);if(a.isAtom){if(!s&&ye.isSelectable(a))return ye.create(n,t-(i<0?a.nodeSize:0))}else{let l=to(n,a,t+i,i<0?a.childCount:0,i,s);if(l)return l}t+=a.nodeSize*i}return null}function $1(n,e,t){let r=n.steps.length-1;if(r<e)return;let i=n.steps[r];if(!(i instanceof Lt||i instanceof qt))return;let s=n.mapping.maps[r],o;s.forEach((a,l,c,u)=>{o==null&&(o=u)}),n.setSelection(we.near(n.doc.resolve(o),t))}const D1=1,xc=2,E1=4;class Hz extends ck{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|D1)&~xc,this.storedMarks=null,this}get selectionSet(){return(this.updated&D1)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=xc,this}ensureMarks(e){return Pe.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&xc)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~xc,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Pe.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let i=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r==null?t:r,!e)return this.deleteRange(t,r);let s=this.storedMarks;if(!s){let o=this.doc.resolve(t);s=r==t?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,i.text(e,s)),this.selection.empty||this.setSelection(we.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=E1,this}get scrolledIntoView(){return(this.updated&E1)>0}}function A1(n,e){return!e||!n?n:n.bind(e)}class va{constructor(e,t,r){this.name=e,this.init=A1(t.init,r),this.apply=A1(t.apply,r)}}const Wz=[new va("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new va("selection",{init(n,e){return n.selection||we.atStart(e.doc)},apply(n){return n.selection}}),new va("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new va("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class Bf{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Wz.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new va(r.key,r.spec.state,r))})}}class po{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),i=null;for(;;){let s=!1;for(let o=0;o<this.config.plugins.length;o++){let a=this.config.plugins[o];if(a.spec.appendTransaction){let l=i?i[o].n:0,c=i?i[o].state:this,u=l<t.length&&a.spec.appendTransaction.call(a,l?t.slice(l):t,c,r);if(u&&r.filterTransaction(u,o)){if(u.setMeta("appendedTransaction",e),!i){i=[];for(let d=0;d<this.config.plugins.length;d++)i.push(d<o?{state:r,n:t.length}:{state:this,n:0})}t.push(u),r=r.applyInner(u),s=!0}i&&(i[o]={state:r,n:t.length})}}if(!s)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new po(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let s=r[i];t[s.name]=s.apply(e,this[s.name],this,t)}return t}get tr(){return new Hz(this)}static create(e){let t=new Bf(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new po(t);for(let i=0;i<t.fields.length;i++)r[t.fields[i].name]=t.fields[i].init(e,r);return r}reconfigure(e){let t=new Bf(this.schema,e.plugins),r=t.fields,i=new po(t);for(let s=0;s<r.length;s++){let o=r[s].name;i[o]=this.hasOwnProperty(o)?this[o]:r[s].init(e,i)}return i}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],s=i.spec.state;s&&s.toJSON&&(t[r]=s.toJSON.call(i,this[i.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new Bf(e.schema,e.plugins),s=new po(i);return i.fields.forEach(o=>{if(o.name=="doc")s.doc=xi.fromJSON(e.schema,t.doc);else if(o.name=="selection")s.selection=we.fromJSON(s.doc,t.selection);else if(o.name=="storedMarks")t.storedMarks&&(s.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,a)){s[o.name]=c.fromJSON.call(l,e,t[a],s);return}}s[o.name]=o.init(e,s)}}),s}}function dk(n,e,t){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=dk(i,e,{})),t[r]=i}return t}class Gt{constructor(e){this.spec=e,this.props={},e.props&&dk(e.props,this,this.props),this.key=e.key?e.key.key:fk("plugin")}getState(e){return e[this.key]}}const Ff=Object.create(null);function fk(n){return n in Ff?n+"$"+ ++Ff[n]:(Ff[n]=0,n+"$")}class Bt{constructor(e="key"){this.key=fk(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Zt=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},gl=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let P1=null;const Rr=function(n,e,t){let r=P1||(P1=document.createRange());return r.setEnd(n,t==null?n.nodeValue.length:t),r.setStart(n,e||0),r},zs=function(n,e,t,r){return t&&(N1(n,e,t,r,-1)||N1(n,e,t,r,1))},jz=/^(img|br|input|textarea|hr)$/i;function N1(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:fr(n))){let s=n.parentNode;if(!s||s.nodeType!=1||Mm(n)||jz.test(n.nodeName)||n.contentEditable=="false")return!1;e=Zt(n)+(i<0?0:1),n=s}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.contentEditable=="false")return!1;e=i<0?fr(n):0}else return!1}}function fr(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Uz(n,e,t){for(let r=e==0,i=e==fr(n);r||i;){if(n==t)return!0;let s=Zt(n);if(n=n.parentNode,!n)return!1;r=r&&s==0,i=i&&s==fr(n)}}function Mm(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const Rd=function(n){return n.focusNode&&zs(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function us(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function qz(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Yz(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:r.offset}}catch(r){}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:r.startOffset}}}const br=typeof navigator<"u"?navigator:null,R1=typeof document<"u"?document:null,zi=br&&br.userAgent||"",ap=/Edge\/(\d+)/.exec(zi),hk=/MSIE \d/.exec(zi),lp=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(zi),on=!!(hk||lp||ap),Ci=hk?document.documentMode:lp?+lp[1]:ap?+ap[1]:0,Jn=!on&&/gecko\/(\d+)/i.test(zi);Jn&&+(/Firefox\/(\d+)/.exec(zi)||[0,0])[1];const cp=!on&&/Chrome\/(\d+)/.exec(zi),Wt=!!cp,Kz=cp?+cp[1]:0,Qt=!on&&!!br&&/Apple Computer/.test(br.vendor),No=Qt&&(/Mobile\/\w+/.test(zi)||!!br&&br.maxTouchPoints>2),$n=No||(br?/Mac/.test(br.platform):!1),Gz=br?/Win/.test(br.platform):!1,Un=/Android \d/.test(zi),Nl=!!R1&&"webkitFontSmoothing"in R1.documentElement.style,Xz=Nl?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Jz(n){return{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function Or(n,e){return typeof n=="number"?n:n[e]}function Zz(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function L1(n,e,t){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,s=n.dom.ownerDocument;for(let o=t||n.dom;o;o=gl(o)){if(o.nodeType!=1)continue;let a=o,l=a==s.body,c=l?Jz(s):Zz(a),u=0,d=0;if(e.top<c.top+Or(r,"top")?d=-(c.top-e.top+Or(i,"top")):e.bottom>c.bottom-Or(r,"bottom")&&(d=e.bottom-e.top>c.bottom-c.top?e.top+Or(i,"top")-c.top:e.bottom-c.bottom+Or(i,"bottom")),e.left<c.left+Or(r,"left")?u=-(c.left-e.left+Or(i,"left")):e.right>c.right-Or(r,"right")&&(u=e.right-c.right+Or(i,"right")),u||d)if(l)s.defaultView.scrollBy(u,d);else{let f=a.scrollLeft,h=a.scrollTop;d&&(a.scrollTop+=d),u&&(a.scrollLeft+=u);let p=a.scrollLeft-f,m=a.scrollTop-h;e={left:e.left-p,top:e.top-m,right:e.right-p,bottom:e.bottom-m}}if(l||/^(fixed|sticky)$/.test(getComputedStyle(o).position))break}}function Qz(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,i;for(let s=(e.left+e.right)/2,o=t+1;o<Math.min(innerHeight,e.bottom);o+=5){let a=n.root.elementFromPoint(s,o);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=t-20){r=a,i=l.top;break}}return{refDOM:r,refTop:i,stack:pk(n.dom)}}function pk(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=gl(r));return e}function eB({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;mk(t,r==0?0:r-e)}function mk(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:i,left:s}=n[t];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=s&&(r.scrollLeft=s)}}let Js=null;function tB(n){if(n.setActive)return n.setActive();if(Js)return n.focus(Js);let e=pk(n);n.focus(Js==null?{get preventScroll(){return Js={preventScroll:!0},!0}}:void 0),Js||(Js=!1,mk(e,0))}function gk(n,e){let t,r=2e8,i,s=0,o=e.top,a=e.top,l,c;for(let u=n.firstChild,d=0;u;u=u.nextSibling,d++){let f;if(u.nodeType==1)f=u.getClientRects();else if(u.nodeType==3)f=Rr(u).getClientRects();else continue;for(let h=0;h<f.length;h++){let p=f[h];if(p.top<=o&&p.bottom>=a){o=Math.max(p.bottom,o),a=Math.min(p.top,a);let m=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(m<r){t=u,r=m,i=m&&t.nodeType==3?{left:p.right<e.left?p.right:p.left,top:e.top}:e,u.nodeType==1&&m&&(s=d+(e.left>=(p.left+p.right)/2?1:0));continue}}else p.top>e.top&&!l&&p.left<=e.left&&p.right>=e.left&&(l=u,c={left:Math.max(p.left,Math.min(p.right,e.left)),top:p.top});!t&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(s=d+1)}}return!t&&l&&(t=l,i=c,r=0),t&&t.nodeType==3?nB(t,i):!t||r&&t.nodeType==1?{node:n,offset:s}:gk(t,i)}function nB(n,e){let t=n.nodeValue.length,r=document.createRange();for(let i=0;i<t;i++){r.setEnd(n,i+1),r.setStart(n,i);let s=ti(r,1);if(s.top!=s.bottom&&Tm(e,s))return{node:n,offset:i+(e.left>=(s.left+s.right)/2?1:0)}}return{node:n,offset:0}}function Tm(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function rB(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function iB(n,e,t){let{node:r,offset:i}=gk(e,t),s=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();s=o.left!=o.right&&t.left>(o.left+o.right)/2?1:-1}return n.docView.posFromDOM(r,i,s)}function sB(n,e,t,r){let i=-1;for(let s=e,o=!1;s!=n.dom;){let a=n.docView.nearestDesc(s,!0);if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent&&!o||!a.contentDOM)){let l=a.dom.getBoundingClientRect();if(a.node.isBlock&&a.parent&&!o&&(o=!0,l.left>r.left||l.top>r.top?i=a.posBefore:(l.right<r.left||l.bottom<r.top)&&(i=a.posAfter)),!a.contentDOM&&i<0&&!a.node.isText)return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter}s=a.dom.parentNode}return i>-1?i:n.docView.posFromDOM(e,t,-1)}function vk(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),s=i;;){let o=n.childNodes[s];if(o.nodeType==1){let a=o.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(Tm(e,c))return vk(o,e,c)}}if((s=(s+1)%r)==i)break}return n}function oB(n,e){let t=n.dom.ownerDocument,r,i=0,s=Yz(t,e.left,e.top);s&&({node:r,offset:i}=s);let o=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),a;if(!o||!n.dom.contains(o.nodeType!=1?o.parentNode:o)){let c=n.dom.getBoundingClientRect();if(!Tm(e,c)||(o=vk(n.dom,e,c),!o))return null}if(Qt)for(let c=o;r&&c;c=gl(c))c.draggable&&(r=void 0);if(o=rB(o,e),r){if(Jn&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let u=r.childNodes[i],d;u.nodeName=="IMG"&&(d=u.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&i++}let c;Nl&&i&&r.nodeType==1&&(c=r.childNodes[i-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&i--,r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(a=sB(n,r,i,e))}a==null&&(a=iB(n,o,e));let l=n.docView.nearestDesc(o,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function I1(n){return n.top<n.bottom||n.left<n.right}function ti(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(I1(r))return r}return Array.prototype.find.call(t,I1)||n.getBoundingClientRect()}const aB=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function yk(n,e,t){let{node:r,offset:i,atom:s}=n.docView.domFromPos(e,t<0?-1:1),o=Nl||Jn;if(r.nodeType==3)if(o&&(aB.test(r.nodeValue)||(t<0?!i:i==r.nodeValue.length))){let l=ti(Rr(r,i,i),t);if(Jn&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let c=ti(Rr(r,i-1,i-1),-1);if(c.top==l.top){let u=ti(Rr(r,i,i+1),-1);if(u.top!=l.top)return aa(u,u.left<c.left)}}return l}else{let l=i,c=i,u=t<0?1:-1;return t<0&&!i?(c++,u=-1):t>=0&&i==r.nodeValue.length?(l--,u=1):t<0?l--:c++,aa(ti(Rr(r,l,c),u),u<0)}if(!n.state.doc.resolve(e-(s||0)).parent.inlineContent){if(s==null&&i&&(t<0||i==fr(r))){let l=r.childNodes[i-1];if(l.nodeType==1)return Vf(l.getBoundingClientRect(),!1)}if(s==null&&i<fr(r)){let l=r.childNodes[i];if(l.nodeType==1)return Vf(l.getBoundingClientRect(),!0)}return Vf(r.getBoundingClientRect(),t>=0)}if(s==null&&i&&(t<0||i==fr(r))){let l=r.childNodes[i-1],c=l.nodeType==3?Rr(l,fr(l)-(o?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return aa(ti(c,1),!1)}if(s==null&&i<fr(r)){let l=r.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?Rr(l,0,o?0:1):l.nodeType==1?l:null:null;if(c)return aa(ti(c,-1),!0)}return aa(ti(r.nodeType==3?Rr(r):r,-t),t>=0)}function aa(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function Vf(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function bk(n,e,t){let r=n.state,i=n.root.activeElement;r!=e&&n.updateState(e),i!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function lB(n,e,t){let r=e.selection,i=t=="up"?r.$from:r.$to;return bk(n,e,()=>{let{node:s}=n.docView.domFromPos(i.pos,t=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(s,!0);if(!a)break;if(a.node.isBlock){s=a.contentDOM||a.dom;break}s=a.dom.parentNode}let o=yk(n,i.pos,1);for(let a=s.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=Rr(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(t=="up"?o.top-u.top>(u.bottom-o.top)*2:u.bottom-o.bottom>(o.bottom-u.top)*2))return!1}}return!0})}const cB=/[\u0590-\u08ac]/;function uB(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,s=!i,o=i==r.parent.content.size,a=n.domSelection();return!cB.test(r.parent.textContent)||!a.modify?t=="left"||t=="backward"?s:o:bk(n,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:d}=n.domSelectionRange(),f=a.caretBidiLevel;a.modify("move",t,"character");let h=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:p,focusOffset:m}=n.domSelectionRange(),g=p&&!h.contains(p.nodeType==1?p:p.parentNode)||l==p&&c==m;try{a.collapse(u,d),l&&(l!=u||c!=d)&&a.extend&&a.extend(l,c)}catch(w){}return f!=null&&(a.caretBidiLevel=f),g})}let z1=null,B1=null,F1=!1;function dB(n,e,t){return z1==e&&B1==t?F1:(z1=e,B1=t,F1=t=="up"||t=="down"?lB(n,e,t):uB(n,e,t))}const An=0,V1=1,gs=2,wr=3;class Rl{constructor(e,t,r,i){this.parent=e,this.children=t,this.dom=r,this.contentDOM=i,this.dirty=An,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let i=this.children[t];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let s,o;if(e==this.contentDOM)s=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.previousSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(o)+o.size:this.posAtStart}else{let s,o;if(e==this.contentDOM)s=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(o):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=t>Zt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!1;break}if(s.previousSibling)break}if(i==null&&t==e.childNodes.length)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!0;break}if(s.nextSibling)break}}return(i==null?r>0:i)?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,i=e;i;i=i.parentNode){let s=this.getDesc(i),o;if(s&&(!t||s.node))if(r&&(o=s.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return s}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let i=e;i;i=i.parentNode){let s=this.getDesc(i);if(s)return s.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let i=this.children[t],s=r+i.size;if(r==e&&s!=r){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(e<s)return i.descAt(e-r-i.border);r=s}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let s=0;r<this.children.length;r++){let o=this.children[r],a=s+o.size;if(a>e||o instanceof _k){i=e-s;break}s=a}if(i)return this.children[r].domFromPos(i-this.children[r].border,t);for(let s;r&&!(s=this.children[r-1]).size&&s instanceof wk&&s.side>=0;r--);if(t<=0){let s,o=!0;for(;s=r?this.children[r-1]:null,!(!s||s.dom.parentNode==this.contentDOM);r--,o=!1);return s&&t&&o&&!s.border&&!s.domAtom?s.domFromPos(s.size,t):{node:this.contentDOM,offset:s?Zt(s.dom)+1:0}}else{let s,o=!0;for(;s=r<this.children.length?this.children[r]:null,!(!s||s.dom.parentNode==this.contentDOM);r++,o=!1);return s&&o&&!s.border&&!s.domAtom?s.domFromPos(0,t):{node:this.contentDOM,offset:s?Zt(s.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,s=-1;for(let o=r,a=0;;a++){let l=this.children[a],c=o+l.size;if(i==-1&&e<=c){let u=o+l.border;if(e>=u&&t<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,t,u);e=o;for(let d=a;d>0;d--){let f=this.children[d-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){i=Zt(f.dom)+1;break}e-=f.size}i==-1&&(i=0)}if(i>-1&&(c>t||a==this.children.length-1)){t=c;for(let u=a+1;u<this.children.length;u++){let d=this.children[u];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){s=Zt(d.dom);break}t+=d.size}s==-1&&(s=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,i=!1){let s=Math.min(e,t),o=Math.max(e,t);for(let f=0,h=0;f<this.children.length;f++){let p=this.children[f],m=h+p.size;if(s>h&&o<m)return p.setSelection(e-h-p.border,t-h-p.border,r,i);h=m}let a=this.domFromPos(e,e?-1:1),l=t==e?a:this.domFromPos(t,t?-1:1),c=r.getSelection(),u=!1;if((Jn||Qt)&&e==t){let{node:f,offset:h}=a;if(f.nodeType==3){if(u=!!(h&&f.nodeValue[h-1]=="\n"),u&&h==f.nodeValue.length)for(let p=f,m;p;p=p.parentNode){if(m=p.nextSibling){m.nodeName=="BR"&&(a=l={node:m.parentNode,offset:Zt(m)+1});break}let g=p.pmViewDesc;if(g&&g.node&&g.node.isBlock)break}}else{let p=f.childNodes[h-1];u=p&&(p.nodeName=="BR"||p.contentEditable=="false")}}if(Jn&&c.focusNode&&c.focusNode!=l.node&&c.focusNode.nodeType==1){let f=c.focusNode.childNodes[c.focusOffset];f&&f.contentEditable=="false"&&(i=!0)}if(!(i||u&&Qt)&&zs(a.node,a.offset,c.anchorNode,c.anchorOffset)&&zs(l.node,l.offset,c.focusNode,c.focusOffset))return;let d=!1;if((c.extend||e==t)&&!u){c.collapse(a.node,a.offset);try{e!=t&&c.extend(l.node,l.offset),d=!0}catch(f){}}if(!d){if(e>t){let h=a;a=l,l=h}let f=document.createRange();f.setEnd(l.node,l.offset),f.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(f)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,i=0;i<this.children.length;i++){let s=this.children[i],o=r+s.size;if(r==o?e<=o&&t>=r:e<o&&t>r){let a=r+s.border,l=o-s.border;if(e>=a&&t<=l){this.dirty=e==r||t==o?gs:V1,e==a&&t==l&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=wr:s.markDirty(e-a,t-a);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?gs:wr}r=o}this.dirty=gs}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?gs:V1;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class wk extends Rl{constructor(e,t,r,i){let s,o=t.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!s)return i;if(s.parent)return s.parent.posBeforeChild(s)})),!t.type.spec.raw){if(o.nodeType!=1){let a=document.createElement("span");a.appendChild(o),o=a}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=t,this.widget=t,s=this}matchesWidget(e){return this.dirty==An&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class fB extends Rl{constructor(e,t,r,i){super(e,[],t,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Bs extends Rl{constructor(e,t,r,i){super(e,[],r,i),this.mark=t}static create(e,t,r,i){let s=i.nodeViews[t.type.name],o=s&&s(t,i,r);return(!o||!o.dom)&&(o=Fr.renderSpec(document,t.type.spec.toDOM(t,r))),new Bs(e,t,o.dom,o.contentDOM||o.dom)}parseRule(){return this.dirty&wr||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=wr&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=An){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=An}}slice(e,t,r){let i=Bs.create(this.parent,this.mark,!0,r),s=this.children,o=this.size;t<o&&(s=fp(s,t,o,r)),e>0&&(s=fp(s,0,e,r));for(let a=0;a<s.length;a++)s[a].parent=i;return i.children=s,i}}class Si extends Rl{constructor(e,t,r,i,s,o,a,l,c){super(e,[],s,o),this.node=t,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=a}static create(e,t,r,i,s,o){let a=s.nodeViews[t.type.name],l,c=a&&a(t,s,()=>{if(!l)return o;if(l.parent)return l.parent.posBeforeChild(l)},r,i),u=c&&c.dom,d=c&&c.contentDOM;if(t.isText){if(!u)u=document.createTextNode(t.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:d}=Fr.renderSpec(document,t.type.spec.toDOM(t)));!d&&!t.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));let f=u;return u=Ck(u,r,t),c?l=new hB(e,t,r,i,u,d||null,f,c,s,o+1):t.isText?new Ld(e,t,r,i,u,f,s):new Si(e,t,r,i,u,d||null,f,s,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>q.empty)}return e}matchesNode(e,t,r){return this.dirty==An&&e.eq(this.node)&&dp(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,i=t,s=e.composing?this.localCompositionInfo(e,t):null,o=s&&s.pos>-1?s:null,a=s&&s.pos<0,l=new mB(this,o&&o.node,e);yB(this.node,this.innerDeco,(c,u,d)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!d&&l.syncToMarks(u==this.node.childCount?Pe.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,i)},(c,u,d,f)=>{l.syncToMarks(c.marks,r,e);let h;l.findNodeMatch(c,u,d,f)||a&&e.state.selection.from>i&&e.state.selection.to<i+c.nodeSize&&(h=l.findIndexWithChild(s.node))>-1&&l.updateNodeAt(c,u,d,h,e)||l.updateNextNode(c,u,d,e,f,i)||l.addNode(c,u,d,e,i),i+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==gs)&&(o&&this.protectLocalComposition(e,o),kk(this.contentDOM,this.children,e),No&&bB(this.dom))}localCompositionInfo(e,t){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof Me)||r<t||i>t+this.node.content.size)return null;let s=e.domSelectionRange(),o=wB(s.focusNode,s.focusOffset);if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let a=o.nodeValue,l=_B(this.node.content,a,r-t,i-t);return l<0?null:{node:o,pos:l,text:a}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:i}){if(this.getDesc(t))return;let s=t;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let o=new fB(this,s,t,i);e.input.compositionNodes.push(o),this.children=fp(this.children,r,r+i.length,e,o)}update(e,t,r,i){return this.dirty==wr||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,i),!0)}updateInner(e,t,r,i){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=An}updateOuterDeco(e){if(dp(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=xk(this.dom,this.nodeDOM,up(this.outerDeco,this.node,t),up(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function H1(n,e,t,r,i){Ck(r,e,n);let s=new Si(void 0,n,e,t,r,r,r,i,0);return s.contentDOM&&s.updateChildren(i,0),s}class Ld extends Si{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s,null,o,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,i){return this.dirty==wr||this.dirty!=An&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=An||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=An,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let i=this.node.cut(e,t),s=document.createTextNode(i.text);return new Ld(this.parent,i,this.outerDeco,this.innerDeco,s,s,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=wr)}get domAtom(){return!1}}class _k extends Rl{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==An&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class hB extends Si{constructor(e,t,r,i,s,o,a,l,c,u){super(e,t,r,i,s,o,a,c,u),this.spec=l}update(e,t,r,i){if(this.dirty==wr)return!1;if(this.spec.update){let s=this.spec.update(e,t,r);return s&&this.updateInner(e,t,r,i),s}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,i){this.spec.setSelection?this.spec.setSelection(e,t,r):super.setSelection(e,t,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function kk(n,e,t){let r=n.firstChild,i=!1;for(let s=0;s<e.length;s++){let o=e[s],a=o.dom;if(a.parentNode==n){for(;a!=r;)r=W1(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(a,r);if(o instanceof Bs){let l=r?r.previousSibling:n.lastChild;kk(o.contentDOM,o.children,t),r=l?l.nextSibling:n.firstChild}}for(;r;)r=W1(r),i=!0;i&&t.trackWrites==n&&(t.trackWrites=null)}const Ka=function(n){n&&(this.nodeName=n)};Ka.prototype=Object.create(null);const vs=[new Ka];function up(n,e,t){if(n.length==0)return vs;let r=t?vs[0]:new Ka,i=[r];for(let s=0;s<n.length;s++){let o=n[s].type.attrs;if(o){o.nodeName&&i.push(r=new Ka(o.nodeName));for(let a in o){let l=o[a];l!=null&&(t&&i.length==1&&i.push(r=new Ka(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return i}function xk(n,e,t,r){if(t==vs&&r==vs)return e;let i=e;for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(s){let l;a&&a.nodeName==o.nodeName&&i!=n&&(l=i.parentNode)&&l.nodeName.toLowerCase()==o.nodeName||(l=document.createElement(o.nodeName),l.pmIsDeco=!0,l.appendChild(i),a=vs[0]),i=l}pB(i,a||vs[0],o)}return i}function pB(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=t.class?t.class.split(" ").filter(Boolean):[];for(let s=0;s<r.length;s++)i.indexOf(r[s])==-1&&n.classList.remove(r[s]);for(let s=0;s<i.length;s++)r.indexOf(i[s])==-1&&n.classList.add(i[s]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)n.style.removeProperty(i[1])}t.style&&(n.style.cssText+=t.style)}}function Ck(n,e,t){return xk(n,n,vs,up(e,t,n.nodeType!=1))}function dp(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function W1(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class mB{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=gB(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let i=0,s=this.stack.length>>1,o=Math.min(s,e.length);for(;i<o&&(i==s-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<s;)this.destroyRest(),this.top.dirty=An,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[s])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Bs.create(this.top,e[s],t,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,s++}}findNodeMatch(e,t,r,i){let s=-1,o;if(i>=this.preMatch.index&&(o=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,r))s=this.top.children.indexOf(o,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){s=a;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,t,r,i,s){let o=this.top.children[i];return o.dirty==wr&&o.dom==o.contentDOM&&(o.dirty=gs),o.update(e,t,r,s)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=t}}updateNextNode(e,t,r,i,s,o){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof Si){let c=this.preMatch.matched.get(l);if(c!=null&&c!=s)return!1;let u=l.dom,d,f=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=wr&&dp(t,l.outerDeco));if(!f&&l.update(e,t,r,i))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!f&&(d=this.recreateWrapper(l,e,t,r,i,o)))return this.top.children[this.index]=d,d.contentDOM&&(d.dirty=gs,d.updateChildren(i,o+1),d.dirty=An),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,i,s,o){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content))return null;let a=Si.create(this.top,t,r,i,s,o);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,t,r,i,s){let o=Si.create(this.top,e,t,r,i,s);o.contentDOM&&o.updateChildren(i,s+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,t,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let s=new wk(this.top,e,t,r);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof Bs;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof Ld)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Qt||Wt)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new _k(this.top,[],r,null);t!=this.top?t.children.push(i):t.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function gB(n,e){let t=e,r=t.children.length,i=n.childCount,s=new Map,o=[];e:for(;i>0;){let a;for(;;)if(r){let c=t.children[r-1];if(c instanceof Bs)t=c,r=c.children.length;else{a=c,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let l=a.node;if(l){if(l!=n.child(i-1))break;--i,s.set(a,i),o.push(a)}}return{index:i,matched:s,matches:o.reverse()}}function vB(n,e){return n.type.side-e.type.side}function yB(n,e,t,r){let i=e.locals(n),s=0;if(i.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);r(u,i,e.forChild(s,u),c),s+=u.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){let u,d;for(;o<i.length&&i[o].to==s;){let g=i[o++];g.widget&&(u?(d||(d=[u])).push(g):u=g)}if(u)if(d){d.sort(vB);for(let g=0;g<d.length;g++)t(d[g],c,!!l)}else t(u,c,!!l);let f,h;if(l)h=-1,f=l,l=null;else if(c<n.childCount)h=c,f=n.child(c++);else break;for(let g=0;g<a.length;g++)a[g].to<=s&&a.splice(g--,1);for(;o<i.length&&i[o].from<=s&&i[o].to>s;)a.push(i[o++]);let p=s+f.nodeSize;if(f.isText){let g=p;o<i.length&&i[o].from<g&&(g=i[o].from);for(let w=0;w<a.length;w++)a[w].to<g&&(g=a[w].to);g<p&&(l=f.cut(g-s),f=f.cut(0,g-s),p=g,h=-1)}else for(;o<i.length&&i[o].to<p;)o++;let m=f.isInline&&!f.isLeaf?a.filter(g=>!g.inline):a.slice();r(f,m,e.forChild(s,f),h),s=p}}function bB(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function wB(n,e){for(;;){if(n.nodeType==3)return n;if(n.nodeType==1&&e>0){if(n.childNodes.length>e&&n.childNodes[e].nodeType==3)return n.childNodes[e];n=n.childNodes[e-1],e=fr(n)}else if(n.nodeType==1&&e<n.childNodes.length)n=n.childNodes[e],e=0;else return null}}function _B(n,e,t,r){for(let i=0,s=0;i<n.childCount&&s<=r;){let o=n.child(i++),a=s;if(s+=o.nodeSize,!o.isText)continue;let l=o.text;for(;i<n.childCount;){let c=n.child(i++);if(s+=c.nodeSize,!c.isText)break;l+=c.text}if(s>=t){if(s>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=t)return a+c;if(t==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function fp(n,e,t,r,i){let s=[];for(let o=0,a=0;o<n.length;o++){let l=n[o],c=a,u=a+=l.size;c>=t||u<=e?s.push(l):(c<e&&s.push(l.slice(0,e-c,r)),i&&(s.push(i),i=void 0),u>t&&s.push(l.slice(t-c,l.size,r)))}return s}function Om(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode),s=i&&i.size==0,o=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(o<0)return null;let a=r.resolve(o),l,c;if(Rd(t)){for(l=a;i&&!i.node;)i=i.parent;let u=i.node;if(i&&u.isAtom&&ye.isSelectable(u)&&i.parent&&!(u.isInline&&Uz(t.focusNode,t.focusOffset,i.dom))){let d=i.posBefore;c=new ye(o==d?a:r.resolve(d))}}else{let u=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(u<0)return null;l=r.resolve(u)}if(!c){let u=e=="pointer"||n.state.selection.head<a.pos&&!s?1:-1;c=$m(n,l,a,u)}return c}function Sk(n){return n.editable?n.hasFocus():Tk(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Hr(n,e=!1){let t=n.state.selection;if(Mk(n,t),!!Sk(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Wt){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&zs(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)xB(n);else{let{anchor:r,head:i}=t,s,o;j1&&!(t instanceof Me)&&(t.$from.parent.inlineContent||(s=U1(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(o=U1(n,t.to))),n.docView.setSelection(r,i,n.root,e),j1&&(s&&q1(s),o&&q1(o)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&kB(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const j1=Qt||Wt&&Kz<63;function U1(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),i=r<t.childNodes.length?t.childNodes[r]:null,s=r?t.childNodes[r-1]:null;if(Qt&&i&&i.contentEditable=="false")return Hf(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return Hf(i);if(s)return Hf(s)}}function Hf(n){return n.contentEditable="true",Qt&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function q1(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function kB(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,i=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=i)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!Sk(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function xB(n){let e=n.domSelection(),t=document.createRange(),r=n.cursorWrapper.dom,i=r.nodeName=="IMG";i?t.setEnd(r.parentNode,Zt(r)+1):t.setEnd(r,0),t.collapse(!1),e.removeAllRanges(),e.addRange(t),!i&&!n.state.selection.visible&&on&&Ci<=11&&(r.disabled=!0,r.disabled=!1)}function Mk(n,e){if(e instanceof ye){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(Y1(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else Y1(n)}function Y1(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function $m(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||Me.between(e,t,r)}function K1(n){return n.editable&&!n.hasFocus()?!1:Tk(n)}function Tk(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch(t){return!1}}function CB(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return zs(e.node,e.offset,t.anchorNode,t.anchorOffset)}function hp(n,e){let{$anchor:t,$head:r}=n.selection,i=e>0?t.max(r):t.min(r),s=i.parent.inlineContent?i.depth?n.doc.resolve(e>0?i.after():i.before()):null:i;return s&&we.findFrom(s,e)}function ci(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function G1(n,e,t){let r=n.state.selection;if(r instanceof Me)if(t.indexOf("s")>-1){let{$head:i}=r,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let o=n.state.doc.resolve(i.pos+s.nodeSize*(e<0?-1:1));return ci(n,new Me(r.$anchor,o))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let i=hp(n.state,e);return i&&i instanceof ye?ci(n,i):!1}else if(!($n&&t.indexOf("m")>-1)){let i=r.$head,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,o;if(!s||s.isText)return!1;let a=e<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(o=n.docView.descAt(a))&&!o.contentDOM?ye.isSelectable(s)?ci(n,new ye(e<0?n.state.doc.resolve(i.pos-s.nodeSize):i)):Nl?ci(n,new Me(n.state.doc.resolve(e<0?a:a+s.nodeSize))):!1:!1}}else return!1;else{if(r instanceof ye&&r.node.isInline)return ci(n,new Me(e>0?r.$to:r.$from));{let i=hp(n.state,e);return i?ci(n,i):!1}}}function ed(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Ga(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function Zs(n,e){return e<0?SB(n):MB(n)}function SB(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i,s,o=!1;for(Jn&&t.nodeType==1&&r<ed(t)&&Ga(t.childNodes[r],-1)&&(o=!0);;)if(r>0){if(t.nodeType!=1)break;{let a=t.childNodes[r-1];if(Ga(a,-1))i=t,s=--r;else if(a.nodeType==3)t=a,r=t.nodeValue.length;else break}}else{if(Ok(t))break;{let a=t.previousSibling;for(;a&&Ga(a,-1);)i=t.parentNode,s=Zt(a),a=a.previousSibling;if(a)t=a,r=ed(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}o?pp(n,t,r):i&&pp(n,i,s)}function MB(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i=ed(t),s,o;for(;;)if(r<i){if(t.nodeType!=1)break;let a=t.childNodes[r];if(Ga(a,1))s=t,o=++r;else break}else{if(Ok(t))break;{let a=t.nextSibling;for(;a&&Ga(a,1);)s=a.parentNode,o=Zt(a)+1,a=a.nextSibling;if(a)t=a,r=0,i=ed(t);else{if(t=t.parentNode,t==n.dom)break;r=i=0}}}s&&pp(n,s,o)}function Ok(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function TB(n,e){for(;n&&e==n.childNodes.length&&!Mm(n);)e=Zt(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function OB(n,e){for(;n&&!e&&!Mm(n);)e=Zt(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function pp(n,e,t){if(e.nodeType!=3){let s,o;(o=TB(e,t))?(e=o,t=0):(s=OB(e,t))&&(e=s,t=s.nodeValue.length)}let r=n.domSelection();if(Rd(r)){let s=document.createRange();s.setEnd(e,t),s.setStart(e,t),r.removeAllRanges(),r.addRange(s)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&Hr(n)},50)}function X1(n,e){let t=n.state.doc.resolve(e);if(!(Wt||Gz)&&t.parent.inlineContent){let i=n.coordsAtPos(e);if(e>t.start()){let s=n.coordsAtPos(e-1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left<i.left?"ltr":"rtl"}if(e<t.end()){let s=n.coordsAtPos(e+1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left>i.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function J1(n,e,t){let r=n.state.selection;if(r instanceof Me&&!r.empty||t.indexOf("s")>-1||$n&&t.indexOf("m")>-1)return!1;let{$from:i,$to:s}=r;if(!i.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let o=hp(n.state,e);if(o&&o instanceof ye)return ci(n,o)}if(!i.parent.inlineContent){let o=e<0?i:s,a=r instanceof kn?we.near(o,e):we.findFrom(o,e);return a?ci(n,a):!1}return!1}function Z1(n,e){if(!(n.state.selection instanceof Me))return!0;let{$head:t,$anchor:r,empty:i}=n.state.selection;if(!t.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(s&&!s.isText){let o=n.state.tr;return e<0?o.delete(t.pos-s.nodeSize,t.pos):o.delete(t.pos,t.pos+s.nodeSize),n.dispatch(o),!0}return!1}function Q1(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function $B(n){if(!Qt||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;Q1(n,r,"true"),setTimeout(()=>Q1(n,r,"false"),20)}return!1}function DB(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function EB(n,e){let t=e.keyCode,r=DB(e);if(t==8||$n&&t==72&&r=="c")return Z1(n,-1)||Zs(n,-1);if(t==46&&!e.shiftKey||$n&&t==68&&r=="c")return Z1(n,1)||Zs(n,1);if(t==13||t==27)return!0;if(t==37||$n&&t==66&&r=="c"){let i=t==37?X1(n,n.state.selection.from)=="ltr"?-1:1:-1;return G1(n,i,r)||Zs(n,i)}else if(t==39||$n&&t==70&&r=="c"){let i=t==39?X1(n,n.state.selection.from)=="ltr"?1:-1:1;return G1(n,i,r)||Zs(n,i)}else{if(t==38||$n&&t==80&&r=="c")return J1(n,-1,r)||Zs(n,-1);if(t==40||$n&&t==78&&r=="c")return $B(n)||J1(n,1,r)||Zs(n,1);if(r==($n?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function $k(n,e){n.someProp("transformCopied",h=>{e=h(e,n)});let t=[],{content:r,openStart:i,openEnd:s}=e;for(;i>1&&s>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,s--;let h=r.firstChild;t.push(h.type.name,h.attrs!=h.type.defaultAttrs?h.attrs:null),r=h.content}let o=n.someProp("clipboardSerializer")||Fr.fromSchema(n.state.schema),a=Rk(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let c=l.firstChild,u,d=0;for(;c&&c.nodeType==1&&(u=Nk[c.nodeName.toLowerCase()]);){for(let h=u.length-1;h>=0;h--){let p=a.createElement(u[h]);for(;l.firstChild;)p.appendChild(l.firstChild);l.appendChild(p),d++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice","".concat(i," ").concat(s).concat(d?" -".concat(d):""," ").concat(JSON.stringify(t)));let f=n.someProp("clipboardTextSerializer",h=>h(e,n))||e.content.textBetween(0,e.content.size,"\n\n");return{dom:l,text:f}}function Dk(n,e,t,r,i){let s=i.parent.type.spec.code,o,a;if(!t&&!e)return null;let l=e&&(r||s||!t);if(l){if(n.someProp("transformPastedText",f=>{e=f(e,s||r,n)}),s)return e?new J(q.from(n.state.schema.text(e.replace(/\r\n?/g,"\n"))),0,0):J.empty;let d=n.someProp("clipboardTextParser",f=>f(e,i,r,n));if(d)a=d;else{let f=i.marks(),{schema:h}=n.state,p=Fr.fromSchema(h);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let g=o.appendChild(document.createElement("p"));m&&g.appendChild(p.serializeNode(h.text(m,f)))})}}else n.someProp("transformPastedHTML",d=>{t=d(t,n)}),o=NB(t),Nl&&RB(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let f=o.firstChild;for(;f&&f.nodeType!=1;)f=f.nextSibling;if(!f)break;o=f}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||Eo.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(l||u),context:i,ruleFromNode(f){return f.nodeName=="BR"&&!f.nextSibling&&f.parentNode&&!AB.test(f.parentNode.nodeName)?{ignore:!0}:null}})),u)a=LB(e0(a,+u[1],+u[2]),u[4]);else if(a=J.maxOpen(PB(a.content,i),!0),a.openStart||a.openEnd){let d=0,f=0;for(let h=a.content.firstChild;d<a.openStart&&!h.type.spec.isolating;d++,h=h.firstChild);for(let h=a.content.lastChild;f<a.openEnd&&!h.type.spec.isolating;f++,h=h.lastChild);a=e0(a,d,f)}return n.someProp("transformPasted",d=>{a=d(a,n)}),a}const AB=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function PB(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let i=e.node(t).contentMatchAt(e.index(t)),s,o=[];if(n.forEach(a=>{if(!o)return;let l=i.findWrapping(a.type),c;if(!l)return o=null;if(c=o.length&&s.length&&Ak(l,s,a,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=Pk(o[o.length-1],s.length));let u=Ek(a,l);o.push(u),i=i.matchType(u.type),s=l}}),o)return q.from(o)}return n}function Ek(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,q.from(n));return n}function Ak(n,e,t,r,i){if(i<n.length&&i<e.length&&n[i]==e[i]){let s=Ak(n,e,t,r.lastChild,i+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?t.type:n[i+1]))return r.copy(r.content.append(q.from(Ek(t,n,i+1))))}}function Pk(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,Pk(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(q.empty,!0);return n.copy(t.append(r))}function mp(n,e,t,r,i,s){let o=e<0?n.firstChild:n.lastChild,a=o.content;return n.childCount>1&&(s=0),i<r-1&&(a=mp(a,e,t,r,i+1,s)),i>=t&&(a=e<0?o.contentMatchAt(0).fillBefore(a,s<=i).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(q.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,o.copy(a))}function e0(n,e,t){return e<n.openStart&&(n=new J(mp(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new J(mp(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const Nk={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let t0=null;function Rk(){return t0||(t0=document.implementation.createHTMLDocument("title"))}function NB(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=Rk().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&Nk[r[1].toLowerCase()])&&(n=i.map(s=>"<"+s+">").join("")+n+i.map(s=>"</"+s+">").reverse().join("")),t.innerHTML=n,i)for(let s=0;s<i.length;s++)t=t.querySelector(i[s])||t;return t}function RB(n){let e=n.querySelectorAll(Wt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==" "&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function LB(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch(a){return n}let{content:i,openStart:s,openEnd:o}=n;for(let a=r.length-2;a>=0;a-=2){let l=t.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;i=q.from(l.create(r[a+1],i)),s++,o++}return new J(i,s,o)}const en={},tn={},IB={touchstart:!0,touchmove:!0};class zB{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function BB(n){for(let e in en){let t=en[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{VB(n,r)&&!Dm(n,r)&&(n.editable||!(r.type in tn))&&t(n,r)},IB[e]?{passive:!0}:void 0)}Qt&&n.dom.addEventListener("input",()=>null),gp(n)}function wi(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function FB(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function gp(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>Dm(n,r))})}function Dm(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function VB(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function HB(n,e){!Dm(n,e)&&en[e.type]&&(n.editable||!(e.type in tn))&&en[e.type](n,e)}tn.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!Ik(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(Un&&Wt&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),No&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,us(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||EB(n,t)?t.preventDefault():wi(n,"key")};tn.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};tn.keypress=(n,e)=>{let t=e;if(Ik(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||$n&&t.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof Me)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(t.charCode);!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",s=>s(n,r.$from.pos,r.$to.pos,i))&&n.dispatch(n.state.tr.insertText(i).scrollIntoView()),t.preventDefault()}};function Id(n){return{left:n.clientX,top:n.clientY}}function WB(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function Em(n,e,t,r,i){if(r==-1)return!1;let s=n.state.doc.resolve(r);for(let o=s.depth+1;o>0;o--)if(n.someProp(e,a=>o>s.depth?a(n,t,s.nodeAfter,s.before(o),i,!0):a(n,t,s.node(o),s.before(o),i,!1)))return!0;return!1}function wo(n,e,t){n.focused||n.focus();let r=n.state.tr.setSelection(e);t=="pointer"&&r.setMeta("pointer",!0),n.dispatch(r)}function jB(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&ye.isSelectable(r)?(wo(n,new ye(t),"pointer"),!0):!1}function UB(n,e){if(e==-1)return!1;let t=n.state.selection,r,i;t instanceof ye&&(r=t.node);let s=n.state.doc.resolve(e);for(let o=s.depth+1;o>0;o--){let a=o>s.depth?s.nodeAfter:s.node(o);if(ye.isSelectable(a)){r&&t.$from.depth>0&&o>=t.$from.depth&&s.before(t.$from.depth+1)==t.$from.pos?i=s.before(t.$from.depth):i=s.before(o);break}}return i!=null?(wo(n,ye.create(n.state.doc,i),"pointer"),!0):!1}function qB(n,e,t,r,i){return Em(n,"handleClickOn",e,t,r)||n.someProp("handleClick",s=>s(n,e,r))||(i?UB(n,t):jB(n,t))}function YB(n,e,t,r){return Em(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",i=>i(n,e,r))}function KB(n,e,t,r){return Em(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",i=>i(n,e,r))||GB(n,t,r)}function GB(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(wo(n,Me.create(r,0,r.content.size),"pointer"),!0):!1;let i=r.resolve(e);for(let s=i.depth+1;s>0;s--){let o=s>i.depth?i.nodeAfter:i.node(s),a=i.before(s);if(o.inlineContent)wo(n,Me.create(r,a+1,a+1+o.content.size),"pointer");else if(ye.isSelectable(o))wo(n,ye.create(r,a),"pointer");else continue;return!0}}function Am(n){return td(n)}const Lk=$n?"metaKey":"ctrlKey";en.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=Am(n),i=Date.now(),s="singleClick";i-n.input.lastClick.time<500&&WB(t,n.input.lastClick)&&!t[Lk]&&(n.input.lastClick.type=="singleClick"?s="doubleClick":n.input.lastClick.type=="doubleClick"&&(s="tripleClick")),n.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:s};let o=n.posAtCoords(Id(t));o&&(s=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new XB(n,o,t,!!r)):(s=="doubleClick"?YB:KB)(n,o.pos,o.inside,t)?t.preventDefault():wi(n,"pointer"))};class XB{constructor(e,t,r,i){this.view=e,this.pos=t,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[Lk],this.allowDefault=r.shiftKey;let s,o;if(t.inside>-1)s=e.state.doc.nodeAt(t.inside),o=t.inside;else{let u=e.state.doc.resolve(t.pos);s=u.parent,o=u.depth?u.before():0}const a=i?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l?l.dom:null;let{selection:c}=e.state;(r.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||c instanceof ye&&c.from<=o&&c.to>o)&&(this.mightDrag={node:s,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Jn&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),wi(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Hr(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Id(e))),this.updateAllowDefault(e),this.allowDefault||!t?wi(this.view,"pointer"):qB(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Qt&&this.mightDrag&&!this.mightDrag.node.isAtom||Wt&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(wo(this.view,we.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):wi(this.view,"pointer")}move(e){this.updateAllowDefault(e),wi(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}en.touchstart=n=>{n.input.lastTouch=Date.now(),Am(n),wi(n,"pointer")};en.touchmove=n=>{n.input.lastTouch=Date.now(),wi(n,"pointer")};en.contextmenu=n=>Am(n);function Ik(n,e){return n.composing?!0:Qt&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const JB=Un?5e3:-1;tn.compositionstart=tn.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),td(n,!0),n.markCursor=null;else if(td(n),Jn&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,s=r.focusOffset;i&&i.nodeType==1&&s!=0;){let o=s<0?i.lastChild:i.childNodes[s-1];if(!o)break;if(o.nodeType==3){n.domSelection().collapse(o,o.nodeValue.length);break}else i=o,s=-1}}n.input.composing=!0}zk(n,JB)};tn.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,zk(n,20))};function zk(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>td(n),e))}function Bk(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=ZB());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function ZB(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function td(n,e=!1){if(!(Un&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),Bk(n),e||n.docView&&n.docView.dirty){let t=Om(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):n.updateState(n.state),!0}return!1}}function QB(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const vl=on&&Ci<15||No&&Xz<604;en.copy=tn.cut=(n,e)=>{let t=e,r=n.state.selection,i=t.type=="cut";if(r.empty)return;let s=vl?null:t.clipboardData,o=r.content(),{dom:a,text:l}=$k(n,o);s?(t.preventDefault(),s.clearData(),s.setData("text/html",a.innerHTML),s.setData("text/plain",l)):QB(n,a),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function eF(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function tF(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?yl(n,r.value,null,i,e):yl(n,r.textContent,r.innerHTML,i,e)},50)}function yl(n,e,t,r,i){let s=Dk(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,i,s||J.empty)))return!0;if(!s)return!1;let o=eF(s),a=o?n.state.tr.replaceSelectionWith(o,r):n.state.tr.replaceSelection(s);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Fk(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}tn.paste=(n,e)=>{let t=e;if(n.composing&&!Un)return;let r=vl?null:t.clipboardData,i=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&yl(n,Fk(r),r.getData("text/html"),i,t)?t.preventDefault():tF(n,t)};class Vk{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const Hk=$n?"altKey":"ctrlKey";en.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let i=n.state.selection,s=i.empty?null:n.posAtCoords(Id(t)),o;if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof ye?i.to-1:i.to))){if(r&&r.mightDrag)o=ye.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let u=n.docView.nearestDesc(t.target,!0);u&&u.node.type.spec.draggable&&u!=n.docView&&(o=ye.create(n.state.doc,u.posBefore))}}let a=(o||n.state.selection).content(),{dom:l,text:c}=$k(n,a);t.dataTransfer.clearData(),t.dataTransfer.setData(vl?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",vl||t.dataTransfer.setData("text/plain",c),n.dragging=new Vk(a,!t[Hk],o)};en.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};tn.dragover=tn.dragenter=(n,e)=>e.preventDefault();tn.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let i=n.posAtCoords(Id(t));if(!i)return;let s=n.state.doc.resolve(i.pos),o=r&&r.slice;o?n.someProp("transformPasted",p=>{o=p(o,n)}):o=Dk(n,Fk(t.dataTransfer),vl?null:t.dataTransfer.getData("text/html"),!1,s);let a=!!(r&&!t[Hk]);if(n.someProp("handleDrop",p=>p(n,t,o||J.empty,a))){t.preventDefault();return}if(!o)return;t.preventDefault();let l=o?Nz(n.state.doc,s.pos,o):s.pos;l==null&&(l=s.pos);let c=n.state.tr;if(a){let{node:p}=r;p?p.replace(c):c.deleteSelection()}let u=c.mapping.map(l),d=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,f=c.doc;if(d?c.replaceRangeWith(u,u,o.content.firstChild):c.replaceRange(u,u,o),c.doc.eq(f))return;let h=c.doc.resolve(u);if(d&&ye.isSelectable(o.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new ye(h));else{let p=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((m,g,w,x)=>p=x),c.setSelection($m(n,h,c.doc.resolve(p)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};en.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&Hr(n)},20))};en.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};en.beforeinput=(n,e)=>{if(Wt&&Un&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",s=>s(n,us(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in tn)en[n]=tn[n];function bl(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class nd{constructor(e,t){this.toDOM=e,this.spec=t||xs,this.side=this.spec.side||0}map(e,t,r,i){let{pos:s,deleted:o}=e.mapResult(t.from+i,this.side<0?-1:1);return o?null:new Ut(s-r,s-r,this)}valid(){return!0}eq(e){return this==e||e instanceof nd&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&bl(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Mi{constructor(e,t){this.attrs=e,this.spec=t||xs}map(e,t,r,i){let s=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-r,o=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-r;return s>=o?null:new Ut(s,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Mi&&bl(this.attrs,e.attrs)&&bl(this.spec,e.spec)}static is(e){return e.type instanceof Mi}destroy(){}}class Pm{constructor(e,t){this.attrs=e,this.spec=t||xs}map(e,t,r,i){let s=e.mapResult(t.from+i,1);if(s.deleted)return null;let o=e.mapResult(t.to+i,-1);return o.deleted||o.pos<=s.pos?null:new Ut(s.pos-r,o.pos-r,this)}valid(e,t){let{index:r,offset:i}=e.content.findIndex(t.from),s;return i==t.from&&!(s=e.child(r)).isText&&i+s.nodeSize==t.to}eq(e){return this==e||e instanceof Pm&&bl(this.attrs,e.attrs)&&bl(this.spec,e.spec)}destroy(){}}class Ut{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new Ut(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new Ut(e,e,new nd(t,r))}static inline(e,t,r,i){return new Ut(e,t,new Mi(r,i))}static node(e,t,r,i){return new Ut(e,t,new Pm(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Mi}get widget(){return this.type instanceof nd}}const no=[],xs={};class Qe{constructor(e,t){this.local=e.length?e:no,this.children=t.length?t:no}static create(e,t){return t.length?rd(t,e,0,xs):Ht}find(e,t,r){let i=[];return this.findInner(e==null?0:e,t==null?1e9:t,i,0,r),i}findInner(e,t,r,i,s){for(let o=0;o<this.local.length;o++){let a=this.local[o];a.from<=t&&a.to>=e&&(!s||s(a.spec))&&r.push(a.copy(a.from+i,a.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let a=this.children[o]+1;this.children[o+2].findInner(e-a,t-a,r,i+a,s)}}map(e,t,r){return this==Ht||e.maps.length==0?this:this.mapInner(e,t,0,0,r||xs)}mapInner(e,t,r,i,s){let o;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,i);l&&l.type.valid(t,l)?(o||(o=[])).push(l):s.onRemove&&s.onRemove(this.local[a].spec)}return this.children.length?nF(this.children,o||[],e,t,r,i,s):o?new Qe(o.sort(Cs),no):Ht}add(e,t){return t.length?this==Ht?Qe.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let i,s=0;e.forEach((a,l)=>{let c=l+r,u;if(u=jk(t,a,c)){for(i||(i=this.children.slice());s<i.length&&i[s]<l;)s+=3;i[s]==l?i[s+2]=i[s+2].addInner(a,u,c+1):i.splice(s,0,l,l+a.nodeSize,rd(u,a,c+1,xs)),s+=3}});let o=Wk(s?Uk(t):t,-r);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||o.splice(a--,1);return new Qe(o.length?this.local.concat(o).sort(Cs):this.local,i||this.children)}remove(e){return e.length==0||this==Ht?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,i=this.local;for(let s=0;s<r.length;s+=3){let o,a=r[s]+t,l=r[s+1]+t;for(let u=0,d;u<e.length;u++)(d=e[u])&&d.from>a&&d.to<l&&(e[u]=null,(o||(o=[])).push(d));if(!o)continue;r==this.children&&(r=this.children.slice());let c=r[s+2].removeInner(o,a+1);c!=Ht?r[s+2]=c:(r.splice(s,3),s-=3)}if(i.length){for(let s=0,o;s<e.length;s++)if(o=e[s])for(let a=0;a<i.length;a++)i[a].eq(o,t)&&(i==this.local&&(i=this.local.slice()),i.splice(a--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new Qe(i,r):Ht}forChild(e,t){if(this==Ht)return this;if(t.isLeaf)return Qe.empty;let r,i;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let s=e+1,o=s+t.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<o&&l.to>s&&l.type instanceof Mi){let c=Math.max(s,l.from)-s,u=Math.min(o,l.to)-s;c<u&&(i||(i=[])).push(l.copy(c,u))}}if(i){let a=new Qe(i.sort(Cs),no);return r?new fi([a,r]):a}return r||Ht}eq(e){if(this==e)return!0;if(!(e instanceof Qe)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return Nm(this.localsInner(e))}localsInner(e){if(this==Ht)return no;if(e.inlineContent||!this.local.some(Mi.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Mi||t.push(this.local[r]);return t}}Qe.empty=new Qe([],[]);Qe.removeOverlap=Nm;const Ht=Qe.empty;class fi{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,xs));return fi.from(r)}forChild(e,t){if(t.isLeaf)return Qe.empty;let r=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(e,t);s!=Ht&&(s instanceof fi?r=r.concat(s.members):r.push(s))}return fi.from(r)}eq(e){if(!(e instanceof fi)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(e);if(s.length)if(!t)t=s;else{r&&(t=t.slice(),r=!1);for(let o=0;o<s.length;o++)t.push(s[o])}}return t?Nm(r?t:t.sort(Cs)):no}static from(e){switch(e.length){case 0:return Ht;case 1:return e[0];default:return new fi(e.every(t=>t instanceof Qe)?e:e.reduce((t,r)=>t.concat(r instanceof Qe?r:r.members),[]))}}}function nF(n,e,t,r,i,s,o){let a=n.slice();for(let c=0,u=s;c<t.maps.length;c++){let d=0;t.maps[c].forEach((f,h,p,m)=>{let g=m-p-(h-f);for(let w=0;w<a.length;w+=3){let x=a[w+1];if(x<0||f>x+u-d)continue;let M=a[w]+u-d;h>=M?a[w+1]=f<=M?-2:-1:f>=u&&g&&(a[w]+=g,a[w+1]+=g)}d+=g}),u=t.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=t.map(n[c]+s),d=u-i;if(d<0||d>=r.content.size){l=!0;continue}let f=t.map(n[c+1]+s,-1),h=f-i,{index:p,offset:m}=r.content.findIndex(d),g=r.maybeChild(p);if(g&&m==d&&m+g.nodeSize==h){let w=a[c+2].mapInner(t,g,u+1,n[c]+s+1,o);w!=Ht?(a[c]=d,a[c+1]=h,a[c+2]=w):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=rF(a,n,e,t,i,s,o),u=rd(c,r,0,o);e=u.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,f=0;d<u.children.length;d+=3){let h=u.children[d];for(;f<a.length&&a[f]<h;)f+=3;a.splice(f,0,u.children[d],u.children[d+1],u.children[d+2])}}return new Qe(e.sort(Cs),a)}function Wk(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let i=n[r];t.push(new Ut(i.from+e,i.to+e,i.type))}return t}function rF(n,e,t,r,i,s,o){function a(l,c){for(let u=0;u<l.local.length;u++){let d=l.local[u].map(r,i,c);d?t.push(d):o.onRemove&&o.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],e[l]+s+1);return t}function jk(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,i=null;for(let s=0,o;s<n.length;s++)(o=n[s])&&o.from>t&&o.to<r&&((i||(i=[])).push(o),n[s]=null);return i}function Uk(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function rd(n,e,t,r){let i=[],s=!1;e.forEach((a,l)=>{let c=jk(n,a,l+t);if(c){s=!0;let u=rd(c,a,t+l+1,r);u!=Ht&&i.push(l,l+a.nodeSize,u)}});let o=Wk(s?Uk(n):n,-t).sort(Cs);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||(r.onRemove&&r.onRemove(o[a].spec),o.splice(a--,1));return o.length||i.length?new Qe(o,i):Ht}function Cs(n,e){return n.from-e.from||n.to-e.to}function Nm(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){let s=e[i];if(s.from==r.from){s.to!=r.to&&(e==n&&(e=n.slice()),e[i]=s.copy(s.from,r.to),n0(e,i+1,s.copy(r.to,s.to)));continue}else{s.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,s.from),n0(e,i,r.copy(s.from,r.to)));break}}}return e}function n0(n,e,t){for(;e<n.length&&Cs(t,n[e])>0;)e++;n.splice(e,0,t)}function Wf(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=Ht&&e.push(r)}),n.cursorWrapper&&e.push(Qe.create(n.state.doc,[n.cursorWrapper.deco])),fi.from(e)}const iF={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},sF=on&&Ci<=11;class oF{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class aF{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new oF,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);on&&Ci<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),sF&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,iF)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(K1(this.view)){if(this.suppressingSelectionUpdates)return Hr(this.view);if(on&&Ci<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&zs(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let s=e.focusNode;s;s=gl(s))t.add(s);for(let s=e.anchorNode;s;s=gl(s))if(t.has(s)){r=s;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&K1(e)&&!this.ignoreSelectionChange(r),s=-1,o=-1,a=!1,l=[];if(e.editable)for(let u=0;u<t.length;u++){let d=this.registerMutation(t[u],l);d&&(s=s<0?d.from:Math.min(d.from,s),o=o<0?d.to:Math.max(d.to,o),d.typeOver&&(a=!0))}if(Jn&&l.length>1){let u=l.filter(d=>d.nodeName=="BR");if(u.length==2){let d=u[0],f=u[1];d.parentNode&&d.parentNode.parentNode==f.parentNode?f.remove():d.remove()}}let c=null;s<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Rd(r)&&(c=Om(e))&&c.eq(we.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Hr(e),this.currentSelection.set(r),e.scrollToSelection()):(s>-1||i)&&(s>-1&&(e.docView.markDirty(s,o),lF(e)),this.handleDOMChange(s,o,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Hr(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++)t.push(e.addedNodes[u]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,s=e.nextSibling;if(on&&Ci<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:d,nextSibling:f}=e.addedNodes[u];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d),(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(s=f)}let o=i&&i.parentNode==e.target?Zt(i)+1:0,a=r.localPosFromDOM(e.target,o,-1),l=s&&s.parentNode==e.target?Zt(s):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}}let r0=new WeakMap,i0=!1;function lF(n){if(!r0.has(n)&&(r0.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Jn,i0)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),i0=!0}}function cF(n){let e;function t(l){l.preventDefault(),l.stopImmediatePropagation(),e=l.getTargetRanges()[0]}n.dom.addEventListener("beforeinput",t,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",t,!0);let r=e.startContainer,i=e.startOffset,s=e.endContainer,o=e.endOffset,a=n.domAtPos(n.state.selection.anchor);return zs(a.node,a.offset,s,o)&&([r,i,s,o]=[s,o,r,i]),{anchorNode:r,anchorOffset:i,focusNode:s,focusOffset:o}}function uF(n,e,t){let{node:r,fromOffset:i,toOffset:s,from:o,to:a}=n.docView.parseRange(e,t),l=n.domSelectionRange(),c,u=l.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],Rd(l)||c.push({node:l.focusNode,offset:l.focusOffset})),Wt&&n.input.lastKeyCode===8)for(let g=s;g>i;g--){let w=r.childNodes[g-1],x=w.pmViewDesc;if(w.nodeName=="BR"&&!x){s=g;break}if(!x||x.size)break}let d=n.state.doc,f=n.someProp("domParser")||Eo.fromSchema(n.state.schema),h=d.resolve(o),p=null,m=f.parse(r,{topNode:h.parent,topMatch:h.parent.contentMatchAt(h.index()),topOpen:!0,from:i,to:s,preserveWhitespace:h.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:dF,context:h});if(c&&c[0].pos!=null){let g=c[0].pos,w=c[1]&&c[1].pos;w==null&&(w=g),p={anchor:g+o,head:w+o}}return{doc:m,sel:p,from:o,to:a}}function dF(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Qt&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||Qt&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const fF=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function hF(n,e,t,r,i){let s=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let D=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,N=Om(n,D);if(N&&!n.state.selection.eq(N)){if(Wt&&Un&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",U=>U(n,us(13,"Enter"))))return;let B=n.state.tr.setSelection(N);D=="pointer"?B.setMeta("pointer",!0):D=="key"&&B.scrollIntoView(),s&&B.setMeta("composition",s),n.dispatch(B)}return}let o=n.state.doc.resolve(e),a=o.sharedDepth(t);e=o.before(a+1),t=n.state.doc.resolve(t).after(a+1);let l=n.state.selection,c=uF(n,e,t),u=n.state.doc,d=u.slice(c.from,c.to),f,h;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(f=n.state.selection.to,h="end"):(f=n.state.selection.from,h="start"),n.input.lastKeyCode=null;let p=gF(d.content,c.doc.content,c.from,f,h);if((No&&n.input.lastIOSEnter>Date.now()-225||Un)&&i.some(D=>D.nodeType==1&&!fF.test(D.nodeName))&&(!p||p.endA>=p.endB)&&n.someProp("handleKeyDown",D=>D(n,us(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!p)if(r&&l instanceof Me&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))p={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let D=s0(n,n.state.doc,c.sel);if(D&&!D.eq(n.state.selection)){let N=n.state.tr.setSelection(D);s&&N.setMeta("composition",s),n.dispatch(N)}}return}if(Wt&&n.cursorWrapper&&c.sel&&c.sel.anchor==n.cursorWrapper.deco.from&&c.sel.head==c.sel.anchor){let D=p.endB-p.start;c.sel={anchor:c.sel.anchor+D,head:c.sel.anchor+D}}n.input.domChangeCount++,n.state.selection.from<n.state.selection.to&&p.start==p.endB&&n.state.selection instanceof Me&&(p.start>n.state.selection.from&&p.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?p.start=n.state.selection.from:p.endA<n.state.selection.to&&p.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(p.endB+=n.state.selection.to-p.endA,p.endA=n.state.selection.to)),on&&Ci<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>c.from&&c.doc.textBetween(p.start-c.from-1,p.start-c.from+1)=="  "&&(p.start--,p.endA--,p.endB--);let m=c.doc.resolveNoCache(p.start-c.from),g=c.doc.resolveNoCache(p.endB-c.from),w=u.resolve(p.start),x=m.sameParent(g)&&m.parent.inlineContent&&w.end()>=p.endA,M;if((No&&n.input.lastIOSEnter>Date.now()-225&&(!x||i.some(D=>D.nodeName=="DIV"||D.nodeName=="P"))||!x&&m.pos<c.doc.content.size&&!m.sameParent(g)&&(M=we.findFrom(c.doc.resolve(m.pos+1),1,!0))&&M.head==g.pos)&&n.someProp("handleKeyDown",D=>D(n,us(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>p.start&&mF(u,p.start,p.endA,m,g)&&n.someProp("handleKeyDown",D=>D(n,us(8,"Backspace")))){Un&&Wt&&n.domObserver.suppressSelectionUpdates();return}Wt&&Un&&p.endB==p.start&&(n.input.lastAndroidDelete=Date.now()),Un&&!x&&m.start()!=g.start()&&g.parentOffset==0&&m.depth==g.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==p.endA&&(p.endB-=2,g=c.doc.resolveNoCache(p.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(D){return D(n,us(13,"Enter"))})},20));let b=p.start,C=p.endA,k,$,O;if(x){if(m.pos==g.pos)on&&Ci<=11&&m.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>Hr(n),20)),k=n.state.tr.delete(b,C),$=u.resolve(p.start).marksAcross(u.resolve(p.endA));else if(p.endA==p.endB&&(O=pF(m.parent.content.cut(m.parentOffset,g.parentOffset),w.parent.content.cut(w.parentOffset,p.endA-w.start()))))k=n.state.tr,O.type=="add"?k.addMark(b,C,O.mark):k.removeMark(b,C,O.mark);else if(m.parent.child(m.index()).isText&&m.index()==g.index()-(g.textOffset?0:1)){let D=m.parent.textBetween(m.parentOffset,g.parentOffset);if(n.someProp("handleTextInput",N=>N(n,b,C,D)))return;k=n.state.tr.insertText(D,b,C)}}if(k||(k=n.state.tr.replace(b,C,c.doc.slice(p.start-c.from,p.endB-c.from))),c.sel){let D=s0(n,k.doc,c.sel);D&&!(Wt&&Un&&n.composing&&D.empty&&(p.start!=p.endB||n.input.lastAndroidDelete<Date.now()-100)&&(D.head==b||D.head==k.mapping.map(C)-1)||on&&D.empty&&D.head==b)&&k.setSelection(D)}$&&k.ensureMarks($),s&&k.setMeta("composition",s),n.dispatch(k.scrollIntoView())}function s0(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:$m(n,e.resolve(t.anchor),e.resolve(t.head))}function pF(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,i=t,s=r,o,a,l;for(let u=0;u<r.length;u++)i=r[u].removeFromSet(i);for(let u=0;u<t.length;u++)s=t[u].removeFromSet(s);if(i.length==1&&s.length==0)a=i[0],o="add",l=u=>u.mark(a.addToSet(u.marks));else if(i.length==0&&s.length==1)a=s[0],o="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(q.from(c).eq(n))return{mark:a,type:o}}function mF(n,e,t,r,i){if(!r.parent.isTextblock||t-e<=i.pos-r.pos||jf(r,!0,!1)<i.pos)return!1;let s=n.resolve(e);if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=n.resolve(jf(s,!0,!0));return!o.parent.isTextblock||o.pos>t||jf(o,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function jf(n,e,t){let r=n.depth,i=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,i++,e=!1;if(t){let s=n.node(r).maybeChild(n.indexAfter(r));for(;s&&!s.isLeaf;)s=s.firstChild,i++}return i}function gF(n,e,t,r,i){let s=n.findDiffStart(e,t);if(s==null)return null;let{a:o,b:a}=n.findDiffEnd(e,t+n.size,t+e.size);if(i=="end"){let l=Math.max(0,s-Math.min(o,a));r-=o+l-s}if(o<s&&n.size<e.size){let l=r<=s&&r>=o?s-r:0;s-=l,s&&s<e.size&&o0(e.textBetween(s-1,s+1))&&(s+=l?1:-1),a=s+(a-o),o=s}else if(a<s){let l=r<=s&&r>=a?s-r:0;s-=l,s&&s<n.size&&o0(n.textBetween(s-1,s+1))&&(s+=l?1:-1),o=s+(o-a),a=s}return{start:s,endA:o,endB:a}}function o0(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class vF{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new zB,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(d0),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=c0(this),l0(this),this.nodeViews=u0(this),this.docView=H1(this.state.doc,a0(this),Wf(this),this.dom,this),this.domObserver=new aF(this,(r,i,s,o)=>hF(this,r,i,s,o)),this.domObserver.start(),BB(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&gp(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(d0),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let i=this.state,s=!1,o=!1;e.storedMarks&&this.composing&&(Bk(this),o=!0),this.state=e;let a=i.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let h=u0(this);bF(h,this.nodeViews)&&(this.nodeViews=h,s=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&gp(this),this.editable=c0(this),l0(this);let l=Wf(this),c=a0(this),u=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",d=s||!this.docView.matchesNode(e.doc,c,l);(d||!e.selection.eq(i.selection))&&(o=!0);let f=u=="preserve"&&o&&this.dom.style.overflowAnchor==null&&Qz(this);if(o){this.domObserver.stop();let h=d&&(on||Wt)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&yF(i.selection,e.selection);if(d){let p=Wt?this.trackWrites=this.domSelectionRange().focusNode:null;(s||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=H1(e.doc,c,l,this.dom,this)),p&&!this.trackWrites&&(h=!0)}h||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&CB(this))?Hr(this,h):(Mk(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():f&&eB(f)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof ye){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&L1(this,t.getBoundingClientRect(),e)}else L1(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let s=r.from+(this.state.doc.content.size-t.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==r.node&&(i=s)}this.dragging=new Vk(e.slice,e.move,i<0?void 0:ye.create(this.state.doc,i))}someProp(e,t){let r=this._props&&this._props[e],i;if(r!=null&&(i=t?t(r):r))return i;for(let o=0;o<this.directPlugins.length;o++){let a=this.directPlugins[o].props[e];if(a!=null&&(i=t?t(a):a))return i}let s=this.state.plugins;if(s)for(let o=0;o<s.length;o++){let a=s[o].props[e];if(a!=null&&(i=t?t(a):a))return i}}hasFocus(){if(on){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&tB(this.dom),Hr(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return oB(this,e)}coordsAtPos(e,t=1){return yk(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let i=this.docView.posFromDOM(e,t,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,t){return dB(this,t||this.state,e)}pasteHTML(e,t){return yl(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return yl(this,e,null,!0,t||new ClipboardEvent("paste"))}destroy(){this.docView&&(FB(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Wf(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return this.docView==null}dispatchEvent(e){return HB(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){return Qt&&this.root.nodeType===11&&qz(this.dom.ownerDocument)==this.dom?cF(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function a0(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[Ut.node(0,n.state.doc.content.size,e)]}function l0(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:Ut.widget(n.state.selection.head,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function c0(n){return!n.someProp("editable",e=>e(n.state)===!1)}function yF(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function u0(n){let e=Object.create(null);function t(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function bF(n,e){let t=0,r=0;for(let i in n){if(n[i]!=e[i])return!0;t++}for(let i in e)r++;return t!=r}function d0(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var wF=Object.defineProperty,_F=(n,e,t)=>e in n?wF(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,En=(n,e,t)=>(_F(n,typeof e!="symbol"?e+"":e,t),t);const kF=Symbol("[ProsemirrorAdapter]nodeViewContext"),xF=Symbol("[ProsemirrorAdapter]useNodeViewFactory");let CF=class extends YI{constructor(){super(...arguments),En(this,"key",km()),En(this,"context",{contentRef:e=>{e&&e instanceof HTMLElement&&this.contentDOM&&e.firstChild!==this.contentDOM&&e.appendChild(this.contentDOM)},view:this.view,getPos:this.getPos,setAttrs:this.setAttrs,node:pi(this.node),selected:pi(this.selected),decorations:pi(this.decorations),innerDecorations:pi(this.innerDecorations)}),En(this,"updateContext",()=>{Object.entries({node:this.node,selected:this.selected,decorations:this.decorations,innerDecorations:this.innerDecorations}).forEach(([e,t])=>{const r=this.context[e];r.value!==t&&(r.value=t)})}),En(this,"render",()=>{const e=this.component;return hd(W({name:"ProsemirrorNodeView",setup:()=>(Dt(kF,this.context),()=>P(Li,{key:this.key,to:this.dom},{default:()=>[P(e,null,null)]}))}))})}};const SF=(n,e)=>t=>(r,i,s,o,a)=>{const l=new CF({node:r,view:i,getPos:s,decorations:o,innerDecorations:a,options:{...t,onUpdate(){var c;(c=t.onUpdate)==null||c.call(t),l.updateContext()},selectNode(){var c;(c=t.selectNode)==null||c.call(t),l.updateContext()},deselectNode(){var c;(c=t.deselectNode)==null||c.call(t),l.updateContext()},destroy(){var c;(c=t.destroy)==null||c.call(t),e(l)}}});return n(l),l},qk=Symbol("[ProsemirrorAdapter]nodeViewContext"),zd=()=>dt(qk),Yk=Symbol("[ProsemirrorAdapter]usePluginViewFactory"),Rm=()=>dt(Yk);let MF=class extends KI{constructor(){super(...arguments),En(this,"key",km()),En(this,"context",{view:pi(this.view),prevState:pi(this.prevState)}),En(this,"updateContext",()=>{Object.entries({view:this.view,prevState:this.prevState}).forEach(([e,t])=>{const r=this.context[e];if(e==="view"){const i=Object.assign(Object.create(Object.getPrototypeOf(t)),t);r.value=i;return}r.value=t})}),En(this,"render",()=>{const e=this.component;return hd(W({name:"ProsemirrorNodeView",setup:()=>(Dt(qk,this.context),()=>P(Li,{key:this.key,to:this.root},{default:()=>[P(e,null,null)]}))}))})}};const TF=(n,e)=>t=>r=>{const i=new MF({view:r,options:{...t,update:(s,o)=>{var a;(a=t.update)==null||a.call(t,s,o),i.updateContext()},destroy:()=>{var s;(s=t.destroy)==null||s.call(t),e(i)}}});return n(i),i},OF=()=>{const n=E({}),e=Ho(),t=hd({});return zp(()=>{t.updater=()=>{e==null||e.update()}}),Xn(()=>{t.updater=void 0}),{portals:n,renderVueRenderer:r=>{var i;n.value[r.key]=r.render(),(i=t.updater)==null||i.call(t)},removeVueRenderer:r=>{delete n.value[r.key]}}},Kk=Symbol("[ProsemirrorAdapter]widgetViewContext"),$F=()=>dt(Kk),Gk=Symbol("[ProsemirrorAdapter]useWidgetViewFactory"),DF=()=>dt(Gk);let EF=class extends GI{constructor(){super(...arguments),En(this,"key",km()),En(this,"context",{view:this.view,getPos:this.getPos,spec:this.spec}),En(this,"updateContext",()=>{Object.assign(this.context,{view:this.view,getPos:this.getPos,spec:this.spec})}),En(this,"render",()=>{const e=this.component;return hd(W({name:"ProsemirrorWidgetView",setup:()=>(Dt(Kk,this.context),()=>P(Li,{key:this.key,to:this.dom},{default:()=>[P(e,null,null)]}))}))})}};const AF=(n,e)=>t=>(r,i={})=>{const s=new EF({pos:r,options:t}),o={...i,destroy:a=>{var l;(l=i.destroy)==null||l.call(i,a),e(s)}};return s.spec=o,Ut.widget(r,(a,l)=>(s.bind(a,l),s.updateContext(),n(s),s.dom),o)},PF=W({name:"ProsemirrorAdapterProvider",setup:(n,{slots:e})=>{const{portals:t,renderVueRenderer:r,removeVueRenderer:i}=OF(),s=SF(r,i),o=TF(r,i),a=AF(r,i);return Dt(xF,s),Dt(Yk,o),Dt(Gk,a),()=>{var l;return P(X,null,[(l=e.default)==null?void 0:l.call(e),Object.values(t.value).map(c=>Mt(c))])}}});var Cn=(n=>(n.docTypeError="docTypeError",n.contextNotFound="contextNotFound",n.timerNotFound="timerNotFound",n.ctxCallOutOfScope="ctxCallOutOfScope",n.createNodeInParserFail="createNodeInParserFail",n.stackOverFlow="stackOverFlow",n.parserMatchError="parserMatchError",n.serializerMatchError="serializerMatchError",n.getAtomFromSchemaFail="getAtomFromSchemaFail",n.expectDomTypeError="expectDomTypeError",n.callCommandBeforeEditorView="callCommandBeforeEditorView",n.missingRootElement="missingRootElement",n.missingNodeInSchema="missingNodeInSchema",n.missingMarkInSchema="missingMarkInSchema",n.ctxNotBind="ctxNotBind",n.missingYjsDoc="missingYjsDoc",n))(Cn||{});let Fn=class extends Error{constructor(e,t){super(t),this.name="MilkdownError",this.code=e}};const NF=(n,e)=>typeof e=="function"?"[Function]":e,Ro=n=>JSON.stringify(n,NF);function RF(n){return new Fn(Cn.docTypeError,"Doc type error, unsupported type: ".concat(Ro(n)))}function LF(n){return new Fn(Cn.contextNotFound,'Context "'.concat(n,'" not found, do you forget to inject it?'))}function IF(n){return new Fn(Cn.timerNotFound,'Timer "'.concat(n,'" not found, do you forget to record it?'))}function Lm(){return new Fn(Cn.ctxCallOutOfScope,"Should not call a context out of the plugin.")}function zF(...n){const e=n.reduce((t,r)=>{if(!r)return t;const i=s=>Array.isArray(s)?s.map(o=>i(o)).join(", "):s.toJSON?Ro(s.toJSON()):s.spec?Ro(s.spec):s.toString();return"".concat(t,", ").concat(i(r))},"Create prosemirror node from remark failed in parser");return new Fn(Cn.createNodeInParserFail,e)}function Xk(){return new Fn(Cn.stackOverFlow,"Stack over flow, cannot pop on an empty stack.")}function BF(n){return new Fn(Cn.parserMatchError,"Cannot match target parser for node: ".concat(Ro(n),"."))}function FF(n){return new Fn(Cn.serializerMatchError,"Cannot match target serializer for node: ".concat(Ro(n),"."))}function Cr(n){return new Fn(Cn.expectDomTypeError,"Expect to be a dom, but get: ".concat(Ro(n),"."))}function VF(){return new Fn(Cn.callCommandBeforeEditorView,"You're trying to call a command before editor view initialized, make sure to get commandManager from ctx after editor view has been initialized")}function HF(n){return new Fn(Cn.missingNodeInSchema,'Missing node in schema, milkdown cannot find "'.concat(n,'" in schema.'))}function WF(n){return new Fn(Cn.missingMarkInSchema,'Missing mark in schema, milkdown cannot find "'.concat(n,'" in schema.'))}var Jk=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},ue=(n,e,t)=>(Jk(n,e,"read from private field"),t?t.call(n):e.get(n)),ht=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},He=(n,e,t,r)=>(Jk(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t);let Zk=class{constructor(){this.sliceMap=new Map,this.get=e=>{const t=typeof e=="string"?[...this.sliceMap.values()].find(r=>r.type.name===e):this.sliceMap.get(e.id);if(!t){const r=typeof e=="string"?e:e.name;throw LF(r)}return t},this.remove=e=>{const t=typeof e=="string"?[...this.sliceMap.values()].find(r=>r.type.name===e):this.sliceMap.get(e.id);t&&this.sliceMap.delete(t.type.id)},this.has=e=>typeof e=="string"?[...this.sliceMap.values()].some(t=>t.type.name===e):this.sliceMap.has(e.id)}};var ir,ni,ya;let jF=class{constructor(e,t,r){ht(this,ir,void 0),ht(this,ni,void 0),ht(this,ya,void 0),He(this,ir,[]),He(this,ya,()=>{ue(this,ir).forEach(i=>i(ue(this,ni)))}),this.set=i=>{He(this,ni,i),ue(this,ya).call(this)},this.get=()=>ue(this,ni),this.update=i=>{He(this,ni,i(ue(this,ni))),ue(this,ya).call(this)},this.type=r,He(this,ni,t),e.set(r.id,this)}on(e){return ue(this,ir).push(e),()=>{He(this,ir,ue(this,ir).filter(t=>t!==e))}}once(e){const t=this.on(r=>{e(r),t()});return t}off(e){He(this,ir,ue(this,ir).filter(t=>t!==e))}offAll(){He(this,ir,[])}};ir=new WeakMap,ni=new WeakMap,ya=new WeakMap;let UF=class{constructor(e,t){this.id=Symbol("Context-".concat(t)),this.name=t,this._defaultValue=e,this._typeInfo=()=>{throw Lm()}}create(e,t=this._defaultValue){return new jF(e,t,this)}};const We=(n,e)=>new UF(n,e);var Uc,qc,Yc,ro,ba,ns,wa,_a,ka;let qF=class{constructor(e,t,r){ht(this,Uc,void 0),ht(this,qc,void 0),ht(this,Yc,void 0),ht(this,ro,void 0),ht(this,ba,void 0),ht(this,ns,void 0),ht(this,wa,void 0),ht(this,_a,void 0),ht(this,ka,void 0),He(this,ro,new Set),He(this,ba,new Set),He(this,ns,new Map),He(this,wa,new Map),this.read=()=>({metadata:ue(this,Uc),injectedSlices:[...ue(this,ro)].map(i=>({name:typeof i=="string"?i:i.name,value:ue(this,_a).call(this,i)})),consumedSlices:[...ue(this,ba)].map(i=>({name:typeof i=="string"?i:i.name,value:ue(this,_a).call(this,i)})),recordedTimers:[...ue(this,ns)].map(([i,{duration:s}])=>({name:i.name,duration:s,status:ue(this,ka).call(this,i)})),waitTimers:[...ue(this,wa)].map(([i,{duration:s}])=>({name:i.name,duration:s,status:ue(this,ka).call(this,i)}))}),this.onRecord=i=>{ue(this,ns).set(i,{start:Date.now(),duration:0})},this.onClear=i=>{ue(this,ns).delete(i)},this.onDone=i=>{const s=ue(this,ns).get(i);s&&(s.duration=Date.now()-s.start)},this.onWait=(i,s)=>{const o=Date.now();s.finally(()=>{ue(this,wa).set(i,{duration:Date.now()-o})})},this.onInject=i=>{ue(this,ro).add(i)},this.onRemove=i=>{ue(this,ro).delete(i)},this.onUse=i=>{ue(this,ba).add(i)},He(this,_a,i=>ue(this,qc).get(i).get()),He(this,ka,i=>ue(this,Yc).get(i).status),He(this,qc,e),He(this,Yc,t),He(this,Uc,r)}};Uc=new WeakMap,qc=new WeakMap,Yc=new WeakMap,ro=new WeakMap,ba=new WeakMap,ns=new WeakMap,wa=new WeakMap,_a=new WeakMap,ka=new WeakMap;var ri,ii,Kc,jn;const YF=class Qk{constructor(e,t,r){ht(this,ri,void 0),ht(this,ii,void 0),ht(this,Kc,void 0),ht(this,jn,void 0),this.produce=i=>i&&Object.keys(i).length?new Qk(ue(this,ri),ue(this,ii),{...i}):this,this.inject=(i,s)=>{var o;const a=i.create(ue(this,ri).sliceMap);return s!=null&&a.set(s),(o=ue(this,jn))==null||o.onInject(i),this},this.remove=i=>{var s;return ue(this,ri).remove(i),(s=ue(this,jn))==null||s.onRemove(i),this},this.record=i=>{var s;return i.create(ue(this,ii).store),(s=ue(this,jn))==null||s.onRecord(i),this},this.clearTimer=i=>{var s;return ue(this,ii).remove(i),(s=ue(this,jn))==null||s.onClear(i),this},this.isInjected=i=>ue(this,ri).has(i),this.isRecorded=i=>ue(this,ii).has(i),this.use=i=>{var s;return(s=ue(this,jn))==null||s.onUse(i),ue(this,ri).get(i)},this.get=i=>this.use(i).get(),this.set=(i,s)=>this.use(i).set(s),this.update=(i,s)=>this.use(i).update(s),this.timer=i=>ue(this,ii).get(i),this.done=i=>{var s;this.timer(i).done(),(s=ue(this,jn))==null||s.onDone(i)},this.wait=i=>{var s;const o=this.timer(i).start();return(s=ue(this,jn))==null||s.onWait(i,o),o},this.waitTimers=async i=>{await Promise.all(this.get(i).map(s=>this.wait(s)))},He(this,ri,e),He(this,ii,t),He(this,Kc,r),r&&He(this,jn,new qF(e,t,r))}get meta(){return ue(this,Kc)}get inspector(){return ue(this,jn)}};ri=new WeakMap,ii=new WeakMap,Kc=new WeakMap,jn=new WeakMap;let KF=YF,GF=class{constructor(){this.store=new Map,this.get=e=>{const t=this.store.get(e.id);if(!t)throw IF(e.name);return t},this.remove=e=>{this.store.delete(e.id)},this.has=e=>this.store.has(e.id)}};var io,rs,xa,si,Ca,Gc;let XF=class{constructor(e,t){ht(this,io,void 0),ht(this,rs,void 0),ht(this,xa,void 0),ht(this,si,void 0),ht(this,Ca,void 0),ht(this,Gc,void 0),He(this,io,null),He(this,rs,null),He(this,si,"pending"),this.start=()=>{var r;return(r=ue(this,io))!=null||He(this,io,new Promise((i,s)=>{He(this,rs,o=>{o instanceof CustomEvent&&o.detail.id===ue(this,xa)&&(He(this,si,"resolved"),ue(this,Ca).call(this),o.stopImmediatePropagation(),i())}),ue(this,Gc).call(this,()=>{ue(this,si)==="pending"&&He(this,si,"rejected"),ue(this,Ca).call(this),s(new Error("Timing ".concat(this.type.name," timeout.")))}),He(this,si,"pending"),addEventListener(this.type.name,ue(this,rs))})),ue(this,io)},this.done=()=>{const r=new CustomEvent(this.type.name,{detail:{id:ue(this,xa)}});dispatchEvent(r)},He(this,Ca,()=>{ue(this,rs)&&removeEventListener(this.type.name,ue(this,rs))}),He(this,Gc,r=>{setTimeout(()=>{r()},this.type.timeout)}),He(this,xa,Symbol(t.name)),this.type=t,e.set(t.id,this)}get status(){return ue(this,si)}};io=new WeakMap,rs=new WeakMap,xa=new WeakMap,si=new WeakMap,Ca=new WeakMap,Gc=new WeakMap;let JF=class{constructor(e,t=3e3){this.create=r=>new XF(r,this),this.id=Symbol("Timer-".concat(e)),this.name=e,this.timeout=t}};const Bi=(n,e=3e3)=>new JF(n,e);var ex=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},Ae=(n,e,t)=>(ex(n,e,"read from private field"),t?t.call(n):e.get(n)),Tt=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},ot=(n,e,t,r)=>(ex(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t);let tx=class{},nx=class{constructor(){this.elements=[],this.size=()=>this.elements.length,this.top=()=>this.elements.at(-1),this.push=e=>{var t;(t=this.top())==null||t.push(e)},this.open=e=>{this.elements.push(e)},this.close=()=>{const e=this.elements.pop();if(!e)throw Xk();return e}}},ZF=class rx extends tx{constructor(e,t,r){super(),this.type=e,this.content=t,this.attrs=r}push(e,...t){this.content.push(e,...t)}pop(){return this.content.pop()}static create(e,t,r){return new rx(e,t,r)}};var sr,Sa,Xc,Jc,Zc,Ma,Ta;const vp=class extends nx{constructor(e){super(),Tt(this,sr,void 0),Tt(this,Sa,void 0),Tt(this,Xc,void 0),Tt(this,Jc,void 0),Tt(this,Zc,void 0),Tt(this,Ma,void 0),Tt(this,Ta,void 0),ot(this,sr,Pe.none),ot(this,Sa,t=>t.isText),ot(this,Xc,(t,r)=>{if(Ae(this,Sa).call(this,t)&&Ae(this,Sa).call(this,r)&&Pe.sameSet(t.marks,r.marks))return this.schema.text(t.text+r.text,t.marks)}),ot(this,Jc,t=>{const r=Object.values({...this.schema.nodes,...this.schema.marks}).find(i=>i.spec.parseMarkdown.match(t));if(!r)throw BF(t);return r}),ot(this,Zc,t=>{const r=Ae(this,Jc).call(this,t);r.spec.parseMarkdown.runner(this,t,r)}),this.injectRoot=(t,r,i)=>(this.openNode(r,i),this.next(t.children),this),this.openNode=(t,r)=>(this.open(ZF.create(t,[],r)),this),ot(this,Ma,()=>{ot(this,sr,Pe.none);const t=this.close();return Ae(this,Ta).call(this,t.type,t.attrs,t.content)}),this.closeNode=()=>(Ae(this,Ma).call(this),this),ot(this,Ta,(t,r,i)=>{const s=t.createAndFill(r,i,Ae(this,sr));if(!s)throw zF(t,r,i);return this.push(s),s}),this.addNode=(t,r,i)=>(Ae(this,Ta).call(this,t,r,i),this),this.openMark=(t,r)=>{const i=t.create(r);return ot(this,sr,i.addToSet(Ae(this,sr))),this},this.closeMark=t=>(ot(this,sr,t.removeFromSet(Ae(this,sr))),this),this.addText=t=>{const r=this.top();if(!r)throw Xk();const i=r.pop(),s=this.schema.text(t,Ae(this,sr));if(!i)return r.push(s),this;const o=Ae(this,Xc).call(this,i,s);return o?(r.push(o),this):(r.push(i,s),this)},this.build=()=>{let t;do t=Ae(this,Ma).call(this);while(this.size());return t},this.next=(t=[])=>([t].flat().forEach(r=>Ae(this,Zc).call(this,r)),this),this.toDoc=()=>this.build(),this.run=(t,r)=>{const i=t.runSync(t.parse(r),r);return this.next(i),this},this.schema=e}};sr=new WeakMap,Sa=new WeakMap,Xc=new WeakMap,Jc=new WeakMap,Zc=new WeakMap,Ma=new WeakMap,Ta=new WeakMap,vp.create=(n,e)=>{const t=new vp(n);return r=>(t.run(e,r),t.toDoc())};let QF=vp;const yp=class extends tx{constructor(e,t,r,i={}){super(),this.type=e,this.children=t,this.value=r,this.props=i,this.push=(s,...o)=>{this.children||(this.children=[]),this.children.push(s,...o)},this.pop=()=>{var s;return(s=this.children)==null?void 0:s.pop()}}};yp.create=(n,e,t,r={})=>new yp(n,e,t,r);let f0=yp;const eV=n=>Object.prototype.hasOwnProperty.call(n,"size");var Er,Oa,Qc,eu,$a,tu,Da,nu,so,Ea,ru,Aa;const bp=class extends nx{constructor(e){super(),Tt(this,Er,void 0),Tt(this,Oa,void 0),Tt(this,Qc,void 0),Tt(this,eu,void 0),Tt(this,$a,void 0),Tt(this,tu,void 0),Tt(this,Da,void 0),Tt(this,nu,void 0),Tt(this,so,void 0),Tt(this,Ea,void 0),Tt(this,ru,void 0),Tt(this,Aa,void 0),ot(this,Er,Pe.none),ot(this,Oa,t=>{const r=Object.values({...this.schema.nodes,...this.schema.marks}).find(i=>i.spec.toMarkdown.match(t));if(!r)throw FF(t.type);return r}),ot(this,Qc,t=>Ae(this,Oa).call(this,t).spec.toMarkdown.runner(this,t)),ot(this,eu,(t,r)=>Ae(this,Oa).call(this,t).spec.toMarkdown.runner(this,t,r)),ot(this,$a,t=>{const{marks:r}=t,i=s=>{var o;return(o=s.type.spec.priority)!=null?o:50};[...r].sort((s,o)=>i(s)-i(o)).every(s=>!Ae(this,eu).call(this,s,t))&&Ae(this,Qc).call(this,t),r.forEach(s=>Ae(this,Aa).call(this,s))}),ot(this,tu,(t,r)=>{var i;if(t.type===r||((i=t.children)==null?void 0:i.length)!==1)return t;const s=c=>{var u;if(c.type===r)return c;if(((u=c.children)==null?void 0:u.length)!==1)return null;const[d]=c.children;return d?s(d):null},o=s(t);if(!o)return t;const a=o.children?[...o.children]:void 0,l={...t,children:a};return l.children=a,o.children=[l],o}),ot(this,Da,t=>{const{children:r}=t;return r&&(t.children=r.reduce((i,s,o)=>{if(o===0)return[s];const a=i.at(-1);if(a&&a.isMark&&s.isMark){s=Ae(this,tu).call(this,s,a.type);const{children:l,...c}=s,{children:u,...d}=a;if(s.type===a.type&&l&&u&&JSON.stringify(c)===JSON.stringify(d)){const f={...d,children:[...u,...l]};return i.slice(0,-1).concat(Ae(this,Da).call(this,f))}}return i.concat(s)},[])),t}),ot(this,nu,t=>{const r={...t.props,type:t.type};return t.children&&(r.children=t.children),t.value&&(r.value=t.value),r}),this.openNode=(t,r,i)=>(this.open(f0.create(t,void 0,r,i)),this),ot(this,so,()=>{const t=this.close();return Ae(this,Ea).call(this,t.type,t.children,t.value,t.props)}),this.closeNode=()=>(Ae(this,so).call(this),this),ot(this,Ea,(t,r,i,s)=>{const o=f0.create(t,r,i,s),a=Ae(this,Da).call(this,Ae(this,nu).call(this,o));return this.push(a),a}),this.addNode=(t,r,i,s)=>(Ae(this,Ea).call(this,t,r,i,s),this),ot(this,ru,(t,r,i,s)=>t.isInSet(Ae(this,Er))?this:(ot(this,Er,t.addToSet(Ae(this,Er))),this.openNode(r,i,{...s,isMark:!0}))),ot(this,Aa,t=>{t.isInSet(Ae(this,Er))&&(ot(this,Er,t.type.removeFromSet(Ae(this,Er))),Ae(this,so).call(this))}),this.withMark=(t,r,i,s)=>(Ae(this,ru).call(this,t,r,i,s),this),this.closeMark=t=>(Ae(this,Aa).call(this,t),this),this.build=()=>{let t=null;do t=Ae(this,so).call(this);while(this.size());return t},this.next=t=>eV(t)?(t.forEach(r=>{Ae(this,$a).call(this,r)}),this):(Ae(this,$a).call(this,t),this),this.toString=t=>t.stringify(this.build()),this.run=t=>(this.next(t),this),this.schema=e}};Er=new WeakMap,Oa=new WeakMap,Qc=new WeakMap,eu=new WeakMap,$a=new WeakMap,tu=new WeakMap,Da=new WeakMap,nu=new WeakMap,so=new WeakMap,Ea=new WeakMap,ru=new WeakMap,Aa=new WeakMap,bp.create=(n,e)=>{const t=new bp(n);return r=>(t.run(r),t.toString(e))};let tV=bp;class Sn{constructor(e,t,r={}){this.match=e,this.match=e,this.handler=typeof t=="string"?nV(t):t,this.undoable=r.undoable!==!1}}function nV(n){return function(e,t,r,i){let s=n;if(t[1]){let o=t[0].lastIndexOf(t[1]);s+=t[0].slice(o+t[1].length),r+=o;let a=r-i;a>0&&(s=t[0].slice(o-a,o)+s,r=i)}return e.tr.insertText(s,r,i)}}const rV=(n,e)=>{let t=n.plugins;for(let r=0;r<t.length;r++){let i=t[r],s;if(i.spec.isInputRules&&(s=i.getState(n))){if(e){let o=n.tr,a=s.transform;for(let l=a.steps.length-1;l>=0;l--)o.step(a.steps[l].invert(a.docs[l]));if(s.text){let l=o.doc.resolve(s.from).marks();o.replaceWith(s.from,s.to,n.schema.text(s.text,l))}else o.delete(s.from,s.to);e(o)}return!0}}return!1};new Sn(/--$/,"—");new Sn(/\.\.\.$/,"…");new Sn(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“");new Sn(/"$/,"”");new Sn(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘");new Sn(/'$/,"’");function Im(n,e,t=null,r){return new Sn(n,(i,s,o,a)=>{let l=t instanceof Function?t(s):t,c=i.tr.delete(o,a),u=c.doc.resolve(o),d=u.blockRange(),f=d&&ik(d,e,l);if(!f)return null;c.wrap(d,f);let h=c.doc.resolve(o-1).nodeBefore;return h&&h.type==e&&Pd(c.doc,o-1)&&(!r||r(s,h))&&c.join(o-1),c})}function ix(n,e,t=null){return new Sn(n,(r,i,s,o)=>{let a=r.doc.resolve(s),l=t instanceof Function?t(i):t;return a.node(-1).canReplaceWith(a.index(-1),a.indexAfter(-1),e)?r.tr.delete(s,o).setBlockType(s,s,e,l):null})}const Ni=typeof navigator<"u"?navigator:null,h0=typeof document<"u"?document:null,Fi=Ni&&Ni.userAgent||"",wp=/Edge\/(\d+)/.exec(Fi),sx=/MSIE \d/.exec(Fi),_p=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Fi),Bd=!!(sx||_p||wp),iV=sx?document.documentMode:_p?+_p[1]:wp?+wp[1]:0,ox=!Bd&&/gecko\/(\d+)/i.test(Fi),sV=ox&&+(/Firefox\/(\d+)/.exec(Fi)||[0,0])[1],kp=!Bd&&/Chrome\/(\d+)/.exec(Fi),oV=!!kp,aV=kp?+kp[1]:0,ax=!Bd&&!!Ni&&/Apple Computer/.test(Ni.vendor),lx=ax&&(/Mobile\/\w+/.test(Fi)||!!Ni&&Ni.maxTouchPoints>2),lV=lx||(Ni?/Mac/.test(Ni.platform):!1),cV=/Android \d/.test(Fi),cx=!!h0&&"webkitFontSmoothing"in h0.documentElement.style,uV=cx?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;var p0=Object.freeze({__proto__:null,android:cV,chrome:oV,chrome_version:aV,gecko:ox,gecko_version:sV,ie:Bd,ie_version:iV,ios:lx,mac:lV,safari:ax,webkit:cx,webkit_version:uV});function Uf(n,e,t,r,i,s){if(n.composing)return!1;const o=n.state,a=o.doc.resolve(e);if(a.parent.type.spec.code)return!1;const l=a.parent.textBetween(Math.max(0,a.parentOffset-500),a.parentOffset,void 0,"￼")+r;for(let c=0;c<i.length;c++){const u=i[c].match.exec(l),d=u&&u[0]&&i[c].handler(o,u,e-(u[0].length-r.length),t);if(d)return n.dispatch(d.setMeta(s,{transform:d,from:e,to:t,text:r})),!0}return!1}const dV=new Bt("MILKDOWN_CUSTOM_INPUTRULES");function fV({rules:n}){const e=new Gt({key:dV,isInputRules:!0,state:{init(){return null},apply(t,r){const i=t.getMeta(this);return i||(t.selectionSet||t.docChanged?null:r)}},props:{handleTextInput(t,r,i,s){return Uf(t,r,i,s,n,e)},handleDOMEvents:{compositionend:t=>(setTimeout(()=>{const{$cursor:r}=t.state.selection;r&&Uf(t,r.pos,r.pos,"",n,e)}),!1)},handleKeyDown(t,r){if(r.key!=="Enter")return!1;const{$cursor:i}=t.state.selection;return i?Uf(t,i.pos,i.pos,"\n",n,e):!1}}});return e}function Ll(n,e,t={}){return new Sn(n,(r,i,s,o)=>{var a,l,c,u;const{tr:d}=r,f=i.length;let h=i[f-1],p=i[0],m=[],g=o;const w={group:h,fullMatch:p,start:s,end:o},x=(a=t.updateCaptured)==null?void 0:a.call(t,w);if(Object.assign(w,x),{group:h,fullMatch:p,start:s,end:o}=w,p===null||(h==null?void 0:h.trim())==="")return null;if(h){const M=p.search(/\S/),b=s+p.indexOf(h),C=b+h.length;m=(l=d.storedMarks)!=null?l:[],C<o&&d.delete(C,o),b>s&&d.delete(s+M,b),g=s+M+h.length;const k=(c=t.getAttr)==null?void 0:c.call(t,i);d.addMark(s,g,e.create(k)),d.setStoredMarks(m),(u=t.beforeDispatch)==null||u.call(t,{match:i,start:s,end:o,tr:d})}return d})}var hV=Object.defineProperty,pV=Object.defineProperties,mV=Object.getOwnPropertyDescriptors,m0=Object.getOwnPropertySymbols,gV=Object.prototype.hasOwnProperty,vV=Object.prototype.propertyIsEnumerable,g0=(n,e,t)=>e in n?hV(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,yV=(n,e)=>{for(var t in e||(e={}))gV.call(e,t)&&g0(n,t,e[t]);if(m0)for(var t of m0(e))vV.call(e,t)&&g0(n,t,e[t]);return n},bV=(n,e)=>pV(n,mV(e));function v0(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function zm(n,e,t){const i=n.state.doc.content.size,s=v0(e,0,i),o=v0(t,0,i),a=n.coordsAtPos(s),l=n.coordsAtPos(o,-1),c=Math.min(a.top,l.top),u=Math.max(a.bottom,l.bottom),d=Math.min(a.left,l.left),f=Math.max(a.right,l.right),h=f-d,p=u-c,w={top:c,bottom:u,left:d,right:f,width:h,height:p,x:d,y:c};return bV(yV({},w),{toJSON:()=>w})}function Fd(n){return Object.assign(Object.create(n),n).setTime(Date.now())}function wV(n,e){return Array.isArray(n)&&n.includes(e.type)||e.type===n}function _V(n){return e=>{for(let t=e.depth;t>0;t--){const r=e.node(t);if(n(r))return{pos:t>0?e.before(t):0,start:e.start(t),depth:t,node:r}}}}function kV(n){return e=>_V(n)(e.$from)}function xV(n,e){if(!(n instanceof ye))return;const{node:t,$from:r}=n;if(wV(e,t))return{node:t,pos:r.pos,start:r.start(r.depth),depth:r.depth}}const Bm=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function CV(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const ux=(n,e,t)=>{let r=CV(n,t);if(!r)return!1;let i=fx(r);if(!i){let o=r.blockRange(),a=o&&Ad(o);return a==null?!1:(e&&e(n.tr.lift(o,a).scrollIntoView()),!0)}let s=i.nodeBefore;if(!s.type.spec.isolating&&px(n,i,e))return!0;if(r.parent.content.size==0&&(Lo(s,"end")||ye.isSelectable(s))){let o=Cm(n.doc,r.before(),r.after(),J.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=n.tr.step(o);a.setSelection(Lo(s,"end")?we.findFrom(a.doc.resolve(a.mapping.map(i.pos,-1)),-1):ye.create(a.doc,i.pos-s.nodeSize)),e(a.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1};function Lo(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const dx=(n,e,t)=>{let{$head:r,empty:i}=n.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;s=fx(r)}let o=s&&s.nodeBefore;return!o||!ye.isSelectable(o)?!1:(e&&e(n.tr.setSelection(ye.create(n.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function fx(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function SV(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const MV=(n,e,t)=>{let r=SV(n,t);if(!r)return!1;let i=hx(r);if(!i)return!1;let s=i.nodeAfter;if(px(n,i,e))return!0;if(r.parent.content.size==0&&(Lo(s,"start")||ye.isSelectable(s))){let o=Cm(n.doc,r.before(),r.after(),J.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=n.tr.step(o);a.setSelection(Lo(s,"start")?we.findFrom(a.doc.resolve(a.mapping.map(i.pos)),1):ye.create(a.doc,a.mapping.map(i.pos))),e(a.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},TV=(n,e,t)=>{let{$head:r,empty:i}=n.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;s=hx(r)}let o=s&&s.nodeAfter;return!o||!ye.isSelectable(o)?!1:(e&&e(n.tr.setSelection(ye.create(n.doc,s.pos)).scrollIntoView()),!0)};function hx(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const OV=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText("\n").scrollIntoView()),!0)};function Fm(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const $V=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let i=t.node(-1),s=t.indexAfter(-1),o=Fm(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(e){let a=t.after(),l=n.tr.replaceWith(a,a,o.createAndFill());l.setSelection(we.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},DV=(n,e)=>{let t=n.selection,{$from:r,$to:i}=t;if(t instanceof kn||r.parent.inlineContent||i.parent.inlineContent)return!1;let s=Fm(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let o=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,a=n.tr.insert(o,s.createAndFill());a.setSelection(Me.create(a.doc,o+1)),e(a.scrollIntoView())}return!0},EV=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let s=t.before();if(Ya(n.doc,s))return e&&e(n.tr.split(s).scrollIntoView()),!0}let r=t.blockRange(),i=r&&Ad(r);return i==null?!1:(e&&e(n.tr.lift(r,i).scrollIntoView()),!0)};function AV(n){return(e,t)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof ye&&e.selection.node.isBlock)return!r.parentOffset||!Ya(e.doc,r.pos)?!1:(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.parent.isBlock)return!1;if(t){let s=i.parentOffset==i.parent.content.size,o=e.tr;(e.selection instanceof Me||e.selection instanceof kn)&&o.deleteSelection();let a=r.depth==0?null:Fm(r.node(-1).contentMatchAt(r.indexAfter(-1))),l=n&&n(i.parent,s),c=l?[l]:s&&a?[{type:a}]:void 0,u=Ya(o.doc,o.mapping.map(r.pos),1,c);if(!c&&!u&&Ya(o.doc,o.mapping.map(r.pos),1,a?[{type:a}]:void 0)&&(a&&(c=[{type:a}]),u=!0),u&&(o.split(o.mapping.map(r.pos),1,c),!s&&!r.parentOffset&&r.parent.type!=a)){let d=o.mapping.map(r.before()),f=o.doc.resolve(d);a&&r.node(-1).canReplaceWith(f.index(),f.index()+1,a)&&o.setNodeMarkup(o.mapping.map(r.before()),a)}t(o.scrollIntoView())}return!0}}const PV=AV(),NV=(n,e)=>(e&&e(n.tr.setSelection(new kn(n.doc))),!0);function RV(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,s=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(s-1,s)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(i.isTextblock||Pd(n.doc,e.pos))?!1:(t&&t(n.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),!0)}function px(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,s,o;if(r.type.spec.isolating||i.type.spec.isolating)return!1;if(RV(n,e,t))return!0;let a=e.parent.canReplace(e.index(),e.index()+1);if(a&&(s=(o=r.contentMatchAt(r.childCount)).findWrapping(i.type))&&o.matchType(s[0]||i.type).validEnd){if(t){let d=e.pos+i.nodeSize,f=q.empty;for(let m=s.length-1;m>=0;m--)f=q.from(s[m].create(null,f));f=q.from(r.copy(f));let h=n.tr.step(new qt(e.pos-1,d,e.pos,d,new J(f,1,0),s.length,!0)),p=d+2*s.length;Pd(h.doc,p)&&h.join(p),t(h.scrollIntoView())}return!0}let l=we.findFrom(e,1),c=l&&l.$from.blockRange(l.$to),u=c&&Ad(c);if(u!=null&&u>=e.depth)return t&&t(n.tr.lift(c,u).scrollIntoView()),!0;if(a&&Lo(i,"start",!0)&&Lo(r,"end")){let d=r,f=[];for(;f.push(d),!d.isTextblock;)d=d.lastChild;let h=i,p=1;for(;!h.isTextblock;h=h.firstChild)p++;if(d.canReplace(d.childCount,d.childCount,h.content)){if(t){let m=q.empty;for(let w=f.length-1;w>=0;w--)m=q.from(f[w].copy(m));let g=n.tr.step(new qt(e.pos-f.length,e.pos+i.nodeSize,e.pos+p,e.pos+i.nodeSize-p,new J(m,f.length,0),0,!0));t(g.scrollIntoView())}return!0}}return!1}function mx(n){return function(e,t){let r=e.selection,i=n<0?r.$from:r.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(t&&t(e.tr.setSelection(Me.create(e.doc,n<0?i.start(s):i.end(s)))),!0):!1}}const LV=mx(-1),IV=mx(1);function Vm(n,e=null){return function(t,r){let{$from:i,$to:s}=t.selection,o=i.blockRange(s),a=o&&ik(o,n,e);return a?(r&&r(t.tr.wrap(o,a).scrollIntoView()),!0):!1}}function wl(n,e=null){return function(t,r){let i=!1;for(let s=0;s<t.selection.ranges.length&&!i;s++){let{$from:{pos:o},$to:{pos:a}}=t.selection.ranges[s];t.doc.nodesBetween(o,a,(l,c)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)i=!0;else{let u=t.doc.resolve(c),d=u.index();i=u.parent.canReplaceWith(d,d+1,n)}})}if(!i)return!1;if(r){let s=t.tr;for(let o=0;o<t.selection.ranges.length;o++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[o];s.setBlockType(a,l,n,e)}r(s.scrollIntoView())}return!0}}function zV(n,e,t){for(let r=0;r<e.length;r++){let{$from:i,$to:s}=e[r],o=i.depth==0?n.inlineContent&&n.type.allowsMarkType(t):!1;if(n.nodesBetween(i.pos,s.pos,a=>{if(o)return!1;o=a.inlineContent&&a.type.allowsMarkType(t)}),o)return!0}return!1}function Vd(n,e=null){return function(t,r){let{empty:i,$cursor:s,ranges:o}=t.selection;if(i&&!s||!zV(t.doc,o,n))return!1;if(r)if(s)n.isInSet(t.storedMarks||s.marks())?r(t.tr.removeStoredMark(n)):r(t.tr.addStoredMark(n.create(e)));else{let a=!1,l=t.tr;for(let c=0;!a&&c<o.length;c++){let{$from:u,$to:d}=o[c];a=t.doc.rangeHasMark(u.pos,d.pos,n)}for(let c=0;c<o.length;c++){let{$from:u,$to:d}=o[c];if(a)l.removeMark(u.pos,d.pos,n);else{let f=u.pos,h=d.pos,p=u.nodeAfter,m=d.nodeBefore,g=p&&p.isText?/^\s*/.exec(p.text)[0].length:0,w=m&&m.isText?/\s*$/.exec(m.text)[0].length:0;f+g<h&&(f+=g,h-=w),l.addMark(f,h,n.create(e))}}r(l.scrollIntoView())}return!0}}function Hd(...n){return function(e,t,r){for(let i=0;i<n.length;i++)if(n[i](e,t,r))return!0;return!1}}let qf=Hd(Bm,ux,dx),y0=Hd(Bm,MV,TV);const Lr={Enter:Hd(OV,DV,EV,PV),"Mod-Enter":$V,Backspace:qf,"Mod-Backspace":qf,"Shift-Backspace":qf,Delete:y0,"Mod-Delete":y0,"Mod-a":NV},gx={"Ctrl-h":Lr.Backspace,"Alt-Backspace":Lr["Mod-Backspace"],"Ctrl-d":Lr.Delete,"Ctrl-Alt-Backspace":Lr["Mod-Delete"],"Alt-Delete":Lr["Mod-Delete"],"Alt-d":Lr["Mod-Delete"],"Ctrl-a":LV,"Ctrl-e":IV};for(let n in Lr)gx[n]=Lr[n];const BV=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1,FV=BV?gx:Lr;var Ri={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},id={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},VV=typeof navigator<"u"&&/Mac/.test(navigator.platform),HV=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var It=0;It<10;It++)Ri[48+It]=Ri[96+It]=String(It);for(var It=1;It<=24;It++)Ri[It+111]="F"+It;for(var It=65;It<=90;It++)Ri[It]=String.fromCharCode(It+32),id[It]=String.fromCharCode(It);for(var Yf in Ri)id.hasOwnProperty(Yf)||(id[Yf]=Ri[Yf]);function WV(n){var e=VV&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||HV&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?id:Ri)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const jV=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function UV(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,s,o;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))jV?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),o&&(t="Meta-"+t),s&&(t="Shift-"+t),t}function qV(n){let e=Object.create(null);for(let t in n)e[UV(t)]=n[t];return e}function Kf(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function vx(n){return new Gt({props:{handleKeyDown:yx(n)}})}function yx(n){let e=qV(n);return function(t,r){let i=WV(r),s,o=e[Kf(i,r)];if(o&&o(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let a=e[Kf(i,r,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(s=Ri[r.keyCode])&&s!=i){let a=e[Kf(s,r)];if(a&&a(t.state,t.dispatch,t))return!0}}return!1}}var bx=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},pe=(n,e,t)=>(bx(n,e,"read from private field"),t?t.call(n):e.get(n)),Nt=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},ct=(n,e,t,r)=>(bx(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t);function Vi(n,e){return n.meta={package:"@milkdown/core",group:"System",...e},n}const wx={strong:(n,e,t,r)=>{const i=n.marker||t.options.strong||"*",s=t.enter("strong"),o=t.createTracker(r);let a=o.move(i+i);return a+=o.move(t.containerPhrasing(n,{before:a,after:i,...o.current()})),a+=o.move(i+i),s(),a},emphasis:(n,e,t,r)=>{const i=n.marker||t.options.emphasis||"*",s=t.enter("emphasis"),o=t.createTracker(r);let a=o.move(i);return a+=o.move(t.containerPhrasing(n,{before:a,after:i,...o.current()})),a+=o.move(i),s(),a}},iu=Bi("ConfigReady");function YV(n){const e=t=>(t.record(iu),async()=>(await n(t),t.done(iu),()=>{t.clearTimer(iu)}));return Vi(e,{displayName:"Config"}),e}const Ss=Bi("InitReady"),Gf=We([],"initTimer"),b0=We({},"editor"),_l=We([],"inputRules"),_r=We([],"prosePlugins"),kl=We([],"remarkPlugins"),xp=We([],"nodeView"),Cp=We([],"markView"),Ms=We(gh().use(vh).use(yh),"remark"),Xa=We({handlers:wx},"remarkStringifyOptions");function KV(n){const e=t=>(t.inject(b0,n).inject(_r,[]).inject(kl,[]).inject(_l,[]).inject(xp,[]).inject(Cp,[]).inject(Xa,{handlers:wx}).inject(Ms,gh().use(vh).use(yh)).inject(Gf,[iu]).record(Ss),async()=>{await t.waitTimers(Gf);const r=t.get(Xa);return t.set(Ms,gh().use(vh).use(yh,r)),t.done(Ss),()=>{t.remove(b0).remove(_r).remove(kl).remove(_l).remove(xp).remove(Cp).remove(Xa).remove(Ms).remove(Gf).clearTimer(Ss)}});return Vi(e,{displayName:"Init"}),e}const gr=Bi("SchemaReady"),Xf=We([],"schemaTimer"),Ti=We({},"schema"),_o=We([],"nodes"),ko=We([],"marks");function w0(n){var e;return{...n,parseDOM:(e=n.parseDOM)==null?void 0:e.map(t=>({priority:n.priority,...t}))}}const _x=n=>(n.inject(Ti,{}).inject(_o,[]).inject(ko,[]).inject(Xf,[Ss]).record(gr),async()=>{await n.waitTimers(Xf);const e=n.get(Ms),t=n.get(kl).reduce((o,a)=>o.use(a.plugin,a.options),e);n.set(Ms,t);const r=Object.fromEntries(n.get(_o).map(([o,a])=>[o,w0(a)])),i=Object.fromEntries(n.get(ko).map(([o,a])=>[o,w0(a)])),s=new uz({nodes:r,marks:i});return n.set(Ti,s),n.done(gr),()=>{n.remove(Ti).remove(_o).remove(ko).remove(Xf).clearTimer(gr)}});Vi(_x,{displayName:"Schema"});const su=Bi("ParserReady"),kx=()=>{throw Lm()},ou=We(kx,"parser"),Jf=We([],"parserTimer"),xx=n=>(n.inject(ou,kx).inject(Jf,[gr]).record(su),async()=>{await n.waitTimers(Jf);const e=n.get(Ms),t=n.get(Ti);return n.set(ou,QF.create(t,e)),n.done(su),()=>{n.remove(ou).remove(Jf).clearTimer(su)}});Vi(xx,{displayName:"Parser"});const Ja=Bi("SerializerReady"),Zf=We([],"serializerTimer"),Cx=()=>{throw Lm()},au=We(Cx,"serializer"),Sx=n=>(n.inject(au,Cx).inject(Zf,[gr]).record(Ja),async()=>{await n.waitTimers(Zf);const e=n.get(Ms),t=n.get(Ti);return n.set(au,tV.create(t,e)),n.done(Ja),()=>{n.remove(au).remove(Zf).clearTimer(Ja)}});Vi(Sx,{displayName:"Serializer"});const lu=We("","defaultValue"),Pa=We({},"editorState"),Qf=We(n=>n,"stateOptions"),eh=We([],"editorStateTimer"),cu=Bi("EditorStateReady");function GV(n,e,t){if(typeof n=="string")return e(n);if(n.type==="html")return Eo.fromSchema(t).parse(n.dom);if(n.type==="json")return xi.fromJSON(t,n.value);throw RF(n)}const XV=new Bt("MILKDOWN_STATE_TRACKER");function JV(n){const e=Hd(rV,Bm,ux,dx);return n.Backspace=e,n}const Mx=n=>(n.inject(lu,"").inject(Pa,{}).inject(Qf,e=>e).inject(eh,[su,Ja,Za]).record(cu),async()=>{await n.waitTimers(eh);const e=n.get(Ti),t=n.get(ou),r=n.get(_l),i=n.get(Qf),s=n.get(_r),o=n.get(lu),a=GV(o,t,e),l=[...s,new Gt({key:XV,state:{init:()=>{},apply:(d,f,h,p)=>{n.set(Pa,p)}}}),fV({rules:r}),vx(JV(FV))];n.set(_r,l);const c=i({schema:e,doc:a,plugins:l}),u=po.create(c);return n.set(Pa,u),n.done(cu),()=>{n.remove(lu).remove(Pa).remove(Qf).remove(eh).clearTimer(cu)}});Vi(Mx,{displayName:"EditorState"});const uu=Bi("EditorViewReady"),xo=We({},"editorView"),th=We([],"editorViewTimer"),du=We({},"editorViewOptions"),fu=We(null,"root"),Sp=We(null,"rootDOM"),Mp=We({},"rootAttrs");function ZV(n,e){const t=document.createElement("div");t.className="milkdown",n.appendChild(t),e.set(Sp,t);const r=e.get(Mp);return Object.entries(r).forEach(([i,s])=>t.setAttribute(i,s)),t}function QV(n){n.classList.add("editor"),n.setAttribute("role","textbox")}const eH=new Bt("MILKDOWN_VIEW_CLEAR"),Tx=n=>(n.inject(fu,document.body).inject(xo,{}).inject(du,{}).inject(Sp,null).inject(Mp,{}).inject(th,[cu]).record(uu),async()=>{await n.wait(Ss);const e=n.get(fu)||document.body,t=typeof e=="string"?document.querySelector(e):e;n.update(_r,l=>[new Gt({key:eH,view:c=>{const u=t?ZV(t,n):void 0;return(()=>{if(u&&t){const d=c.dom;t.replaceChild(u,d),u.appendChild(d)}})(),{destroy:()=>{u!=null&&u.parentNode&&(u==null||u.parentNode.replaceChild(c.dom,u)),u==null||u.remove()}}}}),...l]),await n.waitTimers(th);const r=n.get(Pa),i=n.get(du),s=Object.fromEntries(n.get(xp)),o=Object.fromEntries(n.get(Cp)),a=new vF(t,{state:r,nodeViews:s,markViews:o,...i});return QV(a.dom),n.set(xo,a),n.done(uu),()=>{a==null||a.destroy(),n.remove(fu).remove(xo).remove(du).remove(Sp).remove(Mp).remove(th).clearTimer(uu)}});Vi(Tx,{displayName:"EditorView"});var oo,is;let Ox=class{constructor(){Nt(this,oo,void 0),Nt(this,is,void 0),ct(this,oo,new Zk),ct(this,is,null),this.setCtx=e=>{ct(this,is,e)}}get ctx(){return pe(this,is)}create(e,t){const r=e.create(pe(this,oo).sliceMap);return r.set(t),r}get(e){return pe(this,oo).get(e).get()}remove(e){return pe(this,oo).remove(e)}call(e,t){if(pe(this,is)==null)throw VF();const r=this.get(e)(t),i=pe(this,is).get(xo);return r(i.state,i.dispatch,i)}};oo=new WeakMap,is=new WeakMap;function tH(n="cmdKey"){return We(()=>()=>!1,n)}const xe=We(new Ox,"commands"),nh=We([gr],"commandsTimer"),Za=Bi("CommandsReady"),$x=n=>{const e=new Ox;return e.setCtx(n),n.inject(xe,e).inject(nh,[gr]).record(Za),async()=>(await n.waitTimers(nh),n.done(Za),()=>{n.remove(xe).remove(nh).clearTimer(Za)})};Vi($x,{displayName:"Commands"});var ao,On,oi,Na,hu,pu,pn,ai,lo,mu,co,Ra,gu,ss,La;const nH=class Dx{constructor(){Nt(this,ao,void 0),Nt(this,On,void 0),Nt(this,oi,void 0),Nt(this,Na,void 0),Nt(this,hu,void 0),Nt(this,pu,void 0),Nt(this,pn,void 0),Nt(this,ai,void 0),Nt(this,lo,void 0),Nt(this,mu,void 0),Nt(this,co,void 0),Nt(this,Ra,void 0),Nt(this,gu,void 0),Nt(this,ss,void 0),Nt(this,La,void 0),ct(this,ao,!1),ct(this,On,"Idle"),ct(this,oi,[]),ct(this,Na,()=>{}),ct(this,hu,new Zk),ct(this,pu,new GF),ct(this,pn,new Map),ct(this,ai,new Map),ct(this,lo,new KF(pe(this,hu),pe(this,pu))),ct(this,mu,()=>{const e=YV(async r=>{await Promise.all(pe(this,oi).map(i=>i(r)))}),t=[_x,xx,Sx,$x,Mx,Tx,KV(this),e];pe(this,co).call(this,t,pe(this,ai))}),ct(this,co,(e,t)=>{e.forEach(r=>{const i=pe(this,lo).produce(pe(this,ao)?r.meta:void 0),s=r(i);t.set(r,{ctx:i,handler:s,cleanup:void 0})})}),ct(this,Ra,(e,t=!1)=>Promise.all([e].flat().map(r=>{const i=pe(this,pn).get(r),s=i==null?void 0:i.cleanup;return t?pe(this,pn).delete(r):pe(this,pn).set(r,{ctx:void 0,handler:void 0,cleanup:void 0}),typeof s=="function"?s():s}))),ct(this,gu,async()=>{await Promise.all([...pe(this,ai).entries()].map(([e,{cleanup:t}])=>typeof t=="function"?t():t)),pe(this,ai).clear()}),ct(this,ss,e=>{ct(this,On,e),pe(this,Na).call(this,e)}),ct(this,La,e=>[...e.entries()].map(async([t,r])=>{const{ctx:i,handler:s}=r;if(!s)return;const o=await s();e.set(t,{ctx:i,handler:s,cleanup:o})})),this.enableInspector=(e=!0)=>(ct(this,ao,e),this),this.onStatusChange=e=>(ct(this,Na,e),this),this.config=e=>(pe(this,oi).push(e),this),this.removeConfig=e=>(ct(this,oi,pe(this,oi).filter(t=>t!==e)),this),this.use=e=>{const t=[e].flat();return t.flat().forEach(r=>{pe(this,pn).set(r,{ctx:void 0,handler:void 0,cleanup:void 0})}),pe(this,On)==="Created"&&pe(this,co).call(this,t,pe(this,pn)),this},this.remove=async e=>pe(this,On)==="OnCreate"?(console.warn("[Milkdown]: You are trying to remove plugins when the editor is creating, this is not recommended, please check your code."),new Promise(t=>{setTimeout(()=>{t(this.remove(e))},50)})):(await pe(this,Ra).call(this,[e].flat(),!0),this),this.create=async()=>pe(this,On)==="OnCreate"?this:(pe(this,On)==="Created"&&await this.destroy(),pe(this,ss).call(this,"OnCreate"),pe(this,mu).call(this),pe(this,co).call(this,[...pe(this,pn).keys()],pe(this,pn)),await Promise.all([pe(this,La).call(this,pe(this,ai)),pe(this,La).call(this,pe(this,pn))].flat()),pe(this,ss).call(this,"Created"),this),this.destroy=async(e=!1)=>pe(this,On)==="Destroyed"||pe(this,On)==="OnDestroy"?this:pe(this,On)==="OnCreate"?new Promise(t=>{setTimeout(()=>{t(this.destroy(e))},50)}):(e&&ct(this,oi,[]),pe(this,ss).call(this,"OnDestroy"),await pe(this,Ra).call(this,[...pe(this,pn).keys()],e),await pe(this,gu).call(this),pe(this,ss).call(this,"Destroyed"),this),this.action=e=>e(pe(this,lo)),this.inspect=()=>pe(this,ao)?[...pe(this,ai).values(),...pe(this,pn).values()].map(({ctx:e})=>{var t;return(t=e==null?void 0:e.inspector)==null?void 0:t.read()}).filter(e=>!!e):(console.warn("[Milkdown]: You are trying to collect inspection when inspector is disabled, please enable inspector by `editor.enableInspector()` first."),[])}static make(){return new Dx}get ctx(){return pe(this,lo)}get status(){return pe(this,On)}};ao=new WeakMap,On=new WeakMap,oi=new WeakMap,Na=new WeakMap,hu=new WeakMap,pu=new WeakMap,pn=new WeakMap,ai=new WeakMap,lo=new WeakMap,mu=new WeakMap,co=new WeakMap,Ra=new WeakMap,gu=new WeakMap,ss=new WeakMap,La=new WeakMap;let rH=nH;var sd=200,Pt=function(){};Pt.prototype.append=function(e){return e.length?(e=Pt.from(e),!this.length&&e||e.length<sd&&this.leafAppend(e)||this.length<sd&&e.leafPrepend(this)||this.appendInner(e)):this};Pt.prototype.prepend=function(e){return e.length?Pt.from(e).append(this):this};Pt.prototype.appendInner=function(e){return new iH(this,e)};Pt.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?Pt.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};Pt.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Pt.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};Pt.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(s,o){return i.push(e(s,o))},t,r),i};Pt.from=function(e){return e instanceof Pt?e:e&&e.length?new Ex(e):Pt.empty};var Ex=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,s){return i==0&&s==this.length?this:new e(this.values.slice(i,s))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,s,o,a){for(var l=s;l<o;l++)if(i(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(i,s,o,a){for(var l=s-1;l>=o;l--)if(i(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=sd)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=sd)return new e(i.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(Pt);Pt.empty=new Ex([]);var iH=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,s,o){var a=this.left.length;if(i<a&&this.left.forEachInner(r,i,Math.min(s,a),o)===!1||s>a&&this.right.forEachInner(r,Math.max(i-a,0),Math.min(this.length,s)-a,o+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,s,o){var a=this.left.length;if(i>a&&this.right.forEachInvertedInner(r,i-a,Math.max(s,a)-a,o+a)===!1||s<a&&this.left.forEachInvertedInner(r,Math.min(i,a),s,o)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var s=this.left.length;return i<=s?this.left.slice(r,i):r>=s?this.right.slice(r-s,i-s):this.left.slice(r,s).append(this.right.slice(0,i-s))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(Pt);const sH=500;class qn{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,s;t&&(i=this.remapping(r,this.items.length),s=i.maps.length);let o=e.tr,a,l,c=[],u=[];return this.items.forEach((d,f)=>{if(!d.step){i||(i=this.remapping(r,f+1),s=i.maps.length),s--,u.push(d);return}if(i){u.push(new ar(d.map));let h=d.step.map(i.slice(s)),p;h&&o.maybeStep(h).doc&&(p=o.mapping.maps[o.mapping.maps.length-1],c.push(new ar(p,void 0,void 0,c.length+u.length))),s--,p&&i.appendMap(p,s)}else o.maybeStep(d.step);if(d.selection)return a=i?d.selection.map(i.slice(s)):d.selection,l=new qn(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:o,selection:a}}addTransform(e,t,r,i){let s=[],o=this.eventCount,a=this.items,l=!i&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let d=e.steps[u].invert(e.docs[u]),f=new ar(e.mapping.maps[u],d,t),h;(h=l&&l.merge(f))&&(f=h,u?s.pop():a=a.slice(0,a.length-1)),s.push(f),t&&(o++,t=void 0),i||(l=f)}let c=o-r.depth;return c>aH&&(a=oH(a,c),o-=c),new qn(a.append(s),o)}remapping(e,t){let r=new yo;return this.items.forEach((i,s)=>{let o=i.mirrorOffset!=null&&s-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,o)},e,t),r}addMaps(e){return this.eventCount==0?this:new qn(this.items.append(e.map(t=>new ar(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-t),s=e.mapping,o=e.steps.length,a=this.eventCount;this.items.forEach(f=>{f.selection&&a--},i);let l=t;this.items.forEach(f=>{let h=s.getMirror(--l);if(h==null)return;o=Math.min(o,h);let p=s.maps[h];if(f.step){let m=e.steps[h].invert(e.docs[h]),g=f.selection&&f.selection.map(s.slice(l+1,h));g&&a++,r.push(new ar(p,m,g))}else r.push(new ar(p))},i);let c=[];for(let f=t;f<o;f++)c.push(new ar(s.maps[f]));let u=this.items.slice(0,i).append(c).append(r),d=new qn(u,a);return d.emptyItemCount()>sH&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,i=[],s=0;return this.items.forEach((o,a)=>{if(a>=e)i.push(o),o.selection&&s++;else if(o.step){let l=o.step.map(t.slice(r)),c=l&&l.getMap();if(r--,c&&t.appendMap(c,r),l){let u=o.selection&&o.selection.map(t.slice(r));u&&s++;let d=new ar(c.invert(),l,u),f,h=i.length-1;(f=i.length&&i[h].merge(d))?i[h]=f:i.push(d)}}else o.map&&r--},this.items.length,0),new qn(Pt.from(i.reverse()),s)}}qn.empty=new qn(Pt.empty,0);function oH(n,e){let t;return n.forEach((r,i)=>{if(r.selection&&e--==0)return t=i,!1}),n.slice(t)}class ar{constructor(e,t,r,i){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new ar(t.getMap().invert(),t,this.selection)}}}class ui{constructor(e,t,r,i,s){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=i,this.prevComposition=s}}const aH=20;function lH(n,e,t,r){let i=t.getMeta(Oi),s;if(i)return i.historyState;t.getMeta(uH)&&(n=new ui(n.done,n.undone,null,0,-1));let o=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(o&&o.getMeta(Oi))return o.getMeta(Oi).redo?new ui(n.done.addTransform(t,void 0,r,vu(e)),n.undone,_0(t.mapping.maps[t.steps.length-1]),n.prevTime,n.prevComposition):new ui(n.done,n.undone.addTransform(t,void 0,r,vu(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let a=t.getMeta("composition"),l=n.prevTime==0||!o&&n.prevComposition!=a&&(n.prevTime<(t.time||0)-r.newGroupDelay||!cH(t,n.prevRanges)),c=o?rh(n.prevRanges,t.mapping):_0(t.mapping.maps[t.steps.length-1]);return new ui(n.done.addTransform(t,l?e.selection.getBookmark():void 0,r,vu(e)),qn.empty,c,t.time,a==null?n.prevComposition:a)}else return(s=t.getMeta("rebased"))?new ui(n.done.rebased(t,s),n.undone.rebased(t,s),rh(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new ui(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),rh(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function cH(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,i)=>{for(let s=0;s<e.length;s+=2)r<=e[s+1]&&i>=e[s]&&(t=!0)}),t}function _0(n){let e=[];return n.forEach((t,r,i,s)=>e.push(i,s)),e}function rh(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let i=e.map(n[r],1),s=e.map(n[r+1],-1);i<=s&&t.push(i,s)}return t}function Ax(n,e,t,r){let i=vu(e),s=Oi.get(e).spec.config,o=(r?n.undone:n.done).popEvent(e,i);if(!o)return;let a=o.selection.resolve(o.transform.doc),l=(r?n.done:n.undone).addTransform(o.transform,e.selection.getBookmark(),s,i),c=new ui(r?l:o.remaining,r?o.remaining:l,null,0,-1);t(o.transform.setSelection(a).setMeta(Oi,{redo:r,historyState:c}).scrollIntoView())}let ih=!1,k0=null;function vu(n){let e=n.plugins;if(k0!=e){ih=!1,k0=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){ih=!0;break}}return ih}const Oi=new Bt("history"),uH=new Bt("closeHistory");function dH(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new Gt({key:Oi,state:{init(){return new ui(qn.empty,qn.empty,null,0,-1)},apply(e,t,r){return lH(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,i=r=="historyUndo"?Px:r=="historyRedo"?Nx:null;return i?(t.preventDefault(),i(e.state,e.dispatch)):!1}}}})}const Px=(n,e)=>{let t=Oi.getState(n);return!t||t.done.eventCount==0?!1:(e&&Ax(t,n,e,!1),!0)},Nx=(n,e)=>{let t=Oi.getState(n);return!t||t.undone.eventCount==0?!1:(e&&Ax(t,n,e,!0),!0)};let fH=n=>crypto.getRandomValues(new Uint8Array(n)),hH=(n,e,t)=>{let r=(2<<Math.log(n.length-1)/Math.LN2)-1,i=-~(1.6*r*e/n.length);return(s=e)=>{let o="";for(;;){let a=t(i),l=i;for(;l--;)if(o+=n[a[l]&r]||"",o.length===s)return o}}},pH=(n,e=21)=>hH(n,e,fH);pH("abcedfghicklmn",10);function Oe(n,e){const t=tH(n),r=i=>async()=>{r.key=t,await i.wait(Za);const s=e(i);return i.get(xe).create(t,s),r.run=o=>i.get(xe).call(n,o),()=>{i.get(xe).remove(t)}};return r}function dn(n){const e=t=>async()=>{await t.wait(gr);const r=n(t);return t.update(_l,i=>[...i,r]),e.inputRule=r,()=>{t.update(_l,i=>i.filter(s=>s!==r))}};return e}function mH(n,e){const t=r=>async()=>{const i=e(r);return r.update(ko,s=>[...s.filter(o=>o[0]!==n),[n,i]]),t.id=n,t.schema=i,()=>{r.update(ko,s=>s.filter(([o])=>o!==n))}};return t.type=r=>{const i=r.get(Ti).marks[n];if(!i)throw WF(n);return i},t}function Hm(n,e){const t=r=>async()=>{const i=e(r);return r.update(_o,s=>[...s.filter(o=>o[0]!==n),[n,i]]),t.id=n,t.schema=i,()=>{r.update(_o,s=>s.filter(([o])=>o!==n))}};return t.type=r=>{const i=r.get(Ti).nodes[n];if(!i)throw HF(n);return i},t}function Vn(n){let e;const t=r=>async()=>(await r.wait(gr),e=n(r),r.update(_r,i=>[...i,e]),()=>{r.update(_r,i=>i.filter(s=>s!==e))});return t.plugin=()=>e,t.key=()=>e.spec.key,t}function gH(n){const e=t=>async()=>{await t.wait(gr);const r=n(t),i=vx(r);return t.update(_r,s=>[...s,i]),e.keymap=r,()=>{t.update(_r,s=>s.filter(o=>o!==i))}};return e}function fn(n,e){const t=We(n,e),r=i=>(i.inject(t),()=>()=>{i.remove(t)});return r.key=t,r}function Ft(n,e){const t=fn(e,n),r=Hm(n,s=>s.get(t.key)(s)),i=[t,r];return i.id=r.id,i.node=r,i.type=s=>r.type(s),i.schema=r.schema,i.ctx=t,i.key=t.key,i.extendSchema=s=>o=>()=>{const a=o.get(t.key),l=s(a)(o);o.update(_o,c=>[...c.filter(u=>u[0]!==n),[n,l]]),i.schema=l},i}function Il(n,e){const t=fn(e,n),r=mH(n,s=>s.get(t.key)(s)),i=[t,r];return i.id=r.id,i.mark=r,i.type=r.type,i.schema=r.schema,i.ctx=t,i.key=t.key,i.extendSchema=s=>o=>()=>{const a=o.get(t.key),l=s(a)(o);o.update(ko,c=>[...c.filter(u=>u[0]!==n),[n,l]]),i.schema=l},i}function hn(n,e){const t=Object.fromEntries(Object.entries(e).map(([o,{shortcuts:a}])=>[o,a])),r=fn(t,"".concat(n,"Keymap")),i=gH(o=>{const a=o.get(r.key),l=Object.entries(e).flatMap(([c,{command:u}])=>[a[c]].flat().map(d=>[d,u(o)]));return Object.fromEntries(l)}),s=[r,i];return s.ctx=r,s.shortcuts=i,s.key=r.key,s.keymap=i.keymap,s}const Zn=(n,e=()=>({}))=>fn(e,"".concat(n,"Attr")),zl=(n,e=()=>({}))=>fn(e,"".concat(n,"Attr"));function qo(n,e,t){const r=fn(t!=null?t:{},n),i=o=>async()=>{await o.wait(Ss);const a={plugin:e(o),options:o.get(r.key)};return o.update(kl,l=>[...l,a]),()=>{o.update(kl,l=>l.filter(c=>c!==a))}},s=[r,i];return s.id=n,s.plugin=i,s.options=r,s}function vH(n,e){return t=>t.get(xe).call(n,e)}function Yo(n,e){return Object.assign(n,{meta:{package:"@milkdown/plugin-history",...e}}),n}const Wd=Oe("Undo",()=>()=>Px);Yo(Wd,{displayName:"Command<undo>"});const jd=Oe("Redo",()=>()=>Nx);Yo(jd,{displayName:"Command<redo>"});const Wm=fn({},"historyProviderConfig");Yo(Wm,{displayName:"Ctx<historyProviderConfig>"});const Rx=Vn(n=>dH(n.get(Wm.key)));Yo(Rx,{displayName:"Ctx<historyProviderPlugin>"});const jm=hn("historyKeymap",{Undo:{shortcuts:"Mod-z",command:n=>{const e=n.get(xe);return()=>e.call(Wd.key)}},Redo:{shortcuts:["Mod-y","Shift-Mod-z"],command:n=>{const e=n.get(xe);return()=>e.call(jd.key)}}});Yo(jm.ctx,{displayName:"KeymapCtx<history>"});Yo(jm.shortcuts,{displayName:"Keymap<history>"});const yH=[Wm,Rx,jm,Wd,jd].flat();var bH="Expected a function",x0=0/0,wH="[object Symbol]",_H=/^\s+|\s+$/g,kH=/^[-+]0x[0-9a-f]+$/i,xH=/^0b[01]+$/i,CH=/^0o[0-7]+$/i,SH=parseInt,MH=typeof ua=="object"&&ua&&ua.Object===Object&&ua,TH=typeof self=="object"&&self&&self.Object===Object&&self,OH=MH||TH||Function("return this")(),$H=Object.prototype,DH=$H.toString,EH=Math.max,AH=Math.min,sh=function(){return OH.Date.now()};function PH(n,e,t){var r,i,s,o,a,l,c=0,u=!1,d=!1,f=!0;if(typeof n!="function")throw new TypeError(bH);e=C0(e)||0,Tp(t)&&(u=!!t.leading,d="maxWait"in t,s=d?EH(C0(t.maxWait)||0,e):s,f="trailing"in t?!!t.trailing:f);function h(k){var $=r,O=i;return r=i=void 0,c=k,o=n.apply(O,$),o}function p(k){return c=k,a=setTimeout(w,e),u?h(k):o}function m(k){var $=k-l,O=k-c,D=e-$;return d?AH(D,s-O):D}function g(k){var $=k-l,O=k-c;return l===void 0||$>=e||$<0||d&&O>=s}function w(){var k=sh();if(g(k))return x(k);a=setTimeout(w,m(k))}function x(k){return a=void 0,f&&r?h(k):(r=i=void 0,o)}function M(){a!==void 0&&clearTimeout(a),c=0,r=l=i=a=void 0}function b(){return a===void 0?o:x(sh())}function C(){var k=sh(),$=g(k);if(r=arguments,i=this,l=k,$){if(a===void 0)return p(l);if(d)return a=setTimeout(w,e),h(l)}return a===void 0&&(a=setTimeout(w,e)),o}return C.cancel=M,C.flush=b,C}function Tp(n){var e=typeof n;return!!n&&(e=="object"||e=="function")}function NH(n){return!!n&&typeof n=="object"}function RH(n){return typeof n=="symbol"||NH(n)&&DH.call(n)==wH}function C0(n){if(typeof n=="number")return n;if(RH(n))return x0;if(Tp(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=Tp(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=n.replace(_H,"");var t=xH.test(n);return t||CH.test(n)?SH(n.slice(2),t?2:8):kH.test(n)?x0:+n}var LH=PH;const Lx=pb(LH);let Ix=class{constructor(){this.beforeMountedListeners=[],this.mountedListeners=[],this.updatedListeners=[],this.markdownUpdatedListeners=[],this.blurListeners=[],this.focusListeners=[],this.destroyListeners=[],this.beforeMount=e=>(this.beforeMountedListeners.push(e),this),this.mounted=e=>(this.mountedListeners.push(e),this),this.updated=e=>(this.updatedListeners.push(e),this)}get listeners(){return{beforeMount:this.beforeMountedListeners,mounted:this.mountedListeners,updated:this.updatedListeners,markdownUpdated:this.markdownUpdatedListeners,blur:this.blurListeners,focus:this.focusListeners,destroy:this.destroyListeners}}markdownUpdated(e){return this.markdownUpdatedListeners.push(e),this}blur(e){return this.blurListeners.push(e),this}focus(e){return this.focusListeners.push(e),this}destroy(e){return this.destroyListeners.push(e),this}};const od=We(new Ix,"listener"),IH=new Bt("MILKDOWN_LISTENER"),zx=n=>(n.inject(od,new Ix),async()=>{await n.wait(Ss);const e=n.get(od),{listeners:t}=e;t.beforeMount.forEach(a=>a(n)),await n.wait(Ja);const r=n.get(au);let i=null,s=null;const o=new Gt({key:IH,view:()=>({destroy:()=>{t.destroy.forEach(a=>a(n))}}),props:{handleDOMEvents:{focus:()=>(t.focus.forEach(a=>a(n)),!1),blur:()=>(t.blur.forEach(a=>a(n)),!1)}},state:{init:()=>{},apply:a=>!a.docChanged||a.getMeta("addToHistory")===!1?void 0:Lx(()=>{const{doc:l}=a;if(t.updated.length>0&&(i==null||!i.eq(l))&&t.updated.forEach(c=>{c(n,l,i)}),t.markdownUpdated.length>0&&(i==null||!i.eq(l))){const c=r(l);t.markdownUpdated.forEach(u=>{u(n,c,s)}),s=c}i=l},200)()}});n.update(_r,a=>a.concat(o)),await n.wait(uu),t.mounted.forEach(a=>a(n))});zx.meta={package:"@milkdown/plugin-listener",displayName:"Listener"};function Bx(n){if(typeof n!="string")throw new TypeError("Expected a string");return n.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function zH(n){if(typeof n!="string")throw new TypeError("Expected a string");return n.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}const BH=[["ß","ss"],["ẞ","Ss"],["ä","ae"],["Ä","Ae"],["ö","oe"],["Ö","Oe"],["ü","ue"],["Ü","Ue"],["À","A"],["Á","A"],["Â","A"],["Ã","A"],["Ä","Ae"],["Å","A"],["Æ","AE"],["Ç","C"],["È","E"],["É","E"],["Ê","E"],["Ë","E"],["Ì","I"],["Í","I"],["Î","I"],["Ï","I"],["Ð","D"],["Ñ","N"],["Ò","O"],["Ó","O"],["Ô","O"],["Õ","O"],["Ö","Oe"],["Ő","O"],["Ø","O"],["Ù","U"],["Ú","U"],["Û","U"],["Ü","Ue"],["Ű","U"],["Ý","Y"],["Þ","TH"],["ß","ss"],["à","a"],["á","a"],["â","a"],["ã","a"],["ä","ae"],["å","a"],["æ","ae"],["ç","c"],["è","e"],["é","e"],["ê","e"],["ë","e"],["ì","i"],["í","i"],["î","i"],["ï","i"],["ð","d"],["ñ","n"],["ò","o"],["ó","o"],["ô","o"],["õ","o"],["ö","oe"],["ő","o"],["ø","o"],["ù","u"],["ú","u"],["û","u"],["ü","ue"],["ű","u"],["ý","y"],["þ","th"],["ÿ","y"],["ẞ","SS"],["à","a"],["À","A"],["á","a"],["Á","A"],["â","a"],["Â","A"],["ã","a"],["Ã","A"],["è","e"],["È","E"],["é","e"],["É","E"],["ê","e"],["Ê","E"],["ì","i"],["Ì","I"],["í","i"],["Í","I"],["ò","o"],["Ò","O"],["ó","o"],["Ó","O"],["ô","o"],["Ô","O"],["õ","o"],["Õ","O"],["ù","u"],["Ù","U"],["ú","u"],["Ú","U"],["ý","y"],["Ý","Y"],["ă","a"],["Ă","A"],["Đ","D"],["đ","d"],["ĩ","i"],["Ĩ","I"],["ũ","u"],["Ũ","U"],["ơ","o"],["Ơ","O"],["ư","u"],["Ư","U"],["ạ","a"],["Ạ","A"],["ả","a"],["Ả","A"],["ấ","a"],["Ấ","A"],["ầ","a"],["Ầ","A"],["ẩ","a"],["Ẩ","A"],["ẫ","a"],["Ẫ","A"],["ậ","a"],["Ậ","A"],["ắ","a"],["Ắ","A"],["ằ","a"],["Ằ","A"],["ẳ","a"],["Ẳ","A"],["ẵ","a"],["Ẵ","A"],["ặ","a"],["Ặ","A"],["ẹ","e"],["Ẹ","E"],["ẻ","e"],["Ẻ","E"],["ẽ","e"],["Ẽ","E"],["ế","e"],["Ế","E"],["ề","e"],["Ề","E"],["ể","e"],["Ể","E"],["ễ","e"],["Ễ","E"],["ệ","e"],["Ệ","E"],["ỉ","i"],["Ỉ","I"],["ị","i"],["Ị","I"],["ọ","o"],["Ọ","O"],["ỏ","o"],["Ỏ","O"],["ố","o"],["Ố","O"],["ồ","o"],["Ồ","O"],["ổ","o"],["Ổ","O"],["ỗ","o"],["Ỗ","O"],["ộ","o"],["Ộ","O"],["ớ","o"],["Ớ","O"],["ờ","o"],["Ờ","O"],["ở","o"],["Ở","O"],["ỡ","o"],["Ỡ","O"],["ợ","o"],["Ợ","O"],["ụ","u"],["Ụ","U"],["ủ","u"],["Ủ","U"],["ứ","u"],["Ứ","U"],["ừ","u"],["Ừ","U"],["ử","u"],["Ử","U"],["ữ","u"],["Ữ","U"],["ự","u"],["Ự","U"],["ỳ","y"],["Ỳ","Y"],["ỵ","y"],["Ỵ","Y"],["ỷ","y"],["Ỷ","Y"],["ỹ","y"],["Ỹ","Y"],["ء","e"],["آ","a"],["أ","a"],["ؤ","w"],["إ","i"],["ئ","y"],["ا","a"],["ب","b"],["ة","t"],["ت","t"],["ث","th"],["ج","j"],["ح","h"],["خ","kh"],["د","d"],["ذ","dh"],["ر","r"],["ز","z"],["س","s"],["ش","sh"],["ص","s"],["ض","d"],["ط","t"],["ظ","z"],["ع","e"],["غ","gh"],["ـ","_"],["ف","f"],["ق","q"],["ك","k"],["ل","l"],["م","m"],["ن","n"],["ه","h"],["و","w"],["ى","a"],["ي","y"],["َ‎","a"],["ُ","u"],["ِ‎","i"],["٠","0"],["١","1"],["٢","2"],["٣","3"],["٤","4"],["٥","5"],["٦","6"],["٧","7"],["٨","8"],["٩","9"],["چ","ch"],["ک","k"],["گ","g"],["پ","p"],["ژ","zh"],["ی","y"],["۰","0"],["۱","1"],["۲","2"],["۳","3"],["۴","4"],["۵","5"],["۶","6"],["۷","7"],["۸","8"],["۹","9"],["ټ","p"],["ځ","z"],["څ","c"],["ډ","d"],["ﺫ","d"],["ﺭ","r"],["ړ","r"],["ﺯ","z"],["ږ","g"],["ښ","x"],["ګ","g"],["ڼ","n"],["ۀ","e"],["ې","e"],["ۍ","ai"],["ٹ","t"],["ڈ","d"],["ڑ","r"],["ں","n"],["ہ","h"],["ھ","h"],["ے","e"],["А","A"],["а","a"],["Б","B"],["б","b"],["В","V"],["в","v"],["Г","G"],["г","g"],["Д","D"],["д","d"],["ъе","ye"],["Ъе","Ye"],["ъЕ","yE"],["ЪЕ","YE"],["Е","E"],["е","e"],["Ё","Yo"],["ё","yo"],["Ж","Zh"],["ж","zh"],["З","Z"],["з","z"],["И","I"],["и","i"],["ый","iy"],["Ый","Iy"],["ЫЙ","IY"],["ыЙ","iY"],["Й","Y"],["й","y"],["К","K"],["к","k"],["Л","L"],["л","l"],["М","M"],["м","m"],["Н","N"],["н","n"],["О","O"],["о","o"],["П","P"],["п","p"],["Р","R"],["р","r"],["С","S"],["с","s"],["Т","T"],["т","t"],["У","U"],["у","u"],["Ф","F"],["ф","f"],["Х","Kh"],["х","kh"],["Ц","Ts"],["ц","ts"],["Ч","Ch"],["ч","ch"],["Ш","Sh"],["ш","sh"],["Щ","Sch"],["щ","sch"],["Ъ",""],["ъ",""],["Ы","Y"],["ы","y"],["Ь",""],["ь",""],["Э","E"],["э","e"],["Ю","Yu"],["ю","yu"],["Я","Ya"],["я","ya"],["ă","a"],["Ă","A"],["ș","s"],["Ș","S"],["ț","t"],["Ț","T"],["ţ","t"],["Ţ","T"],["ş","s"],["Ş","S"],["ç","c"],["Ç","C"],["ğ","g"],["Ğ","G"],["ı","i"],["İ","I"],["ա","a"],["Ա","A"],["բ","b"],["Բ","B"],["գ","g"],["Գ","G"],["դ","d"],["Դ","D"],["ե","ye"],["Ե","Ye"],["զ","z"],["Զ","Z"],["է","e"],["Է","E"],["ը","y"],["Ը","Y"],["թ","t"],["Թ","T"],["ժ","zh"],["Ժ","Zh"],["ի","i"],["Ի","I"],["լ","l"],["Լ","L"],["խ","kh"],["Խ","Kh"],["ծ","ts"],["Ծ","Ts"],["կ","k"],["Կ","K"],["հ","h"],["Հ","H"],["ձ","dz"],["Ձ","Dz"],["ղ","gh"],["Ղ","Gh"],["ճ","tch"],["Ճ","Tch"],["մ","m"],["Մ","M"],["յ","y"],["Յ","Y"],["ն","n"],["Ն","N"],["շ","sh"],["Շ","Sh"],["ո","vo"],["Ո","Vo"],["չ","ch"],["Չ","Ch"],["պ","p"],["Պ","P"],["ջ","j"],["Ջ","J"],["ռ","r"],["Ռ","R"],["ս","s"],["Ս","S"],["վ","v"],["Վ","V"],["տ","t"],["Տ","T"],["ր","r"],["Ր","R"],["ց","c"],["Ց","C"],["ու","u"],["ՈՒ","U"],["Ու","U"],["փ","p"],["Փ","P"],["ք","q"],["Ք","Q"],["օ","o"],["Օ","O"],["ֆ","f"],["Ֆ","F"],["և","yev"],["ა","a"],["ბ","b"],["გ","g"],["დ","d"],["ე","e"],["ვ","v"],["ზ","z"],["თ","t"],["ი","i"],["კ","k"],["ლ","l"],["მ","m"],["ნ","n"],["ო","o"],["პ","p"],["ჟ","zh"],["რ","r"],["ს","s"],["ტ","t"],["უ","u"],["ფ","ph"],["ქ","q"],["ღ","gh"],["ყ","k"],["შ","sh"],["ჩ","ch"],["ც","ts"],["ძ","dz"],["წ","ts"],["ჭ","tch"],["ხ","kh"],["ჯ","j"],["ჰ","h"],["č","c"],["ď","d"],["ě","e"],["ň","n"],["ř","r"],["š","s"],["ť","t"],["ů","u"],["ž","z"],["Č","C"],["Ď","D"],["Ě","E"],["Ň","N"],["Ř","R"],["Š","S"],["Ť","T"],["Ů","U"],["Ž","Z"],["ހ","h"],["ށ","sh"],["ނ","n"],["ރ","r"],["ބ","b"],["ޅ","lh"],["ކ","k"],["އ","a"],["ވ","v"],["މ","m"],["ފ","f"],["ދ","dh"],["ތ","th"],["ލ","l"],["ގ","g"],["ޏ","gn"],["ސ","s"],["ޑ","d"],["ޒ","z"],["ޓ","t"],["ޔ","y"],["ޕ","p"],["ޖ","j"],["ޗ","ch"],["ޘ","tt"],["ޙ","hh"],["ޚ","kh"],["ޛ","th"],["ޜ","z"],["ޝ","sh"],["ޞ","s"],["ޟ","d"],["ޠ","t"],["ޡ","z"],["ޢ","a"],["ޣ","gh"],["ޤ","q"],["ޥ","w"],["ަ","a"],["ާ","aa"],["ި","i"],["ީ","ee"],["ު","u"],["ޫ","oo"],["ެ","e"],["ޭ","ey"],["ޮ","o"],["ޯ","oa"],["ް",""],["α","a"],["β","v"],["γ","g"],["δ","d"],["ε","e"],["ζ","z"],["η","i"],["θ","th"],["ι","i"],["κ","k"],["λ","l"],["μ","m"],["ν","n"],["ξ","ks"],["ο","o"],["π","p"],["ρ","r"],["σ","s"],["τ","t"],["υ","y"],["φ","f"],["χ","x"],["ψ","ps"],["ω","o"],["ά","a"],["έ","e"],["ί","i"],["ό","o"],["ύ","y"],["ή","i"],["ώ","o"],["ς","s"],["ϊ","i"],["ΰ","y"],["ϋ","y"],["ΐ","i"],["Α","A"],["Β","B"],["Γ","G"],["Δ","D"],["Ε","E"],["Ζ","Z"],["Η","I"],["Θ","TH"],["Ι","I"],["Κ","K"],["Λ","L"],["Μ","M"],["Ν","N"],["Ξ","KS"],["Ο","O"],["Π","P"],["Ρ","R"],["Σ","S"],["Τ","T"],["Υ","Y"],["Φ","F"],["Χ","X"],["Ψ","PS"],["Ω","O"],["Ά","A"],["Έ","E"],["Ί","I"],["Ό","O"],["Ύ","Y"],["Ή","I"],["Ώ","O"],["Ϊ","I"],["Ϋ","Y"],["ā","a"],["ē","e"],["ģ","g"],["ī","i"],["ķ","k"],["ļ","l"],["ņ","n"],["ū","u"],["Ā","A"],["Ē","E"],["Ģ","G"],["Ī","I"],["Ķ","K"],["Ļ","L"],["Ņ","N"],["Ū","U"],["č","c"],["š","s"],["ž","z"],["Č","C"],["Š","S"],["Ž","Z"],["ą","a"],["č","c"],["ę","e"],["ė","e"],["į","i"],["š","s"],["ų","u"],["ū","u"],["ž","z"],["Ą","A"],["Č","C"],["Ę","E"],["Ė","E"],["Į","I"],["Š","S"],["Ų","U"],["Ū","U"],["Ќ","Kj"],["ќ","kj"],["Љ","Lj"],["љ","lj"],["Њ","Nj"],["њ","nj"],["Тс","Ts"],["тс","ts"],["ą","a"],["ć","c"],["ę","e"],["ł","l"],["ń","n"],["ś","s"],["ź","z"],["ż","z"],["Ą","A"],["Ć","C"],["Ę","E"],["Ł","L"],["Ń","N"],["Ś","S"],["Ź","Z"],["Ż","Z"],["Є","Ye"],["І","I"],["Ї","Yi"],["Ґ","G"],["є","ye"],["і","i"],["ї","yi"],["ґ","g"],["Ĳ","IJ"],["ĳ","ij"],["¢","c"],["¥","Y"],["߿","b"],["৳","t"],["૱","Bo"],["฿","B"],["₠","CE"],["₡","C"],["₢","Cr"],["₣","F"],["₥","m"],["₦","N"],["₧","Pt"],["₨","Rs"],["₩","W"],["₫","s"],["€","E"],["₭","K"],["₮","T"],["₯","Dp"],["₰","S"],["₱","P"],["₲","G"],["₳","A"],["₴","S"],["₵","C"],["₶","tt"],["₷","S"],["₸","T"],["₹","R"],["₺","L"],["₽","P"],["₿","B"],["﹩","$"],["￠","c"],["￥","Y"],["￦","W"],["𝐀","A"],["𝐁","B"],["𝐂","C"],["𝐃","D"],["𝐄","E"],["𝐅","F"],["𝐆","G"],["𝐇","H"],["𝐈","I"],["𝐉","J"],["𝐊","K"],["𝐋","L"],["𝐌","M"],["𝐍","N"],["𝐎","O"],["𝐏","P"],["𝐐","Q"],["𝐑","R"],["𝐒","S"],["𝐓","T"],["𝐔","U"],["𝐕","V"],["𝐖","W"],["𝐗","X"],["𝐘","Y"],["𝐙","Z"],["𝐚","a"],["𝐛","b"],["𝐜","c"],["𝐝","d"],["𝐞","e"],["𝐟","f"],["𝐠","g"],["𝐡","h"],["𝐢","i"],["𝐣","j"],["𝐤","k"],["𝐥","l"],["𝐦","m"],["𝐧","n"],["𝐨","o"],["𝐩","p"],["𝐪","q"],["𝐫","r"],["𝐬","s"],["𝐭","t"],["𝐮","u"],["𝐯","v"],["𝐰","w"],["𝐱","x"],["𝐲","y"],["𝐳","z"],["𝐴","A"],["𝐵","B"],["𝐶","C"],["𝐷","D"],["𝐸","E"],["𝐹","F"],["𝐺","G"],["𝐻","H"],["𝐼","I"],["𝐽","J"],["𝐾","K"],["𝐿","L"],["𝑀","M"],["𝑁","N"],["𝑂","O"],["𝑃","P"],["𝑄","Q"],["𝑅","R"],["𝑆","S"],["𝑇","T"],["𝑈","U"],["𝑉","V"],["𝑊","W"],["𝑋","X"],["𝑌","Y"],["𝑍","Z"],["𝑎","a"],["𝑏","b"],["𝑐","c"],["𝑑","d"],["𝑒","e"],["𝑓","f"],["𝑔","g"],["𝑖","i"],["𝑗","j"],["𝑘","k"],["𝑙","l"],["𝑚","m"],["𝑛","n"],["𝑜","o"],["𝑝","p"],["𝑞","q"],["𝑟","r"],["𝑠","s"],["𝑡","t"],["𝑢","u"],["𝑣","v"],["𝑤","w"],["𝑥","x"],["𝑦","y"],["𝑧","z"],["𝑨","A"],["𝑩","B"],["𝑪","C"],["𝑫","D"],["𝑬","E"],["𝑭","F"],["𝑮","G"],["𝑯","H"],["𝑰","I"],["𝑱","J"],["𝑲","K"],["𝑳","L"],["𝑴","M"],["𝑵","N"],["𝑶","O"],["𝑷","P"],["𝑸","Q"],["𝑹","R"],["𝑺","S"],["𝑻","T"],["𝑼","U"],["𝑽","V"],["𝑾","W"],["𝑿","X"],["𝒀","Y"],["𝒁","Z"],["𝒂","a"],["𝒃","b"],["𝒄","c"],["𝒅","d"],["𝒆","e"],["𝒇","f"],["𝒈","g"],["𝒉","h"],["𝒊","i"],["𝒋","j"],["𝒌","k"],["𝒍","l"],["𝒎","m"],["𝒏","n"],["𝒐","o"],["𝒑","p"],["𝒒","q"],["𝒓","r"],["𝒔","s"],["𝒕","t"],["𝒖","u"],["𝒗","v"],["𝒘","w"],["𝒙","x"],["𝒚","y"],["𝒛","z"],["𝒜","A"],["𝒞","C"],["𝒟","D"],["𝒢","g"],["𝒥","J"],["𝒦","K"],["𝒩","N"],["𝒪","O"],["𝒫","P"],["𝒬","Q"],["𝒮","S"],["𝒯","T"],["𝒰","U"],["𝒱","V"],["𝒲","W"],["𝒳","X"],["𝒴","Y"],["𝒵","Z"],["𝒶","a"],["𝒷","b"],["𝒸","c"],["𝒹","d"],["𝒻","f"],["𝒽","h"],["𝒾","i"],["𝒿","j"],["𝓀","h"],["𝓁","l"],["𝓂","m"],["𝓃","n"],["𝓅","p"],["𝓆","q"],["𝓇","r"],["𝓈","s"],["𝓉","t"],["𝓊","u"],["𝓋","v"],["𝓌","w"],["𝓍","x"],["𝓎","y"],["𝓏","z"],["𝓐","A"],["𝓑","B"],["𝓒","C"],["𝓓","D"],["𝓔","E"],["𝓕","F"],["𝓖","G"],["𝓗","H"],["𝓘","I"],["𝓙","J"],["𝓚","K"],["𝓛","L"],["𝓜","M"],["𝓝","N"],["𝓞","O"],["𝓟","P"],["𝓠","Q"],["𝓡","R"],["𝓢","S"],["𝓣","T"],["𝓤","U"],["𝓥","V"],["𝓦","W"],["𝓧","X"],["𝓨","Y"],["𝓩","Z"],["𝓪","a"],["𝓫","b"],["𝓬","c"],["𝓭","d"],["𝓮","e"],["𝓯","f"],["𝓰","g"],["𝓱","h"],["𝓲","i"],["𝓳","j"],["𝓴","k"],["𝓵","l"],["𝓶","m"],["𝓷","n"],["𝓸","o"],["𝓹","p"],["𝓺","q"],["𝓻","r"],["𝓼","s"],["𝓽","t"],["𝓾","u"],["𝓿","v"],["𝔀","w"],["𝔁","x"],["𝔂","y"],["𝔃","z"],["𝔄","A"],["𝔅","B"],["𝔇","D"],["𝔈","E"],["𝔉","F"],["𝔊","G"],["𝔍","J"],["𝔎","K"],["𝔏","L"],["𝔐","M"],["𝔑","N"],["𝔒","O"],["𝔓","P"],["𝔔","Q"],["𝔖","S"],["𝔗","T"],["𝔘","U"],["𝔙","V"],["𝔚","W"],["𝔛","X"],["𝔜","Y"],["𝔞","a"],["𝔟","b"],["𝔠","c"],["𝔡","d"],["𝔢","e"],["𝔣","f"],["𝔤","g"],["𝔥","h"],["𝔦","i"],["𝔧","j"],["𝔨","k"],["𝔩","l"],["𝔪","m"],["𝔫","n"],["𝔬","o"],["𝔭","p"],["𝔮","q"],["𝔯","r"],["𝔰","s"],["𝔱","t"],["𝔲","u"],["𝔳","v"],["𝔴","w"],["𝔵","x"],["𝔶","y"],["𝔷","z"],["𝔸","A"],["𝔹","B"],["𝔻","D"],["𝔼","E"],["𝔽","F"],["𝔾","G"],["𝕀","I"],["𝕁","J"],["𝕂","K"],["𝕃","L"],["𝕄","M"],["𝕆","N"],["𝕊","S"],["𝕋","T"],["𝕌","U"],["𝕍","V"],["𝕎","W"],["𝕏","X"],["𝕐","Y"],["𝕒","a"],["𝕓","b"],["𝕔","c"],["𝕕","d"],["𝕖","e"],["𝕗","f"],["𝕘","g"],["𝕙","h"],["𝕚","i"],["𝕛","j"],["𝕜","k"],["𝕝","l"],["𝕞","m"],["𝕟","n"],["𝕠","o"],["𝕡","p"],["𝕢","q"],["𝕣","r"],["𝕤","s"],["𝕥","t"],["𝕦","u"],["𝕧","v"],["𝕨","w"],["𝕩","x"],["𝕪","y"],["𝕫","z"],["𝕬","A"],["𝕭","B"],["𝕮","C"],["𝕯","D"],["𝕰","E"],["𝕱","F"],["𝕲","G"],["𝕳","H"],["𝕴","I"],["𝕵","J"],["𝕶","K"],["𝕷","L"],["𝕸","M"],["𝕹","N"],["𝕺","O"],["𝕻","P"],["𝕼","Q"],["𝕽","R"],["𝕾","S"],["𝕿","T"],["𝖀","U"],["𝖁","V"],["𝖂","W"],["𝖃","X"],["𝖄","Y"],["𝖅","Z"],["𝖆","a"],["𝖇","b"],["𝖈","c"],["𝖉","d"],["𝖊","e"],["𝖋","f"],["𝖌","g"],["𝖍","h"],["𝖎","i"],["𝖏","j"],["𝖐","k"],["𝖑","l"],["𝖒","m"],["𝖓","n"],["𝖔","o"],["𝖕","p"],["𝖖","q"],["𝖗","r"],["𝖘","s"],["𝖙","t"],["𝖚","u"],["𝖛","v"],["𝖜","w"],["𝖝","x"],["𝖞","y"],["𝖟","z"],["𝖠","A"],["𝖡","B"],["𝖢","C"],["𝖣","D"],["𝖤","E"],["𝖥","F"],["𝖦","G"],["𝖧","H"],["𝖨","I"],["𝖩","J"],["𝖪","K"],["𝖫","L"],["𝖬","M"],["𝖭","N"],["𝖮","O"],["𝖯","P"],["𝖰","Q"],["𝖱","R"],["𝖲","S"],["𝖳","T"],["𝖴","U"],["𝖵","V"],["𝖶","W"],["𝖷","X"],["𝖸","Y"],["𝖹","Z"],["𝖺","a"],["𝖻","b"],["𝖼","c"],["𝖽","d"],["𝖾","e"],["𝖿","f"],["𝗀","g"],["𝗁","h"],["𝗂","i"],["𝗃","j"],["𝗄","k"],["𝗅","l"],["𝗆","m"],["𝗇","n"],["𝗈","o"],["𝗉","p"],["𝗊","q"],["𝗋","r"],["𝗌","s"],["𝗍","t"],["𝗎","u"],["𝗏","v"],["𝗐","w"],["𝗑","x"],["𝗒","y"],["𝗓","z"],["𝗔","A"],["𝗕","B"],["𝗖","C"],["𝗗","D"],["𝗘","E"],["𝗙","F"],["𝗚","G"],["𝗛","H"],["𝗜","I"],["𝗝","J"],["𝗞","K"],["𝗟","L"],["𝗠","M"],["𝗡","N"],["𝗢","O"],["𝗣","P"],["𝗤","Q"],["𝗥","R"],["𝗦","S"],["𝗧","T"],["𝗨","U"],["𝗩","V"],["𝗪","W"],["𝗫","X"],["𝗬","Y"],["𝗭","Z"],["𝗮","a"],["𝗯","b"],["𝗰","c"],["𝗱","d"],["𝗲","e"],["𝗳","f"],["𝗴","g"],["𝗵","h"],["𝗶","i"],["𝗷","j"],["𝗸","k"],["𝗹","l"],["𝗺","m"],["𝗻","n"],["𝗼","o"],["𝗽","p"],["𝗾","q"],["𝗿","r"],["𝘀","s"],["𝘁","t"],["𝘂","u"],["𝘃","v"],["𝘄","w"],["𝘅","x"],["𝘆","y"],["𝘇","z"],["𝘈","A"],["𝘉","B"],["𝘊","C"],["𝘋","D"],["𝘌","E"],["𝘍","F"],["𝘎","G"],["𝘏","H"],["𝘐","I"],["𝘑","J"],["𝘒","K"],["𝘓","L"],["𝘔","M"],["𝘕","N"],["𝘖","O"],["𝘗","P"],["𝘘","Q"],["𝘙","R"],["𝘚","S"],["𝘛","T"],["𝘜","U"],["𝘝","V"],["𝘞","W"],["𝘟","X"],["𝘠","Y"],["𝘡","Z"],["𝘢","a"],["𝘣","b"],["𝘤","c"],["𝘥","d"],["𝘦","e"],["𝘧","f"],["𝘨","g"],["𝘩","h"],["𝘪","i"],["𝘫","j"],["𝘬","k"],["𝘭","l"],["𝘮","m"],["𝘯","n"],["𝘰","o"],["𝘱","p"],["𝘲","q"],["𝘳","r"],["𝘴","s"],["𝘵","t"],["𝘶","u"],["𝘷","v"],["𝘸","w"],["𝘹","x"],["𝘺","y"],["𝘻","z"],["𝘼","A"],["𝘽","B"],["𝘾","C"],["𝘿","D"],["𝙀","E"],["𝙁","F"],["𝙂","G"],["𝙃","H"],["𝙄","I"],["𝙅","J"],["𝙆","K"],["𝙇","L"],["𝙈","M"],["𝙉","N"],["𝙊","O"],["𝙋","P"],["𝙌","Q"],["𝙍","R"],["𝙎","S"],["𝙏","T"],["𝙐","U"],["𝙑","V"],["𝙒","W"],["𝙓","X"],["𝙔","Y"],["𝙕","Z"],["𝙖","a"],["𝙗","b"],["𝙘","c"],["𝙙","d"],["𝙚","e"],["𝙛","f"],["𝙜","g"],["𝙝","h"],["𝙞","i"],["𝙟","j"],["𝙠","k"],["𝙡","l"],["𝙢","m"],["𝙣","n"],["𝙤","o"],["𝙥","p"],["𝙦","q"],["𝙧","r"],["𝙨","s"],["𝙩","t"],["𝙪","u"],["𝙫","v"],["𝙬","w"],["𝙭","x"],["𝙮","y"],["𝙯","z"],["𝙰","A"],["𝙱","B"],["𝙲","C"],["𝙳","D"],["𝙴","E"],["𝙵","F"],["𝙶","G"],["𝙷","H"],["𝙸","I"],["𝙹","J"],["𝙺","K"],["𝙻","L"],["𝙼","M"],["𝙽","N"],["𝙾","O"],["𝙿","P"],["𝚀","Q"],["𝚁","R"],["𝚂","S"],["𝚃","T"],["𝚄","U"],["𝚅","V"],["𝚆","W"],["𝚇","X"],["𝚈","Y"],["𝚉","Z"],["𝚊","a"],["𝚋","b"],["𝚌","c"],["𝚍","d"],["𝚎","e"],["𝚏","f"],["𝚐","g"],["𝚑","h"],["𝚒","i"],["𝚓","j"],["𝚔","k"],["𝚕","l"],["𝚖","m"],["𝚗","n"],["𝚘","o"],["𝚙","p"],["𝚚","q"],["𝚛","r"],["𝚜","s"],["𝚝","t"],["𝚞","u"],["𝚟","v"],["𝚠","w"],["𝚡","x"],["𝚢","y"],["𝚣","z"],["𝚤","l"],["𝚥","j"],["𝛢","A"],["𝛣","B"],["𝛤","G"],["𝛥","D"],["𝛦","E"],["𝛧","Z"],["𝛨","I"],["𝛩","TH"],["𝛪","I"],["𝛫","K"],["𝛬","L"],["𝛭","M"],["𝛮","N"],["𝛯","KS"],["𝛰","O"],["𝛱","P"],["𝛲","R"],["𝛳","TH"],["𝛴","S"],["𝛵","T"],["𝛶","Y"],["𝛷","F"],["𝛸","x"],["𝛹","PS"],["𝛺","O"],["𝛻","D"],["𝛼","a"],["𝛽","b"],["𝛾","g"],["𝛿","d"],["𝜀","e"],["𝜁","z"],["𝜂","i"],["𝜃","th"],["𝜄","i"],["𝜅","k"],["𝜆","l"],["𝜇","m"],["𝜈","n"],["𝜉","ks"],["𝜊","o"],["𝜋","p"],["𝜌","r"],["𝜍","s"],["𝜎","s"],["𝜏","t"],["𝜐","y"],["𝜑","f"],["𝜒","x"],["𝜓","ps"],["𝜔","o"],["𝜕","d"],["𝜖","E"],["𝜗","TH"],["𝜘","K"],["𝜙","f"],["𝜚","r"],["𝜛","p"],["𝜜","A"],["𝜝","V"],["𝜞","G"],["𝜟","D"],["𝜠","E"],["𝜡","Z"],["𝜢","I"],["𝜣","TH"],["𝜤","I"],["𝜥","K"],["𝜦","L"],["𝜧","M"],["𝜨","N"],["𝜩","KS"],["𝜪","O"],["𝜫","P"],["𝜬","S"],["𝜭","TH"],["𝜮","S"],["𝜯","T"],["𝜰","Y"],["𝜱","F"],["𝜲","X"],["𝜳","PS"],["𝜴","O"],["𝜵","D"],["𝜶","a"],["𝜷","v"],["𝜸","g"],["𝜹","d"],["𝜺","e"],["𝜻","z"],["𝜼","i"],["𝜽","th"],["𝜾","i"],["𝜿","k"],["𝝀","l"],["𝝁","m"],["𝝂","n"],["𝝃","ks"],["𝝄","o"],["𝝅","p"],["𝝆","r"],["𝝇","s"],["𝝈","s"],["𝝉","t"],["𝝊","y"],["𝝋","f"],["𝝌","x"],["𝝍","ps"],["𝝎","o"],["𝝏","a"],["𝝐","e"],["𝝑","i"],["𝝒","k"],["𝝓","f"],["𝝔","r"],["𝝕","p"],["𝝖","A"],["𝝗","B"],["𝝘","G"],["𝝙","D"],["𝝚","E"],["𝝛","Z"],["𝝜","I"],["𝝝","TH"],["𝝞","I"],["𝝟","K"],["𝝠","L"],["𝝡","M"],["𝝢","N"],["𝝣","KS"],["𝝤","O"],["𝝥","P"],["𝝦","R"],["𝝧","TH"],["𝝨","S"],["𝝩","T"],["𝝪","Y"],["𝝫","F"],["𝝬","X"],["𝝭","PS"],["𝝮","O"],["𝝯","D"],["𝝰","a"],["𝝱","v"],["𝝲","g"],["𝝳","d"],["𝝴","e"],["𝝵","z"],["𝝶","i"],["𝝷","th"],["𝝸","i"],["𝝹","k"],["𝝺","l"],["𝝻","m"],["𝝼","n"],["𝝽","ks"],["𝝾","o"],["𝝿","p"],["𝞀","r"],["𝞁","s"],["𝞂","s"],["𝞃","t"],["𝞄","y"],["𝞅","f"],["𝞆","x"],["𝞇","ps"],["𝞈","o"],["𝞉","a"],["𝞊","e"],["𝞋","i"],["𝞌","k"],["𝞍","f"],["𝞎","r"],["𝞏","p"],["𝞐","A"],["𝞑","V"],["𝞒","G"],["𝞓","D"],["𝞔","E"],["𝞕","Z"],["𝞖","I"],["𝞗","TH"],["𝞘","I"],["𝞙","K"],["𝞚","L"],["𝞛","M"],["𝞜","N"],["𝞝","KS"],["𝞞","O"],["𝞟","P"],["𝞠","S"],["𝞡","TH"],["𝞢","S"],["𝞣","T"],["𝞤","Y"],["𝞥","F"],["𝞦","X"],["𝞧","PS"],["𝞨","O"],["𝞩","D"],["𝞪","av"],["𝞫","g"],["𝞬","d"],["𝞭","e"],["𝞮","z"],["𝞯","i"],["𝞰","i"],["𝞱","th"],["𝞲","i"],["𝞳","k"],["𝞴","l"],["𝞵","m"],["𝞶","n"],["𝞷","ks"],["𝞸","o"],["𝞹","p"],["𝞺","r"],["𝞻","s"],["𝞼","s"],["𝞽","t"],["𝞾","y"],["𝞿","f"],["𝟀","x"],["𝟁","ps"],["𝟂","o"],["𝟃","a"],["𝟄","e"],["𝟅","i"],["𝟆","k"],["𝟇","f"],["𝟈","r"],["𝟉","p"],["𝟊","F"],["𝟋","f"],["⒜","(a)"],["⒝","(b)"],["⒞","(c)"],["⒟","(d)"],["⒠","(e)"],["⒡","(f)"],["⒢","(g)"],["⒣","(h)"],["⒤","(i)"],["⒥","(j)"],["⒦","(k)"],["⒧","(l)"],["⒨","(m)"],["⒩","(n)"],["⒪","(o)"],["⒫","(p)"],["⒬","(q)"],["⒭","(r)"],["⒮","(s)"],["⒯","(t)"],["⒰","(u)"],["⒱","(v)"],["⒲","(w)"],["⒳","(x)"],["⒴","(y)"],["⒵","(z)"],["Ⓐ","(A)"],["Ⓑ","(B)"],["Ⓒ","(C)"],["Ⓓ","(D)"],["Ⓔ","(E)"],["Ⓕ","(F)"],["Ⓖ","(G)"],["Ⓗ","(H)"],["Ⓘ","(I)"],["Ⓙ","(J)"],["Ⓚ","(K)"],["Ⓛ","(L)"],["Ⓝ","(N)"],["Ⓞ","(O)"],["Ⓟ","(P)"],["Ⓠ","(Q)"],["Ⓡ","(R)"],["Ⓢ","(S)"],["Ⓣ","(T)"],["Ⓤ","(U)"],["Ⓥ","(V)"],["Ⓦ","(W)"],["Ⓧ","(X)"],["Ⓨ","(Y)"],["Ⓩ","(Z)"],["ⓐ","(a)"],["ⓑ","(b)"],["ⓒ","(b)"],["ⓓ","(c)"],["ⓔ","(e)"],["ⓕ","(f)"],["ⓖ","(g)"],["ⓗ","(h)"],["ⓘ","(i)"],["ⓙ","(j)"],["ⓚ","(k)"],["ⓛ","(l)"],["ⓜ","(m)"],["ⓝ","(n)"],["ⓞ","(o)"],["ⓟ","(p)"],["ⓠ","(q)"],["ⓡ","(r)"],["ⓢ","(s)"],["ⓣ","(t)"],["ⓤ","(u)"],["ⓥ","(v)"],["ⓦ","(w)"],["ⓧ","(x)"],["ⓨ","(y)"],["ⓩ","(z)"],["Ċ","C"],["ċ","c"],["Ġ","G"],["ġ","g"],["Ħ","H"],["ħ","h"],["Ż","Z"],["ż","z"],["𝟎","0"],["𝟏","1"],["𝟐","2"],["𝟑","3"],["𝟒","4"],["𝟓","5"],["𝟔","6"],["𝟕","7"],["𝟖","8"],["𝟗","9"],["𝟘","0"],["𝟙","1"],["𝟚","2"],["𝟛","3"],["𝟜","4"],["𝟝","5"],["𝟞","6"],["𝟟","7"],["𝟠","8"],["𝟡","9"],["𝟢","0"],["𝟣","1"],["𝟤","2"],["𝟥","3"],["𝟦","4"],["𝟧","5"],["𝟨","6"],["𝟩","7"],["𝟪","8"],["𝟫","9"],["𝟬","0"],["𝟭","1"],["𝟮","2"],["𝟯","3"],["𝟰","4"],["𝟱","5"],["𝟲","6"],["𝟳","7"],["𝟴","8"],["𝟵","9"],["𝟶","0"],["𝟷","1"],["𝟸","2"],["𝟹","3"],["𝟺","4"],["𝟻","5"],["𝟼","6"],["𝟽","7"],["𝟾","8"],["𝟿","9"],["①","1"],["②","2"],["③","3"],["④","4"],["⑤","5"],["⑥","6"],["⑦","7"],["⑧","8"],["⑨","9"],["⑩","10"],["⑪","11"],["⑫","12"],["⑬","13"],["⑭","14"],["⑮","15"],["⑯","16"],["⑰","17"],["⑱","18"],["⑲","19"],["⑳","20"],["⑴","1"],["⑵","2"],["⑶","3"],["⑷","4"],["⑸","5"],["⑹","6"],["⑺","7"],["⑻","8"],["⑼","9"],["⑽","10"],["⑾","11"],["⑿","12"],["⒀","13"],["⒁","14"],["⒂","15"],["⒃","16"],["⒄","17"],["⒅","18"],["⒆","19"],["⒇","20"],["⒈","1."],["⒉","2."],["⒊","3."],["⒋","4."],["⒌","5."],["⒍","6."],["⒎","7."],["⒏","8."],["⒐","9."],["⒑","10."],["⒒","11."],["⒓","12."],["⒔","13."],["⒕","14."],["⒖","15."],["⒗","16."],["⒘","17."],["⒙","18."],["⒚","19."],["⒛","20."],["⓪","0"],["⓫","11"],["⓬","12"],["⓭","13"],["⓮","14"],["⓯","15"],["⓰","16"],["⓱","17"],["⓲","18"],["⓳","19"],["⓴","20"],["⓵","1"],["⓶","2"],["⓷","3"],["⓸","4"],["⓹","5"],["⓺","6"],["⓻","7"],["⓼","8"],["⓽","9"],["⓾","10"],["⓿","0"],["🙰","&"],["🙱","&"],["🙲","&"],["🙳","&"],["🙴","&"],["🙵","&"],["🙶",'"'],["🙷",'"'],["🙸",'"'],["‽","?!"],["🙹","?!"],["🙺","?!"],["🙻","?!"],["🙼","/"],["🙽","\\"],["🜇","AR"],["🜈","V"],["🜉","V"],["🜆","VR"],["🜅","VF"],["🜩","2"],["🜪","5"],["🝡","f"],["🝢","W"],["🝣","U"],["🝧","V"],["🝨","T"],["🝪","V"],["🝫","MB"],["🝬","VB"],["🝲","3B"],["🝳","3B"],["💯","100"],["🔙","BACK"],["🔚","END"],["🔛","ON!"],["🔜","SOON"],["🔝","TOP"],["🔞","18"],["🔤","abc"],["🔠","ABCD"],["🔡","abcd"],["🔢","1234"],["🔣","T&@%"],["#️⃣","#"],["*️⃣","*"],["0️⃣","0"],["1️⃣","1"],["2️⃣","2"],["3️⃣","3"],["4️⃣","4"],["5️⃣","5"],["6️⃣","6"],["7️⃣","7"],["8️⃣","8"],["9️⃣","9"],["🔟","10"],["🅰️","A"],["🅱️","B"],["🆎","AB"],["🆑","CL"],["🅾️","O"],["🅿","P"],["🆘","SOS"],["🅲","C"],["🅳","D"],["🅴","E"],["🅵","F"],["🅶","G"],["🅷","H"],["🅸","I"],["🅹","J"],["🅺","K"],["🅻","L"],["🅼","M"],["🅽","N"],["🆀","Q"],["🆁","R"],["🆂","S"],["🆃","T"],["🆄","U"],["🆅","V"],["🆆","W"],["🆇","X"],["🆈","Y"],["🆉","Z"]],FH=(n,e)=>{for(const[t,r]of e)n=n.replace(new RegExp(zH(t),"g"),r);return n};function VH(n,e){if(typeof n!="string")throw new TypeError("Expected a string, got `".concat(typeof n,"`"));e={customReplacements:[],...e};const t=new Map([...BH,...e.customReplacements]);return n=n.normalize(),n=FH(n,t),n=n.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").normalize(),n}const HH=[["&"," and "],["🦄"," unicorn "],["♥"," love "]],WH=n=>n.replace(/([A-Z]{2,})(\d+)/g,"$1 $2").replace(/([a-z\d]+)([A-Z]{2,})/g,"$1 $2").replace(/([a-z\d])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z][a-rt-z\d]+)/g,"$1 $2"),jH=(n,e)=>{const t=Bx(e);return n.replace(new RegExp("".concat(t,"{2,}"),"g"),e).replace(new RegExp("^".concat(t,"|").concat(t,"$"),"g"),"")},UH=n=>{let e="a-z\\d";if(e+=n.lowercase?"":"A-Z",n.preserveCharacters.length>0)for(const t of n.preserveCharacters){if(t===n.separator)throw new Error("The separator character `".concat(n.separator,"` cannot be included in preserved characters: ").concat(n.preserveCharacters));e+=Bx(t)}return new RegExp("[^".concat(e,"]+"),"g")};function qH(n,e){if(typeof n!="string")throw new TypeError("Expected a string, got `".concat(typeof n,"`"));e={separator:"-",lowercase:!0,decamelize:!0,customReplacements:[],preserveLeadingUnderscore:!1,preserveTrailingDash:!1,preserveCharacters:[],...e};const t=e.preserveLeadingUnderscore&&n.startsWith("_"),r=e.preserveTrailingDash&&n.endsWith("-"),i=new Map([...HH,...e.customReplacements]);n=VH(n,{customReplacements:i}),e.decamelize&&(n=WH(n));const s=UH(e);return e.lowercase&&(n=n.toLowerCase()),n=n.replace(/([a-zA-Z\d]+)'([ts])(\s|$)/g,"$1$2$3"),n=n.replace(s,e.separator),n=n.replace(/\\/g,""),e.separator&&(n=jH(n,e.separator)),t&&(n="_".concat(n)),r&&(n="".concat(n,"-")),n}function YH(n,e){return function(t,r){let{$from:i,$to:s,node:o}=t.selection;if(o&&o.isBlock||i.depth<2||!i.sameParent(s))return!1;let a=i.node(-1);if(a.type!=n)return!1;if(i.parent.content.size==0&&i.node(-1).childCount==i.indexAfter(-1)){if(i.depth==3||i.node(-3).type!=n||i.index(-2)!=i.node(-2).childCount-1)return!1;if(r){let d=q.empty,f=i.index(-1)?1:i.index(-2)?2:3;for(let w=i.depth-f;w>=i.depth-3;w--)d=q.from(i.node(w).copy(d));let h=i.indexAfter(-1)<i.node(-2).childCount?1:i.indexAfter(-2)<i.node(-3).childCount?2:3;d=d.append(q.from(n.createAndFill()));let p=i.before(i.depth-(f-1)),m=t.tr.replace(p,i.after(-h),new J(d,4-f,0)),g=-1;m.doc.nodesBetween(p,m.doc.content.size,(w,x)=>{if(g>-1)return!1;w.isTextblock&&w.content.size==0&&(g=x+1)}),g>-1&&m.setSelection(we.near(m.doc.resolve(g))),r(m.scrollIntoView())}return!0}let l=s.pos==i.end()?a.contentMatchAt(0).defaultType:null,c=t.tr.delete(i.pos,s.pos),u=l?[e?{type:n,attrs:e}:null,{type:l}]:void 0;return Ya(c.doc,i.pos,2,u)?(r&&r(c.split(i.pos,2,u).scrollIntoView()),!0):!1}}function Fx(n){return function(e,t){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,o=>o.childCount>0&&o.firstChild.type==n);return s?t?r.node(s.depth-1).type==n?KH(e,t,n,s):GH(e,t,s):!0:!1}}function KH(n,e,t,r){let i=n.tr,s=r.end,o=r.$to.end(r.depth);s<o&&(i.step(new qt(s-1,o,s,o,new J(q.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new W_(i.doc.resolve(r.$from.pos),i.doc.resolve(o),r.depth));const a=Ad(r);if(a==null)return!1;i.lift(r,a);let l=i.mapping.map(s,-1)-1;return Pd(i.doc,l)&&i.join(l),e(i.scrollIntoView()),!0}function GH(n,e,t){let r=n.tr,i=t.parent;for(let h=t.end,p=t.endIndex-1,m=t.startIndex;p>m;p--)h-=i.child(p).nodeSize,r.delete(h-1,h+1);let s=r.doc.resolve(t.start),o=s.nodeAfter;if(r.mapping.map(t.end)!=t.start+s.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==i.childCount,c=s.node(-1),u=s.index(-1);if(!c.canReplace(u+(a?0:1),u+1,o.content.append(l?q.empty:q.from(i))))return!1;let d=s.pos,f=d+o.nodeSize;return r.step(new qt(d-(a?1:0),f+(l?1:0),d+1,f-1,new J((a?q.empty:q.from(i.copy(q.empty))).append(l?q.empty:q.from(i.copy(q.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function XH(n){return function(e,t){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,c=>c.childCount>0&&c.firstChild.type==n);if(!s)return!1;let o=s.startIndex;if(o==0)return!1;let a=s.parent,l=a.child(o-1);if(l.type!=n)return!1;if(t){let c=l.lastChild&&l.lastChild.type==a.type,u=q.from(c?n.create():null),d=new J(q.from(n.create(null,q.from(a.type.create(null,u)))),c?3:1,0),f=s.start,h=s.end;t(e.tr.step(new qt(f-(c?3:1),h,f,h,d,1,!0)).scrollIntoView())}return!0}}function JH(n){const e=new Map;if(!n||!n.type)throw new Error("mdast-util-definitions expected node");return Ol(n,"definition",function(r){const i=S0(r.identifier);i&&!e.get(i)&&e.set(i,r)}),t;function t(r){const i=S0(r);return e.get(i)}}function S0(n){return String(n||"").toUpperCase()}function ZH(){return function(n){const e=JH(n);Ol(n,function(t,r,i){if(t.type==="definition"&&i!==void 0&&typeof r=="number")return i.children.splice(r,1),[bv,r];if(t.type==="imageReference"||t.type==="linkReference"){const s=e(t.identifier);if(s&&i&&typeof r=="number")return i.children[r]=t.type==="imageReference"?{type:"image",url:s.url,title:s.title,alt:t.alt}:{type:"link",url:s.url,title:s.title,children:t.children},[bv,r]}})}}function Vx(n,e){var t;if(!(e.childCount>=1&&((t=e.lastChild)==null?void 0:t.type.name)==="hardbreak")){n.next(e.content);return}const r=[];e.content.forEach((i,s,o)=>{o!==e.childCount-1&&r.push(i)}),n.next(q.fromArray(r))}function H(n,e){return Object.assign(n,{meta:{package:"@milkdown/preset-commonmark",...e}}),n}const Um=zl("emphasis");H(Um,{displayName:"Attr<emphasis>",group:"Emphasis"});const Ko=Il("emphasis",n=>({attrs:{marker:{default:n.get(Xa).emphasis||"*"}},parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:e=>e==="italic"}],toDOM:e=>["em",n.get(Um.key)(e)],parseMarkdown:{match:e=>e.type==="emphasis",runner:(e,t,r)=>{e.openMark(r,{marker:t.marker}),e.next(t.children),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="emphasis",runner:(e,t)=>{e.withMark(t,"emphasis",void 0,{marker:t.attrs.marker})}}}));H(Ko.mark,{displayName:"MarkSchema<emphasis>",group:"Emphasis"});H(Ko.ctx,{displayName:"MarkSchemaCtx<emphasis>",group:"Emphasis"});const Ud=Oe("ToggleEmphasis",n=>()=>Vd(Ko.type(n)));H(Ud,{displayName:"Command<toggleEmphasisCommand>",group:"Emphasis"});const Hx=dn(n=>Ll(/(?:^|[^*])\*([^*]+)\*$/,Ko.type(n),{updateCaptured:({fullMatch:e,start:t})=>e.startsWith("*")?{}:{fullMatch:e.slice(1),start:t+1}}));H(Hx,{displayName:"InputRule<emphasis>|Star",group:"Emphasis"});const Wx=dn(n=>Ll(/(?:^|[^_])_([^_]+)_$/,Ko.type(n),{updateCaptured:({fullMatch:e,start:t})=>e.startsWith("_")?{}:{fullMatch:e.slice(1),start:t+1}}));H(Wx,{displayName:"InputRule<emphasis>|Underscore",group:"Emphasis"});const qm=hn("emphasisKeymap",{ToggleEmphasis:{shortcuts:"Mod-i",command:n=>{const e=n.get(xe);return()=>e.call(Ud.key)}}});H(qm.ctx,{displayName:"KeymapCtx<emphasis>",group:"Emphasis"});H(qm.shortcuts,{displayName:"Keymap<emphasis>",group:"Emphasis"});const Ym=zl("strong");H(Ym,{displayName:"Attr<strong>",group:"Strong"});const Bl=Il("strong",n=>({attrs:{marker:{default:n.get(Xa).strong||"*"}},parseDOM:[{tag:"b"},{tag:"strong"},{style:"font-style",getAttrs:e=>e==="bold"}],toDOM:e=>["strong",n.get(Ym.key)(e)],parseMarkdown:{match:e=>e.type==="strong",runner:(e,t,r)=>{e.openMark(r,{marker:t.marker}),e.next(t.children),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="strong",runner:(e,t)=>{e.withMark(t,"strong",void 0,{marker:t.attrs.marker})}}}));H(Bl.mark,{displayName:"MarkSchema<strong>",group:"Strong"});H(Bl.ctx,{displayName:"MarkSchemaCtx<strong>",group:"Strong"});const qd=Oe("ToggleStrong",n=>()=>Vd(Bl.type(n)));H(qd,{displayName:"Command<toggleStrongCommand>",group:"Strong"});const jx=dn(n=>Ll(/(?:\*\*|__)([^*_]+)(?:\*\*|__)$/,Bl.type(n)));H(jx,{displayName:"InputRule<strong>",group:"Strong"});const Km=hn("strongKeymap",{ToggleBold:{shortcuts:["Mod-b"],command:n=>{const e=n.get(xe);return()=>e.call(qd.key)}}});H(Km.ctx,{displayName:"KeymapCtx<strong>",group:"Strong"});H(Km.shortcuts,{displayName:"Keymap<strong>",group:"Strong"});const Gm=zl("inlineCode");H(Gm,{displayName:"Attr<inlineCode>",group:"InlineCode"});const _i=Il("inlineCode",n=>({priority:100,code:!0,inclusive:!1,parseDOM:[{tag:"code"}],toDOM:e=>["code",n.get(Gm.key)(e)],parseMarkdown:{match:e=>e.type==="inlineCode",runner:(e,t,r)=>{e.openMark(r),e.addText(t.value),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="inlineCode",runner:(e,t,r)=>{e.withMark(t,"inlineCode",r.text||"")}}}));H(_i.mark,{displayName:"MarkSchema<inlineCode>",group:"InlineCode"});H(_i.ctx,{displayName:"MarkSchemaCtx<inlineCode>",group:"InlineCode"});const Xm=Oe("ToggleInlineCode",n=>()=>(e,t)=>{const{selection:r,tr:i}=e;if(r.empty)return!1;const{from:s,to:o}=r;return e.doc.rangeHasMark(s,o,_i.type(n))?(t==null||t(i.removeMark(s,o,_i.type(n))),!0):(Object.keys(e.schema.marks).filter(a=>a!==_i.type.name).map(a=>e.schema.marks[a]).forEach(a=>{i.removeMark(s,o,a)}),t==null||t(i.addMark(s,o,_i.type(n).create())),!0)});H(Xm,{displayName:"Command<toggleInlineCodeCommand>",group:"InlineCode"});const Ux=dn(n=>Ll(/(?:\`)([^\`]+)(?:\`)$/,_i.type(n)));H(Ux,{displayName:"InputRule<inlineCodeInputRule>",group:"InlineCode"});const Jm=hn("inlineCodeKeymap",{ToggleInlineCode:{shortcuts:"Mod-e",command:n=>{const e=n.get(xe);return()=>e.call(Xm.key)}}});H(Jm.ctx,{displayName:"KeymapCtx<inlineCode>",group:"InlineCode"});H(Jm.shortcuts,{displayName:"Keymap<inlineCode>",group:"InlineCode"});const Zm=zl("link");H(Zm,{displayName:"Attr<link>",group:"Link"});const $i=Il("link",n=>({attrs:{href:{},title:{default:null}},parseDOM:[{tag:"a[href]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw Cr(e);return{href:e.getAttribute("href"),title:e.getAttribute("title")}}}],toDOM:e=>["a",{...n.get(Zm.key)(e),...e.attrs}],parseMarkdown:{match:e=>e.type==="link",runner:(e,t,r)=>{const i=t.url,s=t.title;e.openMark(r,{href:i,title:s}),e.next(t.children),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="link",runner:(e,t)=>{e.withMark(t,"link",void 0,{title:t.attrs.title,url:t.attrs.href})}}}));H($i.mark,{displayName:"MarkSchema<link>",group:"Link"});const qx=Oe("ToggleLink",n=>(e={})=>Vd($i.type(n),e));H(qx,{displayName:"Command<toggleLinkCommand>",group:"Link"});const Yx=Oe("UpdateLink",n=>(e={})=>(t,r)=>{if(!r)return!1;let i,s=-1;const{selection:o}=t,{from:a,to:l}=o;if(t.doc.nodesBetween(a,a===l?l+1:l,(p,m)=>{if($i.type(n).isInSet(p.marks))return i=p,s=m,!1}),!i)return!1;const c=i.marks.find(({type:p})=>p===$i.type(n));if(!c)return!1;const u=s,d=s+i.nodeSize,{tr:f}=t,h=$i.type(n).create({...c.attrs,...e});return h?(r(f.removeMark(u,d,c).addMark(u,d,h).setSelection(new Me(f.selection.$anchor)).scrollIntoView()),!0):!1});H(Yx,{displayName:"Command<updateLinkCommand>",group:"Link"});const Kx=Hm("doc",()=>({content:"block+",parseMarkdown:{match:({type:n})=>n==="root",runner:(n,e,t)=>{n.injectRoot(e,t)}},toMarkdown:{match:n=>n.type.name==="doc",runner:(n,e)=>{n.openNode("root"),n.next(e.content)}}}));H(Kx,{displayName:"NodeSchema<doc>",group:"Doc"});const Yd=Zn("paragraph");H(Yd,{displayName:"Attr<paragraph>",group:"Paragraph"});const Yr=Ft("paragraph",n=>({content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:e=>["p",n.get(Yd.key)(e),0],parseMarkdown:{match:e=>e.type==="paragraph",runner:(e,t,r)=>{e.openNode(r),t.children?e.next(t.children):e.addText(t.value||""),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="paragraph",runner:(e,t)=>{e.openNode("paragraph"),Vx(e,t),e.closeNode()}}}));H(Yr.node,{displayName:"NodeSchema<paragraph>",group:"Paragraph"});H(Yr.ctx,{displayName:"NodeSchemaCtx<paragraph>",group:"Paragraph"});const Qm=Oe("TurnIntoText",n=>()=>wl(Yr.type(n)));H(Qm,{displayName:"Command<turnIntoTextCommand>",group:"Paragraph"});const eg=hn("paragraphKeymap",{TurnIntoText:{shortcuts:"Mod-Alt-0",command:n=>{const e=n.get(xe);return()=>e.call(Qm.key)}}});H(eg.ctx,{displayName:"KeymapCtx<paragraph>",group:"Paragraph"});H(eg.shortcuts,{displayName:"Keymap<paragraph>",group:"Paragraph"});const QH=Array(6).fill(0).map((n,e)=>e+1);function eW(n){return qH(n.textContent)}const Kd=fn(eW,"headingIdGenerator");H(Kd,{displayName:"Ctx<HeadingIdGenerator>",group:"Heading"});const Gd=Zn("heading");H(Gd,{displayName:"Attr<heading>",group:"Heading"});const qs=Ft("heading",n=>{const e=n.get(Kd.key);return{content:"inline*",group:"block",defining:!0,attrs:{id:{default:""},level:{default:1}},parseDOM:QH.map(t=>({tag:"h".concat(t),getAttrs:r=>{if(!(r instanceof HTMLElement))throw Cr(r);return{level:t,id:r.id}}})),toDOM:t=>["h".concat(t.attrs.level),{...n.get(Gd.key)(t),id:t.attrs.id||e(t)},0],parseMarkdown:{match:({type:t})=>t==="heading",runner:(t,r,i)=>{const s=r.depth;t.openNode(i,{level:s}),t.next(r.children),t.closeNode()}},toMarkdown:{match:t=>t.type.name==="heading",runner:(t,r)=>{t.openNode("heading",void 0,{depth:r.attrs.level}),Vx(t,r),t.closeNode()}}}});H(qs.node,{displayName:"NodeSchema<heading>",group:"Heading"});H(qs.ctx,{displayName:"NodeSchemaCtx<heading>",group:"Heading"});const Gx=dn(n=>ix(new RegExp("^(?<hashes>#+)\\s$"),qs.type(n),e=>{var t,r;const i=((r=(t=e.groups)==null?void 0:t.hashes)==null?void 0:r.length)||0,s=n.get(xo),{$from:o}=s.state.selection,a=o.node();if(a.type.name==="heading"){let l=Number(a.attrs.level)+Number(i);return l>6&&(l=6),{level:l}}return{level:i}}));H(Gx,{displayName:"InputRule<wrapInHeadingInputRule>",group:"Heading"});const lr=Oe("WrapInHeading",n=>e=>(e!=null||(e=1),e<1?wl(Yr.type(n)):wl(qs.type(n),{level:e})));H(lr,{displayName:"Command<wrapInHeadingCommand>",group:"Heading"});const tg=Oe("DowngradeHeading",n=>()=>(e,t,r)=>{const{$from:i}=e.selection,s=i.node();if(s.type!==qs.type(n)||!e.selection.empty||i.parentOffset!==0)return!1;const o=s.attrs.level-1;return o?(t==null||t(e.tr.setNodeMarkup(e.selection.$from.before(),void 0,{...s.attrs,level:o})),!0):wl(Yr.type(n))(e,t,r)});H(tg,{displayName:"Command<downgradeHeadingCommand>",group:"Heading"});const ng=hn("headingKeymap",{TurnIntoH1:{shortcuts:"Mod-Alt-1",command:n=>{const e=n.get(xe);return()=>e.call(lr.key,1)}},TurnIntoH2:{shortcuts:"Mod-Alt-2",command:n=>{const e=n.get(xe);return()=>e.call(lr.key,2)}},TurnIntoH3:{shortcuts:"Mod-Alt-3",command:n=>{const e=n.get(xe);return()=>e.call(lr.key,3)}},TurnIntoH4:{shortcuts:"Mod-Alt-4",command:n=>{const e=n.get(xe);return()=>e.call(lr.key,4)}},TurnIntoH5:{shortcuts:"Mod-Alt-5",command:n=>{const e=n.get(xe);return()=>e.call(lr.key,5)}},TurnIntoH6:{shortcuts:"Mod-Alt-6",command:n=>{const e=n.get(xe);return()=>e.call(lr.key,6)}},DowngradeHeading:{shortcuts:["Delete","Backspace"],command:n=>{const e=n.get(xe);return()=>e.call(tg.key)}}});H(ng.ctx,{displayName:"KeymapCtx<heading>",group:"Heading"});H(ng.shortcuts,{displayName:"Keymap<heading>",group:"Heading"});const rg=Zn("blockquote");H(rg,{displayName:"Attr<blockquote>",group:"Blockquote"});const Fl=Ft("blockquote",n=>({content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:e=>["blockquote",n.get(rg.key)(e),0],parseMarkdown:{match:({type:e})=>e==="blockquote",runner:(e,t,r)=>{e.openNode(r).next(t.children).closeNode()}},toMarkdown:{match:e=>e.type.name==="blockquote",runner:(e,t)=>{e.openNode("blockquote").next(t.content).closeNode()}}}));H(Fl.node,{displayName:"NodeSchema<blockquote>",group:"Blockquote"});H(Fl.ctx,{displayName:"NodeSchemaCtx<blockquote>",group:"Blockquote"});const Xx=dn(n=>Im(/^\s*>\s$/,Fl.type(n)));H(Xx,{displayName:"InputRule<wrapInBlockquoteInputRule>",group:"Blockquote"});const Xd=Oe("WrapInBlockquote",n=>()=>Vm(Fl.type(n)));H(Xd,{displayName:"Command<wrapInBlockquoteCommand>",group:"Blockquote"});const ig=hn("blockquoteKeymap",{WrapInBlockquote:{shortcuts:"Mod-Shift-b",command:n=>{const e=n.get(xe);return()=>e.call(Xd.key)}}});H(ig.ctx,{displayName:"KeymapCtx<blockquote>",group:"Blockquote"});H(ig.shortcuts,{displayName:"Keymap<blockquote>",group:"Blockquote"});const sg=Zn("codeBlock",()=>({pre:{},code:{}}));H(sg,{displayName:"Attr<codeBlock>",group:"CodeBlock"});const Vl=Ft("code_block",n=>({content:"text*",group:"block",marks:"",defining:!0,code:!0,attrs:{language:{default:""}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:e=>{if(!(e instanceof HTMLElement))throw Cr(e);return{language:e.dataset.language}}}],toDOM:e=>{const t=n.get(sg.key)(e);return["pre",{...t.pre,"data-language":e.attrs.language},["code",t.code,0]]},parseMarkdown:{match:({type:e})=>e==="code",runner:(e,t,r)=>{const i=t.lang,s=t.value;e.openNode(r,{language:i}),s&&e.addText(s),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="code_block",runner:(e,t)=>{var r;e.addNode("code",void 0,((r=t.content.firstChild)==null?void 0:r.text)||"",{lang:t.attrs.language})}}}));H(Vl.node,{displayName:"NodeSchema<codeBlock>",group:"CodeBlock"});H(Vl.ctx,{displayName:"NodeSchemaCtx<codeBlock>",group:"CodeBlock"});const Jx=dn(n=>ix(new RegExp("^```(?<language>[a-z]*)?[\\s\\n]$"),Vl.type(n),e=>{var r;var t;return{language:(r=(t=e.groups)==null?void 0:t.language)!=null?r:""}}));H(Jx,{displayName:"InputRule<createCodeBlockInputRule>",group:"CodeBlock"});const Jd=Oe("CreateCodeBlock",n=>(e="")=>wl(Vl.type(n),{language:e}));H(Jd,{displayName:"Command<createCodeBlockCommand>",group:"CodeBlock"});const tW=Oe("UpdateCodeBlockLanguage",()=>({pos:n,language:e}={pos:-1,language:""})=>(t,r)=>n>=0?(r==null||r(t.tr.setNodeAttribute(n,"language",e)),!0):!1);H(tW,{displayName:"Command<updateCodeBlockLanguageCommand>",group:"CodeBlock"});const og=hn("codeBlockKeymap",{CreateCodeBlock:{shortcuts:"Mod-Alt-c",command:n=>{const e=n.get(xe);return()=>e.call(Jd.key)}}});H(og.ctx,{displayName:"KeymapCtx<codeBlock>",group:"CodeBlock"});H(og.shortcuts,{displayName:"Keymap<codeBlock>",group:"CodeBlock"});const ag=Zn("image");H(ag,{displayName:"Attr<image>",group:"Image"});const Go=Ft("image",n=>({inline:!0,group:"inline",selectable:!0,draggable:!0,marks:"",atom:!0,defining:!0,isolating:!0,attrs:{src:{default:""},alt:{default:""},title:{default:""}},parseDOM:[{tag:"img[src]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw Cr(e);return{src:e.getAttribute("src")||"",alt:e.getAttribute("alt")||"",title:e.getAttribute("title")||e.getAttribute("alt")||""}}}],toDOM:e=>["img",{...n.get(ag.key)(e),...e.attrs}],parseMarkdown:{match:({type:e})=>e==="image",runner:(e,t,r)=>{const i=t.url,s=t.alt,o=t.title;e.addNode(r,{src:i,alt:s,title:o})}},toMarkdown:{match:e=>e.type.name==="image",runner:(e,t)=>{e.addNode("image",void 0,void 0,{title:t.attrs.title,url:t.attrs.src,alt:t.attrs.alt})}}}));H(Go.node,{displayName:"NodeSchema<image>",group:"Image"});H(Go.ctx,{displayName:"NodeSchemaCtx<image>",group:"Image"});const lg=Oe("InsertImage",n=>(e={})=>(t,r)=>{if(!r)return!0;const{src:i="",alt:s="",title:o=""}=e,a=Go.type(n).create({src:i,alt:s,title:o});return a&&r(t.tr.replaceSelectionWith(a).scrollIntoView()),!0});H(lg,{displayName:"Command<insertImageCommand>",group:"Image"});const Zx=Oe("UpdateImage",n=>(e={})=>(t,r)=>{const i=xV(t.selection,Go.type(n));if(!i)return!1;const{node:s,pos:o}=i,a={...s.attrs},{src:l,alt:c,title:u}=e;return l!==void 0&&(a.src=l),c!==void 0&&(a.alt=c),u!==void 0&&(a.title=u),r==null||r(t.tr.setNodeMarkup(o,void 0,a).scrollIntoView()),!0});H(Zx,{displayName:"Command<updateImageCommand>",group:"Image"});const nW=dn(n=>new Sn(new RegExp('!\\[(?<alt>.*?)]\\((?<filename>.*?)\\s*(?="|\\))"?(?<title>[^"]+)?"?\\)'),(e,t,r,i)=>{const[s,o,a="",l]=t;return s?e.tr.replaceWith(r,i,Go.type(n).create({src:a,alt:o,title:l})):null}));H(nW,{displayName:"InputRule<insertImageInputRule>",group:"Image"});const cg=Zn("hardbreak",n=>({"data-is-inline":n.attrs.isInline}));H(cg,{displayName:"Attr<hardbreak>",group:"Hardbreak"});const Ts=Ft("hardbreak",n=>({inline:!0,group:"inline",attrs:{isInline:{default:!1}},selectable:!1,parseDOM:[{tag:"br"}],toDOM:e=>["br",n.get(cg.key)(e)],parseMarkdown:{match:({type:e})=>e==="break",runner:(e,t,r)=>{var i;e.addNode(r,{isInline:!!((i=t.data)!=null&&i.isInline)})}},leafText:()=>"\n",toMarkdown:{match:e=>e.type.name==="hardbreak",runner:(e,t)=>{t.attrs.isInline?e.addNode("text",void 0,"\n"):e.addNode("break")}}}));H(Ts.node,{displayName:"NodeSchema<hardbreak>",group:"Hardbreak"});H(Ts.ctx,{displayName:"NodeSchemaCtx<hardbreak>",group:"Hardbreak"});const ug=Oe("InsertHardbreak",n=>()=>(e,t)=>{var r;const{selection:i,tr:s}=e;if(!(i instanceof Me))return!1;if(i.empty){const o=i.$from.node();if(o.childCount>0&&((r=o.lastChild)==null?void 0:r.type.name)==="hardbreak")return t==null||t(s.replaceRangeWith(i.to-1,i.to,e.schema.node("paragraph")).setSelection(we.near(s.doc.resolve(i.to))).scrollIntoView()),!0}return t==null||t(s.setMeta("hardbreak",!0).replaceSelectionWith(Ts.type(n).create()).scrollIntoView()),!0});H(ug,{displayName:"Command<insertHardbreakCommand>",group:"Hardbreak"});const dg=hn("hardbreakKeymap",{InsertHardbreak:{shortcuts:"Shift-Enter",command:n=>{const e=n.get(xe);return()=>e.call(ug.key)}}});H(dg.ctx,{displayName:"KeymapCtx<hardbreak>",group:"Hardbreak"});H(dg.shortcuts,{displayName:"Keymap<hardbreak>",group:"Hardbreak"});const fg=Zn("hr");H(fg,{displayName:"Attr<hr>",group:"Hr"});const Hl=Ft("hr",n=>({group:"block",parseDOM:[{tag:"hr"}],toDOM:e=>["hr",n.get(fg.key)(e)],parseMarkdown:{match:({type:e})=>e==="thematicBreak",runner:(e,t,r)=>{e.addNode(r)}},toMarkdown:{match:e=>e.type.name==="hr",runner:e=>{e.addNode("thematicBreak")}}}));H(Hl.node,{displayName:"NodeSchema<hr>",group:"Hr"});H(Hl.ctx,{displayName:"NodeSchemaCtx<hr>",group:"Hr"});const Qx=dn(n=>new Sn(/^(?:---|___\s|\*\*\*\s)$/,(e,t,r,i)=>{const{tr:s}=e;return t[0]&&s.replaceWith(r-1,i,Hl.type(n).create()),s}));H(Qx,{displayName:"InputRule<insertHrInputRule>",group:"Hr"});const e2=Oe("InsertHr",n=>()=>(e,t)=>{if(!t)return!0;const r=Yr.node.type(n).create(),{tr:i,selection:s}=e,{from:o}=s,a=Hl.type(n).create();if(!a)return!0;const l=i.replaceSelectionWith(a).insert(o,r),c=we.findFrom(l.doc.resolve(o),1,!0);return c&&t(l.setSelection(c).scrollIntoView()),!0});H(e2,{displayName:"Command<insertHrCommand>",group:"Hr"});const hg=Zn("bulletList");H(hg,{displayName:"Attr<bulletList>",group:"BulletList"});const Xo=Ft("bullet_list",n=>({content:"listItem+",group:"block",attrs:{spread:{default:!1}},parseDOM:[{tag:"ul",getAttrs:e=>{if(!(e instanceof HTMLElement))throw Cr(e);return{spread:e.dataset.spread}}}],toDOM:e=>["ul",{...n.get(hg.key)(e),"data-spread":e.attrs.spread},0],parseMarkdown:{match:({type:e,ordered:t})=>e==="list"&&!t,runner:(e,t,r)=>{const i=t.spread!=null?"".concat(t.spread):"false";e.openNode(r,{spread:i}).next(t.children).closeNode()}},toMarkdown:{match:e=>e.type.name==="bullet_list",runner:(e,t)=>{e.openNode("list",void 0,{ordered:!1,spread:t.attrs.spread==="true"}).next(t.content).closeNode()}}}));H(Xo.node,{displayName:"NodeSchema<bulletList>",group:"BulletList"});H(Xo.ctx,{displayName:"NodeSchemaCtx<bulletList>",group:"BulletList"});const t2=dn(n=>Im(/^\s*([-+*])\s$/,Xo.type(n)));H(t2,{displayName:"InputRule<wrapInBulletListInputRule>",group:"BulletList"});const Zd=Oe("WrapInBulletList",n=>()=>Vm(Xo.type(n)));H(Zd,{displayName:"Command<wrapInBulletListCommand>",group:"BulletList"});const pg=hn("bulletListKeymap",{WrapInBulletList:{shortcuts:"Mod-Alt-8",command:n=>{const e=n.get(xe);return()=>e.call(Zd.key)}}});H(pg.ctx,{displayName:"KeymapCtx<bulletListKeymap>",group:"BulletList"});H(pg.shortcuts,{displayName:"Keymap<bulletListKeymap>",group:"BulletList"});const mg=Zn("orderedList");H(mg,{displayName:"Attr<orderedList>",group:"OrderedList"});const Jo=Ft("ordered_list",n=>({content:"listItem+",group:"block",attrs:{order:{default:1},spread:{default:!1}},parseDOM:[{tag:"ol",getAttrs:e=>{if(!(e instanceof HTMLElement))throw Cr(e);return{spread:e.dataset.spread,order:e.hasAttribute("start")?Number(e.getAttribute("start")):1}}}],toDOM:e=>["ol",{...n.get(mg.key)(e),...e.attrs.order===1?{}:e.attrs.order,"data-spread":e.attrs.spread},0],parseMarkdown:{match:({type:e,ordered:t})=>e==="list"&&!!t,runner:(e,t,r)=>{const i=t.spread!=null?"".concat(t.spread):"true";e.openNode(r,{spread:i}).next(t.children).closeNode()}},toMarkdown:{match:e=>e.type.name==="ordered_list",runner:(e,t)=>{e.openNode("list",void 0,{ordered:!0,start:1,spread:t.attrs.spread==="true"}),e.next(t.content),e.closeNode()}}}));H(Jo.node,{displayName:"NodeSchema<orderedList>",group:"OrderedList"});H(Jo.ctx,{displayName:"NodeSchemaCtx<orderedList>",group:"OrderedList"});const n2=dn(n=>Im(/^\s*(\d+)\.\s$/,Jo.type(n),e=>({order:Number(e[1])}),(e,t)=>t.childCount+t.attrs.order===Number(e[1])));H(n2,{displayName:"InputRule<wrapInOrderedListInputRule>",group:"OrderedList"});const Qd=Oe("WrapInOrderedList",n=>()=>Vm(Jo.type(n)));H(Qd,{displayName:"Command<wrapInOrderedListCommand>",group:"OrderedList"});const gg=hn("orderedListKeymap",{WrapInOrderedList:{shortcuts:"Mod-Alt-7",command:n=>{const e=n.get(xe);return()=>e.call(Qd.key)}}});H(gg.ctx,{displayName:"KeymapCtx<orderedList>",group:"OrderedList"});H(gg.shortcuts,{displayName:"Keymap<orderedList>",group:"OrderedList"});const vg=Zn("listItem");H(vg,{displayName:"Attr<listItem>",group:"ListItem"});const kr=Ft("list_item",n=>({group:"listItem",content:"paragraph block*",attrs:{label:{default:"•"},listType:{default:"bullet"},spread:{default:"true"}},defining:!0,parseDOM:[{tag:"li",getAttrs:e=>{if(!(e instanceof HTMLElement))throw Cr(e);return{label:e.dataset.label,listType:e.dataset["list-type"],spread:e.dataset.spread}}}],toDOM:e=>["li",{...n.get(vg.key)(e),"data-label":e.attrs.label,"data-list-type":e.attrs.listType,"data-spread":e.attrs.spread},0],parseMarkdown:{match:({type:e})=>e==="listItem",runner:(e,t,r)=>{const i=t.label!=null?"".concat(t.label,"."):"•",s=t.label!=null?"ordered":"bullet",o=t.spread!=null?"".concat(t.spread):"true";e.openNode(r,{label:i,listType:s,spread:o}),e.next(t.children),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="list_item",runner:(e,t)=>{e.openNode("listItem",void 0,{spread:t.attrs.spread==="true"}),e.next(t.content),e.closeNode()}}}));H(kr.node,{displayName:"NodeSchema<listItem>",group:"ListItem"});H(kr.ctx,{displayName:"NodeSchemaCtx<listItem>",group:"ListItem"});const yg=Oe("SinkListItem",n=>()=>XH(kr.type(n)));H(yg,{displayName:"Command<sinkListItemCommand>",group:"ListItem"});const bg=Oe("SplitListItem",n=>()=>Fx(kr.type(n)));H(bg,{displayName:"Command<liftListItemCommand>",group:"ListItem"});const wg=Oe("SplitListItem",n=>()=>YH(kr.type(n)));H(wg,{displayName:"Command<splitListItemCommand>",group:"ListItem"});function rW(n){return(e,t,r)=>{const{selection:i}=e;if(!(i instanceof Me))return!1;const{empty:s,$from:o}=i;if(!s||o.parentOffset!==0)return!1;const a=o.node(-1);return a.type!==kr.type(n)||a.firstChild!==o.node()||o.node(-2).childCount>1?!1:Fx(kr.type(n))(e,t,r)}}const _g=Oe("LiftFirstListItem",n=>()=>rW(n));H(_g,{displayName:"Command<liftFirstListItemCommand>",group:"ListItem"});const kg=hn("listItemKeymap",{NextListItem:{shortcuts:"Enter",command:n=>{const e=n.get(xe);return()=>e.call(wg.key)}},SinkListItem:{shortcuts:["Tab","Mod-]"],command:n=>{const e=n.get(xe);return()=>e.call(yg.key)}},LiftListItem:{shortcuts:["Shift-Tab","Mod-["],command:n=>{const e=n.get(xe);return()=>e.call(bg.key)}},LiftFirstListItem:{shortcuts:["Backspace","Delete"],command:n=>{const e=n.get(xe);return()=>e.call(_g.key)}}});H(kg.ctx,{displayName:"KeymapCtx<listItem>",group:"ListItem"});H(kg.shortcuts,{displayName:"Keymap<listItem>",group:"ListItem"});const r2=Hm("text",()=>({group:"inline",parseMarkdown:{match:({type:n})=>n==="text",runner:(n,e)=>{n.addText(e.value)}},toMarkdown:{match:n=>n.type.name==="text",runner:(n,e)=>{n.addNode("text",void 0,e.text)}}}));H(r2,{displayName:"NodeSchema<text>",group:"Text"});const xg=Zn("html");H(xg,{displayName:"Attr<html>",group:"Html"});const Cg=Ft("html",n=>({atom:!0,group:"inline",inline:!0,attrs:{value:{default:""}},toDOM:e=>{const t=document.createElement("span"),r={...n.get(xg.key)(e),"data-value":e.attrs.value,"data-type":"html"};return t.textContent=e.attrs.value,["span",r,e.attrs.value]},parseDOM:[{tag:'span[data-type="html"]',getAttrs:e=>{var t;return{value:(t=e.dataset.value)!=null?t:""}}}],parseMarkdown:{match:({type:e})=>e==="html",runner:(e,t,r)=>{e.addNode(r,{value:t.value})}},toMarkdown:{match:e=>e.type.name==="html",runner:(e,t)=>{e.addNode("html",void 0,t.attrs.value)}}}));H(Cg.node,{displayName:"NodeSchema<html>",group:"Html"});H(Cg.ctx,{displayName:"NodeSchemaCtx<html>",group:"Html"});const iW=[Kx,Yd,Yr,Kd,Gd,qs,cg,Ts,rg,Fl,sg,Vl,fg,Hl,ag,Go,hg,Xo,mg,Jo,vg,kr,Um,Ko,Ym,Bl,Gm,_i,Zm,$i,xg,Cg,r2].flat(),sW=[Xx,t2,n2,Jx,Qx,Gx].flat(),oW=[Hx,Wx,Ux,jx],aW=[Qm,Xd,lr,tg,Jd,ug,e2,lg,Zx,Qd,Zd,yg,wg,bg,_g,Ud,Xm,qd,qx,Yx],lW=[ig,og,dg,ng,kg,gg,pg,eg,qm,Jm,Km].flat(),Sg=qo("remarkAddOrderInList",()=>()=>n=>{Ol(n,"list",e=>{var t;if(e.ordered){const r=(t=e.start)!=null?t:1;e.children.forEach((i,s)=>{i.label=s+r})}})});H(Sg.plugin,{displayName:"Remark<remarkAddOrderInListPlugin>",group:"Remark"});H(Sg.options,{displayName:"RemarkConfig<remarkAddOrderInListPlugin>",group:"Remark"});const Mg=qo("remarkLineBreak",()=>()=>n=>{const e=/[\t ]*(?:\r?\n|\r)/g;Ol(n,"text",(t,r,i)=>{if(!t.value||typeof t.value!="string")return;const s=[];let o=0;e.lastIndex=0;let a=e.exec(t.value);for(;a;){const l=a.index;o!==l&&s.push({type:"text",value:t.value.slice(o,l)}),s.push({type:"break",data:{isInline:!0}}),o=l+a[0].length,a=e.exec(t.value)}if(s.length>0&&i&&typeof r=="number")return o<t.value.length&&s.push({type:"text",value:t.value.slice(o)}),i.children.splice(r,1,...s),r+s.length})});H(Mg.plugin,{displayName:"Remark<remarkLineBreak>",group:"Remark"});H(Mg.options,{displayName:"RemarkConfig<remarkLineBreak>",group:"Remark"});const Tg=qo("remarkInlineLink",()=>ZH);H(Tg.plugin,{displayName:"Remark<remarkInlineLinkPlugin>",group:"Remark"});H(Tg.options,{displayName:"RemarkConfig<remarkInlineLinkPlugin>",group:"Remark"});const cW=n=>!!n.children,uW=n=>n.type==="html";function dW(n,e){return t(n,0,null)[0];function t(r,i,s){if(cW(r)){const o=[];for(let a=0,l=r.children.length;a<l;a++){const c=r.children[a];if(c){const u=t(c,a,r);if(u)for(let d=0,f=u.length;d<f;d++){const h=u[d];h&&o.push(h)}}}r.children=o}return e(r,i,s)}}const Og=qo("remarkHTMLTransformer",()=>()=>n=>{dW(n,(e,t,r)=>uW(e)?((r==null?void 0:r.type)==="root"&&(e.children=[{...e}],delete e.value,e.type="paragraph"),[e]):[e])});H(Og.plugin,{displayName:"Remark<remarkHtmlTransformer>",group:"Remark"});H(Og.options,{displayName:"RemarkConfig<remarkHtmlTransformer>",group:"Remark"});const $g=qo("remarkMarker",()=>()=>(n,e)=>{const t=r=>e.value.charAt(r.position.start.offset);Ol(n,r=>["strong","emphasis"].includes(r.type),r=>{r.marker=t(r)})});H($g.plugin,{displayName:"Remark<remarkMarker>",group:"Remark"});H($g.options,{displayName:"RemarkConfig<remarkMarker>",group:"Remark"});const i2=Vn(()=>{let n=!1;const e=new Bt("MILKDOWN_INLINE_NODES_CURSOR"),t=new Gt({key:e,state:{init(){return!1},apply(r){if(!r.selection.empty)return!1;const i=r.selection.$from,s=i.nodeBefore,o=i.nodeAfter;return!!(s&&o&&s.isInline&&!s.isText&&o.isInline&&!o.isText)}},props:{handleDOMEvents:{compositionend:(r,i)=>n?(n=!1,requestAnimationFrame(()=>{if(t.getState(r.state)){const s=r.state.selection.from;i.preventDefault(),r.dispatch(r.state.tr.insertText(i.data||"",s))}}),!0):!1,compositionstart:r=>(t.getState(r.state)&&(n=!0),!1),beforeinput:(r,i)=>{if(t.getState(r.state)&&i instanceof InputEvent&&i.data&&!n){const s=r.state.selection.from;return i.preventDefault(),r.dispatch(r.state.tr.insertText(i.data||"",s)),!0}return!1}},decorations(r){if(t.getState(r)){const i=r.selection.$from.pos,s=document.createElement("span"),o=Ut.widget(i,s,{side:-1}),a=document.createElement("span"),l=Ut.widget(i,a);return setTimeout(()=>{s.contentEditable="true",a.contentEditable="true"}),Qe.create(r.doc,[o,l])}return Qe.empty}}});return t});H(i2,{displayName:"Prose<inlineNodesCursorPlugin>",group:"Prose"});const s2=Vn(n=>new Gt({key:new Bt("MILKDOWN_HARDBREAK_MARKS"),appendTransaction:(e,t,r)=>{if(!e.length)return;const[i]=e;if(!i)return;const[s]=i.steps;if(i.getMeta("hardbreak")){if(!(s instanceof Lt))return;const{from:o}=s;return r.tr.setNodeMarkup(o,Ts.type(n),void 0,[])}if(s instanceof Vr){let o=r.tr;const{from:a,to:l}=s;return r.doc.nodesBetween(a,l,(c,u)=>{c.type===Ts.type(n)&&(o=o.setNodeMarkup(u,Ts.type(n),void 0,[]))}),o}}}));H(s2,{displayName:"Prose<hardbreakClearMarkPlugin>",group:"Prose"});const Dg=fn(["table","code_block"],"hardbreakFilterNodes");H(Dg,{displayName:"Ctx<hardbreakFilterNodes>",group:"Prose"});const o2=Vn(n=>{const e=n.get(Dg.key);return new Gt({key:new Bt("MILKDOWN_HARDBREAK_FILTER"),filterTransaction:(t,r)=>{const i=t.getMeta("hardbreak"),[s]=t.steps;if(i&&s){const{from:o}=s,a=r.doc.resolve(o);let l=a.depth,c=!0;for(;l>0;)e.includes(a.node(l).type.name)&&(c=!1),l--;return c}return!0}})});H(o2,{displayName:"Prose<hardbreakFilterPlugin>",group:"Prose"});const a2=Vn(n=>{const e=new Bt("MILKDOWN_HEADING_ID"),t=r=>{if(r.composing||!r.editable)return;const i=n.get(Kd.key),s=r.state.tr.setMeta("addToHistory",!1);let o=!1;r.state.doc.descendants((a,l)=>{if(a.type===qs.type(n)){if(a.textContent.trim().length===0)return;const c=a.attrs,u=i(a);c.id!==u&&(o=!0,s.setMeta(e,!0).setNodeMarkup(l,void 0,{...c,id:u}))}}),o&&r.dispatch(s)};return new Gt({key:e,view:r=>(t(r),{update:i=>{t(i)}})})});H(a2,{displayName:"Prose<syncHeadingIdPlugin>",group:"Prose"});const l2=Vn(n=>{const e=t=>{if(t.composing||!t.editable)return;const r=Jo.type(n),i=Xo.type(n),s=kr.type(n),o=t.state,a=(u,d)=>{let f=!1;const h="".concat(d+1,".");return u.label!==h&&(u.label=h,f=!0),f};let l=o.tr,c=!1;o.doc.descendants((u,d,f,h)=>{if(u.type===i){const p=u.maybeChild(0);(p==null?void 0:p.type)===s&&p.attrs.listType==="ordered"&&(c=!0,l.setNodeMarkup(d,r,{spread:"true"}),u.descendants((m,g,w,x)=>{if(m.type===s){const M={...m.attrs};a(M,x)&&(l=l.setNodeMarkup(g,void 0,M))}return!1}))}else if(u.type===s&&(f==null?void 0:f.type)===r){const p={...u.attrs};let m=!1;p.listType!=="ordered"&&(p.listType="ordered",m=!0),f!=null&&f.maybeChild(0)&&(m=a(p,h)),m&&(l=l.setNodeMarkup(d,void 0,p),c=!0)}}),c&&t.dispatch(l.setMeta("addToHistory",!1))};return new Gt({key:new Bt("MILKDOWN_KEEP_LIST_ORDER"),view:t=>(e(t),{update:r=>{e(r)}})})});H(l2,{displayName:"Prose<syncListOrderPlugin>",group:"Prose"});const fW=[s2,Dg,o2,i2,Sg,Tg,Mg,Og,$g,a2,l2].flat(),hW=[iW,sW,oW,aW,lW,fW].flat();var Op,$p;if(typeof WeakMap<"u"){let n=new WeakMap;Op=e=>n.get(e),$p=(e,t)=>(n.set(e,t),t)}else{const n=[];let t=0;Op=r=>{for(let i=0;i<n.length;i+=2)if(n[i]==r)return n[i+1]},$p=(r,i)=>(t==10&&(t=0),n[t++]=r,n[t++]=i)}var qe=class{constructor(n,e,t,r){this.width=n,this.height=e,this.map=t,this.problems=r}findCell(n){for(let e=0;e<this.map.length;e++){const t=this.map[e];if(t!=n)continue;const r=e%this.width,i=e/this.width|0;let s=r+1,o=i+1;for(let a=1;s<this.width&&this.map[e+a]==t;a++)s++;for(let a=1;o<this.height&&this.map[e+this.width*a]==t;a++)o++;return{left:r,top:i,right:s,bottom:o}}throw new RangeError("No cell with offset ".concat(n," found"))}colCount(n){for(let e=0;e<this.map.length;e++)if(this.map[e]==n)return e%this.width;throw new RangeError("No cell with offset ".concat(n," found"))}nextCell(n,e,t){const{left:r,right:i,top:s,bottom:o}=this.findCell(n);return e=="horiz"?(t<0?r==0:i==this.width)?null:this.map[s*this.width+(t<0?r-1:i)]:(t<0?s==0:o==this.height)?null:this.map[r+this.width*(t<0?s-1:o)]}rectBetween(n,e){const{left:t,right:r,top:i,bottom:s}=this.findCell(n),{left:o,right:a,top:l,bottom:c}=this.findCell(e);return{left:Math.min(t,o),top:Math.min(i,l),right:Math.max(r,a),bottom:Math.max(s,c)}}cellsInRect(n){const e=[],t={};for(let r=n.top;r<n.bottom;r++)for(let i=n.left;i<n.right;i++){const s=r*this.width+i,o=this.map[s];t[o]||(t[o]=!0,!(i==n.left&&i&&this.map[s-1]==o||r==n.top&&r&&this.map[s-this.width]==o)&&e.push(o))}return e}positionAt(n,e,t){for(let r=0,i=0;;r++){const s=i+t.child(r).nodeSize;if(r==n){let o=e+n*this.width;const a=(n+1)*this.width;for(;o<a&&this.map[o]<i;)o++;return o==a?s-1:this.map[o]}i=s}}static get(n){return Op(n)||$p(n,pW(n))}};function pW(n){if(n.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+n.type.name);const e=mW(n),t=n.childCount,r=[];let i=0,s=null;const o=[];for(let c=0,u=e*t;c<u;c++)r[c]=0;for(let c=0,u=0;c<t;c++){const d=n.child(c);u++;for(let p=0;;p++){for(;i<r.length&&r[i]!=0;)i++;if(p==d.childCount)break;const m=d.child(p),{colspan:g,rowspan:w,colwidth:x}=m.attrs;for(let M=0;M<w;M++){if(M+c>=t){(s||(s=[])).push({type:"overlong_rowspan",pos:u,n:w-M});break}const b=i+M*e;for(let C=0;C<g;C++){r[b+C]==0?r[b+C]=u:(s||(s=[])).push({type:"collision",row:c,pos:u,n:g-C});const k=x&&x[C];if(k){const $=(b+C)%e*2,O=o[$];O==null||O!=k&&o[$+1]==1?(o[$]=k,o[$+1]=1):O==k&&o[$+1]++}}}i+=g,u+=m.nodeSize}const f=(c+1)*e;let h=0;for(;i<f;)r[i++]==0&&h++;h&&(s||(s=[])).push({type:"missing",row:c,n:h}),u++}const a=new qe(e,t,r,s);let l=!1;for(let c=0;!l&&c<o.length;c+=2)o[c]!=null&&o[c+1]<t&&(l=!0);return l&&gW(a,o,n),a}function mW(n){let e=-1,t=!1;for(let r=0;r<n.childCount;r++){const i=n.child(r);let s=0;if(t)for(let o=0;o<r;o++){const a=n.child(o);for(let l=0;l<a.childCount;l++){const c=a.child(l);o+c.attrs.rowspan>r&&(s+=c.attrs.colspan)}}for(let o=0;o<i.childCount;o++){const a=i.child(o);s+=a.attrs.colspan,a.attrs.rowspan>1&&(t=!0)}e==-1?e=s:e!=s&&(e=Math.max(e,s))}return e}function gW(n,e,t){n.problems||(n.problems=[]);const r={};for(let i=0;i<n.map.length;i++){const s=n.map[i];if(r[s])continue;r[s]=!0;const o=t.nodeAt(s);if(!o)throw new RangeError("No cell with offset ".concat(s," found"));let a=null;const l=o.attrs;for(let c=0;c<l.colspan;c++){const u=(i+c)%n.width,d=e[u*2];d!=null&&(!l.colwidth||l.colwidth[c]!=d)&&((a||(a=vW(l)))[c]=d)}a&&n.problems.unshift({type:"colwidth mismatch",pos:s,colwidth:a})}}function vW(n){if(n.colwidth)return n.colwidth.slice();const e=[];for(let t=0;t<n.colspan;t++)e.push(0);return e}function M0(n,e){if(typeof n=="string")return{};const t=n.getAttribute("data-colwidth"),r=t&&/^\d+(,\d+)*$/.test(t)?t.split(",").map(o=>Number(o)):null,i=Number(n.getAttribute("colspan")||1),s={colspan:i,rowspan:Number(n.getAttribute("rowspan")||1),colwidth:r&&r.length==i?r:null};for(const o in e){const a=e[o].getFromDOM,l=a&&a(n);l!=null&&(s[o]=l)}return s}function T0(n,e){const t={};n.attrs.colspan!=1&&(t.colspan=n.attrs.colspan),n.attrs.rowspan!=1&&(t.rowspan=n.attrs.rowspan),n.attrs.colwidth&&(t["data-colwidth"]=n.attrs.colwidth.join(","));for(const r in e){const i=e[r].setDOMAttr;i&&i(n.attrs[r],t)}return t}function yW(n){const e=n.cellAttributes||{},t={colspan:{default:1},rowspan:{default:1},colwidth:{default:null}};for(const r in e)t[r]={default:e[r].default};return{table:{content:"table_row+",tableRole:"table",isolating:!0,group:n.tableGroup,parseDOM:[{tag:"table"}],toDOM(){return["table",["tbody",0]]}},table_row:{content:"(table_cell | table_header)*",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM(){return["tr",0]}},table_cell:{content:n.cellContent,attrs:t,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs:r=>M0(r,e)}],toDOM(r){return["td",T0(r,e),0]}},table_header:{content:n.cellContent,attrs:t,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs:r=>M0(r,e)}],toDOM(r){return["th",T0(r,e),0]}}}}function Ln(n){let e=n.cached.tableNodeTypes;if(!e){e=n.cached.tableNodeTypes={};for(const t in n.nodes){const r=n.nodes[t],i=r.spec.tableRole;i&&(e[i]=r)}}return e}var hi=new Bt("selectingCells");function Wl(n){for(let e=n.depth-1;e>0;e--)if(n.node(e).type.spec.tableRole=="row")return n.node(0).resolve(n.before(e+1));return null}function cn(n){const e=n.selection.$head;for(let t=e.depth;t>0;t--)if(e.node(t).type.spec.tableRole=="row")return!0;return!1}function ef(n){const e=n.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&e.node.type.spec.tableRole=="cell")return e.$anchor;const t=Wl(e.$head)||bW(e.$head);if(t)return t;throw new RangeError("No cell found around position ".concat(e.head))}function bW(n){for(let e=n.nodeAfter,t=n.pos;e;e=e.firstChild,t++){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t)}for(let e=n.nodeBefore,t=n.pos;e;e=e.lastChild,t--){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t-e.nodeSize)}}function Dp(n){return n.parent.type.spec.tableRole=="row"&&!!n.nodeAfter}function wW(n){return n.node(0).resolve(n.pos+n.nodeAfter.nodeSize)}function Eg(n,e){return n.depth==e.depth&&n.pos>=e.start(-1)&&n.pos<=e.end(-1)}function c2(n,e,t){const r=n.node(-1),i=qe.get(r),s=n.start(-1),o=i.nextCell(n.pos-s,e,t);return o==null?null:n.node(0).resolve(s+o)}function Fs(n,e,t=1){const r={...n,colspan:n.colspan-t};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,t),r.colwidth.some(i=>i>0)||(r.colwidth=null)),r}function _W(n,e,t=1){const r={...n,colspan:n.colspan+t};if(r.colwidth){r.colwidth=r.colwidth.slice();for(let i=0;i<t;i++)r.colwidth.splice(e,0,0)}return r}function kW(n,e,t){const r=Ln(e.type.schema).header_cell;for(let i=0;i<n.height;i++)if(e.nodeAt(n.map[t+i*n.width]).type!=r)return!1;return!0}var tt=class Ar extends we{constructor(e,t=e){const r=e.node(-1),i=qe.get(r),s=e.start(-1),o=i.rectBetween(e.pos-s,t.pos-s),a=e.node(0),l=i.cellsInRect(o).filter(u=>u!=t.pos-s);l.unshift(t.pos-s);const c=l.map(u=>{const d=r.nodeAt(u);if(!d)throw RangeError("No cell with offset ".concat(u," found"));const f=s+u+1;return new uk(a.resolve(f),a.resolve(f+d.content.size))});super(c[0].$from,c[0].$to,c),this.$anchorCell=e,this.$headCell=t}map(e,t){const r=e.resolve(t.map(this.$anchorCell.pos)),i=e.resolve(t.map(this.$headCell.pos));if(Dp(r)&&Dp(i)&&Eg(r,i)){const s=this.$anchorCell.node(-1)!=r.node(-1);return s&&this.isRowSelection()?Ar.rowSelection(r,i):s&&this.isColSelection()?Ar.colSelection(r,i):new Ar(r,i)}return Me.between(r,i)}content(){const e=this.$anchorCell.node(-1),t=qe.get(e),r=this.$anchorCell.start(-1),i=t.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),s={},o=[];for(let l=i.top;l<i.bottom;l++){const c=[];for(let u=l*t.width+i.left,d=i.left;d<i.right;d++,u++){const f=t.map[u];if(s[f])continue;s[f]=!0;const h=t.findCell(f);let p=e.nodeAt(f);if(!p)throw RangeError("No cell with offset ".concat(f," found"));const m=i.left-h.left,g=h.right-i.right;if(m>0||g>0){let w=p.attrs;if(m>0&&(w=Fs(w,0,m)),g>0&&(w=Fs(w,w.colspan-g,g)),h.left<i.left){if(p=p.type.createAndFill(w),!p)throw RangeError("Could not create cell with attrs ".concat(JSON.stringify(w)))}else p=p.type.create(w,p.content)}if(h.top<i.top||h.bottom>i.bottom){const w={...p.attrs,rowspan:Math.min(h.bottom,i.bottom)-Math.max(h.top,i.top)};h.top<i.top?p=p.type.createAndFill(w):p=p.type.create(w,p.content)}c.push(p)}o.push(e.child(l).copy(q.from(c)))}const a=this.isColSelection()&&this.isRowSelection()?e:o;return new J(q.from(a),1,1)}replace(e,t=J.empty){const r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){const{$from:a,$to:l}=i[o],c=e.mapping.slice(r);e.replace(c.map(a.pos),c.map(l.pos),o?J.empty:t)}const s=we.findFrom(e.doc.resolve(e.mapping.slice(r).map(this.to)),-1);s&&e.setSelection(s)}replaceWith(e,t){this.replace(e,new J(q.from(t),0,0))}forEachCell(e){const t=this.$anchorCell.node(-1),r=qe.get(t),i=this.$anchorCell.start(-1),s=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-i,this.$headCell.pos-i));for(let o=0;o<s.length;o++)e(t.nodeAt(s[o]),i+s[o])}isColSelection(){const e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);if(Math.min(e,t)>0)return!1;const r=e+this.$anchorCell.nodeAfter.attrs.rowspan,i=t+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,i)==this.$headCell.node(-1).childCount}static colSelection(e,t=e){const r=e.node(-1),i=qe.get(r),s=e.start(-1),o=i.findCell(e.pos-s),a=i.findCell(t.pos-s),l=e.node(0);return o.top<=a.top?(o.top>0&&(e=l.resolve(s+i.map[o.left])),a.bottom<i.height&&(t=l.resolve(s+i.map[i.width*(i.height-1)+a.right-1]))):(a.top>0&&(t=l.resolve(s+i.map[a.left])),o.bottom<i.height&&(e=l.resolve(s+i.map[i.width*(i.height-1)+o.right-1]))),new Ar(e,t)}isRowSelection(){const e=this.$anchorCell.node(-1),t=qe.get(e),r=this.$anchorCell.start(-1),i=t.colCount(this.$anchorCell.pos-r),s=t.colCount(this.$headCell.pos-r);if(Math.min(i,s)>0)return!1;const o=i+this.$anchorCell.nodeAfter.attrs.colspan,a=s+this.$headCell.nodeAfter.attrs.colspan;return Math.max(o,a)==t.width}eq(e){return e instanceof Ar&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,t=e){const r=e.node(-1),i=qe.get(r),s=e.start(-1),o=i.findCell(e.pos-s),a=i.findCell(t.pos-s),l=e.node(0);return o.left<=a.left?(o.left>0&&(e=l.resolve(s+i.map[o.top*i.width])),a.right<i.width&&(t=l.resolve(s+i.map[i.width*(a.top+1)-1]))):(a.left>0&&(t=l.resolve(s+i.map[a.top*i.width])),o.right<i.width&&(e=l.resolve(s+i.map[i.width*(o.top+1)-1]))),new Ar(e,t)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,t){return new Ar(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){return new Ar(e.resolve(t),e.resolve(r))}getBookmark(){return new xW(this.$anchorCell.pos,this.$headCell.pos)}};tt.prototype.visible=!1;we.jsonID("cell",tt);var xW=class u2{constructor(e,t){this.anchor=e,this.head=t}map(e){return new u2(e.map(this.anchor),e.map(this.head))}resolve(e){const t=e.resolve(this.anchor),r=e.resolve(this.head);return t.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&t.index()<t.parent.childCount&&r.index()<r.parent.childCount&&Eg(t,r)?new tt(t,r):we.near(r,1)}};function CW(n){if(!(n.selection instanceof tt))return null;const e=[];return n.selection.forEachCell((t,r)=>{e.push(Ut.node(r,r+t.nodeSize,{class:"selectedCell"}))}),Qe.create(n.doc,e)}function SW({$from:n,$to:e}){if(n.pos==e.pos||n.pos<n.pos-6)return!1;let t=n.pos,r=e.pos,i=n.depth;for(;i>=0&&!(n.after(i+1)<n.end(i));i--,t++);for(let s=e.depth;s>=0&&!(e.before(s+1)>e.start(s));s--,r--);return t==r&&/row|table/.test(n.node(i).type.spec.tableRole)}function MW({$from:n,$to:e}){let t,r;for(let i=n.depth;i>0;i--){const s=n.node(i);if(s.type.spec.tableRole==="cell"||s.type.spec.tableRole==="header_cell"){t=s;break}}for(let i=e.depth;i>0;i--){const s=e.node(i);if(s.type.spec.tableRole==="cell"||s.type.spec.tableRole==="header_cell"){r=s;break}}return t!==r&&e.parentOffset===0}function TW(n,e,t){const r=(e||n).selection,i=(e||n).doc;let s,o;if(r instanceof ye&&(o=r.node.type.spec.tableRole)){if(o=="cell"||o=="header_cell")s=tt.create(i,r.from);else if(o=="row"){const a=i.resolve(r.from+1);s=tt.rowSelection(a,a)}else if(!t){const a=qe.get(r.node),l=r.from+1,c=l+a.map[a.width*a.height-1];s=tt.create(i,l+1,c)}}else r instanceof Me&&SW(r)?s=Me.create(i,r.from):r instanceof Me&&MW(r)&&(s=Me.create(i,r.$from.start(),r.$from.end()));return s&&(e||(e=n.tr)).setSelection(s),e}var OW=new Bt("fix-tables");function d2(n,e,t,r){const i=n.childCount,s=e.childCount;e:for(let o=0,a=0;o<s;o++){const l=e.child(o);for(let c=a,u=Math.min(i,o+3);c<u;c++)if(n.child(c)==l){a=c+1,t+=l.nodeSize;continue e}r(l,t),a<i&&n.child(a).sameMarkup(l)?d2(n.child(a),l,t+1,r):l.nodesBetween(0,l.content.size,r,t+1),t+=l.nodeSize}}function $W(n,e){let t;const r=(i,s)=>{i.type.spec.tableRole=="table"&&(t=DW(n,i,s,t))};return e?e.doc!=n.doc&&d2(e.doc,n.doc,0,r):n.doc.descendants(r),t}function DW(n,e,t,r){const i=qe.get(e);if(!i.problems)return r;r||(r=n.tr);const s=[];for(let l=0;l<i.height;l++)s.push(0);for(let l=0;l<i.problems.length;l++){const c=i.problems[l];if(c.type=="collision"){const u=e.nodeAt(c.pos);if(!u)continue;const d=u.attrs;for(let f=0;f<d.rowspan;f++)s[c.row+f]+=c.n;r.setNodeMarkup(r.mapping.map(t+1+c.pos),null,Fs(d,d.colspan-c.n,c.n))}else if(c.type=="missing")s[c.row]+=c.n;else if(c.type=="overlong_rowspan"){const u=e.nodeAt(c.pos);if(!u)continue;r.setNodeMarkup(r.mapping.map(t+1+c.pos),null,{...u.attrs,rowspan:u.attrs.rowspan-c.n})}else if(c.type=="colwidth mismatch"){const u=e.nodeAt(c.pos);if(!u)continue;r.setNodeMarkup(r.mapping.map(t+1+c.pos),null,{...u.attrs,colwidth:c.colwidth})}}let o,a;for(let l=0;l<s.length;l++)s[l]&&(o==null&&(o=l),a=l);for(let l=0,c=t+1;l<i.height;l++){const u=e.child(l),d=c+u.nodeSize,f=s[l];if(f>0){let h="cell";u.firstChild&&(h=u.firstChild.type.spec.tableRole);const p=[];for(let g=0;g<f;g++){const w=Ln(n.schema)[h].createAndFill();w&&p.push(w)}const m=(l==0||o==l-1)&&a==l?c+1:d-1;r.insert(r.mapping.map(m),p)}c=d}return r.setMeta(OW,{fixTables:!0})}function EW(n){if(!n.size)return null;let{content:e,openStart:t,openEnd:r}=n;for(;e.childCount==1&&(t>0&&r>0||e.child(0).type.spec.tableRole=="table");)t--,r--,e=e.child(0).content;const i=e.child(0),s=i.type.spec.tableRole,o=i.type.schema,a=[];if(s=="row")for(let l=0;l<e.childCount;l++){let c=e.child(l).content;const u=l?0:Math.max(0,t-1),d=l<e.childCount-1?0:Math.max(0,r-1);(u||d)&&(c=Ep(Ln(o).row,new J(c,u,d)).content),a.push(c)}else if(s=="cell"||s=="header_cell")a.push(t||r?Ep(Ln(o).row,new J(e,t,r)).content:e);else return null;return AW(o,a)}function AW(n,e){const t=[];for(let i=0;i<e.length;i++){const s=e[i];for(let o=s.childCount-1;o>=0;o--){const{rowspan:a,colspan:l}=s.child(o).attrs;for(let c=i;c<i+a;c++)t[c]=(t[c]||0)+l}}let r=0;for(let i=0;i<t.length;i++)r=Math.max(r,t[i]);for(let i=0;i<t.length;i++)if(i>=e.length&&e.push(q.empty),t[i]<r){const s=Ln(n).cell.createAndFill(),o=[];for(let a=t[i];a<r;a++)o.push(s);e[i]=e[i].append(q.from(o))}return{height:e.length,width:r,rows:e}}function Ep(n,e){const t=n.createAndFill();return new ck(t).replace(0,t.content.size,e).doc}function PW({width:n,height:e,rows:t},r,i){if(n!=r){const s=[],o=[];for(let a=0;a<t.length;a++){const l=t[a],c=[];for(let u=s[a]||0,d=0;u<r;d++){let f=l.child(d%l.childCount);u+f.attrs.colspan>r&&(f=f.type.createChecked(Fs(f.attrs,f.attrs.colspan,u+f.attrs.colspan-r),f.content)),c.push(f),u+=f.attrs.colspan;for(let h=1;h<f.attrs.rowspan;h++)s[a+h]=(s[a+h]||0)+f.attrs.colspan}o.push(q.from(c))}t=o,n=r}if(e!=i){const s=[];for(let o=0,a=0;o<i;o++,a++){const l=[],c=t[a%e];for(let u=0;u<c.childCount;u++){let d=c.child(u);o+d.attrs.rowspan>i&&(d=d.type.create({...d.attrs,rowspan:Math.max(1,i-d.attrs.rowspan)},d.content)),l.push(d)}s.push(q.from(l))}t=s,e=i}return{width:n,height:e,rows:t}}function NW(n,e,t,r,i,s,o){const a=n.doc.type.schema,l=Ln(a);let c,u;if(i>e.width)for(let d=0,f=0;d<e.height;d++){const h=t.child(d);f+=h.nodeSize;const p=[];let m;h.lastChild==null||h.lastChild.type==l.cell?m=c||(c=l.cell.createAndFill()):m=u||(u=l.header_cell.createAndFill());for(let g=e.width;g<i;g++)p.push(m);n.insert(n.mapping.slice(o).map(f-1+r),p)}if(s>e.height){const d=[];for(let p=0,m=(e.height-1)*e.width;p<Math.max(e.width,i);p++){const g=p>=e.width?!1:t.nodeAt(e.map[m+p]).type==l.header_cell;d.push(g?u||(u=l.header_cell.createAndFill()):c||(c=l.cell.createAndFill()))}const f=l.row.create(null,q.from(d)),h=[];for(let p=e.height;p<s;p++)h.push(f);n.insert(n.mapping.slice(o).map(r+t.nodeSize-2),h)}return!!(c||u)}function O0(n,e,t,r,i,s,o,a){if(o==0||o==e.height)return!1;let l=!1;for(let c=i;c<s;c++){const u=o*e.width+c,d=e.map[u];if(e.map[u-e.width]==d){l=!0;const f=t.nodeAt(d),{top:h,left:p}=e.findCell(d);n.setNodeMarkup(n.mapping.slice(a).map(d+r),null,{...f.attrs,rowspan:o-h}),n.insert(n.mapping.slice(a).map(e.positionAt(o,p,t)),f.type.createAndFill({...f.attrs,rowspan:h+f.attrs.rowspan-o})),c+=f.attrs.colspan-1}}return l}function $0(n,e,t,r,i,s,o,a){if(o==0||o==e.width)return!1;let l=!1;for(let c=i;c<s;c++){const u=c*e.width+o,d=e.map[u];if(e.map[u-1]==d){l=!0;const f=t.nodeAt(d),h=e.colCount(d),p=n.mapping.slice(a).map(d+r);n.setNodeMarkup(p,null,Fs(f.attrs,o-h,f.attrs.colspan-(o-h))),n.insert(p+f.nodeSize,f.type.createAndFill(Fs(f.attrs,0,o-h))),c+=f.attrs.rowspan-1}}return l}function D0(n,e,t,r,i){let s=t?n.doc.nodeAt(t-1):n.doc;if(!s)throw new Error("No table found");let o=qe.get(s);const{top:a,left:l}=r,c=l+i.width,u=a+i.height,d=n.tr;let f=0;function h(){if(s=t?d.doc.nodeAt(t-1):d.doc,!s)throw new Error("No table found");o=qe.get(s),f=d.mapping.maps.length}NW(d,o,s,t,c,u,f)&&h(),O0(d,o,s,t,l,c,a,f)&&h(),O0(d,o,s,t,l,c,u,f)&&h(),$0(d,o,s,t,a,u,l,f)&&h(),$0(d,o,s,t,a,u,c,f)&&h();for(let p=a;p<u;p++){const m=o.positionAt(p,l,s),g=o.positionAt(p,c,s);d.replace(d.mapping.slice(f).map(m+t),d.mapping.slice(f).map(g+t),new J(i.rows[p-a],0,0))}h(),d.setSelection(new tt(d.doc.resolve(t+o.positionAt(a,l,s)),d.doc.resolve(t+o.positionAt(u-1,c-1,s)))),e(d)}var RW=yx({ArrowLeft:Cc("horiz",-1),ArrowRight:Cc("horiz",1),ArrowUp:Cc("vert",-1),ArrowDown:Cc("vert",1),"Shift-ArrowLeft":Sc("horiz",-1),"Shift-ArrowRight":Sc("horiz",1),"Shift-ArrowUp":Sc("vert",-1),"Shift-ArrowDown":Sc("vert",1),Backspace:Mc,"Mod-Backspace":Mc,Delete:Mc,"Mod-Delete":Mc});function yu(n,e,t){return t.eq(n.selection)?!1:(e&&e(n.tr.setSelection(t).scrollIntoView()),!0)}function Cc(n,e){return(t,r,i)=>{if(!i)return!1;const s=t.selection;if(s instanceof tt)return yu(t,r,we.near(s.$headCell,e));if(n!="horiz"&&!s.empty)return!1;const o=f2(i,n,e);if(o==null)return!1;if(n=="horiz")return yu(t,r,we.near(t.doc.resolve(s.head+e),e));{const a=t.doc.resolve(o),l=c2(a,n,e);let c;return l?c=we.near(l,1):e<0?c=we.near(t.doc.resolve(a.before(-1)),-1):c=we.near(t.doc.resolve(a.after(-1)),1),yu(t,r,c)}}}function Sc(n,e){return(t,r,i)=>{if(!i)return!1;const s=t.selection;let o;if(s instanceof tt)o=s;else{const l=f2(i,n,e);if(l==null)return!1;o=new tt(t.doc.resolve(l))}const a=c2(o.$headCell,n,e);return a?yu(t,r,new tt(o.$anchorCell,a)):!1}}function Mc(n,e){const t=n.selection;if(!(t instanceof tt))return!1;if(e){const r=n.tr,i=Ln(n.schema).cell.createAndFill().content;t.forEachCell((s,o)=>{s.content.eq(i)||r.replace(r.mapping.map(o+1),r.mapping.map(o+s.nodeSize-1),new J(i,0,0))}),r.docChanged&&e(r)}return!0}function LW(n,e){const t=n.state.doc,r=Wl(t.resolve(e));return r?(n.dispatch(n.state.tr.setSelection(new tt(r))),!0):!1}function IW(n,e,t){if(!cn(n.state))return!1;let r=EW(t);const i=n.state.selection;if(i instanceof tt){r||(r={width:1,height:1,rows:[q.from(Ep(Ln(n.state.schema).cell,t))]});const s=i.$anchorCell.node(-1),o=i.$anchorCell.start(-1),a=qe.get(s).rectBetween(i.$anchorCell.pos-o,i.$headCell.pos-o);return r=PW(r,a.right-a.left,a.bottom-a.top),D0(n.state,n.dispatch,o,a,r),!0}else if(r){const s=ef(n.state),o=s.start(-1);return D0(n.state,n.dispatch,o,qe.get(s.node(-1)).findCell(s.pos-o),r),!0}else return!1}function zW(n,e){var t;if(e.ctrlKey||e.metaKey)return;const r=E0(n,e.target);let i;if(e.shiftKey&&n.state.selection instanceof tt)s(n.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&r&&(i=Wl(n.state.selection.$anchor))!=null&&((t=oh(n,e))==null?void 0:t.pos)!=i.pos)s(i,e),e.preventDefault();else if(!r)return;function s(l,c){let u=oh(n,c);const d=hi.getState(n.state)==null;if(!u||!Eg(l,u))if(d)u=l;else return;const f=new tt(l,u);if(d||!n.state.selection.eq(f)){const h=n.state.tr.setSelection(f);d&&h.setMeta(hi,l.pos),n.dispatch(h)}}function o(){n.root.removeEventListener("mouseup",o),n.root.removeEventListener("dragstart",o),n.root.removeEventListener("mousemove",a),hi.getState(n.state)!=null&&n.dispatch(n.state.tr.setMeta(hi,-1))}function a(l){const c=l,u=hi.getState(n.state);let d;if(u!=null)d=n.state.doc.resolve(u);else if(E0(n,c.target)!=r&&(d=oh(n,e),!d))return o();d&&s(d,c)}n.root.addEventListener("mouseup",o),n.root.addEventListener("dragstart",o),n.root.addEventListener("mousemove",a)}function f2(n,e,t){if(!(n.state.selection instanceof Me))return null;const{$head:r}=n.state.selection;for(let i=r.depth-1;i>=0;i--){const s=r.node(i);if((t<0?r.index(i):r.indexAfter(i))!=(t<0?0:s.childCount))return null;if(s.type.spec.tableRole=="cell"||s.type.spec.tableRole=="header_cell"){const a=r.before(i),l=e=="vert"?t>0?"down":"up":t>0?"right":"left";return n.endOfTextblock(l)?a:null}}return null}function E0(n,e){for(;e&&e!=n.dom;e=e.parentNode)if(e.nodeName=="TD"||e.nodeName=="TH")return e;return null}function oh(n,e){const t=n.posAtCoords({left:e.clientX,top:e.clientY});return t&&t?Wl(n.state.doc.resolve(t.pos)):null}var h2=class{constructor(e,t){this.node=e,this.cellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Ap(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!=this.node.type?!1:(this.node=e,Ap(e,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(e){return e.type=="attributes"&&(e.target==this.table||this.colgroup.contains(e.target))}};function Ap(n,e,t,r,i,s){var o;let a=0,l=!0,c=e.firstChild;const u=n.firstChild;if(u){for(let d=0,f=0;d<u.childCount;d++){const{colspan:h,colwidth:p}=u.child(d).attrs;for(let m=0;m<h;m++,f++){const g=i==f?s:p&&p[m],w=g?g+"px":"";a+=g||r,g||(l=!1),c?(c.style.width!=w&&(c.style.width=w),c=c.nextSibling):e.appendChild(document.createElement("col")).style.width=w}}for(;c;){const d=c.nextSibling;(o=c.parentNode)==null||o.removeChild(c),c=d}l?(t.style.width=a+"px",t.style.minWidth=""):(t.style.width="",t.style.minWidth=a+"px")}}var Dn=new Bt("tableColumnResizing");function p2({handleWidth:n=5,cellMinWidth:e=25,View:t=h2,lastColumnResizable:r=!0}={}){const i=new Gt({key:Dn,state:{init(s,o){return i.spec.props.nodeViews[Ln(o.schema).table.name]=(a,l)=>new t(a,e,l),new BW(-1,!1)},apply(s,o){return o.apply(s)}},props:{attributes:s=>{const o=Dn.getState(s);return o&&o.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(s,o)=>{FW(s,o,n,e,r)},mouseleave:s=>{VW(s)},mousedown:(s,o)=>{HW(s,o,e)}},decorations:s=>{const o=Dn.getState(s);if(o&&o.activeHandle>-1)return KW(s,o.activeHandle)},nodeViews:{}}});return i}var BW=class bu{constructor(e,t){this.activeHandle=e,this.dragging=t}apply(e){const t=this,r=e.getMeta(Dn);if(r&&r.setHandle!=null)return new bu(r.setHandle,!1);if(r&&r.setDragging!==void 0)return new bu(t.activeHandle,r.setDragging);if(t.activeHandle>-1&&e.docChanged){let i=e.mapping.map(t.activeHandle,-1);return Dp(e.doc.resolve(i))||(i=-1),new bu(i,t.dragging)}return t}};function FW(n,e,t,r,i){const s=Dn.getState(n.state);if(s&&!s.dragging){const o=jW(e.target);let a=-1;if(o){const{left:l,right:c}=o.getBoundingClientRect();e.clientX-l<=t?a=A0(n,e,"left",t):c-e.clientX<=t&&(a=A0(n,e,"right",t))}if(a!=s.activeHandle){if(!i&&a!==-1){const l=n.state.doc.resolve(a),c=l.node(-1),u=qe.get(c),d=l.start(-1);if(u.colCount(l.pos-d)+l.nodeAfter.attrs.colspan-1==u.width-1)return}m2(n,a)}}}function VW(n){const e=Dn.getState(n.state);e&&e.activeHandle>-1&&!e.dragging&&m2(n,-1)}function HW(n,e,t){const r=Dn.getState(n.state);if(!r||r.activeHandle==-1||r.dragging)return!1;const i=n.state.doc.nodeAt(r.activeHandle),s=WW(n,r.activeHandle,i.attrs);n.dispatch(n.state.tr.setMeta(Dn,{setDragging:{startX:e.clientX,startWidth:s}}));function o(l){window.removeEventListener("mouseup",o),window.removeEventListener("mousemove",a);const c=Dn.getState(n.state);c!=null&&c.dragging&&(UW(n,c.activeHandle,P0(c.dragging,l,t)),n.dispatch(n.state.tr.setMeta(Dn,{setDragging:null})))}function a(l){if(!l.which)return o(l);const c=Dn.getState(n.state);if(c&&c.dragging){const u=P0(c.dragging,l,t);qW(n,c.activeHandle,u,t)}}return window.addEventListener("mouseup",o),window.addEventListener("mousemove",a),e.preventDefault(),!0}function WW(n,e,{colspan:t,colwidth:r}){const i=r&&r[r.length-1];if(i)return i;const s=n.domAtPos(e);let a=s.node.childNodes[s.offset].offsetWidth,l=t;if(r)for(let c=0;c<t;c++)r[c]&&(a-=r[c],l--);return a/l}function jW(n){for(;n&&n.nodeName!="TD"&&n.nodeName!="TH";)n=n.classList&&n.classList.contains("ProseMirror")?null:n.parentNode;return n}function A0(n,e,t,r){const i=t=="right"?-r:r,s=n.posAtCoords({left:e.clientX+i,top:e.clientY});if(!s)return-1;const{pos:o}=s,a=Wl(n.state.doc.resolve(o));if(!a)return-1;if(t=="right")return a.pos;const l=qe.get(a.node(-1)),c=a.start(-1),u=l.map.indexOf(a.pos-c);return u%l.width==0?-1:c+l.map[u-1]}function P0(n,e,t){const r=e.clientX-n.startX;return Math.max(t,n.startWidth+r)}function m2(n,e){n.dispatch(n.state.tr.setMeta(Dn,{setHandle:e}))}function UW(n,e,t){const r=n.state.doc.resolve(e),i=r.node(-1),s=qe.get(i),o=r.start(-1),a=s.colCount(r.pos-o)+r.nodeAfter.attrs.colspan-1,l=n.state.tr;for(let c=0;c<s.height;c++){const u=c*s.width+a;if(c&&s.map[u]==s.map[u-s.width])continue;const d=s.map[u],f=i.nodeAt(d).attrs,h=f.colspan==1?0:a-s.colCount(d);if(f.colwidth&&f.colwidth[h]==t)continue;const p=f.colwidth?f.colwidth.slice():YW(f.colspan);p[h]=t,l.setNodeMarkup(o+d,null,{...f,colwidth:p})}l.docChanged&&n.dispatch(l)}function qW(n,e,t,r){const i=n.state.doc.resolve(e),s=i.node(-1),o=i.start(-1),a=qe.get(s).colCount(i.pos-o)+i.nodeAfter.attrs.colspan-1;let l=n.domAtPos(i.start(-1)).node;for(;l&&l.nodeName!="TABLE";)l=l.parentNode;l&&Ap(s,l.firstChild,l,r,a,t)}function YW(n){return Array(n).fill(0)}function KW(n,e){const t=[],r=n.doc.resolve(e),i=r.node(-1);if(!i)return Qe.empty;const s=qe.get(i),o=r.start(-1),a=s.colCount(r.pos-o)+r.nodeAfter.attrs.colspan;for(let l=0;l<s.height;l++){const c=a+l*s.width-1;if((a==s.width||s.map[c]!=s.map[c+1])&&(l==0||s.map[c]!=s.map[c-s.width])){const u=s.map[c],d=o+u+i.nodeAt(u).nodeSize-1,f=document.createElement("div");f.className="column-resize-handle",t.push(Ut.widget(d,f))}}return Qe.create(n.doc,t)}function Hi(n){const e=n.selection,t=ef(n),r=t.node(-1),i=t.start(-1),s=qe.get(r);return{...e instanceof tt?s.rectBetween(e.$anchorCell.pos-i,e.$headCell.pos-i):s.findCell(t.pos-i),tableStart:i,map:s,table:r}}function g2(n,{map:e,tableStart:t,table:r},i){let s=i>0?-1:0;kW(e,r,i+s)&&(s=i==0||i==e.width?null:0);for(let o=0;o<e.height;o++){const a=o*e.width+i;if(i>0&&i<e.width&&e.map[a-1]==e.map[a]){const l=e.map[a],c=r.nodeAt(l);n.setNodeMarkup(n.mapping.map(t+l),null,_W(c.attrs,i-e.colCount(l))),o+=c.attrs.rowspan-1}else{const l=s==null?Ln(r.type.schema).cell:r.nodeAt(e.map[a+s]).type,c=e.positionAt(o,i,r);n.insert(n.mapping.map(t+c),l.createAndFill())}}return n}function GW(n,e){if(!cn(n))return!1;if(e){const t=Hi(n);e(g2(n.tr,t,t.left))}return!0}function XW(n,e){if(!cn(n))return!1;if(e){const t=Hi(n);e(g2(n.tr,t,t.right))}return!0}function JW(n,{map:e,table:t,tableStart:r},i){const s=n.mapping.maps.length;for(let o=0;o<e.height;){const a=o*e.width+i,l=e.map[a],c=t.nodeAt(l),u=c.attrs;if(i>0&&e.map[a-1]==l||i<e.width-1&&e.map[a+1]==l)n.setNodeMarkup(n.mapping.slice(s).map(r+l),null,Fs(u,i-e.colCount(l)));else{const d=n.mapping.slice(s).map(r+l);n.delete(d,d+c.nodeSize)}o+=u.rowspan}}function ZW(n,e){if(!cn(n))return!1;if(e){const t=Hi(n),r=n.tr;if(t.left==0&&t.right==t.map.width)return!1;for(let i=t.right-1;JW(r,t,i),i!=t.left;i--){const s=t.tableStart?r.doc.nodeAt(t.tableStart-1):r.doc;if(!s)throw RangeError("No table found");t.table=s,t.map=qe.get(s)}e(r)}return!0}function QW(n,{map:e,table:t,tableStart:r},i){let s=0;for(let c=0;c<i;c++)s+=t.child(c).nodeSize;const o=s+t.child(i).nodeSize,a=n.mapping.maps.length;n.delete(s+r,o+r);const l=new Set;for(let c=0,u=i*e.width;c<e.width;c++,u++){const d=e.map[u];if(!l.has(d)){if(l.add(d),i>0&&d==e.map[u-e.width]){const f=t.nodeAt(d).attrs;n.setNodeMarkup(n.mapping.slice(a).map(d+r),null,{...f,rowspan:f.rowspan-1}),c+=f.colspan-1}else if(i<e.height&&d==e.map[u+e.width]){const f=t.nodeAt(d),h=f.attrs,p=f.type.create({...h,rowspan:f.attrs.rowspan-1},f.content),m=e.positionAt(i+1,c,t);n.insert(n.mapping.slice(a).map(r+m),p),c+=h.colspan-1}}}}function ej(n,e){if(!cn(n))return!1;if(e){const t=Hi(n),r=n.tr;if(t.top==0&&t.bottom==t.map.height)return!1;for(let i=t.bottom-1;QW(r,t,i),i!=t.top;i--){const s=t.tableStart?r.doc.nodeAt(t.tableStart-1):r.doc;if(!s)throw RangeError("No table found");t.table=s,t.map=qe.get(t.table)}e(r)}return!0}function tj(n,e){return function(t,r){if(!cn(t))return!1;const i=ef(t);if(i.nodeAfter.attrs[n]===e)return!1;if(r){const s=t.tr;t.selection instanceof tt?t.selection.forEachCell((o,a)=>{o.attrs[n]!==e&&s.setNodeMarkup(a,null,{...o.attrs,[n]:e})}):s.setNodeMarkup(i.pos,null,{...i.nodeAfter.attrs,[n]:e}),r(s)}return!0}}function nj(n){return function(e,t){if(!cn(e))return!1;if(t){const r=Ln(e.schema),i=Hi(e),s=e.tr,o=i.map.cellsInRect(n=="column"?{left:i.left,top:0,right:i.right,bottom:i.map.height}:n=="row"?{left:0,top:i.top,right:i.map.width,bottom:i.bottom}:i),a=o.map(l=>i.table.nodeAt(l));for(let l=0;l<o.length;l++)a[l].type==r.header_cell&&s.setNodeMarkup(i.tableStart+o[l],r.cell,a[l].attrs);if(s.steps.length==0)for(let l=0;l<o.length;l++)s.setNodeMarkup(i.tableStart+o[l],r.header_cell,a[l].attrs);t(s)}return!0}}function N0(n,e,t){const r=e.map.cellsInRect({left:0,top:0,right:n=="row"?e.map.width:1,bottom:n=="column"?e.map.height:1});for(let i=0;i<r.length;i++){const s=e.table.nodeAt(r[i]);if(s&&s.type!==t.header_cell)return!1}return!0}function Ag(n,e){return e=e||{useDeprecatedLogic:!1},e.useDeprecatedLogic?nj(n):function(t,r){if(!cn(t))return!1;if(r){const i=Ln(t.schema),s=Hi(t),o=t.tr,a=N0("row",s,i),l=N0("column",s,i),u=(n==="column"?a:n==="row"?l:!1)?1:0,d=n=="column"?{left:0,top:u,right:1,bottom:s.map.height}:n=="row"?{left:u,top:0,right:s.map.width,bottom:1}:s,f=n=="column"?l?i.cell:i.header_cell:n=="row"?a?i.cell:i.header_cell:i.cell;s.map.cellsInRect(d).forEach(h=>{const p=h+s.tableStart,m=o.doc.nodeAt(p);m&&o.setNodeMarkup(p,f,m.attrs)}),r(o)}return!0}}Ag("row",{useDeprecatedLogic:!0});Ag("column",{useDeprecatedLogic:!0});Ag("cell",{useDeprecatedLogic:!0});function rj(n,e){if(e<0){const t=n.nodeBefore;if(t)return n.pos-t.nodeSize;for(let r=n.index(-1)-1,i=n.before();r>=0;r--){const s=n.node(-1).child(r),o=s.lastChild;if(o)return i-1-o.nodeSize;i-=s.nodeSize}}else{if(n.index()<n.parent.childCount-1)return n.pos+n.nodeAfter.nodeSize;const t=n.node(-1);for(let r=n.indexAfter(-1),i=n.after();r<t.childCount;r++){const s=t.child(r);if(s.childCount)return i+1;i+=s.nodeSize}}return null}function v2(n){return function(e,t){if(!cn(e))return!1;const r=rj(ef(e),n);if(r==null)return!1;if(t){const i=e.doc.resolve(r);t(e.tr.setSelection(Me.between(i,wW(i))).scrollIntoView())}return!0}}function ij(n,e){const t=n.selection.$anchor;for(let r=t.depth;r>0;r--)if(t.node(r).type.spec.tableRole=="table")return e&&e(n.tr.delete(t.before(r),t.after(r)).scrollIntoView()),!0;return!1}function sj({allowTableNodeSelection:n=!1}={}){return new Gt({key:hi,state:{init(){return null},apply(e,t){const r=e.getMeta(hi);if(r!=null)return r==-1?null:r;if(t==null||!e.docChanged)return t;const{deleted:i,pos:s}=e.mapping.mapResult(t);return i?null:s}},props:{decorations:CW,handleDOMEvents:{mousedown:zW},createSelectionBetween(e){return hi.getState(e.state)!=null?e.state.selection:null},handleTripleClick:LW,handleKeyDown:RW,handlePaste:IW},appendTransaction(e,t,r){return TW(r,$W(r,t),n)}})}function _e(n,e){return Object.assign(n,{meta:{package:"@milkdown/preset-gfm",...e}}),n}const Pg=zl("strike_through");_e(Pg,{displayName:"Attr<strikethrough>",group:"Strikethrough"});const jl=Il("strike_through",n=>({parseDOM:[{tag:"del"},{style:"text-decoration",getAttrs:e=>e==="line-through"}],toDOM:e=>["del",n.get(Pg.key)(e)],parseMarkdown:{match:e=>e.type==="delete",runner:(e,t,r)=>{e.openMark(r),e.next(t.children),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="strike_through",runner:(e,t)=>{e.withMark(t,"delete")}}}));_e(jl.mark,{displayName:"MarkSchema<strikethrough>",group:"Strikethrough"});_e(jl.ctx,{displayName:"MarkSchemaCtx<strikethrough>",group:"Strikethrough"});const Ng=Oe("ToggleStrikeThrough",n=>()=>Vd(jl.type(n)));_e(Ng,{displayName:"Command<ToggleStrikethrough>",group:"Strikethrough"});const y2=dn(n=>Ll(/~([^~]+)~$/,jl.type(n)));_e(y2,{displayName:"InputRule<strikethrough>",group:"Strikethrough"});const Rg=hn("strikeThroughKeymap",{ToggleStrikethrough:{shortcuts:"Mod-Alt-x",command:n=>{const e=n.get(xe);return()=>e.call(Ng.key)}}});_e(Rg.ctx,{displayName:"KeymapCtx<strikethrough>",group:"Strikethrough"});_e(Rg.shortcuts,{displayName:"Keymap<strikethrough>",group:"Strikethrough"});function b2(n,e=3,t=3){const r=Array(t).fill(0).map(()=>Yl.type(n).createAndFill()),i=Array(t).fill(0).map(()=>nf.type(n).createAndFill()),s=Array(e).fill(0).map((o,a)=>ql.type(n).create(null,a===0?i:r));return Ul.type(n).create(null,s)}function Zo(n){return kV(e=>e.type.spec.tableRole==="table")(n)}function ds(n,e){const t=Zo(e);if(!t)return;const r=qe.get(t.node);if(!(n<0||n>=r.width))return r.cellsInRect({left:n,right:n+1,top:0,bottom:r.height}).map(i=>{const s=t.node.nodeAt(i);if(!s)return;const o=i+t.start;return{pos:o,start:o+1,node:s}}).filter(i=>i!=null)}function fs(n,e){const t=Zo(e);if(!t)return;const r=qe.get(t.node);if(!(n<0||n>=r.height))return r.cellsInRect({left:0,right:r.width,top:n,bottom:n+1}).map(i=>{const s=t.node.nodeAt(i);if(!s)return;const o=i+t.start;return{pos:o,start:o+1,node:s}}).filter(i=>i!=null)}function oj(n){const e=Zo(n);if(!e)return;const t=qe.get(e.node);return t.cellsInRect({left:0,right:t.width,top:0,bottom:t.height}).map(r=>{const i=e.node.nodeAt(r),s=r+e.start;return{pos:s,start:s+1,node:i}})}function aj(n){const e=oj(n.selection);if(e&&e[0]){const t=n.doc.resolve(e[0].pos),r=e[e.length-1];if(r){const i=n.doc.resolve(r.pos);return Fd(n.setSelection(new tt(i,t)))}}return n}function w2(n,e,{map:t,tableStart:r,table:i},s){const o=Array(s).fill(0).reduce((l,c,u)=>l+i.child(u).nodeSize,r),a=Array(t.width).fill(0).map((l,c)=>{const u=i.nodeAt(t.map[c]);return Yl.type(n).createAndFill({alignment:u==null?void 0:u.attrs.alignment})});return e.insert(o,ql.type(n).create(null,a)),e}function _2(n){return e=>t=>{const r=Zo(t.selection),i=n==="row";if(r){const s=qe.get(r.node);if(e>=0&&e<(i?s.height:s.width)){const o=s.positionAt(i?e:s.height-1,i?s.width-1:e,r.node),a=t.doc.resolve(r.start+o),l=i?tt.rowSelection:tt.colSelection,c=s.positionAt(i?e:0,i?0:e,r.node),u=t.doc.resolve(r.start+c);return Fd(t.setSelection(l(a,u)))}}return t}}const lj=_2("row"),cj=_2("col");function R0(n){return n[0].map((e,t)=>n.map(r=>r[t]))}function k2(n,e){const t=[],r=qe.get(n);for(let i=0;i<r.height;i++){const s=n.child(i),o=[];for(let a=0;a<r.width;a++){if(!e[i][a])continue;const l=r.map[i*r.width+a],c=e[i][a],u=n.nodeAt(l).type.createChecked(Object.assign({},c.attrs),c.content,c.marks);o.push(u)}t.push(s.type.createChecked(s.attrs,o,s.marks))}return n.type.createChecked(n.attrs,t,n.marks)}function x2(n){const e=qe.get(n),t=[];for(let r=0;r<e.height;r++){const i=[],s={};for(let o=0;o<e.width;o++){const a=e.map[r*e.width+o],l=n.nodeAt(a),c=e.findCell(a);if(s[a]||c.top!==r){i.push(null);continue}s[a]=!0,i.push(l)}t.push(i)}return t}function C2(n,e,t,r){const i=e[0]>t[0]?-1:1,s=n.splice(e[0],e.length),o=s.length%2===0?1:0;let a;return r===-1&&i===1?a=t[0]-1:r===1&&i===-1?a=t[t.length-1]-o+1:a=i===-1?t[0]:t[t.length-1]-o,n.splice(a,0,...s),n}function uj(n,e,t,r){let i=R0(x2(n.node));return i=C2(i,e,t,r),i=R0(i),k2(n.node,i)}function dj(n,e,t,r){let i=x2(n.node);return i=C2(i,e,t,r),k2(n.node,i)}function L0(n,e){let t=n,r=n;for(let u=n;u>=0;u--){const d=ds(u,e.selection);d&&d.forEach(f=>{const h=f.node.attrs.colspan+u-1;h>=t&&(t=u),h>r&&(r=h)})}for(let u=n;u<=r;u++){const d=ds(u,e.selection);d&&d.forEach(f=>{const h=f.node.attrs.colspan+u-1;f.node.attrs.colspan>1&&h>r&&(r=h)})}const i=[];for(let u=t;u<=r;u++){const d=ds(u,e.selection);d&&d.length&&i.push(u)}t=i[0],r=i[i.length-1];const s=ds(t,e.selection),o=fs(0,e.selection),a=e.doc.resolve(s[s.length-1].pos);let l;for(let u=r;u>=t;u--){const d=ds(u,e.selection);if(d&&d.length){for(let f=o.length-1;f>=0;f--)if(o[f].pos===d[0].pos){l=d[0];break}if(l)break}}const c=e.doc.resolve(l.pos);return{$anchor:a,$head:c,indexes:i}}function I0(n,e){let t=n,r=n;for(let u=n;u>=0;u--)fs(u,e.selection).forEach(d=>{const f=d.node.attrs.rowspan+u-1;f>=t&&(t=u),f>r&&(r=f)});for(let u=n;u<=r;u++)fs(u,e.selection).forEach(d=>{const f=d.node.attrs.rowspan+u-1;d.node.attrs.rowspan>1&&f>r&&(r=f)});const i=[];for(let u=t;u<=r;u++){const d=fs(u,e.selection);d&&d.length&&i.push(u)}t=i[0],r=i[i.length-1];const s=fs(t,e.selection),o=ds(0,e.selection),a=e.doc.resolve(s[s.length-1].pos);let l;for(let u=r;u>=t;u--){const d=fs(u,e.selection);if(d&&d.length){for(let f=o.length-1;f>=0;f--)if(o[f].pos===d[0].pos){l=d[0];break}if(l)break}}const c=e.doc.resolve(l.pos);return{$anchor:a,$head:c,indexes:i}}function fj(n,e,t,r=!0){const i=Zo(n.selection);if(!i)return n;const{indexes:s}=L0(e,n),{indexes:o}=L0(t,n);if(s.includes(t))return n;const a=uj(i,s,o,0),l=Fd(n).replaceWith(i.pos,i.pos+i.node.nodeSize,a);if(!r)return l;const c=qe.get(a),u=i.start,d=t,f=c.positionAt(c.height-1,d,a),h=l.doc.resolve(u+f),p=tt.colSelection,m=c.positionAt(0,d,a),g=l.doc.resolve(u+m);return l.setSelection(p(h,g))}function hj(n,e,t,r=!0){const i=Zo(n.selection);if(!i)return n;const{indexes:s}=I0(e,n),{indexes:o}=I0(t,n);if(s.includes(t))return n;const a=dj(i,s,o,0),l=Fd(n).replaceWith(i.pos,i.pos+i.node.nodeSize,a);if(!r)return l;const c=qe.get(a),u=i.start,d=t,f=c.positionAt(d,c.width-1,a),h=l.doc.resolve(u+f),p=tt.rowSelection,m=c.positionAt(d,0,a),g=l.doc.resolve(u+m);return l.setSelection(p(h,g))}const tf=yW({tableGroup:"block",cellContent:"paragraph",cellAttributes:{alignment:{default:"left",getFromDOM:n=>n.style.textAlign||"left",setDOMAttr:(n,e)=>{e.style="text-align: ".concat(n||"left")}}}}),Ul=Ft("table",()=>({...tf.table,parseMarkdown:{match:n=>n.type==="table",runner:(n,e,t)=>{const r=e.align,i=e.children.map((s,o)=>({...s,align:r,isHeader:o===0}));n.openNode(t),n.next(i),n.closeNode()}},toMarkdown:{match:n=>n.type.name==="table",runner:(n,e)=>{var t;const r=(t=e.content.firstChild)==null?void 0:t.content;if(!r)return;const i=[];r.forEach(s=>{i.push(s.attrs.alignment)}),n.openNode("table",void 0,{align:i}),n.next(e.content),n.closeNode()}}}));_e(Ul.node,{displayName:"NodeSchema<table>",group:"Table"});_e(Ul.ctx,{displayName:"NodeSchemaCtx<table>",group:"Table"});const ql=Ft("table_row",()=>({...tf.table_row,parseMarkdown:{match:n=>n.type==="tableRow",runner:(n,e,t)=>{const r=e.align,i=e.children.map((s,o)=>({...s,align:r[o],isHeader:e.isHeader}));n.openNode(t),n.next(i),n.closeNode()}},toMarkdown:{match:n=>n.type.name==="table_row",runner:(n,e)=>{n.openNode("tableRow"),n.next(e.content),n.closeNode()}}}));_e(ql.node,{displayName:"NodeSchema<tableRow>",group:"Table"});_e(ql.ctx,{displayName:"NodeSchemaCtx<tableRow>",group:"Table"});const Yl=Ft("table_cell",()=>({...tf.table_cell,parseMarkdown:{match:n=>n.type==="tableCell"&&!n.isHeader,runner:(n,e,t)=>{const r=e.align;n.openNode(t,{alignment:r}).openNode(n.schema.nodes.paragraph).next(e.children).closeNode().closeNode()}},toMarkdown:{match:n=>n.type.name==="table_cell",runner:(n,e)=>{n.openNode("tableCell").next(e.content).closeNode()}}}));_e(Yl.node,{displayName:"NodeSchema<tableCell>",group:"Table"});_e(Yl.ctx,{displayName:"NodeSchemaCtx<tableCell>",group:"Table"});const nf=Ft("table_header",()=>({...tf.table_header,parseMarkdown:{match:n=>n.type==="tableCell"&&!!n.isHeader,runner:(n,e,t)=>{const r=e.align;n.openNode(t,{alignment:r}),n.openNode(n.schema.nodes.paragraph),n.next(e.children),n.closeNode(),n.closeNode()}},toMarkdown:{match:n=>n.type.name==="table_header",runner:(n,e)=>{n.openNode("tableCell"),n.next(e.content),n.closeNode()}}}));_e(nf.node,{displayName:"NodeSchema<tableHeader>",group:"Table"});_e(nf.ctx,{displayName:"NodeSchemaCtx<tableHeader>",group:"Table"});const S2=dn(n=>new Sn(new RegExp("^\\|(?<col>\\d+)[xX](?<row>\\d+)\\|\\s$"),(e,t,r,i)=>{var s,o;const a=e.doc.resolve(r);if(!a.node(-1).canReplaceWith(a.index(-1),a.indexAfter(-1),Ul.type(n)))return null;const l=b2(n,Number((s=t.groups)==null?void 0:s.row),Number((o=t.groups)==null?void 0:o.col)),c=e.tr.replaceRangeWith(r,i,l);return c.setSelection(Me.create(c.doc,r+3)).scrollIntoView()}));_e(S2,{displayName:"InputRule<insertTableInputRule>",group:"Table"});const Lg=Oe("GoToPrevTableCell",()=>()=>v2(-1));_e(Lg,{displayName:"Command<goToPrevTableCellCommand>",group:"Table"});const Ig=Oe("GoToNextTableCell",()=>()=>v2(1));_e(Ig,{displayName:"Command<goToNextTableCellCommand>",group:"Table"});const zg=Oe("BreakTable",n=>()=>(e,t)=>{if(!cn(e))return!1;const{$head:r}=e.selection,i=r.after(),s=e.tr.replaceWith(i,i,Yr.type(n).createAndFill());return s.setSelection(we.near(s.doc.resolve(i),1)).scrollIntoView(),t==null||t(s),!0});_e(zg,{displayName:"Command<breakTableCommand>",group:"Table"});const Bg=Oe("InsertTable",n=>({row:e,col:t}={})=>(r,i)=>{const{selection:s,tr:o}=r,{from:a}=s,l=b2(n,e,t),c=o.replaceSelectionWith(l),u=we.findFrom(c.doc.resolve(a),1,!0);return u&&c.setSelection(u),i==null||i(c),!0});_e(Bg,{displayName:"Command<insertTableCommand>",group:"Table"});const Fg=Oe("MoveRow",()=>({from:n,to:e}={})=>(t,r)=>{const{tr:i}=t;return!!(r!=null&&r(hj(i,n!=null?n:0,e!=null?e:0,!0)))});_e(Fg,{displayName:"Command<moveRowCommand>",group:"Table"});const Vg=Oe("MoveCol",()=>({from:n,to:e}={})=>(t,r)=>{const{tr:i}=t;return!!(r!=null&&r(fj(i,n!=null?n:0,e!=null?e:0,!0)))});_e(Vg,{displayName:"Command<moveColCommand>",group:"Table"});const Hg=Oe("SelectRow",()=>(n=0)=>(e,t)=>{const{tr:r}=e;return!!(t!=null&&t(lj(n)(r)))});_e(Hg,{displayName:"Command<selectRowCommand>",group:"Table"});const Wg=Oe("SelectCol",()=>(n=0)=>(e,t)=>{const{tr:r}=e;return!!(t!=null&&t(cj(n)(r)))});_e(Wg,{displayName:"Command<selectColCommand>",group:"Table"});const jg=Oe("SelectTable",()=>()=>(n,e)=>{const{tr:t}=n;return!!(e!=null&&e(aj(t)))});_e(jg,{displayName:"Command<selectTableCommand>",group:"Table"});const Ug=Oe("DeleteSelectedCells",()=>()=>(n,e)=>{const{selection:t}=n;if(!(t instanceof tt))return!1;const r=t.isRowSelection(),i=t.isColSelection();return r&&i?ij(n,e):i?ZW(n,e):ej(n,e)});_e(Ug,{displayName:"Command<deleteSelectedCellsCommand>",group:"Table"});const qg=Oe("AddColBefore",()=>()=>GW);_e(qg,{displayName:"Command<addColBeforeCommand>",group:"Table"});const Yg=Oe("AddColAfter",()=>()=>XW);_e(Yg,{displayName:"Command<addColAfterCommand>",group:"Table"});const Kg=Oe("AddRowBefore",n=>()=>(e,t)=>{if(!cn(e))return!1;if(t){const r=Hi(e);t(w2(n,e.tr,r,r.top))}return!0});_e(Kg,{displayName:"Command<addRowBeforeCommand>",group:"Table"});const Gg=Oe("AddRowAfter",n=>()=>(e,t)=>{if(!cn(e))return!1;if(t){const r=Hi(e);t(w2(n,e.tr,r,r.bottom))}return!0});_e(Gg,{displayName:"Command<addRowAfterCommand>",group:"Table"});const Qa=Oe("SetAlign",()=>(n="left")=>tj("alignment",n));_e(Qa,{displayName:"Command<setAlignCommand>",group:"Table"});const Xg=hn("tableKeymap",{NextCell:{shortcuts:["Mod-]","Tab"],command:n=>{const e=n.get(xe);return()=>e.call(Ig.key)}},PrevCell:{shortcuts:["Mod-[","Shift-Tab"],command:n=>{const e=n.get(xe);return()=>e.call(Lg.key)}},ExitTable:{shortcuts:["Mod-Enter"],command:n=>{const e=n.get(xe);return()=>e.call(zg.key)}}});_e(Xg.ctx,{displayName:"KeymapCtx<table>",group:"Table"});_e(Xg.shortcuts,{displayName:"Keymap<table>",group:"Table"});const ah="footnote_definition",z0="footnoteDefinition",Jg=Ft("footnote_definition",()=>({group:"block",content:"block+",defining:!0,attrs:{label:{default:""}},parseDOM:[{tag:'dl[data-type="'.concat(ah,'"]'),getAttrs:n=>{if(!(n instanceof HTMLElement))throw Cr(n);return{label:n.dataset.label}},contentElement:"dd"}],toDOM:n=>{const e=n.attrs.label;return["dl",{"data-label":e,"data-type":ah},["dt",e],["dd",0]]},parseMarkdown:{match:({type:n})=>n===z0,runner:(n,e,t)=>{n.openNode(t,{label:e.label}).next(e.children).closeNode()}},toMarkdown:{match:n=>n.type.name===ah,runner:(n,e)=>{n.openNode(z0,void 0,{label:e.attrs.label,identifier:e.attrs.label}).next(e.content).closeNode()}}}));_e(Jg.ctx,{displayName:"NodeSchemaCtx<footnodeDef>",group:"footnote"});_e(Jg.node,{displayName:"NodeSchema<footnodeDef>",group:"footnote"});const lh="footnote_reference",Zg=Ft("footnote_reference",()=>({group:"inline",inline:!0,atom:!0,attrs:{label:{default:""}},parseDOM:[{tag:'sup[data-type="'.concat(lh,'"]'),getAttrs:n=>{if(!(n instanceof HTMLElement))throw Cr(n);return{label:n.dataset.label}}}],toDOM:n=>{const e=n.attrs.label;return["sup",{"data-label":e,"data-type":lh},e]},parseMarkdown:{match:({type:n})=>n==="footnoteReference",runner:(n,e,t)=>{n.addNode(t,{label:e.label})}},toMarkdown:{match:n=>n.type.name===lh,runner:(n,e)=>{n.addNode("footnoteReference",void 0,void 0,{label:e.attrs.label,identifier:e.attrs.label})}}}));_e(Zg.ctx,{displayName:"NodeSchemaCtx<footnodeRef>",group:"footnote"});_e(Zg.node,{displayName:"NodeSchema<footnodeRef>",group:"footnote"});const M2=kr.extendSchema(n=>e=>{const t=n(e);return{...t,attrs:{...t.attrs,checked:{default:null}},parseDOM:[{tag:'li[data-item-type="task"]',getAttrs:r=>{if(!(r instanceof HTMLElement))throw Cr(r);return{label:r.dataset.label,listType:r.dataset["list-type"],spread:r.dataset.spread,checked:r.dataset.checked?r.dataset.checked==="true":null}}},...(t==null?void 0:t.parseDOM)||[]],toDOM:r=>t.toDOM&&r.attrs.checked==null?t.toDOM(r):["li",{"data-item-type":"task","data-label":r.attrs.label,"data-list-type":r.attrs.listType,"data-spread":r.attrs.spread,"data-checked":r.attrs.checked},0],parseMarkdown:{match:({type:r})=>r==="listItem",runner:(r,i,s)=>{if(i.checked==null){t.parseMarkdown.runner(r,i,s);return}const o=i.label!=null?"".concat(i.label,"."):"•",a=i.checked!=null?!!i.checked:null,l=i.label!=null?"ordered":"bullet",c=i.spread!=null?"".concat(i.spread):"true";r.openNode(s,{label:o,listType:l,spread:c,checked:a}),r.next(i.children),r.closeNode()}},toMarkdown:{match:r=>r.type.name==="list_item",runner:(r,i)=>{if(i.attrs.checked==null){t.toMarkdown.runner(r,i);return}const s=i.attrs.label,o=i.attrs.listType,a=i.attrs.spread==="true",l=i.attrs.checked;r.openNode("listItem",void 0,{label:s,listType:o,spread:a,checked:l}),r.next(i.content),r.closeNode()}}}});_e(M2,{displayName:"NodeSchema<listItem>",group:"ListItem"});const T2=dn(()=>new Sn(new RegExp("^\\[(?<checked>\\s|x)\\]\\s$"),(n,e,t,r)=>{var i;const s=n.doc.resolve(t);let o=0,a=s.node(o);for(;a&&a.type.name!=="list_item";)o--,a=s.node(o);if(!a||a.attrs.checked!=null)return null;const l=((i=e.groups)==null?void 0:i.checked)==="x",c=s.before(o),u=n.tr;return u.deleteRange(t,r).setNodeMarkup(c,void 0,{...a.attrs,checked:l}),u}));_e(T2,{displayName:"InputRule<wrapInTaskListInputRule>",group:"ListItem"});const pj=[Rg,Xg].flat(),mj=[S2,T2],gj=[y2],O2=Vn(n=>{const e=new Bt("MILKDOWN_AUTO_INSERT_ZERO_SPACE"),t=i=>i.type===Yr.type(n),r=i=>t(i)&&i.nodeSize===2;return new Gt({key:e,props:{handleDOMEvents:{compositionstart(i){const{state:s,dispatch:o}=i,{tr:a,selection:l}=s,{$from:c}=l;return p0.safari&&cn(s)&&l.empty&&r(c.parent)&&o(a.insertText("⁠",c.start())),!1},compositionend(i){const{state:s,dispatch:o}=i,{tr:a,selection:l}=s,{$from:c}=l;return p0.safari&&cn(s)&&l.empty&&t(c.parent)&&c.parent.textContent.startsWith("⁠")&&o(a.delete(c.start(),c.start()+1)),!1}}}})});_e(O2,{displayName:"Prose<autoInsertZeroSpaceInTablePlugin>",group:"Prose"});const Qg=Vn(()=>p2({}));_e(Qg,{displayName:"Prose<columnResizingPlugin>",group:"Prose"});const $2=Vn(()=>sj());_e($2,{displayName:"Prose<tableEditingPlugin>",group:"Prose"});const ev=qo("remarkGFM",()=>BC);_e(ev.plugin,{displayName:"Remark<remarkGFMPlugin>",group:"Remark"});_e(ev.options,{displayName:"RemarkConfig<remarkGFMPlugin>",group:"Remark"});const vj=[O2,Qg,$2,ev].flat(),yj=[M2,Ul,ql,nf,Yl,Jg,Zg,Pg,jl].flat(),bj=[Ig,Lg,zg,Bg,Fg,Vg,Hg,Wg,jg,Ug,Kg,Gg,qg,Yg,Qa,Ng],ch=[yj,mj,gj,pj,vj,bj].flat(),mn=W({__name:"EditorButton",props:{icon:{}},setup(n){return(e,t)=>(_(),S("button",{class:me(["fr-btn fr-btn--secondary-grey-400 fr-btn--sm fr-btn--tertiary-no-outline",e.icon]),role:"menuitem"},[et(e.$slots,"default")],2))}}),wj=["aria-labelledby","id"],_j={class:"fr-container fr-container--fluid fr-container-md"},kj={class:"fr-grid-row fr-grid-row--center"},xj={class:"fr-col-12 fr-col-md-8 fr-col-lg-6"},Cj={class:"fr-modal__body"},Sj={class:"fr-modal__header"},Mj={class:"fr-modal__content"},Tj=["id"],Oj={"data-testid":"summary"},$j={class:"fr-my-1w"},Dj={class:"fr-modal__footer"},Ej={class:"fr-btns-group fr-btns-group--right"},Aj=W({inheritAttrs:!1,__name:"ImageModal",props:{id:{}},emits:["sendModal"],setup(n,{emit:e}){const t=n,r=e,{t:i}=De(),s=A(()=>t.id+"-title"),o=E(),a={src:"",title:"",alt:""},l=Hs({...a}),c={src:{required:bh}},{getErrorText:u,getFunctionalState:d,hasError:f,reset:h,validateRequiredRules:p,v$:m}=A_(l,c,c),g=A(()=>({src:d(m.value.src.$dirty,m.value.src.$error,!1)}));function w(b){return f(g,b)}function x(){globalThis.dsfr(o.value).modal.conceal(),l.src=a.src,l.title=a.title,l.alt=a.alt,h()}function M(){p().then(b=>{b&&(r("sendModal",{...l}),x())})}return(b,C)=>(_(),G(Li,{to:"body"},[y("dialog",yr(b.$attrs,{"aria-labelledby":s.value,id:b.id,role:"dialog",class:"fr-modal",ref_key:"modalRef",ref:o}),[y("div",_j,[y("div",kj,[y("div",xj,[y("div",Cj,[y("div",Sj,[y("button",{class:"fr-btn--close fr-btn","aria-controls":"fr-modal-2",onClick:x},T(v(i)("Close")),1)]),y("div",Mj,[y("h1",{id:s.value,class:"fr-mb-2w fr-modal__title"},[C[3]||(C[3]=y("span",{class:"fr-icon-image-line fr-icon--lg"},null,-1)),Y(" "+T(v(i)("Add an image")),1)],8,Tj),y("p",null,T(v(i)("Paste a link of your image to add it to your description. It is recommended to also provide a textual alternative for an informative image and a title.")),1),P(fm),P(Su,{label:v(i)("Image link"),placeholder:v(i)("Paste your link..."),required:!0,modelValue:l.src,"onUpdate:modelValue":C[0]||(C[0]=k=>l.src=k),type:"url",hasError:w("src"),errorText:v(u)("src")},null,8,["label","placeholder","modelValue","hasError","errorText"]),y("details",null,[y("summary",Oj,T(v(i)("Customize accessibility options")),1),y("div",$j,[P(Su,{label:v(i)("Image alternative text"),modelValue:l.alt,"onUpdate:modelValue":C[1]||(C[1]=k=>l.alt=k)},null,8,["label","modelValue"]),P(Su,{label:v(i)("Image title"),modelValue:l.title,"onUpdate:modelValue":C[2]||(C[2]=k=>l.title=k)},null,8,["label","modelValue"])])])]),y("div",Dj,[y("div",Ej,[y("button",{class:"fr-btn",onClick:M,"data-testid":"add-image-button"},T(v(i)("Add image")),1)])])])])])])],16,wj)]))}}),Pj=W({__name:"ImageModalButton",emits:["send"],setup(n,{emit:e}){const t=e,{t:r}=De(),i=Ws("image-modal");function s(o){t("send",o)}return(o,a)=>(_(),S(X,null,[P(mn,{"data-fr-opened":"false","aria-controls":v(i),icon:"fr-icon-image-add-fill",title:v(r)("Image"),"data-testid":"image-modal-button"},null,8,["aria-controls","title"]),P(Aj,{id:v(i),multiple:!0,onSendModal:s},null,8,["id"])],64))}});class Nj extends h2{constructor(e,t){super(e,t),this.dom.className="fr-table fr-table--no-caption fr-table--layout-fixed"}ignoreMutation(e){return super.ignoreMutation(e)||e.type==="attributes"&&e.target===this.dom}}const Rj=Vn(()=>p2({View:Nj}));var an="top",In="bottom",zn="right",ln="left",tv="auto",Kl=[an,In,zn,ln],Io="start",xl="end",Lj="clippingParents",D2="viewport",la="popper",Ij="reference",B0=Kl.reduce(function(n,e){return n.concat([e+"-"+Io,e+"-"+xl])},[]),E2=[].concat(Kl,[tv]).reduce(function(n,e){return n.concat([e,e+"-"+Io,e+"-"+xl])},[]),zj="beforeRead",Bj="read",Fj="afterRead",Vj="beforeMain",Hj="main",Wj="afterMain",jj="beforeWrite",Uj="write",qj="afterWrite",Yj=[zj,Bj,Fj,Vj,Hj,Wj,jj,Uj,qj];function xr(n){return n?(n.nodeName||"").toLowerCase():null}function xn(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function Vs(n){var e=xn(n).Element;return n instanceof e||n instanceof Element}function Pn(n){var e=xn(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function nv(n){if(typeof ShadowRoot>"u")return!1;var e=xn(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Kj(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var r=e.styles[t]||{},i=e.attributes[t]||{},s=e.elements[t];!Pn(s)||!xr(s)||(Object.assign(s.style,r),Object.keys(i).forEach(function(o){var a=i[o];a===!1?s.removeAttribute(o):s.setAttribute(o,a===!0?"":a)}))})}function Gj(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],s=e.attributes[r]||{},o=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:t[r]),a=o.reduce(function(l,c){return l[c]="",l},{});!Pn(i)||!xr(i)||(Object.assign(i.style,a),Object.keys(s).forEach(function(l){i.removeAttribute(l)}))})}}const A2={name:"applyStyles",enabled:!0,phase:"write",fn:Kj,effect:Gj,requires:["computeStyles"]};function vr(n){return n.split("-")[0]}var Os=Math.max,ad=Math.min,zo=Math.round;function Pp(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function P2(){return!/^((?!chrome|android).)*safari/i.test(Pp())}function Bo(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var r=n.getBoundingClientRect(),i=1,s=1;e&&Pn(n)&&(i=n.offsetWidth>0&&zo(r.width)/n.offsetWidth||1,s=n.offsetHeight>0&&zo(r.height)/n.offsetHeight||1);var o=Vs(n)?xn(n):window,a=o.visualViewport,l=!P2()&&t,c=(r.left+(l&&a?a.offsetLeft:0))/i,u=(r.top+(l&&a?a.offsetTop:0))/s,d=r.width/i,f=r.height/s;return{width:d,height:f,top:u,right:c+d,bottom:u+f,left:c,x:c,y:u}}function rv(n){var e=Bo(n),t=n.offsetWidth,r=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:r}}function N2(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&nv(t)){var r=e;do{if(r&&n.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Wr(n){return xn(n).getComputedStyle(n)}function Xj(n){return["table","td","th"].indexOf(xr(n))>=0}function Wi(n){return((Vs(n)?n.ownerDocument:n.document)||window.document).documentElement}function rf(n){return xr(n)==="html"?n:n.assignedSlot||n.parentNode||(nv(n)?n.host:null)||Wi(n)}function F0(n){return!Pn(n)||Wr(n).position==="fixed"?null:n.offsetParent}function Jj(n){var e=/firefox/i.test(Pp()),t=/Trident/i.test(Pp());if(t&&Pn(n)){var r=Wr(n);if(r.position==="fixed")return null}var i=rf(n);for(nv(i)&&(i=i.host);Pn(i)&&["html","body"].indexOf(xr(i))<0;){var s=Wr(i);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return i;i=i.parentNode}return null}function Gl(n){for(var e=xn(n),t=F0(n);t&&Xj(t)&&Wr(t).position==="static";)t=F0(t);return t&&(xr(t)==="html"||xr(t)==="body"&&Wr(t).position==="static")?e:t||Jj(n)||e}function iv(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function el(n,e,t){return Os(n,ad(e,t))}function Zj(n,e,t){var r=el(n,e,t);return r>t?t:r}function R2(){return{top:0,right:0,bottom:0,left:0}}function L2(n){return Object.assign({},R2(),n)}function I2(n,e){return e.reduce(function(t,r){return t[r]=n,t},{})}var Qj=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,L2(typeof e!="number"?e:I2(e,Kl))};function eU(n){var e,t=n.state,r=n.name,i=n.options,s=t.elements.arrow,o=t.modifiersData.popperOffsets,a=vr(t.placement),l=iv(a),c=[ln,zn].indexOf(a)>=0,u=c?"height":"width";if(!(!s||!o)){var d=Qj(i.padding,t),f=rv(s),h=l==="y"?an:ln,p=l==="y"?In:zn,m=t.rects.reference[u]+t.rects.reference[l]-o[l]-t.rects.popper[u],g=o[l]-t.rects.reference[l],w=Gl(s),x=w?l==="y"?w.clientHeight||0:w.clientWidth||0:0,M=m/2-g/2,b=d[h],C=x-f[u]-d[p],k=x/2-f[u]/2+M,$=el(b,k,C),O=l;t.modifiersData[r]=(e={},e[O]=$,e.centerOffset=$-k,e)}}function tU(n){var e=n.state,t=n.options,r=t.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||N2(e.elements.popper,i)&&(e.elements.arrow=i))}const nU={name:"arrow",enabled:!0,phase:"main",fn:eU,effect:tU,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Fo(n){return n.split("-")[1]}var rU={top:"auto",right:"auto",bottom:"auto",left:"auto"};function iU(n,e){var t=n.x,r=n.y,i=e.devicePixelRatio||1;return{x:zo(t*i)/i||0,y:zo(r*i)/i||0}}function V0(n){var e,t=n.popper,r=n.popperRect,i=n.placement,s=n.variation,o=n.offsets,a=n.position,l=n.gpuAcceleration,c=n.adaptive,u=n.roundOffsets,d=n.isFixed,f=o.x,h=f===void 0?0:f,p=o.y,m=p===void 0?0:p,g=typeof u=="function"?u({x:h,y:m}):{x:h,y:m};h=g.x,m=g.y;var w=o.hasOwnProperty("x"),x=o.hasOwnProperty("y"),M=ln,b=an,C=window;if(c){var k=Gl(t),$="clientHeight",O="clientWidth";if(k===xn(t)&&(k=Wi(t),Wr(k).position!=="static"&&a==="absolute"&&($="scrollHeight",O="scrollWidth")),k=k,i===an||(i===ln||i===zn)&&s===xl){b=In;var D=d&&k===C&&C.visualViewport?C.visualViewport.height:k[$];m-=D-r.height,m*=l?1:-1}if(i===ln||(i===an||i===In)&&s===xl){M=zn;var N=d&&k===C&&C.visualViewport?C.visualViewport.width:k[O];h-=N-r.width,h*=l?1:-1}}var B=Object.assign({position:a},c&&rU),U=u===!0?iU({x:h,y:m},xn(t)):{x:h,y:m};if(h=U.x,m=U.y,l){var le;return Object.assign({},B,(le={},le[b]=x?"0":"",le[M]=w?"0":"",le.transform=(C.devicePixelRatio||1)<=1?"translate("+h+"px, "+m+"px)":"translate3d("+h+"px, "+m+"px, 0)",le))}return Object.assign({},B,(e={},e[b]=x?m+"px":"",e[M]=w?h+"px":"",e.transform="",e))}function sU(n){var e=n.state,t=n.options,r=t.gpuAcceleration,i=r===void 0?!0:r,s=t.adaptive,o=s===void 0?!0:s,a=t.roundOffsets,l=a===void 0?!0:a,c={placement:vr(e.placement),variation:Fo(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,V0(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,V0(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const oU={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:sU,data:{}};var Tc={passive:!0};function aU(n){var e=n.state,t=n.instance,r=n.options,i=r.scroll,s=i===void 0?!0:i,o=r.resize,a=o===void 0?!0:o,l=xn(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&c.forEach(function(u){u.addEventListener("scroll",t.update,Tc)}),a&&l.addEventListener("resize",t.update,Tc),function(){s&&c.forEach(function(u){u.removeEventListener("scroll",t.update,Tc)}),a&&l.removeEventListener("resize",t.update,Tc)}}const lU={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:aU,data:{}};var cU={left:"right",right:"left",bottom:"top",top:"bottom"};function wu(n){return n.replace(/left|right|bottom|top/g,function(e){return cU[e]})}var uU={start:"end",end:"start"};function H0(n){return n.replace(/start|end/g,function(e){return uU[e]})}function sv(n){var e=xn(n),t=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:t,scrollTop:r}}function ov(n){return Bo(Wi(n)).left+sv(n).scrollLeft}function dU(n,e){var t=xn(n),r=Wi(n),i=t.visualViewport,s=r.clientWidth,o=r.clientHeight,a=0,l=0;if(i){s=i.width,o=i.height;var c=P2();(c||!c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:s,height:o,x:a+ov(n),y:l}}function fU(n){var e,t=Wi(n),r=sv(n),i=(e=n.ownerDocument)==null?void 0:e.body,s=Os(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),o=Os(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-r.scrollLeft+ov(n),l=-r.scrollTop;return Wr(i||t).direction==="rtl"&&(a+=Os(t.clientWidth,i?i.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}function av(n){var e=Wr(n),t=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+r)}function z2(n){return["html","body","#document"].indexOf(xr(n))>=0?n.ownerDocument.body:Pn(n)&&av(n)?n:z2(rf(n))}function tl(n,e){var t;e===void 0&&(e=[]);var r=z2(n),i=r===((t=n.ownerDocument)==null?void 0:t.body),s=xn(r),o=i?[s].concat(s.visualViewport||[],av(r)?r:[]):r,a=e.concat(o);return i?a:a.concat(tl(rf(o)))}function Np(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function hU(n,e){var t=Bo(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function W0(n,e,t){return e===D2?Np(dU(n,t)):Vs(e)?hU(e,t):Np(fU(Wi(n)))}function pU(n){var e=tl(rf(n)),t=["absolute","fixed"].indexOf(Wr(n).position)>=0,r=t&&Pn(n)?Gl(n):n;return Vs(r)?e.filter(function(i){return Vs(i)&&N2(i,r)&&xr(i)!=="body"}):[]}function mU(n,e,t,r){var i=e==="clippingParents"?pU(n):[].concat(e),s=[].concat(i,[t]),o=s[0],a=s.reduce(function(l,c){var u=W0(n,c,r);return l.top=Os(u.top,l.top),l.right=ad(u.right,l.right),l.bottom=ad(u.bottom,l.bottom),l.left=Os(u.left,l.left),l},W0(n,o,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function B2(n){var e=n.reference,t=n.element,r=n.placement,i=r?vr(r):null,s=r?Fo(r):null,o=e.x+e.width/2-t.width/2,a=e.y+e.height/2-t.height/2,l;switch(i){case an:l={x:o,y:e.y-t.height};break;case In:l={x:o,y:e.y+e.height};break;case zn:l={x:e.x+e.width,y:a};break;case ln:l={x:e.x-t.width,y:a};break;default:l={x:e.x,y:e.y}}var c=i?iv(i):null;if(c!=null){var u=c==="y"?"height":"width";switch(s){case Io:l[c]=l[c]-(e[u]/2-t[u]/2);break;case xl:l[c]=l[c]+(e[u]/2-t[u]/2);break}}return l}function Cl(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=r===void 0?n.placement:r,s=t.strategy,o=s===void 0?n.strategy:s,a=t.boundary,l=a===void 0?Lj:a,c=t.rootBoundary,u=c===void 0?D2:c,d=t.elementContext,f=d===void 0?la:d,h=t.altBoundary,p=h===void 0?!1:h,m=t.padding,g=m===void 0?0:m,w=L2(typeof g!="number"?g:I2(g,Kl)),x=f===la?Ij:la,M=n.rects.popper,b=n.elements[p?x:f],C=mU(Vs(b)?b:b.contextElement||Wi(n.elements.popper),l,u,o),k=Bo(n.elements.reference),$=B2({reference:k,element:M,strategy:"absolute",placement:i}),O=Np(Object.assign({},M,$)),D=f===la?O:k,N={top:C.top-D.top+w.top,bottom:D.bottom-C.bottom+w.bottom,left:C.left-D.left+w.left,right:D.right-C.right+w.right},B=n.modifiersData.offset;if(f===la&&B){var U=B[i];Object.keys(N).forEach(function(le){var Te=[zn,In].indexOf(le)>=0?1:-1,ee=[an,In].indexOf(le)>=0?"y":"x";N[le]+=U[ee]*Te})}return N}function gU(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=t.boundary,s=t.rootBoundary,o=t.padding,a=t.flipVariations,l=t.allowedAutoPlacements,c=l===void 0?E2:l,u=Fo(r),d=u?a?B0:B0.filter(function(p){return Fo(p)===u}):Kl,f=d.filter(function(p){return c.indexOf(p)>=0});f.length===0&&(f=d);var h=f.reduce(function(p,m){return p[m]=Cl(n,{placement:m,boundary:i,rootBoundary:s,padding:o})[vr(m)],p},{});return Object.keys(h).sort(function(p,m){return h[p]-h[m]})}function vU(n){if(vr(n)===tv)return[];var e=wu(n);return[H0(n),e,H0(e)]}function yU(n){var e=n.state,t=n.options,r=n.name;if(!e.modifiersData[r]._skip){for(var i=t.mainAxis,s=i===void 0?!0:i,o=t.altAxis,a=o===void 0?!0:o,l=t.fallbackPlacements,c=t.padding,u=t.boundary,d=t.rootBoundary,f=t.altBoundary,h=t.flipVariations,p=h===void 0?!0:h,m=t.allowedAutoPlacements,g=e.options.placement,w=vr(g),x=w===g,M=l||(x||!p?[wu(g)]:vU(g)),b=[g].concat(M).reduce(function(I,Q){return I.concat(vr(Q)===tv?gU(e,{placement:Q,boundary:u,rootBoundary:d,padding:c,flipVariations:p,allowedAutoPlacements:m}):Q)},[]),C=e.rects.reference,k=e.rects.popper,$=new Map,O=!0,D=b[0],N=0;N<b.length;N++){var B=b[N],U=vr(B),le=Fo(B)===Io,Te=[an,In].indexOf(U)>=0,ee=Te?"width":"height",ie=Cl(e,{placement:B,boundary:u,rootBoundary:d,altBoundary:f,padding:c}),he=Te?le?zn:ln:le?In:an;C[ee]>k[ee]&&(he=wu(he));var be=wu(he),ke=[];if(s&&ke.push(ie[U]<=0),a&&ke.push(ie[he]<=0,ie[be]<=0),ke.every(function(I){return I})){D=B,O=!1;break}$.set(B,ke)}if(O)for(var ge=p?3:1,je=function(Q){var ae=b.find(function(j){var R=$.get(j);if(R)return R.slice(0,Q).every(function(Z){return Z})});if(ae)return D=ae,"break"},F=ge;F>0;F--){var L=je(F);if(L==="break")break}e.placement!==D&&(e.modifiersData[r]._skip=!0,e.placement=D,e.reset=!0)}}const bU={name:"flip",enabled:!0,phase:"main",fn:yU,requiresIfExists:["offset"],data:{_skip:!1}};function j0(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function U0(n){return[an,zn,In,ln].some(function(e){return n[e]>=0})}function wU(n){var e=n.state,t=n.name,r=e.rects.reference,i=e.rects.popper,s=e.modifiersData.preventOverflow,o=Cl(e,{elementContext:"reference"}),a=Cl(e,{altBoundary:!0}),l=j0(o,r),c=j0(a,i,s),u=U0(l),d=U0(c);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}const _U={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:wU};function kU(n,e,t){var r=vr(n),i=[ln,an].indexOf(r)>=0?-1:1,s=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,o=s[0],a=s[1];return o=o||0,a=(a||0)*i,[ln,zn].indexOf(r)>=0?{x:a,y:o}:{x:o,y:a}}function xU(n){var e=n.state,t=n.options,r=n.name,i=t.offset,s=i===void 0?[0,0]:i,o=E2.reduce(function(u,d){return u[d]=kU(d,e.rects,s),u},{}),a=o[e.placement],l=a.x,c=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=o}const CU={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:xU};function SU(n){var e=n.state,t=n.name;e.modifiersData[t]=B2({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const MU={name:"popperOffsets",enabled:!0,phase:"read",fn:SU,data:{}};function TU(n){return n==="x"?"y":"x"}function OU(n){var e=n.state,t=n.options,r=n.name,i=t.mainAxis,s=i===void 0?!0:i,o=t.altAxis,a=o===void 0?!1:o,l=t.boundary,c=t.rootBoundary,u=t.altBoundary,d=t.padding,f=t.tether,h=f===void 0?!0:f,p=t.tetherOffset,m=p===void 0?0:p,g=Cl(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),w=vr(e.placement),x=Fo(e.placement),M=!x,b=iv(w),C=TU(b),k=e.modifiersData.popperOffsets,$=e.rects.reference,O=e.rects.popper,D=typeof m=="function"?m(Object.assign({},e.rects,{placement:e.placement})):m,N=typeof D=="number"?{mainAxis:D,altAxis:D}:Object.assign({mainAxis:0,altAxis:0},D),B=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,U={x:0,y:0};if(k){if(s){var le,Te=b==="y"?an:ln,ee=b==="y"?In:zn,ie=b==="y"?"height":"width",he=k[b],be=he+g[Te],ke=he-g[ee],ge=h?-O[ie]/2:0,je=x===Io?$[ie]:O[ie],F=x===Io?-O[ie]:-$[ie],L=e.elements.arrow,I=h&&L?rv(L):{width:0,height:0},Q=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:R2(),ae=Q[Te],j=Q[ee],R=el(0,$[ie],I[ie]),Z=M?$[ie]/2-ge-R-ae-N.mainAxis:je-R-ae-N.mainAxis,ne=M?-$[ie]/2+ge+R+j+N.mainAxis:F+R+j+N.mainAxis,Ie=e.elements.arrow&&Gl(e.elements.arrow),lt=Ie?b==="y"?Ie.clientTop||0:Ie.clientLeft||0:0,ft=(le=B==null?void 0:B[b])!=null?le:0,Xt=he+Z-ft-lt,Qn=he+ne-ft,Kr=el(h?ad(be,Xt):be,he,h?Os(ke,Qn):ke);k[b]=Kr,U[b]=Kr-he}if(a){var Gr,ji=b==="x"?an:ln,Ui=b==="x"?In:zn,Mn=k[C],Hn=C==="y"?"height":"width",Xr=Mn+g[ji],er=Mn-g[Ui],Qo=[an,ln].indexOf(w)!==-1,Jl=(Gr=B==null?void 0:B[C])!=null?Gr:0,Zl=Qo?Xr:Mn-$[Hn]-O[Hn]-Jl+N.altAxis,Ql=Qo?Mn+$[Hn]+O[Hn]-Jl-N.altAxis:er,ec=h&&Qo?Zj(Zl,Mn,Ql):el(h?Zl:Xr,Mn,h?Ql:er);k[C]=ec,U[C]=ec-Mn}e.modifiersData[r]=U}}const $U={name:"preventOverflow",enabled:!0,phase:"main",fn:OU,requiresIfExists:["offset"]};function DU(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function EU(n){return n===xn(n)||!Pn(n)?sv(n):DU(n)}function AU(n){var e=n.getBoundingClientRect(),t=zo(e.width)/n.offsetWidth||1,r=zo(e.height)/n.offsetHeight||1;return t!==1||r!==1}function PU(n,e,t){t===void 0&&(t=!1);var r=Pn(e),i=Pn(e)&&AU(e),s=Wi(e),o=Bo(n,i,t),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!t)&&((xr(e)!=="body"||av(s))&&(a=EU(e)),Pn(e)?(l=Bo(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=ov(s))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function NU(n){var e=new Map,t=new Set,r=[];n.forEach(function(s){e.set(s.name,s)});function i(s){t.add(s.name);var o=[].concat(s.requires||[],s.requiresIfExists||[]);o.forEach(function(a){if(!t.has(a)){var l=e.get(a);l&&i(l)}}),r.push(s)}return n.forEach(function(s){t.has(s.name)||i(s)}),r}function RU(n){var e=NU(n);return Yj.reduce(function(t,r){return t.concat(e.filter(function(i){return i.phase===r}))},[])}function LU(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function IU(n){var e=n.reduce(function(t,r){var i=t[r.name];return t[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,t},{});return Object.keys(e).map(function(t){return e[t]})}var q0={placement:"bottom",modifiers:[],strategy:"absolute"};function Y0(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function zU(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,r=t===void 0?[]:t,i=e.defaultOptions,s=i===void 0?q0:i;return function(a,l,c){c===void 0&&(c=s);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},q0,s),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},d=[],f=!1,h={state:u,setOptions:function(w){var x=typeof w=="function"?w(u.options):w;m(),u.options=Object.assign({},s,u.options,x),u.scrollParents={reference:Vs(a)?tl(a):a.contextElement?tl(a.contextElement):[],popper:tl(l)};var M=RU(IU([].concat(r,u.options.modifiers)));return u.orderedModifiers=M.filter(function(b){return b.enabled}),p(),h.update()},forceUpdate:function(){if(!f){var w=u.elements,x=w.reference,M=w.popper;if(Y0(x,M)){u.rects={reference:PU(x,Gl(M),u.options.strategy==="fixed"),popper:rv(M)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(N){return u.modifiersData[N.name]=Object.assign({},N.data)});for(var b=0;b<u.orderedModifiers.length;b++){if(u.reset===!0){u.reset=!1,b=-1;continue}var C=u.orderedModifiers[b],k=C.fn,$=C.options,O=$===void 0?{}:$,D=C.name;typeof k=="function"&&(u=k({state:u,options:O,name:D,instance:h})||u)}}}},update:LU(function(){return new Promise(function(g){h.forceUpdate(),g(u)})}),destroy:function(){m(),f=!0}};if(!Y0(a,l))return h;h.setOptions(c).then(function(g){!f&&c.onFirstUpdate&&c.onFirstUpdate(g)});function p(){u.orderedModifiers.forEach(function(g){var w=g.name,x=g.options,M=x===void 0?{}:x,b=g.effect;if(typeof b=="function"){var C=b({state:u,name:w,instance:h,options:M}),k=function(){};d.push(C||k)}})}function m(){d.forEach(function(g){return g()}),d=[]}return h}}var BU=[lU,MU,oU,A2,CU,bU,$U,nU,_U],FU=zU({defaultModifiers:BU}),VU="tippy-box",F2="tippy-content",HU="tippy-backdrop",V2="tippy-arrow",H2="tippy-svg-arrow",as={passive:!0,capture:!0},W2=function(){return document.body};function uh(n,e,t){if(Array.isArray(n)){var r=n[e];return r==null?Array.isArray(t)?t[e]:t:r}return n}function lv(n,e){var t={}.toString.call(n);return t.indexOf("[object")===0&&t.indexOf(e+"]")>-1}function j2(n,e){return typeof n=="function"?n.apply(void 0,e):n}function K0(n,e){if(e===0)return n;var t;return function(r){clearTimeout(t),t=setTimeout(function(){n(r)},e)}}function WU(n){return n.split(/\s+/).filter(Boolean)}function uo(n){return[].concat(n)}function G0(n,e){n.indexOf(e)===-1&&n.push(e)}function jU(n){return n.filter(function(e,t){return n.indexOf(e)===t})}function UU(n){return n.split("-")[0]}function ld(n){return[].slice.call(n)}function X0(n){return Object.keys(n).reduce(function(e,t){return n[t]!==void 0&&(e[t]=n[t]),e},{})}function nl(){return document.createElement("div")}function sf(n){return["Element","Fragment"].some(function(e){return lv(n,e)})}function qU(n){return lv(n,"NodeList")}function YU(n){return lv(n,"MouseEvent")}function KU(n){return!!(n&&n._tippy&&n._tippy.reference===n)}function GU(n){return sf(n)?[n]:qU(n)?ld(n):Array.isArray(n)?n:ld(document.querySelectorAll(n))}function dh(n,e){n.forEach(function(t){t&&(t.style.transitionDuration=e+"ms")})}function J0(n,e){n.forEach(function(t){t&&t.setAttribute("data-state",e)})}function XU(n){var e,t=uo(n),r=t[0];return r!=null&&(e=r.ownerDocument)!=null&&e.body?r.ownerDocument:document}function JU(n,e){var t=e.clientX,r=e.clientY;return n.every(function(i){var s=i.popperRect,o=i.popperState,a=i.props,l=a.interactiveBorder,c=UU(o.placement),u=o.modifiersData.offset;if(!u)return!0;var d=c==="bottom"?u.top.y:0,f=c==="top"?u.bottom.y:0,h=c==="right"?u.left.x:0,p=c==="left"?u.right.x:0,m=s.top-r+d>l,g=r-s.bottom-f>l,w=s.left-t+h>l,x=t-s.right-p>l;return m||g||w||x})}function fh(n,e,t){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){n[r](i,t)})}function Z0(n,e){for(var t=e;t;){var r;if(n.contains(t))return!0;t=t.getRootNode==null||(r=t.getRootNode())==null?void 0:r.host}return!1}var cr={isTouch:!1},Q0=0;function ZU(){cr.isTouch||(cr.isTouch=!0,window.performance&&document.addEventListener("mousemove",U2))}function U2(){var n=performance.now();n-Q0<20&&(cr.isTouch=!1,document.removeEventListener("mousemove",U2)),Q0=n}function QU(){var n=document.activeElement;if(KU(n)){var e=n._tippy;n.blur&&!e.state.isVisible&&n.blur()}}function eq(){document.addEventListener("touchstart",ZU,as),window.addEventListener("blur",QU)}var tq=typeof window<"u"&&typeof document<"u",nq=tq?!!window.msCrypto:!1,rq={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},iq={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},Kn=Object.assign({appendTo:W2,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},rq,iq),sq=Object.keys(Kn),oq=function(e){var t=Object.keys(e);t.forEach(function(r){Kn[r]=e[r]})};function q2(n){var e=n.plugins||[],t=e.reduce(function(r,i){var s=i.name,o=i.defaultValue;if(s){var a;r[s]=n[s]!==void 0?n[s]:(a=Kn[s])!=null?a:o}return r},{});return Object.assign({},n,t)}function aq(n,e){var t=e?Object.keys(q2(Object.assign({},Kn,{plugins:e}))):sq,r=t.reduce(function(i,s){var o=(n.getAttribute("data-tippy-"+s)||"").trim();if(!o)return i;if(s==="content")i[s]=o;else try{i[s]=JSON.parse(o)}catch(a){i[s]=o}return i},{});return r}function eb(n,e){var t=Object.assign({},e,{content:j2(e.content,[n])},e.ignoreAttributes?{}:aq(n,e.plugins));return t.aria=Object.assign({},Kn.aria,t.aria),t.aria={expanded:t.aria.expanded==="auto"?e.interactive:t.aria.expanded,content:t.aria.content==="auto"?e.interactive?null:"describedby":t.aria.content},t}var lq=function(){return"innerHTML"};function Rp(n,e){n[lq()]=e}function tb(n){var e=nl();return n===!0?e.className=V2:(e.className=H2,sf(n)?e.appendChild(n):Rp(e,n)),e}function nb(n,e){sf(e.content)?(Rp(n,""),n.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?Rp(n,e.content):n.textContent=e.content)}function Lp(n){var e=n.firstElementChild,t=ld(e.children);return{box:e,content:t.find(function(r){return r.classList.contains(F2)}),arrow:t.find(function(r){return r.classList.contains(V2)||r.classList.contains(H2)}),backdrop:t.find(function(r){return r.classList.contains(HU)})}}function Y2(n){var e=nl(),t=nl();t.className=VU,t.setAttribute("data-state","hidden"),t.setAttribute("tabindex","-1");var r=nl();r.className=F2,r.setAttribute("data-state","hidden"),nb(r,n.props),e.appendChild(t),t.appendChild(r),i(n.props,n.props);function i(s,o){var a=Lp(e),l=a.box,c=a.content,u=a.arrow;o.theme?l.setAttribute("data-theme",o.theme):l.removeAttribute("data-theme"),typeof o.animation=="string"?l.setAttribute("data-animation",o.animation):l.removeAttribute("data-animation"),o.inertia?l.setAttribute("data-inertia",""):l.removeAttribute("data-inertia"),l.style.maxWidth=typeof o.maxWidth=="number"?o.maxWidth+"px":o.maxWidth,o.role?l.setAttribute("role",o.role):l.removeAttribute("role"),(s.content!==o.content||s.allowHTML!==o.allowHTML)&&nb(c,n.props),o.arrow?u?s.arrow!==o.arrow&&(l.removeChild(u),l.appendChild(tb(o.arrow))):l.appendChild(tb(o.arrow)):u&&l.removeChild(u)}return{popper:e,onUpdate:i}}Y2.$$tippy=!0;var cq=1,Oc=[],hh=[];function uq(n,e){var t=eb(n,Object.assign({},Kn,q2(X0(e)))),r,i,s,o=!1,a=!1,l=!1,c=!1,u,d,f,h=[],p=K0(Xt,t.interactiveDebounce),m,g=cq++,w=null,x=jU(t.plugins),M={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},b={id:g,reference:n,popper:nl(),popperInstance:w,props:t,state:M,plugins:x,clearDelayTimeouts:Zl,setProps:Ql,setContent:ec,show:eC,hide:tC,hideWithInteractivity:nC,enable:Qo,disable:Jl,unmount:rC,destroy:iC};if(!t.render)return b;var C=t.render(b),k=C.popper,$=C.onUpdate;k.setAttribute("data-tippy-root",""),k.id="tippy-"+b.id,b.popper=k,n._tippy=b,k._tippy=b;var O=x.map(function(z){return z.fn(b)}),D=n.hasAttribute("aria-expanded");return Ie(),ge(),he(),be("onCreate",[b]),t.showOnCreate&&Xr(),k.addEventListener("mouseenter",function(){b.props.interactive&&b.state.isVisible&&b.clearDelayTimeouts()}),k.addEventListener("mouseleave",function(){b.props.interactive&&b.props.trigger.indexOf("mouseenter")>=0&&Te().addEventListener("mousemove",p)}),b;function N(){var z=b.props.touch;return Array.isArray(z)?z:[z,0]}function B(){return N()[0]==="hold"}function U(){var z;return!!((z=b.props.render)!=null&&z.$$tippy)}function le(){return m||n}function Te(){var z=le().parentNode;return z?XU(z):document}function ee(){return Lp(k)}function ie(z){return b.state.isMounted&&!b.state.isVisible||cr.isTouch||u&&u.type==="focus"?0:uh(b.props.delay,z?0:1,Kn.delay)}function he(z){z===void 0&&(z=!1),k.style.pointerEvents=b.props.interactive&&!z?"":"none",k.style.zIndex=""+b.props.zIndex}function be(z,ce,ve){if(ve===void 0&&(ve=!0),O.forEach(function(ze){ze[z]&&ze[z].apply(ze,ce)}),ve){var Ge;(Ge=b.props)[z].apply(Ge,ce)}}function ke(){var z=b.props.aria;if(z.content){var ce="aria-"+z.content,ve=k.id,Ge=uo(b.props.triggerTarget||n);Ge.forEach(function(ze){var Jt=ze.getAttribute(ce);if(b.state.isVisible)ze.setAttribute(ce,Jt?Jt+" "+ve:ve);else{var Tn=Jt&&Jt.replace(ve,"").trim();Tn?ze.setAttribute(ce,Tn):ze.removeAttribute(ce)}})}}function ge(){if(!(D||!b.props.aria.expanded)){var z=uo(b.props.triggerTarget||n);z.forEach(function(ce){b.props.interactive?ce.setAttribute("aria-expanded",b.state.isVisible&&ce===le()?"true":"false"):ce.removeAttribute("aria-expanded")})}}function je(){Te().removeEventListener("mousemove",p),Oc=Oc.filter(function(z){return z!==p})}function F(z){if(!(cr.isTouch&&(l||z.type==="mousedown"))){var ce=z.composedPath&&z.composedPath()[0]||z.target;if(!(b.props.interactive&&Z0(k,ce))){if(uo(b.props.triggerTarget||n).some(function(ve){return Z0(ve,ce)})){if(cr.isTouch||b.state.isVisible&&b.props.trigger.indexOf("click")>=0)return}else be("onClickOutside",[b,z]);b.props.hideOnClick===!0&&(b.clearDelayTimeouts(),b.hide(),a=!0,setTimeout(function(){a=!1}),b.state.isMounted||ae())}}}function L(){l=!0}function I(){l=!1}function Q(){var z=Te();z.addEventListener("mousedown",F,!0),z.addEventListener("touchend",F,as),z.addEventListener("touchstart",I,as),z.addEventListener("touchmove",L,as)}function ae(){var z=Te();z.removeEventListener("mousedown",F,!0),z.removeEventListener("touchend",F,as),z.removeEventListener("touchstart",I,as),z.removeEventListener("touchmove",L,as)}function j(z,ce){Z(z,function(){!b.state.isVisible&&k.parentNode&&k.parentNode.contains(k)&&ce()})}function R(z,ce){Z(z,ce)}function Z(z,ce){var ve=ee().box;function Ge(ze){ze.target===ve&&(fh(ve,"remove",Ge),ce())}if(z===0)return ce();fh(ve,"remove",d),fh(ve,"add",Ge),d=Ge}function ne(z,ce,ve){ve===void 0&&(ve=!1);var Ge=uo(b.props.triggerTarget||n);Ge.forEach(function(ze){ze.addEventListener(z,ce,ve),h.push({node:ze,eventType:z,handler:ce,options:ve})})}function Ie(){B()&&(ne("touchstart",ft,{passive:!0}),ne("touchend",Qn,{passive:!0})),WU(b.props.trigger).forEach(function(z){if(z!=="manual")switch(ne(z,ft),z){case"mouseenter":ne("mouseleave",Qn);break;case"focus":ne(nq?"focusout":"blur",Kr);break;case"focusin":ne("focusout",Kr);break}})}function lt(){h.forEach(function(z){var ce=z.node,ve=z.eventType,Ge=z.handler,ze=z.options;ce.removeEventListener(ve,Ge,ze)}),h=[]}function ft(z){var ce,ve=!1;if(!(!b.state.isEnabled||Gr(z)||a)){var Ge=((ce=u)==null?void 0:ce.type)==="focus";u=z,m=z.currentTarget,ge(),!b.state.isVisible&&YU(z)&&Oc.forEach(function(ze){return ze(z)}),z.type==="click"&&(b.props.trigger.indexOf("mouseenter")<0||o)&&b.props.hideOnClick!==!1&&b.state.isVisible?ve=!0:Xr(z),z.type==="click"&&(o=!ve),ve&&!Ge&&er(z)}}function Xt(z){var ce=z.target,ve=le().contains(ce)||k.contains(ce);if(!(z.type==="mousemove"&&ve)){var Ge=Hn().concat(k).map(function(ze){var Jt,Tn=ze._tippy,Ys=(Jt=Tn.popperInstance)==null?void 0:Jt.state;return Ys?{popperRect:ze.getBoundingClientRect(),popperState:Ys,props:t}:null}).filter(Boolean);JU(Ge,z)&&(je(),er(z))}}function Qn(z){var ce=Gr(z)||b.props.trigger.indexOf("click")>=0&&o;if(!ce){if(b.props.interactive){b.hideWithInteractivity(z);return}er(z)}}function Kr(z){b.props.trigger.indexOf("focusin")<0&&z.target!==le()||b.props.interactive&&z.relatedTarget&&k.contains(z.relatedTarget)||er(z)}function Gr(z){return cr.isTouch?B()!==z.type.indexOf("touch")>=0:!1}function ji(){Ui();var z=b.props,ce=z.popperOptions,ve=z.placement,Ge=z.offset,ze=z.getReferenceClientRect,Jt=z.moveTransition,Tn=U()?Lp(k).arrow:null,Ys=ze?{getBoundingClientRect:ze,contextElement:ze.contextElement||le()}:n,pv={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(tc){var Ks=tc.state;if(U()){var sC=ee(),lf=sC.box;["placement","reference-hidden","escaped"].forEach(function(nc){nc==="placement"?lf.setAttribute("data-placement",Ks.placement):Ks.attributes.popper["data-popper-"+nc]?lf.setAttribute("data-"+nc,""):lf.removeAttribute("data-"+nc)}),Ks.attributes.popper={}}}},qi=[{name:"offset",options:{offset:Ge}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!Jt}},pv];U()&&Tn&&qi.push({name:"arrow",options:{element:Tn,padding:3}}),qi.push.apply(qi,(ce==null?void 0:ce.modifiers)||[]),b.popperInstance=FU(Ys,k,Object.assign({},ce,{placement:ve,onFirstUpdate:f,modifiers:qi}))}function Ui(){b.popperInstance&&(b.popperInstance.destroy(),b.popperInstance=null)}function Mn(){var z=b.props.appendTo,ce,ve=le();b.props.interactive&&z===W2||z==="parent"?ce=ve.parentNode:ce=j2(z,[ve]),ce.contains(k)||ce.appendChild(k),b.state.isMounted=!0,ji()}function Hn(){return ld(k.querySelectorAll("[data-tippy-root]"))}function Xr(z){b.clearDelayTimeouts(),z&&be("onTrigger",[b,z]),Q();var ce=ie(!0),ve=N(),Ge=ve[0],ze=ve[1];cr.isTouch&&Ge==="hold"&&ze&&(ce=ze),ce?r=setTimeout(function(){b.show()},ce):b.show()}function er(z){if(b.clearDelayTimeouts(),be("onUntrigger",[b,z]),!b.state.isVisible){ae();return}if(!(b.props.trigger.indexOf("mouseenter")>=0&&b.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(z.type)>=0&&o)){var ce=ie(!1);ce?i=setTimeout(function(){b.state.isVisible&&b.hide()},ce):s=requestAnimationFrame(function(){b.hide()})}}function Qo(){b.state.isEnabled=!0}function Jl(){b.hide(),b.state.isEnabled=!1}function Zl(){clearTimeout(r),clearTimeout(i),cancelAnimationFrame(s)}function Ql(z){if(!b.state.isDestroyed){be("onBeforeUpdate",[b,z]),lt();var ce=b.props,ve=eb(n,Object.assign({},ce,X0(z),{ignoreAttributes:!0}));b.props=ve,Ie(),ce.interactiveDebounce!==ve.interactiveDebounce&&(je(),p=K0(Xt,ve.interactiveDebounce)),ce.triggerTarget&&!ve.triggerTarget?uo(ce.triggerTarget).forEach(function(Ge){Ge.removeAttribute("aria-expanded")}):ve.triggerTarget&&n.removeAttribute("aria-expanded"),ge(),he(),$&&$(ce,ve),b.popperInstance&&(ji(),Hn().forEach(function(Ge){requestAnimationFrame(Ge._tippy.popperInstance.forceUpdate)})),be("onAfterUpdate",[b,z])}}function ec(z){b.setProps({content:z})}function eC(){var z=b.state.isVisible,ce=b.state.isDestroyed,ve=!b.state.isEnabled,Ge=cr.isTouch&&!b.props.touch,ze=uh(b.props.duration,0,Kn.duration);if(!(z||ce||ve||Ge)&&!le().hasAttribute("disabled")&&(be("onShow",[b],!1),b.props.onShow(b)!==!1)){if(b.state.isVisible=!0,U()&&(k.style.visibility="visible"),he(),Q(),b.state.isMounted||(k.style.transition="none"),U()){var Jt=ee(),Tn=Jt.box,Ys=Jt.content;dh([Tn,Ys],0)}f=function(){var qi;if(!(!b.state.isVisible||c)){if(c=!0,k.offsetHeight,k.style.transition=b.props.moveTransition,U()&&b.props.animation){var af=ee(),tc=af.box,Ks=af.content;dh([tc,Ks],ze),J0([tc,Ks],"visible")}ke(),ge(),G0(hh,b),(qi=b.popperInstance)==null||qi.forceUpdate(),be("onMount",[b]),b.props.animation&&U()&&R(ze,function(){b.state.isShown=!0,be("onShown",[b])})}},Mn()}}function tC(){var z=!b.state.isVisible,ce=b.state.isDestroyed,ve=!b.state.isEnabled,Ge=uh(b.props.duration,1,Kn.duration);if(!(z||ce||ve)&&(be("onHide",[b],!1),b.props.onHide(b)!==!1)){if(b.state.isVisible=!1,b.state.isShown=!1,c=!1,o=!1,U()&&(k.style.visibility="hidden"),je(),ae(),he(!0),U()){var ze=ee(),Jt=ze.box,Tn=ze.content;b.props.animation&&(dh([Jt,Tn],Ge),J0([Jt,Tn],"hidden"))}ke(),ge(),b.props.animation?U()&&j(Ge,b.unmount):b.unmount()}}function nC(z){Te().addEventListener("mousemove",p),G0(Oc,p),p(z)}function rC(){b.state.isVisible&&b.hide(),b.state.isMounted&&(Ui(),Hn().forEach(function(z){z._tippy.unmount()}),k.parentNode&&k.parentNode.removeChild(k),hh=hh.filter(function(z){return z!==b}),b.state.isMounted=!1,be("onHidden",[b]))}function iC(){b.state.isDestroyed||(b.clearDelayTimeouts(),b.unmount(),lt(),delete n._tippy,b.state.isDestroyed=!0,be("onDestroy",[b]))}}function Xl(n,e){e===void 0&&(e={});var t=Kn.plugins.concat(e.plugins||[]);eq();var r=Object.assign({},e,{plugins:t}),i=GU(n),s=i.reduce(function(o,a){var l=a&&uq(a,r);return l&&o.push(l),o},[]);return sf(n)?s[0]:s}Xl.defaultProps=Kn;Xl.setDefaultProps=oq;Xl.currentInput=cr;Object.assign({},A2,{effect:function(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow)}});Xl.setDefaultProps({render:Y2});var cv=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},nr=(n,e,t)=>(cv(n,e,"read from private field"),t?t.call(n):e.get(n)),Qs=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},ca=(n,e,t,r)=>(cv(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),dq=(n,e,t)=>(cv(n,e,"access private method"),t),Pr,_u,ku,xu,Cu,Ip,K2;class fq{constructor(e){var t,r,i;Qs(this,Ip),Qs(this,Pr,void 0),Qs(this,_u,void 0),Qs(this,ku,void 0),Qs(this,xu,void 0),Qs(this,Cu,void 0),ca(this,Cu,(s,o)=>{var m;const{state:a,composing:l}=s,{selection:c,doc:u}=a,{ranges:d}=c,f=Math.min(...d.map(g=>g.$from.pos)),h=Math.max(...d.map(g=>g.$to.pos)),p=o&&o.doc.eq(u)&&o.selection.eq(c);if((m=nr(this,Pr))!=null||ca(this,Pr,Xl(s.dom,{trigger:"manual",interactive:!0,...nr(this,_u),content:this.element})),!(l||p)){if(!nr(this,xu).call(this,s,o)){this.hide();return}nr(this,Pr).setProps({getReferenceClientRect:()=>zm(s,f,h)}),this.show()}}),this.update=(s,o)=>{Lx(nr(this,Cu),nr(this,ku))(s,o)},this.destroy=()=>{var s;(s=nr(this,Pr))==null||s.destroy()},this.show=()=>{var s;(s=nr(this,Pr))==null||s.show()},this.hide=()=>{var s;(s=nr(this,Pr))==null||s.hide()},this.getInstance=()=>nr(this,Pr),this.element=e.content,ca(this,_u,(t=e.tippyOptions)!=null?t:{}),ca(this,ku,(r=e.debounce)!=null?r:200),ca(this,xu,(i=e.shouldShow)!=null?i:dq(this,Ip,K2))}}Pr=new WeakMap,_u=new WeakMap,ku=new WeakMap,xu=new WeakMap,Cu=new WeakMap,Ip=new WeakSet,K2=function(n){const{doc:e,selection:t}=n.state,{empty:r,from:i,to:s}=t,o=!e.textBetween(i,s).length&&n.state.selection instanceof Me,a=this.element.contains(document.activeElement),l=!n.hasFocus()&&!a,c=!n.editable;return!(l||r||o||c)};function uv(n){const e=fn({},"".concat(n,"_TOOLTIP_SPEC")),t=Vn(i=>{const s=i.get(e.key);return new Gt({key:new Bt("".concat(n,"_TOOLTIP")),...s})}),r=[e,t];return r.key=e.key,r.pluginKey=t.key,e.meta={package:"@milkdown/plugin-tooltip",displayName:"Ctx<tooltipSpec>|".concat(n)},t.meta={package:"@milkdown/plugin-tooltip",displayName:"Prose<tooltip>|".concat(n)},r}const dv=fn(null,"tableTooltip"),rb=uv("TABLE"),hq=["draggable"],pq=W({__name:"TableSelectorWidget",setup(n){var m;const{spec:e}=$F(),t=e==null?void 0:e.type,r=(m=e==null?void 0:e.index)!=null?m:0,[i,s]=Pl(),o=E(null),a=E(!1),l=A(()=>"absolute bg-grey-200 "+(a.value?"border border-blue-400 border-2":"")),c=A(()=>t==="left"?"w-1w h-100 left-n3-5v top-0 fr-py-1v":t==="top"?"right-px h-1w w-100 left-0 top-n3-5v":"h-3v w-3v left-n2w top-n2w rounded-circle");function u(g){g.stopPropagation();const w=o.value;if(!w||i.value)return;s().action(M=>{var k;const b=M.get(dv.key);(k=b==null?void 0:b.getInstance())==null||k.setProps({getReferenceClientRect:()=>w.getBoundingClientRect()}),b==null||b.show();const C=M.get(xe);t==="left"?C.call(Hg.key,r):t==="top"?C.call(Wg.key,r):C.call(jg.key)})}function d(g){g.stopPropagation();const w={index:e==null?void 0:e.index,type:e==null?void 0:e.type};g.dataTransfer&&(g.dataTransfer.setData("application/milkdown-table-sort",JSON.stringify(w)),g.dataTransfer.effectAllowed="move")}function f(g){a.value=!0,g.stopPropagation(),g.preventDefault(),g.dataTransfer&&(g.dataTransfer.dropEffect="move")}function h(){a.value=!1}function p(g){var M,b;if(a.value=!1,t==="top-left")return;const w=e==null?void 0:e.index;if(i.value||w==null)return;const x=(b=(M=g.dataTransfer)==null?void 0:M.getData("application/milkdown-table-sort"))!=null?b:"";try{const{index:C,type:k}=JSON.parse(x);s().action(O=>{const D=O.get(xe),N={from:Number(C),to:w};D.call(k==="left"?Fg.key:Vg.key,N)})}catch(C){}}return(g,w)=>(_(),S("button",{ref_key:"containerRef",ref:o,draggable:v(t)!=="top-left",class:me(["table-selector block fr-p-0",c.value+" "+l.value]),onClick:u,onDragstart:d,onDragover:f,onDragleave:h,onDrop:p},null,42,hq))}});const mq=Ne(pq,[["__scopeId","data-v-e26c3559"]]);function gq(n){return Vn(()=>{const e=new Bt("MILKDOWN_TABLE_SELECTOR");return new Gt({key:e,state:{init(){return{decorations:Qe.empty,pos:0}},apply(t,r,i,s){const o=ds(0,t.selection);if(!o)return{decorations:Qe.empty,pos:0};const a=fs(0,t.selection);if(!a)return{decorations:Qe.empty,pos:0};const l=n({as:"div",component:mq}),[c]=o;if(!c)return{decorations:Qe.empty,pos:0};const u=[];return u.push(l(c.pos+1,{type:"top-left"})),o.forEach((d,f)=>{u.push(l(d.pos+1,{type:"left",index:f}))}),a.forEach((d,f)=>{u.push(l(d.pos+1,{type:"top",index:f}))}),r.pos===c.pos&&i.doc.eq(s.doc)?r:{decorations:Qe.create(t.doc,u),pos:c.pos}}},props:{decorations(t){return e.getState(t).decorations}}})})}const of=fn(null,"linkEditTooltip"),Vo=fn({from:-1,to:-1,mark:null},"linkTooltipStateCtx"),G2=uv("LINK_EDIT"),X2=Oe("InsertLink",n=>()=>()=>J2(n));function J2(n){var i;const e=n.get(xo),{selection:t}=e.state;if(t.empty)return!1;n.update(Vo.key,()=>({from:t.from,to:t.to,mark:null})),e.dispatch(e.state.tr.setSelection(Me.create(e.state.doc,t.from,t.to)));const r=n.get(of.key);return(i=r==null?void 0:r.getInstance())==null||i.setProps({getReferenceClientRect:()=>zm(e,t.from,t.to)}),r==null||r.show(),!0}const vq=[of,G2,Vo,X2].flat();function yq(n,e){const t=()=>Tu(n()),r=E(null);return{tooltipProvider:r,setTooltipProvider:s=>{r.value=s;const o=t();o!=null&&o.ctx&&o.ctx.isInjected(e)&&(o.ctx.set(e,s),r.value=s)}}}function fv(n,e){const{view:t}=zd(),[r,i]=Pl(),{tooltipProvider:s,setTooltipProvider:o}=yq(i,n);return it([e,r,s,t],([a,l,c,u],[d,f,h,p],m)=>{if(a&&!l&&!c&&u&&u.state){const g=ps(a);if(g instanceof HTMLElement){const w=new fq({content:g,tippyOptions:{zIndex:30},shouldShow:()=>!1});w.update(u),o(w)}m(()=>h==null?void 0:h.destroy())}}),{tooltipProvider:s}}const bq={},wq={class:"bg-white border border-default-grey fr-py-1w fr-px-3v rounded-xxs drop-shadow fr-grid-row fr-grid-row--middle no-wrap"};function _q(n,e){return _(),S("div",wq,[et(n.$slots,"default")])}const Z2=Ne(bq,[["render",_q]]);function kq(n,e,t){const r=n.state.tr;t&&r.removeMark(n.state.selection.from,n.state.selection.to,t),r.addMark(n.state.selection.from,n.state.selection.to,e),n.dispatch(r)}function xq(n,e,t,r){const i=n.state.tr;r&&i.removeMark(e,t,r),n.dispatch(i)}function Cq(){const n=E("");Dt(Q2,n)}function hv(){const n=dt(Q2);return{link:dd(n),updateLink(e){n.value=e}}}const Q2=Symbol(),Sq=["placeholder","onKeydown"],Mq=W({__name:"LinkEditTooltip",setup(n){const{t:e}=De(),t=E(null),{link:r,updateLink:i}=hv(),s=E("");zt(()=>{s.value=r.value});const{view:o}=zd(),[a,l]=Pl(),{tooltipProvider:c}=fv(of.key,t);function u(){var h;i(""),(h=c.value)==null||h.hide()}function d(){const h=Tu(l());if(!h)return;const{mark:p}=h.ctx.get(Vo.key),m=$i.type(h.ctx);if(p&&p.attrs.href===s.value){u();return}kq(o.value,m.create({href:s.value}),p),u()}function f(h){h.key==="Escape"&&u()}return(h,p)=>(_(),G(Z2,{ref_key:"toolTipRef",ref:t},{default:K(()=>[xt(y("input",{class:"input-area",placeholder:v(e)("Paste link..."),ref:"linkInput",onKeydown:[Bp($e(d,["stop","prevent"]),["enter"]),f],"onUpdate:modelValue":p[0]||(p[0]=m=>s.value=m)},null,40,Sq),[[Di,s.value]]),y("button",{class:me(["fr-ml-1w fr-button fr-btn--sm fr-btn--tertiary-no-outline",{"fr-hidden":s.value.length===0}]),onClick:d},T(v(e)("Confirm ⏎")),3)]),_:1},512))}});function Tq(n){const e=Rm();n.set(G2.key,{view:e({component:Mq})})}const cd=fn(null,"linkPreviewTooltip"),ud=uv("LINK_PREVIEW"),Oq=[cd,ud].flat(),$q={class:"text-overflow-ellipsis"},Dq=["href"],Eq=["title"],Aq=W({__name:"LinkPreviewTooltip",setup(n){const{t:e}=De(),t=E(null),{tooltipProvider:r}=fv(cd.key,t),{view:i}=zd(),[s,o]=Pl(),{link:a}=hv();function l(){var h;const u=Tu(o());if(!u)return;const{from:d,to:f}=u.ctx.get(Vo.key);(h=r.value)==null||h.hide(),i.value.dispatch(i.value.state.tr.setSelection(Me.create(i.value.state.doc,d,f))),J2(u.ctx)}function c(){var p;const u=Tu(o());if(!u)return;const{from:d,to:f,mark:h}=u.ctx.get(Vo.key);h&&xq(i.value,d,f,h),(p=r.value)==null||p.hide()}return(u,d)=>(_(),G(Z2,{ref_key:"toolTipRef",ref:t,class:me({"fr-hidden":v(a).length===0})},{default:K(()=>[d[0]||(d[0]=y("span",{"aria-hidden":"true",class:"fr-icon-link fr-mr-1w"},null,-1)),y("div",$q,[y("a",{class:"fr-link",href:v(a)},T(v(a)),9,Dq)]),y("button",{class:"fr-btn fr-btn--secondary fr-btn--sm fr-icon-pencil-line fr-mx-1w",onClick:l},T(v(e)("Edit link")),1),y("button",{class:"fr-btn fr-btn--tertiary fr-btn--sm fr-icon-link-unlink",title:v(e)("Remove link"),onClick:c},T(v(e)("Remove link")),9,Eq)]),_:1},8,["class"]))}});function Pq(n,e,t,r){let i={start:-1,end:-1};return e.nodesBetween(t,r,(s,o)=>{if(i.start>-1)return!1;i.start===-1&&n.isInSet(s.marks)&&(i={start:o,end:o+Math.max(s.textContent.length,1)})}),i}function Nq(n,e){return n.marks.find(t=>t.type===e)}function Rq(n,e){const t=e.posAtCoords(n);if(!t)return{node:null,pos:null};const{pos:r}=t;return{node:e.state.doc.nodeAt(r),pos:r}}function Lq(n,e,t){const{node:r,pos:i}=Rq({left:t.clientX,top:t.clientY},e);if(!r)return;const s=Nq(r,$i.mark.type(n));if(!(!s||!ud.pluginKey()))return{show:!0,pos:i,node:r,mark:s}}const ib=200;function Iq(n,e){const t=Rm(),r=E(!1),i=()=>{r.value=!0},s=()=>{r.value=!1},o=Od((l,c)=>{var f,h,p;if(!l.hasFocus())return;const u=Lq(n,l,c),d=n.get(cd.key);if(u){const m=l.state.doc.resolve(u.pos),g=Pq(u.mark,l.state.doc,m.before(),m.after()),w=n.get(ud.key);if(!w||!w.view)return;(f=d==null?void 0:d.getInstance())==null||f.setProps({getReferenceClientRect:()=>zm(l,g.start,g.end)}),n.update(Vo.key,()=>({from:g.start,to:g.end,mark:u.mark})),e(u.mark.attrs.href),d==null||d.show(),(h=d==null?void 0:d.getInstance())==null||h.popper.addEventListener("mouseenter",i),(p=d==null?void 0:d.getInstance())==null||p.popper.addEventListener("mouseleave",s);return}a()},ib),a=()=>{setTimeout(()=>{var u,d,f;if(r.value)return;const l=n.get(cd.key),c=n.get(of.key);l==null||l.hide(),(u=c==null?void 0:c.getInstance())!=null&&u.state.isVisible||e(""),(d=l==null?void 0:l.getInstance())==null||d.popper.removeEventListener("mouseenter",i),(f=l==null?void 0:l.getInstance())==null||f.popper.removeEventListener("mouseleave",s)},ib)};n.set(ud.key,{props:{handleDOMEvents:{mousemove:o,mouseleave:a}},view:t({component:Aq})})}const zq='<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M3 6H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 14H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M6 10L18 10" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M6 18L18 18" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',Bq='<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M3 10L17 10" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 6H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 18L17 18" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 14H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',Fq='<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M7 10L21 10" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 6H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M7 18L21 18" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 14H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',Vq=["innerHTML"],Qr=W({__name:"TooltipButton",props:{icon:{},svg:{}},emits:["click"],setup(n,{emit:e}){const t=n,r=t.icon?t.icon:"fr-icon-svg",i=e;return(s,o)=>(_(),S("button",{class:me(["fr-btn fr-btn--secondary fr-btn--sm bg-white",v(r)]),onClick:o[0]||(o[0]=a=>i("click"))},[s.svg?(_(),S("div",{key:0,innerHTML:s.svg},null,8,Vq)):V("",!0),et(s.$slots,"default")],2))}}),Hq={class:"fr-hidden"},Wq=W({__name:"TableTooltip",setup(n){const{t:e}=De(),t=E(null),{view:r}=zd(),[i,s]=Pl(),{tooltipProvider:o}=fv(dv.key,t),a=A(()=>r.value.state.selection instanceof tt&&r.value.state.selection.isRowSelection()),l=A(()=>r.value.state.selection instanceof tt&&r.value.state.selection.isColSelection()),c=A(()=>a.value&&l.value),u=A(()=>a.value||l.value),d=A(()=>{var f;return a.value&&((f=r.value.state.doc.nodeAt(r.value.state.selection.$headCell.pos))==null?void 0:f.type.name)==="table_header"});return(f,h)=>(_(),S("div",Hq,[y("div",{class:"fr-grid-row",ref_key:"toolTipRef",ref:t},[!c.value&&!d.value&&a.value?(_(),G(Qr,{key:0,icon:"fr-icon-arrow-up-line",class:"fr-mr-1v",title:v(e)("Add row before"),onClick:h[0]||(h[0]=()=>{var p,m;v(i)||((p=v(s)())==null||p.action(g=>{g.get(v(xe)).call(v(Kg).key)}),(m=v(o))==null||m.hide())})},null,8,["title"])):V("",!0),!c.value&&l.value?(_(),G(Qr,{key:1,icon:"fr-icon-arrow-left-line",class:"fr-mr-1v",title:v(e)("Add column before"),onClick:h[1]||(h[1]=()=>{var p,m;v(i)||((p=v(s)())==null||p.action(g=>{g.get(v(xe)).call(v(qg).key)}),(m=v(o))==null||m.hide())})},null,8,["title"])):V("",!0),c.value||!d.value&&u.value?(_(),G(Qr,{key:2,icon:"fr-icon-delete-line",class:"fr-mr-1v",title:v(e)("Delete selected cells"),onClick:h[2]||(h[2]=()=>{var p,m;v(i)||((p=v(s)())==null||p.action(g=>{g.get(v(xe)).call(v(Ug).key)}),(m=v(o))==null||m.hide())})},null,8,["title"])):V("",!0),!c.value&&a.value?(_(),G(Qr,{key:3,icon:"fr-icon-arrow-down-line",class:"fr-mr-1v",title:v(e)("Add row after"),onClick:h[3]||(h[3]=()=>{var p,m;v(i)||((p=v(s)())==null||p.action(g=>{g.get(v(xe)).call(v(Gg).key)}),(m=v(o))==null||m.hide())})},null,8,["title"])):V("",!0),!c.value&&l.value?(_(),S(X,{key:4},[P(Qr,{icon:"fr-icon-arrow-right-line",class:"fr-mr-1v",title:v(e)("Add column after"),onClick:h[4]||(h[4]=()=>{var p,m;v(i)||((p=v(s)())==null||p.action(g=>{g.get(v(xe)).call(v(Yg).key)}),(m=v(o))==null||m.hide())})},null,8,["title"]),P(Qr,{svg:v(Bq),class:"fr-mr-1v",title:v(e)("Align left"),onClick:h[5]||(h[5]=()=>{var p;v(i)||(p=v(s)())==null||p.action(m=>{m.get(v(xe)).call(v(Qa).key,"left")})})},null,8,["svg","title"]),P(Qr,{class:"fr-mr-1v",svg:v(zq),title:v(e)("Align center"),onClick:h[6]||(h[6]=()=>{var p;v(i)||(p=v(s)())==null||p.action(m=>{m.get(v(xe)).call(v(Qa).key,"center")})})},null,8,["svg","title"]),P(Qr,{class:"fr-mr-1v",svg:v(Fq),title:v(e)("Align right"),onClick:h[7]||(h[7]=()=>{var p;v(i)||(p=v(s)())==null||p.action(m=>{m.get(v(xe)).call(v(Qa).key,"right")})})},null,8,["svg","title"])],64)):V("",!0)],512)]))}});const jq={class:"editor__container"},Uq={class:"fr-mx-auto fr-grid-row fr-pb-1v",role:"menubar"},qq={role:"group",class:"fr-pr-1w"},Yq={role:"group",class:"fr-pr-1w"},Kq={role:"group",class:"fr-px-1w"},Gq={role:"group",class:"fr-pl-1w"},Xq={class:"fr-p-1v"},Jq=W({__name:"InternalEditor",props:{ariaLabel:{},ariaLabelledBy:{},id:{},disabled:{type:Boolean,default:!1},value:{default:""}},emits:["change","editorMounted"],setup(n,{emit:e}){const t=n,r=e,i=Od(h=>r("change",h),300),{t:s}=De(),o=Rm(),a=DF(),{updateLink:l}=hv(),c=ch.findIndex(h=>h===Qg);ch[c]=Rj;const u=[ch,rb,dv,h=>async()=>{h.set(rb.key,{view:o({component:Wq})})},gq(a)].flat(),d=UI(h=>rH.make().config(p=>{p.set(fu,h),Tq(p),Iq(p,l),p.set(lu,t.value),p.set(Gd.key,m=>{const g=m.attrs.level;return g===1?{class:"fr-h1"}:g===2?{class:"fr-h2"}:g===3?{class:"fr-h3"}:g===4?{class:"fr-h4"}:g===5?{class:"fr-h5"}:g===6?{class:"fr-h6"}:{}}),p.update(du,m=>{const g=m.attributes;return{...m,attributes:w=>{const x=typeof g=="function"?g(w):g!=null?g:{};return x.id=t.id,x["data-testid"]="markdown-editor",t.ariaLabelledBy?x["aria-labelledby"]=t.ariaLabelledBy:t.ariaLabel&&(x.ariaLabel=t.ariaLabel),{...x}},editable:()=>!t.disabled}}),p.set(Yd.key,()=>({class:"text-lg"})),p.get(od).markdownUpdated((m,g,w)=>i(g)),p.get(od).mounted(m=>{r("editorMounted")})}).use(hW).use(u).use(yH).use(vq).use(Oq).use(zx));function f(h,p){var m;return(m=d.get())==null?void 0:m.action(vH(h,p))}return(h,p)=>(_(),S("div",jq,[y("div",Uq,[y("div",qq,[P(mn,{icon:"fr-icon-arrow-go-back-line",onClick:p[0]||(p[0]=()=>f(v(Wd).key)),title:v(s)("Undo")},null,8,["title"]),P(mn,{icon:"fr-icon-arrow-go-forward-line",onClick:p[1]||(p[1]=()=>f(v(jd).key)),title:v(s)("Redo")},null,8,["title"])]),p[13]||(p[13]=y("div",{role:"separator",class:"w-1px bg-grey-125 fr-my-1v"},null,-1)),y("div",Yq,[P(mn,{icon:"fr-icon-bold",onClick:p[2]||(p[2]=()=>f(v(qd).key)),title:v(s)("Bold")},null,8,["title"]),P(mn,{icon:"fr-icon-italic",onClick:p[3]||(p[3]=()=>f(v(Ud).key)),title:v(s)("Italic")},null,8,["title"]),P(mn,{icon:"fr-icon-h-1",onClick:p[4]||(p[4]=()=>f(v(lr).key,3)),title:v(s)("Title")},null,8,["title"]),P(mn,{icon:"fr-icon-h-2",onClick:p[5]||(p[5]=()=>f(v(lr).key,4)),title:v(s)("Subtitle")},null,8,["title"])]),p[14]||(p[14]=y("div",{role:"separator",class:"w-1px bg-grey-125 fr-my-1v"},null,-1)),y("div",Kq,[P(mn,{icon:"fr-icon-table-2",onClick:p[6]||(p[6]=()=>f(v(Bg).key)),title:v(s)("Table")},null,8,["title"]),P(mn,{icon:"fr-icon-link",onClick:p[7]||(p[7]=()=>f(v(X2).key)),title:v(s)("Link")},null,8,["title"]),P(Pj,{onSend:p[8]||(p[8]=m=>f(v(lg).key,m))})]),p[15]||(p[15]=y("div",{role:"separator",class:"w-1px bg-grey-125 fr-my-1v"},null,-1)),y("div",Gq,[P(mn,{icon:"fr-icon-list-unordered",onClick:p[9]||(p[9]=()=>f(v(Zd).key)),title:v(s)("List unordered")},null,8,["title"]),P(mn,{icon:"fr-icon-list-ordered",onClick:p[10]||(p[10]=()=>f(v(Qd).key)),title:v(s)("List ordered")},null,8,["title"]),P(mn,{icon:"fr-icon-code-s-slash-line",onClick:p[11]||(p[11]=()=>f(v(Jd).key)),title:v(s)("Code block")},null,8,["title"]),P(mn,{icon:"fr-icon-quote-line",onClick:p[12]||(p[12]=()=>f(v(Xd).key)),title:v(s)("Quote")},null,8,["title"])])]),y("div",Xq,[P(v(WI))])]))}}),Zq=W({__name:"MarkdownEditor",props:{ariaLabel:{},ariaLabelledBy:{},id:{},disabled:{type:Boolean},value:{}},emits:["change","editorMounted"],setup(n){const e=n;return Cq(),(t,r)=>(_(),G(v(jI),null,{default:K(()=>[P(v(PF),null,{default:K(()=>[P(Jq,yr(e,{onChange:r[0]||(r[0]=i=>t.$emit("change",i)),onEditorMounted:r[1]||(r[1]=i=>t.$emit("editorMounted"))}),null,16)]),_:1})]),_:1}))}}),Qq=["for"],eY={key:0,class:"fr-hint-text"},tY=["aria-describedby","id","disabled","type","value","placeholder","required"],nY={key:1,class:"fr-mt-1w"},rY=["aria-describedby","id","disabled","type","placeholder","value","required"],iY=["id"],sY=["id"],Su=W({__name:"InputGroup",props:{ariaDescribedby:{default:""},disabled:{type:Boolean,default:!1},errorText:{default:""},hasError:{type:Boolean,default:!1},hasWarning:{type:Boolean,default:!1},hintText:{default:""},isValid:{type:Boolean,default:!1},label:{},modelValue:{default:void 0},placeholder:{default:""},required:{type:Boolean,default:!1},type:{default:"text"},validText:{default:""}},emits:["change","update:modelValue"],setup(n,{expose:e,emit:t}){const r=t,i=n,{id:s}=jo("input");e({id:s});const o=A(()=>s+"-desc-error"),a=A(()=>s+"-desc-valid"),l=A(()=>{let f=i.ariaDescribedby?i.ariaDescribedby+" ":"";return i.isValid?f+=a.value:i.hasError&&(f+=o.value),f}),c=A(()=>({"fr-input-group--disabled":i.disabled,"fr-input-group--error":i.hasError,"fr-input-group--warning":!i.hasError&&i.hasWarning,"fr-input-group--valid":i.isValid})),u=fb(Hp);function d(f){let h;if(f instanceof Event){const p=f.target;h=p==null?void 0:p.value}else h=f;r("update:modelValue",h),r("change",h)}return(f,h)=>(_(),S("div",{class:me(["fr-input-group",c.value])},[y("label",{class:"fr-label",for:v(s)},[Y(T(f.label)+" ",1),P(pm,{required:f.required},null,8,["required"]),f.hintText?(_(),S("span",eY,T(f.hintText),1)):V("",!0)],8,Qq),f.type==="textarea"?(_(),S("textarea",{key:0,class:me(["fr-input",{"fr-input--error":f.hasError,"fr-input--warning":!f.hasError&&v(Qh),"fr-input--valid":f.isValid}]),"aria-describedby":l.value,id:v(s),disabled:f.disabled,type:f.type,value:f.modelValue,placeholder:f.placeholder,onChange:d,required:f.required},null,42,tY)):f.type==="date"?(_(),S("div",nY,[P(v(P_),{class:me(["fr-input",{"fr-input--error":f.hasError,"fr-input--valid":f.isValid}]),"aria-describedby":l.value,id:v(s),disabled:f.disabled,modelValue:f.modelValue,onChange:d,locale:v(u),inputFormat:"P"},null,8,["class","aria-describedby","id","disabled","modelValue","locale"])])):f.type==="range"?(_(),G(VI,{key:2,modelValue:f.modelValue,onChange:d},null,8,["modelValue"])):f.type==="markdown"?(_(),G(Zq,{key:3,class:me(["fr-mt-1w",{"fr-input--error":f.hasError,"fr-input--warning":!f.hasError&&v(Qh),"fr-input--valid":f.isValid}]),"aria-describedby":l.value,id:v(s),disabled:f.disabled,value:f.modelValue,placeholder:f.placeholder,onChange:d,required:f.required},null,8,["class","aria-describedby","id","disabled","value","placeholder","required"])):(_(),S("input",{key:4,class:me(["fr-input",{"fr-input--error":f.hasError,"fr-input--valid":f.isValid}]),"aria-describedby":l.value,id:v(s),disabled:f.disabled,type:f.type,placeholder:f.placeholder,value:f.modelValue,onChange:d,required:f.required},null,42,rY)),f.isValid?(_(),S("p",{key:5,id:a.value,class:"fr-valid-text"},T(f.validText),9,iY)):f.hasError?(_(),S("p",{key:6,id:o.value,class:"fr-error-text"},T(f.errorText),9,sY)):V("",!0)],2))}}),oY=["aria-labelledby","id"],aY={class:"fr-container fr-container--fluid fr-container-md"},lY={class:"fr-grid-row fr-grid-row--center"},cY={class:"fr-col-12 fr-col-md-8"},uY={class:"fr-modal__body"},dY={class:"fr-modal__header"},fY=["title","aria-controls","disabled"],hY={class:"fr-modal__content"},pY=["id"],mY=["href"],gY={class:"fr-modal__footer"},vY={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-lg fr-btns-group--icon-left"},yY=["aria-controls"],bY={class:"fr-modal__content"},wY=["id"],_Y=["href"],kY={class:"fr-modal__footer"},xY={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-lg fr-btns-group--icon-left"},CY=["aria-controls","disabled"],SY=W({__name:"ReportModal",props:{id:{},loading:{type:Boolean},succeeded:{type:Boolean}},emits:["send"],setup(n,{emit:e}){const t=e,{t:r}=De(),i=Ws("modal-title"),s=E(),o={reason:"",message:""},a=Hs({...o}),l=E([]),c={reason:{required:bh},message:{required:bh}},{getErrorText:u,getFunctionalState:d,hasError:f,reset:h,validateRequiredRules:p,v$:m}=A_(a,c,c),g=b=>f(w,b),w=A(()=>({reason:d(m.value.reason.$dirty,m.value.reason.$error,!1),message:d(m.value.message.$dirty,m.value.message.$error,!1)}));function x(){globalThis.dsfr(s.value).modal.conceal(),a.message=o.message,a.reason=o.reason,h()}function M(){p().then(b=>{b&&t("send",{...a})})}return Ke(async()=>{l.value=await AL()}),(b,C)=>{const k=yt("i18n-t");return _(),G(Li,{to:"body"},[y("dialog",yr(b.$attrs,{"aria-labelledby":v(i),id:b.id,role:"dialog",class:"fr-modal",ref_key:"modalRef",ref:s}),[y("div",aY,[y("div",lY,[y("div",cY,[y("div",uY,[y("div",dY,[y("button",{class:"fr-btn--close fr-btn",title:v(r)("Close the modal dialog"),"aria-controls":b.id,target:"_self",disabled:b.loading,onClick:x},T(v(r)("Close")),9,fY)]),b.succeeded?(_(),S(X,{key:0},[y("div",hY,[y("h2",{id:v(i),class:"fr-mb-2w"},[C[2]||(C[2]=y("span",{class:"fr-icon-success-line fr-icon--lg"},null,-1)),Y(T(v(r)("Thanks for reporting this content")),1)],8,pY),P(k,{keypath:"{site} team will examine the content to check if it breaks our {markup}. Thanks for your help.",tag:"p",class:"fr-mt-0 fr-mb-1w fr-text--xs",scope:"global"},{site:K(()=>[Y(T(v(hb)),1)]),markup:K(()=>[y("a",{href:v(wv)},T(v(r)("usage policy")),9,mY)]),_:1})]),y("div",gY,[y("div",vY,[y("button",{class:"fr-btn","aria-controls":b.id,target:"_self",onClickCapture:$e(x,["prevent","stop"])},T(v(r)("Close")),41,yY)])])],64)):(_(),S(X,{key:1},[y("div",bY,[y("h2",{id:v(i),class:"fr-mb-2w"},T(v(r)("Report this content")),9,wY),P(v(Au),{class:"fr-mb-2w",color:"warning",weight:"regular"},{default:K(()=>[C[3]||(C[3]=y("span",{class:"fr-icon-warning-line fr-mr-1v","aria-hidden":"true"},null,-1)),Y(" "+T(v(r)("Please only report in case of serious concern."))+" ",1),y("a",{href:v(wv)},T(v(r)("See our usage policy")),9,_Y)]),_:1}),P(tI,{label:v(r)("Report reason"),required:!0,modelValue:a.reason,"onUpdate:modelValue":C[0]||(C[0]=$=>a.reason=$),hasError:g("reason"),errorText:v(u)("reason"),options:l.value},null,8,["label","modelValue","hasError","errorText","options"]),P(Su,{type:"textarea",label:v(r)("Message"),required:!0,hasError:g("message"),errorText:v(u)("message"),modelValue:a.message,"onUpdate:modelValue":C[1]||(C[1]=$=>a.message=$),placeholder:v(r)("Reason of your report.{newline}Don't include any personal data.")},null,8,["label","hasError","errorText","modelValue","placeholder"])]),y("div",kY,[y("div",xY,[y("button",{class:"fr-btn","aria-controls":b.id,target:"_self",disabled:b.loading,onClickCapture:$e(M,["prevent","stop"])},T(v(r)("Send")),41,CY)])])],64))])])])])],16,oY)])}}}),MY=["aria-controls","disabled","title"],TY=W({__name:"ReportModalButton",props:{objectType:{},objectId:{}},setup(n){const e=n,{t}=De(),{toast:r}=Bn(),i=E(!1),s=E(!1),o=Ws();async function a(l){try{i.value=!0,await PL(e.objectType,e.objectId,l.reason,l.message),s.value=!0}catch(c){r.error(t("An unexpected error occured while reporting this content."))}finally{i.value=!1}}return(l,c)=>(_(),S(X,null,[y("button",yr({class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 fr-icon-flag-line","data-fr-opened":"false","aria-controls":v(o)},l.$attrs,{disabled:i.value,title:v(t)("Make a report")}),T(v(t)("Make a report")),17,MY),P(SY,{id:v(o),loading:i.value,succeeded:s.value,onSend:a},null,8,["id","loading","succeeded"])],64))}}),OY={class:"fr-grid-row fr-grid-row--middle justify-between","data-cy":"search"},$Y={class:"fr-search-bar fr-search-bar--lg w-100"},DY=["for"],EY=["id","aria-label","placeholder"],AY={class:"fr-btn",type:"submit"},PY={class:"fr-grid-row fr-mt-1w fr-mt-md-5v"},NY={class:"fr-col-12 fr-col-md-4 fr-col-lg-3"},RY={class:"fr-sidemenu","aria-labelledby":"fr-sidemenu-title"},LY={class:"fr-sidemenu__inner"},IY={class:"fr-sidemenu__btn fr-mt-1w",hidden:"","aria-controls":"fr-sidemenu-wrapper","aria-expanded":"false"},zY={class:"fr-collapse",id:"fr-sidemenu-wrapper"},BY={class:"fr-sidemenu__title fr-mb-3v",id:"fr-sidemenu-title"},FY={class:"fr-grid-row fr-grid-row--gutters"},VY={key:0,class:"fr-col-12"},HY={class:"fr-col-12"},WY={class:"fr-select-group"},jY=["for"],UY=["id"],qY={value:null},YY={value:!1},KY={value:!0},GY={key:1,class:"fr-col-12 fr-mb-3w text-align-center"},XY={class:"fr-col-12 fr-col-md-8 fr-col-lg-9 fr-mt-2w fr-mt-md-0 search-results"},JY={key:0},ZY={key:1,class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle justify-between fr-pb-1w"},QY={class:"fr-col-auto fr-my-0",role:"status"},eK={key:2},tK={class:"fr-mt-1w border-default-grey border-top relative z-2"},nK={key:3,class:"fr-mt-2w"},rK=W({__name:"DataservicesSearch",props:{organization:{default:""}},setup(n){const e=n,{t}=De(),{toast:r}=w4(),i=E(null);it(i,()=>a.value=1);const s=E(null);it(s,()=>a.value=1);const o=gv(),a=E(1),l=A(()=>i.value||s.value!==null),c=()=>{i.value="",s.value=null},u=()=>{f.value="",c(),m()},d=gv(),f=E(""),h=pS(f,500),p=bC("searchInputRef"),m=()=>{p.value&&p.value.scrollIntoView({behavior:"smooth"})},g=A(()=>{const O={};return i.value&&(O.organization=i.value),h.value&&(O.q=h.value),s.value!==null&&(O.is_restricted=s.value.toString()),e.organization&&(O.organization=e.organization),a.value&&a.value!==1&&(O.page=a.value.toString()),new URLSearchParams(O)}),{ignoreUpdates:w}=mS(g,()=>{let O=new URL(window.location.href);O.search=g.value.toString(),window.history.pushState(null,"",O)}),x=A(()=>"/dataservices/search/?".concat(g.value)),M=E(null),b=E(null);it(f,()=>{b.value&&b.value.abort(),a.value=1});const C=async()=>{M.value=null,b.value=new AbortController;try{const O=await Tl.get(x.value,{signal:b.value.signal});b.value=null,M.value=O.data}catch(O){hr.isCancel(O)||r.error(t("Error getting search results."))}},k=()=>{const O=new URL(window.location.href);i.value=O.searchParams.get("organization"),f.value=O.searchParams.get("q")||"",O.searchParams.get("is_restricted")==="true"?s.value=!0:O.searchParams.get("is_restricted")==="false"?s.value=!1:s.value=null,a.value=parseInt(O.searchParams.get("page")||"1")};Ke(()=>{var O;k(),C(),(O=p.value)==null||O.focus(),window.addEventListener("popstate",()=>{w(()=>{k()})})}),it(x,()=>{C()});const $=O=>{a.value=O};return(O,D)=>(_(),S("form",{class:"fr-pt-3v",onSubmit:$e(C,["prevent"])},[y("div",OY,[y("section",$Y,[y("label",{class:"fr-label",for:v(d)},T(v(t)("Search")),9,DY),xt(y("input",{id:v(d),type:"search","onUpdate:modelValue":D[0]||(D[0]=N=>f.value=N),ref:"searchInputRef",class:"fr-input","aria-label":v(t)("Search..."),placeholder:v(t)("Search..."),"data-cy":"search-input","data-testid":"search-input"},null,8,EY),[[Di,f.value]]),y("button",AY,T(v(t)("Search")),1)])]),y("div",PY,[y("div",NY,[y("nav",RY,[y("div",LY,[y("button",IY,T(v(t)("Filter results")),1),y("div",zY,[y("div",BY,T(v(t)("Filters")),1),y("div",FY,[e.organization?V("",!0):(_(),S("div",VY,[P(Nr,{placeholder:v(t)("Organizations"),searchPlaceholder:v(t)("Search an organization..."),allOption:v(t)("All organizations"),listUrl:"/organizations/?sort=-followers",suggestUrl:"/organizations/suggest/",entityUrl:"/organizations/",values:i.value,onChange:D[1]||(D[1]=N=>i.value=N),isBlue:!0},null,8,["placeholder","searchPlaceholder","allOption","values"])])),y("div",HY,[y("div",WY,[y("label",{class:"fr-label",for:v(o)},T(v(t)("Access terms")),9,jY),xt(y("select",{class:me(["fr-select",{"text-mention-grey":s.value===null}]),id:v(o),"onUpdate:modelValue":D[2]||(D[2]=N=>s.value=N)},[y("option",qY,T(v(t)("All access terms")),1),y("option",YY,T(v(t)("Open APIs to everyone")),1),y("option",KY,T(v(t)("Restricted access APIs")),1)],10,UY),[[fd,s.value]])])]),l.value?(_(),S("div",GY,[y("button",{class:"fr-btn fr-btn--secondary fr-icon-close-circle-line fr-btn--icon-left justify-center w-100",onClick:c},T(v(t)("Reset filters")),1)])):V("",!0)])])])])]),y("section",XY,[M.value===null?(_(),S("div",JY,[P(hm)])):V("",!0),M.value!==null?(_(),S("div",ZY,[y("p",QY,T(v(t)("{count} API",M.value.total)),1)])):V("",!0),M.value!==null&&M.value.data.length?(_(),S("div",eK,[y("ul",tK,[(_(!0),S(X,null,Ye(M.value.data,N=>(_(),S("li",{key:N.id},[P(v(ew),{dataservice:N,dataserviceUrl:N.self_web_url},null,8,["dataservice","dataserviceUrl"])]))),128))]),M.value!==null&&M.value.total>M.value.page_size?(_(),G(v(js),{key:0,page:a.value,pageSize:M.value.page_size,totalResults:M.value.total,onChange:$,class:"fr-mt-2w"},null,8,["page","pageSize","totalResults"])):(_(),G(qu,{key:1,onResetFilters:u}))])):V("",!0),M.value!==null&&M.value.data.length===0?(_(),S("div",nK,[P(qu,{onResetFilters:u})])):V("",!0)])])],32))}});FC({admin_root:VC,api_root:HC,api_2_root:WC,default_lang:wh.global.locale.value,only_locales:wh.global.locale.value,schema_documentation_url:jC,schema_validata_url:UC,show_copy_resource_permalink:!0,tabular_api_dataservice_id:qC,tabular_api_url:YC,tabular_page_size:KC,title:hb});const iK=n=>{const e=wC({});GC(e),e.use(XC),e.use(DR),e.use(JC),e.use(wh),e.component("chart",y6),e.component("dataset-resources",KR),e.component("dataset-resource-from-hash",OR),e.component("dataservice-card",ew),e.component("dataservice-links",_L),e.component("delete-button",HN),e.component("delete-user-button",sR),e.component("discussion-threads",qA),e.component("discussion-create",r_),e.component("featured-button",dR),e.component("follow-button",gR),e.component("menu-search",oP),e.component("owner-type",uM),e.component("owner-type-icon",Gp),e.component("read-more",nw),e.component("report-button",TY),e.component("request-membership",bR),e.component("reuse-card",S_),e.component("search",DN),e.component("dataservices-search",rK),e.component("toggletip",Zp),e.component("user-dataset-list",QR),e.component("user-reuse-list",aL),e.config.compilerOptions.delimiters=["",""],e.mount(n)},sK=document.querySelectorAll(".vuejs");sK.forEach(n=>{const e=n.innerHTML;try{iK(n)}catch(t){throw n.innerHTML=e,console.log("VueJS template compilation failed for element ".concat(n.className,".\n      Aborted the process and rolled back the HTML.\n      See error(s) above and below (probably won't help you tho) :")),console.log(n),console.error(t),t}});globalThis.dsfr.start();console.log("JS is injected !");EL();export{Qy as _,aK as __vite_legacy_guard,R7 as a,te as b,LH as l};
