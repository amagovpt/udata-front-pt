var P2=Object.defineProperty;var R2=(n,e,t)=>e in n?P2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var G=(n,e,t)=>(R2(n,typeof e!="symbol"?e+"":e,t),t);import*as Jg from"vue";import{defineComponent as B,inject as ct,useAttrs as N2,computed as A,openBlock as w,createElementBlock as S,mergeProps as rr,renderSlot as Ye,createBlock as Y,unref as y,normalizeProps as I2,withCtx as q,withAsyncContext as L2,createCommentVNode as I,normalizeClass as ue,ref as $,createVNode as P,createElementVNode as v,toDisplayString as T,toValue as at,watch as et,onMounted as Ve,nextTick as Aa,getCurrentInstance as yo,getCurrentScope as z2,onScopeDispose as B2,customRef as V0,onUpdated as H0,isRef as Jc,shallowRef as Xr,watchEffect as It,Fragment as J,createTextVNode as U,cloneVNode as F2,h as wt,provide as xt,onUnmounted as Nn,Teleport as ws,reactive as ki,Suspense as W0,normalizeStyle as vo,resolveDynamicComponent as Js,renderList as Fe,withModifiers as Se,defineAsyncComponent as j0,readonly as zu,resolveComponent as dt,withDirectives as yt,vModelText as fs,onBeforeMount as hp,onBeforeUnmount as U0,Transition as tl,vShow as Kr,render as Xg,TransitionGroup as V2,vModelSelect as Bu,withKeys as fp,isReactive as H2,isReadonly as W2,pushScopeId as j2,popScopeId as U2,markRaw as Fu,toRaw as Xc,useId as Qg,useTemplateRef as q2,createApp as Y2}from"vue";import{a as mt,g as K2,c as vt,r as G2,R as J2,y as Xt,b as pp,d as Yi,s as X2,p as ke,e as Vn,f as Ts,h as Ol,i as Id,j as Zg,n as Q2,t as Qc,k as Zc,u as Te,_ as Fs,Z as Z2,l as Vu,m as Ki,o as q0,q as xi,v as Qn,w as ps,x as ec,z as eC,A as tC,C as Y0,B as mp,D as ma,E as nl,F as Hu,G as nC,H as rC,I as sC,J as iC,K as Vs,L as Wu,M as Ld,N as oC,O as aC,P as lC,Q as cC,S as gp,T as rl,U as uC,V as ey,W as Fh,X as dC,Y as K0,$ as Vh,a0 as Hh,a1 as Wh,a2 as sl,a3 as ty,a4 as hC,a5 as fC,a6 as jh,a7 as G0,a8 as ny,a9 as pC,aa as mC,ab as gC,ac as yC,ad as Uh,ae as vC,af as bC,ag as wC,ah as _C,ai as kC,aj as xC,ak as CC,al as SC}from"./sentry.6.2.3.js";import{ContentLoader as il}from"vue-content-loader";import{c as _r,g as yp}from"./_commonjsHelpers.6.2.3.js";function mY(){import.meta.url,import("_").catch(()=>1);async function*n(){}}let Dl=null;function MC(){return K2("reuses/types/")}async function TC(){return Dl||(Dl=(await mt.get(MC())).data,Dl)}function OC(n,e){const t=n.find(r=>r.id===e);return t?t.label:""}let $l=null;async function J0(){return $l||($l=mt.get("datasets/schemas/").then(n=>n.data),$l)}function DC(n,e){return n.find(t=>(e==null?void 0:e.name)===t.name)||null}function $C(n){return"".concat(vt.schema_documentation_url).concat(n,"/")}function EC(n,e){var s;if(!n.schema||!n.schema.name)return null;let t={schema_name:"schema-datagouvfr.".concat(n.schema.name)};if(n.schema&&n.schema.version){const i=n.schema.version,o=(s=e.versions.find(a=>a.version_name===i))==null?void 0:s.schema_url;o&&(t={schema_url:o})}const r=new URLSearchParams({input:"url",url:n.url,"header-case":"on",...t}).toString();return"".concat(vt.schema_validata_url,"/table-schema?").concat(r)}const AC=["href"],no=B({__name:"AppLink",props:{to:{},custom:{type:Boolean},activeClass:{},exactActiveClass:{},ariaCurrentValue:{default:"page"},viewTransition:{type:Boolean},replace:{type:Boolean}},setup(n){const e=ct(G2,null),t=N2(),r=A(()=>({...t,target:e?"_blank":t.target}));function s(i){return!e||typeof i=="string"&&i.startsWith("http")}return(i,o)=>s(i.to)?(w(),S("a",rr({key:0},r.value,{href:i.to}),[Ye(i.$slots,"default")],16,AC)):(w(),Y(y(J2),I2(rr({key:1},i.$props)),{default:q(()=>[Ye(i.$slots,"default")]),_:3},16))}}),X0=B({__name:"AsyncTextClamp",props:{maxLines:{},text:{}},async setup(n){let e,t;const r=n,s=([e,t]=L2(()=>r.text),e=await e,t(),e);return(i,o)=>y(s)?(w(),Y(y(Xt),{key:0,text:y(s),"max-lines":i.maxLines},null,8,["text","max-lines"])):I("",!0)}});function PC(n,e){const t=(r,s)=>"".concat(vt.api_root,"avatars/").concat(r,"/").concat(s);return n.avatar_thumbnail||t(n.id,e)}const RC=["src","width","height"],Q0=B({__name:"Avatar",props:{rounded:{type:Boolean,default:!1},size:{default:40},user:{}},setup(n){const e=n,t=A(()=>PC(e.user,e.size));return(r,s)=>(w(),S("img",{class:ue({"rounded-circle border border-default-grey":r.rounded}),src:t.value,width:r.size,height:r.size,loading:"lazy",alt:""},null,10,RC))}}),NC={name:"ri-bank-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M2 20h20v2H2v-2zm2-8h2v7H4v-7zm5 0h2v7H9v-7zm4 0h2v7h-2v-7zm5 0h2v7h-2v-7zM2 7l10-5 10 5v4H2V7zm2 1.236V9h16v-.764l-8-4-8 4zM12 8a1 1 0 110-2 1 1 0 010 2z"/>'},IC={name:"ri-building-2-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M3 19V5.7a1 1 0 01.658-.94l9.671-3.516a.5.5 0 01.671.47v4.953l6.316 2.105a1 1 0 01.684.949V19h2v2H1v-2h2zm2 0h7V3.855L5 6.401V19zm14 0v-8.558l-5-1.667V19h5z"/>'},LC={name:"ri-check-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"/>'},zC={name:"ri-clipboard-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M7 4V2h10v2h3.007c.548 0 .993.445.993.993v16.014a.994.994 0 01-.993.993H3.993A.994.994 0 013 21.007V4.993C3 4.445 3.445 4 3.993 4H7zm0 2H5v14h14V6h-2v2H7V6zm2-2v2h6V4H9z"/>'},BC={name:"ri-community-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M21 21H3a1 1 0 01-1-1v-7.513a1 1 0 01.343-.754L6 8.544V4a1 1 0 011-1h14a1 1 0 011 1v16a1 1 0 01-1 1zM9 19h3v-6.058L8 9.454l-4 3.488V19h3v-4h2v4zm5 0h6V5H8v2.127c.234 0 .469.082.657.247l5 4.359a1 1 0 01.343.754V19zm2-8h2v2h-2v-2zm0 4h2v2h-2v-2zm0-8h2v2h-2V7zm-4 0h2v2h-2V7z"/>'},FC={name:"ri-download-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M3 19h18v2H3v-2zm10-5.828L19.071 7.1l1.414 1.414L12 17 3.515 8.515 4.929 7.1 11 13.17V2h2v11.172z"/>'},VC={name:"ri-file-copy-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M7 6V3a1 1 0 011-1h12a1 1 0 011 1v14a1 1 0 01-1 1h-3v3c0 .552-.45 1-1.007 1H4.007A1.001 1.001 0 013 21l.003-14c0-.552.45-1 1.007-1H7zM5.003 8L5 20h10V8H5.003zM9 6h8v10h2V4H9v2z"/>'},HC={name:"ri-file-warning-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M15 4H5v16h14V8h-4V4zM3 2.992C3 2.444 3.447 2 3.999 2H16l5 5v13.993A1 1 0 0120.007 22H3.993A1 1 0 013 21.008V2.992zM11 15h2v2h-2v-2zm0-8h2v6h-2V7z"/>'},WC={name:"ri-government-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M20 6h3v2h-1v11h1v2H1v-2h1V8H1V6h3V4a1 1 0 011-1h14a1 1 0 011 1v2zm0 2H4v11h3v-7h2v7h2v-7h2v7h2v-7h2v7h3V8zM6 5v1h12V5H6z"/>'},jC={name:"ri-user-line",minX:0,minY:0,width:24,height:24,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M4 22a8 8 0 1116 0h-2a6 6 0 10-12 0H4zm8-9c-3.315 0-6-2.685-6-6s2.685-6 6-6 6 2.685 6 6-2.685 6-6 6zm0-2c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4z"/>'},UC={key:0,style:{color:"#3558a2"}},qC={key:1},YC=B({__name:"CopyButton",props:{text:{},label:{},copiedLabel:{},hideLabel:{type:Boolean,default:!1}},setup(n){pp(LC,zC,VC);const e=n,t=$(!1),r=()=>{navigator.clipboard.writeText(e.text),t.value=!0,setTimeout(()=>t.value=!1,2e3)};return(s,i)=>(w(),S("button",{type:"button",onClick:r,class:ue(["fr-text--sm fr-mb-0 whitespace-nowrap relative fr-p-1v text-mention-grey line-height-1",{"border bg-white rounded-xxs text-grey-500":s.hideLabel}])},[t.value?(w(),S("span",UC,[P(y(Yi),{height:16,width:16,name:"ri-check-line"}),v("span",{class:ue(["fr-ml-1v copy-label",{"fr-sr-only":s.hideLabel}])},T(s.copiedLabel),3)])):I("",!0),t.value?I("",!0):(w(),S("span",qC,[P(y(Yi),{height:16,width:16,name:s.hideLabel?"ri-clipboard-line":"ri-file-copy-line",class:"copy-icon"},null,8,["name"]),v("span",{class:ue(["fr-ml-1v copy-link copy-label",{"fr-sr-only":s.hideLabel}])},T(s.label),3)]))],2))}}),$e=(n,e)=>{const t=n.__vccOpts||n;for(const[r,s]of e)t[r]=s;return t},Us=$e(YC,[["__scopeId","data-v-4d7d7e27"]]);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Pa=function(){return Pa=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Pa.apply(this,arguments)};function vp(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}var bp=function(n){var e=n.onRead,t=n.onRender,r=n.uncachedValues,s=r===void 0?new Set:r,i=n.useCache,o=i===void 0?!0:i;return function(a){a===void 0&&(a={});var l=vp(a,[]),c={},u=[],d=!1;function h(p,m){p.startsWith("--")&&(l.hasCSSVariable=!0);var g=c[p];c[p]=m,c[p]!==g&&(u.indexOf(p)===-1&&u.push(p),d||(d=!0,X2.render(f.render)))}var f={get:function(p,m){m===void 0&&(m=!1);var g=!m&&o&&!s.has(p)&&c[p]!==void 0;return g?c[p]:e(p,l)},set:function(p,m){if(typeof p=="string")h(p,m);else for(var g in p)h(g,p[g]);return this},render:function(p){return p===void 0&&(p=!1),(d||p===!0)&&(t(c,l,u),d=!1,u.length=0),this}};return f}},KC=/([a-z])([A-Z])/g,GC="$1-$2",ju=function(n){return n.replace(KC,GC).toLowerCase()},Z0=new Map,wp=new Map,eb=["Webkit","Moz","O","ms",""],JC=eb.length,XC=typeof document<"u",zd,tb=function(n,e){return wp.set(n,ju(e))},QC=function(n){zd=zd||document.createElement("div");for(var e=0;e<JC;e++){var t=eb[e],r=t==="",s=r?n:t+n.charAt(0).toUpperCase()+n.slice(1);if(s in zd.style||r){if(r&&n==="clipPath"&&wp.has(n))return;Z0.set(n,s),tb(n,(r?"":"-")+ju(s))}}},ZC=function(n){return tb(n,n)},nb=function(n,e){e===void 0&&(e=!1);var t=e?wp:Z0;return t.has(n)||(XC?QC(n):ZC(n)),t.get(n)||n},eS=["","X","Y","Z"],tS=["translate","scale","rotate","skew","transformPerspective"],qh=tS.reduce(function(n,e){return eS.reduce(function(t,r){return t.push(e+r),t},n)},["x","y","z"]),nS=qh.reduce(function(n,e){return n[e]=!0,n},{});function _p(n){return nS[n]===!0}function rS(n,e){return qh.indexOf(n)-qh.indexOf(e)}var sS=new Set(["originX","originY","originZ"]);function iS(n){return sS.has(n)}var ry=Pa(Pa({},Q2),{transform:Math.round}),oS={color:Vn,backgroundColor:Vn,outlineColor:Vn,fill:Vn,stroke:Vn,borderColor:Vn,borderTopColor:Vn,borderRightColor:Vn,borderBottomColor:Vn,borderLeftColor:Vn,borderWidth:ke,borderTopWidth:ke,borderRightWidth:ke,borderBottomWidth:ke,borderLeftWidth:ke,borderRadius:ke,radius:ke,borderTopLeftRadius:ke,borderTopRightRadius:ke,borderBottomRightRadius:ke,borderBottomLeftRadius:ke,width:ke,maxWidth:ke,height:ke,maxHeight:ke,size:ke,top:ke,right:ke,bottom:ke,left:ke,padding:ke,paddingTop:ke,paddingRight:ke,paddingBottom:ke,paddingLeft:ke,margin:ke,marginTop:ke,marginRight:ke,marginBottom:ke,marginLeft:ke,rotate:Ts,rotateX:Ts,rotateY:Ts,rotateZ:Ts,scale:Ol,scaleX:Ol,scaleY:Ol,scaleZ:Ol,skew:Ts,skewX:Ts,skewY:Ts,distance:ke,translateX:ke,translateY:ke,translateZ:ke,x:ke,y:ke,z:ke,perspective:ke,opacity:Id,originX:Zg,originY:Zg,originZ:ke,zIndex:ry,fillOpacity:Id,strokeOpacity:Id,numOctaves:ry},kp=function(n){return oS[n]},aS=function(n,e){return e&&typeof n=="number"?e.transform(n):n},ga="scrollLeft",ya="scrollTop",rb=new Set([ga,ya]),lS=new Set([ga,ya,"transform"]),cS={x:"translateX",y:"translateY",z:"translateZ"};function sb(n){return typeof n=="function"}function uS(n,e,t,r,s,i){i===void 0&&(i=!0);var o="",a=!1;t.sort(rS);for(var l=t.length,c=0;c<l;c++){var u=t[c];o+=(cS[u]||u)+"("+e[u]+") ",a=u==="z"?!0:a}return!a&&s?o+="translateZ(0)":o=o.trim(),sb(n.transform)?o=n.transform(e,r?"":o):i&&r&&(o="none"),o}function dS(n,e,t,r,s,i,o,a){e===void 0&&(e=!0),t===void 0&&(t={}),r===void 0&&(r={}),s===void 0&&(s={}),i===void 0&&(i=[]),o===void 0&&(o=!1),a===void 0&&(a=!0);var l=!0,c=!1,u=!1;for(var d in n){var h=n[d],f=kp(d),p=aS(h,f);_p(d)?(c=!0,r[d]=p,i.push(d),l&&(f.default&&h!==f.default||!f.default&&h!==0)&&(l=!1)):iS(d)?(s[d]=p,u=!0):(!lS.has(d)||!sb(p))&&(t[nb(d,o)]=p)}return(c||typeof n.transform=="function")&&(t.transform=uS(n,r,i,l,e,a)),u&&(t.transformOrigin=(s.originX||"50%")+" "+(s.originY||"50%")+" "+(s.originZ||0)),t}function xp(n){var e=n===void 0?{}:n,t=e.enableHardwareAcceleration,r=t===void 0?!0:t,s=e.isDashCase,i=s===void 0?!0:s,o=e.allowTransformNone,a=o===void 0?!0:o,l={},c={},u={},d=[];return function(h){return d.length=0,dS(h,r,l,c,u,d,i,a),l}}function hS(n,e){var t=e.element,r=e.preparseOutput,s=kp(n);if(_p(n))return s&&s.default||0;if(rb.has(n))return t[n];var i=window.getComputedStyle(t,null).getPropertyValue(nb(n,!0))||0;return r&&s&&s.test(i)&&s.parse?s.parse(i):i}function fS(n,e,t){var r=e.element,s=e.buildStyles,i=e.hasCSSVariable;if(Object.assign(r.style,s(n)),i)for(var o=t.length,a=0;a<o;a++){var l=t[a];l.startsWith("--")&&r.style.setProperty(l,n[l])}t.indexOf(ga)!==-1&&(r[ga]=n[ga]),t.indexOf(ya)!==-1&&(r[ya]=n[ya])}var pS=bp({onRead:hS,onRender:fS,uncachedValues:rb});function mS(n,e){e===void 0&&(e={});var t=e.enableHardwareAcceleration,r=e.allowTransformNone,s=vp(e,["enableHardwareAcceleration","allowTransformNone"]);return pS(Pa({element:n,buildStyles:xp({enableHardwareAcceleration:t,allowTransformNone:r}),preparseOutput:!0},s))}var ib=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues"]),sy=.5,ob=function(){return{style:{}}},Bd=function(n,e){return ke.transform(n*e)},gS={x:0,y:0,width:0,height:0};function iy(n,e,t){return typeof n=="string"?n:ke.transform(e+t*n)}function yS(n,e,t){return iy(e,n.x,n.width)+" "+iy(t,n.y,n.height)}var ab={enableHardwareAcceleration:!1,isDashCase:!1};function vS(n,e,t,r,s,i){e===void 0&&(e=gS),r===void 0&&(r=xp(ab)),s===void 0&&(s=ob()),i===void 0&&(i=!0);var o=n.attrX,a=n.attrY,l=n.originX,c=n.originY,u=n.pathLength,d=n.pathSpacing,h=d===void 0?1:d,f=n.pathOffset,p=f===void 0?0:f,m=vp(n,["attrX","attrY","originX","originY","pathLength","pathSpacing","pathOffset"]),g=r(m);for(var b in g)if(b==="transform")s.style.transform=g[b];else{var _=i&&!ib.has(b)?ju(b):b;s[_]=g[b]}return(l!==void 0||c!==void 0||g.transform)&&(s.style.transformOrigin=yS(e,l!==void 0?l:sy,c!==void 0?c:sy)),o!==void 0&&(s.x=o),a!==void 0&&(s.y=a),t!==void 0&&u!==void 0&&(s[i?"stroke-dashoffset":"strokeDashoffset"]=Bd(-p,t),s[i?"stroke-dasharray":"strokeDasharray"]=Bd(u,t)+" "+Bd(h,t)),s}function bS(n,e,t){t===void 0&&(t=!0);var r=ob(),s=xp(ab);return function(i){return vS(i,n,e,s,r,t)}}var wS=function(n){return typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()},_S=function(n){try{return wS(n)}catch(e){return{x:0,y:0,width:0,height:0}}},kS=function(n){return n.tagName==="path"},xS=bp({onRead:function(n,e){var t=e.element;if(n=ib.has(n)?n:ju(n),_p(n)){var r=kp(n);return r&&r.default||0}else return t.getAttribute(n)},onRender:function(n,e){var t=e.element,r=e.buildAttrs,s=r(n);for(var i in s)i==="style"?Object.assign(t.style,s.style):t.setAttribute(i,s[i])}}),CS=function(n){var e=_S(n),t=kS(n)&&n.getTotalLength?n.getTotalLength():void 0;return xS({element:n,buildAttrs:bS(e,t)})},SS=bp({useCache:!1,onRead:function(n){return n==="scrollTop"?window.pageYOffset:window.pageXOffset},onRender:function(n){var e=n.scrollTop,t=e===void 0?0:e,r=n.scrollLeft,s=r===void 0?0:r;return window.scrollTo(s,t)}}),Yh=new WeakMap,MS=function(n){return n instanceof HTMLElement||typeof n.click=="function"},TS=function(n){return n instanceof SVGElement||"ownerSVGElement"in n},OS=function(n,e){var t;return n===window?t=SS(n):MS(n)?t=mS(n,e):TS(n)&&(t=CS(n)),Yh.set(n,t),t},DS=function(n,e){return Yh.has(n)?Yh.get(n):OS(n,e)};function lb(n,e){var t=typeof n=="string"?document.querySelector(n):n;return DS(t,e)}function cb(n,e,t=0){if(n){const r=lb(n);e?(r.set({display:"block"}),r.render(!0),Qc({from:{height:0,padding:0},to:{height:n.scrollHeight+2*t,padding:t},duration:300,ease:Zc}).start({update:r.set,complete:()=>r.set({height:"auto"})})):Qc({from:{height:n.scrollHeight,padding:t},to:{height:0,padding:0},duration:300,ease:Zc}).start({update:r.set,complete:()=>r.set({height:0,display:"none"})})}}const eu="public-service",Kh="association",Gh="company",tu="local-authority",Uu="other",ub="user";function ji(n,e){return db(n,e)}function db(n,e){return at(n).badges.some(t=>t.kind===e)}function hb(){const{t:n}=Te();return[{type:eu,label:n("Public service"),icon:"ri-bank-line"},{type:tu,label:n("Local authority"),icon:"ri-government-line"},{type:Kh,label:n("Association"),icon:"ri-community-line"},{type:Gh,label:n("Company"),icon:"ri-building-2-line"},{type:Uu,label:n("Other"),icon:""},{type:ub,label:n("User"),icon:"ri-user-line"}]}function fb(n){return hb().find(e=>e.type===n)}function $S(n){const e=A(()=>ji(n,eu)),t=A(()=>ji(n,Kh)),r=A(()=>ji(n,tu)),s=A(()=>ji(n,Gh));return{type:A(()=>r.value?tu:e.value?eu:t.value?Kh:s.value?Gh:Uu)}}const oy=14,ES=B({__name:"OwnerTypeIcon",props:{type:{}},setup(n){pp(NC,IC,BC,WC,jC);const e=n,t=A(()=>fb(e.type).icon);return(r,s)=>t.value?(w(),Y(y(Yi),{key:0,height:oy,width:oy,name:t.value},null,8,["name"])):I("",!0)}}),Cp=$e(ES,[["__scopeId","data-v-7acefa45"]]),AS="certified";function PS(n){return{organizationCertified:A(()=>{const t=at(n);return t?db(t,AS)&&(ji(t,eu)||ji(t,tu)):!1})}}const RS=["title"],li=B({__name:"OrganizationNameWithCertificate",props:{organization:{},showType:{type:Boolean,default:!0}},setup(n){const{t:e}=Te(),t=n,{type:r}=$S(t.organization),{organizationCertified:s}=PS(t.organization);return(i,o)=>(w(),S("span",{class:ue(["inline-flex",y(r)!==y(Uu)||y(s)?"fr-grid-row--middle":"align-items-baseline"])},[v("span",null,[i.showType?(w(),Y(Cp,{key:0,type:y(r)},null,8,["type"])):I("",!0)]),P(y(Xt),{class:"fr-mx-1v","auto-resize":!0,text:i.organization.name,"max-lines":1},null,8,["text"]),y(s)?(w(),S("span",{key:0,class:"fr-icon-success-line fr-icon--sm",title:y(e)("The identity of this public service is certified by {certifier}",{certifier:y(vt).title}),"aria-hidden":"true"},null,8,RS)):I("",!0)],2))}}),NS=(n,e)=>{const t=n[e];return t?typeof t=="function"?t():Promise.resolve(t):new Promise((r,s)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+e)))})};function IS(n){return z2()?(B2(n),!0):!1}function Jh(n){return typeof n=="function"?n():y(n)}const LS=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Xh=()=>{};function pb(n,e){function t(...r){return new Promise((s,i)=>{Promise.resolve(n(()=>e.apply(this,r),{fn:e,thisArg:this,args:r})).then(s).catch(i)})}return t}const zS=n=>n();function BS(n,e={}){let t,r,s=Xh;const i=a=>{clearTimeout(a),s(),s=Xh};return a=>{const l=Jh(n),c=Jh(e.maxWait);return t&&i(t),l<=0||c!==void 0&&c<=0?(r&&(i(r),r=null),Promise.resolve(a())):new Promise((u,d)=>{s=e.rejectOnCancel?d:u,c&&!r&&(r=setTimeout(()=>{t&&i(t),r=null,u(a())},c)),t=setTimeout(()=>{r&&i(r),r=null,u(a())},l)})}}function FS(n){return n||yo()}function VS(n,e=200,t={}){return pb(BS(e,t),n)}function HS(n,e=200,t={}){const r=$(n.value),s=VS(()=>{r.value=n.value},e,t);return et(n,()=>s()),r}function mb(n,e=!0,t){FS()?Ve(n,t):e?n():Aa(n)}function WS(n,e,t={}){const{eventFilter:r=zS,...s}=t,i=pb(r,e);let o,a,l;if(s.flush==="sync"){const c=$(!1);a=()=>{},o=u=>{c.value=!0,u(),c.value=!1},l=et(n,(...u)=>{c.value||i(...u)},s)}else{const c=[],u=$(0),d=$(0);a=()=>{u.value=d.value},c.push(et(n,()=>{d.value++},{...s,flush:"sync"})),o=h=>{const f=d.value;h(),u.value+=d.value-f},c.push(et(n,(...h)=>{const f=u.value>0&&u.value===d.value;u.value=0,d.value=0,!f&&i(...h)},s)),l=()=>{c.forEach(h=>h())}}return{stop:l,ignoreUpdates:o,ignorePrevAsyncUpdates:a}}function gb(n,e,t){let r;Jc(t)?r={evaluating:t}:r=t||{};const{lazy:s=!1,evaluating:i=void 0,shallow:o=!0,onError:a=Xh}=r,l=$(!s),c=o?Xr(e):$(e);let u=0;return It(async d=>{if(!l.value)return;u++;const h=u;let f=!1;i&&Promise.resolve().then(()=>{i.value=!0});try{const p=await n(m=>{d(()=>{i&&(i.value=!1),f||m()})});h===u&&(c.value=p)}catch(p){a(p)}finally{i&&h===u&&(i.value=!1),f=!0}}),s?A(()=>(l.value=!0,c.value)):c}function qs(n){var e;const t=Jh(n);return(e=t==null?void 0:t.$el)!=null?e:t}const yb=LS?window:void 0;function Ra(n,e=null){const t=yo();let r=()=>{};const s=V0((i,o)=>(r=o,{get(){var a,l;return i(),(l=(a=t==null?void 0:t.proxy)==null?void 0:a.$refs[n])!=null?l:e},set(){}}));return mb(r),H0(r),s}function jS(){const n=$(!1),e=yo();return e&&Ve(()=>{n.value=!0},e),n}function US(n){const e=jS();return A(()=>(e.value,!!n()))}function qS(n,e,t={}){const{window:r=yb,...s}=t;let i;const o=US(()=>r&&"ResizeObserver"in r),a=()=>{i&&(i.disconnect(),i=void 0)},l=A(()=>Array.isArray(n)?n.map(d=>qs(d)):[qs(n)]),c=et(l,d=>{if(a(),o.value&&r){i=new ResizeObserver(e);for(const h of d)h&&i.observe(h,s)}},{immediate:!0,flush:"post"}),u=()=>{a(),c()};return IS(u),{isSupported:o,stop:u}}function YS(n,e={width:0,height:0},t={}){const{window:r=yb,box:s="content-box"}=t,i=A(()=>{var d,h;return(h=(d=qs(n))==null?void 0:d.namespaceURI)==null?void 0:h.includes("svg")}),o=$(e.width),a=$(e.height),{stop:l}=qS(n,([d])=>{const h=s==="border-box"?d.borderBoxSize:s==="content-box"?d.contentBoxSize:d.devicePixelContentBoxSize;if(r&&i.value){const f=qs(n);if(f){const p=f.getBoundingClientRect();o.value=p.width,a.value=p.height}}else if(h){const f=Array.isArray(h)?h:[h];o.value=f.reduce((p,{inlineSize:m})=>p+m,0),a.value=f.reduce((p,{blockSize:m})=>p+m,0)}else o.value=d.contentRect.width,a.value=d.contentRect.height},t);mb(()=>{const d=qs(n);d&&(o.value="offsetWidth"in d?d.offsetWidth:e.width,a.value="offsetHeight"in d?d.offsetHeight:e.height)});const c=et(()=>qs(n),d=>{o.value=d?e.width:0,a.value=d?e.height:0});function u(){l(),c()}return{width:o,height:a,stop:u}}const KS=["src","alt","width","height"],Qh=B({__name:"Placeholder",props:{type:{},src:{},alt:{},size:{}},setup(n){const e=n,t=async()=>{const i=await NS(Object.assign({"../../assets/img/placeholders/author.png":()=>Fs(()=>import("./author.6.2.3.js"),[]),"../../assets/img/placeholders/dataset.png":()=>Fs(()=>import("./dataset.6.2.3.js"),[]),"../../assets/img/placeholders/news.png":()=>Fs(()=>import("./news.6.2.3.js"),[]),"../../assets/img/placeholders/organization.png":()=>Fs(()=>import("./organization.6.2.3.js"),[]),"../../assets/img/placeholders/reuse.png":()=>Fs(()=>import("./reuse.6.2.3.js"),[])}),"../../assets/img/placeholders/".concat(e.type,".png"));return e.src?e.src:i.default},r=A(()=>e.src?e.alt:""),s=gb(()=>t());return(i,o)=>(w(),S("img",rr({loading:"lazy",src:y(s),alt:r.value,width:i.size,height:i.size},i.$attrs),null,16,KS))}}),GS=["value"],Fd=1,JS=B({__name:"QualityScore",props:{score:{},class:{default:""}},setup(n){const e=n,t=Fd*2/3,{t:r,locale:s}=Te(),i=A(()=>new Intl.NumberFormat(s.value,{style:"percent"}).format(e.score));return(o,a)=>(w(),S("meter",{class:ue(["quality-score",e.class]),min:"0",low:"0",high:t,max:Fd,optimum:Fd,value:o.score},[o.score>=t?(w(),S(J,{key:0},[U(T(y(r)("Good")),1)],64)):(w(),S(J,{key:1},[U(T(y(r)("To improve")),1)],64)),U("("+T(i.value)+") ",1)],10,GS))}}),XS={key:0,class:"fr-my-0"},QS={key:1,class:"fr-my-0 text-mention-grey"},Rr=B({__name:"QualityItem",props:{passed:{type:Boolean},messagePassed:{},messageFailed:{}},setup(n){return(e,t)=>(w(),S("li",null,[e.passed?(w(),S("p",XS,[t[0]||(t[0]=v("span",{class:"fr-icon-check-line","aria-hidden":"true"},null,-1)),U(" "+T(e.messagePassed),1)])):(w(),S("p",QS,[t[1]||(t[1]=v("span",{class:"fr-icon-warning-line","aria-hidden":"true"},null,-1)),U(" "+T(e.messageFailed),1)]))]))}});function ZS(n){typeof queueMicrotask=="function"?queueMicrotask(n):Promise.resolve().then(n).catch(e=>setTimeout(()=>{throw e}))}var ay;let e3=Symbol("headlessui.useid"),t3=0;const is=(ay=Jg.useId)!=null?ay:function(){return Jg.inject(e3,()=>"".concat(++t3))()};function ne(n){var e;if(n==null||n.value==null)return null;let t=(e=n.value.$el)!=null?e:n.value;return t instanceof Node?t:null}function fn(n,e,...t){if(n in e){let s=e[n];return typeof s=="function"?s(...t):s}let r=new Error('Tried to handle "'.concat(n,'" but there is no handler defined. Only defined handlers are: ').concat(Object.keys(e).map(s=>'"'.concat(s,'"')).join(", "),"."));throw Error.captureStackTrace&&Error.captureStackTrace(r,fn),r}var n3=Object.defineProperty,r3=(n,e,t)=>e in n?n3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ly=(n,e,t)=>(r3(n,typeof e!="symbol"?e+"":e,t),t);let s3=class{constructor(){ly(this,"current",this.detect()),ly(this,"currentId",0)}set(e){this.current!==e&&(this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}},qu=new s3;function $r(n){if(qu.isServer)return null;if(n instanceof Node)return n.ownerDocument;if(n!=null&&n.hasOwnProperty("value")){let e=ne(n);if(e)return e.ownerDocument}return document}let Zh=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(n=>"".concat(n,":not([tabindex='-1'])")).join(",");var _t=(n=>(n[n.First=1]="First",n[n.Previous=2]="Previous",n[n.Next=4]="Next",n[n.Last=8]="Last",n[n.WrapAround=16]="WrapAround",n[n.NoScroll=32]="NoScroll",n))(_t||{}),Qr=(n=>(n[n.Error=0]="Error",n[n.Overflow=1]="Overflow",n[n.Success=2]="Success",n[n.Underflow=3]="Underflow",n))(Qr||{}),i3=(n=>(n[n.Previous=-1]="Previous",n[n.Next=1]="Next",n))(i3||{});function Yu(n=document.body){return n==null?[]:Array.from(n.querySelectorAll(Zh)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}var Sp=(n=>(n[n.Strict=0]="Strict",n[n.Loose=1]="Loose",n))(Sp||{});function vb(n,e=0){var t;return n===((t=$r(n))==null?void 0:t.body)?!1:fn(e,{0(){return n.matches(Zh)},1(){let r=n;for(;r!==null;){if(r.matches(Zh))return!0;r=r.parentElement}return!1}})}var o3=(n=>(n[n.Keyboard=0]="Keyboard",n[n.Mouse=1]="Mouse",n))(o3||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",n=>{n.metaKey||n.altKey||n.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",n=>{n.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:n.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));let a3=["textarea","input"].join(",");function l3(n){var e,t;return(t=(e=n==null?void 0:n.matches)==null?void 0:e.call(n,a3))!=null?t:!1}function Pi(n,e=t=>t){return n.slice().sort((t,r)=>{let s=e(t),i=e(r);if(s===null||i===null)return 0;let o=s.compareDocumentPosition(i);return o&Node.DOCUMENT_POSITION_FOLLOWING?-1:o&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function cn(n,e,{sorted:t=!0,relativeTo:r=null,skipElements:s=[]}={}){var i;let o=(i=Array.isArray(n)?n.length>0?n[0].ownerDocument:document:n==null?void 0:n.ownerDocument)!=null?i:document,a=Array.isArray(n)?t?Pi(n):n:Yu(n);s.length>0&&a.length>1&&(a=a.filter(p=>!s.includes(p))),r=r!=null?r:o.activeElement;let l=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,a.indexOf(r))-1;if(e&4)return Math.max(0,a.indexOf(r))+1;if(e&8)return a.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=e&32?{preventScroll:!0}:{},d=0,h=a.length,f;do{if(d>=h||d+h<=0)return 0;let p=c+d;if(e&16)p=(p+h)%h;else{if(p<0)return 3;if(p>=h)return 1}f=a[p],f==null||f.focus(u),d+=l}while(f!==o.activeElement);return e&6&&l3(f)&&f.select(),2}function c3(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function u3(){return/Android/gi.test(window.navigator.userAgent)}function d3(){return c3()||u3()}function El(n,e,t){qu.isServer||It(r=>{document.addEventListener(n,e,t),r(()=>document.removeEventListener(n,e,t))})}function bb(n,e,t){qu.isServer||It(r=>{window.addEventListener(n,e,t),r(()=>window.removeEventListener(n,e,t))})}function h3(n,e,t=A(()=>!0)){function r(i,o){if(!t.value||i.defaultPrevented)return;let a=o(i);if(a===null||!a.getRootNode().contains(a))return;let l=function c(u){return typeof u=="function"?c(u()):Array.isArray(u)||u instanceof Set?u:[u]}(n);for(let c of l){if(c===null)continue;let u=c instanceof HTMLElement?c:ne(c);if(u!=null&&u.contains(a)||i.composed&&i.composedPath().includes(u))return}return!vb(a,Sp.Loose)&&a.tabIndex!==-1&&i.preventDefault(),e(i,a)}let s=$(null);El("pointerdown",i=>{var o,a;t.value&&(s.value=((a=(o=i.composedPath)==null?void 0:o.call(i))==null?void 0:a[0])||i.target)},!0),El("mousedown",i=>{var o,a;t.value&&(s.value=((a=(o=i.composedPath)==null?void 0:o.call(i))==null?void 0:a[0])||i.target)},!0),El("click",i=>{d3()||s.value&&(r(i,()=>s.value),s.value=null)},!0),El("touchend",i=>r(i,()=>i.target instanceof HTMLElement?i.target:null),!0),bb("blur",i=>r(i,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function cy(n,e){if(n)return n;let t=e!=null?e:"button";if(typeof t=="string"&&t.toLowerCase()==="button")return"button"}function wb(n,e){let t=$(cy(n.value.type,n.value.as));return Ve(()=>{t.value=cy(n.value.type,n.value.as)}),It(()=>{var r;t.value||ne(e)&&ne(e)instanceof HTMLButtonElement&&!((r=ne(e))!=null&&r.hasAttribute("type"))&&(t.value="button")}),t}var ci=(n=>(n[n.None=0]="None",n[n.RenderStrategy=1]="RenderStrategy",n[n.Static=2]="Static",n))(ci||{}),f3=(n=>(n[n.Unmount=0]="Unmount",n[n.Hidden=1]="Hidden",n))(f3||{});function Zt({visible:n=!0,features:e=0,ourProps:t,theirProps:r,...s}){var i;let o=kb(r,t),a=Object.assign(s,{props:o});if(n||e&2&&o.static)return Vd(a);if(e&1){let l=(i=o.unmount)==null||i?0:1;return fn(l,{0(){return null},1(){return Vd({...s,props:{...o,hidden:!0,style:{display:"none"}}})}})}return Vd(a)}function Vd({props:n,attrs:e,slots:t,slot:r,name:s}){var i,o;let{as:a,...l}=xb(n,["unmount","static"]),c=(i=t.default)==null?void 0:i.call(t,r),u={};if(r){let d=!1,h=[];for(let[f,p]of Object.entries(r))typeof p=="boolean"&&(d=!0),p===!0&&h.push(f);d&&(u["data-headlessui-state"]=h.join(" "))}if(a==="template"){if(c=_b(c!=null?c:[]),Object.keys(l).length>0||Object.keys(e).length>0){let[d,...h]=c!=null?c:[];if(!p3(d)||h.length>0)throw new Error(['Passing props on "template"!',"","The current component <".concat(s,' /> is rendering a "template".'),"However we need to passthrough the following props:",Object.keys(l).concat(Object.keys(e)).map(m=>m.trim()).filter((m,g,b)=>b.indexOf(m)===g).sort((m,g)=>m.localeCompare(g)).map(m=>"  - ".concat(m)).join("\n"),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "template".',"Render a single element as the child so that we can forward the props onto that element."].map(m=>"  - ".concat(m)).join("\n")].join("\n"));let f=kb((o=d.props)!=null?o:{},l,u),p=F2(d,f,!0);for(let m in f)m.startsWith("on")&&(p.props||(p.props={}),p.props[m]=f[m]);return p}return Array.isArray(c)&&c.length===1?c[0]:c}return wt(a,Object.assign({},l,u),{default:()=>c})}function _b(n){return n.flatMap(e=>e.type===J?_b(e.children):[e])}function kb(...n){if(n.length===0)return{};if(n.length===1)return n[0];let e={},t={};for(let r of n)for(let s in r)s.startsWith("on")&&typeof r[s]=="function"?(t[s]!=null||(t[s]=[]),t[s].push(r[s])):e[s]=r[s];if(e.disabled||e["aria-disabled"])return Object.assign(e,Object.fromEntries(Object.keys(t).map(r=>[r,void 0])));for(let r in t)Object.assign(e,{[r](s,...i){let o=t[r];for(let a of o){if(s instanceof Event&&s.defaultPrevented)return;a(s,...i)}}});return e}function xb(n,e=[]){let t=Object.assign({},n);for(let r of e)r in t&&delete t[r];return t}function p3(n){return n==null?!1:typeof n.type=="string"||typeof n.type=="object"||typeof n.type=="function"}var ui=(n=>(n[n.None=1]="None",n[n.Focusable=2]="Focusable",n[n.Hidden=4]="Hidden",n))(ui||{});let di=B({name:"Hidden",props:{as:{type:[Object,String],default:"div"},features:{type:Number,default:1}},setup(n,{slots:e,attrs:t}){return()=>{var r;let{features:s,...i}=n,o={"aria-hidden":(s&2)===2?!0:(r=i["aria-hidden"])!=null?r:void 0,hidden:(s&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(s&4)===4&&(s&2)!==2&&{display:"none"}}};return Zt({ourProps:o,theirProps:i,slot:{},attrs:t,slots:e,name:"Hidden"})}}}),Cb=Symbol("Context");var hi=(n=>(n[n.Open=1]="Open",n[n.Closed=2]="Closed",n[n.Closing=4]="Closing",n[n.Opening=8]="Opening",n))(hi||{});function Sb(){return ct(Cb,null)}function m3(n){xt(Cb,n)}var St=(n=>(n.Space=" ",n.Enter="Enter",n.Escape="Escape",n.Backspace="Backspace",n.Delete="Delete",n.ArrowLeft="ArrowLeft",n.ArrowUp="ArrowUp",n.ArrowRight="ArrowRight",n.ArrowDown="ArrowDown",n.Home="Home",n.End="End",n.PageUp="PageUp",n.PageDown="PageDown",n.Tab="Tab",n))(St||{});function g3(n,e,t,r){qu.isServer||It(s=>{n=n!=null?n:window,n.addEventListener(e,t,r),s(()=>n.removeEventListener(e,t,r))})}var kr=(n=>(n[n.Forwards=0]="Forwards",n[n.Backwards=1]="Backwards",n))(kr||{});function Mb(){let n=$(0);return bb("keydown",e=>{e.key==="Tab"&&(n.value=e.shiftKey?1:0)}),n}function y3({defaultContainers:n=[],portals:e,mainTreeNodeRef:t}={}){let r=$(null),s=$r(r);function i(){var o,a,l;let c=[];for(let u of n)u!==null&&(u instanceof HTMLElement?c.push(u):"value"in u&&u.value instanceof HTMLElement&&c.push(u.value));if(e!=null&&e.value)for(let u of e.value)c.push(u);for(let u of(o=s==null?void 0:s.querySelectorAll("html > *, body > *"))!=null?o:[])u!==document.body&&u!==document.head&&u instanceof HTMLElement&&u.id!=="headlessui-portal-root"&&(u.contains(ne(r))||u.contains((l=(a=ne(r))==null?void 0:a.getRootNode())==null?void 0:l.host)||c.some(d=>u.contains(d))||c.push(u));return c}return{resolveContainers:i,contains(o){return i().some(a=>a.contains(o))},mainTreeNodeRef:r,MainTreeNode(){return t!=null?null:wt(di,{features:ui.Hidden,ref:r})}}}function v3(){let n=$(null);return{mainTreeNodeRef:n,MainTreeNode(){return wt(di,{features:ui.Hidden,ref:n})}}}let Tb=Symbol("ForcePortalRootContext");function b3(){return ct(Tb,!1)}B({name:"ForcePortalRoot",props:{as:{type:[Object,String],default:"template"},force:{type:Boolean,default:!1}},setup(n,{slots:e,attrs:t}){return xt(Tb,n.force),()=>{let{force:r,...s}=n;return Zt({theirProps:s,ourProps:{},slot:{},slots:e,attrs:t,name:"ForcePortalRoot"})}}});function w3(n){let e=$r(n);if(!e){if(n===null)return null;throw new Error("[Headless UI]: Cannot find ownerDocument for contextElement: ".concat(n))}let t=e.getElementById("headlessui-portal-root");if(t)return t;let r=e.createElement("div");return r.setAttribute("id","headlessui-portal-root"),e.body.appendChild(r)}const ef=new WeakMap;function _3(n){var e;return(e=ef.get(n))!=null?e:0}function uy(n,e){let t=e(_3(n));return t<=0?ef.delete(n):ef.set(n,t),t}B({name:"Portal",props:{as:{type:[Object,String],default:"div"}},setup(n,{slots:e,attrs:t}){let r=$(null),s=A(()=>$r(r)),i=b3(),o=ct(Ob,null),a=$(i===!0||o==null?w3(r.value):o.resolveTarget());a.value&&uy(a.value,h=>h+1);let l=$(!1);Ve(()=>{l.value=!0}),It(()=>{i||o!=null&&(a.value=o.resolveTarget())});let c=ct(tf,null),u=!1,d=yo();return et(r,()=>{if(u||!c)return;let h=ne(r);h&&(Nn(c.register(h),d),u=!0)}),Nn(()=>{var h,f;let p=(h=s.value)==null?void 0:h.getElementById("headlessui-portal-root");!p||a.value!==p||uy(a.value,m=>m-1)||a.value.children.length>0||(f=a.value.parentElement)==null||f.removeChild(a.value)}),()=>{if(!l.value||a.value===null)return null;let h={ref:r,"data-headlessui-portal":""};return wt(ws,{to:a.value},Zt({ourProps:h,theirProps:n,slot:{},attrs:t,slots:e,name:"Portal"}))}}});let tf=Symbol("PortalParentContext");function k3(){let n=ct(tf,null),e=$([]);function t(i){return e.value.push(i),n&&n.register(i),()=>r(i)}function r(i){let o=e.value.indexOf(i);o!==-1&&e.value.splice(o,1),n&&n.unregister(i)}let s={register:t,unregister:r,portals:e};return[e,B({name:"PortalWrapper",setup(i,{slots:o}){return xt(tf,s),()=>{var a;return(a=o.default)==null?void 0:a.call(o)}}})]}let Ob=Symbol("PortalGroupContext");B({name:"PortalGroup",props:{as:{type:[Object,String],default:"template"},target:{type:Object,default:null}},setup(n,{attrs:e,slots:t}){let r=ki({resolveTarget(){return n.target}});return xt(Ob,r),()=>{let{target:s,...i}=n;return Zt({theirProps:i,ourProps:{},slot:{},attrs:e,slots:t,name:"PortalGroup"})}}});var x3=(n=>(n[n.Open=0]="Open",n[n.Closed=1]="Closed",n))(x3||{});let Db=Symbol("PopoverContext");function Ku(n){let e=ct(Db,null);if(e===null){let t=new Error("<".concat(n," /> is missing a parent <").concat(Pb.name," /> component."));throw Error.captureStackTrace&&Error.captureStackTrace(t,Ku),t}return e}let $b=Symbol("PopoverGroupContext");function Eb(){return ct($b,null)}let Ab=Symbol("PopoverPanelContext");function C3(){return ct(Ab,null)}let Pb=B({name:"Popover",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"}},setup(n,{slots:e,attrs:t,expose:r}){var s;let i=$(null);r({el:i,$el:i});let o=$(1),a=$(null),l=$(null),c=$(null),u=$(null),d=A(()=>$r(i)),h=A(()=>{var C,x;if(!ne(a)||!ne(u))return!1;for(let _e of document.querySelectorAll("body > *"))if(Number(_e==null?void 0:_e.contains(ne(a)))^Number(_e==null?void 0:_e.contains(ne(u))))return!0;let D=Yu(),O=D.indexOf(ne(a)),E=(O+D.length-1)%D.length,R=(O+1)%D.length,W=D[E],K=D[R];return!((C=ne(u))!=null&&C.contains(W))&&!((x=ne(u))!=null&&x.contains(K))}),f={popoverState:o,buttonId:$(null),panelId:$(null),panel:u,button:a,isPortalled:h,beforePanelSentinel:l,afterPanelSentinel:c,togglePopover(){o.value=fn(o.value,{0:1,1:0})},closePopover(){o.value!==1&&(o.value=1)},close(C){f.closePopover();let x=(()=>C?C instanceof HTMLElement?C:C.value instanceof HTMLElement?ne(C):ne(f.button):ne(f.button))();x==null||x.focus()}};xt(Db,f),m3(A(()=>fn(o.value,{0:hi.Open,1:hi.Closed})));let p={buttonId:f.buttonId,panelId:f.panelId,close(){f.closePopover()}},m=Eb(),g=m==null?void 0:m.registerPopover,[b,_]=k3(),M=y3({mainTreeNodeRef:m==null?void 0:m.mainTreeNodeRef,portals:b,defaultContainers:[a,u]});function k(){var C,x,D,O;return(O=m==null?void 0:m.isFocusWithinPopoverGroup())!=null?O:((C=d.value)==null?void 0:C.activeElement)&&(((x=ne(a))==null?void 0:x.contains(d.value.activeElement))||((D=ne(u))==null?void 0:D.contains(d.value.activeElement)))}return It(()=>g==null?void 0:g(p)),g3((s=d.value)==null?void 0:s.defaultView,"focus",C=>{var x,D;C.target!==window&&C.target instanceof HTMLElement&&o.value===0&&(k()||a&&u&&(M.contains(C.target)||(x=ne(f.beforePanelSentinel))!=null&&x.contains(C.target)||(D=ne(f.afterPanelSentinel))!=null&&D.contains(C.target)||f.closePopover()))},!0),h3(M.resolveContainers,(C,x)=>{var D;f.closePopover(),vb(x,Sp.Loose)||(C.preventDefault(),(D=ne(a))==null||D.focus())},A(()=>o.value===0)),()=>{let C={open:o.value===0,close:f.close};return wt(J,[wt(_,{},()=>Zt({theirProps:{...n,...t},ourProps:{ref:i},slot:C,slots:e,attrs:t,name:"Popover"})),wt(M.MainTreeNode)])}}}),S3=B({name:"PopoverButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(n,{attrs:e,slots:t,expose:r}){var s;let i=(s=n.id)!=null?s:"headlessui-popover-button-".concat(is()),o=Ku("PopoverButton"),a=A(()=>$r(o.button));r({el:o.button,$el:o.button}),Ve(()=>{o.buttonId.value=i}),Nn(()=>{o.buttonId.value=null});let l=Eb(),c=l==null?void 0:l.closeOthers,u=C3(),d=A(()=>u===null?!1:u.value===o.panelId.value),h=$(null),f="headlessui-focus-sentinel-".concat(is());d.value||It(()=>{o.button.value=ne(h)});let p=wb(A(()=>({as:n.as,type:e.type})),h);function m(C){var x,D,O,E,R;if(d.value){if(o.popoverState.value===1)return;switch(C.key){case St.Space:case St.Enter:C.preventDefault(),(D=(x=C.target).click)==null||D.call(x),o.closePopover(),(O=ne(o.button))==null||O.focus();break}}else switch(C.key){case St.Space:case St.Enter:C.preventDefault(),C.stopPropagation(),o.popoverState.value===1&&(c==null||c(o.buttonId.value)),o.togglePopover();break;case St.Escape:if(o.popoverState.value!==0)return c==null?void 0:c(o.buttonId.value);if(!ne(o.button)||(E=a.value)!=null&&E.activeElement&&!((R=ne(o.button))!=null&&R.contains(a.value.activeElement)))return;C.preventDefault(),C.stopPropagation(),o.closePopover();break}}function g(C){d.value||C.key===St.Space&&C.preventDefault()}function b(C){var x,D;n.disabled||(d.value?(o.closePopover(),(x=ne(o.button))==null||x.focus()):(C.preventDefault(),C.stopPropagation(),o.popoverState.value===1&&(c==null||c(o.buttonId.value)),o.togglePopover(),(D=ne(o.button))==null||D.focus()))}function _(C){C.preventDefault(),C.stopPropagation()}let M=Mb();function k(){let C=ne(o.panel);if(!C)return;function x(){fn(M.value,{[kr.Forwards]:()=>cn(C,_t.First),[kr.Backwards]:()=>cn(C,_t.Last)})===Qr.Error&&cn(Yu().filter(D=>D.dataset.headlessuiFocusGuard!=="true"),fn(M.value,{[kr.Forwards]:_t.Next,[kr.Backwards]:_t.Previous}),{relativeTo:ne(o.button)})}x()}return()=>{let C=o.popoverState.value===0,x={open:C},{...D}=n,O=d.value?{ref:h,type:p.value,onKeydown:m,onClick:b}:{ref:h,id:i,type:p.value,"aria-expanded":o.popoverState.value===0,"aria-controls":ne(o.panel)?o.panelId.value:void 0,disabled:n.disabled?!0:void 0,onKeydown:m,onKeyup:g,onClick:b,onMousedown:_};return wt(J,[Zt({ourProps:O,theirProps:{...e,...D},slot:x,attrs:e,slots:t,name:"PopoverButton"}),C&&!d.value&&o.isPortalled.value&&wt(di,{id:f,features:ui.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:k})])}}});B({name:"PopoverOverlay",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0}},setup(n,{attrs:e,slots:t}){let r=Ku("PopoverOverlay"),s="headlessui-popover-overlay-".concat(is()),i=Sb(),o=A(()=>i!==null?(i.value&hi.Open)===hi.Open:r.popoverState.value===0);function a(){r.closePopover()}return()=>{let l={open:r.popoverState.value===0};return Zt({ourProps:{id:s,"aria-hidden":!0,onClick:a},theirProps:n,slot:l,attrs:e,slots:t,features:ci.RenderStrategy|ci.Static,visible:o.value,name:"PopoverOverlay"})}}});let M3=B({name:"PopoverPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},focus:{type:Boolean,default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(n,{attrs:e,slots:t,expose:r}){var s;let i=(s=n.id)!=null?s:"headlessui-popover-panel-".concat(is()),{focus:o}=n,a=Ku("PopoverPanel"),l=A(()=>$r(a.panel)),c="headlessui-focus-sentinel-before-".concat(is()),u="headlessui-focus-sentinel-after-".concat(is());r({el:a.panel,$el:a.panel}),Ve(()=>{a.panelId.value=i}),Nn(()=>{a.panelId.value=null}),xt(Ab,a.panelId),It(()=>{var _,M;if(!o||a.popoverState.value!==0||!a.panel)return;let k=(_=l.value)==null?void 0:_.activeElement;(M=ne(a.panel))!=null&&M.contains(k)||cn(ne(a.panel),_t.First)});let d=Sb(),h=A(()=>d!==null?(d.value&hi.Open)===hi.Open:a.popoverState.value===0);function f(_){var M,k;switch(_.key){case St.Escape:if(a.popoverState.value!==0||!ne(a.panel)||l.value&&!((M=ne(a.panel))!=null&&M.contains(l.value.activeElement)))return;_.preventDefault(),_.stopPropagation(),a.closePopover(),(k=ne(a.button))==null||k.focus();break}}function p(_){var M,k,C,x,D;let O=_.relatedTarget;O&&ne(a.panel)&&((M=ne(a.panel))!=null&&M.contains(O)||(a.closePopover(),((C=(k=ne(a.beforePanelSentinel))==null?void 0:k.contains)!=null&&C.call(k,O)||(D=(x=ne(a.afterPanelSentinel))==null?void 0:x.contains)!=null&&D.call(x,O))&&O.focus({preventScroll:!0})))}let m=Mb();function g(){let _=ne(a.panel);if(!_)return;function M(){fn(m.value,{[kr.Forwards]:()=>{var k;cn(_,_t.First)===Qr.Error&&((k=ne(a.afterPanelSentinel))==null||k.focus())},[kr.Backwards]:()=>{var k;(k=ne(a.button))==null||k.focus({preventScroll:!0})}})}M()}function b(){let _=ne(a.panel);if(!_)return;function M(){fn(m.value,{[kr.Forwards]:()=>{let k=ne(a.button),C=ne(a.panel);if(!k)return;let x=Yu(),D=x.indexOf(k),O=x.slice(0,D+1),E=[...x.slice(D+1),...O];for(let R of E.slice())if(R.dataset.headlessuiFocusGuard==="true"||C!=null&&C.contains(R)){let W=E.indexOf(R);W!==-1&&E.splice(W,1)}cn(E,_t.First,{sorted:!1})},[kr.Backwards]:()=>{var k;cn(_,_t.Previous)===Qr.Error&&((k=ne(a.button))==null||k.focus())}})}M()}return()=>{let _={open:a.popoverState.value===0,close:a.close},{focus:M,...k}=n,C={ref:a.panel,id:i,onKeydown:f,onFocusout:o&&a.popoverState.value===0?p:void 0,tabIndex:-1};return Zt({ourProps:C,theirProps:{...e,...k},attrs:e,slot:_,slots:{...t,default:(...x)=>{var D;return[wt(J,[h.value&&a.isPortalled.value&&wt(di,{id:c,ref:a.beforePanelSentinel,features:ui.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:g}),(D=t.default)==null?void 0:D.call(t,...x),h.value&&a.isPortalled.value&&wt(di,{id:u,ref:a.afterPanelSentinel,features:ui.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:b})])]}},features:ci.RenderStrategy|ci.Static,visible:h.value,name:"PopoverPanel"})}}});B({name:"PopoverGroup",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"}},setup(n,{attrs:e,slots:t,expose:r}){let s=$(null),i=Xr([]),o=A(()=>$r(s)),a=v3();r({el:s,$el:s});function l(h){let f=i.value.indexOf(h);f!==-1&&i.value.splice(f,1)}function c(h){return i.value.push(h),()=>{l(h)}}function u(){var h;let f=o.value;if(!f)return!1;let p=f.activeElement;return(h=ne(s))!=null&&h.contains(p)?!0:i.value.some(m=>{var g,b;return((g=f.getElementById(m.buttonId.value))==null?void 0:g.contains(p))||((b=f.getElementById(m.panelId.value))==null?void 0:b.contains(p))})}function d(h){for(let f of i.value)f.buttonId.value!==h&&f.close()}return xt($b,{registerPopover:c,unregisterPopover:l,isFocusWithinPopoverGroup:u,closeOthers:d,mainTreeNodeRef:a.mainTreeNodeRef}),()=>wt(J,[Zt({ourProps:{ref:s},theirProps:{...n,...e},slot:{},attrs:e,slots:t,name:"PopoverGroup"}),wt(a.MainTreeNode)])}});let T3=B({props:{onFocus:{type:Function,required:!0}},setup(n){let e=$(!0);return()=>e.value?wt(di,{as:"button",type:"button",features:ui.Focusable,onFocus(t){t.preventDefault();let r,s=50;function i(){var o;if(s--<=0){r&&cancelAnimationFrame(r);return}if((o=n.onFocus)!=null&&o.call(n)){e.value=!1,cancelAnimationFrame(r);return}r=requestAnimationFrame(i)}r=requestAnimationFrame(i)}}):null}});var O3=(n=>(n[n.Forwards=0]="Forwards",n[n.Backwards=1]="Backwards",n))(O3||{}),D3=(n=>(n[n.Less=-1]="Less",n[n.Equal=0]="Equal",n[n.Greater=1]="Greater",n))(D3||{});let Rb=Symbol("TabsContext");function ol(n){let e=ct(Rb,null);if(e===null){let t=new Error("<".concat(n," /> is missing a parent <TabGroup /> component."));throw Error.captureStackTrace&&Error.captureStackTrace(t,ol),t}return e}let Mp=Symbol("TabsSSRContext"),$3=B({name:"TabGroup",emits:{change:n=>!0},props:{as:{type:[Object,String],default:"template"},selectedIndex:{type:[Number],default:null},defaultIndex:{type:[Number],default:0},vertical:{type:[Boolean],default:!1},manual:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(n,{slots:e,attrs:t,emit:r}){var s;let i=$((s=n.selectedIndex)!=null?s:n.defaultIndex),o=$([]),a=$([]),l=A(()=>n.selectedIndex!==null),c=A(()=>l.value?n.selectedIndex:i.value);function u(m){var g;let b=Pi(d.tabs.value,ne),_=Pi(d.panels.value,ne),M=b.filter(k=>{var C;return!((C=ne(k))!=null&&C.hasAttribute("disabled"))});if(m<0||m>b.length-1){let k=fn(i.value===null?0:Math.sign(m-i.value),{[-1]:()=>1,0:()=>fn(Math.sign(m),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0}),C=fn(k,{0:()=>b.indexOf(M[0]),1:()=>b.indexOf(M[M.length-1])});C!==-1&&(i.value=C),d.tabs.value=b,d.panels.value=_}else{let k=b.slice(0,m),C=[...b.slice(m),...k].find(D=>M.includes(D));if(!C)return;let x=(g=b.indexOf(C))!=null?g:d.selectedIndex.value;x===-1&&(x=d.selectedIndex.value),i.value=x,d.tabs.value=b,d.panels.value=_}}let d={selectedIndex:A(()=>{var m,g;return(g=(m=i.value)!=null?m:n.defaultIndex)!=null?g:null}),orientation:A(()=>n.vertical?"vertical":"horizontal"),activation:A(()=>n.manual?"manual":"auto"),tabs:o,panels:a,setSelectedIndex(m){c.value!==m&&r("change",m),l.value||u(m)},registerTab(m){var g;if(o.value.includes(m))return;let b=o.value[i.value];if(o.value.push(m),o.value=Pi(o.value,ne),!l.value){let _=(g=o.value.indexOf(b))!=null?g:i.value;_!==-1&&(i.value=_)}},unregisterTab(m){let g=o.value.indexOf(m);g!==-1&&o.value.splice(g,1)},registerPanel(m){a.value.includes(m)||(a.value.push(m),a.value=Pi(a.value,ne))},unregisterPanel(m){let g=a.value.indexOf(m);g!==-1&&a.value.splice(g,1)}};xt(Rb,d);let h=$({tabs:[],panels:[]}),f=$(!1);Ve(()=>{f.value=!0}),xt(Mp,A(()=>f.value?null:h.value));let p=A(()=>n.selectedIndex);return Ve(()=>{et([p],()=>{var m;return u((m=n.selectedIndex)!=null?m:n.defaultIndex)},{immediate:!0})}),It(()=>{if(!l.value||c.value==null||d.tabs.value.length<=0)return;let m=Pi(d.tabs.value,ne);m.some((g,b)=>ne(d.tabs.value[b])!==ne(g))&&d.setSelectedIndex(m.findIndex(g=>ne(g)===ne(d.tabs.value[c.value])))}),()=>{let m={selectedIndex:i.value};return wt(J,[o.value.length<=0&&wt(T3,{onFocus:()=>{for(let g of o.value){let b=ne(g);if((b==null?void 0:b.tabIndex)===0)return b.focus(),!0}return!1}}),Zt({theirProps:{...t,...xb(n,["selectedIndex","defaultIndex","manual","vertical","onChange"])},ourProps:{},slot:m,slots:e,attrs:t,name:"TabGroup"})])}}}),E3=B({name:"TabList",props:{as:{type:[Object,String],default:"div"}},setup(n,{attrs:e,slots:t}){let r=ol("TabList");return()=>{let s={selectedIndex:r.selectedIndex.value},i={role:"tablist","aria-orientation":r.orientation.value};return Zt({ourProps:i,theirProps:n,slot:s,attrs:e,slots:t,name:"TabList"})}}}),A3=B({name:"Tab",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},setup(n,{attrs:e,slots:t,expose:r}){var s;let i=(s=n.id)!=null?s:"headlessui-tabs-tab-".concat(is()),o=ol("Tab"),a=$(null);r({el:a,$el:a}),Ve(()=>o.registerTab(a)),Nn(()=>o.unregisterTab(a));let l=ct(Mp),c=A(()=>{if(l.value){let _=l.value.tabs.indexOf(i);return _===-1?l.value.tabs.push(i)-1:_}return-1}),u=A(()=>{let _=o.tabs.value.indexOf(a);return _===-1?c.value:_}),d=A(()=>u.value===o.selectedIndex.value);function h(_){var M;let k=_();if(k===Qr.Success&&o.activation.value==="auto"){let C=(M=$r(a))==null?void 0:M.activeElement,x=o.tabs.value.findIndex(D=>ne(D)===C);x!==-1&&o.setSelectedIndex(x)}return k}function f(_){let M=o.tabs.value.map(k=>ne(k)).filter(Boolean);if(_.key===St.Space||_.key===St.Enter){_.preventDefault(),_.stopPropagation(),o.setSelectedIndex(u.value);return}switch(_.key){case St.Home:case St.PageUp:return _.preventDefault(),_.stopPropagation(),h(()=>cn(M,_t.First));case St.End:case St.PageDown:return _.preventDefault(),_.stopPropagation(),h(()=>cn(M,_t.Last))}if(h(()=>fn(o.orientation.value,{vertical(){return _.key===St.ArrowUp?cn(M,_t.Previous|_t.WrapAround):_.key===St.ArrowDown?cn(M,_t.Next|_t.WrapAround):Qr.Error},horizontal(){return _.key===St.ArrowLeft?cn(M,_t.Previous|_t.WrapAround):_.key===St.ArrowRight?cn(M,_t.Next|_t.WrapAround):Qr.Error}}))===Qr.Success)return _.preventDefault()}let p=$(!1);function m(){var _;p.value||(p.value=!0,!n.disabled&&((_=ne(a))==null||_.focus({preventScroll:!0}),o.setSelectedIndex(u.value),ZS(()=>{p.value=!1})))}function g(_){_.preventDefault()}let b=wb(A(()=>({as:n.as,type:e.type})),a);return()=>{var _,M;let k={selected:d.value,disabled:(_=n.disabled)!=null?_:!1},{...C}=n,x={ref:a,onKeydown:f,onMousedown:g,onClick:m,id:i,role:"tab",type:b.value,"aria-controls":(M=ne(o.panels.value[u.value]))==null?void 0:M.id,"aria-selected":d.value,tabIndex:d.value?0:-1,disabled:n.disabled?!0:void 0};return Zt({ourProps:x,theirProps:C,slot:k,attrs:e,slots:t,name:"Tab"})}}}),P3=B({name:"TabPanels",props:{as:{type:[Object,String],default:"div"}},setup(n,{slots:e,attrs:t}){let r=ol("TabPanels");return()=>{let s={selectedIndex:r.selectedIndex.value};return Zt({theirProps:n,ourProps:{},slot:s,attrs:t,slots:e,name:"TabPanels"})}}}),R3=B({name:"TabPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null},tabIndex:{type:Number,default:0}},setup(n,{attrs:e,slots:t,expose:r}){var s;let i=(s=n.id)!=null?s:"headlessui-tabs-panel-".concat(is()),o=ol("TabPanel"),a=$(null);r({el:a,$el:a}),Ve(()=>o.registerPanel(a)),Nn(()=>o.unregisterPanel(a));let l=ct(Mp),c=A(()=>{if(l.value){let h=l.value.panels.indexOf(i);return h===-1?l.value.panels.push(i)-1:h}return-1}),u=A(()=>{let h=o.panels.value.indexOf(a);return h===-1?c.value:h}),d=A(()=>u.value===o.selectedIndex.value);return()=>{var h;let f={selected:d.value},{tabIndex:p,...m}=n,g={ref:a,id:i,role:"tabpanel","aria-labelledby":(h=ne(o.tabs.value[u.value]))==null?void 0:h.id,tabIndex:d.value?p:-1};return!d.value&&n.unmount&&!n.static?wt(di,{as:"span","aria-hidden":!0,...g}):Zt({ourProps:g,theirProps:m,slot:f,attrs:e,slots:t,features:ci.Static|ci.RenderStrategy,visible:d.value,name:"TabPanel"})}}});const N3=B({__name:"ToggletipButton",props:{size:{default:"xs"},icon:{default:"fr-icon-information-line"}},setup(n){const e=n,t=A(()=>e.size==="md"?"":e.size==="xs"?"fr-btn--".concat(e.size," fr-icon--sm"):"fr-btn--".concat(e.size));return(r,s)=>(w(),S("button",{class:ue("fr-btn fr-btn--tertiary-no-outline text-grey-380 fr-btn--darker-hover align-middle ".concat(t.value," ").concat(r.icon))},null,2))}}),I3=B({inheritAttrs:!1,__name:"Toggletip",props:{noMargin:{type:Boolean,default:!1},position:{default:"left"}},setup(n){return(e,t)=>(w(),Y(y(Pb),{class:"relative text-grey-500",focus:!0},{default:q(()=>[P(y(S3),rr(e.$attrs,{ref:"button",as:N3}),{default:q(()=>[Ye(e.$slots,"default",{},void 0,!0)]),_:3},16),P(y(M3),{class:ue(["toggletip",{"fr-p-0":e.noMargin,"left-0":e.position==="right"}]),ref:"toggletip"},{default:q(({close:r})=>[Ye(e.$slots,"toggletip",{close:r},void 0,!0)]),_:3},8,["class"])]),_:3}))}}),Tp=$e(I3,[["__scopeId","data-v-3bf812ef"]]),L3={class:"fr-m-0 fr-grid-row fr-grid-row--middle fr-text--sm text-mention-grey"},z3={class:"fr-grid-row fr-grid-row--middle"},B3={class:"fr-text--sm fr-my-0"},F3={class:"list-style-none fr-m-0 fr-p-0"},V3={class:"fr-grid-row fr-grid-row--right not-enlarged"},H3=["href","title"],W3={class:"fr-my-0 fr-mr-1v text-mention-grey fr-text--sm"},j3={class:"fr-grid-row fr-grid-row--middle fr-mr-1v"},U3=B({__name:"QualityComponentInline",props:{quality:{}},setup(n){return(e,t)=>(w(),S("div",L3,[v("div",z3,[P(y(Tp),{class:"relative z-2"},{toggletip:q(()=>[v("h5",B3,T(e.$t("Metadata quality:")),1),v("ul",F3,[P(y(Rr),{passed:e.quality.dataset_description_quality,messagePassed:e.$t("Data description filled"),messageFailed:e.$t("Data description empty"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),P(y(Rr),{passed:e.quality.resources_documentation,messagePassed:e.$t("Files documented"),messageFailed:e.$t("Files documentation missing"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),P(y(Rr),{passed:e.quality.license,messagePassed:e.$t("License filled"),messageFailed:e.$t("No license set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),P(y(Rr),{passed:e.quality.update_frequency&&!!e.quality.update_fulfilled_in_time,messagePassed:e.$t("Update frequency followed"),messageFailed:e.quality.update_frequency?e.$t("Update frequency not followed"):e.$t("Update frequency not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),P(y(Rr),{passed:e.quality.has_open_format,messagePassed:e.$t("File formats are open"),messageFailed:e.$t("File formats are closed"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),P(y(Rr),{passed:e.quality.temporal_coverage,messagePassed:e.$t("Temporal coverage filled"),messageFailed:e.$t("Temporal coverage not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),P(y(Rr),{passed:e.quality.spatial,messagePassed:e.$t("Spatial coverage filled"),messageFailed:e.$t("Spatial coverage not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),P(y(Rr),{passed:e.quality.all_resources_available,messagePassed:e.$t("All files are available"),messageFailed:e.$t("Some files are unavailable"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"])]),v("div",V3,[v("a",{href:y(vt).guides_quality_url,target:"_blank",rel:"noopener",title:e.$t("Learn more about this indicator - opens a new window")},T(e.$t("Learn more about this indicator")),9,H3)])]),_:1}),v("p",W3,T(e.$t("Metadata :")),1),v("div",j3,[P(y(JS),{score:e.quality.score},null,8,["score"])])])]))}});function q3(n){const e=$(!1);function t(){e.value=!e.value;const r=document.getElementById(n);r&&cb(r,e.value)}return{expanded:e,expand:t}}const Y3=Z2({duration:!1,dismissible:!0});function K3(){return{toast:Y3}}function Gu(n){return A(()=>{const t=at(n);if(t)return t.organization?t.organization.name:t.owner.first_name+" "+t.owner.last_name})}const G3={class:"fr-my-2w fr-p-2w border border-default-grey fr-enlarge-link"},J3={key:0,class:"absolute top-0 fr-grid-row fr-grid-row--middle fr-mt-n3v fr-ml-n1v"},X3={key:0,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},Q3={key:1,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},Z3={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--top"},eM={class:"fr-col-auto"},tM={class:"logo"},nM={class:"fr-col-12 fr-col-sm"},rM={class:"fr-text--md fr-mb-0 fr-grid-row"},sM={key:0,class:"fr-col-auto fr-ml-1w"},iM={key:0,class:"fr-text--sm fr-m-0 inline-flex"},oM={key:0,class:"not-enlarged fr-mr-1v"},aM={class:"text-mention-grey dash-before-sm whitespace-nowrap"},lM={class:"fr-mx-0 fr-mb-n1v fr-grid-row fr-grid-row--middle fr-text--sm text-mention-grey"},cM={class:"fr-hidden flex-sm dash-after-sm text-grey-500"},uM={class:"fr-grid-row fr-grid-row--middle fr-mr-1v"},dM=["aria-label"],hM=["aria-label"],fM=["aria-label"],pM=B({__name:"DatasetCard",props:{dataset:{},datasetUrl:{},organizationUrl:{},showDescription:{type:Boolean,default:!0}},setup(n){const e=n,{t}=Te(),r=Gu(e.dataset);return(s,i)=>(w(),S("div",G3,[s.dataset.private||s.dataset.archived?(w(),S("div",J3,[s.dataset.private?(w(),S("p",X3,[i[0]||(i[0]=v("span",{class:"fr-icon-lock-line fr-icon--sm","aria-hidden":"true"},null,-1)),U(" "+T(y(t)("Draft")),1)])):I("",!0),s.dataset.archived?(w(),S("p",Q3,[i[1]||(i[1]=v("span",{class:"fr-icon-archive-line fr-icon--sm","aria-hidden":"true"},null,-1)),U(" "+T(y(t)("Archived")),1)])):I("",!0)])):I("",!0),v("div",Z3,[v("div",eM,[v("div",tM,[s.dataset.organization?(w(),Y(y(Qh),{key:0,type:"dataset",src:s.dataset.organization.logo_thumbnail,alt:"",size:40},null,8,["src"])):s.dataset.owner?(w(),Y(Q0,{key:1,user:s.dataset.owner,size:40},null,8,["user"])):(w(),Y(y(Qh),{key:2,type:"dataset",size:40}))])]),v("div",nM,[v("h4",rM,[Ye(s.$slots,"datasetUrl",{dataset:s.dataset,datasetUrl:s.datasetUrl},()=>[P(no,{to:s.datasetUrl,class:"text-grey-500 fr-grid-row"},{default:q(()=>[P(y(Xt),{class:"fr-col","auto-resize":!0,text:s.dataset.title,"max-lines":1},null,8,["text"]),s.dataset.acronym?(w(),S("small",sM,T(s.dataset.acronym),1)):I("",!0)]),_:1},8,["to"])])]),s.dataset.organization||s.dataset.owner?(w(),S("div",iM,[s.dataset.organization?(w(),S("span",oM,[s.organizationUrl?(w(),Y(no,{key:0,class:"fr-link fr-text--sm inline-flex items-center",to:s.organizationUrl},{default:q(()=>[P(li,{organization:s.dataset.organization},null,8,["organization"])]),_:1},8,["to"])):(w(),Y(li,{key:1,organization:s.dataset.organization},null,8,["organization"]))])):(w(),Y(y(Xt),{key:1,class:"not-enlarged fr-mr-1v","auto-resize":!0,text:y(r),"max-lines":1},null,8,["text"])),v("span",aM,T(s.$t("Updated {date}",{date:y(Vu)(s.dataset.last_update)})),1)])):I("",!0),v("div",lM,[v("div",cM,[P(y(U3),{quality:s.dataset.quality},null,8,["quality"])]),v("div",uM,[v("p",{class:"fr-text--sm fr-my-0","aria-label":y(t)("{n} resources downloads",s.dataset.metrics.resources_downloads)},[i[2]||(i[2]=v("span",{class:"fr-icon-download-line fr-icon--sm fr-px-1v","aria-hidden":"true"},null,-1)),U(T(y(Ki)(s.dataset.metrics.resources_downloads)),1)],8,dM),v("p",{class:"fr-text--sm fr-my-0","aria-label":y(t)("{n} followers",s.dataset.metrics.followers)},[i[3]||(i[3]=v("span",{class:"fr-icon-star-line fr-icon--sm fr-px-1v","aria-hidden":"true"},null,-1)),U(T(y(Ki)(s.dataset.metrics.followers)),1)],8,hM),v("p",{class:"fr-text--sm fr-my-0","aria-label":y(t)("{n} reuses",s.dataset.metrics.reuses)},[i[4]||(i[4]=v("span",{class:"fr-icon-line-chart-line fr-icon--sm fr-px-1v","aria-hidden":"true"},null,-1)),U(T(y(Ki)(s.dataset.metrics.reuses)),1)],8,fM)])]),s.showDescription?(w(),Y(W0,{key:1},{default:q(()=>[P(X0,{class:"fr-text--sm fr-mt-1w fr-mb-0 overflow-wrap-anywhere","auto-resize":!0,text:y(q0)(s.dataset.description),"max-lines":2},null,8,["text"])]),_:1})):I("",!0)])])]))}}),mM={key:0,class:"absolute top-0 fr-grid-row fr-grid-row--middle fr-mt-n3v fr-ml-n1v"},gM={key:0,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},yM={key:1,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},vM={key:2,class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380 fr-mr-1w"},bM={class:"fr-text--md fr-mb-0"},wM={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",class:"fr-mr-1v",style:{width:"1rem"}},_M={key:1,class:"fr-icon-terminal-line fr-icon--sm fr-mr-1v","aria-hidden":"true"},kM={key:1,class:"fr-text--sm text-mention-grey inline-flex fr-mt-1v fr-mb-0"},xM={key:0,class:"not-enlarged"},CM={class:"dash-before whitespace-nowrap"},SM={class:"fr-text--sm text-mention-grey fr-my-0 fr-mt-1v"},MM={class:"text-grey-400"},TM=B({__name:"DataserviceCard",props:{dataservice:{},dataserviceUrl:{},organizationUrl:{},showDescription:{type:Boolean,default:!0}},setup(n){const e=n,{t}=Te(),r=Gu(e.dataservice),s=A(()=>vt.tabular_api_dataservice_id===e.dataservice.id);return(i,o)=>(w(),S("article",{class:ue(["fr-my-2w fr-p-2w border fr-enlarge-link",{"border-tabular-api":s.value}]),style:vo(e.style)},[i.dataservice.access_type==="restricted"||i.dataservice.private||i.dataservice.archived_at?(w(),S("div",mM,[i.dataservice.access_type==="restricted"?(w(),S("p",gM,[o[0]||(o[0]=v("span",{class:"fr-icon-lock-line fr-icon--sm","aria-hidden":"true"},null,-1)),U(" "+T(y(t)("Restricted access")),1)])):I("",!0),i.dataservice.private?(w(),S("p",yM,[o[1]||(o[1]=v("span",{class:"fr-icon-lock-line fr-icon--sm","aria-hidden":"true"},null,-1)),U(" "+T(y(t)("Draft")),1)])):I("",!0),i.dataservice.archived_at?(w(),S("p",vM,[o[2]||(o[2]=v("span",{class:"fr-icon-lock-line fr-icon--sm","aria-hidden":"true"},null,-1)),U(" "+T(y(t)("Archived")),1)])):I("",!0)])):I("",!0),v("h4",bM,[Ye(i.$slots,"dataserviceUrl",{dataservice:i.dataservice,dataserviceUrl:i.dataserviceUrl},()=>[s.value?(w(),S("svg",wM,o[3]||(o[3]=[v("path",{d:"M17.0007 1.20825 18.3195 3.68108 20.7923 4.99992 18.3195 6.31876 17.0007 8.79159 15.6818 6.31876 13.209 4.99992 15.6818 3.68108 17.0007 1.20825ZM10.6673 9.33325 15.6673 11.9999 10.6673 14.6666 8.00065 19.6666 5.33398 14.6666.333984 11.9999 5.33398 9.33325 8.00065 4.33325 10.6673 9.33325ZM11.4173 11.9999 9.18905 10.8115 8.00065 8.58325 6.81224 10.8115 4.58398 11.9999 6.81224 13.1883 8.00065 15.4166 9.18905 13.1883 11.4173 11.9999ZM19.6673 16.3333 18.0007 13.2083 16.334 16.3333 13.209 17.9999 16.334 19.6666 18.0007 22.7916 19.6673 19.6666 22.7923 17.9999 19.6673 16.3333Z"},null,-1)]))):(w(),S("span",_M)),P(no,{class:"inline-flex",to:i.dataserviceUrl},{default:q(()=>[P(y(Xt),{"auto-resize":!0,text:i.dataservice.title,"max-lines":1},null,8,["text"])]),_:1},8,["to"])],!0)]),i.dataservice.organization||i.dataservice.owner?(w(),S("p",kM,[i.dataservice.organization?(w(),S("span",xM,[i.organizationUrl?(w(),Y(no,{key:0,class:"fr-link fr-text--sm",to:i.organizationUrl},{default:q(()=>[P(li,{organization:i.dataservice.organization},null,8,["organization"])]),_:1},8,["to"])):(w(),Y(li,{key:1,organization:i.dataservice.organization},null,8,["organization"]))])):(w(),Y(y(Xt),{key:1,class:"not-enlarged fr-mr-1v","auto-resize":!0,text:y(r),"max-lines":1},null,8,["text"])),v("span",CM,T(y(t)("Updated {date}",{date:y(Vu)(i.dataservice.metadata_modified_at)})),1)])):I("",!0),v("p",SM,[o[4]||(o[4]=v("span",{class:"fr-icon-information-line fr-icon--sm text-grey-380"},null,-1)),U(" "+T(y(t)("Availability :"))+" ",1),v("span",MM,[i.dataservice.availability?(w(),S(J,{key:0},[U(T(y(t)("{n}%",i.dataservice.availability)),1)],64)):(w(),S(J,{key:1},[U(T(y(t)("unknown")),1)],64))])]),i.showDescription?(w(),Y(W0,{key:2},{default:q(()=>[P(X0,{class:"fr-text--sm fr-mt-1w fr-mb-0 overflow-wrap-anywhere","auto-resize":!0,text:y(q0)(i.dataservice.description),"max-lines":2},null,8,["text"])]),_:1})):I("",!0)],6))}}),Nb=$e(TM,[["__scopeId","data-v-47254e37"]]),OM={class:"fr-grid-row fr-grid-row--middle fr-pb-3w fr-mb-3w border-bottom border-default-grey"},DM={class:"fr-col"},$M={class:"fr-col-auto"},EM=["aria-expanded","aria-controls"],AM=["id"],PM={class:"fr-pb-3w fr-mb-3w border-bottom border-default-grey"},RM={class:"fr-grid-row fr-grid-row--gutters fr-text--sm fr-m-0","data-testid":"extra-list"},NM={class:"subtitle fr-mb-1v"},IM={class:"fr-text--sm fr-m-0 text-mention-grey overflow-wrap-anywhere"},LM=B({__name:"ExtraAccordion",props:{buttonText:{},titleText:{},extra:{},titleLevel:{}},setup(n){const e=xi("accordion"),{expanded:t,expand:r}=q3(e);return(s,i)=>(w(),S("div",null,[v("header",OM,[v("div",DM,[(w(),Y(Js(s.titleLevel),{class:"subtitle subtitle--uppercase fr-m-0"},{default:q(()=>[U(T(s.titleText),1)]),_:1}))]),v("div",$M,[v("button",{onClick:i[0]||(i[0]=(...o)=>y(r)&&y(r)(...o)),role:"button","aria-expanded":y(t),"aria-controls":y(e),class:ue(["fr-btn fr-btn--tertiary-no-outline fr-btn--icon-left fr-btn--secondary-grey-500",{"fr-icon-arrow-up-s-line":y(t),"fr-icon-arrow-down-s-line":!y(t)}]),"data-testid":"button"},[y(t)?(w(),S(J,{key:0},[U(T(s.$t("Close details")),1)],64)):(w(),S(J,{key:1},[U(T(s.buttonText),1)],64))],10,EM)])]),v("div",{class:"accordion-content",id:y(e)},[v("div",PM,[v("div",RM,[(w(!0),S(J,null,Fe(s.extra,(o,a)=>(w(),S("div",{key:a,class:"fr-col-12 fr-col-sm-6 fr-col-md-4"},[v("h3",NM,T(a),1),v("p",IM,T(o),1)]))),128))])])],8,AM)]))}}),zM=B({__name:"OwnerType",props:{type:{},size:{default:"sm"},color:{default:"grey"}},setup(n){const e=n,t=A(()=>{switch(e.color){case"black":return"text-grey-500";case"grey":return"text-mention-grey"}}),r=A(()=>fb(e.type).label);return(s,i)=>(w(),S("p",{class:ue("".concat(t.value," fr-text--").concat(s.size," fr-my-0"))},[P(Cp,{type:s.type},null,8,["type"]),U(" "+T(r.value),1)],2))}}),tc=3;function Ib(n,e=1){return[...Array(n).keys()].map(t=>t+e)}function BM(n){return Ib(n)}function FM(n,e){return Math.min(tc*2+1,n.length-2,tc+e-1,tc+n.length-e)}function VM(n){return Math.max(n-tc,2)}function HM(n,e){const t=BM(e),r=VM(n);if(e<=2)return[];let s=Ib(FM(t,n),r);return s.includes(2)||s.unshift(null),s.includes(e-1)||s.push(null),s}const WM=["aria-label"],jM={class:"fr-pagination__list"},UM=["href"],qM=["href"],YM=["aria-current","href","title"],KM=["aria-current","href","title","onClick","data-testid"],GM={key:1,class:"fr-pagination__link fr-hidden fr-unhidden-lg"},JM=["aria-current","href","title","data-testid"],XM=["href"],QM=["href"],Ci=B({__name:"Pagination",props:{page:{default:1},pageSize:{default:20},totalResults:{}},emits:["change"],setup(n,{emit:e}){const t=e,r=n,{t:s}=Te(),i=A(()=>Math.ceil(r.totalResults/r.pageSize)),o=A(()=>HM(r.page,i.value)),a=u=>{if(u!==r.page)return t("change",u)},l=()=>{const u=r.page+1;if(u<=i.value)return t("change",u)},c=()=>{const u=r.page-1;if(u>0)return t("change",u)};return(u,d)=>u.totalResults>u.pageSize?(w(),S("nav",{key:0,role:"navigation",class:"fr-pagination fr-pagination--centered","aria-label":y(s)("Pagination")},[v("ul",jM,[v("li",null,[v("a",{href:u.page===1?void 0:"#",class:"fr-pagination__link fr-pagination__link--first",onClick:d[0]||(d[0]=Se(h=>a(1),["prevent"])),"data-testid":"first-page"},T(y(s)("First page")),9,UM)]),v("li",null,[v("a",{href:u.page===1?void 0:"#",class:"fr-pagination__link fr-pagination__link--prev fr-pagination__link--lg-label",onClick:Se(c,["prevent"]),"data-testid":"previous-page"},T(y(s)("Previous page")),9,qM)]),v("li",null,[v("a",{"aria-current":u.page===1?"page":void 0,href:u.page===1?void 0:"#",class:ue(["fr-pagination__link",{"fr-hidden fr-unhidden-sm":u.page>1}]),title:y(s)("Page {nb}",{nb:1}),onClick:d[1]||(d[1]=Se(h=>a(1),["prevent"])),"data-testid":1}," 1 ",10,YM)]),(w(!0),S(J,null,Fe(o.value,h=>(w(),S("li",null,[h?(w(),S("a",{key:0,class:ue(["fr-pagination__link",{"fr-hidden fr-unhidden-lg":h<u.page-1||h>u.page+1}]),"aria-current":u.page===h?"page":void 0,href:u.page===h?void 0:"#",title:y(s)("Page {nb}",{nb:h}),onClick:Se(f=>a(h),["prevent"]),"data-testid":h},T(h),11,KM)):(w(),S("a",GM," … "))]))),256)),v("li",null,[v("a",{class:"fr-pagination__link","aria-current":u.page===i.value?"page":void 0,href:u.page===i.value?void 0:"#",title:y(s)("Page {nb}",{nb:i.value}),onClick:d[2]||(d[2]=Se(h=>a(i.value),["prevent"])),"data-testid":i.value},T(i.value),9,JM)]),v("li",null,[v("a",{class:"fr-pagination__link fr-pagination__link--next fr-pagination__link--lg-label",href:u.page===i.value?void 0:"#",onClick:Se(l,["prevent"]),"data-testid":"next-page"},T(y(s)("Next page")),9,XM)]),v("li",null,[v("a",{class:"fr-pagination__link fr-pagination__link--last",href:u.page===i.value?void 0:"#",onClick:d[3]||(d[3]=Se(h=>a(i.value),["prevent"])),"data-testid":"last-page"},T(y(s)("Last page")),9,QM)])])],8,WM)):I("",!0)}}),ZM={class:"relative"},dy=284,Lb=B({__name:"ReadMore",props:{maxHeight:{default:""}},setup(n){const e=n,t=$(!1),r=$(!1),s=Ra("containerRef"),i=Ra("readMoreRef"),{height:o}=YS(s),a=$(dy),l=h=>{const f=getComputedStyle(h);return parseFloat(f.getPropertyValue("height"))+parseFloat(f.getPropertyValue("margin-top"))+parseFloat(f.getPropertyValue("margin-bottom"))},c=()=>{const h=document.querySelector('[data-read-more-max-height="'.concat(e.maxHeight,'"]'));return h?Array.from(h.children).map(l).reduce((f,p)=>f+p,0):dy},u=h=>{a.value=c(),r.value=h>a.value,r.value||(a.value=h)},d=()=>{if(!i.value)return;const h=lb(i.value);t.value?Qc({from:{height:i.value.scrollHeight},to:{height:c()},duration:300,ease:Zc}).start({update:h.set,complete:()=>{var f;return(f=i.value)==null?void 0:f.scrollIntoView({behavior:"smooth"})}}):Qc({from:{height:c()},to:{height:i.value.scrollHeight},duration:300,ease:Zc}).start({update:h.set,complete:()=>h.set({height:"auto"})}),t.value=!t.value};return et(o,u),(h,f)=>(w(),S("div",ZM,[v("div",{class:ue(["read-more",{expand:t.value}]),ref_key:"readMoreRef",ref:i,style:vo({height:a.value+"px"})},[v("div",{ref_key:"containerRef",ref:s},[Ye(h.$slots,"default")],512)],6),r.value?(w(),S("div",{key:0,class:"read-more__bottom",onClick:Se(d,["prevent"])},[v("button",{role:"button",class:"fr-btn fr-btn--tertiary-no-outline",onClick:Se(d,["prevent","stop"])},[t.value?(w(),S(J,{key:0},[U(T(h.$t("Read less")),1)],64)):(w(),S(J,{key:1},[U(T(h.$t("Read more")),1)],64))])])):I("",!0)]))}}),e4=["y"],t4=["y"],n4=["y"],r4=["y"],s4=["y"],i4=["y"],o4=["y"],zb=B({__name:"Loader",setup(n){function e(t){return 16+4+t*(32+24)}return(t,r)=>(w(),Y(y(il),{width:1124,height:300,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},{default:q(()=>[r[0]||(r[0]=v("rect",{x:"16",y:"16",rx:"4",ry:"4",width:"112",height:"24"},null,-1)),r[1]||(r[1]=v("rect",{x:"160",y:"16",rx:"4",ry:"4",width:"116",height:"24"},null,-1)),r[2]||(r[2]=v("rect",{x:"308",y:"16",rx:"4",ry:"4",width:"140",height:"24"},null,-1)),r[3]||(r[3]=v("rect",{x:"480",y:"16",rx:"4",ry:"4",width:"106",height:"24"},null,-1)),r[4]||(r[4]=v("rect",{x:"618",y:"16",rx:"4",ry:"4",width:"140",height:"24"},null,-1)),r[5]||(r[5]=v("rect",{x:"790",y:"16",rx:"4",ry:"4",width:"144",height:"24"},null,-1)),r[6]||(r[6]=v("rect",{x:"966",y:"16",rx:"4",ry:"4",width:"142",height:"24"},null,-1)),r[7]||(r[7]=v("rect",{x:"4",y:"56",rx:"4",ry:"4",width:"1116",height:"4"},null,-1)),(w(),S(J,null,Fe(5,s=>(w(),S(J,null,[v("rect",{x:"16",y:e(s),rx:"4",ry:"4",width:"112",height:"32"},null,8,e4),v("rect",{x:"160",y:e(s),rx:"4",ry:"4",width:"116",height:"32"},null,8,t4),v("rect",{x:"308",y:e(s),rx:"4",ry:"4",width:"140",height:"32"},null,8,n4),v("rect",{x:"480",y:e(s),rx:"4",ry:"4",width:"106",height:"32"},null,8,r4),v("rect",{x:"618",y:e(s),rx:"4",ry:"4",width:"140",height:"32"},null,8,s4),v("rect",{x:"790",y:e(s),rx:"4",ry:"4",width:"144",height:"32"},null,8,i4),v("rect",{x:"966",y:e(s),rx:"4",ry:"4",width:"142",height:"32"},null,8,o4)],64))),64))]),_:1}))}});function a4(n,e,t){let r="".concat(vt.tabular_api_url,"/api/resources/").concat(n,"/data/?page=").concat(e,"&page_size=").concat(vt.tabular_page_size);return t&&(r=r+"&".concat(t.column,"__sort=").concat(t.type)),Qn.get(r)}function l4(n){const e="".concat(vt.tabular_api_url,"/api/resources/").concat(n,"/profile/");return Qn.get(e)}const c4={key:0,class:"bg-alt-green-tilleul-verveine fr-p-3v fr-mb-2w"},u4={class:"fr-grid-row fr-m-0"},d4={key:2,class:"fr-grid-row fr-grid-row--gutters"},h4={key:0,class:"bg-alt-green-tilleul-verveine fr-p-3v fr-mb-2w"},f4={class:"fr-grid-row fr-m-0"},p4={class:"fr-col-12 fr-col-sm-6 fr-col-md-4 fr-col-lg-3"},m4={class:"fr-text--sm fr-text--bold fr-mt-0 fr-mb-1v"},g4={class:"code"},y4=B({__name:"DataStructure",props:{resource:{}},setup(n){const e=n,t=$([]),r=$({}),s=$(!0),i=$(!1),o=$(!1);return Ve(async()=>{try{const{data:a}=await l4(e.resource.id);"profile"in a&&a.profile?(t.value=Object.keys(a.profile.columns),r.value=a.profile.columns,o.value=!0,s.value=!1):(i.value=!0,s.value=!1)}catch(a){i.value=!0,s.value=!1}}),(a,l)=>i.value?(w(),S("div",c4,[v("p",u4,[l[0]||(l[0]=v("span",{class:"fr-icon-warning-line","aria-hidden":"true"},null,-1)),U(" "+T(a.$t("The data structure of this file failed to load.")),1)])])):s.value?(w(),Y(zb,{key:1})):(w(),S("div",d4,[o.value?I("",!0):(w(),S("div",h4,[v("p",f4,[l[1]||(l[1]=v("span",{class:"fr-icon-warning-line","aria-hidden":"true"},null,-1)),U(" "+T(a.$t("No data structure found for this file.")),1)])])),o.value?(w(!0),S(J,{key:1},Fe(t.value,c=>(w(),S("div",p4,[v("h5",m4,T(c),1),v("code",g4,T(r.value[c].format),1)]))),256)):I("",!0)]))}}),v4='<svg width="64" height="64" viewBox="0 0 64 64" aria-hidden="true" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="path-1-inside-1_677_1834" fill="white"><path d="M47.6364 31.7323C47.8391 31.8153 48.0153 31.8812 48.1901 31.9556C49.3599 32.4569 50.0394 33.3352 50.1277 34.6162C50.1983 35.6647 50.2292 36.7158 50.2371 37.7685C50.2523 39.8635 51.2789 41.4763 52.6657 42.8981C53.5865 43.842 53.6661 44.3716 52.7286 45.2974C51.1332 46.8812 49.3827 48.2165 47.1329 48.7665C44.8819 49.3216 42.5083 49.0548 40.4357 48.0138C39.4892 47.5604 38.5265 47.3019 37.5309 47.7071C37.071 47.9103 36.6618 48.214 36.3331 48.596C36.0111 48.9977 35.7367 49.4357 35.5154 49.9011C35.0548 50.75 34.2981 51.2484 33.4773 51.6648C33.2122 51.7978 32.9196 51.8661 32.6233 51.8641C32.3271 51.862 32.0355 51.7897 31.7724 51.653C31.4776 51.521 31.2044 51.3451 30.9618 51.1313C29.8211 50.0656 28.445 49.7385 26.9352 49.6965C24.2186 49.5962 21.5474 48.9671 19.0698 47.8441C18.4504 47.5532 17.8641 47.1957 17.3213 46.7778C16.6911 46.3217 16.5988 45.9152 16.8344 45.1807C17.1056 44.3195 17.3992 43.4821 17.6453 42.6226C17.6638 42.5251 17.6598 42.4247 17.6338 42.329C17.6077 42.2333 17.5603 42.1449 17.495 42.0705C16.4777 41.1564 16.4698 41.1632 15.3346 41.8919C12.2675 43.8671 9.1983 45.8419 6.12697 47.816C5.39573 48.2874 5.04746 48.1891 4.61497 47.4308C4.33147 46.9348 4.052 46.4365 3.77656 45.9357C3.18563 44.8787 3.26602 44.5782 4.27115 43.9407C7.48797 41.9067 10.6834 39.8658 13.9015 37.8507C14.3035 37.5956 14.4007 37.3572 14.3108 36.8936C13.6776 33.714 14.5417 30.9795 16.8278 28.6954C16.9816 28.5764 17.0894 28.4073 17.1328 28.2171C17.1763 28.027 17.1526 27.8277 17.0658 27.6532C16.5668 26.2486 15.7792 25.1355 14.3525 24.5233C13.5227 24.1467 12.7175 23.7178 11.9416 23.2391C10.7864 22.5922 9.89092 21.5619 9.40841 20.3243C9.31335 20.0822 9.28169 19.8197 9.31644 19.5617C9.3512 19.3037 9.45121 19.059 9.60692 18.8509C10.6377 17.2552 12.2625 16.7311 13.9773 16.7337C15.3337 16.7378 16.6957 17.1374 18.0435 17.418C19.2594 17.6697 19.3451 17.666 19.9235 16.5752C20.1987 16.055 20.4163 15.4882 20.7251 14.9994C21.2758 14.1191 21.9105 13.926 22.8624 14.3348C23.2938 14.516 23.7286 14.7474 24.1486 14.9462C24.9684 15.324 25.7026 15.2084 26.3461 14.585C26.6077 14.3351 26.842 14.0578 27.045 13.7578C27.8829 12.5231 28.9904 11.4969 30.2827 10.7576C31.7264 9.85971 32.9011 8.58535 33.6818 7.07013C34.0043 6.47507 34.6284 6.37336 35.1547 6.87449C36.1787 7.85765 37.2353 8.82594 38.1708 9.8952C39.6137 11.5828 41.5324 12.7905 43.6733 13.3587C45.1679 13.7661 46.5788 14.4553 48.045 14.97C49.8289 15.5957 51.624 16.1995 53.4326 16.7561C54.4429 17.0682 54.7071 17.4125 54.4318 18.4614C53.8032 20.8525 53.1633 23.2416 52.512 25.6287C52.2313 26.6591 51.5044 27.3829 50.6757 27.9621C49.3363 28.9134 48.2845 30.2182 47.6364 31.7323ZM19.0829 43.0845C18.8621 43.7906 18.688 44.4745 18.4321 45.1261C18.2675 45.546 18.3981 45.7414 18.7452 45.9473C21.1132 47.3103 23.6962 47.8813 26.3813 48.163C27.5256 48.2847 28.6999 48.356 29.785 48.6883C30.5876 48.9346 31.287 49.5481 32.0035 50.0404C32.41 50.3202 32.7838 50.4547 33.176 50.0845C33.6071 49.6961 34.0124 49.2799 34.3896 48.8386C34.6545 48.4664 34.8964 48.0784 35.1142 47.6767C35.6541 46.8224 36.438 46.3537 37.4121 46.1269C38.6063 45.8473 39.8607 46.0113 40.9435 46.5887C43.5843 47.9246 46.236 47.8653 48.8 46.4721C49.8779 45.8886 50.796 44.9852 51.8339 44.1811C49.2935 41.8756 48.4762 39.073 48.724 35.8709C48.7321 35.4135 48.6838 34.9569 48.5801 34.5115C48.4556 33.8144 47.9893 33.425 47.3285 33.2617C47.0897 33.2022 46.8401 33.1982 46.5981 33.1537C45.8078 32.9971 45.5014 32.4304 45.8734 31.7287C46.8901 29.7991 47.9735 27.9259 49.8707 26.6837C50.2318 26.4528 50.5403 26.1477 50.7759 25.7885C51.0114 25.4292 51.1688 25.0241 51.2375 24.5995C51.4742 23.351 51.8317 22.1215 52.1618 20.8919C52.3982 20.012 52.6732 19.1464 52.9439 18.2473C52.0883 17.992 51.2364 17.7912 50.4176 17.4913C48.2143 16.6752 46.0306 15.8094 43.8326 14.9782C42.7874 14.5843 41.7022 14.2815 40.6869 13.8328C38.9215 13.0457 37.6898 11.5944 36.4238 10.1918C35.887 9.59656 35.273 9.06983 34.7665 8.58209C33.7652 9.61965 32.9772 10.7416 31.9168 11.4609C30.2571 12.5878 28.7721 13.8207 27.6019 15.4618C27.008 16.2924 26.1005 16.6368 25.0653 16.6718C24.1996 16.7016 23.4937 16.3034 22.7614 15.9491C22.0637 15.6113 22.0795 15.6271 21.7115 16.3264C21.3435 17.0257 20.9463 17.727 20.5177 18.3967C20.3427 18.6865 20.0779 18.9105 19.764 19.0344C19.45 19.1582 19.1044 19.1751 18.7801 19.0823C17.7876 18.8694 16.7939 18.6383 15.799 18.389C14.442 18.0468 13.0074 18.2086 11.7591 18.8447C10.8519 19.286 10.659 19.8764 11.3125 20.6174C11.7995 21.1706 12.3573 21.6566 12.9713 22.0626C13.7107 22.5281 14.4823 22.9399 15.2802 23.2949C16.2898 23.744 17.1328 24.5015 17.6895 25.4597C18.0248 26.0498 18.3157 26.6661 18.629 27.2724C23.4786 24.8338 27.9071 26.9763 29.9508 29.657C31.1027 31.1657 31.7438 33.0057 31.7801 34.9075C31.8164 36.8093 31.2461 38.6732 30.1526 40.2264C28.1536 43.0702 23.9809 45.1654 19.0829 43.0845ZM23.4376 42.3861C27.4778 42.1222 30.5404 38.6684 30.2798 34.6712C30.16 32.7164 29.2747 30.8892 27.8175 29.5894C26.3603 28.2897 24.4499 27.6232 22.5043 27.7359C21.536 27.7825 20.5865 28.0224 19.7111 28.4416C18.8358 28.8608 18.0522 29.4508 17.4059 30.1773C16.7596 30.9039 16.2636 31.7523 15.9469 32.6733C15.6301 33.5943 15.4988 34.5693 15.5608 35.5416C15.6227 36.5139 15.8766 37.4639 16.3076 38.3364C16.7387 39.2089 17.3382 39.9863 18.0714 40.6234C18.8045 41.2604 19.6566 41.7444 20.5779 42.047C21.4992 42.3497 22.4713 42.465 23.4376 42.3861ZM5.73574 46.2692L15.5443 39.9311L14.9626 38.9176L5.11278 45.1722L5.73574 46.2692Z"/></mask><path d="M47.6364 31.7323C47.8391 31.8153 48.0153 31.8812 48.1901 31.9556C49.3599 32.4569 50.0394 33.3352 50.1277 34.6162C50.1983 35.6647 50.2292 36.7158 50.2371 37.7685C50.2523 39.8635 51.2789 41.4763 52.6657 42.8981C53.5865 43.842 53.6661 44.3716 52.7286 45.2974C51.1332 46.8812 49.3827 48.2165 47.1329 48.7665C44.8819 49.3216 42.5083 49.0548 40.4357 48.0138C39.4892 47.5604 38.5265 47.3019 37.5309 47.7071C37.071 47.9103 36.6618 48.214 36.3331 48.596C36.0111 48.9977 35.7367 49.4357 35.5154 49.9011C35.0548 50.75 34.2981 51.2484 33.4773 51.6648C33.2122 51.7978 32.9196 51.8661 32.6233 51.8641C32.3271 51.862 32.0355 51.7897 31.7724 51.653C31.4776 51.521 31.2044 51.3451 30.9618 51.1313C29.8211 50.0656 28.445 49.7385 26.9352 49.6965C24.2186 49.5962 21.5474 48.9671 19.0698 47.8441C18.4504 47.5532 17.8641 47.1957 17.3213 46.7778C16.6911 46.3217 16.5988 45.9152 16.8344 45.1807C17.1056 44.3195 17.3992 43.4821 17.6453 42.6226C17.6638 42.5251 17.6598 42.4247 17.6338 42.329C17.6077 42.2333 17.5603 42.1449 17.495 42.0705C16.4777 41.1564 16.4698 41.1632 15.3346 41.8919C12.2675 43.8671 9.1983 45.8419 6.12697 47.816C5.39573 48.2874 5.04746 48.1891 4.61497 47.4308C4.33147 46.9348 4.052 46.4365 3.77656 45.9357C3.18563 44.8787 3.26602 44.5782 4.27115 43.9407C7.48797 41.9067 10.6834 39.8658 13.9015 37.8507C14.3035 37.5956 14.4007 37.3572 14.3108 36.8936C13.6776 33.714 14.5417 30.9795 16.8278 28.6954C16.9816 28.5764 17.0894 28.4073 17.1328 28.2171C17.1763 28.027 17.1526 27.8277 17.0658 27.6532C16.5668 26.2486 15.7792 25.1355 14.3525 24.5233C13.5227 24.1467 12.7175 23.7178 11.9416 23.2391C10.7864 22.5922 9.89092 21.5619 9.40841 20.3243C9.31335 20.0822 9.28169 19.8197 9.31644 19.5617C9.3512 19.3037 9.45121 19.059 9.60692 18.8509C10.6377 17.2552 12.2625 16.7311 13.9773 16.7337C15.3337 16.7378 16.6957 17.1374 18.0435 17.418C19.2594 17.6697 19.3451 17.666 19.9235 16.5752C20.1987 16.055 20.4163 15.4882 20.7251 14.9994C21.2758 14.1191 21.9105 13.926 22.8624 14.3348C23.2938 14.516 23.7286 14.7474 24.1486 14.9462C24.9684 15.324 25.7026 15.2084 26.3461 14.585C26.6077 14.3351 26.842 14.0578 27.045 13.7578C27.8829 12.5231 28.9904 11.4969 30.2827 10.7576C31.7264 9.85971 32.9011 8.58535 33.6818 7.07013C34.0043 6.47507 34.6284 6.37336 35.1547 6.87449C36.1787 7.85765 37.2353 8.82594 38.1708 9.8952C39.6137 11.5828 41.5324 12.7905 43.6733 13.3587C45.1679 13.7661 46.5788 14.4553 48.045 14.97C49.8289 15.5957 51.624 16.1995 53.4326 16.7561C54.4429 17.0682 54.7071 17.4125 54.4318 18.4614C53.8032 20.8525 53.1633 23.2416 52.512 25.6287C52.2313 26.6591 51.5044 27.3829 50.6757 27.9621C49.3363 28.9134 48.2845 30.2182 47.6364 31.7323ZM19.0829 43.0845C18.8621 43.7906 18.688 44.4745 18.4321 45.1261C18.2675 45.546 18.3981 45.7414 18.7452 45.9473C21.1132 47.3103 23.6962 47.8813 26.3813 48.163C27.5256 48.2847 28.6999 48.356 29.785 48.6883C30.5876 48.9346 31.287 49.5481 32.0035 50.0404C32.41 50.3202 32.7838 50.4547 33.176 50.0845C33.6071 49.6961 34.0124 49.2799 34.3896 48.8386C34.6545 48.4664 34.8964 48.0784 35.1142 47.6767C35.6541 46.8224 36.438 46.3537 37.4121 46.1269C38.6063 45.8473 39.8607 46.0113 40.9435 46.5887C43.5843 47.9246 46.236 47.8653 48.8 46.4721C49.8779 45.8886 50.796 44.9852 51.8339 44.1811C49.2935 41.8756 48.4762 39.073 48.724 35.8709C48.7321 35.4135 48.6838 34.9569 48.5801 34.5115C48.4556 33.8144 47.9893 33.425 47.3285 33.2617C47.0897 33.2022 46.8401 33.1982 46.5981 33.1537C45.8078 32.9971 45.5014 32.4304 45.8734 31.7287C46.8901 29.7991 47.9735 27.9259 49.8707 26.6837C50.2318 26.4528 50.5403 26.1477 50.7759 25.7885C51.0114 25.4292 51.1688 25.0241 51.2375 24.5995C51.4742 23.351 51.8317 22.1215 52.1618 20.8919C52.3982 20.012 52.6732 19.1464 52.9439 18.2473C52.0883 17.992 51.2364 17.7912 50.4176 17.4913C48.2143 16.6752 46.0306 15.8094 43.8326 14.9782C42.7874 14.5843 41.7022 14.2815 40.6869 13.8328C38.9215 13.0457 37.6898 11.5944 36.4238 10.1918C35.887 9.59656 35.273 9.06983 34.7665 8.58209C33.7652 9.61965 32.9772 10.7416 31.9168 11.4609C30.2571 12.5878 28.7721 13.8207 27.6019 15.4618C27.008 16.2924 26.1005 16.6368 25.0653 16.6718C24.1996 16.7016 23.4937 16.3034 22.7614 15.9491C22.0637 15.6113 22.0795 15.6271 21.7115 16.3264C21.3435 17.0257 20.9463 17.727 20.5177 18.3967C20.3427 18.6865 20.0779 18.9105 19.764 19.0344C19.45 19.1582 19.1044 19.1751 18.7801 19.0823C17.7876 18.8694 16.7939 18.6383 15.799 18.389C14.442 18.0468 13.0074 18.2086 11.7591 18.8447C10.8519 19.286 10.659 19.8764 11.3125 20.6174C11.7995 21.1706 12.3573 21.6566 12.9713 22.0626C13.7107 22.5281 14.4823 22.9399 15.2802 23.2949C16.2898 23.744 17.1328 24.5015 17.6895 25.4597C18.0248 26.0498 18.3157 26.6661 18.629 27.2724C23.4786 24.8338 27.9071 26.9763 29.9508 29.657C31.1027 31.1657 31.7438 33.0057 31.7801 34.9075C31.8164 36.8093 31.2461 38.6732 30.1526 40.2264C28.1536 43.0702 23.9809 45.1654 19.0829 43.0845ZM23.4376 42.3861C27.4778 42.1222 30.5404 38.6684 30.2798 34.6712C30.16 32.7164 29.2747 30.8892 27.8175 29.5894C26.3603 28.2897 24.4499 27.6232 22.5043 27.7359C21.536 27.7825 20.5865 28.0224 19.7111 28.4416C18.8358 28.8608 18.0522 29.4508 17.4059 30.1773C16.7596 30.9039 16.2636 31.7523 15.9469 32.6733C15.6301 33.5943 15.4988 34.5693 15.5608 35.5416C15.6227 36.5139 15.8766 37.4639 16.3076 38.3364C16.7387 39.2089 17.3382 39.9863 18.0714 40.6234C18.8045 41.2604 19.6566 41.7444 20.5779 42.047C21.4992 42.3497 22.4713 42.465 23.4376 42.3861ZM5.73574 46.2692L15.5443 39.9311L14.9626 38.9176L5.11278 45.1722L5.73574 46.2692Z" fill="#e4794a" stroke="#e4794a" stroke-width="1.47127" mask="url(#path-1-inside-1_677_1834)"/><path d="M55.8056 54.9357L55.8053 54.9356C53.9679 53.7622 53.1178 52.0475 53.3058 49.8972C53.3294 49.6381 53.4447 49.3591 53.6234 49.051C53.749 48.8346 53.8901 48.6287 54.0361 48.4157C54.1014 48.3203 54.1677 48.2235 54.2341 48.1238L54.2342 48.1235C54.8237 47.2354 55.4726 46.374 56.1353 45.5437C56.3434 45.2859 56.6122 45.0845 56.9172 44.9578L56.9172 44.9579L56.923 44.9553C56.9599 44.9393 57 44.9321 57.04 44.9343C57.0801 44.9366 57.1192 44.9482 57.1542 44.9684L57.3381 44.6496L57.1542 44.9684C57.1892 44.9885 57.2192 45.0168 57.2417 45.0509C57.2643 45.0851 57.2786 45.1242 57.2835 45.1651L57.2856 45.1826L57.2894 45.1999C57.6104 46.6687 57.9003 48.1378 58.1967 49.6402C58.2648 49.9854 58.3332 50.3324 58.4025 50.6815C58.3661 51.0327 58.3381 51.3785 58.3105 51.7205C58.2462 52.5158 58.1835 53.291 58.0196 54.0677C58.0039 54.1413 57.9855 54.2112 57.9646 54.2774L57.2274 53.9288C57.2588 53.8551 57.2859 53.7789 57.3096 53.7024C57.3862 53.4552 57.4388 53.1657 57.4739 52.8556C57.5443 52.235 57.5488 51.4924 57.5128 50.7585C57.4768 50.0228 57.3995 49.2844 57.3024 48.6685C57.2079 48.0695 57.0879 47.5396 56.9499 47.2536L56.7354 46.8089L56.3706 47.1425C56.2548 47.2485 56.1361 47.3593 56.0145 47.4728C55.7638 47.7069 55.5007 47.9526 55.2238 48.1917C54.6795 48.6593 54.3018 49.1965 54.1288 49.809C53.9559 50.4209 53.997 51.0746 54.2336 51.7594C54.4146 52.3383 54.7129 52.8734 55.1098 53.331C55.3952 53.66 55.7272 53.9438 56.0944 54.1737L55.7471 54.522L56.7235 54.4551L56.7277 54.4549L57.9319 54.3724C57.7731 54.799 57.5043 55.0583 57.2051 55.1753C56.8363 55.3195 56.3419 55.2789 55.8056 54.9357Z" fill="#e4794a" stroke="#e4794a" stroke-width="0.735634"/><path d="M32.0098 27.4033C31.8698 27.2844 31.5731 27.1425 31.4612 26.9121C31.1579 26.3001 30.8869 25.6725 30.6493 25.0318C30.3973 24.4023 29.9882 24.0238 29.3023 23.9844C29.1123 23.9917 28.9234 23.9526 28.7517 23.8704C28.5172 23.7179 28.2081 23.5158 28.1586 23.2791C28.1439 23.1349 28.1632 22.9893 28.2149 22.854C28.2666 22.7187 28.3493 22.5976 28.4562 22.5003C29.5039 21.7777 29.8084 20.7899 29.7264 19.5716C29.7065 19.276 29.9189 18.7875 30.1499 18.7C30.4334 18.5837 30.8707 18.7286 31.1946 18.8687C31.3888 18.9523 31.5044 19.2372 31.6316 19.4454C32.1339 20.2747 32.7479 20.9278 33.7881 21.0293C34.2101 21.07 34.6257 21.2037 34.763 21.6872C34.9004 22.1708 34.6307 22.4926 34.3129 22.7861C33.2433 23.7735 32.6731 24.9564 32.828 26.4478C32.8683 26.9232 32.6691 27.2634 32.0098 27.4033ZM30.4794 22.663L30.6854 22.453L31.8104 23.5978L32.5667 22.3769L31.0835 21.3304C30.8875 21.782 30.6846 22.2235 30.4795 22.6651L30.4794 22.663Z" fill="white"/><path d="M35.3139 40.5875C35.3348 40.8978 35.3563 41.2165 35.3777 41.5352C35.4082 41.9882 35.3326 42.3915 34.814 42.5028C34.3801 42.5957 34.023 42.3042 33.8949 41.7716C33.8565 41.6057 33.8531 41.4311 33.8311 41.2599C33.8091 41.0886 33.7922 40.9613 33.7682 40.7923C33.2267 40.6882 32.6052 40.6718 32.5854 39.9106C32.5739 39.4901 32.8465 39.305 33.5825 39.1535C33.56 38.818 33.5204 38.4794 33.5144 38.1407C33.5097 37.5722 33.777 37.2148 34.2023 37.1815C34.6277 37.1481 34.9354 37.4536 35.0143 38.0338C35.0584 38.3467 35.0566 38.6628 35.0807 39.0214C35.6566 38.982 36.1913 38.8927 36.3436 39.5669C36.4511 40.0125 36.158 40.2979 35.3139 40.5875Z" fill="white"/><path d="M21.4362 21.894C21.9395 21.8975 22.3991 21.9376 22.4815 22.5071C22.5739 23.1327 22.0685 23.2853 21.6171 23.4615C21.6054 23.6919 21.6696 23.9614 21.5678 24.1305C21.4188 24.3767 21.1636 24.6954 20.9321 24.7133C20.7847 24.6985 20.6431 24.6475 20.5199 24.5649C20.3966 24.4822 20.2955 24.3704 20.2253 24.2393C20.0438 23.8157 19.9873 23.413 19.4798 23.1592C19.0311 22.9392 19.1104 22.3418 19.5218 22.0082C19.6613 21.8997 19.8457 21.7754 19.8794 21.6214C19.9716 21.217 20.1775 20.9438 20.5923 20.9406C21.0443 20.9286 21.2544 21.2471 21.3591 21.6507C21.3761 21.7169 21.4017 21.7868 21.4362 21.894Z" fill="white"/><path d="M25.7339 38.1494L25.5118 38.0538L23.9878 37.3977L23.6345 37.2455L23.8028 36.8992C24.223 36.035 24.0136 35.2562 23.5068 34.3769L25.7339 38.1494ZM25.7339 38.1494L25.9099 37.9831M25.7339 38.1494L25.9099 37.9831M25.9099 37.9831C28.053 35.958 27.6901 32.4635 25.1777 31.0098L25.9099 37.9831ZM24.2421 30.9358L24.2421 30.9358C24.3489 30.8623 24.4644 30.8442 24.5434 30.8403C24.6273 30.8362 24.7094 30.8464 24.7803 30.8608C24.9203 30.8893 25.0655 30.9447 25.1776 31.0097L24.2421 30.9358ZM24.2421 30.9358L24.2401 30.9372M24.2421 30.9358L24.2401 30.9372M24.2401 30.9372C23.7609 31.2718 23.4531 31.907 23.3201 32.5212M24.2401 30.9372L23.3201 32.5212M23.3201 32.5212C23.1867 33.1377 23.2036 33.8514 23.5067 34.3768L23.3201 32.5212ZM23.0591 40.1014L23.0591 40.1013L23.0499 40.1021C22.3684 40.1591 21.6825 40.0799 21.0317 39.8689C20.381 39.6578 19.7782 39.3192 19.2584 38.8724C18.7385 38.4257 18.3119 37.8796 18.0032 37.2658C17.6946 36.6521 17.5101 35.9827 17.4603 35.2966L17.4603 35.2965C17.2504 32.4087 19.5441 29.8094 22.5065 29.6066C25.4646 29.4041 27.8677 31.4988 28.0702 34.4116C28.1146 35.1162 28.0201 35.8228 27.792 36.4907C27.5638 37.1589 27.2066 37.7751 26.7408 38.3039C26.275 38.8327 25.7099 39.2637 25.0781 39.5721C24.4462 39.8806 23.7601 40.0605 23.0591 40.1014ZM23.9612 38.251C23.9505 38.2473 23.9397 38.2436 23.9291 38.2399C23.7969 38.1945 23.6718 38.1514 23.5454 38.1032C23.2053 37.9729 23.0039 37.7713 22.9151 37.5596C22.8289 37.3541 22.8275 37.0893 22.9832 36.7792C23.1516 36.4926 23.2326 36.1628 23.2164 35.8306C23.2 35.4964 23.0859 35.1745 22.8883 34.9051C22.5891 34.4641 22.4159 33.9488 22.3879 33.4153C22.3597 32.8796 22.479 32.3466 22.7324 31.8747L22.7326 31.8747L22.7378 31.8643C22.8467 31.6451 22.9491 31.418 23.0581 31.1762C23.1023 31.0783 23.1475 30.9779 23.1948 30.8747L23.436 30.3474L22.8564 30.3542C21.7919 30.3667 20.7629 30.7392 19.935 31.4108C19.7356 31.5393 19.5844 31.7309 19.5054 31.9551C19.4256 32.1818 19.4243 32.4286 19.5012 32.6557C19.6015 33.0536 19.7317 33.4432 19.8905 33.8213L19.8952 33.8325L19.9006 33.8433C20.5091 35.0609 20.4616 36.3277 20.0864 37.6368C20.0145 37.8854 19.9917 38.1472 20.1124 38.3899C20.23 38.6262 20.4455 38.7653 20.6559 38.8634L20.6565 38.8637C21.7133 39.3545 22.8172 39.5094 23.9887 39.04L24.387 39.1796L24.3495 38.6228L24.3493 38.6186L24.314 38.0951L23.9612 38.251ZM19.11 34.067L18.7841 34.1721L18.7448 33.9013L18.5019 33.9369L18.1413 33.9898L18.1904 34.3509L18.514 36.7302L18.5633 37.0933L18.9267 37.0448L19.1531 37.0145L19.3869 36.9833L19.4563 36.7577C19.594 36.3104 19.6343 35.8386 19.5745 35.3744C19.5148 34.9102 19.3564 34.4643 19.11 34.067Z" fill="#e4794a" stroke="#e4794a" stroke-width="0.735634"/><path d="M25.6571 37.7115L24.1331 37.0554C24.6319 36.027 24.3565 35.1105 23.8249 34.1884C23.3498 33.3573 23.7072 31.7529 24.4499 31.2344C24.56 31.1574 24.8398 31.2351 24.9925 31.3237C27.2847 32.6497 27.6341 35.8488 25.6571 37.7115Z" fill="#F2F7FF"/><path d="M18.7969 34.2611C19.0149 34.6133 19.1551 35.0084 19.2081 35.4198C19.2611 35.8312 19.2256 36.2492 19.104 36.6457L18.8776 36.676L18.554 34.2967L18.7969 34.2611Z" fill="#F2F7FF"/></svg>\n',b4={key:0,class:"bg-alt-green-tilleul-verveine fr-p-3v fr-mt-4w fr-mx-4w fr-mb-3v"},w4={class:"fr-grid-row fr-m-0"},_4={class:"bg-blue-100 text-blue-400 fr-hidden fr-unhidden-md fr-p-2w"},k4={class:"fr-grid-row fr-grid-row--middle fr-grid-row--gutters"},x4=["innerHTML"],C4={class:"fr-col"},S4={class:"fr-text--bold fr-m-0"},M4={class:"fr-text--sm fr-m-0 f-italic"},T4={class:"fr-col-auto fr-my-0"},O4=["href"],D4={class:"fr-table fr-table--no-background fr-p-0 fr-pt-0-5v fr-m-0"},$4={class:"fr-mb-3w"},E4={class:"fr-sr-only"},A4={scope:"col"},P4={class:"fr-grid-row fr-grid-row--middle col-width"},R4=["onClick"],N4={class:"fr-sr-only"},I4={class:"cell-padding"},L4={class:"fr-grid-row fr-grid-row--middle fr-text--xs w-100 style-cell"},z4={class:"fr-my-auto"},B4={class:"fr-px-5v"},F4=B({__name:"Preview",props:{resource:{}},setup(n){const e=n,{t}=Te(),r=$([]),s=$([]),i=$(!0),o=$(!1),a=$(null),l=$(0),c=vt.tabular_page_size,u=$(1);function d(g){var b;return g===((b=a.value)==null?void 0:b.column)}async function h(g,b){try{const{data:_}=await a4(e.resource.id,g,b);"data"in _&&_.data&&_.data.length>0?(r.value=_.data,s.value=Object.keys(_.data[0]).filter(M=>M!=="__id"),l.value=_.meta.total,u.value=g,i.value=!1):(o.value=!0,i.value=!1)}catch(_){o.value=!0,i.value=!1}}function f(g){h(g,a.value)}function p(g){a.value&&a.value.column==g?a.value.type=="asc"?a.value.type="desc":a.value.type="asc":a.value?(a.value.column=g,a.value.type="asc"):a.value={column:g,type:"asc"},u.value=1,h(u.value,a.value)}const m=ps(e.resource.extras["analysis:parsing:finished_at"]);return Ve(()=>{h(u.value)}),(g,b)=>(w(),S("div",null,[o.value?(w(),S("div",b4,[v("p",w4,[b[0]||(b[0]=v("span",{class:"fr-icon-warning-line","aria-hidden":"true"},null,-1)),U(" "+T(y(t)("The preview of this file failed to load.")),1)])])):i.value?(w(),Y(zb,{key:1})):(w(),S(J,{key:2},[v("div",_4,[v("div",k4,[v("div",{class:"fr-col-auto",innerHTML:y(v4)},null,8,x4),v("div",C4,[v("p",S4,T(y(t)("Explore data in detail")),1),v("p",M4,T(y(t)("Use our tool to get an overview of data, learn about different columns or perform filters and sorts.")),1)]),v("p",T4,[v("a",{href:g.resource.preview_url,class:"fr-btn",target:"_blank"},T(y(t)("Explore data")),9,O4)])])]),v("div",D4,[v("table",$4,[v("caption",E4,T(y(t)("Preview of {name}",{name:g.resource.title})),1),v("thead",null,[v("tr",null,[(w(!0),S(J,null,Fe(s.value,_=>(w(),S("th",A4,[v("div",P4,[v("button",{class:ue(["fr-btn fr-btn--sm fr-btn--tertiary-no-outline fr-my-n1w",{"fr-btn--secondary-grey-500":!d(_),"fr-btn--icon-right":d(_),"fr-icon-arrow-down-line":d(_)&&a.value&&a.value.type=="desc","fr-icon-arrow-up-line":d(_)&&a.value&&a.value.type=="asc"}]),onClick:M=>p(_)},[U(T(_)+" ",1),v("span",N4,T(a.value&&a.value.type=="desc"?y(t)("Sort ascending"):y(t)("Sort descending")),1)],10,R4)])]))),256))])]),v("tbody",null,[(w(!0),S(J,null,Fe(r.value,_=>(w(),S("tr",null,[(w(!0),S(J,null,Fe(s.value,M=>(w(),S("td",I4,[v("div",L4,[v("div",z4,T(_[M]),1)])]))),256))]))),256))])])]),P(y(Ci),{class:"fr-mt-3w",page:u.value,pageSize:y(c),totalResults:l.value,onChange:f},null,8,["page","pageSize","totalResults"]),v("div",B4,T(y(t)("Preview updated on {date}",{date:y(m)}))+" — "+T(y(t)("{count} columns",s.value.length))+" — "+T(y(t)("{count} rows",l.value)),1)],64))]))}}),V4=$e(F4,[["__scopeId","data-v-90a6d6fe"]]),H4=["href"],W4=B({__name:"EditButton",props:{datasetId:{},isCommunityResource:{type:Boolean,default:!1},resource:{}},setup(n){const e=n,{t}=Te(),r=A(()=>vt.new_admin?"owner"in e.resource&&e.resource.owner?"".concat(vt.admin_root,"users/").concat(e.resource.owner.id,"/community-resources/?resource_id=").concat(e.resource.id):"organization"in e.resource&&e.resource.organization?"".concat(vt.admin_root,"organization/").concat(e.resource.organization.id,"/community-resources/?resource_id=").concat(e.resource.id):"".concat(vt.admin_root,"datasets/").concat(e.datasetId,"/files/?resource_id=").concat(e.resource.id):"".concat(vt.admin_root,"dataset/").concat(e.datasetId,"/").concat(e.isCommunityResource?"community-resource":"resource","/").concat(e.resource.id));return(s,i)=>(w(),S("a",{href:r.value,class:"fr-btn fr-btn--secondary fr-btn--secondary-warning-425 fr-icon-pencil-line fr-icon--sm","data-testid":"edit-button"},T(y(t)("Edit file")),9,H4))}}),j4="/_themes/gouvfr/assets/file.svg",U4="/_themes/gouvfr/assets/code.svg",q4="/_themes/gouvfr/assets/archive.svg",Y4="/_themes/gouvfr/assets/documentation.svg",K4="/_themes/gouvfr/assets/link2.svg",G4="/_themes/gouvfr/assets/table.svg",J4="/_themes/gouvfr/assets/map.svg",X4="/_themes/gouvfr/assets/globe.svg";function Bb(n){var e,t;switch((t=(e=n.format)==null?void 0:e.trim())==null?void 0:t.toLowerCase()){case"txt":case"pdf":case"rtf":case"odt":case"doc":case"docx":case"epub":return Y4;case"json":case"sql":case"xml":case"xsd":case"shp":case"kml":case"kmz":case"gpx":case"shx":case"ovr":case"gpkg":case"grib2":case"dbf":case"prj":case"sqlite":case"db":case"sbn":case"sbx":case"cpg":case"lyr":case"owl":case"dxf":case"ics":case"rdf":case"ttl":case"n3":return U4;case"tar":case"gz":case"tgz":case"rar":case"zip":case"7z":case"xz":case"bz2":return q4;case"url":return K4;case"csv":case"ods":case"xls":case"xlsx":case"parquet":case"csv.gz":return G4;case"geojson":return J4;case"ogc:wfs":case"ogc:wms":case"wfs":case"wms":return X4;default:return null}}function Fb(n){return"resource-"+n.id+"-title"}const Q4={class:"fr-icon-svg flex items-center"},Z4=["src"],eT=B({__name:"ResourceIcon",props:{resource:{}},setup(n){const e=n,t=A(()=>Bb(e.resource)||j4);return(r,s)=>(w(),S("div",Q4,[v("img",{src:t.value,alt:""},null,8,Z4)]))}}),tT={key:0,class:"inline-flex fr-mb-0 align-items-baseline fr-text--xs"},nT={class:"flex justify-between border-bottom"},rT={class:"fr-text--sm fr-my-0 fr-p-2v"},sT=["onClick","title"],iT={class:"fr-p-3v"},oT={key:0},aT={key:1},lT={key:2},cT={key:3,class:"text-default-warning flex items-center fr-mt-4v"},uT={key:4,class:"text-default-warning flex items-center fr-mt-4v"},dT={key:5,class:"text-default-warning flex items-center fr-mt-4v"},hT={key:6,class:"w-100 text-align-right fr-mt-5v",target:"_blank"},fT=["href"],pT={class:"fr-mr-1v text-grey-380"},mT={class:"flex items-center bg-error-950 rounded-sm"},gT={class:"fr-tag fr-tag--sm"},yT={key:0,class:"flex items-center padding-sm"},vT={key:1,class:"flex items-center text-warning-425 padding-sm"},bT=B({__name:"SchemaBadge",props:{resource:{}},setup(n){const e=n,{t}=Te(),r=$(null);Ve(async()=>{r.value=await J0()});const s=A(()=>r.value?DC(r.value,e.resource.schema):null),i=A(()=>s.value?EC(e.resource,s.value):null),o=A(()=>s.value?$C(s.value.name):null),a=A(()=>e.resource.schema?e.resource.schema.name||e.resource.schema.url:null),l=A(()=>e.resource.extras["validation-report:errors"]||[]),c=A(()=>l.value.filter(f=>[""].includes(f.code))),u=A(()=>l.value.filter(f=>["#body","#cell","#content","#row","#table"].some(p=>f.tags.includes(p)))),d=A(()=>l.value.filter(f=>["#head","#structure","#header"].some(p=>f.tags.includes(p)))),h=A(()=>l.value.length===0?"ok":l.value.length===c.value.length?"warnings":"ko");return(f,p)=>a.value?(w(),S("span",tT,[P(Tp,{position:"right",noMargin:"",class:"relative z-2"},{toggletip:q(({close:m})=>[v("div",nT,[v("h5",rT,T(f.$t("Data schema")),1),v("button",{type:"button",onClick:m,title:y(t)("Close"),class:"border-left close-button flex items-center justify-center"},"×",8,sT)]),v("div",iT,[h.value==="ok"?(w(),S("div",oT,[U(T(y(t)("This file is valid for the shema:"))+" ",1),(w(),Y(Js(o.value?"a":"span"),{href:o.value,class:"fr-link fr-text--sm"},{default:q(()=>[U(T(a.value),1)]),_:1},8,["href"])),p[0]||(p[0]=U(". "))])):I("",!0),h.value==="warnings"?(w(),S("div",aT,[U(T(y(t)("This file is valid for the shema:"))+" ",1),(w(),Y(Js(o.value?"a":"span"),{href:o.value,class:"fr-link fr-text--sm"},{default:q(()=>[U(T(a.value),1)]),_:1},8,["href"])),U(". "+T(y(t)("But its compliance could be improved.")),1)])):I("",!0),h.value==="ko"?(w(),S("div",lT,[U(T(y(t)("This file indicates to follow the schema:"))+" ",1),(w(),Y(Js(o.value?"a":"span"),{href:o.value,class:"fr-link fr-text--sm"},{default:q(()=>[U(T(a.value),1)]),_:1},8,["href"])),U(". "+T(y(t)("But is not compliant.")),1)])):I("",!0),c.value.length?(w(),S("div",cT,[p[1]||(p[1]=v("span",{class:"fr-icon-alert-line fr-icon--sm fr-mr-1v"},null,-1)),v("span",null,T(c.value.length)+" "+T(y(t)("advices")),1)])):I("",!0),d.value.length?(w(),S("div",uT,[p[2]||(p[2]=v("span",{class:"fr-icon-alert-line fr-icon--sm fr-mr-1v"},null,-1)),v("span",null,T(d.value.length)+" "+T(y(t)("structure errors")),1)])):I("",!0),u.value.length?(w(),S("div",dT,[p[3]||(p[3]=v("span",{class:"fr-icon-alert-line fr-icon--sm fr-mr-1v"},null,-1)),v("span",null,T(u.value.length)+" "+T(y(t)("body errors")),1)])):I("",!0),i.value?(w(),S("div",hT,[v("a",{href:i.value},T(y(t)("See validation report")),9,fT)])):I("",!0)])]),_:1}),v("span",pT,T(y(t)("Schema:")),1),v("span",mT,[v("span",gT,T(a.value),1),h.value==="warnings"?(w(),S("span",yT,[p[4]||(p[4]=v("span",{class:"fr-icon-alert-line fr-icon--sm fr-mr-1v"},null,-1)),v("span",null,T(y(t)("Invalid")),1)])):I("",!0),h.value==="ko"?(w(),S("span",vT,[p[5]||(p[5]=v("span",{class:"fr-icon-error-line fr-icon--sm fr-mr-1v"},null,-1)),v("span",null,T(y(t)("Invalid")),1)])):I("",!0)])])):I("",!0)}}),wT=$e(bT,[["__scopeId","data-v-bf96ce2f"]]),_T={class:"fr-text--sm fr-ml-0 fr-mt-0 fr-mb-2w text-mention-grey h-4w fr-grid-row fr-grid-row--middle"},kT={key:0,class:"text-overflow-ellipsis"},ur=B({__name:"DescriptionDetails",props:{withEllipsis:{type:Boolean,default:!0}},setup(n){return(e,t)=>(w(),S("dd",_T,[e.withEllipsis?(w(),S("div",kT,[Ye(e.$slots,"default")])):Ye(e.$slots,"default",{key:1})]))}}),xT={},CT={class:"fr-my-0"};function ST(n,e){return w(),S("dl",CT,[Ye(n.$slots,"default")])}const Hd=$e(xT,[["render",ST]]),MT={},TT={class:"fr-text--sm fr-my-0 fr-text--bold"};function OT(n,e){return w(),S("dt",TT,[Ye(n.$slots,"default")])}const dr=$e(MT,[["render",OT]]),DT={class:"flex gap-3rem flex-col-on-small"},$T={class:"code"},ET=["href"],AT={class:"code"},PT=["href"],RT={class:"code"},NT={class:"code"},IT={class:"code text-overflow-ellipsis"},LT=B({__name:"Metadata",props:{resource:{}},setup(n){const e=n,t=A(()=>Object.keys(e.resource.extras).length),r=A(()=>Fb(e.resource)),{t:s}=Te();return(i,o)=>(w(),S("div",null,[v("div",DT,[P(Hd,{class:"flex-1"},{default:q(()=>[P(dr,null,{default:q(()=>[U(T(y(s)("URL"))+" ",1),P(Us,{label:i.$t("Copy URL"),"copied-label":i.$t("URL copied!"),text:i.resource.url,"aria-describedby":r.value},null,8,["label","copied-label","text","aria-describedby"])]),_:1}),P(ur,{"with-ellipsis":!1},{default:q(()=>[v("code",$T,[v("a",{href:i.resource.url},[P(y(Xt),{"max-lines":1,autoresize:!0,text:i.resource.url},null,8,["text"])],8,ET)])]),_:1}),P(dr,null,{default:q(()=>[U(T(y(s)("Stable URL"))+" ",1),P(Us,{label:i.$t("Copy stable URL"),"copied-label":i.$t("Stable URL copied!"),text:i.resource.latest,"aria-describedby":r.value},null,8,["label","copied-label","text","aria-describedby"])]),_:1}),P(ur,{"with-ellipsis":!1},{default:q(()=>[v("code",AT,[v("a",{href:i.resource.latest},[P(y(Xt),{"max-lines":1,autoresize:!0,text:i.resource.latest},null,8,["text"])],8,PT)])]),_:1}),P(dr,null,{default:q(()=>[U(T(y(s)("Identifier"))+" ",1),P(Us,{label:i.$t("Copy ID"),"copied-label":i.$t("ID copied!"),text:i.resource.id,"aria-describedby":r.value},null,8,["label","copied-label","text","aria-describedby"])]),_:1}),P(ur,{"with-ellipsis":!1},{default:q(()=>[v("code",RT,[P(y(Xt),{"max-lines":1,autoresize:!0,text:i.resource.id},null,8,["text"])])]),_:1}),i.resource.checksum?(w(),S(J,{key:0},[P(dr,null,{default:q(()=>[U(T(i.resource.checksum.type)+" ",1),P(Us,{label:i.$t("Copy checksum"),"copied-label":i.$t("Checksum copied!"),text:i.resource.checksum.value,"aria-describedby":r.value},null,8,["label","copied-label","text","aria-describedby"])]),_:1}),P(ur,{"with-ellipsis":!1},{default:q(()=>[v("code",NT,[P(y(Xt),{"max-lines":1,autoresize:!0,text:i.resource.checksum.value},null,8,["text"])])]),_:1})],64)):I("",!0)]),_:1}),P(Hd,{style:{"flex-shrink":"0"}},{default:q(()=>[P(dr,null,{default:q(()=>[U(T(y(s)("Created on")),1)]),_:1}),P(ur,null,{default:q(()=>[U(T(y(ps)(i.resource.created_at)),1)]),_:1}),P(dr,null,{default:q(()=>[U(T(y(s)("Modified on")),1)]),_:1}),P(ur,null,{default:q(()=>[U(T(y(ps)(i.resource.last_modified)),1)]),_:1})]),_:1}),P(Hd,{style:{"flex-shrink":"0"}},{default:q(()=>[i.resource.filesize?(w(),S(J,{key:0},[P(dr,null,{default:q(()=>[U(T(y(s)("Size")),1)]),_:1}),P(ur,null,{default:q(()=>[U(T(y(ec)(i.resource.filesize)),1)]),_:1})],64)):I("",!0),i.resource.mime?(w(),S(J,{key:1},[P(dr,null,{default:q(()=>[U(T(y(s)("Type")),1)]),_:1}),P(ur,null,{default:q(()=>[U(T(y(eC)(i.resource.type)),1)]),_:1})],64)):I("",!0),i.resource.mime?(w(),S(J,{key:2},[P(dr,null,{default:q(()=>[U(T(y(s)("MIME Type")),1)]),_:1}),P(ur,null,{default:q(()=>[v("code",IT,T(i.resource.mime),1)]),_:1})],64)):I("",!0)]),_:1})]),v("div",null,[t.value?(w(),Y(LM,{key:0,class:"fr-pt-3w fr-mt-3w border-top border-default-grey","button-text":y(s)("See extras"),"title-text":y(s)("Resource Extras"),"title-level":"h5",extra:i.resource.extras},null,8,["button-text","title-text","extra"])):I("",!0)])]))}}),zT=$e(LT,[["__scopeId","data-v-f2a0bf07"]]),BT=B({__name:"TabGroup",props:{size:{default:"md"}},setup(n){return(e,t)=>(w(),Y(y($3),{as:"div",class:ue({"tabs-sm":e.size==="sm"})},{default:q(()=>[Ye(e.$slots,"default")]),_:3},8,["class"]))}}),FT=B({__name:"TabList",setup(n){return(e,t)=>(w(),Y(y(E3),{class:"fr-segmented__elements"},{default:q(()=>[Ye(e.$slots,"default",{},void 0,!0)]),_:3}))}}),VT=$e(FT,[["__scopeId","data-v-999cc2d0"]]),HT={class:"inner"},WT=B({__name:"Tab",setup(n){return(e,t)=>(w(),Y(y(A3),{as:"template"},{default:q(({selected:r})=>[v("button",{class:ue(["fr-segmented__element",{selected:r}])},[v("div",HT,[Ye(e.$slots,"default",{},void 0,!0)])],2)]),_:3}))}}),jT=$e(WT,[["__scopeId","data-v-80aca752"]]),UT=B({__name:"TabPanels",setup(n){return(e,t)=>(w(),Y(y(P3),null,{default:q(()=>[Ye(e.$slots,"default")]),_:3}))}}),qT=B({__name:"TabPanel",setup(n){return(e,t)=>(w(),Y(y(R3),null,{default:q(()=>[Ye(e.$slots,"default")]),_:3}))}});function $o(n){var e;(e=globalThis._paq)==null||e.push(["trackEvent",...n])}const YT={class:"flex items-center fr-mb-1v"},KT=["id"],GT=["aria-expanded"],JT={class:"text-grey-380 subheaders-infos"},XT={class:"fr-text--xs fr-mb-0 dash-after"},QT={key:0,class:"fr-text--xs fr-mb-0 dash-after"},ZT={class:"hidden show-on-small"},eO={key:0},tO=["aria-label"],nO={class:"hidden show-on-small"},rO={key:0,class:"fr-mb-0 fr-mt-1v fr-text--xs text-grey-380"},sO=["href"],iO={class:"flex items-center fr-ml-4v buttons"},oO={key:0,class:"fr-col-auto fr-ml-3v fr-m-0 z-2"},aO=["href","title","aria-describedby"],lO={key:1,class:"fr-col-auto fr-ml-3v fr-m-0 z-2"},cO=["id","data-clipboard-text","aria-describedby"],uO={key:2,class:"fr-col-auto fr-ml-3v fr-m-0"},dO=["href","title","aria-describedby"],hO={class:"fr-sr-only"},fO={key:3,class:"fr-col-auto fr-ml-3v fr-m-0 z-2"},pO=["aria-labelledby"],mO={class:"fr-pl-4v fr-pr-4v fr-pb-4v"},gO={key:0},yO={key:1,class:"fr-pl-4v fr-pr-4v"},vO=["innerHTML"],bO={key:2,class:"fr-pl-4v fr-pr-4v"},wO={key:3,class:"fr-pl-4v fr-pr-4v"},_O={key:4,class:"fr-pl-4v fr-pr-4v"},kO={class:"fr-pl-0"},xO={key:0,class:"font-bold fr-text--sm fr-mb-0"},CO={key:1,class:"font-bold fr-text--sm fr-mb-0"},SO={class:"fr-text--sm fr-ml-0 fr-mt-0 fr-mb-2w text-mention-grey h-4w fr-grid-row fr-grid-row--middle"},MO={key:0},TO=["href"],OO={key:1},DO=["href"],$O={key:0},EO={class:"font-bold fr-text--sm fr-mb-0"},AO={class:"fr-text--sm fr-ml-0 fr-mt-0 fr-mb-2w text-mention-grey h-4w fr-grid-row fr-grid-row--middle"},PO=["href"],RO={key:0},NO={key:5,class:"fr-pl-4v fr-pr-4v"},IO=B({__name:"ResourceAccordion",props:{datasetId:{},expandedOnMount:{type:Boolean,default:!1},isCommunityResource:{type:Boolean,default:!1},resource:{},canEdit:{type:Boolean,default:!1}},setup(n){pp(HC,FC);const e=["ogc:wfs","ogc:wms","wfs","wms"],t=n,r=j0(()=>Fs(()=>import("./Swagger.6.2.3.js"),["js/Swagger.6.2.3.js","js/_commonjsHelpers.6.2.3.js","js/sentry.6.2.3.js"])),{t:s}=Te(),i=A(()=>vt.tabular_api_url&&t.resource.extras["analysis:parsing:finished_at"]&&!t.resource.extras["analysis:parsing:error"]&&(vt.tabular_allow_remote||t.resource.filetype==="file")),o=A(()=>Bb(t.resource)?t.resource.format:s("File")),a=A(()=>e.includes(t.resource.format)),l=$(t.expandedOnMount),c=()=>{l.value=!l.value,l.value?$o(["Open resource",t.resource.id]):$o(["Close resource",t.resource.id])},u=A(()=>{let x=[];return i.value&&x.push({key:"data",label:s("Data")}),t.resource.description&&x.push({key:"description",label:s("Description")}),i.value&&x.push({key:"data-structure",label:s("Data structure")}),x.push({key:"metadata",label:s("Metadata")}),x.push({key:"downloads",label:s("Downloads")}),i.value&&x.push({key:"swagger",label:s("Swagger")}),x}),d=x=>{const D=u.value[x];$o(["View resource tab",t.resource.id,D.label]),D.key==="data"&&$o(["Show preview",t.resource.id]),D.key==="data-structure"&&$o(["Show data structure",t.resource.id])},h=A(()=>t.isCommunityResource?t.resource:null),f=Gu(h.value),p=t.resource.last_modified,g=t.resource.extras&&"check:available"in t.resource.extras&&t.resource.extras["check:available"]===!1,b=g?s("The {certifier} robot failed to access this file - Download file as {format}",{certifier:vt.title,format:o.value}):s("Download file as {format}",{format:o.value}),_=A(()=>"".concat(window.location.origin).concat(window.location.pathname,"#/").concat(t.isCommunityResource?"community-resources":"resources","/").concat(t.resource.id)),M="resource-"+t.resource.id,k="resource-"+t.resource.id+"-header",C=Fb(t.resource);return(x,D)=>(w(),S("div",{class:ue(["border border-default-grey",{"fr-pb-4v":l.value}])},[v("header",{class:"fr-p-4v flex items-center justify-between relative",id:k},[v("div",null,[v("div",YT,[v("h4",{class:"fr-m-0",id:y(C)},[v("button",{type:"button",onClick:c,class:"fr-p-0 flex items-center","data-testid":"expand-button","aria-expanded":l.value},[P(eT,{resource:x.resource,class:"fr-icon--xs fr-mr-1v"},null,8,["resource"]),v("span",{class:ue({"font-bold":l.value})},[P(y(Xt),{"max-lines":1,text:x.resource.title||y(s)("Nameless file")},null,8,["text"])],2),D[0]||(D[0]=v("span",{class:"absolute inset-0 z-1"},null,-1))],8,GT)],8,KT),P(Us,{label:x.$t("Copy link"),"copied-label":x.$t("Link copied!"),text:_.value,class:"z-2"},null,8,["label","copied-label","text"])]),v("div",JT,[P(wT,{resource:x.resource,class:"dash-after"},null,8,["resource"]),v("span",XT,T(y(s)("Updated {date}",{date:y(Vu)(y(p))})),1),x.resource.format?(w(),S("span",QT,[v("span",ZT,T(y(s)("Format")),1),U(" "+T(x.resource.format.trim().toLowerCase())+" ",1),x.resource.filesize?(w(),S("span",eO,"("+T(y(ec)(x.resource.filesize))+")",1)):I("",!0)])):I("",!0),v("span",{class:"inline-flex items-center fr-text--xs fr-mb-0","aria-label":y(s)("{n} downloads",x.resource.metrics.views)},[D[1]||(D[1]=v("span",{class:"fr-icon-download-line fr-icon--xs fr-mr-1v"},null,-1)),v("span",null,[U(T(y(Ki)(x.resource.metrics.views))+" ",1),v("span",nO,T(y(s)("downloads")),1)])],8,tO)]),h.value?(w(),S("p",rO,[U(T(y(s)("From"))+" ",1),h.value.organization?(w(),S("a",{key:0,class:"fr-link fr-text--xs",href:h.value.organization.page},[P(li,{organization:h.value.organization},null,8,["organization"])],8,sO)):y(f)?(w(),S(J,{key:1},[U(T(y(f)),1)],64)):I("",!0)])):I("",!0)]),v("div",iO,[x.resource.format==="url"?(w(),S("p",oO,[v("a",{href:x.resource.latest,title:y(s)("File link - opens a new window"),"aria-describedby":y(C),rel:"ugc nofollow noopener",target:"_blank",class:"fr-btn fr-btn--sm"},T(x.$t("Visit")),9,aO)])):a.value?(w(),S("p",lO,[v("button",{id:x.resource.id+"-copy","data-clipboard-text":x.resource.url,"aria-describedby":y(C),class:"fr-btn fr-btn--sm"},[v("span",null,[P(y(Yi),{height:16,width:16,name:"ri-file-copy-line",class:"copy-icon fr-mr-2v"})]),U(" "+T(y(s)("Copy link")),1)],8,cO)])):(w(),S("p",uO,[v("a",{href:x.resource.latest,rel:"ugc nofollow noopener",title:y(b),download:"",class:"relative text-transform-uppercase fr-btn fr-btn--sm matomo_download z-2","aria-describedby":y(C)},[y(g)?(w(),Y(y(Yi),{key:0,height:16,width:16,name:"ri-file-warning-line",class:"fr-mr-2v"})):(w(),Y(y(Yi),{key:1,height:16,width:16,name:"ri-download-line",class:"fr-mr-2v"})),v("span",hO,T(y(s)("Download file as ")),1),U(T(o.value),1)],8,dO)])),x.canEdit?(w(),S("p",fO,[P(W4,{"dataset-id":x.datasetId,resource:x.resource,"is-community-resource":x.isCommunityResource},null,8,["dataset-id","resource","is-community-resource"])])):I("",!0),v("div",{class:ue(["fr-icon--sm fr-ml-4v",{"fr-icon-arrow-up-s-line":l.value,"fr-icon-arrow-down-s-line":!l.value}])},null,2)])]),l.value?(w(),S("section",{key:0,"aria-labelledby":y(C),id:M},[P(BT,{size:"sm",onChange:d},{default:q(()=>[v("div",mO,[P(VT,{style:{"max-width":"100%","overflow-y":"auto"}},{default:q(()=>[(w(!0),S(J,null,Fe(u.value,O=>(w(),Y(jT,{key:O.key},{default:q(()=>[U(T(O.label),1)]),_:2},1024))),128))]),_:1})]),P(UT,null,{default:q(()=>[(w(!0),S(J,null,Fe(u.value,O=>(w(),Y(qT,{key:O.key},{default:q(()=>[O.key==="data"?(w(),S("div",gO,[P(V4,{resource:x.resource},null,8,["resource"])])):I("",!0),O.key==="description"?(w(),S("div",yO,[v("div",{class:"fr-mt-0 markdown fr-text--sm text-mention-grey",innerHTML:y(tC)(x.resource.description||"")},null,8,vO)])):I("",!0),O.key==="data-structure"?(w(),S("div",bO,[i.value?(w(),Y(y4,{key:0,resource:x.resource},null,8,["resource"])):I("",!0)])):I("",!0),O.key==="metadata"?(w(),S("div",wO,[P(zT,{resource:x.resource},null,8,["resource"])])):I("",!0),O.key==="downloads"?(w(),S("div",_O,[v("dl",kO,[x.resource.format==="url"?(w(),S("dt",xO,T(x.$t("Original URL")),1)):(w(),S("dt",CO,T(x.$t("Original format")),1)),v("dd",SO,[x.resource.format==="url"?(w(),S("span",MO,[v("a",{href:x.resource.latest,class:"fr-link no-icon-after",rel:"ugc nofollow noopener",target:"_blank"},[P(y(Xt),{"auto-resize":!0,"max-lines":1,text:x.resource.url},{after:q(()=>D[2]||(D[2]=[v("span",{class:"fr-ml-1v fr-icon-external-link-line fr-icon--sm"},null,-1)])),_:1},8,["text"])],8,TO)])):(w(),S("span",OO,[D[3]||(D[3]=v("span",{class:"text-blue-400 fr-icon-download-line fr-icon--sm fr-mr-1v fr-mt-1v"},null,-1)),v("a",{href:x.resource.latest,class:"fr-link",rel:"ugc nofollow noopener"},[v("span",null,[U(T(x.$t("Format {format}",{format:x.resource.format})),1),x.resource.filesize?(w(),S("span",$O," - "+T(y(ec)(x.resource.filesize)),1)):I("",!0)])],8,DO)])),P(Us,{label:x.$t("Copy link"),"copied-label":x.$t("Link copied!"),text:x.resource.latest,class:"relative"},null,8,["label","copied-label","text"])]),x.resource.extras["analysis:parsing:parquet_url"]?(w(),S(J,{key:2},[v("dt",EO,T(x.$t("Auto-generated formats from {platform}",{platform:y(vt).title})),1),v("dd",AO,[v("span",null,[D[4]||(D[4]=v("span",{class:"text-blue-400 fr-icon-download-line fr-icon--sm fr-mr-1v fr-mt-1v"},null,-1)),v("a",{href:x.resource.extras["analysis:parsing:parquet_url"],class:"fr-link",rel:"ugc nofollow noopener"},[v("span",null,[U(T(x.$t("Format {format}",{format:"parquet"})),1),x.resource.extras["analysis:parsing:parquet_size"]?(w(),S("span",RO," - "+T(y(ec)(x.resource.extras["analysis:parsing:parquet_size"])),1)):I("",!0)])],8,PO)]),P(Us,{label:x.$t("Copy link"),"copied-label":x.$t("Link copied!"),text:x.resource.extras["analysis:parsing:parquet_url"],class:"relative"},null,8,["label","copied-label","text"])])],64)):I("",!0)])])):I("",!0),O.key==="swagger"?(w(),S("div",NO,[v("div",null,T(y(s)("Swagger automatically generated by data.gouv.fr. This swagger allows you to query data by API by filtering it by column value.")),1),i.value?(w(),Y(y(r),{key:0,url:"".concat(y(vt).tabular_api_url,"/api/resources/").concat(t.resource.id,"/swagger/")},null,8,["url"])):I("",!0)])):I("",!0)]),_:2},1024))),128))]),_:1})]),_:1})],8,pO)):I("",!0)],2))}}),Vb=$e(IO,[["__scopeId","data-v-1eb41db2"]]),LO=88,Hb=B({__name:"Loader",setup(n){return(e,t)=>(w(),Y(y(il),{width:1200,height:LO,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},{default:q(()=>t[0]||(t[0]=[v("rect",{x:"20",y:"24",rx:"4",ry:"4",width:"16",height:"16"},null,-1),v("rect",{x:"52",y:"20",rx:"4",ry:"4",width:"536",height:"22"},null,-1),v("rect",{x:"52",y:"52",rx:"4",ry:"4",width:"374",height:"16"},null,-1),v("rect",{x:"1052",y:"30",rx:"4",ry:"4",width:"80",height:"20"},null,-1),v("rect",{x:"1154",y:"20",rx:"20",ry:"20",width:"40",height:"40"},null,-1)])),_:1}))}});function zO(n){return{label:gb(async()=>{const t=at(n),r=await TC();return OC(r,t)},"")}}const BO={class:"fr-card fr-card--no-icon fr-enlarge-link"},FO={class:"fr-card__body"},VO={class:"fr-card__content fr-px-2w fr-py-1v"},HO={class:"fr-card__title fr-text--md fr-mt-1v fr-mb-0"},WO={class:"fr-card__desc fr-mt-0 text-mention-grey"},jO={class:"fr-text--sm fr-mb-0 flex"},UO={key:0,class:"not-enlarged"},qO={class:"dash-before-sm text-overflow-ellipsis"},YO={class:"fr-grid-row fr-grid-row--middle"},KO={class:"fr-text--sm fr-my-0 dash-after-sm"},GO=["aria-label"],JO=["aria-label"],XO={class:"fr-card__header"},QO={class:"fr-card__img"},ZO={key:0,class:"fr-badges-group"},e5={key:0},t5={class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380"},n5={key:1},r5={class:"fr-badge fr-badge--sm fr-badge--mention-grey text-grey-380"},s5=B({__name:"ReuseCard",props:{reuse:{},reuseUrl:{},organizationUrl:{}},setup(n){const e=n,{t}=Te(),r=Gu(e.reuse),{label:s}=zO(()=>e.reuse.type);return(i,o)=>(w(),S("article",BO,[v("div",FO,[v("div",VO,[v("h3",HO,[P(no,{class:"text-grey-500",to:i.reuseUrl},{default:q(()=>[P(y(Xt),{"auto-resize":!0,text:i.reuse.title,"max-lines":1},null,8,["text"])]),_:1},8,["to"])]),v("div",WO,[v("p",jO,[i.reuse.organization?(w(),S("span",UO,[i.organizationUrl?(w(),Y(no,{key:0,class:"fr-link",to:i.organizationUrl},{default:q(()=>[P(y(li),{organization:i.reuse.organization},null,8,["organization"])]),_:1},8,["to"])):(w(),Y(y(li),{key:1,organization:i.reuse.organization},null,8,["organization"]))])):(w(),Y(y(Xt),{key:1,class:"not-enlarged fr-mr-1v","auto-resize":!0,text:y(r),"max-lines":1},null,8,["text"])),v("span",qO,T(y(t)("published {date}",{date:y(Vu)(i.reuse.created_at)})),1)]),v("div",YO,[v("p",KO,T(y(s)),1),v("p",{class:"fr-text--sm fr-my-0","aria-label":y(t)("{n} views",i.reuse.metrics.views)},[o[0]||(o[0]=v("span",{class:"fr-icon-eye-line fr-icon--xs fr-px-1v","aria-hidden":"true"},null,-1)),U(T(y(Ki)(i.reuse.metrics.views)),1)],8,GO),v("p",{class:"fr-text--sm fr-my-0","aria-label":y(t)("{n} followers",i.reuse.metrics.followers)},[o[1]||(o[1]=v("span",{class:"fr-icon-star-line fr-icon--xs fr-px-1v","aria-hidden":"true"},null,-1)),U(T(y(Ki)(i.reuse.metrics.followers)),1)],8,JO)])])])]),v("div",XO,[v("div",QO,[P(Qh,{class:"fr-responsive-img reuse-ratio",alt:"",type:"reuse",src:i.reuse.image,size:320},null,8,["src"])]),i.reuse.private||i.reuse.archived?(w(),S("ul",ZO,[i.reuse.private?(w(),S("li",e5,[v("p",t5,[o[2]||(o[2]=v("span",{class:"fr-icon-lock-line fr-icon--xs"},null,-1)),U(" "+T(y(t)("Draft")),1)])])):I("",!0),i.reuse.archived?(w(),S("li",n5,[v("p",r5,[o[3]||(o[3]=v("span",{class:"fr-icon-lock-line fr-icon--xs"},null,-1)),U(" "+T(y(t)("Archived")),1)])])):I("",!0)])):I("",!0)])]))}}),i5=$e(s5,[["__scopeId","data-v-81c3bbfa"]]),nu=B({__name:"Well",props:{type:{default:"primary"},color:{default:"grey-100"},weight:{default:"semi-bold"}},setup(n){const e=n,t=A(()=>"well".concat(e.type==="primary"?"":"-"+e.type,"-").concat(e.color)),r=A(()=>"fr-text--".concat(e.weight)),s=A(()=>r.value+" "+t.value);return(i,o)=>(w(),S("div",{class:ue(["well",s.value])},[Ye(i.$slots,"default")],2))}});/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function hr(){}const o5=(()=>{let n=0;return()=>n++})();function Me(n){return n==null}function Ze(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Oe(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function lt(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function an(n,e){return lt(n)?n:e}function be(n,e){return typeof n>"u"?e:n}const a5=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,Wb=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function Je(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function je(n,e,t,r){let s,i,o;if(Ze(n))if(i=n.length,r)for(s=i-1;s>=0;s--)e.call(t,n[s],s);else for(s=0;s<i;s++)e.call(t,n[s],s);else if(Oe(n))for(o=Object.keys(n),i=o.length,s=0;s<i;s++)e.call(t,n[o[s]],o[s])}function ru(n,e){let t,r,s,i;if(!n||!e||n.length!==e.length)return!1;for(t=0,r=n.length;t<r;++t)if(s=n[t],i=e[t],s.datasetIndex!==i.datasetIndex||s.index!==i.index)return!1;return!0}function su(n){if(Ze(n))return n.map(su);if(Oe(n)){const e=Object.create(null),t=Object.keys(n),r=t.length;let s=0;for(;s<r;++s)e[t[s]]=su(n[t[s]]);return e}return n}function jb(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function l5(n,e,t,r){if(!jb(n))return;const s=e[n],i=t[n];Oe(s)&&Oe(i)?Na(s,i,r):e[n]=su(i)}function Na(n,e,t){const r=Ze(e)?e:[e],s=r.length;if(!Oe(n))return n;t=t||{};const i=t.merger||l5;let o;for(let a=0;a<s;++a){if(o=r[a],!Oe(o))continue;const l=Object.keys(o);for(let c=0,u=l.length;c<u;++c)i(l[c],n,o,t)}return n}function va(n,e){return Na(n,e,{merger:c5})}function c5(n,e,t){if(!jb(n))return;const r=e[n],s=t[n];Oe(r)&&Oe(s)?va(r,s):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=su(s))}const hy={"":n=>n,x:n=>n.x,y:n=>n.y};function u5(n){const e=n.split("."),t=[];let r="";for(const s of e)r+=s,r.endsWith("\\")?r=r.slice(0,-1)+".":(t.push(r),r="");return t}function d5(n){const e=u5(n);return t=>{for(const r of e){if(r==="")break;t=t&&t[r]}return t}}function ms(n,e){return(hy[e]||(hy[e]=d5(e)))(n)}function Op(n){return n.charAt(0).toUpperCase()+n.slice(1)}const Ia=n=>typeof n<"u",gs=n=>typeof n=="function",fy=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function h5(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const nt=Math.PI,tt=2*nt,f5=tt+nt,iu=Number.POSITIVE_INFINITY,p5=nt/180,ht=nt/2,Os=nt/4,py=nt*2/3,Zr=Math.log10,er=Math.sign;function ba(n,e,t){return Math.abs(n-e)<t}function my(n){const e=Math.round(n);n=ba(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(Zr(n))),r=n/t;return(r<=1?1:r<=2?2:r<=5?5:10)*t}function m5(n){const e=[],t=Math.sqrt(n);let r;for(r=1;r<t;r++)n%r===0&&(e.push(r),e.push(n/r));return t===(t|0)&&e.push(t),e.sort((s,i)=>s-i).pop(),e}function g5(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function ro(n){return!g5(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function y5(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function Ub(n,e,t){let r,s,i;for(r=0,s=n.length;r<s;r++)i=n[r][t],isNaN(i)||(e.min=Math.min(e.min,i),e.max=Math.max(e.max,i))}function Pn(n){return n*(nt/180)}function Dp(n){return n*(180/nt)}function gy(n){if(!lt(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function qb(n,e){const t=e.x-n.x,r=e.y-n.y,s=Math.sqrt(t*t+r*r);let i=Math.atan2(r,t);return i<-.5*nt&&(i+=tt),{angle:i,distance:s}}function nf(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function v5(n,e){return(n-e+f5)%tt-nt}function ln(n){return(n%tt+tt)%tt}function La(n,e,t,r){const s=ln(n),i=ln(e),o=ln(t),a=ln(i-s),l=ln(o-s),c=ln(s-i),u=ln(s-o);return s===i||s===o||r&&i===o||a>l&&c<u}function Mt(n,e,t){return Math.max(e,Math.min(t,n))}function b5(n){return Mt(n,-32768,32767)}function xr(n,e,t,r=1e-6){return n>=Math.min(e,t)-r&&n<=Math.max(e,t)+r}function $p(n,e,t){t=t||(o=>n[o]<e);let r=n.length-1,s=0,i;for(;r-s>1;)i=s+r>>1,t(i)?s=i:r=i;return{lo:s,hi:r}}const Cr=(n,e,t,r)=>$p(n,t,r?s=>{const i=n[s][e];return i<t||i===t&&n[s+1][e]===t}:s=>n[s][e]<t),w5=(n,e,t)=>$p(n,t,r=>n[r][e]>=t);function _5(n,e,t){let r=0,s=n.length;for(;r<s&&n[r]<e;)r++;for(;s>r&&n[s-1]>t;)s--;return r>0||s<n.length?n.slice(r,s):n}const Yb=["push","pop","shift","splice","unshift"];function k5(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),Yb.forEach(t=>{const r="_onData"+Op(t),s=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...i){const o=s.apply(this,i);return n._chartjs.listeners.forEach(a=>{typeof a[r]=="function"&&a[r](...i)}),o}})})}function yy(n,e){const t=n._chartjs;if(!t)return;const r=t.listeners,s=r.indexOf(e);s!==-1&&r.splice(s,1),!(r.length>0)&&(Yb.forEach(i=>{delete n[i]}),delete n._chartjs)}function Kb(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const Gb=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function Jb(n,e){let t=[],r=!1;return function(...s){t=s,r||(r=!0,Gb.call(window,()=>{r=!1,n.apply(e,t)}))}}function x5(n,e){let t;return function(...r){return e?(clearTimeout(t),t=setTimeout(n,e,r)):n.apply(this,r),e}}const Ep=n=>n==="start"?"left":n==="end"?"right":"center",Bt=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,C5=(n,e,t,r)=>n===(r?"left":"right")?t:n==="center"?(e+t)/2:e;function Xb(n,e,t){const r=e.length;let s=0,i=r;if(n._sorted){const{iScale:o,vScale:a,_parsed:l}=n,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,u=o.axis,{min:d,max:h,minDefined:f,maxDefined:p}=o.getUserBounds();if(f){if(s=Math.min(Cr(l,u,d).lo,t?r:Cr(e,u,o.getPixelForValue(d)).lo),c){const m=l.slice(0,s+1).reverse().findIndex(g=>!Me(g[a.axis]));s-=Math.max(0,m)}s=Mt(s,0,r-1)}if(p){let m=Math.max(Cr(l,o.axis,h,!0).hi+1,t?0:Cr(e,u,o.getPixelForValue(h),!0).hi+1);if(c){const g=l.slice(m-1).findIndex(b=>!Me(b[a.axis]));m+=Math.max(0,g)}i=Mt(m,s,r)-s}else i=r-s}return{start:s,count:i}}function Qb(n){const{xScale:e,yScale:t,_scaleRanges:r}=n,s={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!r)return n._scaleRanges=s,!0;const i=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==t.min||r.ymax!==t.max;return Object.assign(r,s),i}const Al=n=>n===0||n===1,vy=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*tt/t)),by=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*tt/t)+1,wa={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*ht)+1,easeOutSine:n=>Math.sin(n*ht),easeInOutSine:n=>-.5*(Math.cos(nt*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>Al(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>Al(n)?n:vy(n,.075,.3),easeOutElastic:n=>Al(n)?n:by(n,.075,.3),easeInOutElastic(n){return Al(n)?n:n<.5?.5*vy(n*2,.1125,.45):.5+.5*by(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-wa.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?wa.easeInBounce(n*2)*.5:wa.easeOutBounce(n*2-1)*.5+.5};function Ap(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function wy(n){return Ap(n)?n:new Y0(n)}function Wd(n){return Ap(n)?n:new Y0(n).saturate(.5).darken(.1).hexString()}const S5=["x","y","borderWidth","radius","tension"],M5=["color","borderColor","backgroundColor"];function T5(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:M5},numbers:{type:"number",properties:S5}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function O5(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const _y=new Map;function D5(n,e){e=e||{};const t=n+JSON.stringify(e);let r=_y.get(t);return r||(r=new Intl.NumberFormat(n,e),_y.set(t,r)),r}function al(n,e,t){return D5(e,t).format(n)}const Zb={values(n){return Ze(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const r=this.chart.options.locale;let s,i=n;if(t.length>1){const c=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(c<1e-4||c>1e15)&&(s="scientific"),i=$5(n,t)}const o=Zr(Math.abs(i)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:s,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),al(n,r,l)},logarithmic(n,e,t){if(n===0)return"0";const r=t[e].significand||n/Math.pow(10,Math.floor(Zr(n)));return[1,2,3,5,10,15].includes(r)||e>.8*t.length?Zb.numeric.call(this,n,e,t):""}};function $5(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var Ju={formatters:Zb};function E5(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Ju.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const fi=Object.create(null),rf=Object.create(null);function _a(n,e){if(!e)return n;const t=e.split(".");for(let r=0,s=t.length;r<s;++r){const i=t[r];n=n[i]||(n[i]=Object.create(null))}return n}function jd(n,e,t){return typeof e=="string"?Na(_a(n,e),t):Na(_a(n,""),e)}class A5{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,s)=>Wd(s.backgroundColor),this.hoverBorderColor=(r,s)=>Wd(s.borderColor),this.hoverColor=(r,s)=>Wd(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return jd(this,e,t)}get(e){return _a(this,e)}describe(e,t){return jd(rf,e,t)}override(e,t){return jd(fi,e,t)}route(e,t,r,s){const i=_a(this,e),o=_a(this,r),a="_"+t;Object.defineProperties(i,{[a]:{value:i[t],writable:!0},[t]:{enumerable:!0,get(){const l=this[a],c=o[s];return Oe(l)?Object.assign({},c,l):be(l,c)},set(l){this[a]=l}}})}apply(e){e.forEach(t=>t(this))}}var rt=new A5({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[T5,O5,E5]);function P5(n){return!n||Me(n.size)||Me(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function ou(n,e,t,r,s){let i=e[s];return i||(i=e[s]=n.measureText(s).width,t.push(s)),i>r&&(r=i),r}function R5(n,e,t,r){r=r||{};let s=r.data=r.data||{},i=r.garbageCollect=r.garbageCollect||[];r.font!==e&&(s=r.data={},i=r.garbageCollect=[],r.font=e),n.save(),n.font=e;let o=0;const a=t.length;let l,c,u,d,h;for(l=0;l<a;l++)if(d=t[l],d!=null&&!Ze(d))o=ou(n,s,i,o,d);else if(Ze(d))for(c=0,u=d.length;c<u;c++)h=d[c],h!=null&&!Ze(h)&&(o=ou(n,s,i,o,h));n.restore();const f=i.length/2;if(f>t.length){for(l=0;l<f;l++)delete s[i[l]];i.splice(0,f)}return o}function Ds(n,e,t){const r=n.currentDevicePixelRatio,s=t!==0?Math.max(t/2,.5):0;return Math.round((e-s)*r)/r+s}function ky(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function sf(n,e,t,r){ew(n,e,t,r,null)}function ew(n,e,t,r,s){let i,o,a,l,c,u,d,h;const f=e.pointStyle,p=e.rotation,m=e.radius;let g=(p||0)*p5;if(f&&typeof f=="object"&&(i=f.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){n.save(),n.translate(t,r),n.rotate(g),n.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),n.restore();return}if(!(isNaN(m)||m<=0)){switch(n.beginPath(),f){default:s?n.ellipse(t,r,s/2,m,0,0,tt):n.arc(t,r,m,0,tt),n.closePath();break;case"triangle":u=s?s/2:m,n.moveTo(t+Math.sin(g)*u,r-Math.cos(g)*m),g+=py,n.lineTo(t+Math.sin(g)*u,r-Math.cos(g)*m),g+=py,n.lineTo(t+Math.sin(g)*u,r-Math.cos(g)*m),n.closePath();break;case"rectRounded":c=m*.516,l=m-c,o=Math.cos(g+Os)*l,d=Math.cos(g+Os)*(s?s/2-c:l),a=Math.sin(g+Os)*l,h=Math.sin(g+Os)*(s?s/2-c:l),n.arc(t-d,r-a,c,g-nt,g-ht),n.arc(t+h,r-o,c,g-ht,g),n.arc(t+d,r+a,c,g,g+ht),n.arc(t-h,r+o,c,g+ht,g+nt),n.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*m,u=s?s/2:l,n.rect(t-u,r-l,2*u,2*l);break}g+=Os;case"rectRot":d=Math.cos(g)*(s?s/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(s?s/2:m),n.moveTo(t-d,r-a),n.lineTo(t+h,r-o),n.lineTo(t+d,r+a),n.lineTo(t-h,r+o),n.closePath();break;case"crossRot":g+=Os;case"cross":d=Math.cos(g)*(s?s/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(s?s/2:m),n.moveTo(t-d,r-a),n.lineTo(t+d,r+a),n.moveTo(t+h,r-o),n.lineTo(t-h,r+o);break;case"star":d=Math.cos(g)*(s?s/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(s?s/2:m),n.moveTo(t-d,r-a),n.lineTo(t+d,r+a),n.moveTo(t+h,r-o),n.lineTo(t-h,r+o),g+=Os,d=Math.cos(g)*(s?s/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(s?s/2:m),n.moveTo(t-d,r-a),n.lineTo(t+d,r+a),n.moveTo(t+h,r-o),n.lineTo(t-h,r+o);break;case"line":o=s?s/2:Math.cos(g)*m,a=Math.sin(g)*m,n.moveTo(t-o,r-a),n.lineTo(t+o,r+a);break;case"dash":n.moveTo(t,r),n.lineTo(t+Math.cos(g)*(s?s/2:m),r+Math.sin(g)*m);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function Sr(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function Xu(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function Qu(n){n.restore()}function N5(n,e,t,r,s){if(!e)return n.lineTo(t.x,t.y);if(s==="middle"){const i=(e.x+t.x)/2;n.lineTo(i,e.y),n.lineTo(i,t.y)}else s==="after"!=!!r?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function I5(n,e,t,r){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?t.cp2x:t.cp1x,r?t.cp2y:t.cp1y,t.x,t.y)}function L5(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),Me(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function z5(n,e,t,r,s){if(s.strikethrough||s.underline){const i=n.measureText(r),o=e-i.actualBoundingBoxLeft,a=e+i.actualBoundingBoxRight,l=t-i.actualBoundingBoxAscent,c=t+i.actualBoundingBoxDescent,u=s.strikethrough?(l+c)/2:c;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=s.decorationWidth||2,n.moveTo(o,u),n.lineTo(a,u),n.stroke()}}function B5(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function pi(n,e,t,r,s,i={}){const o=Ze(e)?e:[e],a=i.strokeWidth>0&&i.strokeColor!=="";let l,c;for(n.save(),n.font=s.string,L5(n,i),l=0;l<o.length;++l)c=o[l],i.backdrop&&B5(n,i.backdrop),a&&(i.strokeColor&&(n.strokeStyle=i.strokeColor),Me(i.strokeWidth)||(n.lineWidth=i.strokeWidth),n.strokeText(c,t,r,i.maxWidth)),n.fillText(c,t,r,i.maxWidth),z5(n,t,r,c,i),r+=Number(s.lineHeight);n.restore()}function za(n,e){const{x:t,y:r,w:s,h:i,radius:o}=e;n.arc(t+o.topLeft,r+o.topLeft,o.topLeft,1.5*nt,nt,!0),n.lineTo(t,r+i-o.bottomLeft),n.arc(t+o.bottomLeft,r+i-o.bottomLeft,o.bottomLeft,nt,ht,!0),n.lineTo(t+s-o.bottomRight,r+i),n.arc(t+s-o.bottomRight,r+i-o.bottomRight,o.bottomRight,ht,0,!0),n.lineTo(t+s,r+o.topRight),n.arc(t+s-o.topRight,r+o.topRight,o.topRight,0,-ht,!0),n.lineTo(t+o.topLeft,r)}const F5=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,V5=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function H5(n,e){const t=(""+n).match(F5);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const W5=n=>+n||0;function Pp(n,e){const t={},r=Oe(e),s=r?Object.keys(e):e,i=Oe(n)?r?o=>be(n[o],n[e[o]]):o=>n[o]:()=>n;for(const o of s)t[o]=W5(i(o));return t}function tw(n){return Pp(n,{top:"y",right:"x",bottom:"y",left:"x"})}function Xs(n){return Pp(n,["topLeft","topRight","bottomLeft","bottomRight"])}function jt(n){const e=tw(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function kt(n,e){n=n||{},e=e||rt.font;let t=be(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let r=be(n.style,e.style);r&&!(""+r).match(V5)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const s={family:be(n.family,e.family),lineHeight:H5(be(n.lineHeight,e.lineHeight),t),size:t,style:r,weight:be(n.weight,e.weight),string:""};return s.string=P5(s),s}function zo(n,e,t,r){let s=!0,i,o,a;for(i=0,o=n.length;i<o;++i)if(a=n[i],a!==void 0&&(e!==void 0&&typeof a=="function"&&(a=a(e),s=!1),t!==void 0&&Ze(a)&&(a=a[t%a.length],s=!1),a!==void 0))return r&&!s&&(r.cacheable=!1),a}function j5(n,e,t){const{min:r,max:s}=n,i=Wb(e,(s-r)/2),o=(a,l)=>t&&a===0?0:a+l;return{min:o(r,-Math.abs(i)),max:o(s,i)}}function _s(n,e){return Object.assign(Object.create(n),e)}function Rp(n,e=[""],t,r,s=()=>n[0]){const i=t||n;typeof r>"u"&&(r=iw("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:i,_fallback:r,_getTarget:s,override:a=>Rp([a,...n],e,i,r)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete n[0][l],!0},get(a,l){return rw(a,l,()=>Q5(l,e,n,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(a,l){return Cy(a).includes(l)},ownKeys(a){return Cy(a)},set(a,l,c){const u=a._storage||(a._storage=s());return a[l]=u[l]=c,delete a._keys,!0}})}function so(n,e,t,r){const s={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:nw(n,r),setContext:i=>so(n,i,t,r),override:i=>so(n.override(i),e,t,r)};return new Proxy(s,{deleteProperty(i,o){return delete i[o],delete n[o],!0},get(i,o,a){return rw(i,o,()=>q5(i,o,a))},getOwnPropertyDescriptor(i,o){return i._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(i,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(i,o,a){return n[o]=a,delete i[o],!0}})}function nw(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:r=e.indexable,_allKeys:s=e.allKeys}=n;return{allKeys:s,scriptable:t,indexable:r,isScriptable:gs(t)?t:()=>t,isIndexable:gs(r)?r:()=>r}}const U5=(n,e)=>n?n+Op(e):e,Np=(n,e)=>Oe(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function rw(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];const r=t();return n[e]=r,r}function q5(n,e,t){const{_proxy:r,_context:s,_subProxy:i,_descriptors:o}=n;let a=r[e];return gs(a)&&o.isScriptable(e)&&(a=Y5(e,a,n,t)),Ze(a)&&a.length&&(a=K5(e,a,n,o.isIndexable)),Np(e,a)&&(a=so(a,s,i&&i[e],o)),a}function Y5(n,e,t,r){const{_proxy:s,_context:i,_subProxy:o,_stack:a}=t;if(a.has(n))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+n);a.add(n);let l=e(i,o||r);return a.delete(n),Np(n,l)&&(l=Ip(s._scopes,s,n,l)),l}function K5(n,e,t,r){const{_proxy:s,_context:i,_subProxy:o,_descriptors:a}=t;if(typeof i.index<"u"&&r(n))return e[i.index%e.length];if(Oe(e[0])){const l=e,c=s._scopes.filter(u=>u!==l);e=[];for(const u of l){const d=Ip(c,s,n,u);e.push(so(d,i,o&&o[n],a))}}return e}function sw(n,e,t){return gs(n)?n(e,t):n}const G5=(n,e)=>n===!0?e:typeof n=="string"?ms(e,n):void 0;function J5(n,e,t,r,s){for(const i of e){const o=G5(t,i);if(o){n.add(o);const a=sw(o._fallback,t,s);if(typeof a<"u"&&a!==t&&a!==r)return a}else if(o===!1&&typeof r<"u"&&t!==r)return null}return!1}function Ip(n,e,t,r){const s=e._rootScopes,i=sw(e._fallback,t,r),o=[...n,...s],a=new Set;a.add(r);let l=xy(a,o,t,i||t,r);return l===null||typeof i<"u"&&i!==t&&(l=xy(a,o,i,l,r),l===null)?!1:Rp(Array.from(a),[""],s,i,()=>X5(e,t,r))}function xy(n,e,t,r,s){for(;t;)t=J5(n,e,t,r,s);return t}function X5(n,e,t){const r=n._getTarget();e in r||(r[e]={});const s=r[e];return Ze(s)&&Oe(t)?t:s||{}}function Q5(n,e,t,r){let s;for(const i of e)if(s=iw(U5(i,n),t),typeof s<"u")return Np(n,s)?Ip(t,r,n,s):s}function iw(n,e){for(const t of e){if(!t)continue;const r=t[n];if(typeof r<"u")return r}}function Cy(n){let e=n._keys;return e||(e=n._keys=Z5(n._scopes)),e}function Z5(n){const e=new Set;for(const t of n)for(const r of Object.keys(t).filter(s=>!s.startsWith("_")))e.add(r);return Array.from(e)}function ow(n,e,t,r){const{iScale:s}=n,{key:i="r"}=this._parsing,o=new Array(r);let a,l,c,u;for(a=0,l=r;a<l;++a)c=a+t,u=e[c],o[a]={r:s.parse(ms(u,i),c)};return o}const eD=Number.EPSILON||1e-14,io=(n,e)=>e<n.length&&!n[e].skip&&n[e],aw=n=>n==="x"?"y":"x";function tD(n,e,t,r){const s=n.skip?e:n,i=e,o=t.skip?e:t,a=nf(i,s),l=nf(o,i);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const d=r*c,h=r*u;return{previous:{x:i.x-d*(o.x-s.x),y:i.y-d*(o.y-s.y)},next:{x:i.x+h*(o.x-s.x),y:i.y+h*(o.y-s.y)}}}function nD(n,e,t){const r=n.length;let s,i,o,a,l,c=io(n,0);for(let u=0;u<r-1;++u)if(l=c,c=io(n,u+1),!(!l||!c)){if(ba(e[u],0,eD)){t[u]=t[u+1]=0;continue}s=t[u]/e[u],i=t[u+1]/e[u],a=Math.pow(s,2)+Math.pow(i,2),!(a<=9)&&(o=3/Math.sqrt(a),t[u]=s*o*e[u],t[u+1]=i*o*e[u])}}function rD(n,e,t="x"){const r=aw(t),s=n.length;let i,o,a,l=io(n,0);for(let c=0;c<s;++c){if(o=a,a=l,l=io(n,c+1),!a)continue;const u=a[t],d=a[r];o&&(i=(u-o[t])/3,a["cp1".concat(t)]=u-i,a["cp1".concat(r)]=d-i*e[c]),l&&(i=(l[t]-u)/3,a["cp2".concat(t)]=u+i,a["cp2".concat(r)]=d+i*e[c])}}function sD(n,e="x"){const t=aw(e),r=n.length,s=Array(r).fill(0),i=Array(r);let o,a,l,c=io(n,0);for(o=0;o<r;++o)if(a=l,l=c,c=io(n,o+1),!!l){if(c){const u=c[e]-l[e];s[o]=u!==0?(c[t]-l[t])/u:0}i[o]=a?c?er(s[o-1])!==er(s[o])?0:(s[o-1]+s[o])/2:s[o-1]:s[o]}nD(n,s,i),rD(n,i,e)}function Pl(n,e,t){return Math.max(Math.min(n,t),e)}function iD(n,e){let t,r,s,i,o,a=Sr(n[0],e);for(t=0,r=n.length;t<r;++t)o=i,i=a,a=t<r-1&&Sr(n[t+1],e),i&&(s=n[t],o&&(s.cp1x=Pl(s.cp1x,e.left,e.right),s.cp1y=Pl(s.cp1y,e.top,e.bottom)),a&&(s.cp2x=Pl(s.cp2x,e.left,e.right),s.cp2y=Pl(s.cp2y,e.top,e.bottom)))}function oD(n,e,t,r,s){let i,o,a,l;if(e.spanGaps&&(n=n.filter(c=>!c.skip)),e.cubicInterpolationMode==="monotone")sD(n,s);else{let c=r?n[n.length-1]:n[0];for(i=0,o=n.length;i<o;++i)a=n[i],l=tD(c,a,n[Math.min(i+1,o-(r?0:1))%o],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}e.capBezierPoints&&iD(n,t)}function Lp(){return typeof window<"u"&&typeof document<"u"}function zp(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function au(n,e,t){let r;return typeof n=="string"?(r=parseInt(n,10),n.indexOf("%")!==-1&&(r=r/100*e.parentNode[t])):r=n,r}const Zu=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function aD(n,e){return Zu(n).getPropertyValue(e)}const lD=["top","right","bottom","left"];function Qs(n,e,t){const r={};t=t?"-"+t:"";for(let s=0;s<4;s++){const i=lD[s];r[i]=parseFloat(n[e+"-"+i+t])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const cD=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function uD(n,e){const t=n.touches,r=t&&t.length?t[0]:n,{offsetX:s,offsetY:i}=r;let o=!1,a,l;if(cD(s,i,n.target))a=s,l=i;else{const c=e.getBoundingClientRect();a=r.clientX-c.left,l=r.clientY-c.top,o=!0}return{x:a,y:l,box:o}}function As(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:r}=e,s=Zu(t),i=s.boxSizing==="border-box",o=Qs(s,"padding"),a=Qs(s,"border","width"),{x:l,y:c,box:u}=uD(n,t),d=o.left+(u&&a.left),h=o.top+(u&&a.top);let{width:f,height:p}=e;return i&&(f-=o.width+a.width,p-=o.height+a.height),{x:Math.round((l-d)/f*t.width/r),y:Math.round((c-h)/p*t.height/r)}}function dD(n,e,t){let r,s;if(e===void 0||t===void 0){const i=n&&zp(n);if(!i)e=n.clientWidth,t=n.clientHeight;else{const o=i.getBoundingClientRect(),a=Zu(i),l=Qs(a,"border","width"),c=Qs(a,"padding");e=o.width-c.width-l.width,t=o.height-c.height-l.height,r=au(a.maxWidth,i,"clientWidth"),s=au(a.maxHeight,i,"clientHeight")}}return{width:e,height:t,maxWidth:r||iu,maxHeight:s||iu}}const Rl=n=>Math.round(n*10)/10;function hD(n,e,t,r){const s=Zu(n),i=Qs(s,"margin"),o=au(s.maxWidth,n,"clientWidth")||iu,a=au(s.maxHeight,n,"clientHeight")||iu,l=dD(n,e,t);let{width:c,height:u}=l;if(s.boxSizing==="content-box"){const h=Qs(s,"border","width"),f=Qs(s,"padding");c-=f.width+h.width,u-=f.height+h.height}return c=Math.max(0,c-i.width),u=Math.max(0,r?c/r:u-i.height),c=Rl(Math.min(c,o,l.maxWidth)),u=Rl(Math.min(u,a,l.maxHeight)),c&&!u&&(u=Rl(c/2)),(e!==void 0||t!==void 0)&&r&&l.height&&u>l.height&&(u=l.height,c=Rl(Math.floor(u*r))),{width:c,height:u}}function Sy(n,e,t){const r=e||1,s=Math.floor(n.height*r),i=Math.floor(n.width*r);n.height=Math.floor(n.height),n.width=Math.floor(n.width);const o=n.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height="".concat(n.height,"px"),o.style.width="".concat(n.width,"px")),n.currentDevicePixelRatio!==r||o.height!==s||o.width!==i?(n.currentDevicePixelRatio=r,o.height=s,o.width=i,n.ctx.setTransform(r,0,0,r,0,0),!0):!1}const fD=function(){let n=!1;try{const e={get passive(){return n=!0,!1}};Lp()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch(e){}return n}();function My(n,e){const t=aD(n,e),r=t&&t.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function Ps(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function pD(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:r==="middle"?t<.5?n.y:e.y:r==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function mD(n,e,t,r){const s={x:n.cp2x,y:n.cp2y},i={x:e.cp1x,y:e.cp1y},o=Ps(n,s,t),a=Ps(s,i,t),l=Ps(i,e,t),c=Ps(o,a,t),u=Ps(a,l,t);return Ps(c,u,t)}const gD=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,r){return t-r},leftForLtr(t,r){return t-r}}},yD=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function Gi(n,e,t){return n?gD(e,t):yD()}function lw(n,e){let t,r;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,r=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=r)}function cw(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function uw(n){return n==="angle"?{between:La,compare:v5,normalize:ln}:{between:xr,compare:(e,t)=>e-t,normalize:e=>e}}function Ty({start:n,end:e,count:t,loop:r,style:s}){return{start:n%t,end:e%t,loop:r&&(e-n+1)%t===0,style:s}}function vD(n,e,t){const{property:r,start:s,end:i}=t,{between:o,normalize:a}=uw(r),l=e.length;let{start:c,end:u,loop:d}=n,h,f;if(d){for(c+=l,u+=l,h=0,f=l;h<f&&o(a(e[c%l][r]),s,i);++h)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:d,style:n.style}}function dw(n,e,t){if(!t)return[n];const{property:r,start:s,end:i}=t,o=e.length,{compare:a,between:l,normalize:c}=uw(r),{start:u,end:d,loop:h,style:f}=vD(n,e,t),p=[];let m=!1,g=null,b,_,M;const k=()=>l(s,M,b)&&a(s,M)!==0,C=()=>a(i,b)===0||l(i,M,b),x=()=>m||k(),D=()=>!m||C();for(let O=u,E=u;O<=d;++O)_=e[O%o],!_.skip&&(b=c(_[r]),b!==M&&(m=l(b,s,i),g===null&&x()&&(g=a(b,s)===0?O:E),g!==null&&D()&&(p.push(Ty({start:g,end:O,loop:h,count:o,style:f})),g=null),E=O,M=b));return g!==null&&p.push(Ty({start:g,end:d,loop:h,count:o,style:f})),p}function hw(n,e){const t=[],r=n.segments;for(let s=0;s<r.length;s++){const i=dw(r[s],n.points,e);i.length&&t.push(...i)}return t}function bD(n,e,t,r){let s=0,i=e-1;if(t&&!r)for(;s<e&&!n[s].skip;)s++;for(;s<e&&n[s].skip;)s++;for(s%=e,t&&(i+=s);i>s&&n[i%e].skip;)i--;return i%=e,{start:s,end:i}}function wD(n,e,t,r){const s=n.length,i=[];let o=e,a=n[e],l;for(l=e+1;l<=t;++l){const c=n[l%s];c.skip||c.stop?a.skip||(r=!1,i.push({start:e%s,end:(l-1)%s,loop:r}),e=o=c.stop?l:null):(o=l,a.skip&&(e=l)),a=c}return o!==null&&i.push({start:e%s,end:o%s,loop:r}),i}function _D(n,e){const t=n.points,r=n.options.spanGaps,s=t.length;if(!s)return[];const i=!!n._loop,{start:o,end:a}=bD(t,s,i,r);if(r===!0)return Oy(n,[{start:o,end:a,loop:i}],t,e);const l=a<o?a+s:a,c=!!n._fullLoop&&o===0&&a===s-1;return Oy(n,wD(t,o,l,c),t,e)}function Oy(n,e,t,r){return!r||!r.setContext||!t?e:kD(n,e,t,r)}function kD(n,e,t,r){const s=n._chart.getContext(),i=Dy(n.options),{_datasetIndex:o,options:{spanGaps:a}}=n,l=t.length,c=[];let u=i,d=e[0].start,h=d;function f(p,m,g,b){const _=a?-1:1;if(p!==m){for(p+=l;t[p%l].skip;)p-=_;for(;t[m%l].skip;)m+=_;p%l!==m%l&&(c.push({start:p%l,end:m%l,loop:g,style:b}),u=b,d=m%l)}}for(const p of e){d=a?d:p.start;let m=t[d%l],g;for(h=d+1;h<=p.end;h++){const b=t[h%l];g=Dy(r.setContext(_s(s,{type:"segment",p0:m,p1:b,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:o}))),xD(g,u)&&f(d,h-1,p.loop,u),m=b,u=g}d<h-1&&f(d,h-1,p.loop,u)}return c}function Dy(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function xD(n,e){if(!e)return!1;const t=[],r=function(s,i){return Ap(i)?(t.includes(i)||t.push(i),t.indexOf(i)):i};return JSON.stringify(n,r)!==JSON.stringify(e,r)}function Nl(n,e,t){return n.options.clip?n[t]:e[t]}function CD(n,e){const{xScale:t,yScale:r}=n;return t&&r?{left:Nl(t,e,"left"),right:Nl(t,e,"right"),top:Nl(r,e,"top"),bottom:Nl(r,e,"bottom")}:e}function fw(n,e){const t=e._clip;if(t.disabled)return!1;const r=CD(e,n.chartArea);return{left:t.left===!1?0:r.left-(t.left===!0?0:t.left),right:t.right===!1?n.width:r.right+(t.right===!0?0:t.right),top:t.top===!1?0:r.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?n.height:r.bottom+(t.bottom===!0?0:t.bottom)}}/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class SD{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,r,s){const i=t.listeners[s],o=t.duration;i.forEach(a=>a({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(r-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=Gb.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((r,s)=>{if(!r.running||!r.items.length)return;const i=r.items;let o=i.length-1,a=!1,l;for(;o>=0;--o)l=i[o],l._active?(l._total>r.duration&&(r.duration=l._total),l.tick(e),a=!0):(i[o]=i[i.length-1],i.pop());a&&(s.draw(),this._notify(s,r,e,"progress")),i.length||(r.running=!1,this._notify(s,r,e,"complete"),r.initial=!1),t+=i.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let r=t.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,r)),r}listen(e,t,r){this._getAnims(e).listeners[t].push(r)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((r,s)=>Math.max(r,s._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const r=t.items;let s=r.length-1;for(;s>=0;--s)r[s].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var pr=new SD;const $y="transparent",MD={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const r=wy(n||$y),s=r.valid&&wy(e||$y);return s&&s.valid?s.mix(r,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class TD{constructor(e,t,r,s){const i=t[r];s=zo([e.to,s,i,e.from]);const o=zo([e.from,i,s]);this._active=!0,this._fn=e.fn||MD[e.type||typeof o],this._easing=wa[e.easing]||wa.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=r,this._from=o,this._to=s,this._promises=void 0}active(){return this._active}update(e,t,r){if(this._active){this._notify(!1);const s=this._target[this._prop],i=r-this._start,o=this._duration-i;this._start=r,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=zo([e.to,t,s,e.from]),this._from=zo([e.from,s,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,r=this._duration,s=this._prop,i=this._from,o=this._loop,a=this._to;let l;if(this._active=i!==a&&(o||t<r),!this._active){this._target[s]=a,this._notify(!0);return}if(t<0){this._target[s]=i;return}l=t/r%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[s]=this._fn(i,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,r)=>{e.push({res:t,rej:r})})}_notify(e){const t=e?"res":"rej",r=this._promises||[];for(let s=0;s<r.length;s++)r[s][t]()}}class pw{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!Oe(e))return;const t=Object.keys(rt.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(s=>{const i=e[s];if(!Oe(i))return;const o={};for(const a of t)o[a]=i[a];(Ze(i.properties)&&i.properties||[s]).forEach(a=>{(a===s||!r.has(a))&&r.set(a,o)})})}_animateOptions(e,t){const r=t.options,s=DD(e,r);if(!s)return[];const i=this._createAnimations(s,r);return r.$shared&&OD(e.options.$animations,r).then(()=>{e.options=r},()=>{}),i}_createAnimations(e,t){const r=this._properties,s=[],i=e.$animations||(e.$animations={}),o=Object.keys(t),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if(c.charAt(0)==="$")continue;if(c==="options"){s.push(...this._animateOptions(e,t));continue}const u=t[c];let d=i[c];const h=r.get(c);if(d)if(h&&d.active()){d.update(h,u,a);continue}else d.cancel();if(!h||!h.duration){e[c]=u;continue}i[c]=d=new TD(h,e,c,u),s.push(d)}return s}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const r=this._createAnimations(e,t);if(r.length)return pr.add(this._chart,r),!0}}function OD(n,e){const t=[],r=Object.keys(e);for(let s=0;s<r.length;s++){const i=n[r[s]];i&&i.active()&&t.push(i.wait())}return Promise.all(t)}function DD(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function Ey(n,e){const t=n&&n.options||{},r=t.reverse,s=t.min===void 0?e:0,i=t.max===void 0?e:0;return{start:r?i:s,end:r?s:i}}function $D(n,e,t){if(t===!1)return!1;const r=Ey(n,t),s=Ey(e,t);return{top:s.end,right:r.end,bottom:s.start,left:r.start}}function ED(n){let e,t,r,s;return Oe(n)?(e=n.top,t=n.right,r=n.bottom,s=n.left):e=t=r=s=n,{top:e,right:t,bottom:r,left:s,disabled:n===!1}}function mw(n,e){const t=[],r=n._getSortedDatasetMetas(e);let s,i;for(s=0,i=r.length;s<i;++s)t.push(r[s].index);return t}function Ay(n,e,t,r={}){const s=n.keys,i=r.mode==="single";let o,a,l,c;if(e===null)return;let u=!1;for(o=0,a=s.length;o<a;++o){if(l=+s[o],l===t){if(u=!0,r.all)continue;break}c=n.values[l],lt(c)&&(i||e===0||er(e)===er(c))&&(e+=c)}return!u&&!r.all?0:e}function AD(n,e){const{iScale:t,vScale:r}=e,s=t.axis==="x"?"x":"y",i=r.axis==="x"?"x":"y",o=Object.keys(n),a=new Array(o.length);let l,c,u;for(l=0,c=o.length;l<c;++l)u=o[l],a[l]={[s]:u,[i]:n[u]};return a}function Ud(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function PD(n,e,t){return"".concat(n.id,".").concat(e.id,".").concat(t.stack||t.type)}function RD(n){const{min:e,max:t,minDefined:r,maxDefined:s}=n.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:s?t:Number.POSITIVE_INFINITY}}function ND(n,e,t){const r=n[e]||(n[e]={});return r[t]||(r[t]={})}function Py(n,e,t,r){for(const s of e.getMatchingVisibleMetas(r).reverse()){const i=n[s.index];if(t&&i>0||!t&&i<0)return s.index}return null}function Ry(n,e){const{chart:t,_cachedMeta:r}=n,s=t._stacks||(t._stacks={}),{iScale:i,vScale:o,index:a}=r,l=i.axis,c=o.axis,u=PD(i,o,r),d=e.length;let h;for(let f=0;f<d;++f){const p=e[f],{[l]:m,[c]:g}=p,b=p._stacks||(p._stacks={});h=b[c]=ND(s,u,m),h[a]=g,h._top=Py(h,o,!0,r.type),h._bottom=Py(h,o,!1,r.type);const _=h._visualValues||(h._visualValues={});_[a]=g}}function qd(n,e){const t=n.scales;return Object.keys(t).filter(r=>t[r].axis===e).shift()}function ID(n,e){return _s(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function LD(n,e,t){return _s(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function Eo(n,e){const t=n.controller.index,r=n.vScale&&n.vScale.axis;if(r){e=e||n._parsed;for(const s of e){const i=s._stacks;if(!i||i[r]===void 0||i[r][t]===void 0)return;delete i[r][t],i[r]._visualValues!==void 0&&i[r]._visualValues[t]!==void 0&&delete i[r]._visualValues[t]}}}const Yd=n=>n==="reset"||n==="none",Ny=(n,e)=>e?n:Object.assign({},n),zD=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:mw(t,!0),values:null};class Rn{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Ud(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Eo(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,r=this.getDataset(),s=(d,h,f,p)=>d==="x"?h:d==="r"?p:f,i=t.xAxisID=be(r.xAxisID,qd(e,"x")),o=t.yAxisID=be(r.yAxisID,qd(e,"y")),a=t.rAxisID=be(r.rAxisID,qd(e,"r")),l=t.indexAxis,c=t.iAxisID=s(l,i,o,a),u=t.vAxisID=s(l,o,i,a);t.xScale=this.getScaleForId(i),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(a),t.iScale=this.getScaleForId(c),t.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&yy(this._data,this),e._stacked&&Eo(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),r=this._data;if(Oe(t)){const s=this._cachedMeta;this._data=AD(t,s)}else if(r!==t){if(r){yy(r,this);const s=this._cachedMeta;Eo(s),s._parsed=[]}t&&Object.isExtensible(t)&&k5(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,r=this.getDataset();let s=!1;this._dataCheck();const i=t._stacked;t._stacked=Ud(t.vScale,t),t.stack!==r.stack&&(s=!0,Eo(t),t.stack=r.stack),this._resyncElements(e),(s||i!==t._stacked)&&(Ry(this,t._parsed),t._stacked=Ud(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:r,_data:s}=this,{iScale:i,_stacked:o}=r,a=i.axis;let l=e===0&&t===s.length?!0:r._sorted,c=e>0&&r._parsed[e-1],u,d,h;if(this._parsing===!1)r._parsed=s,r._sorted=!0,h=s;else{Ze(s[e])?h=this.parseArrayData(r,s,e,t):Oe(s[e])?h=this.parseObjectData(r,s,e,t):h=this.parsePrimitiveData(r,s,e,t);const f=()=>d[a]===null||c&&d[a]<c[a];for(u=0;u<t;++u)r._parsed[u+e]=d=h[u],l&&(f()&&(l=!1),c=d);r._sorted=l}o&&Ry(this,h)}parsePrimitiveData(e,t,r,s){const{iScale:i,vScale:o}=e,a=i.axis,l=o.axis,c=i.getLabels(),u=i===o,d=new Array(s);let h,f,p;for(h=0,f=s;h<f;++h)p=h+r,d[h]={[a]:u||i.parse(c[p],p),[l]:o.parse(t[p],p)};return d}parseArrayData(e,t,r,s){const{xScale:i,yScale:o}=e,a=new Array(s);let l,c,u,d;for(l=0,c=s;l<c;++l)u=l+r,d=t[u],a[l]={x:i.parse(d[0],u),y:o.parse(d[1],u)};return a}parseObjectData(e,t,r,s){const{xScale:i,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(s);let u,d,h,f;for(u=0,d=s;u<d;++u)h=u+r,f=t[h],c[u]={x:i.parse(ms(f,a),h),y:o.parse(ms(f,l),h)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,r){const s=this.chart,i=this._cachedMeta,o=t[e.axis],a={keys:mw(s,!0),values:t._stacks[e.axis]._visualValues};return Ay(a,o,i.index,{mode:r})}updateRangeFromParsed(e,t,r,s){const i=r[t.axis];let o=i===null?NaN:i;const a=s&&r._stacks[t.axis];s&&a&&(s.values=a,o=Ay(s,i,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const r=this._cachedMeta,s=r._parsed,i=r._sorted&&e===r.iScale,o=s.length,a=this._getOtherScale(e),l=zD(t,r,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:d}=RD(a);let h,f;function p(){f=s[h];const m=f[a.axis];return!lt(f[e.axis])||u>m||d<m}for(h=0;h<o&&!(!p()&&(this.updateRangeFromParsed(c,e,f,l),i));++h);if(i){for(h=o-1;h>=0;--h)if(!p()){this.updateRangeFromParsed(c,e,f,l);break}}return c}getAllParsedValues(e){const t=this._cachedMeta._parsed,r=[];let s,i,o;for(s=0,i=t.length;s<i;++s)o=t[s][e.axis],lt(o)&&r.push(o);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,r=t.iScale,s=t.vScale,i=this.getParsed(e);return{label:r?""+r.getLabelForValue(i[r.axis]):"",value:s?""+s.getLabelForValue(i[s.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=ED(be(this.options.clip,$D(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,r=this._cachedMeta,s=r.data||[],i=t.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||s.length-a,c=this.options.drawActiveElementsOnTop;let u;for(r.dataset&&r.dataset.draw(e,i,a,l),u=a;u<a+l;++u){const d=s[u];d.hidden||(d.active&&c?o.push(d):d.draw(e,i))}for(u=0;u<o.length;++u)o[u].draw(e,i)}getStyle(e,t){const r=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,t,r){const s=this.getDataset();let i;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];i=o.$context||(o.$context=LD(this.getContext(),e,o)),i.parsed=this.getParsed(e),i.raw=s.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=ID(this.chart.getContext(),this.index)),i.dataset=s,i.index=i.datasetIndex=this.index;return i.active=!!t,i.mode=r,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",r){const s=t==="active",i=this._cachedDataOpts,o=e+"-"+t,a=i[o],l=this.enableOptionSharing&&Ia(r);if(a)return Ny(a,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,e),d=s?["".concat(e,"Hover"),"hover",e,""]:[e,""],h=c.getOptionScopes(this.getDataset(),u),f=Object.keys(rt.elements[e]),p=()=>this.getContext(r,s,t),m=c.resolveNamedOptions(h,f,p,d);return m.$shared&&(m.$shared=l,i[o]=Object.freeze(Ny(m,l))),m}_resolveAnimations(e,t,r){const s=this.chart,i=this._cachedDataOpts,o="animation-".concat(t),a=i[o];if(a)return a;let l;if(s.options.animation!==!1){const u=this.chart.config,d=u.datasetAnimationScopeKeys(this._type,t),h=u.getOptionScopes(this.getDataset(),d);l=u.createResolver(h,this.getContext(e,r,t))}const c=new pw(s,l&&l.animations);return l&&l._cacheable&&(i[o]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||Yd(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const r=this.resolveDataElementOptions(e,t),s=this._sharedOptions,i=this.getSharedOptions(r),o=this.includeOptions(t,i)||i!==s;return this.updateSharedOptions(i,t,r),{sharedOptions:i,includeOptions:o}}updateElement(e,t,r,s){Yd(s)?Object.assign(e,r):this._resolveAnimations(t,s).update(e,r)}updateSharedOptions(e,t,r){e&&!Yd(t)&&this._resolveAnimations(void 0,t).update(e,r)}_setStyle(e,t,r,s){e.active=s;const i=this.getStyle(t,s);this._resolveAnimations(t,r,s).update(e,{options:!s&&this.getSharedOptions(i)||i})}removeHoverStyle(e,t,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,t,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,r=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const s=r.length,i=t.length,o=Math.min(i,s);o&&this.parse(0,o),i>s?this._insertElements(s,i-s,e):i<s&&this._removeElements(i,s-i)}_insertElements(e,t,r=!0){const s=this._cachedMeta,i=s.data,o=e+t;let a;const l=c=>{for(c.length+=t,a=c.length-1;a>=o;a--)c[a]=c[a-t]};for(l(i),a=e;a<o;++a)i[a]=new this.dataElementType;this._parsing&&l(s._parsed),this.parse(e,t),r&&this.updateElements(i,e,t,"reset")}updateElements(e,t,r,s){}_removeElements(e,t){const r=this._cachedMeta;if(this._parsing){const s=r._parsed.splice(e,t);r._stacked&&Eo(r,s)}r.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,r,s]=e;this[t](r,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}G(Rn,"defaults",{}),G(Rn,"datasetElementType",null),G(Rn,"dataElementType",null);function BD(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let r=[];for(let s=0,i=t.length;s<i;s++)r=r.concat(t[s].controller.getAllParsedValues(n));n._cache.$bar=Kb(r.sort((s,i)=>s-i))}return n._cache.$bar}function FD(n){const e=n.iScale,t=BD(e,n.type);let r=e._length,s,i,o,a;const l=()=>{o===32767||o===-32768||(Ia(a)&&(r=Math.min(r,Math.abs(o-a)||r)),a=o)};for(s=0,i=t.length;s<i;++s)o=e.getPixelForValue(t[s]),l();for(a=void 0,s=0,i=e.ticks.length;s<i;++s)o=e.getPixelForTick(s),l();return r}function VD(n,e,t,r){const s=t.barThickness;let i,o;return Me(s)?(i=e.min*t.categoryPercentage,o=t.barPercentage):(i=s*r,o=1),{chunk:i/r,ratio:o,start:e.pixels[n]-i/2}}function HD(n,e,t,r){const s=e.pixels,i=s[n];let o=n>0?s[n-1]:null,a=n<s.length-1?s[n+1]:null;const l=t.categoryPercentage;o===null&&(o=i-(a===null?e.end-e.start:a-i)),a===null&&(a=i+i-o);const c=i-(i-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/r,ratio:t.barPercentage,start:c}}function WD(n,e,t,r){const s=t.parse(n[0],r),i=t.parse(n[1],r),o=Math.min(s,i),a=Math.max(s,i);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),e[t.axis]=c,e._custom={barStart:l,barEnd:c,start:s,end:i,min:o,max:a}}function gw(n,e,t,r){return Ze(n)?WD(n,e,t,r):e[t.axis]=t.parse(n,r),e}function Iy(n,e,t,r){const s=n.iScale,i=n.vScale,o=s.getLabels(),a=s===i,l=[];let c,u,d,h;for(c=t,u=t+r;c<u;++c)h=e[c],d={},d[s.axis]=a||s.parse(o[c],c),l.push(gw(h,d,i,c));return l}function Kd(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function jD(n,e,t){return n!==0?er(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function UD(n){let e,t,r,s,i;return n.horizontal?(e=n.base>n.x,t="left",r="right"):(e=n.base<n.y,t="bottom",r="top"),e?(s="end",i="start"):(s="start",i="end"),{start:t,end:r,reverse:e,top:s,bottom:i}}function qD(n,e,t,r){let s=e.borderSkipped;const i={};if(!s){n.borderSkipped=i;return}if(s===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:c,bottom:u}=UD(n);s==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===r?s=c:(t._bottom||0)===r?s=u:(i[Ly(u,o,a,l)]=!0,s=c)),i[Ly(s,o,a,l)]=!0,n.borderSkipped=i}function Ly(n,e,t,r){return r?(n=YD(n,e,t),n=zy(n,t,e)):n=zy(n,e,t),n}function YD(n,e,t){return n===e?t:n===t?e:n}function zy(n,e,t){return n==="start"?e:n==="end"?t:n}function KD(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class nc extends Rn{parsePrimitiveData(e,t,r,s){return Iy(e,t,r,s)}parseArrayData(e,t,r,s){return Iy(e,t,r,s)}parseObjectData(e,t,r,s){const{iScale:i,vScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=i.axis==="x"?a:l,u=o.axis==="x"?a:l,d=[];let h,f,p,m;for(h=r,f=r+s;h<f;++h)m=t[h],p={},p[i.axis]=i.parse(ms(m,c),h),d.push(gw(ms(m,u),p,o,h));return d}updateRangeFromParsed(e,t,r,s){super.updateRangeFromParsed(e,t,r,s);const i=r._custom;i&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,i.min),e.max=Math.max(e.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:r,vScale:s}=t,i=this.getParsed(e),o=i._custom,a=Kd(o)?"["+o.start+", "+o.end+"]":""+s.getLabelForValue(i[s.axis]);return{label:""+r.getLabelForValue(i[r.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,r,s){const i=s==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),u=this._getRuler(),{sharedOptions:d,includeOptions:h}=this._getSharedOptions(t,s);for(let f=t;f<t+r;f++){const p=this.getParsed(f),m=i||Me(p[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(f),g=this._calculateBarIndexPixels(f,u),b=(p._stacks||{})[a.axis],_={horizontal:c,base:m.base,enableBorderRadius:!b||Kd(p._custom)||o===b._top||o===b._bottom,x:c?m.head:g.center,y:c?g.center:m.head,height:c?g.size:Math.abs(m.size),width:c?Math.abs(m.size):g.size};h&&(_.options=d||this.resolveDataElementOptions(f,e[f].active?"active":s));const M=_.options||e[f].options;qD(_,M,b,o),KD(_,M,u.ratio),this.updateElement(e[f],f,_,s)}}_getStacks(e,t){const{iScale:r}=this._cachedMeta,s=r.getMatchingVisibleMetas(this._type).filter(u=>u.controller.options.grouped),i=r.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(t),l=a&&a[r.axis],c=u=>{const d=u._parsed.find(f=>f[r.axis]===l),h=d&&d[u.vScale.axis];if(Me(h)||isNaN(h))return!0};for(const u of s)if(!(t!==void 0&&c(u))&&((i===!1||o.indexOf(u.stack)===-1||i===void 0&&u.stack===void 0)&&o.push(u.stack),u.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,r){const s=this._getStacks(e,r),i=t!==void 0?s.indexOf(t):-1;return i===-1?s.length-1:i}_getRuler(){const e=this.options,t=this._cachedMeta,r=t.iScale,s=[];let i,o;for(i=0,o=t.data.length;i<o;++i)s.push(r.getPixelForValue(this.getParsed(i)[r.axis],i));const a=e.barThickness;return{min:a||FD(t),pixels:s,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:a?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:r,index:s},options:{base:i,minBarLength:o}}=this,a=i||0,l=this.getParsed(e),c=l._custom,u=Kd(c);let d=l[t.axis],h=0,f=r?this.applyStack(t,l,r):d,p,m;f!==d&&(h=f-d,f=d),u&&(d=c.barStart,f=c.barEnd-c.barStart,d!==0&&er(d)!==er(c.barEnd)&&(h=0),h+=d);const g=!Me(i)&&!u?i:h;let b=t.getPixelForValue(g);if(this.chart.getDataVisibility(e)?p=t.getPixelForValue(h+f):p=b,m=p-b,Math.abs(m)<o){m=jD(m,t,a)*o,d===a&&(b-=m/2);const _=t.getPixelForDecimal(0),M=t.getPixelForDecimal(1),k=Math.min(_,M),C=Math.max(_,M);b=Math.max(Math.min(b,C),k),p=b+m,r&&!u&&(l._stacks[t.axis]._visualValues[s]=t.getValueForPixel(p)-t.getValueForPixel(b))}if(b===t.getPixelForValue(a)){const _=er(m)*t.getLineWidthForValue(a)/2;b+=_,m-=_}return{size:m,base:b,head:p,center:p+m/2}}_calculateBarIndexPixels(e,t){const r=t.scale,s=this.options,i=s.skipNull,o=be(s.maxBarThickness,1/0);let a,l;if(t.grouped){const c=i?this._getStackCount(e):t.stackCount,u=s.barThickness==="flex"?HD(e,t,s,c):VD(e,t,s,c),d=this._getStackIndex(this.index,this._cachedMeta.stack,i?e:void 0);a=u.start+u.chunk*d+u.chunk/2,l=Math.min(o,u.chunk*u.ratio)}else a=r.getPixelForValue(this.getParsed(e)[r.axis],e),l=Math.min(o,t.min*t.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this._cachedMeta,t=e.vScale,r=e.data,s=r.length;let i=0;for(;i<s;++i)this.getParsed(i)[t.axis]!==null&&!r[i].hidden&&r[i].draw(this._ctx)}}G(nc,"id","bar"),G(nc,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),G(nc,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class rc extends Rn{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,r,s){const i=super.parsePrimitiveData(e,t,r,s);for(let o=0;o<i.length;o++)i[o]._custom=this.resolveDataElementOptions(o+r).radius;return i}parseArrayData(e,t,r,s){const i=super.parseArrayData(e,t,r,s);for(let o=0;o<i.length;o++){const a=t[r+o];i[o]._custom=be(a[2],this.resolveDataElementOptions(o+r).radius)}return i}parseObjectData(e,t,r,s){const i=super.parseObjectData(e,t,r,s);for(let o=0;o<i.length;o++){const a=t[r+o];i[o]._custom=be(a&&a.r&&+a.r,this.resolveDataElementOptions(o+r).radius)}return i}getMaxOverflow(){const e=this._cachedMeta.data;let t=0;for(let r=e.length-1;r>=0;--r)t=Math.max(t,e[r].size(this.resolveDataElementOptions(r))/2);return t>0&&t}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart.data.labels||[],{xScale:s,yScale:i}=t,o=this.getParsed(e),a=s.getLabelForValue(o.x),l=i.getLabelForValue(o.y),c=o._custom;return{label:r[e]||"",value:"("+a+", "+l+(c?", "+c:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(e,t,r,s){const i=s==="reset",{iScale:o,vScale:a}=this._cachedMeta,{sharedOptions:l,includeOptions:c}=this._getSharedOptions(t,s),u=o.axis,d=a.axis;for(let h=t;h<t+r;h++){const f=e[h],p=!i&&this.getParsed(h),m={},g=m[u]=i?o.getPixelForDecimal(.5):o.getPixelForValue(p[u]),b=m[d]=i?a.getBasePixel():a.getPixelForValue(p[d]);m.skip=isNaN(g)||isNaN(b),c&&(m.options=l||this.resolveDataElementOptions(h,f.active?"active":s),i&&(m.options.radius=0)),this.updateElement(f,h,m,s)}}resolveDataElementOptions(e,t){const r=this.getParsed(e);let s=super.resolveDataElementOptions(e,t);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const i=s.radius;return t!=="active"&&(s.radius=0),s.radius+=be(r&&r._custom,i),s}}G(rc,"id","bubble"),G(rc,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),G(rc,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function GD(n,e,t){let r=1,s=1,i=0,o=0;if(e<tt){const a=n,l=a+e,c=Math.cos(a),u=Math.sin(a),d=Math.cos(l),h=Math.sin(l),f=(M,k,C)=>La(M,a,l,!0)?1:Math.max(k,k*t,C,C*t),p=(M,k,C)=>La(M,a,l,!0)?-1:Math.min(k,k*t,C,C*t),m=f(0,c,d),g=f(ht,u,h),b=p(nt,c,d),_=p(nt+ht,u,h);r=(m-b)/2,s=(g-_)/2,i=-(m+b)/2,o=-(g+_)/2}return{ratioX:r,ratioY:s,offsetX:i,offsetY:o}}class Ys extends Rn{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const r=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=r;else{let i=l=>+r[l];if(Oe(r[e])){const{key:l="value"}=this._parsing;i=c=>+ms(r[c],l)}let o,a;for(o=e,a=e+t;o<a;++o)s._parsed[o]=i(o)}}_getRotation(){return Pn(this.options.rotation-90)}_getCircumference(){return Pn(this.options.circumference)}_getRotationExtents(){let e=tt,t=-tt;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const s=this.chart.getDatasetMeta(r).controller,i=s._getRotation(),o=s._getCircumference();e=Math.min(e,i),t=Math.max(t,i+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:r}=t,s=this._cachedMeta,i=s.data,o=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,a=Math.max((Math.min(r.width,r.height)-o)/2,0),l=Math.min(a5(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:u,rotation:d}=this._getRotationExtents(),{ratioX:h,ratioY:f,offsetX:p,offsetY:m}=GD(d,u,l),g=(r.width-o)/h,b=(r.height-o)/f,_=Math.max(Math.min(g,b)/2,0),M=Wb(this.options.radius,_),k=Math.max(M*l,0),C=(M-k)/this._getVisibleDatasetWeightTotal();this.offsetX=p*M,this.offsetY=m*M,s.total=this.calculateTotal(),this.outerRadius=M-C*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-C*c,0),this.updateElements(i,0,i.length,e)}_circumference(e,t){const r=this.options,s=this._cachedMeta,i=this._getCircumference();return t&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||s._parsed[e]===null||s.data[e].hidden?0:this.calculateCircumference(s._parsed[e]*i/tt)}updateElements(e,t,r,s){const i=s==="reset",o=this.chart,a=o.chartArea,c=o.options.animation,u=(a.left+a.right)/2,d=(a.top+a.bottom)/2,h=i&&c.animateScale,f=h?0:this.innerRadius,p=h?0:this.outerRadius,{sharedOptions:m,includeOptions:g}=this._getSharedOptions(t,s);let b=this._getRotation(),_;for(_=0;_<t;++_)b+=this._circumference(_,i);for(_=t;_<t+r;++_){const M=this._circumference(_,i),k=e[_],C={x:u+this.offsetX,y:d+this.offsetY,startAngle:b,endAngle:b+M,circumference:M,outerRadius:p,innerRadius:f};g&&(C.options=m||this.resolveDataElementOptions(_,k.active?"active":s)),b+=M,this.updateElement(k,_,C,s)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let r=0,s;for(s=0;s<t.length;s++){const i=e._parsed[s];i!==null&&!isNaN(i)&&this.chart.getDataVisibility(s)&&!t[s].hidden&&(r+=Math.abs(i))}return r}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?tt*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart,s=r.data.labels||[],i=al(t._parsed[e],r.options.locale);return{label:s[e]||"",value:i}}getMaxBorderWidth(e){let t=0;const r=this.chart;let s,i,o,a,l;if(!e){for(s=0,i=r.data.datasets.length;s<i;++s)if(r.isDatasetVisible(s)){o=r.getDatasetMeta(s),e=o.data,a=o.controller;break}}if(!e)return 0;for(s=0,i=e.length;s<i;++s)l=a.resolveDataElementOptions(s),l.borderAlign!=="inner"&&(t=Math.max(t,l.borderWidth||0,l.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let r=0,s=e.length;r<s;++r){const i=this.resolveDataElementOptions(r);t=Math.max(t,i.offset||0,i.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(t+=this._getRingWeight(r));return t}_getRingWeight(e){return Math.max(be(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}G(Ys,"id","doughnut"),G(Ys,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),G(Ys,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),G(Ys,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:r,color:s}}=e.legend.options;return t.labels.map((i,o)=>{const l=e.getDatasetMeta(0).controller.getStyle(o);return{text:i,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:s,lineWidth:l.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,t,r){r.chart.toggleDataVisibility(t.index),r.chart.update()}}}});class sc extends Rn{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:r,data:s=[],_dataset:i}=t,o=this.chart._animationsDisabled;let{start:a,count:l}=Xb(t,s,o);this._drawStart=a,this._drawCount=l,Qb(t)&&(a=0,l=s.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!i._decimated,r.points=s;const c=this.resolveDatasetElementOptions(e);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(r,void 0,{animated:!o,options:c},e),this.updateElements(s,a,l,e)}updateElements(e,t,r,s){const i=s==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:d}=this._getSharedOptions(t,s),h=o.axis,f=a.axis,{spanGaps:p,segment:m}=this.options,g=ro(p)?p:Number.POSITIVE_INFINITY,b=this.chart._animationsDisabled||i||s==="none",_=t+r,M=e.length;let k=t>0&&this.getParsed(t-1);for(let C=0;C<M;++C){const x=e[C],D=b?x:{};if(C<t||C>=_){D.skip=!0;continue}const O=this.getParsed(C),E=Me(O[f]),R=D[h]=o.getPixelForValue(O[h],C),W=D[f]=i||E?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,O,l):O[f],C);D.skip=isNaN(R)||isNaN(W)||E,D.stop=C>0&&Math.abs(O[h]-k[h])>g,m&&(D.parsed=O,D.raw=c.data[C]),d&&(D.options=u||this.resolveDataElementOptions(C,x.active?"active":s)),b||this.updateElement(x,C,D,s),k=O}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,r=t.options&&t.options.borderWidth||0,s=e.data||[];if(!s.length)return r;const i=s[0].size(this.resolveDataElementOptions(0)),o=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(r,i,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}G(sc,"id","line"),G(sc,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),G(sc,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class ka extends Rn{constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart,s=r.data.labels||[],i=al(t._parsed[e].r,r.options.locale);return{label:s[e]||"",value:i}}parseObjectData(e,t,r,s){return ow.bind(this)(e,t,r,s)}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){const e=this._cachedMeta,t={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((r,s)=>{const i=this.getParsed(s).r;!isNaN(i)&&this.chart.getDataVisibility(s)&&(i<t.min&&(t.min=i),i>t.max&&(t.max=i))}),t}_updateRadius(){const e=this.chart,t=e.chartArea,r=e.options,s=Math.min(t.right-t.left,t.bottom-t.top),i=Math.max(s/2,0),o=Math.max(r.cutoutPercentage?i/100*r.cutoutPercentage:1,0),a=(i-o)/e.getVisibleDatasetCount();this.outerRadius=i-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(e,t,r,s){const i=s==="reset",o=this.chart,l=o.options.animation,c=this._cachedMeta.rScale,u=c.xCenter,d=c.yCenter,h=c.getIndexAngle(0)-.5*nt;let f=h,p;const m=360/this.countVisibleElements();for(p=0;p<t;++p)f+=this._computeAngle(p,s,m);for(p=t;p<t+r;p++){const g=e[p];let b=f,_=f+this._computeAngle(p,s,m),M=o.getDataVisibility(p)?c.getDistanceFromCenterForValue(this.getParsed(p).r):0;f=_,i&&(l.animateScale&&(M=0),l.animateRotate&&(b=_=h));const k={x:u,y:d,innerRadius:0,outerRadius:M,startAngle:b,endAngle:_,options:this.resolveDataElementOptions(p,g.active?"active":s)};this.updateElement(g,p,k,s)}}countVisibleElements(){const e=this._cachedMeta;let t=0;return e.data.forEach((r,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&t++}),t}_computeAngle(e,t,r){return this.chart.getDataVisibility(e)?Pn(this.resolveDataElementOptions(e,t).angle||r):0}}G(ka,"id","polarArea"),G(ka,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),G(ka,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:r,color:s}}=e.legend.options;return t.labels.map((i,o)=>{const l=e.getDatasetMeta(0).controller.getStyle(o);return{text:i,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:s,lineWidth:l.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,t,r){r.chart.toggleDataVisibility(t.index),r.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class of extends Ys{}G(of,"id","pie"),G(of,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class ic extends Rn{getLabelAndValue(e){const t=this._cachedMeta.vScale,r=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(r[t.axis])}}parseObjectData(e,t,r,s){return ow.bind(this)(e,t,r,s)}update(e){const t=this._cachedMeta,r=t.dataset,s=t.data||[],i=t.iScale.getLabels();if(r.points=s,e!=="resize"){const o=this.resolveDatasetElementOptions(e);this.options.showLine||(o.borderWidth=0);const a={_loop:!0,_fullLoop:i.length===s.length,options:o};this.updateElement(r,void 0,a,e)}this.updateElements(s,0,s.length,e)}updateElements(e,t,r,s){const i=this._cachedMeta.rScale,o=s==="reset";for(let a=t;a<t+r;a++){const l=e[a],c=this.resolveDataElementOptions(a,l.active?"active":s),u=i.getPointPositionForValue(a,this.getParsed(a).r),d=o?i.xCenter:u.x,h=o?i.yCenter:u.y,f={x:d,y:h,angle:u.angle,skip:isNaN(d)||isNaN(h),options:c};this.updateElement(l,a,f,s)}}}G(ic,"id","radar"),G(ic,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),G(ic,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class oc extends Rn{getLabelAndValue(e){const t=this._cachedMeta,r=this.chart.data.labels||[],{xScale:s,yScale:i}=t,o=this.getParsed(e),a=s.getLabelForValue(o.x),l=i.getLabelForValue(o.y);return{label:r[e]||"",value:"("+a+", "+l+")"}}update(e){const t=this._cachedMeta,{data:r=[]}=t,s=this.chart._animationsDisabled;let{start:i,count:o}=Xb(t,r,s);if(this._drawStart=i,this._drawCount=o,Qb(t)&&(i=0,o=r.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:a,_dataset:l}=t;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!l._decimated,a.points=r;const c=this.resolveDatasetElementOptions(e);c.segment=this.options.segment,this.updateElement(a,void 0,{animated:!s,options:c},e)}else this.datasetElementType&&(delete t.dataset,this.datasetElementType=!1);this.updateElements(r,i,o,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,t,r,s){const i=s==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,u=this.resolveDataElementOptions(t,s),d=this.getSharedOptions(u),h=this.includeOptions(s,d),f=o.axis,p=a.axis,{spanGaps:m,segment:g}=this.options,b=ro(m)?m:Number.POSITIVE_INFINITY,_=this.chart._animationsDisabled||i||s==="none";let M=t>0&&this.getParsed(t-1);for(let k=t;k<t+r;++k){const C=e[k],x=this.getParsed(k),D=_?C:{},O=Me(x[p]),E=D[f]=o.getPixelForValue(x[f],k),R=D[p]=i||O?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,x,l):x[p],k);D.skip=isNaN(E)||isNaN(R)||O,D.stop=k>0&&Math.abs(x[f]-M[f])>b,g&&(D.parsed=x,D.raw=c.data[k]),h&&(D.options=d||this.resolveDataElementOptions(k,C.active?"active":s)),_||this.updateElement(C,k,D,s),M=x}this.updateSharedOptions(d,s,u)}getMaxOverflow(){const e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){let a=0;for(let l=t.length-1;l>=0;--l)a=Math.max(a,t[l].size(this.resolveDataElementOptions(l))/2);return a>0&&a}const r=e.dataset,s=r.options&&r.options.borderWidth||0;if(!t.length)return s;const i=t[0].size(this.resolveDataElementOptions(0)),o=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(s,i,o)/2}}G(oc,"id","scatter"),G(oc,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),G(oc,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var JD=Object.freeze({__proto__:null,BarController:nc,BubbleController:rc,DoughnutController:Ys,LineController:sc,PieController:of,PolarAreaController:ka,RadarController:ic,ScatterController:oc});function $s(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Bp{constructor(e){G(this,"options");this.options=e||{}}static override(e){Object.assign(Bp.prototype,e)}init(){}formats(){return $s()}parse(){return $s()}format(){return $s()}add(){return $s()}diff(){return $s()}startOf(){return $s()}endOf(){return $s()}}var XD={_date:Bp};function QD(n,e,t,r){const{controller:s,data:i,_sorted:o}=n,a=s._cachedMeta.iScale,l=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&o&&i.length){const c=a._reversePixels?w5:Cr;if(r){if(s._sharedOptions){const u=i[0],d=typeof u.getRange=="function"&&u.getRange(e);if(d){const h=c(i,e,t-d),f=c(i,e,t+d);return{lo:h.lo,hi:f.hi}}}}else{const u=c(i,e,t);if(l){const{vScale:d}=s._cachedMeta,{_parsed:h}=n,f=h.slice(0,u.lo+1).reverse().findIndex(m=>!Me(m[d.axis]));u.lo-=Math.max(0,f);const p=h.slice(u.hi).findIndex(m=>!Me(m[d.axis]));u.hi+=Math.max(0,p)}return u}}return{lo:0,hi:i.length-1}}function ll(n,e,t,r,s){const i=n.getSortedVisibleDatasetMetas(),o=t[e];for(let a=0,l=i.length;a<l;++a){const{index:c,data:u}=i[a],{lo:d,hi:h}=QD(i[a],e,o,s);for(let f=d;f<=h;++f){const p=u[f];p.skip||r(p,c,f)}}}function ZD(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(r,s){const i=e?Math.abs(r.x-s.x):0,o=t?Math.abs(r.y-s.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}function Gd(n,e,t,r,s){const i=[];return!s&&!n.isPointInArea(e)||ll(n,t,e,function(a,l,c){!s&&!Sr(a,n.chartArea,0)||a.inRange(e.x,e.y,r)&&i.push({element:a,datasetIndex:l,index:c})},!0),i}function e8(n,e,t,r){let s=[];function i(o,a,l){const{startAngle:c,endAngle:u}=o.getProps(["startAngle","endAngle"],r),{angle:d}=qb(o,{x:e.x,y:e.y});La(d,c,u)&&s.push({element:o,datasetIndex:a,index:l})}return ll(n,t,e,i),s}function t8(n,e,t,r,s,i){let o=[];const a=ZD(t);let l=Number.POSITIVE_INFINITY;function c(u,d,h){const f=u.inRange(e.x,e.y,s);if(r&&!f)return;const p=u.getCenterPoint(s);if(!(!!i||n.isPointInArea(p))&&!f)return;const g=a(e,p);g<l?(o=[{element:u,datasetIndex:d,index:h}],l=g):g===l&&o.push({element:u,datasetIndex:d,index:h})}return ll(n,t,e,c),o}function Jd(n,e,t,r,s,i){return!i&&!n.isPointInArea(e)?[]:t==="r"&&!r?e8(n,e,t,s):t8(n,e,t,r,s,i)}function By(n,e,t,r,s){const i=[],o=t==="x"?"inXRange":"inYRange";let a=!1;return ll(n,t,e,(l,c,u)=>{l[o]&&l[o](e[t],s)&&(i.push({element:l,datasetIndex:c,index:u}),a=a||l.inRange(e.x,e.y,s))}),r&&!a?[]:i}var n8={evaluateInteractionItems:ll,modes:{index(n,e,t,r){const s=As(e,n),i=t.axis||"x",o=t.includeInvisible||!1,a=t.intersect?Gd(n,s,i,r,o):Jd(n,s,i,!1,r,o),l=[];return a.length?(n.getSortedVisibleDatasetMetas().forEach(c=>{const u=a[0].index,d=c.data[u];d&&!d.skip&&l.push({element:d,datasetIndex:c.index,index:u})}),l):[]},dataset(n,e,t,r){const s=As(e,n),i=t.axis||"xy",o=t.includeInvisible||!1;let a=t.intersect?Gd(n,s,i,r,o):Jd(n,s,i,!1,r,o);if(a.length>0){const l=a[0].datasetIndex,c=n.getDatasetMeta(l).data;a=[];for(let u=0;u<c.length;++u)a.push({element:c[u],datasetIndex:l,index:u})}return a},point(n,e,t,r){const s=As(e,n),i=t.axis||"xy",o=t.includeInvisible||!1;return Gd(n,s,i,r,o)},nearest(n,e,t,r){const s=As(e,n),i=t.axis||"xy",o=t.includeInvisible||!1;return Jd(n,s,i,t.intersect,r,o)},x(n,e,t,r){const s=As(e,n);return By(n,s,"x",t.intersect,r)},y(n,e,t,r){const s=As(e,n);return By(n,s,"y",t.intersect,r)}}};const yw=["left","top","right","bottom"];function Ao(n,e){return n.filter(t=>t.pos===e)}function Fy(n,e){return n.filter(t=>yw.indexOf(t.pos)===-1&&t.box.axis===e)}function Po(n,e){return n.sort((t,r)=>{const s=e?r:t,i=e?t:r;return s.weight===i.weight?s.index-i.index:s.weight-i.weight})}function r8(n){const e=[];let t,r,s,i,o,a;for(t=0,r=(n||[]).length;t<r;++t)s=n[t],{position:i,options:{stack:o,stackWeight:a=1}}=s,e.push({index:t,box:s,pos:i,horizontal:s.isHorizontal(),weight:s.weight,stack:o&&i+o,stackWeight:a});return e}function s8(n){const e={};for(const t of n){const{stack:r,pos:s,stackWeight:i}=t;if(!r||!yw.includes(s))continue;const o=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return e}function i8(n,e){const t=s8(n),{vBoxMaxWidth:r,hBoxMaxHeight:s}=e;let i,o,a;for(i=0,o=n.length;i<o;++i){a=n[i];const{fullSize:l}=a.box,c=t[a.stack],u=c&&a.stackWeight/c.weight;a.horizontal?(a.width=u?u*r:l&&e.availableWidth,a.height=s):(a.width=r,a.height=u?u*s:l&&e.availableHeight)}return t}function o8(n){const e=r8(n),t=Po(e.filter(c=>c.box.fullSize),!0),r=Po(Ao(e,"left"),!0),s=Po(Ao(e,"right")),i=Po(Ao(e,"top"),!0),o=Po(Ao(e,"bottom")),a=Fy(e,"x"),l=Fy(e,"y");return{fullSize:t,leftAndTop:r.concat(i),rightAndBottom:s.concat(l).concat(o).concat(a),chartArea:Ao(e,"chartArea"),vertical:r.concat(s).concat(l),horizontal:i.concat(o).concat(a)}}function Vy(n,e,t,r){return Math.max(n[t],e[t])+Math.max(n[r],e[r])}function vw(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function a8(n,e,t,r){const{pos:s,box:i}=t,o=n.maxPadding;if(!Oe(s)){t.size&&(n[s]-=t.size);const d=r[t.stack]||{size:0,count:1};d.size=Math.max(d.size,t.horizontal?i.height:i.width),t.size=d.size/d.count,n[s]+=t.size}i.getPadding&&vw(o,i.getPadding());const a=Math.max(0,e.outerWidth-Vy(o,n,"left","right")),l=Math.max(0,e.outerHeight-Vy(o,n,"top","bottom")),c=a!==n.w,u=l!==n.h;return n.w=a,n.h=l,t.horizontal?{same:c,other:u}:{same:u,other:c}}function l8(n){const e=n.maxPadding;function t(r){const s=Math.max(e[r]-n[r],0);return n[r]+=s,s}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function c8(n,e){const t=e.maxPadding;function r(s){const i={left:0,top:0,right:0,bottom:0};return s.forEach(o=>{i[o]=Math.max(e[o],t[o])}),i}return r(n?["left","right"]:["top","bottom"])}function Bo(n,e,t,r){const s=[];let i,o,a,l,c,u;for(i=0,o=n.length,c=0;i<o;++i){a=n[i],l=a.box,l.update(a.width||e.w,a.height||e.h,c8(a.horizontal,e));const{same:d,other:h}=a8(e,t,a,r);c|=d&&s.length,u=u||h,l.fullSize||s.push(a)}return c&&Bo(s,e,t,r)||u}function Il(n,e,t,r,s){n.top=t,n.left=e,n.right=e+r,n.bottom=t+s,n.width=r,n.height=s}function Hy(n,e,t,r){const s=t.padding;let{x:i,y:o}=e;for(const a of n){const l=a.box,c=r[a.stack]||{count:1,placed:0,weight:1},u=a.stackWeight/c.weight||1;if(a.horizontal){const d=e.w*u,h=c.size||l.height;Ia(c.start)&&(o=c.start),l.fullSize?Il(l,s.left,o,t.outerWidth-s.right-s.left,h):Il(l,e.left+c.placed,o,d,h),c.start=o,c.placed+=d,o=l.bottom}else{const d=e.h*u,h=c.size||l.width;Ia(c.start)&&(i=c.start),l.fullSize?Il(l,i,s.top,h,t.outerHeight-s.bottom-s.top):Il(l,i,e.top+c.placed,h,d),c.start=i,c.placed+=d,i=l.right}}e.x=i,e.y=o}var Vt={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,r){if(!n)return;const s=jt(n.options.layout.padding),i=Math.max(e-s.width,0),o=Math.max(t-s.height,0),a=o8(n.boxes),l=a.vertical,c=a.horizontal;je(n.boxes,m=>{typeof m.beforeLayout=="function"&&m.beforeLayout()});const u=l.reduce((m,g)=>g.box.options&&g.box.options.display===!1?m:m+1,0)||1,d=Object.freeze({outerWidth:e,outerHeight:t,padding:s,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/u,hBoxMaxHeight:o/2}),h=Object.assign({},s);vw(h,jt(r));const f=Object.assign({maxPadding:h,w:i,h:o,x:s.left,y:s.top},s),p=i8(l.concat(c),d);Bo(a.fullSize,f,d,p),Bo(l,f,d,p),Bo(c,f,d,p)&&Bo(l,f,d,p),l8(f),Hy(a.leftAndTop,f,d,p),f.x+=f.w,f.y+=f.h,Hy(a.rightAndBottom,f,d,p),n.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},je(a.chartArea,m=>{const g=m.box;Object.assign(g,n.chartArea),g.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})})}};class bw{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,r){}removeEventListener(e,t,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,r,s){return t=Math.max(0,t||e.width),r=r||e.height,{width:t,height:Math.max(0,s?Math.floor(t/s):r)}}isAttached(e){return!0}updateConfig(e){}}class u8 extends bw{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const ac="$chartjs",d8={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Wy=n=>n===null||n==="";function h8(n,e){const t=n.style,r=n.getAttribute("height"),s=n.getAttribute("width");if(n[ac]={initial:{height:r,width:s,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",Wy(s)){const i=My(n,"width");i!==void 0&&(n.width=i)}if(Wy(r))if(n.style.height==="")n.height=n.width/(e||2);else{const i=My(n,"height");i!==void 0&&(n.height=i)}return n}const ww=fD?{passive:!0}:!1;function f8(n,e,t){n&&n.addEventListener(e,t,ww)}function p8(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,ww)}function m8(n,e){const t=d8[n.type]||n.type,{x:r,y:s}=As(n,e);return{type:t,chart:e,native:n,x:r!==void 0?r:null,y:s!==void 0?s:null}}function lu(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function g8(n,e,t){const r=n.canvas,s=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||lu(a.addedNodes,r),o=o&&!lu(a.removedNodes,r);o&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}function y8(n,e,t){const r=n.canvas,s=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||lu(a.removedNodes,r),o=o&&!lu(a.addedNodes,r);o&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}const Ba=new Map;let jy=0;function _w(){const n=window.devicePixelRatio;n!==jy&&(jy=n,Ba.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function v8(n,e){Ba.size||window.addEventListener("resize",_w),Ba.set(n,e)}function b8(n){Ba.delete(n),Ba.size||window.removeEventListener("resize",_w)}function w8(n,e,t){const r=n.canvas,s=r&&zp(r);if(!s)return;const i=Jb((a,l)=>{const c=s.clientWidth;t(a,l),c<s.clientWidth&&t()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||i(c,u)});return o.observe(s),v8(n,i),o}function Xd(n,e,t){t&&t.disconnect(),e==="resize"&&b8(n)}function _8(n,e,t){const r=n.canvas,s=Jb(i=>{n.ctx!==null&&t(m8(i,n))},n);return f8(r,e,s),s}class k8 extends bw{acquireContext(e,t){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(h8(e,t),r):null}releaseContext(e){const t=e.canvas;if(!t[ac])return!1;const r=t[ac].initial;["height","width"].forEach(i=>{const o=r[i];Me(o)?t.removeAttribute(i):t.setAttribute(i,o)});const s=r.style||{};return Object.keys(s).forEach(i=>{t.style[i]=s[i]}),t.width=t.width,delete t[ac],!0}addEventListener(e,t,r){this.removeEventListener(e,t);const s=e.$proxies||(e.$proxies={}),o={attach:g8,detach:y8,resize:w8}[t]||_8;s[t]=o(e,t,r)}removeEventListener(e,t){const r=e.$proxies||(e.$proxies={}),s=r[t];if(!s)return;({attach:Xd,detach:Xd,resize:Xd}[t]||p8)(e,t,s),r[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,r,s){return hD(e,t,r,s)}isAttached(e){const t=e&&zp(e);return!!(t&&t.isConnected)}}function x8(n){return!Lp()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?u8:k8}var Zl;let Er=(Zl=class{constructor(){G(this,"x");G(this,"y");G(this,"active",!1);G(this,"options");G(this,"$animations")}tooltipPosition(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}hasValue(){return ro(this.x)&&ro(this.y)}getProps(e,t){const r=this.$animations;if(!t||!r)return this;const s={};return e.forEach(i=>{s[i]=r[i]&&r[i].active()?r[i]._to:this[i]}),s}},G(Zl,"defaults",{}),G(Zl,"defaultRoutes"),Zl);function C8(n,e){const t=n.options.ticks,r=S8(n),s=Math.min(t.maxTicksLimit||r,r),i=t.major.enabled?T8(e):[],o=i.length,a=i[0],l=i[o-1],c=[];if(o>s)return O8(e,c,i,o/s),c;const u=M8(i,e,s);if(o>0){let d,h;const f=o>1?Math.round((l-a)/(o-1)):null;for(Ll(e,c,u,Me(f)?0:a-f,a),d=0,h=o-1;d<h;d++)Ll(e,c,u,i[d],i[d+1]);return Ll(e,c,u,l,Me(f)?e.length:l+f),c}return Ll(e,c,u),c}function S8(n){const e=n.options.offset,t=n._tickSize(),r=n._length/t+(e?0:1),s=n._maxLength/t;return Math.floor(Math.min(r,s))}function M8(n,e,t){const r=D8(n),s=e.length/t;if(!r)return Math.max(s,1);const i=m5(r);for(let o=0,a=i.length-1;o<a;o++){const l=i[o];if(l>s)return l}return Math.max(s,1)}function T8(n){const e=[];let t,r;for(t=0,r=n.length;t<r;t++)n[t].major&&e.push(t);return e}function O8(n,e,t,r){let s=0,i=t[0],o;for(r=Math.ceil(r),o=0;o<n.length;o++)o===i&&(e.push(n[o]),s++,i=t[s*r])}function Ll(n,e,t,r,s){const i=be(r,0),o=Math.min(be(s,n.length),n.length);let a=0,l,c,u;for(t=Math.ceil(t),s&&(l=s-r,t=l/Math.floor(l/t)),u=i;u<0;)a++,u=Math.round(i+a*t);for(c=Math.max(i,0);c<o;c++)c===u&&(e.push(n[c]),a++,u=Math.round(i+a*t))}function D8(n){const e=n.length;let t,r;if(e<2)return!1;for(r=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==r)return!1;return r}const $8=n=>n==="left"?"right":n==="right"?"left":n,Uy=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,qy=(n,e)=>Math.min(e||n,n);function Yy(n,e){const t=[],r=n.length/e,s=n.length;let i=0;for(;i<s;i+=r)t.push(n[Math.floor(i)]);return t}function E8(n,e,t){const r=n.ticks.length,s=Math.min(e,r-1),i=n._startPixel,o=n._endPixel,a=1e-6;let l=n.getPixelForTick(s),c;if(!(t&&(r===1?c=Math.max(l-i,o-l):e===0?c=(n.getPixelForTick(1)-l)/2:c=(l-n.getPixelForTick(s-1))/2,l+=s<e?c:-c,l<i-a||l>o+a)))return l}function A8(n,e){je(n,t=>{const r=t.gc,s=r.length/2;let i;if(s>e){for(i=0;i<s;++i)delete t.data[r[i]];r.splice(0,s)}})}function Ro(n){return n.drawTicks?n.tickLength:0}function Ky(n,e){if(!n.display)return 0;const t=kt(n.font,e),r=jt(n.padding);return(Ze(n.text)?n.text.length:1)*t.lineHeight+r.height}function P8(n,e){return _s(n,{scale:e,type:"scale"})}function R8(n,e,t){return _s(n,{tick:t,index:e,type:"tick"})}function N8(n,e,t){let r=Ep(n);return(t&&e!=="right"||!t&&e==="right")&&(r=$8(r)),r}function I8(n,e,t,r){const{top:s,left:i,bottom:o,right:a,chart:l}=n,{chartArea:c,scales:u}=l;let d=0,h,f,p;const m=o-s,g=a-i;if(n.isHorizontal()){if(f=Bt(r,i,a),Oe(t)){const b=Object.keys(t)[0],_=t[b];p=u[b].getPixelForValue(_)+m-e}else t==="center"?p=(c.bottom+c.top)/2+m-e:p=Uy(n,t,e);h=a-i}else{if(Oe(t)){const b=Object.keys(t)[0],_=t[b];f=u[b].getPixelForValue(_)-g+e}else t==="center"?f=(c.left+c.right)/2-g+e:f=Uy(n,t,e);p=Bt(r,o,s),d=t==="left"?-ht:ht}return{titleX:f,titleY:p,maxWidth:h,rotation:d}}class Si extends Er{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:r,_suggestedMax:s}=this;return e=an(e,Number.POSITIVE_INFINITY),t=an(t,Number.NEGATIVE_INFINITY),r=an(r,Number.POSITIVE_INFINITY),s=an(s,Number.NEGATIVE_INFINITY),{min:an(e,r),max:an(t,s),minDefined:lt(e),maxDefined:lt(t)}}getMinMax(e){let{min:t,max:r,minDefined:s,maxDefined:i}=this.getUserBounds(),o;if(s&&i)return{min:t,max:r};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,e),s||(t=Math.min(t,o.min)),i||(r=Math.max(r,o.max));return t=i&&t>r?r:t,r=s&&t>r?t:r,{min:an(t,an(r,t)),max:an(r,an(t,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Je(this.options.beforeUpdate,[this])}update(e,t,r){const{beginAtZero:s,grace:i,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=j5(this,i,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?Yy(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=C8(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,r;this.isHorizontal()?(t=this.left,r=this.right):(t=this.top,r=this.bottom,e=!e),this._startPixel=t,this._endPixel=r,this._reversePixels=e,this._length=r-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Je(this.options.afterUpdate,[this])}beforeSetDimensions(){Je(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Je(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Je(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Je(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let r,s,i;for(r=0,s=e.length;r<s;r++)i=e[r],i.label=Je(t.callback,[i.value,r,e],this)}afterTickToLabelConversion(){Je(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Je(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,r=qy(this.ticks.length,e.ticks.maxTicksLimit),s=t.minRotation||0,i=t.maxRotation;let o=s,a,l,c;if(!this._isVisible()||!t.display||s>=i||r<=1||!this.isHorizontal()){this.labelRotation=s;return}const u=this._getLabelSizes(),d=u.widest.width,h=u.highest.height,f=Mt(this.chart.width-d,0,this.maxWidth);a=e.offset?this.maxWidth/r:f/(r-1),d+6>a&&(a=f/(r-(e.offset?.5:1)),l=this.maxHeight-Ro(e.grid)-t.padding-Ky(e.title,this.chart.options.font),c=Math.sqrt(d*d+h*h),o=Dp(Math.min(Math.asin(Mt((u.highest.height+6)/a,-1,1)),Math.asin(Mt(l/c,-1,1))-Math.asin(Mt(h/c,-1,1)))),o=Math.max(s,Math.min(i,o))),this.labelRotation=o}afterCalculateLabelRotation(){Je(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Je(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:r,title:s,grid:i}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=Ky(s,t.options.font);if(a?(e.width=this.maxWidth,e.height=Ro(i)+l):(e.height=this.maxHeight,e.width=Ro(i)+l),r.display&&this.ticks.length){const{first:c,last:u,widest:d,highest:h}=this._getLabelSizes(),f=r.padding*2,p=Pn(this.labelRotation),m=Math.cos(p),g=Math.sin(p);if(a){const b=r.mirror?0:g*d.width+m*h.height;e.height=Math.min(this.maxHeight,e.height+b+f)}else{const b=r.mirror?0:m*d.width+g*h.height;e.width=Math.min(this.maxWidth,e.width+b+f)}this._calculatePadding(c,u,g,m)}}this._handleMargins(),a?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,r,s){const{ticks:{align:i,padding:o},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let h=0,f=0;l?c?(h=s*e.width,f=r*t.height):(h=r*e.height,f=s*t.width):i==="start"?f=t.width:i==="end"?h=e.width:i!=="inner"&&(h=e.width/2,f=t.width/2),this.paddingLeft=Math.max((h-u+o)*this.width/(this.width-u),0),this.paddingRight=Math.max((f-d+o)*this.width/(this.width-d),0)}else{let u=t.height/2,d=e.height/2;i==="start"?(u=0,d=e.height):i==="end"&&(u=t.height,d=0),this.paddingTop=u+o,this.paddingBottom=d+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Je(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,r;for(t=0,r=e.length;t<r;t++)Me(e[t].label)&&(e.splice(t,1),r--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let r=this.ticks;t<r.length&&(r=Yy(r,t)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,r){const{ctx:s,_longestTextCache:i}=this,o=[],a=[],l=Math.floor(t/qy(t,r));let c=0,u=0,d,h,f,p,m,g,b,_,M,k,C;for(d=0;d<t;d+=l){if(p=e[d].label,m=this._resolveTickFontOptions(d),s.font=g=m.string,b=i[g]=i[g]||{data:{},gc:[]},_=m.lineHeight,M=k=0,!Me(p)&&!Ze(p))M=ou(s,b.data,b.gc,M,p),k=_;else if(Ze(p))for(h=0,f=p.length;h<f;++h)C=p[h],!Me(C)&&!Ze(C)&&(M=ou(s,b.data,b.gc,M,C),k+=_);o.push(M),a.push(k),c=Math.max(M,c),u=Math.max(k,u)}A8(i,t);const x=o.indexOf(c),D=a.indexOf(u),O=E=>({width:o[E]||0,height:a[E]||0});return{first:O(0),last:O(t-1),widest:O(x),highest:O(D),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return b5(this._alignToPixels?Ds(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const r=t[e];return r.$context||(r.$context=R8(this.getContext(),e,r))}return this.$context||(this.$context=P8(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=Pn(this.labelRotation),r=Math.abs(Math.cos(t)),s=Math.abs(Math.sin(t)),i=this._getLabelSizes(),o=e.autoSkipPadding||0,a=i?i.widest.width+o:0,l=i?i.highest.height+o:0;return this.isHorizontal()?l*r>a*s?a/r:l/s:l*s<a*r?l/r:a/s}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,r=this.chart,s=this.options,{grid:i,position:o,border:a}=s,l=i.offset,c=this.isHorizontal(),d=this.ticks.length+(l?1:0),h=Ro(i),f=[],p=a.setContext(this.getContext()),m=p.display?p.width:0,g=m/2,b=function(de){return Ds(r,de,m)};let _,M,k,C,x,D,O,E,R,W,K,_e;if(o==="top")_=b(this.bottom),D=this.bottom-h,E=_-g,W=b(e.top)+g,_e=e.bottom;else if(o==="bottom")_=b(this.top),W=e.top,_e=b(e.bottom)-g,D=_+g,E=this.top+h;else if(o==="left")_=b(this.right),x=this.right-h,O=_-g,R=b(e.left)+g,K=e.right;else if(o==="right")_=b(this.left),R=e.left,K=b(e.right)-g,x=_+g,O=this.left+h;else if(t==="x"){if(o==="center")_=b((e.top+e.bottom)/2+.5);else if(Oe(o)){const de=Object.keys(o)[0],me=o[de];_=b(this.chart.scales[de].getPixelForValue(me))}W=e.top,_e=e.bottom,D=_+g,E=D+h}else if(t==="y"){if(o==="center")_=b((e.left+e.right)/2);else if(Oe(o)){const de=Object.keys(o)[0],me=o[de];_=b(this.chart.scales[de].getPixelForValue(me))}x=_-g,O=x-h,R=e.left,K=e.right}const He=be(s.ticks.maxTicksLimit,d),te=Math.max(1,Math.ceil(d/He));for(M=0;M<d;M+=te){const de=this.getContext(M),me=i.setContext(de),De=a.setContext(de),ye=me.lineWidth,fe=me.color,Xe=De.dash||[],V=De.dashOffset,z=me.tickWidth,F=me.tickColor,re=me.tickBorderDash||[],ce=me.tickBorderDashOffset;k=E8(this,M,l),k!==void 0&&(C=Ds(r,k,ye),c?x=O=R=K=C:D=E=W=_e=C,f.push({tx1:x,ty1:D,tx2:O,ty2:E,x1:R,y1:W,x2:K,y2:_e,width:ye,color:fe,borderDash:Xe,borderDashOffset:V,tickWidth:z,tickColor:F,tickBorderDash:re,tickBorderDashOffset:ce}))}return this._ticksLength=d,this._borderValue=_,f}_computeLabelItems(e){const t=this.axis,r=this.options,{position:s,ticks:i}=r,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:u,mirror:d}=i,h=Ro(r.grid),f=h+u,p=d?-u:f,m=-Pn(this.labelRotation),g=[];let b,_,M,k,C,x,D,O,E,R,W,K,_e="middle";if(s==="top")x=this.bottom-p,D=this._getXAxisLabelAlignment();else if(s==="bottom")x=this.top+p,D=this._getXAxisLabelAlignment();else if(s==="left"){const te=this._getYAxisLabelAlignment(h);D=te.textAlign,C=te.x}else if(s==="right"){const te=this._getYAxisLabelAlignment(h);D=te.textAlign,C=te.x}else if(t==="x"){if(s==="center")x=(e.top+e.bottom)/2+f;else if(Oe(s)){const te=Object.keys(s)[0],de=s[te];x=this.chart.scales[te].getPixelForValue(de)+f}D=this._getXAxisLabelAlignment()}else if(t==="y"){if(s==="center")C=(e.left+e.right)/2-f;else if(Oe(s)){const te=Object.keys(s)[0],de=s[te];C=this.chart.scales[te].getPixelForValue(de)}D=this._getYAxisLabelAlignment(h).textAlign}t==="y"&&(l==="start"?_e="top":l==="end"&&(_e="bottom"));const He=this._getLabelSizes();for(b=0,_=a.length;b<_;++b){M=a[b],k=M.label;const te=i.setContext(this.getContext(b));O=this.getPixelForTick(b)+i.labelOffset,E=this._resolveTickFontOptions(b),R=E.lineHeight,W=Ze(k)?k.length:1;const de=W/2,me=te.color,De=te.textStrokeColor,ye=te.textStrokeWidth;let fe=D;o?(C=O,D==="inner"&&(b===_-1?fe=this.options.reverse?"left":"right":b===0?fe=this.options.reverse?"right":"left":fe="center"),s==="top"?c==="near"||m!==0?K=-W*R+R/2:c==="center"?K=-He.highest.height/2-de*R+R:K=-He.highest.height+R/2:c==="near"||m!==0?K=R/2:c==="center"?K=He.highest.height/2-de*R:K=He.highest.height-W*R,d&&(K*=-1),m!==0&&!te.showLabelBackdrop&&(C+=R/2*Math.sin(m))):(x=O,K=(1-W)*R/2);let Xe;if(te.showLabelBackdrop){const V=jt(te.backdropPadding),z=He.heights[b],F=He.widths[b];let re=K-V.top,ce=0-V.left;switch(_e){case"middle":re-=z/2;break;case"bottom":re-=z;break}switch(D){case"center":ce-=F/2;break;case"right":ce-=F;break;case"inner":b===_-1?ce-=F:b>0&&(ce-=F/2);break}Xe={left:ce,top:re,width:F+V.width,height:z+V.height,color:te.backdropColor}}g.push({label:k,font:E,textOffset:K,options:{rotation:m,color:me,strokeColor:De,strokeWidth:ye,textAlign:fe,textBaseline:_e,translation:[C,x],backdrop:Xe}})}return g}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-Pn(this.labelRotation))return e==="top"?"left":"right";let s="center";return t.align==="start"?s="left":t.align==="end"?s="right":t.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:r,mirror:s,padding:i}}=this.options,o=this._getLabelSizes(),a=e+i,l=o.widest.width;let c,u;return t==="left"?s?(u=this.right+i,r==="near"?c="left":r==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-a,r==="near"?c="right":r==="center"?(c="center",u-=l/2):(c="left",u=this.left)):t==="right"?s?(u=this.left+i,r==="near"?c="right":r==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+a,r==="near"?c="left":r==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:r,top:s,width:i,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(r,s,i,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const s=this.ticks.findIndex(i=>i.value===e);return s>=0?t.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const t=this.options.grid,r=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,o;const a=(l,c,u)=>{!u.width||!u.color||(r.save(),r.lineWidth=u.width,r.strokeStyle=u.color,r.setLineDash(u.borderDash||[]),r.lineDashOffset=u.borderDashOffset,r.beginPath(),r.moveTo(l.x,l.y),r.lineTo(c.x,c.y),r.stroke(),r.restore())};if(t.display)for(i=0,o=s.length;i<o;++i){const l=s[i];t.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),t.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:r,grid:s}}=this,i=r.setContext(this.getContext()),o=r.display?i.width:0;if(!o)return;const a=s.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,d,h;this.isHorizontal()?(c=Ds(e,this.left,o)-o/2,u=Ds(e,this.right,a)+a/2,d=h=l):(d=Ds(e,this.top,o)-o/2,h=Ds(e,this.bottom,a)+a/2,c=u=l),t.save(),t.lineWidth=i.width,t.strokeStyle=i.color,t.beginPath(),t.moveTo(c,d),t.lineTo(u,h),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const r=this.ctx,s=this._computeLabelArea();s&&Xu(r,s);const i=this.getLabelItems(e);for(const o of i){const a=o.options,l=o.font,c=o.label,u=o.textOffset;pi(r,c,0,u,l,a)}s&&Qu(r)}drawTitle(){const{ctx:e,options:{position:t,title:r,reverse:s}}=this;if(!r.display)return;const i=kt(r.font),o=jt(r.padding),a=r.align;let l=i.lineHeight/2;t==="bottom"||t==="center"||Oe(t)?(l+=o.bottom,Ze(r.text)&&(l+=i.lineHeight*(r.text.length-1))):l+=o.top;const{titleX:c,titleY:u,maxWidth:d,rotation:h}=I8(this,l,t,a);pi(e,r.text,0,0,i,{color:r.color,maxWidth:d,rotation:h,textAlign:N8(a,t,s),textBaseline:"middle",translation:[c,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,r=be(e.grid&&e.grid.z,-1),s=be(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Si.prototype.draw?[{z:t,draw:i=>{this.draw(i)}}]:[{z:r,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:t,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",s=[];let i,o;for(i=0,o=t.length;i<o;++i){const a=t[i];a[r]===this.id&&(!e||a.type===e)&&s.push(a)}return s}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return kt(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class zl{constructor(e,t,r){this.type=e,this.scope=t,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let r;B8(t)&&(r=this.register(t));const s=this.items,i=e.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+e);return i in s||(s[i]=e,L8(e,o,r),this.override&&rt.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,r=e.id,s=this.scope;r in t&&delete t[r],s&&r in rt[s]&&(delete rt[s][r],this.override&&delete fi[r])}}function L8(n,e,t){const r=Na(Object.create(null),[t?rt.get(t):{},rt.get(e),n.defaults]);rt.set(e,r),n.defaultRoutes&&z8(e,n.defaultRoutes),n.descriptors&&rt.describe(e,n.descriptors)}function z8(n,e){Object.keys(e).forEach(t=>{const r=t.split("."),s=r.pop(),i=[n].concat(r).join("."),o=e[t].split("."),a=o.pop(),l=o.join(".");rt.route(i,s,l,a)})}function B8(n){return"id"in n&&"defaults"in n}class F8{constructor(){this.controllers=new zl(Rn,"datasets",!0),this.elements=new zl(Er,"elements"),this.plugins=new zl(Object,"plugins"),this.scales=new zl(Si,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,r){[...t].forEach(s=>{const i=r||this._getRegistryForType(s);r||i.isForType(s)||i===this.plugins&&s.id?this._exec(e,i,s):je(s,o=>{const a=r||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,t,r){const s=Op(e);Je(r["before"+s],[],r),t[e](r),Je(r["after"+s],[],r)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const r=this._typedRegistries[t];if(r.isForType(e))return r}return this.plugins}_get(e,t,r){const s=t.get(e);if(s===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return s}}var Yn=new F8;class V8{constructor(){this._init=[]}notify(e,t,r,s){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const i=s?this._descriptors(e).filter(s):this._descriptors(e),o=this._notify(i,e,t,r);return t==="afterDestroy"&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall")),o}_notify(e,t,r,s){s=s||{};for(const i of e){const o=i.plugin,a=o[r],l=[t,s,i.options];if(Je(a,l,o)===!1&&s.cancelable)return!1}return!0}invalidate(){Me(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const r=e&&e.config,s=be(r.options&&r.options.plugins,{}),i=H8(r);return s===!1&&!t?[]:j8(e,i,s,t)}_notifyStateChanges(e){const t=this._oldCache||[],r=this._cache,s=(i,o)=>i.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(s(t,r),e,"stop"),this._notify(s(r,t),e,"start")}}function H8(n){const e={},t=[],r=Object.keys(Yn.plugins.items);for(let i=0;i<r.length;i++)t.push(Yn.getPlugin(r[i]));const s=n.plugins||[];for(let i=0;i<s.length;i++){const o=s[i];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function W8(n,e){return!e&&n===!1?null:n===!0?{}:n}function j8(n,{plugins:e,localIds:t},r,s){const i=[],o=n.getContext();for(const a of e){const l=a.id,c=W8(r[l],s);c!==null&&i.push({plugin:a,options:U8(n.config,{plugin:a,local:t[l]},c,o)})}return i}function U8(n,{plugin:e,local:t},r,s){const i=n.pluginScopeKeys(e),o=n.getOptionScopes(r,i);return t&&e.defaults&&o.push(e.defaults),n.createResolver(o,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function af(n,e){const t=rt.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function q8(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function Y8(n,e){return n===e?"_index_":"_value_"}function Gy(n){if(n==="x"||n==="y"||n==="r")return n}function K8(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function lf(n,...e){if(Gy(n))return n;for(const t of e){const r=t.axis||K8(t.position)||n.length>1&&Gy(n[0].toLowerCase());if(r)return r}throw new Error("Cannot determine type of '".concat(n,"' axis. Please provide 'axis' or 'position' option."))}function Jy(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function G8(n,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(r=>r.xAxisID===n||r.yAxisID===n);if(t.length)return Jy(n,"x",t[0])||Jy(n,"y",t[0])}return{}}function J8(n,e){const t=fi[n.type]||{scales:{}},r=e.scales||{},s=af(n.type,e),i=Object.create(null);return Object.keys(r).forEach(o=>{const a=r[o];if(!Oe(a))return console.error("Invalid scale configuration for scale: ".concat(o));if(a._proxy)return console.warn("Ignoring resolver passed as options for scale: ".concat(o));const l=lf(o,a,G8(o,n),rt.scales[a.type]),c=Y8(l,s),u=t.scales||{};i[o]=va(Object.create(null),[{axis:l},a,u[l],u[c]])}),n.data.datasets.forEach(o=>{const a=o.type||n.type,l=o.indexAxis||af(a,e),u=(fi[a]||{}).scales||{};Object.keys(u).forEach(d=>{const h=q8(d,l),f=o[h+"AxisID"]||h;i[f]=i[f]||Object.create(null),va(i[f],[{axis:h},r[f],u[d]])})}),Object.keys(i).forEach(o=>{const a=i[o];va(a,[rt.scales[a.type],rt.scale])}),i}function kw(n){const e=n.options||(n.options={});e.plugins=be(e.plugins,{}),e.scales=J8(n,e)}function xw(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function X8(n){return n=n||{},n.data=xw(n.data),kw(n),n}const Xy=new Map,Cw=new Set;function Bl(n,e){let t=Xy.get(n);return t||(t=e(),Xy.set(n,t),Cw.add(t)),t}const No=(n,e,t)=>{const r=ms(e,t);r!==void 0&&n.add(r)};class Q8{constructor(e){this._config=X8(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=xw(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),kw(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Bl(e,()=>[["datasets.".concat(e),""]])}datasetAnimationScopeKeys(e,t){return Bl("".concat(e,".transition.").concat(t),()=>[["datasets.".concat(e,".transitions.").concat(t),"transitions.".concat(t)],["datasets.".concat(e),""]])}datasetElementScopeKeys(e,t){return Bl("".concat(e,"-").concat(t),()=>[["datasets.".concat(e,".elements.").concat(t),"datasets.".concat(e),"elements.".concat(t),""]])}pluginScopeKeys(e){const t=e.id,r=this.type;return Bl("".concat(r,"-plugin-").concat(t),()=>[["plugins.".concat(t),...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const r=this._scopeCache;let s=r.get(e);return(!s||t)&&(s=new Map,r.set(e,s)),s}getOptionScopes(e,t,r){const{options:s,type:i}=this,o=this._cachedScopes(e,r),a=o.get(t);if(a)return a;const l=new Set;t.forEach(u=>{e&&(l.add(e),u.forEach(d=>No(l,e,d))),u.forEach(d=>No(l,s,d)),u.forEach(d=>No(l,fi[i]||{},d)),u.forEach(d=>No(l,rt,d)),u.forEach(d=>No(l,rf,d))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),Cw.has(t)&&o.set(t,c),c}chartOptionScopes(){const{options:e,type:t}=this;return[e,fi[t]||{},rt.datasets[t]||{},{type:t},rt,rf]}resolveNamedOptions(e,t,r,s=[""]){const i={$shared:!0},{resolver:o,subPrefixes:a}=Qy(this._resolverCache,e,s);let l=o;if(e$(o,t)){i.$shared=!1,r=gs(r)?r():r;const c=this.createResolver(e,r,a);l=so(o,r,c)}for(const c of t)i[c]=l[c];return i}createResolver(e,t,r=[""],s){const{resolver:i}=Qy(this._resolverCache,e,r);return Oe(t)?so(i,t,void 0,s):i}}function Qy(n,e,t){let r=n.get(e);r||(r=new Map,n.set(e,r));const s=t.join();let i=r.get(s);return i||(i={resolver:Rp(e,t),subPrefixes:t.filter(a=>!a.toLowerCase().includes("hover"))},r.set(s,i)),i}const Z8=n=>Oe(n)&&Object.getOwnPropertyNames(n).some(e=>gs(n[e]));function e$(n,e){const{isScriptable:t,isIndexable:r}=nw(n);for(const s of e){const i=t(s),o=r(s),a=(o||i)&&n[s];if(i&&(gs(a)||Z8(a))||o&&Ze(a))return!0}return!1}var t$="4.4.9";const n$=["top","bottom","left","right","chartArea"];function Zy(n,e){return n==="top"||n==="bottom"||n$.indexOf(n)===-1&&e==="x"}function ev(n,e){return function(t,r){return t[n]===r[n]?t[e]-r[e]:t[n]-r[n]}}function tv(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),Je(t&&t.onComplete,[n],e)}function r$(n){const e=n.chart,t=e.options.animation;Je(t&&t.onProgress,[n],e)}function Sw(n){return Lp()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const lc={},nv=n=>{const e=Sw(n);return Object.values(lc).filter(t=>t.canvas===e).pop()};function s$(n,e,t){const r=Object.keys(n);for(const s of r){const i=+s;if(i>=e){const o=n[s];delete n[s],(t>0||i>e)&&(n[i+t]=o)}}}function i$(n,e,t,r){return!t||n.type==="mouseout"?null:r?e:n}var Lr;let Fp=(Lr=class{static register(...e){Yn.add(...e),rv()}static unregister(...e){Yn.remove(...e),rv()}constructor(e,t){const r=this.config=new Q8(t),s=Sw(e),i=nv(s);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||x8(s)),this.platform.updateConfig(r);const a=this.platform.acquireContext(s,o.aspectRatio),l=a&&a.canvas,c=l&&l.height,u=l&&l.width;if(this.id=o5(),this.ctx=a,this.canvas=l,this.width=u,this.height=c,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new V8,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=x5(d=>this.update(d),o.resizeDelay||0),this._dataChanges=[],lc[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}pr.listen(this,"complete",tv),pr.listen(this,"progress",r$),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:r,height:s,_aspectRatio:i}=this;return Me(e)?t&&i?i:s?r/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Yn}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Sy(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return ky(this.canvas,this.ctx),this}stop(){return pr.stop(this),this}resize(e,t){pr.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const r=this.options,s=this.canvas,i=r.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(s,e,t,i),a=r.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,Sy(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),Je(r.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};je(t,(r,s)=>{r.id=s})}buildOrUpdateScales(){const e=this.options,t=e.scales,r=this.scales,s=Object.keys(r).reduce((o,a)=>(o[a]=!1,o),{});let i=[];t&&(i=i.concat(Object.keys(t).map(o=>{const a=t[o],l=lf(o,a),c=l==="r",u=l==="x";return{options:a,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),je(i,o=>{const a=o.options,l=a.id,c=lf(l,a),u=be(a.type,o.dtype);(a.position===void 0||Zy(a.position,c)!==Zy(o.dposition))&&(a.position=o.dposition),s[l]=!0;let d=null;if(l in r&&r[l].type===u)d=r[l];else{const h=Yn.getScale(u);d=new h({id:l,type:u,ctx:this.ctx,chart:this}),r[d.id]=d}d.init(a,e)}),je(s,(o,a)=>{o||delete r[a]}),je(r,o=>{Vt.configure(this,o,o.options),Vt.addBox(this,o)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,r=e.length;if(e.sort((s,i)=>s.index-i.index),r>t){for(let s=t;s<r;++s)this._destroyDatasetMeta(s);e.splice(t,r-t)}this._sortedMetasets=e.slice(0).sort(ev("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((r,s)=>{t.filter(i=>i===r._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let r,s;for(this._removeUnreferencedMetasets(),r=0,s=t.length;r<s;r++){const i=t[r];let o=this.getDatasetMeta(r);const a=i.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(r),o=this.getDatasetMeta(r)),o.type=a,o.indexAxis=i.indexAxis||af(a,this.options),o.order=i.order||0,o.index=r,o.label=""+i.label,o.visible=this.isDatasetVisible(r),o.controller)o.controller.updateIndex(r),o.controller.linkScales();else{const l=Yn.getController(a),{datasetElementType:c,dataElementType:u}=rt.datasets[a];Object.assign(l,{dataElementType:Yn.getElement(u),datasetElementType:c&&Yn.getElement(c)}),o.controller=new l(this,r),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){je(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const r=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:d}=this.getDatasetMeta(c),h=!s&&i.indexOf(d)===-1;d.buildOrUpdateElements(h),o=Math.max(+d.getMaxOverflow(),o)}o=this._minPadding=r.layout.autoPadding?o:0,this._updateLayout(o),s||je(i,c=>{c.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(ev("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){je(this.scales,e=>{Vt.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!fy(t,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:r,start:s,count:i}of t){const o=r==="_removeElements"?-i:i;s$(e,s,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,r=i=>new Set(e.filter(o=>o[0]===i).map((o,a)=>a+","+o.splice(1).join(","))),s=r(0);for(let i=1;i<t;i++)if(!fy(s,r(i)))return;return Array.from(s).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Vt.update(this,this.width,this.height,e);const t=this.chartArea,r=t.width<=0||t.height<=0;this._layers=[],je(this.boxes,s=>{r&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,i)=>{s._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,r=this.data.datasets.length;t<r;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,r=this.data.datasets.length;t<r;++t)this._updateDataset(t,gs(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const r=this.getDatasetMeta(e),s={meta:r,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(r.controller._update(t),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(pr.has(this)?this.attached&&!pr.running(this)&&pr.start(this):(this.draw(),tv({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,r=[];let s,i;for(s=0,i=t.length;s<i;++s){const o=t[s];(!e||o.visible)&&r.push(o)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,r={meta:e,index:e.index,cancelable:!0},s=fw(this,e);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(s&&Xu(t,s),e.controller.draw(),s&&Qu(t),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(e){return Sr(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,r,s){const i=n8.modes[t];return typeof i=="function"?i(this,e,r,s):[]}getDatasetMeta(e){const t=this.data.datasets[e],r=this._metasets;let s=r.filter(i=>i&&i._dataset===t).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},r.push(s)),s}getContext(){return this.$context||(this.$context=_s(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!t.hidden}setDatasetVisibility(e,t){const r=this.getDatasetMeta(e);r.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,r){const s=r?"show":"hide",i=this.getDatasetMeta(e),o=i.controller._resolveAnimations(void 0,s);Ia(t)?(i.data[t].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),o.update(i,{visible:r}),this.update(a=>a.datasetIndex===e?s:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),pr.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),ky(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete lc[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,r=(i,o)=>{t.addEventListener(this,i,o),e[i]=o},s=(i,o,a)=>{i.offsetX=o,i.offsetY=a,this._eventHandler(i)};je(this.options.events,i=>r(i,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,r=(l,c)=>{t.addEventListener(this,l,c),e[l]=c},s=(l,c)=>{e[l]&&(t.removeEventListener(this,l,c),delete e[l])},i=(l,c)=>{this.canvas&&this.resize(l,c)};let o;const a=()=>{s("attach",a),this.attached=!0,this.resize(),r("resize",i),r("detach",o)};o=()=>{this.attached=!1,s("resize",i),this._stop(),this._resize(0,0),r("attach",a)},t.isAttached(this.canvas)?a():o()}unbindEvents(){je(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},je(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,r){const s=r?"set":"remove";let i,o,a,l;for(t==="dataset"&&(i=this.getDatasetMeta(e[0].datasetIndex),i.controller["_"+s+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const c=o&&this.getDatasetMeta(o.datasetIndex).controller;c&&c[s+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],r=e.map(({datasetIndex:i,index:o})=>{const a=this.getDatasetMeta(i);if(!a)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:a.data[o],index:o}});!ru(r,t)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,t))}notifyPlugins(e,t,r){return this._plugins.notify(this,e,t,r)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,r){const s=this.options.hover,i=(l,c)=>l.filter(u=>!c.some(d=>u.datasetIndex===d.datasetIndex&&u.index===d.index)),o=i(t,e),a=r?e:i(e,t);o.length&&this.updateHoverStyle(o,s.mode,!1),a.length&&s.mode&&this.updateHoverStyle(a,s.mode,!0)}_eventHandler(e,t){const r={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},s=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,s)===!1)return;const i=this._handleEvent(e,t,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,s),(i||r.changed)&&this.render(),this}_handleEvent(e,t,r){const{_active:s=[],options:i}=this,o=t,a=this._getActiveElements(e,s,r,o),l=h5(e),c=i$(e,this._lastEvent,r,l);r&&(this._lastEvent=null,Je(i.onHover,[e,a,this],this),l&&Je(i.onClick,[e,a,this],this));const u=!ru(a,s);return(u||t)&&(this._active=a,this._updateHoverStyles(a,s,t)),this._lastEvent=c,u}_getActiveElements(e,t,r,s){if(e.type==="mouseout")return[];if(!r)return t;const i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,s)}},G(Lr,"defaults",rt),G(Lr,"instances",lc),G(Lr,"overrides",fi),G(Lr,"registry",Yn),G(Lr,"version",t$),G(Lr,"getChart",nv),Lr);function rv(){return je(Fp.instances,n=>n._plugins.invalidate())}function o$(n,e,t){const{startAngle:r,pixelMargin:s,x:i,y:o,outerRadius:a,innerRadius:l}=e;let c=s/a;n.beginPath(),n.arc(i,o,a,r-c,t+c),l>s?(c=s/l,n.arc(i,o,l,t+c,r-c,!0)):n.arc(i,o,s,t+ht,r-ht),n.closePath(),n.clip()}function a$(n){return Pp(n,["outerStart","outerEnd","innerStart","innerEnd"])}function l$(n,e,t,r){const s=a$(n.options.borderRadius),i=(t-e)/2,o=Math.min(i,r*e/2),a=l=>{const c=(t-Math.min(i,l))*r/2;return Mt(l,0,Math.min(i,c))};return{outerStart:a(s.outerStart),outerEnd:a(s.outerEnd),innerStart:Mt(s.innerStart,0,o),innerEnd:Mt(s.innerEnd,0,o)}}function Di(n,e,t,r){return{x:t+n*Math.cos(e),y:r+n*Math.sin(e)}}function cu(n,e,t,r,s,i){const{x:o,y:a,startAngle:l,pixelMargin:c,innerRadius:u}=e,d=Math.max(e.outerRadius+r+t-c,0),h=u>0?u+r+t+c:0;let f=0;const p=s-l;if(r){const te=u>0?u-r:0,de=d>0?d-r:0,me=(te+de)/2,De=me!==0?p*me/(me+r):p;f=(p-De)/2}const m=Math.max(.001,p*d-t/nt)/d,g=(p-m)/2,b=l+g+f,_=s-g-f,{outerStart:M,outerEnd:k,innerStart:C,innerEnd:x}=l$(e,h,d,_-b),D=d-M,O=d-k,E=b+M/D,R=_-k/O,W=h+C,K=h+x,_e=b+C/W,He=_-x/K;if(n.beginPath(),i){const te=(E+R)/2;if(n.arc(o,a,d,E,te),n.arc(o,a,d,te,R),k>0){const ye=Di(O,R,o,a);n.arc(ye.x,ye.y,k,R,_+ht)}const de=Di(K,_,o,a);if(n.lineTo(de.x,de.y),x>0){const ye=Di(K,He,o,a);n.arc(ye.x,ye.y,x,_+ht,He+Math.PI)}const me=(_-x/h+(b+C/h))/2;if(n.arc(o,a,h,_-x/h,me,!0),n.arc(o,a,h,me,b+C/h,!0),C>0){const ye=Di(W,_e,o,a);n.arc(ye.x,ye.y,C,_e+Math.PI,b-ht)}const De=Di(D,b,o,a);if(n.lineTo(De.x,De.y),M>0){const ye=Di(D,E,o,a);n.arc(ye.x,ye.y,M,b-ht,E)}}else{n.moveTo(o,a);const te=Math.cos(E)*d+o,de=Math.sin(E)*d+a;n.lineTo(te,de);const me=Math.cos(R)*d+o,De=Math.sin(R)*d+a;n.lineTo(me,De)}n.closePath()}function c$(n,e,t,r,s){const{fullCircles:i,startAngle:o,circumference:a}=e;let l=e.endAngle;if(i){cu(n,e,t,r,l,s);for(let c=0;c<i;++c)n.fill();isNaN(a)||(l=o+(a%tt||tt))}return cu(n,e,t,r,l,s),n.fill(),l}function u$(n,e,t,r,s){const{fullCircles:i,startAngle:o,circumference:a,options:l}=e,{borderWidth:c,borderJoinStyle:u,borderDash:d,borderDashOffset:h}=l,f=l.borderAlign==="inner";if(!c)return;n.setLineDash(d||[]),n.lineDashOffset=h,f?(n.lineWidth=c*2,n.lineJoin=u||"round"):(n.lineWidth=c,n.lineJoin=u||"bevel");let p=e.endAngle;if(i){cu(n,e,t,r,p,s);for(let m=0;m<i;++m)n.stroke();isNaN(a)||(p=o+(a%tt||tt))}f&&o$(n,e,p),i||(cu(n,e,t,r,p,s),n.stroke())}class Fo extends Er{constructor(t){super();G(this,"circumference");G(this,"endAngle");G(this,"fullCircles");G(this,"innerRadius");G(this,"outerRadius");G(this,"pixelMargin");G(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,r,s){const i=this.getProps(["x","y"],s),{angle:o,distance:a}=qb(i,{x:t,y:r}),{startAngle:l,endAngle:c,innerRadius:u,outerRadius:d,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),f=(this.options.spacing+this.options.borderWidth)/2,p=be(h,c-l),m=La(o,l,c)&&l!==c,g=p>=tt||m,b=xr(a,u+f,d+f);return g&&b}getCenterPoint(t){const{x:r,y:s,startAngle:i,endAngle:o,innerRadius:a,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:c,spacing:u}=this.options,d=(i+o)/2,h=(a+l+u+c)/2;return{x:r+Math.cos(d)*h,y:s+Math.sin(d)*h}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:r,circumference:s}=this,i=(r.offset||0)/4,o=(r.spacing||0)/2,a=r.circular;if(this.pixelMargin=r.borderAlign==="inner"?.33:0,this.fullCircles=s>tt?Math.floor(s/tt):0,s===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const l=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(l)*i,Math.sin(l)*i);const c=1-Math.sin(Math.min(nt,s||0)),u=i*c;t.fillStyle=r.backgroundColor,t.strokeStyle=r.borderColor,c$(t,this,u,o,a),u$(t,this,u,o,a),t.restore()}}G(Fo,"id","arc"),G(Fo,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),G(Fo,"defaultRoutes",{backgroundColor:"backgroundColor"}),G(Fo,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"});function Mw(n,e,t=e){n.lineCap=be(t.borderCapStyle,e.borderCapStyle),n.setLineDash(be(t.borderDash,e.borderDash)),n.lineDashOffset=be(t.borderDashOffset,e.borderDashOffset),n.lineJoin=be(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=be(t.borderWidth,e.borderWidth),n.strokeStyle=be(t.borderColor,e.borderColor)}function d$(n,e,t){n.lineTo(t.x,t.y)}function h$(n){return n.stepped?N5:n.tension||n.cubicInterpolationMode==="monotone"?I5:d$}function Tw(n,e,t={}){const r=n.length,{start:s=0,end:i=r-1}=t,{start:o,end:a}=e,l=Math.max(s,o),c=Math.min(i,a),u=s<o&&i<o||s>a&&i>a;return{count:r,start:l,loop:e.loop,ilen:c<l&&!u?r+c-l:c-l}}function f$(n,e,t,r){const{points:s,options:i}=e,{count:o,start:a,loop:l,ilen:c}=Tw(s,t,r),u=h$(i);let{move:d=!0,reverse:h}=r||{},f,p,m;for(f=0;f<=c;++f)p=s[(a+(h?c-f:f))%o],!p.skip&&(d?(n.moveTo(p.x,p.y),d=!1):u(n,m,p,h,i.stepped),m=p);return l&&(p=s[(a+(h?c:0))%o],u(n,m,p,h,i.stepped)),!!l}function p$(n,e,t,r){const s=e.points,{count:i,start:o,ilen:a}=Tw(s,t,r),{move:l=!0,reverse:c}=r||{};let u=0,d=0,h,f,p,m,g,b;const _=k=>(o+(c?a-k:k))%i,M=()=>{m!==g&&(n.lineTo(u,g),n.lineTo(u,m),n.lineTo(u,b))};for(l&&(f=s[_(0)],n.moveTo(f.x,f.y)),h=0;h<=a;++h){if(f=s[_(h)],f.skip)continue;const k=f.x,C=f.y,x=k|0;x===p?(C<m?m=C:C>g&&(g=C),u=(d*u+k)/++d):(M(),n.lineTo(k,C),p=x,d=0,m=g=C),b=C}M()}function cf(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?p$:f$}function m$(n){return n.stepped?pD:n.tension||n.cubicInterpolationMode==="monotone"?mD:Ps}function g$(n,e,t,r){let s=e._path;s||(s=e._path=new Path2D,e.path(s,t,r)&&s.closePath()),Mw(n,e.options),n.stroke(s)}function y$(n,e,t,r){const{segments:s,options:i}=e,o=cf(e);for(const a of s)Mw(n,i,a.style),n.beginPath(),o(n,e,a,{start:t,end:t+r-1})&&n.closePath(),n.stroke()}const v$=typeof Path2D=="function";function b$(n,e,t,r){v$&&!e.options.segment?g$(n,e,t,r):y$(n,e,t,r)}class es extends Er{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){const s=r.spanGaps?this._loop:this._fullLoop;oD(this._points,r,e,s,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=_D(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,r=e.length;return r&&t[e[r-1].end]}interpolate(e,t){const r=this.options,s=e[t],i=this.points,o=hw(this,{property:t,start:s,end:s});if(!o.length)return;const a=[],l=m$(r);let c,u;for(c=0,u=o.length;c<u;++c){const{start:d,end:h}=o[c],f=i[d],p=i[h];if(f===p){a.push(f);continue}const m=Math.abs((s-f[t])/(p[t]-f[t])),g=l(f,p,m,r.stepped);g[t]=e[t],a.push(g)}return a.length===1?a[0]:a}pathSegment(e,t,r){return cf(this)(e,this,t,r)}path(e,t,r){const s=this.segments,i=cf(this);let o=this._loop;t=t||0,r=r||this.points.length-t;for(const a of s)o&=i(e,this,a,{start:t,end:t+r-1});return!!o}draw(e,t,r,s){const i=this.options||{};(this.points||[]).length&&i.borderWidth&&(e.save(),b$(e,this,r,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}G(es,"id","line"),G(es,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),G(es,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),G(es,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function sv(n,e,t,r){const s=n.options,{[t]:i}=n.getProps([t],r);return Math.abs(e-i)<s.radius+s.hitRadius}class cc extends Er{constructor(t){super();G(this,"parsed");G(this,"skip");G(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,r,s){const i=this.options,{x:o,y:a}=this.getProps(["x","y"],s);return Math.pow(t-o,2)+Math.pow(r-a,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(t,r){return sv(this,t,"x",r)}inYRange(t,r){return sv(this,t,"y",r)}getCenterPoint(t){const{x:r,y:s}=this.getProps(["x","y"],t);return{x:r,y:s}}size(t){t=t||this.options||{};let r=t.radius||0;r=Math.max(r,r&&t.hoverRadius||0);const s=r&&t.borderWidth||0;return(r+s)*2}draw(t,r){const s=this.options;this.skip||s.radius<.1||!Sr(this,r,this.size(s)/2)||(t.strokeStyle=s.borderColor,t.lineWidth=s.borderWidth,t.fillStyle=s.backgroundColor,sf(t,s,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}G(cc,"id","point"),G(cc,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),G(cc,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function Ow(n,e){const{x:t,y:r,base:s,width:i,height:o}=n.getProps(["x","y","base","width","height"],e);let a,l,c,u,d;return n.horizontal?(d=o/2,a=Math.min(t,s),l=Math.max(t,s),c=r-d,u=r+d):(d=i/2,a=t-d,l=t+d,c=Math.min(r,s),u=Math.max(r,s)),{left:a,top:c,right:l,bottom:u}}function ts(n,e,t,r){return n?0:Mt(e,t,r)}function w$(n,e,t){const r=n.options.borderWidth,s=n.borderSkipped,i=tw(r);return{t:ts(s.top,i.top,0,t),r:ts(s.right,i.right,0,e),b:ts(s.bottom,i.bottom,0,t),l:ts(s.left,i.left,0,e)}}function _$(n,e,t){const{enableBorderRadius:r}=n.getProps(["enableBorderRadius"]),s=n.options.borderRadius,i=Xs(s),o=Math.min(e,t),a=n.borderSkipped,l=r||Oe(s);return{topLeft:ts(!l||a.top||a.left,i.topLeft,0,o),topRight:ts(!l||a.top||a.right,i.topRight,0,o),bottomLeft:ts(!l||a.bottom||a.left,i.bottomLeft,0,o),bottomRight:ts(!l||a.bottom||a.right,i.bottomRight,0,o)}}function k$(n){const e=Ow(n),t=e.right-e.left,r=e.bottom-e.top,s=w$(n,t/2,r/2),i=_$(n,t/2,r/2);return{outer:{x:e.left,y:e.top,w:t,h:r,radius:i},inner:{x:e.left+s.l,y:e.top+s.t,w:t-s.l-s.r,h:r-s.t-s.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,i.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(s.b,s.r))}}}}function Qd(n,e,t,r){const s=e===null,i=t===null,a=n&&!(s&&i)&&Ow(n,r);return a&&(s||xr(e,a.left,a.right))&&(i||xr(t,a.top,a.bottom))}function x$(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function C$(n,e){n.rect(e.x,e.y,e.w,e.h)}function Zd(n,e,t={}){const r=n.x!==t.x?-e:0,s=n.y!==t.y?-e:0,i=(n.x+n.w!==t.x+t.w?e:0)-r,o=(n.y+n.h!==t.y+t.h?e:0)-s;return{x:n.x+r,y:n.y+s,w:n.w+i,h:n.h+o,radius:n.radius}}class uc extends Er{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:r,backgroundColor:s}}=this,{inner:i,outer:o}=k$(this),a=x$(o.radius)?za:C$;e.save(),(o.w!==i.w||o.h!==i.h)&&(e.beginPath(),a(e,Zd(o,t,i)),e.clip(),a(e,Zd(i,-t,o)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),a(e,Zd(i,t)),e.fillStyle=s,e.fill(),e.restore()}inRange(e,t,r){return Qd(this,e,t,r)}inXRange(e,t){return Qd(this,e,null,t)}inYRange(e,t){return Qd(this,null,e,t)}getCenterPoint(e){const{x:t,y:r,base:s,horizontal:i}=this.getProps(["x","y","base","horizontal"],e);return{x:i?(t+s)/2:t,y:i?r:(r+s)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}G(uc,"id","bar"),G(uc,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),G(uc,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var S$=Object.freeze({__proto__:null,ArcElement:Fo,BarElement:uc,LineElement:es,PointElement:cc});const uf=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],iv=uf.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function Dw(n){return uf[n%uf.length]}function $w(n){return iv[n%iv.length]}function M$(n,e){return n.borderColor=Dw(e),n.backgroundColor=$w(e),++e}function T$(n,e){return n.backgroundColor=n.data.map(()=>Dw(e++)),e}function O$(n,e){return n.backgroundColor=n.data.map(()=>$w(e++)),e}function D$(n){let e=0;return(t,r)=>{const s=n.getDatasetMeta(r).controller;s instanceof Ys?e=T$(t,e):s instanceof ka?e=O$(t,e):s&&(e=M$(t,e))}}function ov(n){let e;for(e in n)if(n[e].borderColor||n[e].backgroundColor)return!0;return!1}function $$(n){return n&&(n.borderColor||n.backgroundColor)}function E$(){return rt.borderColor!=="rgba(0,0,0,0.1)"||rt.backgroundColor!=="rgba(0,0,0,0.1)"}var A$={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,e,t){if(!t.enabled)return;const{data:{datasets:r},options:s}=n.config,{elements:i}=s,o=ov(r)||$$(s)||i&&ov(i)||E$();if(!t.forceOverride&&o)return;const a=D$(n);r.forEach(a)}};function P$(n,e,t,r,s){const i=s.samples||r;if(i>=t)return n.slice(e,e+t);const o=[],a=(t-2)/(i-2);let l=0;const c=e+t-1;let u=e,d,h,f,p,m;for(o[l++]=n[u],d=0;d<i-2;d++){let g=0,b=0,_;const M=Math.floor((d+1)*a)+1+e,k=Math.min(Math.floor((d+2)*a)+1,t)+e,C=k-M;for(_=M;_<k;_++)g+=n[_].x,b+=n[_].y;g/=C,b/=C;const x=Math.floor(d*a)+1+e,D=Math.min(Math.floor((d+1)*a)+1,t)+e,{x:O,y:E}=n[u];for(f=p=-1,_=x;_<D;_++)p=.5*Math.abs((O-g)*(n[_].y-E)-(O-n[_].x)*(b-E)),p>f&&(f=p,h=n[_],m=_);o[l++]=h,u=m}return o[l++]=n[c],o}function R$(n,e,t,r){let s=0,i=0,o,a,l,c,u,d,h,f,p,m;const g=[],b=e+t-1,_=n[e].x,k=n[b].x-_;for(o=e;o<e+t;++o){a=n[o],l=(a.x-_)/k*r,c=a.y;const C=l|0;if(C===u)c<p?(p=c,d=o):c>m&&(m=c,h=o),s=(i*s+a.x)/++i;else{const x=o-1;if(!Me(d)&&!Me(h)){const D=Math.min(d,h),O=Math.max(d,h);D!==f&&D!==x&&g.push({...n[D],x:s}),O!==f&&O!==x&&g.push({...n[O],x:s})}o>0&&x!==f&&g.push(n[x]),g.push(a),u=C,i=0,p=m=c,d=h=f=o}}return g}function Ew(n){if(n._decimated){const e=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function av(n){n.data.datasets.forEach(e=>{Ew(e)})}function N$(n,e){const t=e.length;let r=0,s;const{iScale:i}=n,{min:o,max:a,minDefined:l,maxDefined:c}=i.getUserBounds();return l&&(r=Mt(Cr(e,i.axis,o).lo,0,t-1)),c?s=Mt(Cr(e,i.axis,a).hi+1,r,t)-r:s=t-r,{start:r,count:s}}var I$={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,e,t)=>{if(!t.enabled){av(n);return}const r=n.width;n.data.datasets.forEach((s,i)=>{const{_data:o,indexAxis:a}=s,l=n.getDatasetMeta(i),c=o||s.data;if(zo([a,n.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const u=n.scales[l.xAxisID];if(u.type!=="linear"&&u.type!=="time"||n.options.parsing)return;let{start:d,count:h}=N$(l,c);const f=t.threshold||4*r;if(h<=f){Ew(s);return}Me(o)&&(s._data=c,delete s.data,Object.defineProperty(s,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(m){this._data=m}}));let p;switch(t.algorithm){case"lttb":p=P$(c,d,h,r,t);break;case"min-max":p=R$(c,d,h,r);break;default:throw new Error("Unsupported decimation algorithm '".concat(t.algorithm,"'"))}s._decimated=p})},destroy(n){av(n)}};function L$(n,e,t){const r=n.segments,s=n.points,i=e.points,o=[];for(const a of r){let{start:l,end:c}=a;c=Vp(l,c,s);const u=df(t,s[l],s[c],a.loop);if(!e.segments){o.push({source:a,target:u,start:s[l],end:s[c]});continue}const d=hw(e,u);for(const h of d){const f=df(t,i[h.start],i[h.end],h.loop),p=dw(a,s,f);for(const m of p)o.push({source:m,target:h,start:{[t]:lv(u,f,"start",Math.max)},end:{[t]:lv(u,f,"end",Math.min)}})}}return o}function df(n,e,t,r){if(r)return;let s=e[n],i=t[n];return n==="angle"&&(s=ln(s),i=ln(i)),{property:n,start:s,end:i}}function z$(n,e){const{x:t=null,y:r=null}=n||{},s=e.points,i=[];return e.segments.forEach(({start:o,end:a})=>{a=Vp(o,a,s);const l=s[o],c=s[a];r!==null?(i.push({x:l.x,y:r}),i.push({x:c.x,y:r})):t!==null&&(i.push({x:t,y:l.y}),i.push({x:t,y:c.y}))}),i}function Vp(n,e,t){for(;e>n;e--){const r=t[e];if(!isNaN(r.x)&&!isNaN(r.y))break}return e}function lv(n,e,t,r){return n&&e?r(n[t],e[t]):n?n[t]:e?e[t]:0}function Aw(n,e){let t=[],r=!1;return Ze(n)?(r=!0,t=n):t=z$(n,e),t.length?new es({points:t,options:{tension:0},_loop:r,_fullLoop:r}):null}function cv(n){return n&&n.fill!==!1}function B$(n,e,t){let s=n[e].fill;const i=[e];let o;if(!t)return s;for(;s!==!1&&i.indexOf(s)===-1;){if(!lt(s))return s;if(o=n[s],!o)return!1;if(o.visible)return s;i.push(s),s=o.fill}return!1}function F$(n,e,t){const r=j$(n);if(Oe(r))return isNaN(r.value)?!1:r;let s=parseFloat(r);return lt(s)&&Math.floor(s)===s?V$(r[0],e,s,t):["origin","start","end","stack","shape"].indexOf(r)>=0&&r}function V$(n,e,t,r){return(n==="-"||n==="+")&&(t=e+t),t===e||t<0||t>=r?!1:t}function H$(n,e){let t=null;return n==="start"?t=e.bottom:n==="end"?t=e.top:Oe(n)?t=e.getPixelForValue(n.value):e.getBasePixel&&(t=e.getBasePixel()),t}function W$(n,e,t){let r;return n==="start"?r=t:n==="end"?r=e.options.reverse?e.min:e.max:Oe(n)?r=n.value:r=e.getBaseValue(),r}function j$(n){const e=n.options,t=e.fill;let r=be(t&&t.target,t);return r===void 0&&(r=!!e.backgroundColor),r===!1||r===null?!1:r===!0?"origin":r}function U$(n){const{scale:e,index:t,line:r}=n,s=[],i=r.segments,o=r.points,a=q$(e,t);a.push(Aw({x:null,y:e.bottom},r));for(let l=0;l<i.length;l++){const c=i[l];for(let u=c.start;u<=c.end;u++)Y$(s,o[u],a)}return new es({points:s,options:{}})}function q$(n,e){const t=[],r=n.getMatchingVisibleMetas("line");for(let s=0;s<r.length;s++){const i=r[s];if(i.index===e)break;i.hidden||t.unshift(i.dataset)}return t}function Y$(n,e,t){const r=[];for(let s=0;s<t.length;s++){const i=t[s],{first:o,last:a,point:l}=K$(i,e,"x");if(!(!l||o&&a)){if(o)r.unshift(l);else if(n.push(l),!a)break}}n.push(...r)}function K$(n,e,t){const r=n.interpolate(e,t);if(!r)return{};const s=r[t],i=n.segments,o=n.points;let a=!1,l=!1;for(let c=0;c<i.length;c++){const u=i[c],d=o[u.start][t],h=o[u.end][t];if(xr(s,d,h)){a=s===d,l=s===h;break}}return{first:a,last:l,point:r}}class Pw{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,r){const{x:s,y:i,radius:o}=this;return t=t||{start:0,end:tt},e.arc(s,i,o,t.end,t.start,!0),!r.bounds}interpolate(e){const{x:t,y:r,radius:s}=this,i=e.angle;return{x:t+Math.cos(i)*s,y:r+Math.sin(i)*s,angle:i}}}function G$(n){const{chart:e,fill:t,line:r}=n;if(lt(t))return J$(e,t);if(t==="stack")return U$(n);if(t==="shape")return!0;const s=X$(n);return s instanceof Pw?s:Aw(s,r)}function J$(n,e){const t=n.getDatasetMeta(e);return t&&n.isDatasetVisible(e)?t.dataset:null}function X$(n){return(n.scale||{}).getPointPositionForValue?Z$(n):Q$(n)}function Q$(n){const{scale:e={},fill:t}=n,r=H$(t,e);if(lt(r)){const s=e.isHorizontal();return{x:s?r:null,y:s?null:r}}return null}function Z$(n){const{scale:e,fill:t}=n,r=e.options,s=e.getLabels().length,i=r.reverse?e.max:e.min,o=W$(t,e,i),a=[];if(r.grid.circular){const l=e.getPointPositionForValue(0,i);return new Pw({x:l.x,y:l.y,radius:e.getDistanceFromCenterForValue(o)})}for(let l=0;l<s;++l)a.push(e.getPointPositionForValue(l,o));return a}function eh(n,e,t){const r=G$(e),{chart:s,index:i,line:o,scale:a,axis:l}=e,c=o.options,u=c.fill,d=c.backgroundColor,{above:h=d,below:f=d}=u||{},p=s.getDatasetMeta(i),m=fw(s,p);r&&o.points.length&&(Xu(n,t),eE(n,{line:o,target:r,above:h,below:f,area:t,scale:a,axis:l,clip:m}),Qu(n))}function eE(n,e){const{line:t,target:r,above:s,below:i,area:o,scale:a,clip:l}=e,c=t._loop?"angle":e.axis;n.save(),c==="x"&&i!==s&&(uv(n,r,o.top),dv(n,{line:t,target:r,color:s,scale:a,property:c,clip:l}),n.restore(),n.save(),uv(n,r,o.bottom)),dv(n,{line:t,target:r,color:i,scale:a,property:c,clip:l}),n.restore()}function uv(n,e,t){const{segments:r,points:s}=e;let i=!0,o=!1;n.beginPath();for(const a of r){const{start:l,end:c}=a,u=s[l],d=s[Vp(l,c,s)];i?(n.moveTo(u.x,u.y),i=!1):(n.lineTo(u.x,t),n.lineTo(u.x,u.y)),o=!!e.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(d.x,t)}n.lineTo(e.first().x,t),n.closePath(),n.clip()}function dv(n,e){const{line:t,target:r,property:s,color:i,scale:o,clip:a}=e,l=L$(t,r,s);for(const{source:c,target:u,start:d,end:h}of l){const{style:{backgroundColor:f=i}={}}=c,p=r!==!0;n.save(),n.fillStyle=f,tE(n,o,a,p&&df(s,d,h)),n.beginPath();const m=!!t.pathSegment(n,c);let g;if(p){m?n.closePath():hv(n,r,h,s);const b=!!r.pathSegment(n,u,{move:m,reverse:!0});g=m&&b,g||hv(n,r,d,s)}n.closePath(),n.fill(g?"evenodd":"nonzero"),n.restore()}}function tE(n,e,t,r){const s=e.chart.chartArea,{property:i,start:o,end:a}=r||{};if(i==="x"||i==="y"){let l,c,u,d;i==="x"?(l=o,c=s.top,u=a,d=s.bottom):(l=s.left,c=o,u=s.right,d=a),n.beginPath(),t&&(l=Math.max(l,t.left),u=Math.min(u,t.right),c=Math.max(c,t.top),d=Math.min(d,t.bottom)),n.rect(l,c,u-l,d-c),n.clip()}}function hv(n,e,t,r){const s=e.interpolate(t,r);s&&n.lineTo(s.x,s.y)}var nE={id:"filler",afterDatasetsUpdate(n,e,t){const r=(n.data.datasets||[]).length,s=[];let i,o,a,l;for(o=0;o<r;++o)i=n.getDatasetMeta(o),a=i.dataset,l=null,a&&a.options&&a instanceof es&&(l={visible:n.isDatasetVisible(o),index:o,fill:F$(a,o,r),chart:n,axis:i.controller.options.indexAxis,scale:i.vScale,line:a}),i.$filler=l,s.push(l);for(o=0;o<r;++o)l=s[o],!(!l||l.fill===!1)&&(l.fill=B$(s,o,t.propagate))},beforeDraw(n,e,t){const r=t.drawTime==="beforeDraw",s=n.getSortedVisibleDatasetMetas(),i=n.chartArea;for(let o=s.length-1;o>=0;--o){const a=s[o].$filler;a&&(a.line.updateControlPoints(i,a.axis),r&&a.fill&&eh(n.ctx,a,i))}},beforeDatasetsDraw(n,e,t){if(t.drawTime!=="beforeDatasetsDraw")return;const r=n.getSortedVisibleDatasetMetas();for(let s=r.length-1;s>=0;--s){const i=r[s].$filler;cv(i)&&eh(n.ctx,i,n.chartArea)}},beforeDatasetDraw(n,e,t){const r=e.meta.$filler;!cv(r)||t.drawTime!=="beforeDatasetDraw"||eh(n.ctx,r,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const fv=(n,e)=>{let{boxHeight:t=e,boxWidth:r=e}=n;return n.usePointStyle&&(t=Math.min(t,e),r=n.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:t,itemHeight:Math.max(e,t)}},rE=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class pv extends Er{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,r){this.maxWidth=e,this.maxHeight=t,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Je(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(r=>e.filter(r,this.chart.data))),e.sort&&(t=t.sort((r,s)=>e.sort(r,s,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const r=e.labels,s=kt(r.font),i=s.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=fv(r,i);let c,u;t.font=s.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(o,i,a,l)+10):(u=this.maxHeight,c=this._fitCols(o,s,a,l)+10),this.width=Math.min(c,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,t,r,s){const{ctx:i,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=s+a;let d=e;i.textAlign="left",i.textBaseline="middle";let h=-1,f=-u;return this.legendItems.forEach((p,m)=>{const g=r+t/2+i.measureText(p.text).width;(m===0||c[c.length-1]+g+2*a>o)&&(d+=u,c[c.length-(m>0?0:1)]=0,f+=u,h++),l[m]={left:0,top:f,row:h,width:g,height:s},c[c.length-1]+=g+a}),d}_fitCols(e,t,r,s){const{ctx:i,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=o-e;let d=a,h=0,f=0,p=0,m=0;return this.legendItems.forEach((g,b)=>{const{itemWidth:_,itemHeight:M}=sE(r,t,i,g,s);b>0&&f+M+2*a>u&&(d+=h+a,c.push({width:h,height:f}),p+=h+a,m++,h=f=0),l[b]={left:p,top:f,col:m,width:_,height:M},h=Math.max(h,_),f+=M+a}),d+=h,c.push({width:h,height:f}),d}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:r,labels:{padding:s},rtl:i}}=this,o=Gi(i,this.left,this.width);if(this.isHorizontal()){let a=0,l=Bt(r,this.left+s,this.right-this.lineWidths[a]);for(const c of t)a!==c.row&&(a=c.row,l=Bt(r,this.left+s,this.right-this.lineWidths[a])),c.top+=this.top+e+s,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+s}else{let a=0,l=Bt(r,this.top+e+s,this.bottom-this.columnSizes[a].height);for(const c of t)c.col!==a&&(a=c.col,l=Bt(r,this.top+e+s,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+s,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Xu(e,this),this._draw(),Qu(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:r,ctx:s}=this,{align:i,labels:o}=e,a=rt.color,l=Gi(e.rtl,this.left,this.width),c=kt(o.font),{padding:u}=o,d=c.size,h=d/2;let f;this.drawTitle(),s.textAlign=l.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=c.string;const{boxWidth:p,boxHeight:m,itemHeight:g}=fv(o,d),b=function(x,D,O){if(isNaN(p)||p<=0||isNaN(m)||m<0)return;s.save();const E=be(O.lineWidth,1);if(s.fillStyle=be(O.fillStyle,a),s.lineCap=be(O.lineCap,"butt"),s.lineDashOffset=be(O.lineDashOffset,0),s.lineJoin=be(O.lineJoin,"miter"),s.lineWidth=E,s.strokeStyle=be(O.strokeStyle,a),s.setLineDash(be(O.lineDash,[])),o.usePointStyle){const R={radius:m*Math.SQRT2/2,pointStyle:O.pointStyle,rotation:O.rotation,borderWidth:E},W=l.xPlus(x,p/2),K=D+h;ew(s,R,W,K,o.pointStyleWidth&&p)}else{const R=D+Math.max((d-m)/2,0),W=l.leftForLtr(x,p),K=Xs(O.borderRadius);s.beginPath(),Object.values(K).some(_e=>_e!==0)?za(s,{x:W,y:R,w:p,h:m,radius:K}):s.rect(W,R,p,m),s.fill(),E!==0&&s.stroke()}s.restore()},_=function(x,D,O){pi(s,O.text,x,D+g/2,c,{strikethrough:O.hidden,textAlign:l.textAlign(O.textAlign)})},M=this.isHorizontal(),k=this._computeTitleHeight();M?f={x:Bt(i,this.left+u,this.right-r[0]),y:this.top+u+k,line:0}:f={x:this.left+u,y:Bt(i,this.top+k+u,this.bottom-t[0].height),line:0},lw(this.ctx,e.textDirection);const C=g+u;this.legendItems.forEach((x,D)=>{s.strokeStyle=x.fontColor,s.fillStyle=x.fontColor;const O=s.measureText(x.text).width,E=l.textAlign(x.textAlign||(x.textAlign=o.textAlign)),R=p+h+O;let W=f.x,K=f.y;l.setWidth(this.width),M?D>0&&W+R+u>this.right&&(K=f.y+=C,f.line++,W=f.x=Bt(i,this.left+u,this.right-r[f.line])):D>0&&K+C>this.bottom&&(W=f.x=W+t[f.line].width+u,f.line++,K=f.y=Bt(i,this.top+k+u,this.bottom-t[f.line].height));const _e=l.x(W);if(b(_e,K,x),W=C5(E,W+p+h,M?W+R:this.right,e.rtl),_(l.x(W),K,x),M)f.x+=R+u;else if(typeof x.text!="string"){const He=c.lineHeight;f.y+=Rw(x,He)+u}else f.y+=C}),cw(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,r=kt(t.font),s=jt(t.padding);if(!t.display)return;const i=Gi(e.rtl,this.left,this.width),o=this.ctx,a=t.position,l=r.size/2,c=s.top+l;let u,d=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),u=this.top+c,d=Bt(e.align,d,this.right-h);else{const p=this.columnSizes.reduce((m,g)=>Math.max(m,g.height),0);u=c+Bt(e.align,this.top,this.bottom-p-e.labels.padding-this._computeTitleHeight())}const f=Bt(a,d,d+h);o.textAlign=i.textAlign(Ep(a)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=r.string,pi(o,t.text,f,u,r)}_computeTitleHeight(){const e=this.options.title,t=kt(e.font),r=jt(e.padding);return e.display?t.lineHeight+r.height:0}_getLegendItemAt(e,t){let r,s,i;if(xr(e,this.left,this.right)&&xr(t,this.top,this.bottom)){for(i=this.legendHitBoxes,r=0;r<i.length;++r)if(s=i[r],xr(e,s.left,s.left+s.width)&&xr(t,s.top,s.top+s.height))return this.legendItems[r]}return null}handleEvent(e){const t=this.options;if(!aE(e.type,t))return;const r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const s=this._hoveredItem,i=rE(s,r);s&&!i&&Je(t.onLeave,[e,s,this],this),this._hoveredItem=r,r&&!i&&Je(t.onHover,[e,r,this],this)}else r&&Je(t.onClick,[e,r,this],this)}}function sE(n,e,t,r,s){const i=iE(r,n,e,t),o=oE(s,r,e.lineHeight);return{itemWidth:i,itemHeight:o}}function iE(n,e,t,r){let s=n.text;return s&&typeof s!="string"&&(s=s.reduce((i,o)=>i.length>o.length?i:o)),e+t.size/2+r.measureText(s).width}function oE(n,e,t){let r=n;return typeof e.text!="string"&&(r=Rw(e,t)),r}function Rw(n,e){const t=n.text?n.text.length:0;return e*t}function aE(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var lE={id:"legend",_element:pv,start(n,e,t){const r=n.legend=new pv({ctx:n.ctx,options:t,chart:n});Vt.configure(n,r,t),Vt.addBox(n,r)},stop(n){Vt.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const r=n.legend;Vt.configure(n,r,t),r.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const r=e.datasetIndex,s=t.chart;s.isDatasetVisible(r)?(s.hide(r),e.hidden=!0):(s.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:r,textAlign:s,color:i,useBorderRadius:o,borderRadius:a}}=n.legend.options;return n._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(t?0:void 0),u=jt(c.borderWidth);return{text:e[l.index].label,fillStyle:c.backgroundColor,fontColor:i,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:r||c.pointStyle,rotation:c.rotation,textAlign:s||c.textAlign,borderRadius:o&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class Hp extends Er{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const r=this.options;if(this.left=0,this.top=0,!r.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const s=Ze(r.text)?r.text.length:1;this._padding=jt(r.padding);const i=s*kt(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=i:this.width=i}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:r,bottom:s,right:i,options:o}=this,a=o.align;let l=0,c,u,d;return this.isHorizontal()?(u=Bt(a,r,i),d=t+e,c=i-r):(o.position==="left"?(u=r+e,d=Bt(a,s,t),l=nt*-.5):(u=i-e,d=Bt(a,t,s),l=nt*.5),c=s-t),{titleX:u,titleY:d,maxWidth:c,rotation:l}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const r=kt(t.font),i=r.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(i);pi(e,t.text,0,0,r,{color:t.color,maxWidth:l,rotation:c,textAlign:Ep(t.align),textBaseline:"middle",translation:[o,a]})}}function cE(n,e){const t=new Hp({ctx:n.ctx,options:e,chart:n});Vt.configure(n,t,e),Vt.addBox(n,t),n.titleBlock=t}var uE={id:"title",_element:Hp,start(n,e,t){cE(n,t)},stop(n){const e=n.titleBlock;Vt.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,t){const r=n.titleBlock;Vt.configure(n,r,t),r.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Fl=new WeakMap;var dE={id:"subtitle",start(n,e,t){const r=new Hp({ctx:n.ctx,options:t,chart:n});Vt.configure(n,r,t),Vt.addBox(n,r),Fl.set(n,r)},stop(n){Vt.removeBox(n,Fl.get(n)),Fl.delete(n)},beforeUpdate(n,e,t){const r=Fl.get(n);Vt.configure(n,r,t),r.options=t},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Vo={average(n){if(!n.length)return!1;let e,t,r=new Set,s=0,i=0;for(e=0,t=n.length;e<t;++e){const a=n[e].element;if(a&&a.hasValue()){const l=a.tooltipPosition();r.add(l.x),s+=l.y,++i}}return i===0||r.size===0?!1:{x:[...r].reduce((a,l)=>a+l)/r.size,y:s/i}},nearest(n,e){if(!n.length)return!1;let t=e.x,r=e.y,s=Number.POSITIVE_INFINITY,i,o,a;for(i=0,o=n.length;i<o;++i){const l=n[i].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=nf(e,c);u<s&&(s=u,a=l)}}if(a){const l=a.tooltipPosition();t=l.x,r=l.y}return{x:t,y:r}}};function jn(n,e){return e&&(Ze(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function mr(n){return(typeof n=="string"||n instanceof String)&&n.indexOf("\n")>-1?n.split("\n"):n}function hE(n,e){const{element:t,datasetIndex:r,index:s}=e,i=n.getDatasetMeta(r).controller,{label:o,value:a}=i.getLabelAndValue(s);return{chart:n,label:o,parsed:i.getParsed(s),raw:n.data.datasets[r].data[s],formattedValue:a,dataset:i.getDataset(),dataIndex:s,datasetIndex:r,element:t}}function mv(n,e){const t=n.chart.ctx,{body:r,footer:s,title:i}=n,{boxWidth:o,boxHeight:a}=e,l=kt(e.bodyFont),c=kt(e.titleFont),u=kt(e.footerFont),d=i.length,h=s.length,f=r.length,p=jt(e.padding);let m=p.height,g=0,b=r.reduce((k,C)=>k+C.before.length+C.lines.length+C.after.length,0);if(b+=n.beforeBody.length+n.afterBody.length,d&&(m+=d*c.lineHeight+(d-1)*e.titleSpacing+e.titleMarginBottom),b){const k=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;m+=f*k+(b-f)*l.lineHeight+(b-1)*e.bodySpacing}h&&(m+=e.footerMarginTop+h*u.lineHeight+(h-1)*e.footerSpacing);let _=0;const M=function(k){g=Math.max(g,t.measureText(k).width+_)};return t.save(),t.font=c.string,je(n.title,M),t.font=l.string,je(n.beforeBody.concat(n.afterBody),M),_=e.displayColors?o+2+e.boxPadding:0,je(r,k=>{je(k.before,M),je(k.lines,M),je(k.after,M)}),_=0,t.font=u.string,je(n.footer,M),t.restore(),g+=p.width,{width:g,height:m}}function fE(n,e){const{y:t,height:r}=e;return t<r/2?"top":t>n.height-r/2?"bottom":"center"}function pE(n,e,t,r){const{x:s,width:i}=r,o=t.caretSize+t.caretPadding;if(n==="left"&&s+i+o>e.width||n==="right"&&s-i-o<0)return!0}function mE(n,e,t,r){const{x:s,width:i}=t,{width:o,chartArea:{left:a,right:l}}=n;let c="center";return r==="center"?c=s<=(a+l)/2?"left":"right":s<=i/2?c="left":s>=o-i/2&&(c="right"),pE(c,n,e,t)&&(c="center"),c}function gv(n,e,t){const r=t.yAlign||e.yAlign||fE(n,t);return{xAlign:t.xAlign||e.xAlign||mE(n,e,t,r),yAlign:r}}function gE(n,e){let{x:t,width:r}=n;return e==="right"?t-=r:e==="center"&&(t-=r/2),t}function yE(n,e,t){let{y:r,height:s}=n;return e==="top"?r+=t:e==="bottom"?r-=s+t:r-=s/2,r}function yv(n,e,t,r){const{caretSize:s,caretPadding:i,cornerRadius:o}=n,{xAlign:a,yAlign:l}=t,c=s+i,{topLeft:u,topRight:d,bottomLeft:h,bottomRight:f}=Xs(o);let p=gE(e,a);const m=yE(e,l,c);return l==="center"?a==="left"?p+=c:a==="right"&&(p-=c):a==="left"?p-=Math.max(u,h)+s:a==="right"&&(p+=Math.max(d,f)+s),{x:Mt(p,0,r.width-e.width),y:Mt(m,0,r.height-e.height)}}function Vl(n,e,t){const r=jt(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-r.right:n.x+r.left}function vv(n){return jn([],mr(n))}function vE(n,e,t){return _s(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function bv(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const Nw={beforeTitle:hr,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,r=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return t[e.dataIndex]}return""},afterTitle:hr,beforeBody:hr,beforeLabel:hr,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return Me(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:hr,afterBody:hr,beforeFooter:hr,footer:hr,afterFooter:hr};function Gt(n,e,t,r){const s=n[e].call(t,r);return typeof s>"u"?Nw[e].call(t,r):s}class hf extends Er{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,r=this.options.setContext(this.getContext()),s=r.enabled&&t.options.animation&&r.animations,i=new pw(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=vE(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:r}=t,s=Gt(r,"beforeTitle",this,e),i=Gt(r,"title",this,e),o=Gt(r,"afterTitle",this,e);let a=[];return a=jn(a,mr(s)),a=jn(a,mr(i)),a=jn(a,mr(o)),a}getBeforeBody(e,t){return vv(Gt(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:r}=t,s=[];return je(e,i=>{const o={before:[],lines:[],after:[]},a=bv(r,i);jn(o.before,mr(Gt(a,"beforeLabel",this,i))),jn(o.lines,Gt(a,"label",this,i)),jn(o.after,mr(Gt(a,"afterLabel",this,i))),s.push(o)}),s}getAfterBody(e,t){return vv(Gt(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:r}=t,s=Gt(r,"beforeFooter",this,e),i=Gt(r,"footer",this,e),o=Gt(r,"afterFooter",this,e);let a=[];return a=jn(a,mr(s)),a=jn(a,mr(i)),a=jn(a,mr(o)),a}_createItems(e){const t=this._active,r=this.chart.data,s=[],i=[],o=[];let a=[],l,c;for(l=0,c=t.length;l<c;++l)a.push(hE(this.chart,t[l]));return e.filter&&(a=a.filter((u,d,h)=>e.filter(u,d,h,r))),e.itemSort&&(a=a.sort((u,d)=>e.itemSort(u,d,r))),je(a,u=>{const d=bv(e.callbacks,u);s.push(Gt(d,"labelColor",this,u)),i.push(Gt(d,"labelPointStyle",this,u)),o.push(Gt(d,"labelTextColor",this,u))}),this.labelColors=s,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=a,a}update(e,t){const r=this.options.setContext(this.getContext()),s=this._active;let i,o=[];if(!s.length)this.opacity!==0&&(i={opacity:0});else{const a=Vo[r.position].call(this,s,this._eventPosition);o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r);const l=this._size=mv(this,r),c=Object.assign({},a,l),u=gv(this.chart,r,c),d=yv(r,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,i={opacity:1,x:d.x,y:d.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,r,s){const i=this.getCaretPosition(e,r,s);t.lineTo(i.x1,i.y1),t.lineTo(i.x2,i.y2),t.lineTo(i.x3,i.y3)}getCaretPosition(e,t,r){const{xAlign:s,yAlign:i}=this,{caretSize:o,cornerRadius:a}=r,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:d}=Xs(a),{x:h,y:f}=e,{width:p,height:m}=t;let g,b,_,M,k,C;return i==="center"?(k=f+m/2,s==="left"?(g=h,b=g-o,M=k+o,C=k-o):(g=h+p,b=g+o,M=k-o,C=k+o),_=g):(s==="left"?b=h+Math.max(l,u)+o:s==="right"?b=h+p-Math.max(c,d)-o:b=this.caretX,i==="top"?(M=f,k=M-o,g=b-o,_=b+o):(M=f+m,k=M+o,g=b+o,_=b-o),C=M),{x1:g,x2:b,x3:_,y1:M,y2:k,y3:C}}drawTitle(e,t,r){const s=this.title,i=s.length;let o,a,l;if(i){const c=Gi(r.rtl,this.x,this.width);for(e.x=Vl(this,r.titleAlign,r),t.textAlign=c.textAlign(r.titleAlign),t.textBaseline="middle",o=kt(r.titleFont),a=r.titleSpacing,t.fillStyle=r.titleColor,t.font=o.string,l=0;l<i;++l)t.fillText(s[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===i&&(e.y+=r.titleMarginBottom-a)}}_drawColorBox(e,t,r,s,i){const o=this.labelColors[r],a=this.labelPointStyles[r],{boxHeight:l,boxWidth:c}=i,u=kt(i.bodyFont),d=Vl(this,"left",i),h=s.x(d),f=l<u.lineHeight?(u.lineHeight-l)/2:0,p=t.y+f;if(i.usePointStyle){const m={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},g=s.leftForLtr(h,c)+c/2,b=p+l/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,sf(e,m,g,b),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,sf(e,m,g,b)}else{e.lineWidth=Oe(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const m=s.leftForLtr(h,c),g=s.leftForLtr(s.xPlus(h,1),c-2),b=Xs(o.borderRadius);Object.values(b).some(_=>_!==0)?(e.beginPath(),e.fillStyle=i.multiKeyBackground,za(e,{x:m,y:p,w:c,h:l,radius:b}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),za(e,{x:g,y:p+1,w:c-2,h:l-2,radius:b}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(m,p,c,l),e.strokeRect(m,p,c,l),e.fillStyle=o.backgroundColor,e.fillRect(g,p+1,c-2,l-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,t,r){const{body:s}=this,{bodySpacing:i,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:u}=r,d=kt(r.bodyFont);let h=d.lineHeight,f=0;const p=Gi(r.rtl,this.x,this.width),m=function(O){t.fillText(O,p.x(e.x+f),e.y+h/2),e.y+=h+i},g=p.textAlign(o);let b,_,M,k,C,x,D;for(t.textAlign=o,t.textBaseline="middle",t.font=d.string,e.x=Vl(this,g,r),t.fillStyle=r.bodyColor,je(this.beforeBody,m),f=a&&g!=="right"?o==="center"?c/2+u:c+2+u:0,k=0,x=s.length;k<x;++k){for(b=s[k],_=this.labelTextColors[k],t.fillStyle=_,je(b.before,m),M=b.lines,a&&M.length&&(this._drawColorBox(t,e,k,p,r),h=Math.max(d.lineHeight,l)),C=0,D=M.length;C<D;++C)m(M[C]),h=d.lineHeight;je(b.after,m)}f=0,h=d.lineHeight,je(this.afterBody,m),e.y-=i}drawFooter(e,t,r){const s=this.footer,i=s.length;let o,a;if(i){const l=Gi(r.rtl,this.x,this.width);for(e.x=Vl(this,r.footerAlign,r),e.y+=r.footerMarginTop,t.textAlign=l.textAlign(r.footerAlign),t.textBaseline="middle",o=kt(r.footerFont),t.fillStyle=r.footerColor,t.font=o.string,a=0;a<i;++a)t.fillText(s[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+r.footerSpacing}}drawBackground(e,t,r,s){const{xAlign:i,yAlign:o}=this,{x:a,y:l}=e,{width:c,height:u}=r,{topLeft:d,topRight:h,bottomLeft:f,bottomRight:p}=Xs(s.cornerRadius);t.fillStyle=s.backgroundColor,t.strokeStyle=s.borderColor,t.lineWidth=s.borderWidth,t.beginPath(),t.moveTo(a+d,l),o==="top"&&this.drawCaret(e,t,r,s),t.lineTo(a+c-h,l),t.quadraticCurveTo(a+c,l,a+c,l+h),o==="center"&&i==="right"&&this.drawCaret(e,t,r,s),t.lineTo(a+c,l+u-p),t.quadraticCurveTo(a+c,l+u,a+c-p,l+u),o==="bottom"&&this.drawCaret(e,t,r,s),t.lineTo(a+f,l+u),t.quadraticCurveTo(a,l+u,a,l+u-f),o==="center"&&i==="left"&&this.drawCaret(e,t,r,s),t.lineTo(a,l+d),t.quadraticCurveTo(a,l,a+d,l),t.closePath(),t.fill(),s.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,r=this.$animations,s=r&&r.x,i=r&&r.y;if(s||i){const o=Vo[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=mv(this,e),l=Object.assign({},o,this._size),c=gv(t,e,l),u=yv(e,l,c,t);(s._to!==u.x||i._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(t);const s={width:this.width,height:this.height},i={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const o=jt(t.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&a&&(e.save(),e.globalAlpha=r,this.drawBackground(i,e,s,t),lw(e,t.textDirection),i.y+=o.top,this.drawTitle(i,e,t),this.drawBody(i,e,t),this.drawFooter(i,e,t),cw(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const r=this._active,s=e.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),i=!ru(r,s),o=this._positionChanged(s,t);(i||o)&&(this._active=s,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,r=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,i=this._active||[],o=this._getActiveElements(e,i,t,r),a=this._positionChanged(o,e),l=t||!ru(o,i)||a;return l&&(this._active=o,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),l}_getActiveElements(e,t,r,s){const i=this.options;if(e.type==="mouseout")return[];if(!s)return t.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,i.mode,i,r);return i.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:r,caretY:s,options:i}=this,o=Vo[i.position].call(this,e,t);return o!==!1&&(r!==o.x||s!==o.y)}}G(hf,"positioners",Vo);var bE={id:"tooltip",_element:hf,positioners:Vo,afterInit(n,e,t){t&&(n.tooltip=new hf({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Nw},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},wE=Object.freeze({__proto__:null,Colors:A$,Decimation:I$,Filler:nE,Legend:lE,SubTitle:dE,Title:uE,Tooltip:bE});const _E=(n,e,t,r)=>(typeof e=="string"?(t=n.push(e)-1,r.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function kE(n,e,t,r){const s=n.indexOf(e);if(s===-1)return _E(n,e,t,r);const i=n.lastIndexOf(e);return s!==i?t:s}const xE=(n,e)=>n===null?null:Mt(Math.round(n),0,e);function wv(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class ff extends Si{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const r=this.getLabels();for(const{index:s,label:i}of t)r[s]===i&&r.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(Me(e))return null;const r=this.getLabels();return t=isFinite(t)&&r[t]===e?t:kE(r,e,be(t,e),this._addedLabels),xE(t,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:r,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),t||(s=this.getLabels().length-1)),this.min=r,this.max=s}buildTicks(){const e=this.min,t=this.max,r=this.options.offset,s=[];let i=this.getLabels();i=e===0&&t===i.length-1?i:i.slice(e,t+1),this._valueRange=Math.max(i.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let o=e;o<=t;o++)s.push({value:o});return s}getLabelForValue(e){return wv.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}G(ff,"id","category"),G(ff,"defaults",{ticks:{callback:wv}});function CE(n,e){const t=[],{bounds:s,step:i,min:o,max:a,precision:l,count:c,maxTicks:u,maxDigits:d,includeBounds:h}=n,f=i||1,p=u-1,{min:m,max:g}=e,b=!Me(o),_=!Me(a),M=!Me(c),k=(g-m)/(d+1);let C=my((g-m)/p/f)*f,x,D,O,E;if(C<1e-14&&!b&&!_)return[{value:m},{value:g}];E=Math.ceil(g/C)-Math.floor(m/C),E>p&&(C=my(E*C/p/f)*f),Me(l)||(x=Math.pow(10,l),C=Math.ceil(C*x)/x),s==="ticks"?(D=Math.floor(m/C)*C,O=Math.ceil(g/C)*C):(D=m,O=g),b&&_&&i&&y5((a-o)/i,C/1e3)?(E=Math.round(Math.min((a-o)/C,u)),C=(a-o)/E,D=o,O=a):M?(D=b?o:D,O=_?a:O,E=c-1,C=(O-D)/E):(E=(O-D)/C,ba(E,Math.round(E),C/1e3)?E=Math.round(E):E=Math.ceil(E));const R=Math.max(gy(C),gy(D));x=Math.pow(10,Me(l)?R:l),D=Math.round(D*x)/x,O=Math.round(O*x)/x;let W=0;for(b&&(h&&D!==o?(t.push({value:o}),D<o&&W++,ba(Math.round((D+W*C)*x)/x,o,_v(o,k,n))&&W++):D<o&&W++);W<E;++W){const K=Math.round((D+W*C)*x)/x;if(_&&K>a)break;t.push({value:K})}return _&&h&&O!==a?t.length&&ba(t[t.length-1].value,a,_v(a,k,n))?t[t.length-1].value=a:t.push({value:a}):(!_||O===a)&&t.push({value:O}),t}function _v(n,e,{horizontal:t,minRotation:r}){const s=Pn(r),i=(t?Math.sin(s):Math.cos(s))||.001,o=.75*e*(""+n).length;return Math.min(e/i,o)}class uu extends Si{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return Me(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:s,max:i}=this;const o=l=>s=t?s:l,a=l=>i=r?i:l;if(e){const l=er(s),c=er(i);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(s===i){let l=i===0?1:Math.abs(i*.05);a(i+l),e||o(s-l)}this.min=s,this.max=i}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:r}=e,s;return r?(s=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,s>1e3&&(console.warn("scales.".concat(this.id,".ticks.stepSize: ").concat(r," would result generating up to ").concat(s," ticks. Limiting to 1000.")),s=1e3)):(s=this.computeTickLimit(),t=t||11),t&&(s=Math.min(t,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const s={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},i=this._range||this,o=CE(s,i);return e.bounds==="ticks"&&Ub(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let t=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const s=(r-t)/Math.max(e.length-1,1)/2;t-=s,r+=s}this._startValue=t,this._endValue=r,this._valueRange=r-t}getLabelForValue(e){return al(e,this.chart.options.locale,this.options.ticks.format)}}class pf extends uu{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=lt(e)?e:0,this.max=lt(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,r=Pn(this.options.ticks.minRotation),s=(e?Math.sin(r):Math.cos(r))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,i.lineHeight/s))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}G(pf,"id","linear"),G(pf,"defaults",{ticks:{callback:Ju.formatters.numeric}});const Fa=n=>Math.floor(Zr(n)),Es=(n,e)=>Math.pow(10,Fa(n)+e);function kv(n){return n/Math.pow(10,Fa(n))===1}function xv(n,e,t){const r=Math.pow(10,t),s=Math.floor(n/r);return Math.ceil(e/r)-s}function SE(n,e){const t=e-n;let r=Fa(t);for(;xv(n,e,r)>10;)r++;for(;xv(n,e,r)<10;)r--;return Math.min(r,Fa(n))}function ME(n,{min:e,max:t}){e=an(n.min,e);const r=[],s=Fa(e);let i=SE(e,t),o=i<0?Math.pow(10,Math.abs(i)):1;const a=Math.pow(10,i),l=s>i?Math.pow(10,s):0,c=Math.round((e-l)*o)/o,u=Math.floor((e-l)/a/10)*a*10;let d=Math.floor((c-u)/Math.pow(10,i)),h=an(n.min,Math.round((l+u+d*Math.pow(10,i))*o)/o);for(;h<t;)r.push({value:h,major:kv(h),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(i++,d=2,o=i>=0?1:o),h=Math.round((l+u+d*Math.pow(10,i))*o)/o;const f=an(n.max,h);return r.push({value:f,major:kv(f),significand:d}),r}class mf extends Si{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const r=uu.prototype.parse.apply(this,[e,t]);if(r===0){this._zero=!0;return}return lt(r)&&r>0?r:null}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=lt(e)?Math.max(0,e):null,this.max=lt(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!lt(this._userMin)&&(this.min=e===Es(this.min,0)?Es(this.min,-1):Es(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let r=this.min,s=this.max;const i=a=>r=e?r:a,o=a=>s=t?s:a;r===s&&(r<=0?(i(1),o(10)):(i(Es(r,-1)),o(Es(s,1)))),r<=0&&i(Es(s,-1)),s<=0&&o(Es(r,1)),this.min=r,this.max=s}buildTicks(){const e=this.options,t={min:this._userMin,max:this._userMax},r=ME(t,this);return e.bounds==="ticks"&&Ub(r,this,"value"),e.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}getLabelForValue(e){return e===void 0?"0":al(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=Zr(e),this._valueRange=Zr(this.max)-Zr(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(Zr(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}G(mf,"id","logarithmic"),G(mf,"defaults",{ticks:{callback:Ju.formatters.logarithmic,major:{enabled:!0}}});function gf(n){const e=n.ticks;if(e.display&&n.display){const t=jt(e.backdropPadding);return be(e.font&&e.font.size,rt.font.size)+t.height}return 0}function TE(n,e,t){return t=Ze(t)?t:[t],{w:R5(n,e.string,t),h:t.length*e.lineHeight}}function Cv(n,e,t,r,s){return n===r||n===s?{start:e-t/2,end:e+t/2}:n<r||n>s?{start:e-t,end:e}:{start:e,end:e+t}}function OE(n){const e={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},t=Object.assign({},e),r=[],s=[],i=n._pointLabels.length,o=n.options.pointLabels,a=o.centerPointLabels?nt/i:0;for(let l=0;l<i;l++){const c=o.setContext(n.getPointLabelContext(l));s[l]=c.padding;const u=n.getPointPosition(l,n.drawingArea+s[l],a),d=kt(c.font),h=TE(n.ctx,d,n._pointLabels[l]);r[l]=h;const f=ln(n.getIndexAngle(l)+a),p=Math.round(Dp(f)),m=Cv(p,u.x,h.w,0,180),g=Cv(p,u.y,h.h,90,270);DE(t,e,f,m,g)}n.setCenterPoint(e.l-t.l,t.r-e.r,e.t-t.t,t.b-e.b),n._pointLabelItems=AE(n,r,s)}function DE(n,e,t,r,s){const i=Math.abs(Math.sin(t)),o=Math.abs(Math.cos(t));let a=0,l=0;r.start<e.l?(a=(e.l-r.start)/i,n.l=Math.min(n.l,e.l-a)):r.end>e.r&&(a=(r.end-e.r)/i,n.r=Math.max(n.r,e.r+a)),s.start<e.t?(l=(e.t-s.start)/o,n.t=Math.min(n.t,e.t-l)):s.end>e.b&&(l=(s.end-e.b)/o,n.b=Math.max(n.b,e.b+l))}function $E(n,e,t){const r=n.drawingArea,{extra:s,additionalAngle:i,padding:o,size:a}=t,l=n.getPointPosition(e,r+s+o,i),c=Math.round(Dp(ln(l.angle+ht))),u=NE(l.y,a.h,c),d=PE(c),h=RE(l.x,a.w,d);return{visible:!0,x:l.x,y:u,textAlign:d,left:h,top:u,right:h+a.w,bottom:u+a.h}}function EE(n,e){if(!e)return!0;const{left:t,top:r,right:s,bottom:i}=n;return!(Sr({x:t,y:r},e)||Sr({x:t,y:i},e)||Sr({x:s,y:r},e)||Sr({x:s,y:i},e))}function AE(n,e,t){const r=[],s=n._pointLabels.length,i=n.options,{centerPointLabels:o,display:a}=i.pointLabels,l={extra:gf(i)/2,additionalAngle:o?nt/s:0};let c;for(let u=0;u<s;u++){l.padding=t[u],l.size=e[u];const d=$E(n,u,l);r.push(d),a==="auto"&&(d.visible=EE(d,c),d.visible&&(c=d))}return r}function PE(n){return n===0||n===180?"center":n<180?"left":"right"}function RE(n,e,t){return t==="right"?n-=e:t==="center"&&(n-=e/2),n}function NE(n,e,t){return t===90||t===270?n-=e/2:(t>270||t<90)&&(n-=e),n}function IE(n,e,t){const{left:r,top:s,right:i,bottom:o}=t,{backdropColor:a}=e;if(!Me(a)){const l=Xs(e.borderRadius),c=jt(e.backdropPadding);n.fillStyle=a;const u=r-c.left,d=s-c.top,h=i-r+c.width,f=o-s+c.height;Object.values(l).some(p=>p!==0)?(n.beginPath(),za(n,{x:u,y:d,w:h,h:f,radius:l}),n.fill()):n.fillRect(u,d,h,f)}}function LE(n,e){const{ctx:t,options:{pointLabels:r}}=n;for(let s=e-1;s>=0;s--){const i=n._pointLabelItems[s];if(!i.visible)continue;const o=r.setContext(n.getPointLabelContext(s));IE(t,o,i);const a=kt(o.font),{x:l,y:c,textAlign:u}=i;pi(t,n._pointLabels[s],l,c+a.lineHeight/2,a,{color:o.color,textAlign:u,textBaseline:"middle"})}}function Iw(n,e,t,r){const{ctx:s}=n;if(t)s.arc(n.xCenter,n.yCenter,e,0,tt);else{let i=n.getPointPosition(0,e);s.moveTo(i.x,i.y);for(let o=1;o<r;o++)i=n.getPointPosition(o,e),s.lineTo(i.x,i.y)}}function zE(n,e,t,r,s){const i=n.ctx,o=e.circular,{color:a,lineWidth:l}=e;!o&&!r||!a||!l||t<0||(i.save(),i.strokeStyle=a,i.lineWidth=l,i.setLineDash(s.dash||[]),i.lineDashOffset=s.dashOffset,i.beginPath(),Iw(n,t,o,r),i.closePath(),i.stroke(),i.restore())}function BE(n,e,t){return _s(n,{label:t,index:e,type:"pointLabel"})}class Ho extends uu{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=jt(gf(this.options)/2),t=this.width=this.maxWidth-e.width,r=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+r/2+e.top),this.drawingArea=Math.floor(Math.min(t,r)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=lt(e)&&!isNaN(e)?e:0,this.max=lt(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/gf(this.options))}generateTickLabels(e){uu.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((t,r)=>{const s=Je(this.options.pointLabels.callback,[t,r],this);return s||s===0?s:""}).filter((t,r)=>this.chart.getDataVisibility(r))}fit(){const e=this.options;e.display&&e.pointLabels.display?OE(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,r,s){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((r-s)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,r,s))}getIndexAngle(e){const t=tt/(this._pointLabels.length||1),r=this.options.startAngle||0;return ln(e*t+Pn(r))}getDistanceFromCenterForValue(e){if(Me(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(Me(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const r=t[e];return BE(this.getContext(),e,r)}}getPointPosition(e,t,r=0){const s=this.getIndexAngle(e)-ht+r;return{x:Math.cos(s)*t+this.xCenter,y:Math.sin(s)*t+this.yCenter,angle:s}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:r,right:s,bottom:i}=this._pointLabelItems[e];return{left:t,top:r,right:s,bottom:i}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const r=this.ctx;r.save(),r.beginPath(),Iw(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),r.closePath(),r.fillStyle=e,r.fill(),r.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:r,grid:s,border:i}=t,o=this._pointLabels.length;let a,l,c;if(t.pointLabels.display&&LE(this,o),s.display&&this.ticks.forEach((u,d)=>{if(d!==0||d===0&&this.min<0){l=this.getDistanceFromCenterForValue(u.value);const h=this.getContext(d),f=s.setContext(h),p=i.setContext(h);zE(this,f,l,o,p)}}),r.display){for(e.save(),a=o-1;a>=0;a--){const u=r.setContext(this.getPointLabelContext(a)),{color:d,lineWidth:h}=u;!h||!d||(e.lineWidth=h,e.strokeStyle=d,e.setLineDash(u.borderDash),e.lineDashOffset=u.borderDashOffset,l=this.getDistanceFromCenterForValue(t.reverse?this.min:this.max),c=this.getPointPosition(a,l),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(c.x,c.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,r=t.ticks;if(!r.display)return;const s=this.getIndexAngle(0);let i,o;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(s),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((a,l)=>{if(l===0&&this.min>=0&&!t.reverse)return;const c=r.setContext(this.getContext(l)),u=kt(c.font);if(i=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){e.font=u.string,o=e.measureText(a.label).width,e.fillStyle=c.backdropColor;const d=jt(c.backdropPadding);e.fillRect(-o/2-d.left,-i-u.size/2-d.top,o+d.width,u.size+d.height)}pi(e,a.label,0,-i,u,{color:c.color,strokeColor:c.textStrokeColor,strokeWidth:c.textStrokeWidth})}),e.restore()}drawTitle(){}}G(Ho,"id","radialLinear"),G(Ho,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Ju.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}}),G(Ho,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),G(Ho,"descriptors",{angleLines:{_fallback:"grid"}});const ed={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Jt=Object.keys(ed);function Sv(n,e){return n-e}function Mv(n,e){if(Me(e))return null;const t=n._adapter,{parser:r,round:s,isoWeekday:i}=n._parseOpts;let o=e;return typeof r=="function"&&(o=r(o)),lt(o)||(o=typeof r=="string"?t.parse(o,r):t.parse(o)),o===null?null:(s&&(o=s==="week"&&(ro(i)||i===!0)?t.startOf(o,"isoWeek",i):t.startOf(o,s)),+o)}function Tv(n,e,t,r){const s=Jt.length;for(let i=Jt.indexOf(n);i<s-1;++i){const o=ed[Jt[i]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(a*o.size))<=r)return Jt[i]}return Jt[s-1]}function FE(n,e,t,r,s){for(let i=Jt.length-1;i>=Jt.indexOf(t);i--){const o=Jt[i];if(ed[o].common&&n._adapter.diff(s,r,o)>=e-1)return o}return Jt[t?Jt.indexOf(t):0]}function VE(n){for(let e=Jt.indexOf(n)+1,t=Jt.length;e<t;++e)if(ed[Jt[e]].common)return Jt[e]}function Ov(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:r,hi:s}=$p(t,e),i=t[r]>=e?t[r]:t[s];n[i]=!0}}function HE(n,e,t,r){const s=n._adapter,i=+s.startOf(e[0].value,r),o=e[e.length-1].value;let a,l;for(a=i;a<=o;a=+s.add(a,1,r))l=t[a],l>=0&&(e[l].major=!0);return e}function Dv(n,e,t){const r=[],s={},i=e.length;let o,a;for(o=0;o<i;++o)a=e[o],s[a]=o,r.push({value:a,major:!1});return i===0||!t?r:HE(n,r,s,t)}class Va extends Si{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const r=e.time||(e.time={}),s=this._adapter=new XD._date(e.adapters.date);s.init(t),va(r.displayFormats,s.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:Mv(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,r=e.time.unit||"day";let{min:s,max:i,minDefined:o,maxDefined:a}=this.getUserBounds();function l(c){!o&&!isNaN(c.min)&&(s=Math.min(s,c.min)),!a&&!isNaN(c.max)&&(i=Math.max(i,c.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),s=lt(s)&&!isNaN(s)?s:+t.startOf(Date.now(),r),i=lt(i)&&!isNaN(i)?i:+t.endOf(Date.now(),r)+1,this.min=Math.min(s,i-1),this.max=Math.max(s+1,i)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],r=e[e.length-1]),{min:t,max:r}}buildTicks(){const e=this.options,t=e.time,r=e.ticks,s=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const i=this.min,o=this.max,a=_5(s,i,o);return this._unit=t.unit||(r.autoSkip?Tv(t.minUnit,this.min,this.max,this._getLabelCapacity(i)):FE(this,a.length,t.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:VE(this._unit),this.initOffsets(s),e.reverse&&a.reverse(),Dv(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,r=0,s,i;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?t=1-s:t=(this.getDecimalForValue(e[1])-s)/2,i=this.getDecimalForValue(e[e.length-1]),e.length===1?r=i:r=(i-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;t=Mt(t,0,o),r=Mt(r,0,o),this._offsets={start:t,end:r,factor:1/(t+1+r)}}_generate(){const e=this._adapter,t=this.min,r=this.max,s=this.options,i=s.time,o=i.unit||Tv(i.minUnit,t,r,this._getLabelCapacity(t)),a=be(s.ticks.stepSize,1),l=o==="week"?i.isoWeekday:!1,c=ro(l)||l===!0,u={};let d=t,h,f;if(c&&(d=+e.startOf(d,"isoWeek",l)),d=+e.startOf(d,c?"day":o),e.diff(r,t,o)>1e5*a)throw new Error(t+" and "+r+" are too far apart with stepSize of "+a+" "+o);const p=s.ticks.source==="data"&&this.getDataTimestamps();for(h=d,f=0;h<r;h=+e.add(h,a,o),f++)Ov(u,h,p);return(h===r||s.bounds==="ticks"||f===1)&&Ov(u,h,p),Object.keys(u).sort(Sv).map(m=>+m)}getLabelForValue(e){const t=this._adapter,r=this.options.time;return r.tooltipFormat?t.format(e,r.tooltipFormat):t.format(e,r.displayFormats.datetime)}format(e,t){const s=this.options.time.displayFormats,i=this._unit,o=t||s[i];return this._adapter.format(e,o)}_tickFormatFunction(e,t,r,s){const i=this.options,o=i.ticks.callback;if(o)return Je(o,[e,t,r],this);const a=i.time.displayFormats,l=this._unit,c=this._majorUnit,u=l&&a[l],d=c&&a[c],h=r[t],f=c&&d&&h&&h.major;return this._adapter.format(e,s||(f?d:u))}generateTickLabels(e){let t,r,s;for(t=0,r=e.length;t<r;++t)s=e[t],s.label=this._tickFormatFunction(s.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+r)*t.factor)}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,r=this.ctx.measureText(e).width,s=Pn(this.isHorizontal()?t.maxRotation:t.minRotation),i=Math.cos(s),o=Math.sin(s),a=this._resolveTickFontOptions(0).size;return{w:r*i+a*o,h:r*o+a*i}}_getLabelCapacity(e){const t=this.options.time,r=t.displayFormats,s=r[t.unit]||r.millisecond,i=this._tickFormatFunction(e,0,Dv(this,[e],this._majorUnit),s),o=this._getLabelSize(i),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],t,r;if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(t=0,r=s.length;t<r;++t)e=e.concat(s[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,r;if(e.length)return e;const s=this.getLabels();for(t=0,r=s.length;t<r;++t)e.push(Mv(this,s[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Kb(e.sort(Sv))}}G(Va,"id","time"),G(Va,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Hl(n,e,t){let r=0,s=n.length-1,i,o,a,l;t?(e>=n[r].pos&&e<=n[s].pos&&({lo:r,hi:s}=Cr(n,"pos",e)),{pos:i,time:a}=n[r],{pos:o,time:l}=n[s]):(e>=n[r].time&&e<=n[s].time&&({lo:r,hi:s}=Cr(n,"time",e)),{time:i,pos:a}=n[r],{time:o,pos:l}=n[s]);const c=o-i;return c?a+(l-a)*(e-i)/c:a}class yf extends Va{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=Hl(t,this.min),this._tableRange=Hl(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:r}=this,s=[],i=[];let o,a,l,c,u;for(o=0,a=e.length;o<a;++o)c=e[o],c>=t&&c<=r&&s.push(c);if(s.length<2)return[{time:t,pos:0},{time:r,pos:1}];for(o=0,a=s.length;o<a;++o)u=s[o+1],l=s[o-1],c=s[o],Math.round((u+l)/2)!==c&&i.push({time:c,pos:o/(a-1)});return i}_generate(){const e=this.min,t=this.max;let r=super.getDataTimestamps();return(!r.includes(e)||!r.length)&&r.splice(0,0,e),(!r.includes(t)||r.length===1)&&r.push(t),r.sort((s,i)=>s-i)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),r=this.getLabelTimestamps();return t.length&&r.length?e=this.normalize(t.concat(r)):e=t.length?t:r,e=this._cache.all=e,e}getDecimalForValue(e){return(Hl(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return Hl(this._table,r*this._tableRange+this._minPos,!0)}}G(yf,"id","timeseries"),G(yf,"defaults",Va.defaults);var WE=Object.freeze({__proto__:null,CategoryScale:ff,LinearScale:pf,LogarithmicScale:mf,RadialLinearScale:Ho,TimeScale:Va,TimeSeriesScale:yf});const jE=[JD,S$,wE,WE];Fp.register(...jE);let $v=0;function bo(n="id"){return $v++,zu({id:"".concat(n,"-").concat($v)})}const UE=B({props:{data:{type:Object,required:!0},type:{type:String,default:"bar"}},setup(n){const{id:e}=bo("bar-chart"),t=Object.keys(n.data),r="MM/YY",s=ps(t.shift()||"",r),i=ps(t.pop()||"",r);return Ve(()=>{const o=document.getElementById(e),a=o==null?void 0:o.getContext("2d");if(!a)return;const l="#B6CFFB",c="#3558A2";let u={data:Object.values(n.data),type:n.type};if(n.type==="bar"){const d=u;d.barPercentage=1,d.categoryPercentage=.9,d.backgroundColor=d.data.map((h,f)=>f===d.data.length-1?c:l),u=d}new Fp(a,{data:{labels:Object.keys(n.data),datasets:[u]},options:{animation:!1,responsive:!0,locale:mp,plugins:{legend:{display:!1},tooltip:{enabled:!1}},elements:{bar:{backgroundColor:l,borderRadius:2,hoverBackgroundColor:c},line:{backgroundColor:c,borderColor:c,borderJoinStyle:"round",tension:.35},point:{radius:0}},scales:{x:{display:!1,grid:{display:!1},ticks:{display:!1}},y:{display:!1,grid:{display:!1},ticks:{display:!1}}},layout:{padding:{top:1.5}}}})}),{id:e,startDate:s,endDate:i}}}),qE=["id"],YE={class:"fr-grid-row justify-between"},KE={class:"text-xxs fr-m-0 text-mention-grey"},GE={class:"text-xxs fr-m-0 text-mention-grey"};function JE(n,e,t,r,s,i){return w(),S(J,null,[v("canvas",{id:n.id,width:"120",height:"30"},null,8,qE),v("div",YE,[v("p",KE,T(n.startDate),1),v("p",GE,T(n.endDate),1)])],64)}const XE=$e(UE,[["render",JE]]),QE=B({props:{author:{type:Object,required:!0},badge:Boolean}}),ZE={class:"fr-text--sm fr-mb-0"},e6={key:0,class:"fr-badge fr-ml-3v"};function t6(n,e,t,r,s,i){return w(),S("span",ZE,[U(T(n.author.first_name+" "+n.author.last_name)+" ",1),n.badge?(w(),S("span",e6,T(n.$t("Admin")),1)):I("",!0)])}const du=$e(QE,[["render",t6]]),n6=B({emits:["click"],props:{primary:{type:Boolean,default:!1}}});function r6(n,e,t,r,s,i){return w(),S("button",{type:"button",class:ue(["fr-btn",{"fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 fr-icon-add-line fr-btn--icon-left":!n.primary}]),onClick:e[0]||(e[0]=Se(o=>n.$emit("click"),["prevent"]))},T(n.$t("Start a new discussion")),3)}const vf=$e(n6,[["render",r6]]),s6={};function i6(n,e){const t=dt("i18n-t");return w(),Y(t,{keypath:"Fields preceded by a star ({markup}) are required.",tag:"p",class:"fr-mt-0 fr-mb-1w fr-text--xs",scope:"global"},{markup:q(()=>e[0]||(e[0]=[v("span",{class:"required-field-star"},"*",-1)])),_:1})}const Wp=$e(s6,[["render",i6]]),o6=B({expose:["displayForm"],components:{ThreadCreateButton:vf,Author:du,RequiredExplanation:Wp},props:{showCreateButton:{type:Boolean,default:!1},subjectId:{type:String,required:!0},subjectClass:{type:String,required:!0},onSubmit:{type:Function,required:!0}},setup(n){const e=$(!1),t=$(!1),r=$(""),s=$("");return{loading:e,showForm:t,title:r,comment:s,user:ma,displayForm:()=>{nl(),t.value=!0},hideForm:()=>{t.value=!1},submit:()=>{e.value=!0;const l={title:r.value,comment:s.value,subject:{id:n.subjectId,class:n.subjectClass}};n.onSubmit(l).finally(()=>{var c;e.value=!1,t.value=!1,r.value=s.value="",(c=document.querySelector("[data-no-discussion]"))==null||c.remove()})}}}}),a6={class:"thread-create fr-mt-2w"},l6={key:1,class:"bg-contrast-grey"},c6={class:"fr-grid-row fr-grid-row--middle fr-py-2w fr-px-3w"},u6={class:"fr-col fr-h6 fr-mb-0"},d6={class:"thread-comment fr-pb-3w fr-px-3w"},h6={class:"fr-input-group"},f6={for:"thread-title",class:"fr-label required"},p6=["placeholder"],m6={class:"fr-input-group"},g6={for:"thread-comment",class:"fr-label required"},y6=["placeholder"],v6={class:"fr-grid-row justify-between fr-grid-row--middle"},b6={class:"text-mention-grey fr-text--sm fr-mb-0"},w6=["value"];function _6(n,e,t,r,s,i){const o=dt("ThreadCreateButton"),a=dt("RequiredExplanation"),l=dt("Author");return w(),S("div",a6,[n.showCreateButton&&!n.showForm?(w(),Y(o,{key:0,onClick:n.displayForm},null,8,["onClick"])):I("",!0),n.showForm?(w(),S("div",l6,[v("div",c6,[v("div",u6,T(n.$t("New discussion")),1),v("div",null,[v("button",{class:"fr-btn--close fr-btn text-grey-500 fr-mr-0",onClick:e[0]||(e[0]=(...c)=>n.hideForm&&n.hideForm(...c))},T(n.$t("Close")),1)])]),v("div",d6,[v("form",{class:"form fr-p-0",onSubmit:e[3]||(e[3]=Se((...c)=>n.submit&&n.submit(...c),["prevent"]))},[P(a),v("div",h6,[v("label",f6,T(n.$t("Title")),1),yt(v("input",{class:"fr-input",type:"text",id:"thread-title","onUpdate:modelValue":e[1]||(e[1]=c=>n.title=c),placeholder:n.$t("Title"),required:!0},null,8,p6),[[fs,n.title]])]),v("div",m6,[v("label",g6,T(n.$t("Message")),1),yt(v("textarea",{id:"thread-comment","onUpdate:modelValue":e[2]||(e[2]=c=>n.comment=c),placeholder:n.$t("Comment"),class:"fr-input",required:!0},null,8,y6),[[fs,n.comment]])]),v("footer",v6,[v("span",b6,[U(T(n.$t("Reply as"))+" ",1),P(l,{author:n.user},null,8,["author"])]),v("input",{type:"submit",value:n.$t("Submit"),class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500"},null,8,w6)])],32)])])):I("",!0)])}const Lw=$e(o6,[["render",_6]]);var k6=Object.defineProperty,x6=(n,e,t)=>e in n?k6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Wl=(n,e,t)=>(x6(n,typeof e!="symbol"?e+"":e,t),t);const Rs={TOP_RIGHT:"top-right",TOP:"top",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",BOTTOM:"bottom",BOTTOM_LEFT:"bottom-left"};function Ev(n,e,t){let r=e;switch(n){case Rs.TOP:case Rs.TOP_RIGHT:case Rs.TOP_LEFT:r=e;break;case Rs.BOTTOM:case Rs.BOTTOM_RIGHT:case Rs.BOTTOM_LEFT:r=t;break}return r}const C6=n=>{typeof n.remove<"u"?n.remove():n.parentNode&&n.parentNode.removeChild(n)};class S6{constructor(e,t){Wl(this,"startedAt"),Wl(this,"callback"),Wl(this,"delay"),Wl(this,"timer"),this.startedAt=Date.now(),this.callback=e,this.delay=t,this.timer=setTimeout(e,t)}pause(){this.stop(),this.delay-=Date.now()-this.startedAt}resume(){this.stop(),this.startedAt=Date.now(),this.timer=setTimeout(this.callback,this.delay)}stop(){clearTimeout(this.timer)}}function M6(n){return{all:n=n||new Map,on:function(e,t){var r=n.get(e);r?r.push(t):n.set(e,[t])},off:function(e,t){var r=n.get(e);r&&(t?r.splice(r.indexOf(t)>>>0,1):n.set(e,[]))},emit:function(e,t){var r=n.get(e);r&&r.slice().map(function(s){s(t)}),(r=n.get("*"))&&r.slice().map(function(s){s(e,t)})}}}const bf=M6(),T6=B({__name:"Toaster",props:{message:{},type:{default:"default"},position:{default:Rs.BOTTOM_RIGHT},maxToasts:{type:[Number,Boolean],default:!1},duration:{type:[Number,Boolean],default:4e3},dismissible:{type:Boolean,default:!0},queue:{type:Boolean,default:!1},props:{type:Boolean,default:!0},useDefaultCss:{type:Boolean,default:!0},onClose:{type:Function,default:()=>{}},onClick:{type:Function,default:()=>{}}},setup(n){const e=n;let t=null,r=null,s=null,i;const o=$(null),a=$(!1);hp(()=>{l(),c(),u()}),Ve(()=>{h(),bf.on("toast-clear",g)});function l(){t=document.querySelector(".c-toast-container--top"),r=document.querySelector(".c-toast-container--bottom"),!(t&&r)&&(t||(t=document.createElement("div"),t.className="c-toast-container c-toast-container--top"),r||(r=document.createElement("div"),r.className="c-toast-container c-toast-container--bottom"))}function c(){const k=e.useDefaultCss?"add":"remove";t&&t.classList[k]("v--default-css"),r&&r.classList[k]("v--default-css")}function u(){const k=document.body;t&&k.appendChild(t),r&&k.appendChild(r)}function d(){if(!e.queue&&e.maxToasts===!1)return!1;let k=0;t&&(k=t.childElementCount);let C=0;return r&&(C=r.childElementCount),e.maxToasts!==!1?e.maxToasts<=k+C:k>0||C>0}function h(){if(d()){i=window.setTimeout(h,250);return}const k=b();k&&o.value&&(k.insertAdjacentElement("afterbegin",o.value),a.value=!0,s=e.duration!==!1?new S6(g,e.duration):null)}function f(){e.onClick.apply(null,arguments),e.dismissible&&g()}function p(k){s&&(k?s.pause():s.resume())}function m(){s&&s.stop(),clearTimeout(i)}function g(){m(),a.value=!1,setTimeout(()=>{e.onClose.apply(null,arguments),o.value&&C6(o.value)},150)}function b(){return!t||!r?null:Ev(e.position,t,r)}const _=A(()=>Ev(e.position,{enter:"fadeInDown",leave:"fadeOut"},{enter:"fadeInUp",leave:"fadeOut"})),M=A(()=>e.dismissible?"button":"div");return U0(()=>{bf.off("toast-clear",g)}),(k,C)=>(w(),Y(tl,{"enter-active-class":_.value.enter,"leave-active-class":_.value.leave,ref_key:"el",ref:o},{default:q(()=>[yt((w(),Y(Js(M.value),{class:ue(["c-toast","c-toast--".concat(k.type),"c-toast--".concat(k.position)]),onMouseover:C[0]||(C[0]=x=>p(!0)),onMouseleave:C[1]||(C[1]=x=>p(!1)),onClick:f,role:"alert"},{default:q(()=>[U(T(k.message),1)]),_:1},40,["class"])),[[Kr,a.value]])]),_:1},8,["enter-active-class","leave-active-class"]))}}),O6=()=>typeof document<"u"?document.createElement("div"):null;function D6(n,{props:e}={}){let t=O6(),r=wt(n,e);return t&&Xg(r,t),{vNode:r,destroy:()=>{t&&Xg(null,t),t=null,r=null},el:t}}function $6(n={}){return{show(e,t={}){let r={message:e,...t};return D6(T6,{props:{...n,...r}})},clear(){bf.emit("toast-clear")},success(e,t={}){return t.type="success",this.show(e,t)},error(e,t={}){return t.type="error",this.show(e,t)},info(e,t={}){return t.type="info",this.show(e,t)},warning(e,t={}){return t.type="warning",this.show(e,t)}}}const E6=$6({duration:!1,dismissible:!0});function Mn(){return{toast:E6}}const A6=B({components:{Author:du,RequiredExplanation:Wp},emits:["close"],props:{onSubmit:{type:Function,required:!0}},setup(n){const{t:e}=Te(),{toast:t}=Mn(),r=$(!1),s=$("");return{comment:s,loading:r,submit:()=>{r.value=!0,n.onSubmit(s.value).catch(o=>{t.error(e("Error sending response"))}).finally(()=>{r.value=!1,s.value=""})},user:ma}}}),P6={class:"thread-reply"},R6={class:"fr-grid-row fr-grid-row--middle fr-mb-3v"},N6={class:"fr-col fr-text--bold fr-mb-0"},I6={class:"fr-col-auto"},L6={class:"fr-input-group"},z6={class:"fr-label required",for:"textarea"},B6={class:"fr-grid-row justify-between fr-grid-row--middle"},F6={class:"text-mention-grey fr-text--sm fr-m-0"},V6=["value"];function H6(n,e,t,r,s,i){const o=dt("RequiredExplanation"),a=dt("Author");return w(),S("div",P6,[v("div",R6,[v("h4",N6,T(n.$t("Reply to the discussion")),1),v("div",I6,[v("button",{class:"fr-btn--close fr-btn text-grey-500 fr-mr-0",onClick:e[0]||(e[0]=l=>n.$emit("close"))},T(n.$t("Close")),1)])]),v("form",{class:"form fr-p-0",onSubmit:e[2]||(e[2]=Se((...l)=>n.submit&&n.submit(...l),["prevent"]))},[P(o),v("div",L6,[v("label",z6,T(n.$t("Comment")),1),yt(v("textarea",{"onUpdate:modelValue":e[1]||(e[1]=l=>n.comment=l),required:"",class:"fr-input",id:"textarea"},null,512),[[fs,n.comment]])]),v("footer",B6,[v("p",F6,[U(T(n.$t("Reply as"))+" ",1),P(a,{author:n.user},null,8,["author"])]),v("input",{type:"submit",value:n.$t("Submit"),class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500"},null,8,V6)])],32)])}const W6=$e(A6,[["render",H6]]),Av=B({__name:"MarkAsNoSpam",props:{url:{},spam:{}},setup(n){const e=n,t=()=>mt.delete(e.url).then(()=>{window.location.reload()}),r=A(()=>e.spam&&e.spam.status&&e.spam.status==="potential_spam"&&ma&&ma.roles&&ma.roles.includes("admin"));return(s,i)=>r.value?(w(),S("button",{key:0,class:"fr-btn fr-btn--sm fr-btn--icon-right fr-icon-feedback-fill",onClick:t},T(s.$t("Mark as no spam")),1)):I("",!0)}}),j6=["id"],U6={class:"fr-grid-row fr-grid-row--middle justify-between fr-py-2w fr-px-3w no-wrap wrap-md"},q6={key:0,class:"fr-col-auto text-default-warning fr-text--bold fr-pr-2w fr-my-0"},Y6={class:"fr-col fr-mx-3v fr-mx-md-0 fr-h6 fr-mb-0"},K6={class:"fr-col-auto text-align-right"},G6=["id","data-clipboard-text"],J6={class:"fr-grid-row fr-grid-row--gutters"},X6={class:"fr-col-auto"},Q6={class:"fr-col"},Z6={class:"fr-my-0"},eA={class:"fr-text--sm text-mention-grey fr-m-0"},tA={class:"white-space-pre-wrap overflow-wrap-anywhere"},nA={class:"fr-my-0"},rA={key:0,class:"fr-py-2w fr-px-3w"},sA={class:"fr-py-2w fr-px-3w"},iA={key:1,class:"text-grey-380"},oA={class:"fr-px-1v"},Pv=B({__name:"Thread",props:{thread:{}},setup(n){const e=n,{t}=Te(),r=$(!1),s=$([...e.thread.discussion]),i=$(!!e.thread.closed),o=A(()=>"discussions/"+e.thread.id),a=A(()=>{const u="#/"+o.value;return window.location.origin+window.location.pathname+u}),l=()=>{nl(),r.value=!0},c=u=>mt.post("/discussions/"+e.thread.id+"/",{comment:u}).then(d=>d.data).then(d=>{s.value=d.discussion,r.value=!1});return(u,d)=>(w(),S("div",{class:"bg-contrast-grey fr-mt-2w",id:o.value},[v("header",U6,[u.thread.closed?(w(),S("p",q6,[v("span",null,T(y(t)("Discussion closed")),1)])):I("",!0),v("h3",Y6,T(u.thread.title),1),v("div",K6,[P(Av,{url:"discussions/".concat(u.thread.id,"/spam"),spam:u.thread.spam,class:"fr-mr-3v"},null,8,["url","spam"]),v("button",{id:u.thread.id+"-copy","data-clipboard-text":a.value,class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 fr-btn--icon-right fr-icon-links-fill"},T(y(t)("Copy discussion permalink")),9,G6)])]),v("div",null,[P(V2,{name:"list"},{default:q(()=>[i.value?I("",!0):(w(!0),S(J,{key:0},Fe(s.value,(h,f)=>(w(),S("article",{class:"thread-comment fr-py-3w fr-px-3w fr-pr-5w",key:"comment-".concat(u.thread.id,"-").concat(f)},[v("div",J6,[v("div",X6,[P(y(Q0),{user:h.posted_by},null,8,["user"])]),v("div",Q6,[v("p",Z6,[P(du,{author:h.posted_by,badge:!1},null,8,["author"])]),v("p",eA,T(y(ps)(h.posted_on)),1),P(y(Lb),{class:"fr-mt-3v"},{default:q(()=>[v("div",tA,[v("p",nA,T(h.content),1)])]),_:2},1024),P(Av,{url:"discussions/".concat(u.thread.id,"/comments/").concat(f,"/spam"),spam:h.spam,class:"fr-mt-3v"},null,8,["url","spam"])])])]))),128))]),_:1}),i.value?(w(),S("div",rA,[v("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500",onClick:d[0]||(d[0]=Se(h=>i.value=!1,["prevent"]))},T(y(t)("See {n} messages",s.value.length)),1)])):I("",!0)]),v("footer",sA,[!u.thread.closed&&!y(Hu)?(w(),S(J,{key:0},[r.value?(w(),Y(W6,{key:1,subjectId:u.thread.id,onSubmit:c,onClose:d[1]||(d[1]=h=>r.value=!1)},null,8,["subjectId"])):(w(),S("button",{key:0,class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500 fr-btn--icon-right fr-icon-arrow-right-s-line",onClick:Se(l,["stop"])},T(y(t)("Reply")),1))],64)):I("",!0),u.thread.closed?(w(),S("div",iA,[U(T(y(t)("The discussion was closed by"))+" ",1),v("strong",oA,[P(du,{author:u.thread.closed_by},null,8,["author"])]),U(" "+T(y(t)("on"))+" "+T(y(ps)(u.thread.closed)),1)])):I("",!0)])],8,j6))}}),aA={components:{ContentLoader:il}};function lA(n,e,t,r,s,i){const o=dt("ContentLoader");return w(),Y(o,{width:280,height:180,speed:2,primaryColor:"#7c7c7c",secondaryColor:"#2d2d2d"},{default:q(()=>e[0]||(e[0]=[v("rect",{x:"104",y:"41",rx:"3",ry:"3",width:"162",height:"10"},null,-1),v("rect",{x:"105",y:"63",rx:"3",ry:"3",width:"139",height:"5"},null,-1),v("rect",{x:"26",y:"99",rx:"5",ry:"5",width:"60",height:"60"},null,-1),v("rect",{x:"104",y:"113",rx:"3",ry:"3",width:"162",height:"10"},null,-1),v("rect",{x:"105",y:"135",rx:"3",ry:"3",width:"139",height:"5"},null,-1),v("rect",{x:"26",y:"24",rx:"5",ry:"5",width:"60",height:"60"},null,-1)])),_:1})}const cA=$e(aA,[["render",lA]]);function uA(n){const e=$(null),t=()=>{const s=window.location.hash;for(const i of n){let[o,a,l]=i.exec(s)||[];if(a)return e.value=a}e.value=null},r=()=>{history.pushState(null,""," "),window.dispatchEvent(new HashChangeEvent("hashchange"))};return Ve(()=>{t(),window.addEventListener("hashchange",()=>t())}),{id:zu(e),resetHash:r}}const dA={key:0,class:"fr-grid-row fr-grid-row--middle"},hA={class:"fr-col"},fA={id:"community-discussions",class:"subtitle subtitle--uppercase"},pA={key:0,class:"fr-col-12 fr-col-md-6 fr-grid-row fr-grid-row--gutters fr-grid-row--middle fr-grid-row--right"},mA={class:"fr-col-auto"},gA=["aria-label"],yA=["value","selected"],vA={class:"fr-col-auto"},bA={key:1,class:"fr-grid-row fr-grid-row--center"},wA={key:0},_A={class:"fr-grid-row fr-grid-row--middle justify-between"},kA={class:"text-decoration-underline"},xA={key:1},CA={class:"fr-mb-5v"},th=5,SA=B({__name:"Threads",props:{subjectId:{},subjectClass:{}},setup(n,{expose:e}){const t=n,{t:r}=Te(),{toast:s}=Mn(),i=$([]),o=/discussions\/([a-f0-9]{24})-?([0-9]+)?$/i,a=/discussion-([a-f0-9]{24})-?([0-9]+)?$/i,{id:l,resetHash:c}=uA([o,a]),u=$(null),d=$(1),h=$(0),f=$(!0),p=[{name:r("Discussion creation"),key:"-created"},{name:r("Last reply"),key:"-discussion.posted_on"}],m=$(p[0]),g=$(null),b=()=>{_(l.value)},_=R=>{if(R)return f.value=!0,setTimeout(()=>{g.value&&g.value.scrollIntoView({behavior:"smooth"})},500),mt.get("/discussions/"+R).then(W=>W.data).then(W=>{W&&(u.value=W,h.value=1)}).catch(()=>{s.error(r("An error occurred while fetching the discussion ")+R),M(1)}).finally(()=>{f.value=!1})},M=(R=1,W=!1)=>(R=at(R),f.value=!0,W&&setTimeout(()=>{g.value&&g.value.scrollIntoView({behavior:"smooth"})},500),mt.get("/discussions/",{params:{page:R,for:t.subjectId,sort:m.value.key,page_size:th}}).then(K=>K.data).then(K=>{K.data&&(i.value=K.data,h.value=K.total)}).catch(()=>{s.error(r("An error occurred while fetching discussions")),i.value=[]}).finally(()=>{f.value=!1})),k=$(null),C=()=>{x(),k.value&&k.value.$el.scrollIntoView()},x=()=>{k.value&&k.value.displayForm()},D=R=>mt.post("/discussions/",R).then(()=>{d.value=1,M(1,!0)}).catch(W=>s.error(r("An error occurred while creating the discussion "),W)),O=(R,W=!0)=>{d.value=R,M(R,W)},E=R=>{m.value=R,M(d)};return Ve(()=>{M()}),It(()=>{l.value&&b()}),et(h,R=>{const W=document.querySelectorAll(".discussions-count");W&&W.forEach(K=>K.innerHTML=R.toFixed(0))}),e({startThread:C}),(R,W)=>(w(),S("section",{class:"discussions-wrapper",ref_key:"top",ref:g},[h.value?(w(),S("div",dA,[v("div",hA,[v("h2",fA,T(y(r)("{n} discussions",h.value)),1)]),y(l)?I("",!0):(w(),S("div",pA,[v("div",mA,[yt(v("select",{name:"sortBy",id:"sortBy","aria-label":y(r)("Sort discussions by"),onChange:W[0]||(W[0]=K=>E(m.value)),"onUpdate:modelValue":W[1]||(W[1]=K=>m.value=K),class:"fr-select fr-select--no-border fr-select--blue"},[(w(),S(J,null,Fe(p,K=>v("option",{value:K,selected:K===m.value},T(K.name),9,yA)),64))],40,gA),[[Bu,m.value]])]),v("div",vA,[P(vf,{onClick:x})])]))])):(w(),S("div",bA,[P(vf,{class:"fr-col--bottom",primary:!0,onClick:x})])),P(tl,{mode:"out-in"},{default:q(()=>[f.value?(w(),Y(cA,{key:0,class:"fr-mt-2w"})):(w(),S(J,{key:1},[y(l)?(w(),S("div",wA,[P(y(nu),{type:"secondary",color:"success",class:"fr-mt-2w","data-cy":"threadFromURL"},{default:q(()=>[v("div",_A,[U(T(y(r)("You are seeing a specific discussion about this dataset."))+" ",1),v("button",{class:"fr-btn--close fr-btn fr-mr-0",onClick:W[2]||(W[2]=Se((...K)=>y(c)&&y(c)(...K),["prevent"]))},T(y(r)("Close")),1)])]),_:1}),u.value?(w(),Y(Pv,{key:0,thread:u.value},null,8,["thread"])):(w(),Y(y(nu),{key:1,type:"secondary",color:"warning",class:"fr-mt-2w"},{default:q(()=>[U(T(R.$t("This discussion doesn't exist or was deleted.")),1)]),_:1})),v("button",{class:"nav-link nav-link--no-icon text-decoration-none fr-link fr-mt-9v fr-link--icon-left fr-icon-arrow-right-s-line",onClick:W[3]||(W[3]=Se((...K)=>y(c)&&y(c)(...K),["prevent"]))},[v("span",kA,T(y(r)("See all discussions about this dataset")),1)])])):(w(),S("div",xA,[y(Hu)?I("",!0):(w(),Y(Lw,{key:0,ref_key:"createThread",ref:k,onSubmit:D,subjectId:R.subjectId,subjectClass:R.subjectClass},null,8,["subjectId","subjectClass"])),v("ul",CA,[(w(!0),S(J,null,Fe(i.value,K=>(w(),S("li",null,[P(Pv,{thread:K},null,8,["thread"])]))),256))]),h.value>th?(w(),Y(y(Ci),{key:1,page:d.value,"page-size":th,"total-results":h.value,onChange:O},null,8,["page","total-results"])):I("",!0)]))],64))]),_:1})],512))}}),MA=["href"],TA={class:"fr-grid-row fr-grid-row--middle"},OA=B({__name:"MenuSearchOption",props:{icon:{},query:{},link:{},type:{}},setup(n){return(e,t)=>{const r=dt("i18n-t");return w(),S("a",{class:"fr-nav__link unstyled",href:e.link},[v("div",TA,[v("span",{class:ue(["fr-icon--sm align-[-1px] fr-mr-1w",e.icon]),"aria-hidden":"true"},null,2),e.query?(w(),Y(r,{key:0,keypath:"Search {query} in {type}",class:"fr-col",tag:"div",scope:"global"},{query:q(()=>[v("em",null,T(e.query),1)]),type:q(()=>[v("strong",null,T(e.type),1)]),_:1})):(w(),Y(r,{key:1,keypath:"Start typing to search in X",class:"fr-col",tag:"div",scope:"global"},{type:q(()=>[v("strong",null,T(e.type),1)]),_:1})),t[0]||(t[0]=v("div",{"aria-hidden":"true",class:"fr-col-auto"},[v("span",{class:"fr-icon-arrow-right-s-line fr-icon--sm","aria-hidden":"true"})],-1))])],8,MA)}}});function zw(n){const e=A(()=>"".concat(nC,"?q=").concat(at(n))),t=A(()=>"".concat(rC,"?q=").concat(at(n))),r=A(()=>"".concat(sC,"?q=").concat(at(n))),s=A(()=>"".concat(iC,"?q=").concat(at(n)));return{dataserviceUrl:t,datasetUrl:e,organizationUrl:r,reuseUrl:s}}function DA(){const n=xi("collapse"),e=$(!1),t=()=>e.value=!0,r=()=>e.value=!1,s=()=>e.value=!e.value;let i=null;const o=(d,h,f)=>{const p=at(d),m=at(h),g=at(f);i=c(p,m,g),document.body.addEventListener("pointerup",i,!0)},a=()=>{i&&document.body.removeEventListener("pointerup",i,!0)},l=(d,h)=>d?!d.contains(h):!0,c=(d,h,f)=>p=>{const m=p.target;l(d,m)&&l(h,m)&&l(f,m)&&r()};return{expanded:e,uid:n,show:t,hide:r,toggle:s,registerBackgroundEvent:o,removeBackgroundEvent:a,handleKeyPressForCollapse:d=>{switch(d.key){case"Alt":case"Control":case"Shift":case"CapsLock":break;case"Escape":case"Tab":r();break;default:t()}}}}function $A(n){const e=$(),t=A(()=>at(n).find(h=>h.id===e.value)),r=h=>e.value===h,s=h=>{if(h===void 0)return o(0);e.value=h},i=()=>{e.value=void 0},o=h=>{let f=at(n);f[h]&&s(f[h].id)},a=()=>{let h=0;e.value&&(h=at(n).findIndex(f=>f.id===e.value),h++,h===at(n).length&&(h=0)),o(h)},l=()=>{const h=at(n).length-1;let f=h;e.value&&(f=at(n).findIndex(p=>p.id===e.value),f--,f<0&&(f=h)),o(f)};return{select:s,selected:e,selectedOption:t,isSelected:r,focusOut:i,handleKeyPressForActiveDescendant:(h,f=!1)=>{switch(h.key){case"ArrowDown":!f&&!h.altKey&&a();break;case"ArrowUp":l();break;case"ArrowLeft":case"ArrowRight":case"Home":case"End":case"Escape":i();break}},ALREADY_MOVED_DOWN:!0,NOT_MOVED_YET:!1}}function EA(n,e){const t=$(null),r=$(null),s=$(null),{expanded:i,handleKeyPressForCollapse:o,hide:a,registerBackgroundEvent:l,removeBackgroundEvent:c,show:u,uid:d}=DA(),{focusOut:h,handleKeyPressForActiveDescendant:f,isSelected:p,select:m,selected:g,selectedOption:b,NOT_MOVED_YET:_,ALREADY_MOVED_DOWN:M}=$A(n);function k(){at(e)&&(u(),m(g.value))}function C(){var E;i.value?x():((E=t.value)==null||E.focus(),k())}function x(){b.value&&(window.location.href=b.value.link)}function D(E){k();let R=_;i.value||(R=M),o(E),f(E,R)}function O(){h(),a()}return Ve(()=>{l(t,r,s)}),Nn(()=>{c()}),{buttonRef:s,expanded:i,focusOut:h,handleFocusOut:O,handleKeyDown:D,handleKeyPressForActiveDescendant:f,handleKeyPressForCollapse:o,hide:a,inputRef:t,isSelected:p,listRef:r,registerBackgroundEvent:l,removeBackgroundEvent:c,searchSelectedOption:x,select:m,selected:g,show:u,showAndFocus:C,showAndSelectIfQuery:k,uid:d,NOT_MOVED_YET:_,ALREADY_MOVED_DOWN:M}}const AA=["id"],PA=["for","id"],RA=["placeholder","aria-controls","aria-expanded","id","aria-activedescendant"],NA=["aria-controls","aria-expanded"],IA=["id","aria-labelledby"],LA={class:"fr-menu__list",role:"listbox"},zA=["id","aria-selected"],BA=B({__name:"MenuSearch",setup(n){const{t:e}=Te(),t=$(""),{datasetUrl:r,dataserviceUrl:s,reuseUrl:i,organizationUrl:o}=zw(t),{id:a}=bo("search"),l=A(()=>"".concat(a,"-input")),c=A(()=>"".concat(a,"-label")),u=$([{id:"dataset-option",icon:"fr-icon-database-line",type:e("datasets"),link:r},{id:"dataservice-option",icon:"fr-icon-code-s-slash-line",type:e("dataservices"),link:s},{id:"reuse-option",icon:"fr-icon-line-chart-line",type:e("reuses"),link:i},{id:"organization-option",icon:"fr-icon-government-line",type:e("organizations"),link:o}]),{buttonRef:d,expanded:h,handleFocusOut:f,handleKeyDown:p,inputRef:m,isSelected:g,listRef:b,searchSelectedOption:_,selected:M,showAndFocus:k,showAndSelectIfQuery:C,uid:x}=EA(u,t);return(D,O)=>(w(),S("div",{id:y(a),class:"fr-col fr-search-bar wrap",role:"search"},[v("label",{class:"fr-label",for:l.value,id:c.value},T(y(e)("Search for data")),9,PA),yt(v("input",{class:"fr-input fr-col",placeholder:y(e)("Search"),ref_key:"inputRef",ref:m,autocomplete:"off",role:"combobox","aria-autocomplete":"list","aria-controls":y(x),"aria-expanded":y(h),id:l.value,"data-cy":"search-input","aria-activedescendant":y(M),name:"q","onUpdate:modelValue":O[0]||(O[0]=E=>t.value=E),onClickCapture:O[1]||(O[1]=Se((...E)=>y(C)&&y(C)(...E),["stop"])),onKeydown:O[2]||(O[2]=(...E)=>y(p)&&y(p)(...E)),onKeypress:O[3]||(O[3]=fp(Se((...E)=>y(_)&&y(_)(...E),["prevent"]),["enter"])),onBlur:O[4]||(O[4]=(...E)=>y(f)&&y(f)(...E))},null,40,RA),[[fs,t.value]]),v("button",{type:"button",ref_key:"buttonRef",ref:d,class:"fr-btn",tabindex:"-1","aria-controls":y(x),"aria-expanded":y(h),onClickCapture:O[5]||(O[5]=Se((...E)=>y(k)&&y(k)(...E),["prevent","stop"]))},T(y(e)("Search")),41,NA),v("div",{class:"fr-menu fr-collapse autocomplete",id:y(x),ref_key:"listRef",ref:b,role:"listbox","aria-labelledby":c.value,onMousedown:O[6]||(O[6]=Se(()=>{},["prevent"]))},[v("ul",LA,[(w(!0),S(J,null,Fe(u.value,E=>(w(),S("li",{key:E.id,id:E.id,role:"option","aria-selected":y(g)(E.id)},[P(OA,{icon:E.icon,query:t.value,type:E.type,link:E.link},null,8,["icon","query","type","link"])],8,zA))),128))])],40,IA)],8,AA))}}),FA=B({emits:["change"],props:{value:{type:String,required:!0},placeholder:{type:String,required:!0}},setup(n,{emit:e}){const{id:t}=bo("search-input"),r=$(n.value),s=$(null),i=()=>{var l;(l=s.value)==null||l.focus({preventScroll:!0})},o=()=>{r.value===""&&e("change",r.value)},a=l=>{const c=l.target;e("change",c.value)};return Ve(async()=>{await Aa(),i()}),It(()=>{r.value=n.value}),{id:t,input:s,onDelete:o,onInput:a,queryString:r}}}),VA={class:"fr-search-bar fr-search-bar--lg w-100"},HA=["for"],WA=["id","value","aria-label","placeholder"],jA={class:"fr-btn",type:"submit"};function UA(n,e,t,r,s,i){return w(),S("section",VA,[v("label",{class:"fr-label",for:n.id},T(n.$t("Search")),9,HA),v("input",{id:n.id,type:"search",name:"q",value:n.queryString,onInput:e[0]||(e[0]=(...o)=>n.onInput&&n.onInput(...o)),onKeydown:e[1]||(e[1]=fp((...o)=>n.onDelete&&n.onDelete(...o),["delete"])),ref:"input",class:"fr-input","aria-label":n.placeholder||n.$t("Search..."),placeholder:n.placeholder||n.$t("Search..."),"data-cy":"search-input","data-testid":"search-input"},null,40,WA),v("button",jA,T(n.$t("Search")),1)])}const qA=$e(FA,[["render",UA]]),Bw=B({__name:"card-lg",props:{dataset:{},style:{type:[Boolean,null,String,Object,Array]},showDescription:{type:Boolean,default:!0}},setup(n){return(e,t)=>{var r;return w(),Y(y(pM),{dataset:e.dataset,style:vo(e.style),showDescription:e.showDescription,"dataset-url":e.dataset.page,"organization-url":(r=e.dataset.organization)==null?void 0:r.page},null,8,["dataset","style","showDescription","dataset-url","organization-url"])}}}),YA=B({components:{ContentLoader:il},setup(n){const e=Vs.resources_default_page_size,t=88;return{pageSize:e,height:t,getPosition:(s,i)=>(s-1)*t+i}}}),KA=["y"],GA=["y"],JA=["y"],XA=["y"],QA=["y"];function ZA(n,e,t,r,s,i){const o=dt("ContentLoader");return w(),Y(o,{width:1200,height:n.height*n.pageSize,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},{default:q(()=>[(w(!0),S(J,null,Fe(n.pageSize,a=>(w(),S(J,null,[v("rect",{x:"20",y:n.getPosition(a,24),rx:"4",ry:"4",width:"16",height:"16"},null,8,KA),v("rect",{x:"52",y:n.getPosition(a,20),rx:"4",ry:"4",width:"536",height:"22"},null,8,GA),v("rect",{x:"52",y:n.getPosition(a,52),rx:"4",ry:"4",width:"374",height:"16"},null,8,JA),v("rect",{x:"1052",y:n.getPosition(a,30),rx:"4",ry:"4",width:"80",height:"20"},null,8,XA),v("rect",{x:"1154",y:n.getPosition(a,20),rx:"20",ry:"20",width:"40",height:"40"},null,8,QA)],64))),256))]),_:1},8,["height"])}const jp=$e(YA,[["render",ZA]]),eP={help:"Utilisez la tabulation (ou les touches flèches) pour naviguer dans la liste des suggestions",placeholder:"Rechercher dans la liste",noResult:"Aucun résultat",results:"{x} suggestion(s) disponibles",deleteItem:"Supprimer {t}",delete:"Supprimer",clear:"Vider"},tP=Element.prototype.matches;let Ui=Element.prototype.closest;Ui||(Ui=function(n){var e=this;do{if(tP.call(e,n))return e;e=e.parentElement||e.parentNode}while(e!==null&&e.nodeType===1);return null});const nP=!0,rP=!1;function Io(n){return Array.from(n).map(e=>e.cloneNode(nP))}function sP(n){return n.parentNode.tagName==="OPTGROUP"&&(n.dataset.group=n.parentNode.label),n}class iP{constructor(e,t){var o;var r;this.el=e,this.label=document.querySelector("label[for=".concat(e.id,"]")),this.id=e.id,this.open=!1,this.multiple=this.el.multiple,this.search="",this.suggestions=[],this.focusIndex=null;const s=Object.assign({},t),i=Object.assign({},eP,s.text);if(delete s.text,this._defaultSearch=this._defaultSearch.bind(this),this._options=Object.assign({text:i,showSelected:!0,fillSuggestions:this._defaultSearch,useLabelAsButton:!1,clearable:!1},s),this._handleFocus=this._handleFocus.bind(this),this._handleInput=this._handleInput.bind(this),this._handleKeyboard=this._handleKeyboard.bind(this),this._handleOpener=this._handleOpener.bind(this),this._handleClear=this._handleClear.bind(this),this._handleReset=this._handleReset.bind(this),this._handleSuggestionClick=this._handleSuggestionClick.bind(this),this._positionCursor=this._positionCursor.bind(this),this._removeOption=this._removeOption.bind(this),this.setText=this.setText.bind(this),this._setButtonText=this._setButtonText.bind(this),!this.multiple){const a=Array.from(this.el.options).some(l=>l.selected);if(this._options.useLabelAsButton&&!a){const l=document.createElement("option");l.innerText=(o=(r=this.label)==null?void 0:r.innerText)!=null?o:"",l.setAttribute("value",""),l.setAttribute("selected","selected"),l.setAttribute("disabled","disabled"),l.setAttribute("hidden","hidden"),this.el.options.add(l,0)}}this.originalOptions=Io(Array.from(this.el.options).map(sP)),this.updatedOriginalOptions=Io(this.originalOptions),this.currentOptions=Io(this.originalOptions),this._disable(),this.button=this._createButton(),this._setButtonText(),this.clearButton=this._createClearButton(),this.liveZone=this._createLiveZone(),this.overlay=this._createOverlay(),this.wrap=this._wrap(),this.multiple&&this._options.showSelected&&(this.selectedList=this._createSelectedList(),this._updateSelectedList(),this.selectedList.addEventListener("click",this._removeOption)),this.button.addEventListener("click",this._handleOpener),this.clearButton.addEventListener("click",this._handleClear),this.wrap.addEventListener("keydown",this._handleKeyboard),document.addEventListener("blur",this._handleFocus,!0),this.el.form&&this.el.form.addEventListener("reset",this._handleReset)}setText(e){Object.assign(this._options.text,e)}selectOption(e,t=!0){const r=this.currentOptions.findIndex(i=>i.value===e);if(r===-1)return;const s=!this.multiple;this._toggleSelection(r,s,t)}selectOptionSilently(e){this.selectOption(e,rP)}_createButton(){var e;const t=document.createElement("button");t.setAttribute("type","button"),t.setAttribute("aria-expanded",this.open?"true":"false"),t.className="select-a11y-button";const r=document.createElement("span");return r.className="select-a11y-button__text",this.label&&!this.label.id&&(this.label.id="".concat(this.el.id,"-label")),t.setAttribute("id",this.el.id+"-button"),t.setAttribute("aria-labelledby",((e=this.label)==null?void 0:e.id)+" "+t.id),r.innerHTML="&nbsp;",t.appendChild(r),t.insertAdjacentHTML("beforeend",'<span class="select-a11y-button__icon" aria-hidden="true"></span>'),t}_createClearButton(){const e=document.createElement("button");return e.setAttribute("type","button"),e.setAttribute("aria-label",this._options.text.clear),e.className="select-a11y-button__clear",e}_createLiveZone(){const e=document.createElement("p");return e.setAttribute("aria-live","polite"),e.classList.add("sr-only"),e}_createOverlay(){const e=document.createElement("div");e.classList.add("select-a11y__overlay");const t=document.createElement("div");return t.classList.add("select-a11y-suggestions"),t.id="a11y-".concat(this.id,"-suggestions"),e.innerHTML='\n      <p id="a11y-usage-'.concat(this.id,'-js" class="sr-only">').concat(this._options.text.help,'</p>\n      <label for="a11y-').concat(this.id,'-js" class="sr-only">').concat(this._options.text.placeholder,'</label>\n      <input type="search" id="a11y-').concat(this.id,'-js" class="select-a11y__input ').concat(this.el.className,'" autocomplete="off" autocapitalize="off" spellcheck="false" placeholder="').concat(this._options.text.placeholder,'" aria-describedby="a11y-usage-').concat(this.id,'-js">\n    '),e.appendChild(t),this.list=t,this.list.addEventListener("click",this._handleSuggestionClick),this.input=e.querySelector("input"),this.input&&(this.input.addEventListener("input",this._handleInput),this.input.addEventListener("focus",this._positionCursor,!0)),e}_createSelectedList(){const e=document.createElement("ul");return e.className="select-a11y__selected-list",e}_disable(){this.el.setAttribute("tabindex","-1")}_mapToSuggestion(e){return{hidden:e.hidden,disabled:e.disabled,selected:e.hasAttribute("selected"),label:e.label,value:e.value,image:e.dataset.image,alt:e.dataset.alt,helper:e.dataset.helper,description:e.dataset.description,showIcon:e.dataset.showIcon,group:e.dataset.group,link:e.dataset.link,linkText:e.dataset.linkText}}_mapToOption(e){const t=document.createElement("option");return t.label=e.label,t.value=e.value,e.hidden&&t.setAttribute("hidden","hidden"),e.disabled&&t.setAttribute("disabled","disabled"),e.selected&&t.setAttribute("selected","selected"),e.image&&(t.dataset.image=e.image),e.alt&&(t.dataset.alt=e.alt),e.description&&(t.dataset.description=e.description),e.helper&&(t.dataset.helper=e.helper),e.showIcon&&(t.dataset.showIcon=e.showIcon),e.group&&(t.dataset.group=e.group),e.link&&(t.dataset.link=e.link),e.linkText&&(t.dataset.linkText=e.linkText),t}_defaultSearch(e,t){const r=t.filter(s=>(s.label||s.value).toLocaleLowerCase().indexOf(e)!==-1).map(this._mapToSuggestion);return Promise.resolve(r)}async _fillSuggestions(){const e=this.search.toLowerCase(),t=await this._options.fillSuggestions(e,this.updatedOriginalOptions);this.currentOptions=t.map(this._mapToOption),this.el.replaceChildren(...this._fillSelect(this.currentOptions));const r=t.map((o,a)=>{const l=document.createElement("div");l.setAttribute("role","option"),l.setAttribute("tabindex","0"),l.setAttribute("data-index",a.toString()),o.hidden&&l.setAttribute("data-hidden","hidden"),o.disabled&&l.setAttribute("data-disabled","disabled"),l.classList.add("select-a11y-suggestion");const c=document.createElement("div");c.classList.add("select-a11y-column"),l.appendChild(c);const u=document.createElement("div");if(u.classList.add("select-a11y-suggestion__label"),u.innerText=o.label||o.value,c.appendChild(u),o.selected&&l.setAttribute("aria-selected","true"),o.description){const d=document.createElement("div");d.classList.add("select-a11y-suggestion__description"),o.showIcon&&d.setAttribute("data-show-icon","true"),d.innerText=o.description,c.appendChild(d)}if(o.helper){const d=document.createElement("div");d.classList.add("column--right"),l.appendChild(d);const h=document.createElement("code");h.classList.add("select-a11y-suggestion__helper"),h.innerText=o.helper,d.appendChild(h)}else if(o.link){const d=document.createElement("div");d.classList.add("column--right"),l.appendChild(d);const h=document.createElement("a");h.target="_blank",h.innerText=o.linkText,h.href=o.link,d.appendChild(h)}if(o.image){const d=document.createElement("img");d.setAttribute("src",o.image),d.setAttribute("alt",o.alt?o.alt:""),d.classList.add("select-a11y-suggestion__image"),l.prepend(d)}return{suggestionElement:l,group:o.group}}).filter(o=>!o.suggestionElement.dataset.disabled&&!o.suggestionElement.dataset.hidden),s=[],i={};if(r.forEach(({suggestionElement:o,group:a})=>{if(a){if(!i[a]){const l=document.createElement("div");l.setAttribute("role","group"),i[a]=l;const c=document.createElement("div");c.setAttribute("role","presentation"),c.innerHTML=a,l.appendChild(c)}i[a].appendChild(o)}else s.push(o)}),this.suggestions=r.map(({suggestionElement:o})=>o),this.list)if(!this.suggestions.length)this.list.innerHTML='<p class="select-a11y__no-suggestion">'.concat(this._options.text.noResult,"</p>");else{const o=document.createElement("div");o.setAttribute("role","listbox"),this.multiple&&o.setAttribute("aria-multiselectable","true"),Object.values(s).forEach(a=>{o.appendChild(a)}),Object.values(i).forEach(a=>{o.appendChild(a)}),this.list.innerHTML="",this.list.appendChild(o)}return this._setLiveZone(),t}_fillSelect(e){const t=[];return e.forEach(r=>{const s=r.dataset.group;if(s){if(!t.find(i=>i.tagName==="OPTGROUP"&&i.label===s)){const i=document.createElement("optgroup");i.label=s,t.push(i)}t[t.length-1].appendChild(r)}else t.push(r)}),t}_handleOpener(e){this._toggleOverlay()}_handleFocus(){this.open&&(clearTimeout(this._focusTimeout),this._focusTimeout=setTimeout(()=>{if(!this.overlay.contains(document.activeElement)&&this.button!==document.activeElement)this._toggleOverlay(!1,document.activeElement===document.body);else if(document.activeElement===this.input)this.focusIndex=null;else{const e=this.suggestions.indexOf(document.activeElement);e!==-1&&(this.focusIndex=e)}},10))}_handleClear(){this.el.value="",this._handleReset()}_handleReset(){clearTimeout(this._resetTimeout),this._resetTimeout=setTimeout(async()=>{this.search="",this.updatedOriginalOptions=Io(this.originalOptions),this.currentOptions=Io(this.originalOptions),this.el.dispatchEvent(new Event("reset")),await this._fillSuggestions(),this.el.dispatchEvent(new Event("change")),this._setButtonText(),this.multiple&&this._options.showSelected&&this._updateSelectedList()},10)}_handleSuggestionClick(e){const t=Ui.call(e.target,'[role="option"]');if(!t)return;const r=parseInt(t.getAttribute("data-index"),10),s=!(this.multiple&&e.metaKey);this._toggleSelection(r,s)}_handleInput(){var r;var e,t;this.search!==((e=this.input)==null?void 0:e.value)&&(this.search=(r=(t=this.input)==null?void 0:t.value)!=null?r:"",this._fillSuggestions())}_handleKeyboard(e){const t=Ui.call(e.target,'[role="option"]'),r=Ui.call(e.target,"input");if(e.keyCode===27){this._toggleOverlay();return}if(r&&e.keyCode===13){e.preventDefault();return}if(e.keyCode===40){e.preventDefault(),this._moveIndex(1);return}if(t){if(e.keyCode===39){e.preventDefault(),this._moveIndex(1);return}if(e.keyCode===37||e.keyCode===38){e.preventDefault(),this._moveIndex(-1);return}(!this.multiple&&e.keyCode===13||e.keyCode===32)&&(e.preventDefault(),this._toggleSelection(parseInt(t.getAttribute("data-index"),10),!this.multiple)),this.multiple&&e.keyCode===13&&this._toggleOverlay()}}_moveIndex(e){if(this.focusIndex===null)this.focusIndex=0;else{const t=this.focusIndex+e,r=this.suggestions.length-1;t>r?this.focusIndex=0:t<0?this.focusIndex=r:this.focusIndex=t}this.suggestions[this.focusIndex].focus()}_positionCursor(){setTimeout(()=>{var e;if(this.input){const t=(e=this.input.value.length)!=null?e:0;this.input.setSelectionRange(t,t)}})}_removeOption(e){var t,r;const s=Ui.call(e.target,"button");if(!s)return;const i=(t=this.selectedList)==null?void 0:t.querySelectorAll("button"),o=Array.prototype.indexOf.call(i,s)-1,a=parseInt(s.getAttribute("data-index"),10);if(this._toggleSelection(a),(r=this.selectedList)!=null&&r.parentElement){const l=this.selectedList.querySelectorAll("button");l[o]?l[o].focus():l[0].focus()}else this.button.focus()}_setButtonText(){var e;const t=this.el.item(this.el.selectedIndex),r=this.button.firstElementChild;t&&t.value?this.button.classList.remove("select-a11y-button--no-selected-option"):this.button.classList.add("select-a11y-button--no-selected-option"),this.multiple?this._options.useLabelAsButton?r.innerText=((e=this.label)==null?void 0:e.innerText)||"":r.innerHTML="&nbsp;":t&&(r.innerText=t.label||t.value)}_setLiveZone(){const e=this.suggestions.length;let t="";this.open&&(e?t=this._options.text.results.replace("{x}",e):t=this._options.text.noResult),this.liveZone.innerText=t}_toggleOverlay(e,t){var r;this.open=e!==void 0?e:!this.open,this.button.setAttribute("aria-expanded",this.open?"true":"false"),this.open?(this._fillSuggestions(),this.button.insertAdjacentElement("afterend",this.overlay),(r=this.input)==null||r.focus()):this.wrap.contains(this.overlay)&&(this.wrap.removeChild(this.overlay),this.focusIndex=null,this.input&&this._options.fillSuggestions===this._defaultSearch&&(this.input.value=""),this.search="",this._setLiveZone(),(e===void 0||t)&&setTimeout(()=>{this.button.focus()}))}_toggleSelection(e,t=!0,r=!0){const s=this.el.item(e);this.multiple?s!=null&&s.hasAttribute("selected")?s.removeAttribute("selected"):s==null||s.setAttribute("selected","selected"):(s==null||s.setAttribute("selected","selected"),this.el.selectedIndex=e),this.updatedOriginalOptions=this.updatedOriginalOptions.map(i=>(i.value===(s==null?void 0:s.value)&&(s.hasAttribute("selected")?i.setAttribute("selected","selected"):i.removeAttribute("selected")),!this.multiple&&i.value!==(s==null?void 0:s.value)&&i.removeAttribute("selected"),i)),this.currentOptions=this.currentOptions.map(i=>(i.value===(s==null?void 0:s.value)&&(s.hasAttribute("selected")?i.setAttribute("selected","selected"):i.removeAttribute("selected")),!this.multiple&&i.value!==(s==null?void 0:s.value)&&i.removeAttribute("selected"),i)),this.suggestions=this.suggestions.map(i=>{var l;const o=parseInt((l=i.getAttribute("data-index"))!=null?l:"",10),a=this.el.item(o);return a&&a.selected?i.setAttribute("aria-selected","true"):i.removeAttribute("aria-selected"),i}),r&&this.el.dispatchEvent(new Event("change")),this._setButtonText(),this.multiple&&this._options.showSelected&&this._updateSelectedList(),t&&this.open&&this._toggleOverlay()}_updateSelectedList(){var e;const t=this.currentOptions.map((r,s)=>{if(!r.selected||r.hidden)return;const i=r.label||r.value;return'\n        <li class="select-a11y__selected-item">\n          <span>'.concat(i,'</span>\n          <button class="select-a11y-delete" title="').concat(this._options.text.deleteItem.replace("{t}",i),'" type="button" data-index="').concat(s,'">\n            <span class="sr-only">').concat(this._options.text.delete,'</span>\n            <span class="select-a11y-delete__icon" aria-hidden="true"></span>\n          </button>\n        </li>')}).filter(Boolean);this.selectedList&&(this.selectedList.innerHTML=t.join(""),t.length?(e=this.selectedList)!=null&&e.parentElement||this.wrap.appendChild(this.selectedList):this.selectedList.parentElement&&this.wrap.removeChild(this.selectedList))}_wrap(){var e;const t=document.createElement("div");t.classList.add("select-a11y"),(e=this.el.parentElement)==null||e.appendChild(t);const r=document.createElement("div");return r.classList.add("select-a11y__hidden"),r.setAttribute("aria-hidden","true"),this._options.useLabelAsButton&&r.appendChild(this.label),r.appendChild(this.el),t.appendChild(r),t.appendChild(this.liveZone),t.appendChild(this.button),this._options.clearable&&t.appendChild(this.clearButton),t}}const oP=B({props:{required:{type:Boolean,required:!0}}}),aP={key:0,class:"required-field-star"};function lP(n,e,t,r,s,i){return n.required?(w(),S("span",aP,"*")):I("",!0)}const Up=$e(oP,[["render",lP]]);const cP=B({components:{Required:Up},emits:["change"],props:{addAllOption:{type:Boolean,default:!0},allOption:{type:String,default:""},emptyPlaceholder:{type:String},entityUrl:{type:String},errorText:{type:String,default:""},explanation:{type:String,default:""},hasError:{type:Boolean,default:!1},hasWarning:{type:Boolean,default:!1},hintText:{type:String,default:""},isBlue:{type:Boolean,default:!1},initialOptions:Promise,isValid:{type:Boolean,default:!1},listUrl:{type:String},minimumCharacterBeforeSuggest:{type:Number,default:1},placeholder:{type:String,required:!0},required:{type:Boolean,default:!1},searchPlaceholder:{type:String,required:!0},suggestUrl:{type:String},values:{type:[Array,String]},multiple:{type:Boolean,default:!1},addNewOption:{type:Boolean,default:!1},helperLabel:{type:String,default:""},groups:{type:Array,default:null},onSuggest:{type:Function,default:null},showDescription:{type:Boolean,default:!1},roundedImages:{type:Boolean,default:!1}},setup(n,{emit:e}){const{t}=Te(),{toast:r}=Mn(),{id:s}=bo("multiselect"),i=A(()=>s+"-desc-error"),o=A(()=>s+"-desc-valid"),a=A(()=>({"fr-select-group--error":n.hasError,"fr-select-group--warning":!n.hasError&&n.hasWarning,"fr-select-group--valid":n.isValid,"multiselect--rounded-images":n.roundedImages,"multiselect--align-center":!n.showDescription})),l=Ra("selectRef"),c=$(null),u=$(0),d=350,h=20,f=$([]),p=$([]),m=A(()=>f.value.slice(0,h)),g=$(n.multiple?[]:null),b="",_=$(null),M=$(null),k=A(()=>n.emptyPlaceholder||t("No results found.")),C=ki({help:t("Use tab (or arrow down) to move between suggestions"),placeholder:n.searchPlaceholder,noResult:k.value,results:t("{x} available suggestion"),deleteItem:t("Delete {t}"),delete:t("Delete")}),x=async()=>n.initialOptions?n.initialOptions:n.listUrl?mt.get(n.listUrl).then(N=>{let Z=N.data;if(Array.isArray(Z)||(Z=Z.data),n.groups){const se=Z.map(Ke=>{const Ct=n.groups.find(zt=>zt.values.some(Fn=>Fn.value===Ke.id));if(Ct){const zt=Ct.values.find(Fn=>Fn.value===Ke.id);if(zt)return{...Ke,group:Ct.name,description:zt.description||null,recommended:zt.recommended,code:zt.code}}return Ke});return D(se)}else return D(Z)}).catch(N=>(Qn.isCancel(N)||r.error(t("Error getting {type}.",{type:n.placeholder})),[])):p.value,D=H=>H.map(N=>{var Z,se,Ke,Ct,zt,Fn,Do,Hg,Wg,jg,Ug,qg,Yg,Kg,Gg;return{label:(Fn=(zt=(Ct=(se=(Z=N.name)!=null?Z:N.title)!=null?se:N.text)!=null?Ct:(Ke=N==null?void 0:N.properties)==null?void 0:Ke.name)!=null?zt:N.label)!=null?Fn:N,value:(Wg=(Hg=(Do=N.id)!=null?Do:N.text)!=null?Hg:N.value)!=null?Wg:N,image:(Kg=(Yg=(qg=(Ug=(jg=N.logo_thumbnail)!=null?jg:N.logo)!=null?Ug:N.image_url)!=null?qg:N.image)!=null?Yg:N.avatar_thumbnail)!=null?Kg:N.avatar,hidden:N.hidden,selected:!!N.selected,helper:N!=null&&N.code?n.helperLabel+N.code:N==null?void 0:N.helper,description:n.showDescription&&(Gg=N==null?void 0:N.description)!=null?Gg:"",group:N==null?void 0:N.group,recommended:N==null?void 0:N.recommended}}),O=async(H="")=>{const Z=f.value.filter(se=>(se.label||se.value).toLocaleLowerCase().indexOf(H)!==-1).slice(0,h);return D(Z)},E=H=>H.length<n.minimumCharacterBeforeSuggest?x():n.suggestUrl?(_.value&&_.value.cancel(),_.value=Wu(),mt.get(n.suggestUrl,{params:{q:H,size:h},cancelToken:_.value.token}).then(N=>n.onSuggest?n.onSuggest(N.data):N.data).then(N=>(n.addNewOption&&!N.some(se=>se.text===H)&&N.push({text:H}),D(N))).catch(N=>(Qn.isCancel(N)||r.error(t("Error getting {type}.",{type:n.placeholder})),[]))):O(H),R=(H="")=>E(H).then(K),W=(H="")=>R(H).then(N=>(p.value=N,N.slice(0,h))),K=H=>{const N=[...H].map(se=>(se.selected=!1,se));n.allOption&&(N.find(Ke=>!Ke.value)||N.unshift({label:n.allOption,value:"",hidden:!n.addAllOption}));let Z=[];Array.isArray(g.value)?Z=g.value:Z=[g.value];for(let se of Z)if(typeof se=="string"){const Ke=N.findIndex(zt=>zt.value===se),Ct=p.value.find(zt=>zt.value===se);Ct&&(Ct.selected=!0,Ke===-1?N.unshift(Ct):N[Ke].selected=!0)}return D(N)},_e=H=>(f.value=H,p.value=H,H),He=H=>{const N=$(null);return(typeof H=="string"||Array.isArray(H))&&(N.value=H),N},te=()=>{let H=[],N=at(He(n.values));if(Array.isArray(N))for(let Z of N)H.push(de(Z));else H.push(de(N));return Promise.all(H).then(Z=>(n.multiple?g.value=Z.filter(se=>se!==null):g.value=Z[0],g.value)).catch(Z=>(Qn.isCancel(Z)||r.error(t("Error getting {type}.",{type:n.placeholder})),[]))},de=H=>{var Z;let N=null;if(H&&n.entityUrl)N=mt.get("".concat(n.entityUrl).concat(H,"/")).then(se=>se.data).then(se=>D([se])).then(se=>{var Ke,Ct;return(Ct=(Ke=se[0])==null?void 0:Ke.label)!=null?Ct:H}).then(se=>{p.value.every(Ct=>Ct.value!==H)&&p.value.push({label:se,value:H})}).then(()=>H);else{let se=p.value.find(Ke=>Ke.value===H);H&&!se&&(se={label:H,value:H},p.value.push(se)),N=Promise.resolve((Z=se==null?void 0:se.value)!=null?Z:null)}return N.then(se=>se!=null?se:b).catch(se=>(Qn.isCancel(se)||r.error(t("Error getting {type}.",{type:n.placeholder})),""))},me=()=>{if(l.value)if(n.multiple){const H=Array.from(l.value.selectedOptions).map(N=>N.value);g.value=H,e("change",H)}else g.value=l.value.value,e("change",l.value.value)},De=()=>{l.value&&(n.multiple?g.value=[]:g.value=null)},ye=()=>{fe(),Xe(),V()},fe=()=>{if(!c.value)return;let H=c.value.getBoundingClientRect(),N=d;window.innerWidth<N&&(N=Math.min(d,H.width));let se=window.innerWidth-H.x<N;u.value=se?N-H.width:0;const Ke=c.value.style;Ke.setProperty("--offset-select-a11y__overlay","-".concat(u.value,"px")),Ke.setProperty("--min-width-select-a11y__overlay","".concat(N,"px"))},Xe=()=>{if(!c.value)return;const H=c.value.querySelector(".select-a11y");H&&(H.classList.add("fr-select"),n.isBlue&&H.classList.add("fr-select--blue"));const N=c.value.querySelector("label");N&&N.classList.add("fr-label");const Z=c.value.querySelector(".select-a11y-button__text");Z&&!Z.innerHTML&&(Z.innerHTML="&nbsp;")},V=()=>{c.value&&l.value&&(l.value.removeEventListener("change",me),l.value.addEventListener("change",me),l.value.removeEventListener("reset",De),l.value.addEventListener("reset",De))},z=()=>{const H={text:C,clearable:!0};H.fillSuggestions=W;try{M.value=new iP(l.value,H),ye()}catch(N){console.log(N)}};function F(H,N){return Array.isArray(H)&&Array.isArray(N)?[...H.filter(Z=>!N.includes(Z))]:H===N?[]:[H]}async function re(H){var N;await W(H),(N=M.value)==null||N.selectOptionSilently(H),g.value=H}et(()=>n.values,async()=>{var Z;const H=g.value;await te();const N=F(g.value,H);for(const se of N)(Z=M.value)==null||Z.selectOptionSilently(se)});const ce=R().then(_e).then(te);return Ve(()=>ce.then(z)),H0(ye),{container:c,displayedOptions:m,errorTextId:i,id:s,offset:u,selected:g,selectGroupClass:a,selectOption:re,validTextId:o}}}),uP=["data-selected"],dP=["for","title"],hP={key:0,class:"fr-icon-information-line","aria-hidden":"true"},fP={key:1,class:"fr-hint-text"},pP=["id","required","multiple"],mP=["label"],gP=["value","data-image","hidden","data-helper","data-description","data-show-icon"],yP=["value","data-image","hidden","data-helper","data-description","data-show-icon"],vP=["value","data-image","hidden","data-helper","data-description","data-show-icon"],bP=["id"],wP=["id"];function _P(n,e,t,r,s,i){const o=dt("Required");return w(),S("div",{class:ue(["multiselect w-100 fr-select-group",n.selectGroupClass]),ref:"container","data-selected":!!n.selected},[v("div",null,[v("label",{for:n.id,title:n.explanation},[U(T(n.placeholder)+" ",1),P(o,{required:n.required},null,8,["required"]),n.explanation?(w(),S("span",hP)):I("",!0),n.hintText?(w(),S("span",fP,T(n.hintText),1)):I("",!0)],8,dP),yt(v("select",{class:"multiselect__input",id:n.id,ref:"selectRef","onUpdate:modelValue":e[0]||(e[0]=a=>n.selected=a),required:n.required,multiple:n.multiple},[n.groups?(w(),S(J,{key:0},[(w(!0),S(J,null,Fe(n.groups,a=>(w(),S("optgroup",{label:a.name},[(w(!0),S(J,null,Fe(n.displayedOptions,l=>(w(),S(J,{key:l.value},[a.name==l.group?(w(),S("option",{key:0,value:l.value,"data-image":l.image,hidden:l.hidden,"data-helper":l.helper,"data-description":l.description,"data-show-icon":l.recommended},T(l.label),9,gP)):I("",!0)],64))),128))],8,mP))),256)),(w(!0),S(J,null,Fe(n.displayedOptions,a=>(w(),S(J,{key:a.value},[a.group?I("",!0):(w(),S("option",{key:0,value:a.value,"data-image":a.image,hidden:a.hidden,"data-helper":a.helper,"data-description":a.description,"data-show-icon":a.recommended},T(a.label),9,yP))],64))),128))],64)):(w(!0),S(J,{key:1},Fe(n.displayedOptions,a=>(w(),S("option",{key:a.value,value:a.value,"data-image":a.image,hidden:a.hidden,"data-helper":a.helper,"data-description":a.description,"data-show-icon":a.recommended},T(a.label),9,vP))),128))],8,pP),[[Bu,n.selected]])]),n.isValid?(w(),S("p",{key:0,id:n.validTextId,class:"fr-valid-text"},T(n.validText),9,bP)):n.hasError?(w(),S("p",{key:1,id:n.errorTextId,class:"fr-error-text"},T(n.errorText),9,wP)):I("",!0)],10,uP)}const vr=$e(cP,[["render",_P],["__scopeId","data-v-9b8f38b5"]]),kP=B({__name:"SchemaSelect",props:{allOption:{default:""},isBlue:{type:Boolean,default:!1},showExplanation:{type:Boolean,default:!0},values:{}},emits:["change"],setup(n,{emit:e}){const t=e,r=J0().then(i=>i.map(o=>({label:o.name,value:o.name}))),s=i=>t("change",i);return(i,o)=>(w(),Y(vr,{placeholder:i.$t("Schema"),explanation:i.showExplanation?i.$t("Data schemas describe data models: what are the fields, how are data shown, what are the available values, etc. See schema.data.gouv.fr"):"",searchPlaceholder:i.$t("Search a schema..."),allOption:i.allOption?i.allOption:i.$t("All schemas"),initialOptions:y(r),values:i.values,onChange:s,isBlue:i.isBlue},null,8,["placeholder","explanation","searchPlaceholder","allOption","initialOptions","values","isBlue"]))}});function Cn(n){"@babel/helpers - typeof";return Cn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cn(n)}function qe(n){if(n===null||n===!0||n===!1)return NaN;var e=Number(n);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function le(n,e){if(e.length<n)throw new TypeError(n+" argument"+(n>1?"s":"")+" required, but only "+e.length+" present")}function oe(n){le(1,arguments);var e=Object.prototype.toString.call(n);return n instanceof Date||Cn(n)==="object"&&e==="[object Date]"?new Date(n.getTime()):typeof n=="number"||e==="[object Number]"?new Date(n):((typeof n=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function xP(n,e){le(2,arguments);var t=oe(n),r=qe(e);return isNaN(r)?new Date(NaN):(r&&t.setDate(t.getDate()+r),t)}function qp(n,e){le(2,arguments);var t=oe(n),r=qe(e);if(isNaN(r))return new Date(NaN);if(!r)return t;var s=t.getDate(),i=new Date(t.getTime());i.setMonth(t.getMonth()+r+1,0);var o=i.getDate();return s>=o?i:(t.setFullYear(i.getFullYear(),i.getMonth(),s),t)}function CP(n,e){le(2,arguments);var t=oe(n).getTime(),r=qe(e);return new Date(t+r)}var SP={};function Ar(){return SP}function MP(n,e){var t,r,s,i,o,a,l,c;le(1,arguments);var u=Ar(),d=qe((t=(r=(s=(i=e==null?void 0:e.weekStartsOn)!==null&&i!==void 0?i:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.weekStartsOn)!==null&&s!==void 0?s:u.weekStartsOn)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&t!==void 0?t:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=oe(n),f=h.getDay(),p=(f<d?7:0)+f-d;return h.setDate(h.getDate()-p),h.setHours(0,0,0,0),h}function Fw(n){var e=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return e.setUTCFullYear(n.getFullYear()),n.getTime()-e.getTime()}function wf(n){le(1,arguments);var e=oe(n);return e.setHours(0,0,0,0),e}function Yp(n,e){le(2,arguments);var t=qe(e);return qp(n,t*12)}function TP(n){le(1,arguments);var e;if(n&&typeof n.forEach=="function")e=n;else if(Cn(n)==="object"&&n!==null)e=Array.prototype.slice.call(n);else return new Date(NaN);var t;return e.forEach(function(r){var s=oe(r);(t===void 0||t<s||isNaN(Number(s)))&&(t=s)}),t||new Date(NaN)}function OP(n){le(1,arguments);var e;if(n&&typeof n.forEach=="function")e=n;else if(Cn(n)==="object"&&n!==null)e=Array.prototype.slice.call(n);else return new Date(NaN);var t;return e.forEach(function(r){var s=oe(r);(t===void 0||t>s||isNaN(s.getDate()))&&(t=s)}),t||new Date(NaN)}var DP=6e4,$P=36e5,EP=1e3;function nh(n,e){le(2,arguments);var t=wf(n),r=wf(e);return t.getTime()===r.getTime()}function AP(n){return le(1,arguments),n instanceof Date||Cn(n)==="object"&&Object.prototype.toString.call(n)==="[object Date]"}function hn(n){if(le(1,arguments),!AP(n)&&typeof n!="number")return!1;var e=oe(n);return!isNaN(Number(e))}function PP(n){le(1,arguments);var e=oe(n);return e.setHours(23,59,59,999),e}function Vw(n){le(1,arguments);var e=oe(n),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function RP(n,e){var t;le(1,arguments);var r=n||{},s=oe(r.start),i=oe(r.end),o=i.getTime();if(!(s.getTime()<=o))throw new RangeError("Invalid interval");var a=[],l=s;l.setHours(0,0,0,0);var c=Number((t=e==null?void 0:e.step)!==null&&t!==void 0?t:1);if(c<1||isNaN(c))throw new RangeError("`options.step` must be a number greater than 1");for(;l.getTime()<=o;)a.push(oe(l)),l.setDate(l.getDate()+c),l.setHours(0,0,0,0);return a}function Rv(n){le(1,arguments);var e=oe(n);return e.setSeconds(0,0),e}function NP(n){le(1,arguments);var e=n||{},t=oe(e.start),r=oe(e.end),s=r.getTime(),i=[];if(!(t.getTime()<=s))throw new RangeError("Invalid interval");var o=t;for(o.setHours(0,0,0,0),o.setDate(1);o.getTime()<=s;)i.push(oe(o)),o.setMonth(o.getMonth()+1);return i}function Hw(n){le(1,arguments);var e=oe(n);return e.setDate(1),e.setHours(0,0,0,0),e}function IP(n){le(1,arguments);var e=oe(n),t=e.getFullYear();return e.setFullYear(t+1,0,0),e.setHours(23,59,59,999),e}function LP(n){le(1,arguments);var e=oe(n),t=new Date(0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}function zP(n){le(1,arguments);var e=n||{},t=oe(e.start),r=oe(e.end),s=r.getTime();if(!(t.getTime()<=s))throw new RangeError("Invalid interval");var i=[],o=t;for(o.setHours(0,0,0,0),o.setMonth(0,1);o.getTime()<=s;)i.push(oe(o)),o.setFullYear(o.getFullYear()+1);return i}function BP(n){le(1,arguments);var e=oe(n),t=e.getFullYear(),r=9+Math.floor(t/10)*10;return e.setFullYear(r,11,31),e.setHours(23,59,59,999),e}function FP(n,e){var t,r,s,i,o,a,l,c;le(1,arguments);var u=Ar(),d=qe((t=(r=(s=(i=e==null?void 0:e.weekStartsOn)!==null&&i!==void 0?i:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.weekStartsOn)!==null&&s!==void 0?s:u.weekStartsOn)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&t!==void 0?t:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=oe(n),f=h.getDay(),p=(f<d?-7:0)+6-(f-d);return h.setDate(h.getDate()+p),h.setHours(23,59,59,999),h}function Ww(n,e){le(2,arguments);var t=qe(e);return CP(n,-t)}var VP=864e5;function HP(n){le(1,arguments);var e=oe(n),t=e.getTime();e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0);var r=e.getTime(),s=t-r;return Math.floor(s/VP)+1}function oo(n){le(1,arguments);var e=1,t=oe(n),r=t.getUTCDay(),s=(r<e?7:0)+r-e;return t.setUTCDate(t.getUTCDate()-s),t.setUTCHours(0,0,0,0),t}function jw(n){le(1,arguments);var e=oe(n),t=e.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(t+1,0,4),r.setUTCHours(0,0,0,0);var s=oo(r),i=new Date(0);i.setUTCFullYear(t,0,4),i.setUTCHours(0,0,0,0);var o=oo(i);return e.getTime()>=s.getTime()?t+1:e.getTime()>=o.getTime()?t:t-1}function WP(n){le(1,arguments);var e=jw(n),t=new Date(0);t.setUTCFullYear(e,0,4),t.setUTCHours(0,0,0,0);var r=oo(t);return r}var jP=6048e5;function Uw(n){le(1,arguments);var e=oe(n),t=oo(e).getTime()-WP(e).getTime();return Math.round(t/jP)+1}function mi(n,e){var t,r,s,i,o,a,l,c;le(1,arguments);var u=Ar(),d=qe((t=(r=(s=(i=e==null?void 0:e.weekStartsOn)!==null&&i!==void 0?i:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.weekStartsOn)!==null&&s!==void 0?s:u.weekStartsOn)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&t!==void 0?t:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=oe(n),f=h.getUTCDay(),p=(f<d?7:0)+f-d;return h.setUTCDate(h.getUTCDate()-p),h.setUTCHours(0,0,0,0),h}function Kp(n,e){var t,r,s,i,o,a,l,c;le(1,arguments);var u=oe(n),d=u.getUTCFullYear(),h=Ar(),f=qe((t=(r=(s=(i=e==null?void 0:e.firstWeekContainsDate)!==null&&i!==void 0?i:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.firstWeekContainsDate)!==null&&s!==void 0?s:h.firstWeekContainsDate)!==null&&r!==void 0?r:(l=h.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&t!==void 0?t:1);if(!(f>=1&&f<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var p=new Date(0);p.setUTCFullYear(d+1,0,f),p.setUTCHours(0,0,0,0);var m=mi(p,e),g=new Date(0);g.setUTCFullYear(d,0,f),g.setUTCHours(0,0,0,0);var b=mi(g,e);return u.getTime()>=m.getTime()?d+1:u.getTime()>=b.getTime()?d:d-1}function UP(n,e){var t,r,s,i,o,a,l,c;le(1,arguments);var u=Ar(),d=qe((t=(r=(s=(i=e==null?void 0:e.firstWeekContainsDate)!==null&&i!==void 0?i:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.firstWeekContainsDate)!==null&&s!==void 0?s:u.firstWeekContainsDate)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&t!==void 0?t:1),h=Kp(n,e),f=new Date(0);f.setUTCFullYear(h,0,d),f.setUTCHours(0,0,0,0);var p=mi(f,e);return p}var qP=6048e5;function qw(n,e){le(1,arguments);var t=oe(n),r=mi(t,e).getTime()-UP(t,e).getTime();return Math.round(r/qP)+1}function We(n,e){for(var t=n<0?"-":"",r=Math.abs(n).toString();r.length<e;)r="0"+r;return t+r}var YP={y:function(e,t){var r=e.getUTCFullYear(),s=r>0?r:1-r;return We(t==="yy"?s%100:s,t.length)},M:function(e,t){var r=e.getUTCMonth();return t==="M"?String(r+1):We(r+1,2)},d:function(e,t){return We(e.getUTCDate(),t.length)},a:function(e,t){var r=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h:function(e,t){return We(e.getUTCHours()%12||12,t.length)},H:function(e,t){return We(e.getUTCHours(),t.length)},m:function(e,t){return We(e.getUTCMinutes(),t.length)},s:function(e,t){return We(e.getUTCSeconds(),t.length)},S:function(e,t){var r=t.length,s=e.getUTCMilliseconds(),i=Math.floor(s*Math.pow(10,r-3));return We(i,t.length)}};const Nr=YP;var $i={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},KP={G:function(e,t,r){var s=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(s,{width:"abbreviated"});case"GGGGG":return r.era(s,{width:"narrow"});case"GGGG":default:return r.era(s,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){var s=e.getUTCFullYear(),i=s>0?s:1-s;return r.ordinalNumber(i,{unit:"year"})}return Nr.y(e,t)},Y:function(e,t,r,s){var i=Kp(e,s),o=i>0?i:1-i;if(t==="YY"){var a=o%100;return We(a,2)}return t==="Yo"?r.ordinalNumber(o,{unit:"year"}):We(o,t.length)},R:function(e,t){var r=jw(e);return We(r,t.length)},u:function(e,t){var r=e.getUTCFullYear();return We(r,t.length)},Q:function(e,t,r){var s=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(s);case"QQ":return We(s,2);case"Qo":return r.ordinalNumber(s,{unit:"quarter"});case"QQQ":return r.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(s,{width:"wide",context:"formatting"})}},q:function(e,t,r){var s=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(s);case"qq":return We(s,2);case"qo":return r.ordinalNumber(s,{unit:"quarter"});case"qqq":return r.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(s,{width:"wide",context:"standalone"})}},M:function(e,t,r){var s=e.getUTCMonth();switch(t){case"M":case"MM":return Nr.M(e,t);case"Mo":return r.ordinalNumber(s+1,{unit:"month"});case"MMM":return r.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(s,{width:"wide",context:"formatting"})}},L:function(e,t,r){var s=e.getUTCMonth();switch(t){case"L":return String(s+1);case"LL":return We(s+1,2);case"Lo":return r.ordinalNumber(s+1,{unit:"month"});case"LLL":return r.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(s,{width:"wide",context:"standalone"})}},w:function(e,t,r,s){var i=qw(e,s);return t==="wo"?r.ordinalNumber(i,{unit:"week"}):We(i,t.length)},I:function(e,t,r){var s=Uw(e);return t==="Io"?r.ordinalNumber(s,{unit:"week"}):We(s,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getUTCDate(),{unit:"date"}):Nr.d(e,t)},D:function(e,t,r){var s=HP(e);return t==="Do"?r.ordinalNumber(s,{unit:"dayOfYear"}):We(s,t.length)},E:function(e,t,r){var s=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return r.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(s,{width:"short",context:"formatting"});case"EEEE":default:return r.day(s,{width:"wide",context:"formatting"})}},e:function(e,t,r,s){var i=e.getUTCDay(),o=(i-s.weekStartsOn+8)%7||7;switch(t){case"e":return String(o);case"ee":return We(o,2);case"eo":return r.ordinalNumber(o,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});case"eeee":default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,r,s){var i=e.getUTCDay(),o=(i-s.weekStartsOn+8)%7||7;switch(t){case"c":return String(o);case"cc":return We(o,t.length);case"co":return r.ordinalNumber(o,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});case"cccc":default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,r){var s=e.getUTCDay(),i=s===0?7:s;switch(t){case"i":return String(i);case"ii":return We(i,t.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(s,{width:"short",context:"formatting"});case"iiii":default:return r.day(s,{width:"wide",context:"formatting"})}},a:function(e,t,r){var s=e.getUTCHours(),i=s/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,r){var s=e.getUTCHours(),i;switch(s===12?i=$i.noon:s===0?i=$i.midnight:i=s/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,r){var s=e.getUTCHours(),i;switch(s>=17?i=$i.evening:s>=12?i=$i.afternoon:s>=4?i=$i.morning:i=$i.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){var s=e.getUTCHours()%12;return s===0&&(s=12),r.ordinalNumber(s,{unit:"hour"})}return Nr.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getUTCHours(),{unit:"hour"}):Nr.H(e,t)},K:function(e,t,r){var s=e.getUTCHours()%12;return t==="Ko"?r.ordinalNumber(s,{unit:"hour"}):We(s,t.length)},k:function(e,t,r){var s=e.getUTCHours();return s===0&&(s=24),t==="ko"?r.ordinalNumber(s,{unit:"hour"}):We(s,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):Nr.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):Nr.s(e,t)},S:function(e,t){return Nr.S(e,t)},X:function(e,t,r,s){var i=s._originalDate||e,o=i.getTimezoneOffset();if(o===0)return"Z";switch(t){case"X":return Iv(o);case"XXXX":case"XX":return Ns(o);case"XXXXX":case"XXX":default:return Ns(o,":")}},x:function(e,t,r,s){var i=s._originalDate||e,o=i.getTimezoneOffset();switch(t){case"x":return Iv(o);case"xxxx":case"xx":return Ns(o);case"xxxxx":case"xxx":default:return Ns(o,":")}},O:function(e,t,r,s){var i=s._originalDate||e,o=i.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Nv(o,":");case"OOOO":default:return"GMT"+Ns(o,":")}},z:function(e,t,r,s){var i=s._originalDate||e,o=i.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Nv(o,":");case"zzzz":default:return"GMT"+Ns(o,":")}},t:function(e,t,r,s){var i=s._originalDate||e,o=Math.floor(i.getTime()/1e3);return We(o,t.length)},T:function(e,t,r,s){var i=s._originalDate||e,o=i.getTime();return We(o,t.length)}};function Nv(n,e){var t=n>0?"-":"+",r=Math.abs(n),s=Math.floor(r/60),i=r%60;if(i===0)return t+String(s);var o=e||"";return t+String(s)+o+We(i,2)}function Iv(n,e){if(n%60===0){var t=n>0?"-":"+";return t+We(Math.abs(n)/60,2)}return Ns(n,e)}function Ns(n,e){var t=e||"",r=n>0?"-":"+",s=Math.abs(n),i=We(Math.floor(s/60),2),o=We(s%60,2);return r+i+t+o}const GP=KP;var Lv=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Yw=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},JP=function(e,t){var r=e.match(/(P+)(p+)?/)||[],s=r[1],i=r[2];if(!i)return Lv(e,t);var o;switch(s){case"P":o=t.dateTime({width:"short"});break;case"PP":o=t.dateTime({width:"medium"});break;case"PPP":o=t.dateTime({width:"long"});break;case"PPPP":default:o=t.dateTime({width:"full"});break}return o.replace("{{date}}",Lv(s,t)).replace("{{time}}",Yw(i,t))},XP={p:Yw,P:JP};const _f=XP;var QP=["D","DD"],ZP=["YY","YYYY"];function Kw(n){return QP.indexOf(n)!==-1}function Gw(n){return ZP.indexOf(n)!==-1}function hu(n,e,t){if(n==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(e,"`) for formatting years to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(e,"`) for formatting years to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(e,"`) for formatting days of the month to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(e,"`) for formatting days of the month to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var e7={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},t7={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},n7={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},r7={date:Ld({formats:e7,defaultWidth:"full"}),time:Ld({formats:t7,defaultWidth:"full"}),dateTime:Ld({formats:n7,defaultWidth:"full"})};const s7=r7;var i7={code:"en-US",formatDistance:oC,formatLong:s7,formatRelative:aC,localize:lC,match:cC,options:{weekStartsOn:0,firstWeekContainsDate:1}};const Jw=i7;var o7=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,a7=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,l7=/^'([^]*?)'?$/,c7=/''/g,u7=/[a-zA-Z]/;function ao(n,e,t){var r,s,i,o,a,l,c,u,d,h,f,p,m,g,b,_,M,k;le(2,arguments);var C=String(e),x=Ar(),D=(r=(s=t==null?void 0:t.locale)!==null&&s!==void 0?s:x.locale)!==null&&r!==void 0?r:Jw,O=qe((i=(o=(a=(l=t==null?void 0:t.firstWeekContainsDate)!==null&&l!==void 0?l:t==null||(c=t.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&a!==void 0?a:x.firstWeekContainsDate)!==null&&o!==void 0?o:(d=x.locale)===null||d===void 0||(h=d.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&i!==void 0?i:1);if(!(O>=1&&O<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var E=qe((f=(p=(m=(g=t==null?void 0:t.weekStartsOn)!==null&&g!==void 0?g:t==null||(b=t.locale)===null||b===void 0||(_=b.options)===null||_===void 0?void 0:_.weekStartsOn)!==null&&m!==void 0?m:x.weekStartsOn)!==null&&p!==void 0?p:(M=x.locale)===null||M===void 0||(k=M.options)===null||k===void 0?void 0:k.weekStartsOn)!==null&&f!==void 0?f:0);if(!(E>=0&&E<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!D.localize)throw new RangeError("locale must contain localize property");if(!D.formatLong)throw new RangeError("locale must contain formatLong property");var R=oe(n);if(!hn(R))throw new RangeError("Invalid time value");var W=Fw(R),K=Ww(R,W),_e={firstWeekContainsDate:O,weekStartsOn:E,locale:D,_originalDate:R},He=C.match(a7).map(function(te){var de=te[0];if(de==="p"||de==="P"){var me=_f[de];return me(te,D.formatLong)}return te}).join("").match(o7).map(function(te){if(te==="''")return"'";var de=te[0];if(de==="'")return d7(te);var me=GP[de];if(me)return!(t!=null&&t.useAdditionalWeekYearTokens)&&Gw(te)&&hu(te,e,String(n)),!(t!=null&&t.useAdditionalDayOfYearTokens)&&Kw(te)&&hu(te,e,String(n)),me(K,te,D.localize,_e);if(de.match(u7))throw new RangeError("Format string contains an unescaped latin alphabet character `"+de+"`");return te}).join("");return He}function d7(n){var e=n.match(l7);return e?e[1].replace(c7,"'"):n}function h7(n,e){if(n==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n}function f7(n){le(1,arguments);var e=oe(n),t=e.getFullYear(),r=e.getMonth(),s=new Date(0);return s.setFullYear(t,r+1,0),s.setHours(0,0,0,0),s.getDate()}function jl(n){le(1,arguments);var e=oe(n),t=e.getFullYear(),r=Math.floor(t/10)*10;return r}function Dn(n){return le(1,arguments),oe(n).getFullYear()}function Ha(n,e){le(2,arguments);var t=oe(n),r=oe(e);return t.getTime()>r.getTime()}function Wa(n,e){le(2,arguments);var t=oe(n),r=oe(e);return t.getTime()<r.getTime()}function zv(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function p7(n,e){if(n){if(typeof n=="string")return zv(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?zv(n,e):void 0}}function Bv(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=p7(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,s=function(){};return{s,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(c){throw c},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){t=t.call(n)},n:function(){var c=t.next();return o=c.done,c},e:function(c){a=!0,i=c},f:function(){try{o||t.return==null||t.return()}finally{if(a)throw i}}}}function ee(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function kf(n,e){return kf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},kf(n,e)}function Re(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&kf(n,e)}function fu(n){return fu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},fu(n)}function Xw(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Xw=function(){return!!n})()}function m7(n,e){if(e&&(Cn(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ee(n)}function Ne(n){var e=Xw();return function(){var t,r=fu(n);if(e){var s=fu(this).constructor;t=Reflect.construct(r,arguments,s)}else t=r.apply(this,arguments);return m7(this,t)}}function Ee(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function g7(n,e){if(Cn(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(Cn(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Qw(n){var e=g7(n,"string");return Cn(e)=="symbol"?e:e+""}function Fv(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,Qw(r.key),r)}}function Ae(n,e,t){return e&&Fv(n.prototype,e),t&&Fv(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function X(n,e,t){return(e=Qw(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var y7=10,Zw=function(){function n(){Ee(this,n),X(this,"priority",void 0),X(this,"subPriority",0)}return Ae(n,[{key:"validate",value:function(t,r){return!0}}]),n}(),v7=function(n){Re(t,n);var e=Ne(t);function t(r,s,i,o,a){var l;return Ee(this,t),l=e.call(this),l.value=r,l.validateValue=s,l.setValue=i,l.priority=o,a&&(l.subPriority=a),l}return Ae(t,[{key:"validate",value:function(s,i){return this.validateValue(s,this.value,i)}},{key:"set",value:function(s,i,o){return this.setValue(s,i,this.value,o)}}]),t}(Zw),b7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",y7),X(ee(r),"subPriority",-1),r}return Ae(t,[{key:"set",value:function(s,i){if(i.timestampIsSet)return s;var o=new Date(0);return o.setFullYear(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()),o.setHours(s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCMilliseconds()),o}}]),t}(Zw),ze=function(){function n(){Ee(this,n),X(this,"incompatibleTokens",void 0),X(this,"priority",void 0),X(this,"subPriority",void 0)}return Ae(n,[{key:"run",value:function(t,r,s,i){var o=this.parse(t,r,s,i);return o?{setter:new v7(o.value,this.validate,this.set,this.priority,this.subPriority),rest:o.rest}:null}},{key:"validate",value:function(t,r,s){return!0}}]),n}(),w7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",140),X(ee(r),"incompatibleTokens",["R","u","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){switch(i){case"G":case"GG":case"GGG":return o.era(s,{width:"abbreviated"})||o.era(s,{width:"narrow"});case"GGGGG":return o.era(s,{width:"narrow"});case"GGGG":default:return o.era(s,{width:"wide"})||o.era(s,{width:"abbreviated"})||o.era(s,{width:"narrow"})}}},{key:"set",value:function(s,i,o){return i.era=o,s.setUTCFullYear(o,0,1),s.setUTCHours(0,0,0,0),s}}]),t}(ze),ft={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Jn={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function pt(n,e){return n&&{value:e(n.value),rest:n.rest}}function it(n,e){var t=e.match(n);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function Xn(n,e){var t=e.match(n);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};var r=t[1]==="+"?1:-1,s=t[2]?parseInt(t[2],10):0,i=t[3]?parseInt(t[3],10):0,o=t[5]?parseInt(t[5],10):0;return{value:r*(s*$P+i*DP+o*EP),rest:e.slice(t[0].length)}}function e_(n){return it(ft.anyDigitsSigned,n)}function ut(n,e){switch(n){case 1:return it(ft.singleDigit,e);case 2:return it(ft.twoDigits,e);case 3:return it(ft.threeDigits,e);case 4:return it(ft.fourDigits,e);default:return it(new RegExp("^\\d{1,"+n+"}"),e)}}function pu(n,e){switch(n){case 1:return it(ft.singleDigitSigned,e);case 2:return it(ft.twoDigitsSigned,e);case 3:return it(ft.threeDigitsSigned,e);case 4:return it(ft.fourDigitsSigned,e);default:return it(new RegExp("^-?\\d{1,"+n+"}"),e)}}function Gp(n){switch(n){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function t_(n,e){var t=e>0,r=t?e:1-e,s;if(r<=50)s=n||100;else{var i=r+50,o=Math.floor(i/100)*100,a=n>=i%100;s=n+o-(a?100:0)}return t?s:1-s}function n_(n){return n%400===0||n%4===0&&n%100!==0}var _7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",130),X(ee(r),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){var a=function(c){return{year:c,isTwoDigitYear:i==="yy"}};switch(i){case"y":return pt(ut(4,s),a);case"yo":return pt(o.ordinalNumber(s,{unit:"year"}),a);default:return pt(ut(i.length,s),a)}}},{key:"validate",value:function(s,i){return i.isTwoDigitYear||i.year>0}},{key:"set",value:function(s,i,o){var a=s.getUTCFullYear();if(o.isTwoDigitYear){var l=t_(o.year,a);return s.setUTCFullYear(l,0,1),s.setUTCHours(0,0,0,0),s}var c=!("era"in i)||i.era===1?o.year:1-o.year;return s.setUTCFullYear(c,0,1),s.setUTCHours(0,0,0,0),s}}]),t}(ze),k7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",130),X(ee(r),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){var a=function(c){return{year:c,isTwoDigitYear:i==="YY"}};switch(i){case"Y":return pt(ut(4,s),a);case"Yo":return pt(o.ordinalNumber(s,{unit:"year"}),a);default:return pt(ut(i.length,s),a)}}},{key:"validate",value:function(s,i){return i.isTwoDigitYear||i.year>0}},{key:"set",value:function(s,i,o,a){var l=Kp(s,a);if(o.isTwoDigitYear){var c=t_(o.year,l);return s.setUTCFullYear(c,0,a.firstWeekContainsDate),s.setUTCHours(0,0,0,0),mi(s,a)}var u=!("era"in i)||i.era===1?o.year:1-o.year;return s.setUTCFullYear(u,0,a.firstWeekContainsDate),s.setUTCHours(0,0,0,0),mi(s,a)}}]),t}(ze),x7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",130),X(ee(r),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i){return pu(i==="R"?4:i.length,s)}},{key:"set",value:function(s,i,o){var a=new Date(0);return a.setUTCFullYear(o,0,4),a.setUTCHours(0,0,0,0),oo(a)}}]),t}(ze),C7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",130),X(ee(r),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i){return pu(i==="u"?4:i.length,s)}},{key:"set",value:function(s,i,o){return s.setUTCFullYear(o,0,1),s.setUTCHours(0,0,0,0),s}}]),t}(ze),S7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",120),X(ee(r),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){switch(i){case"Q":case"QQ":return ut(i.length,s);case"Qo":return o.ordinalNumber(s,{unit:"quarter"});case"QQQ":return o.quarter(s,{width:"abbreviated",context:"formatting"})||o.quarter(s,{width:"narrow",context:"formatting"});case"QQQQQ":return o.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return o.quarter(s,{width:"wide",context:"formatting"})||o.quarter(s,{width:"abbreviated",context:"formatting"})||o.quarter(s,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(s,i){return i>=1&&i<=4}},{key:"set",value:function(s,i,o){return s.setUTCMonth((o-1)*3,1),s.setUTCHours(0,0,0,0),s}}]),t}(ze),M7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",120),X(ee(r),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){switch(i){case"q":case"qq":return ut(i.length,s);case"qo":return o.ordinalNumber(s,{unit:"quarter"});case"qqq":return o.quarter(s,{width:"abbreviated",context:"standalone"})||o.quarter(s,{width:"narrow",context:"standalone"});case"qqqqq":return o.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return o.quarter(s,{width:"wide",context:"standalone"})||o.quarter(s,{width:"abbreviated",context:"standalone"})||o.quarter(s,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(s,i){return i>=1&&i<=4}},{key:"set",value:function(s,i,o){return s.setUTCMonth((o-1)*3,1),s.setUTCHours(0,0,0,0),s}}]),t}(ze),T7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),X(ee(r),"priority",110),r}return Ae(t,[{key:"parse",value:function(s,i,o){var a=function(c){return c-1};switch(i){case"M":return pt(it(ft.month,s),a);case"MM":return pt(ut(2,s),a);case"Mo":return pt(o.ordinalNumber(s,{unit:"month"}),a);case"MMM":return o.month(s,{width:"abbreviated",context:"formatting"})||o.month(s,{width:"narrow",context:"formatting"});case"MMMMM":return o.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return o.month(s,{width:"wide",context:"formatting"})||o.month(s,{width:"abbreviated",context:"formatting"})||o.month(s,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(s,i){return i>=0&&i<=11}},{key:"set",value:function(s,i,o){return s.setUTCMonth(o,1),s.setUTCHours(0,0,0,0),s}}]),t}(ze),O7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",110),X(ee(r),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){var a=function(c){return c-1};switch(i){case"L":return pt(it(ft.month,s),a);case"LL":return pt(ut(2,s),a);case"Lo":return pt(o.ordinalNumber(s,{unit:"month"}),a);case"LLL":return o.month(s,{width:"abbreviated",context:"standalone"})||o.month(s,{width:"narrow",context:"standalone"});case"LLLLL":return o.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return o.month(s,{width:"wide",context:"standalone"})||o.month(s,{width:"abbreviated",context:"standalone"})||o.month(s,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(s,i){return i>=0&&i<=11}},{key:"set",value:function(s,i,o){return s.setUTCMonth(o,1),s.setUTCHours(0,0,0,0),s}}]),t}(ze);function D7(n,e,t){le(2,arguments);var r=oe(n),s=qe(e),i=qw(r,t)-s;return r.setUTCDate(r.getUTCDate()-i*7),r}var $7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",100),X(ee(r),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){switch(i){case"w":return it(ft.week,s);case"wo":return o.ordinalNumber(s,{unit:"week"});default:return ut(i.length,s)}}},{key:"validate",value:function(s,i){return i>=1&&i<=53}},{key:"set",value:function(s,i,o,a){return mi(D7(s,o,a),a)}}]),t}(ze);function E7(n,e){le(2,arguments);var t=oe(n),r=qe(e),s=Uw(t)-r;return t.setUTCDate(t.getUTCDate()-s*7),t}var A7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",100),X(ee(r),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){switch(i){case"I":return it(ft.week,s);case"Io":return o.ordinalNumber(s,{unit:"week"});default:return ut(i.length,s)}}},{key:"validate",value:function(s,i){return i>=1&&i<=53}},{key:"set",value:function(s,i,o){return oo(E7(s,o))}}]),t}(ze),P7=[31,28,31,30,31,30,31,31,30,31,30,31],R7=[31,29,31,30,31,30,31,31,30,31,30,31],N7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",90),X(ee(r),"subPriority",1),X(ee(r),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){switch(i){case"d":return it(ft.date,s);case"do":return o.ordinalNumber(s,{unit:"date"});default:return ut(i.length,s)}}},{key:"validate",value:function(s,i){var o=s.getUTCFullYear(),a=n_(o),l=s.getUTCMonth();return a?i>=1&&i<=R7[l]:i>=1&&i<=P7[l]}},{key:"set",value:function(s,i,o){return s.setUTCDate(o),s.setUTCHours(0,0,0,0),s}}]),t}(ze),I7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",90),X(ee(r),"subpriority",1),X(ee(r),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){switch(i){case"D":case"DD":return it(ft.dayOfYear,s);case"Do":return o.ordinalNumber(s,{unit:"date"});default:return ut(i.length,s)}}},{key:"validate",value:function(s,i){var o=s.getUTCFullYear(),a=n_(o);return a?i>=1&&i<=366:i>=1&&i<=365}},{key:"set",value:function(s,i,o){return s.setUTCMonth(0,o),s.setUTCHours(0,0,0,0),s}}]),t}(ze);function Jp(n,e,t){var r,s,i,o,a,l,c,u;le(2,arguments);var d=Ar(),h=qe((r=(s=(i=(o=t==null?void 0:t.weekStartsOn)!==null&&o!==void 0?o:t==null||(a=t.locale)===null||a===void 0||(l=a.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&i!==void 0?i:d.weekStartsOn)!==null&&s!==void 0?s:(c=d.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&r!==void 0?r:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=oe(n),p=qe(e),m=f.getUTCDay(),g=p%7,b=(g+7)%7,_=(b<h?7:0)+p-m;return f.setUTCDate(f.getUTCDate()+_),f}var L7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",90),X(ee(r),"incompatibleTokens",["D","i","e","c","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){switch(i){case"E":case"EE":case"EEE":return o.day(s,{width:"abbreviated",context:"formatting"})||o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"});case"EEEEE":return o.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"});case"EEEE":default:return o.day(s,{width:"wide",context:"formatting"})||o.day(s,{width:"abbreviated",context:"formatting"})||o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(s,i){return i>=0&&i<=6}},{key:"set",value:function(s,i,o,a){return s=Jp(s,o,a),s.setUTCHours(0,0,0,0),s}}]),t}(ze),z7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",90),X(ee(r),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o,a){var l=function(u){var d=Math.floor((u-1)/7)*7;return(u+a.weekStartsOn+6)%7+d};switch(i){case"e":case"ee":return pt(ut(i.length,s),l);case"eo":return pt(o.ordinalNumber(s,{unit:"day"}),l);case"eee":return o.day(s,{width:"abbreviated",context:"formatting"})||o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"});case"eeeee":return o.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"});case"eeee":default:return o.day(s,{width:"wide",context:"formatting"})||o.day(s,{width:"abbreviated",context:"formatting"})||o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(s,i){return i>=0&&i<=6}},{key:"set",value:function(s,i,o,a){return s=Jp(s,o,a),s.setUTCHours(0,0,0,0),s}}]),t}(ze),B7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",90),X(ee(r),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o,a){var l=function(u){var d=Math.floor((u-1)/7)*7;return(u+a.weekStartsOn+6)%7+d};switch(i){case"c":case"cc":return pt(ut(i.length,s),l);case"co":return pt(o.ordinalNumber(s,{unit:"day"}),l);case"ccc":return o.day(s,{width:"abbreviated",context:"standalone"})||o.day(s,{width:"short",context:"standalone"})||o.day(s,{width:"narrow",context:"standalone"});case"ccccc":return o.day(s,{width:"narrow",context:"standalone"});case"cccccc":return o.day(s,{width:"short",context:"standalone"})||o.day(s,{width:"narrow",context:"standalone"});case"cccc":default:return o.day(s,{width:"wide",context:"standalone"})||o.day(s,{width:"abbreviated",context:"standalone"})||o.day(s,{width:"short",context:"standalone"})||o.day(s,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(s,i){return i>=0&&i<=6}},{key:"set",value:function(s,i,o,a){return s=Jp(s,o,a),s.setUTCHours(0,0,0,0),s}}]),t}(ze);function F7(n,e){le(2,arguments);var t=qe(e);t%7===0&&(t=t-7);var r=1,s=oe(n),i=s.getUTCDay(),o=t%7,a=(o+7)%7,l=(a<r?7:0)+t-i;return s.setUTCDate(s.getUTCDate()+l),s}var V7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",90),X(ee(r),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){var a=function(c){return c===0?7:c};switch(i){case"i":case"ii":return ut(i.length,s);case"io":return o.ordinalNumber(s,{unit:"day"});case"iii":return pt(o.day(s,{width:"abbreviated",context:"formatting"})||o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"}),a);case"iiiii":return pt(o.day(s,{width:"narrow",context:"formatting"}),a);case"iiiiii":return pt(o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"}),a);case"iiii":default:return pt(o.day(s,{width:"wide",context:"formatting"})||o.day(s,{width:"abbreviated",context:"formatting"})||o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"}),a)}}},{key:"validate",value:function(s,i){return i>=1&&i<=7}},{key:"set",value:function(s,i,o){return s=F7(s,o),s.setUTCHours(0,0,0,0),s}}]),t}(ze),H7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",80),X(ee(r),"incompatibleTokens",["b","B","H","k","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){switch(i){case"a":case"aa":case"aaa":return o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaaa":return o.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return o.dayPeriod(s,{width:"wide",context:"formatting"})||o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(s,i,o){return s.setUTCHours(Gp(o),0,0,0),s}}]),t}(ze),W7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",80),X(ee(r),"incompatibleTokens",["a","B","H","k","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){switch(i){case"b":case"bb":case"bbb":return o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbbb":return o.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return o.dayPeriod(s,{width:"wide",context:"formatting"})||o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(s,i,o){return s.setUTCHours(Gp(o),0,0,0),s}}]),t}(ze),j7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",80),X(ee(r),"incompatibleTokens",["a","b","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){switch(i){case"B":case"BB":case"BBB":return o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBBB":return o.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return o.dayPeriod(s,{width:"wide",context:"formatting"})||o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(s,i,o){return s.setUTCHours(Gp(o),0,0,0),s}}]),t}(ze),U7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",70),X(ee(r),"incompatibleTokens",["H","K","k","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){switch(i){case"h":return it(ft.hour12h,s);case"ho":return o.ordinalNumber(s,{unit:"hour"});default:return ut(i.length,s)}}},{key:"validate",value:function(s,i){return i>=1&&i<=12}},{key:"set",value:function(s,i,o){var a=s.getUTCHours()>=12;return a&&o<12?s.setUTCHours(o+12,0,0,0):!a&&o===12?s.setUTCHours(0,0,0,0):s.setUTCHours(o,0,0,0),s}}]),t}(ze),q7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",70),X(ee(r),"incompatibleTokens",["a","b","h","K","k","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){switch(i){case"H":return it(ft.hour23h,s);case"Ho":return o.ordinalNumber(s,{unit:"hour"});default:return ut(i.length,s)}}},{key:"validate",value:function(s,i){return i>=0&&i<=23}},{key:"set",value:function(s,i,o){return s.setUTCHours(o,0,0,0),s}}]),t}(ze),Y7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",70),X(ee(r),"incompatibleTokens",["h","H","k","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){switch(i){case"K":return it(ft.hour11h,s);case"Ko":return o.ordinalNumber(s,{unit:"hour"});default:return ut(i.length,s)}}},{key:"validate",value:function(s,i){return i>=0&&i<=11}},{key:"set",value:function(s,i,o){var a=s.getUTCHours()>=12;return a&&o<12?s.setUTCHours(o+12,0,0,0):s.setUTCHours(o,0,0,0),s}}]),t}(ze),K7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",70),X(ee(r),"incompatibleTokens",["a","b","h","H","K","t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){switch(i){case"k":return it(ft.hour24h,s);case"ko":return o.ordinalNumber(s,{unit:"hour"});default:return ut(i.length,s)}}},{key:"validate",value:function(s,i){return i>=1&&i<=24}},{key:"set",value:function(s,i,o){var a=o<=24?o%24:o;return s.setUTCHours(a,0,0,0),s}}]),t}(ze),G7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",60),X(ee(r),"incompatibleTokens",["t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){switch(i){case"m":return it(ft.minute,s);case"mo":return o.ordinalNumber(s,{unit:"minute"});default:return ut(i.length,s)}}},{key:"validate",value:function(s,i){return i>=0&&i<=59}},{key:"set",value:function(s,i,o){return s.setUTCMinutes(o,0,0),s}}]),t}(ze),J7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",50),X(ee(r),"incompatibleTokens",["t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i,o){switch(i){case"s":return it(ft.second,s);case"so":return o.ordinalNumber(s,{unit:"second"});default:return ut(i.length,s)}}},{key:"validate",value:function(s,i){return i>=0&&i<=59}},{key:"set",value:function(s,i,o){return s.setUTCSeconds(o,0),s}}]),t}(ze),X7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",30),X(ee(r),"incompatibleTokens",["t","T"]),r}return Ae(t,[{key:"parse",value:function(s,i){var o=function(l){return Math.floor(l*Math.pow(10,-i.length+3))};return pt(ut(i.length,s),o)}},{key:"set",value:function(s,i,o){return s.setUTCMilliseconds(o),s}}]),t}(ze),Q7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",10),X(ee(r),"incompatibleTokens",["t","T","x"]),r}return Ae(t,[{key:"parse",value:function(s,i){switch(i){case"X":return Xn(Jn.basicOptionalMinutes,s);case"XX":return Xn(Jn.basic,s);case"XXXX":return Xn(Jn.basicOptionalSeconds,s);case"XXXXX":return Xn(Jn.extendedOptionalSeconds,s);case"XXX":default:return Xn(Jn.extended,s)}}},{key:"set",value:function(s,i,o){return i.timestampIsSet?s:new Date(s.getTime()-o)}}]),t}(ze),Z7=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",10),X(ee(r),"incompatibleTokens",["t","T","X"]),r}return Ae(t,[{key:"parse",value:function(s,i){switch(i){case"x":return Xn(Jn.basicOptionalMinutes,s);case"xx":return Xn(Jn.basic,s);case"xxxx":return Xn(Jn.basicOptionalSeconds,s);case"xxxxx":return Xn(Jn.extendedOptionalSeconds,s);case"xxx":default:return Xn(Jn.extended,s)}}},{key:"set",value:function(s,i,o){return i.timestampIsSet?s:new Date(s.getTime()-o)}}]),t}(ze),eR=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",40),X(ee(r),"incompatibleTokens","*"),r}return Ae(t,[{key:"parse",value:function(s){return e_(s)}},{key:"set",value:function(s,i,o){return[new Date(o*1e3),{timestampIsSet:!0}]}}]),t}(ze),tR=function(n){Re(t,n);var e=Ne(t);function t(){var r;Ee(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=e.call.apply(e,[this].concat(i)),X(ee(r),"priority",20),X(ee(r),"incompatibleTokens","*"),r}return Ae(t,[{key:"parse",value:function(s){return e_(s)}},{key:"set",value:function(s,i,o){return[new Date(o),{timestampIsSet:!0}]}}]),t}(ze),nR={G:new w7,y:new _7,Y:new k7,R:new x7,u:new C7,Q:new S7,q:new M7,M:new T7,L:new O7,w:new $7,I:new A7,d:new N7,D:new I7,E:new L7,e:new z7,c:new B7,i:new V7,a:new H7,b:new W7,B:new j7,h:new U7,H:new q7,K:new Y7,k:new K7,m:new G7,s:new J7,S:new X7,X:new Q7,x:new Z7,t:new eR,T:new tR},rR=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,sR=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,iR=/^'([^]*?)'?$/,oR=/''/g,aR=/\S/,lR=/[a-zA-Z]/;function Vv(n,e,t,r){var s,i,o,a,l,c,u,d,h,f,p,m,g,b,_,M,k,C;le(3,arguments);var x=String(n),D=String(e),O=Ar(),E=(s=(i=r==null?void 0:r.locale)!==null&&i!==void 0?i:O.locale)!==null&&s!==void 0?s:Jw;if(!E.match)throw new RangeError("locale must contain match property");var R=qe((o=(a=(l=(c=r==null?void 0:r.firstWeekContainsDate)!==null&&c!==void 0?c:r==null||(u=r.locale)===null||u===void 0||(d=u.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&l!==void 0?l:O.firstWeekContainsDate)!==null&&a!==void 0?a:(h=O.locale)===null||h===void 0||(f=h.options)===null||f===void 0?void 0:f.firstWeekContainsDate)!==null&&o!==void 0?o:1);if(!(R>=1&&R<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var W=qe((p=(m=(g=(b=r==null?void 0:r.weekStartsOn)!==null&&b!==void 0?b:r==null||(_=r.locale)===null||_===void 0||(M=_.options)===null||M===void 0?void 0:M.weekStartsOn)!==null&&g!==void 0?g:O.weekStartsOn)!==null&&m!==void 0?m:(k=O.locale)===null||k===void 0||(C=k.options)===null||C===void 0?void 0:C.weekStartsOn)!==null&&p!==void 0?p:0);if(!(W>=0&&W<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(D==="")return x===""?oe(t):new Date(NaN);var K={firstWeekContainsDate:R,weekStartsOn:W,locale:E},_e=[new b7],He=D.match(sR).map(function(N){var Z=N[0];if(Z in _f){var se=_f[Z];return se(N,E.formatLong)}return N}).join("").match(rR),te=[],de=Bv(He),me;try{var De=function(){var Z=me.value;!(r!=null&&r.useAdditionalWeekYearTokens)&&Gw(Z)&&hu(Z,D,n),!(r!=null&&r.useAdditionalDayOfYearTokens)&&Kw(Z)&&hu(Z,D,n);var se=Z[0],Ke=nR[se];if(Ke){var Ct=Ke.incompatibleTokens;if(Array.isArray(Ct)){var zt=te.find(function(Do){return Ct.includes(Do.token)||Do.token===se});if(zt)throw new RangeError("The format string mustn't contain `".concat(zt.fullToken,"` and `").concat(Z,"` at the same time"))}else if(Ke.incompatibleTokens==="*"&&te.length>0)throw new RangeError("The format string mustn't contain `".concat(Z,"` and any other token at the same time"));te.push({token:se,fullToken:Z});var Fn=Ke.run(x,Z,E.match,K);if(!Fn)return{v:new Date(NaN)};_e.push(Fn.setter),x=Fn.rest}else{if(se.match(lR))throw new RangeError("Format string contains an unescaped latin alphabet character `"+se+"`");if(Z==="''"?Z="'":se==="'"&&(Z=cR(Z)),x.indexOf(Z)===0)x=x.slice(Z.length);else return{v:new Date(NaN)}}};for(de.s();!(me=de.n()).done;){var ye=De();if(Cn(ye)==="object")return ye.v}}catch(N){de.e(N)}finally{de.f()}if(x.length>0&&aR.test(x))return new Date(NaN);var fe=_e.map(function(N){return N.priority}).sort(function(N,Z){return Z-N}).filter(function(N,Z,se){return se.indexOf(N)===Z}).map(function(N){return _e.filter(function(Z){return Z.priority===N}).sort(function(Z,se){return se.subPriority-Z.subPriority})}).map(function(N){return N[0]}),Xe=oe(t);if(isNaN(Xe.getTime()))return new Date(NaN);var V=Ww(Xe,Fw(Xe)),z={},F=Bv(fe),re;try{for(F.s();!(re=F.n()).done;){var ce=re.value;if(!ce.validate(V,K))return new Date(NaN);var H=ce.set(V,z,K);Array.isArray(H)?(V=H[0],h7(z,H[1])):V=H}}catch(N){F.e(N)}finally{F.f()}return V}function cR(n){return n.match(iR)[1].replace(oR,"'")}function Hv(n){le(1,arguments);var e=oe(n);return e.setMinutes(0,0,0),e}function uR(n,e){le(2,arguments);var t=Hv(n),r=Hv(e);return t.getTime()===r.getTime()}function dR(n,e){le(2,arguments);var t=Rv(n),r=Rv(e);return t.getTime()===r.getTime()}function xf(n,e){le(2,arguments);var t=oe(n),r=oe(e);return t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth()}function Wv(n,e){le(2,arguments);var t=oe(n),r=oe(e);return t.getFullYear()===r.getFullYear()}function hR(n,e){le(2,arguments);var t=oe(n).getTime(),r=oe(e.start).getTime(),s=oe(e.end).getTime();if(!(r<=s))throw new RangeError("Invalid interval");return t>=r&&t<=s}function fR(n,e){le(2,arguments);var t=oe(n),r=qe(e),s=t.getFullYear(),i=t.getDate(),o=new Date(0);o.setFullYear(s,r,15),o.setHours(0,0,0,0);var a=f7(o);return t.setMonth(r,Math.min(i,a)),t}function jv(n,e){if(le(2,arguments),Cn(e)!=="object"||e===null)throw new RangeError("values parameter must be an object");var t=oe(n);return isNaN(t.getTime())?new Date(NaN):(e.year!=null&&t.setFullYear(e.year),e.month!=null&&(t=fR(t,e.month)),e.date!=null&&t.setDate(qe(e.date)),e.hours!=null&&t.setHours(qe(e.hours)),e.minutes!=null&&t.setMinutes(qe(e.minutes)),e.seconds!=null&&t.setSeconds(qe(e.seconds)),e.milliseconds!=null&&t.setMilliseconds(qe(e.milliseconds)),t)}function pR(n,e,t){var r,s,i,o,a,l,c,u;le(2,arguments);var d=Ar(),h=qe((r=(s=(i=(o=t==null?void 0:t.weekStartsOn)!==null&&o!==void 0?o:t==null||(a=t.locale)===null||a===void 0||(l=a.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&i!==void 0?i:d.weekStartsOn)!==null&&s!==void 0?s:(c=d.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&r!==void 0?r:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=oe(n),p=qe(e),m=f.getDay(),g=p%7,b=(g+7)%7,_=7-h,M=p<0||p>6?p-(m+_)%7:(b+_)%7-(m+_)%7;return xP(f,M)}function mR(n){le(1,arguments);var e=oe(n),t=e.getFullYear(),r=Math.floor(t/10)*10;return e.setFullYear(r,0,1),e.setHours(0,0,0,0),e}function gR(n,e){le(2,arguments);var t=qe(e);return qp(n,-t)}function r_(n,e){le(2,arguments);var t=qe(e);return Yp(n,-t)}function yR(){return gp("datasets/licenses/")}async function vR(n,e,t,r,s){return(await rl.get("/datasets/"+n+"/resources/",{params:{page:t,type:e,page_size:r,q:s}})).data}async function bR(n,e,t){return(await mt.get("datasets/community_resources/",{params:{page:e,dataset:n,page_size:t}})).data}function wR(){return gp("datasets/extensions/")}const td=(n,e=0,t=!1)=>{let r;return(...s)=>{t&&!r&&n(...s),clearTimeout(r),r=setTimeout(()=>{n(...s)},e)}};function _R(n,e=0,t=!1){const r=$(n);return V0((s,i)=>({get(){return s(),r.value},set:td(o=>{r.value=o,i()},e,t)}))}const kR="/_themes/gouvfr/assets/magnifying_glass.svg",xR=B({props:{actionsAlignment:{type:String,default:""},heading:{type:String,default:"h2"},icon:{type:String,required:!0},stretchHeight:{type:Boolean,default:!1},title:{type:String,required:!0},content:{type:String},type:{type:String,default:"default"}},setup(n){const e=A(()=>"fr-grid-row--".concat(uC(n.actionsAlignment))),t=A(()=>n.type==="primary"?"bg-contrast-blue-cumulus":"bg-white"),r=A(()=>n.type==="primary"),s=A(()=>n.type==="default");return{alignment:e,isDefault:s,isPrimary:r,type:t}}}),CR={class:"fr-col-auto"},SR=["src"],MR={class:"fr-col-12 fr-col-sm fr-grid-row flex-direction-column justify-between"},TR={class:"fr-mb-1w"},OR={key:0,class:"fr-my-1w"};function DR(n,e,t,r,s,i){return w(),S("div",{class:ue(["rounded-xxs fr-p-3w fr-grid-row flex-direction-column",{"h-100":n.stretchHeight,[n.type]:n.type,"border border-default-grey":!n.isPrimary}])},[v("div",{class:ue(["fr-col fr-grid-row fr-grid-row--gutters",{"text-blue-400":n.isPrimary}])},[v("div",CR,[v("img",{class:"w-100",src:n.icon,alt:""},null,8,SR)]),v("div",MR,[v("div",TR,[(w(),Y(Js(n.heading),{class:ue(["fr-m-0 fr-mb-1w",{"fr-text--bold fr-text--md":n.isPrimary,"fr--h5":!n.isPrimary}])},{default:q(()=>[U(T(n.title),1)]),_:1},8,["class"])),n.content?(w(),S("p",OR,T(n.content),1)):Ye(n.$slots,"default",{key:1})]),v("div",{class:ue(["fr-grid-row",n.alignment])},[Ye(n.$slots,"actions")],2)])],2)],2)}const $R=$e(xR,[["render",DR]]),ER={class:"fr-mt-1v fr-mb-3v"},AR=["href"],mu=B({__name:"NoSearchResults",emits:["resetFilters"],setup(n){const{t:e}=Te();return(t,r)=>(w(),Y($R,{title:y(e)("Didn't find what you are looking for?"),icon:y(kR),type:"primary"},{actions:q(()=>[v("button",{onClick:r[0]||(r[0]=s=>t.$emit("resetFilters")),class:"fr-btn fr-btn--secondary"},T(y(e)("Reset filters")),1),y(ey)?(w(),S("a",{key:0,href:y(ey),class:"fr-btn fr-btn--tertiary-no-outline fr-btn--icon-left fr-icon-lightbulb-line fr-ml-1w"},T(y(e)("Check our forum")),9,AR)):I("",!0)]),default:q(()=>[v("p",ER,[U(T(y(e)("Try resetting the filters to broaden your search.")),1),r[1]||(r[1]=v("br",null,null,-1)),U(" "+T(y(e)("You can also check ongoing requests and submit your own on our forum dedicated to data discovery and openness.")),1)])]),_:1},8,["title","icon"]))}}),PR={class:"fr-grid-row fr-mt-1w fr-mt-md-5v"},RR={class:"fr-col-12 fr-col-md-4 fr-col-lg-3"},NR={class:"fr-sidemenu","aria-labelledby":"fr-sidemenu-title"},IR={class:"fr-sidemenu__inner"},LR={class:"fr-sidemenu__btn fr-mt-1w",hidden:"","aria-controls":"fr-sidemenu-wrapper","aria-expanded":"false"},zR={class:"fr-collapse",id:"fr-sidemenu-wrapper"},BR={class:"fr-sidemenu__title fr-mb-3v",id:"fr-sidemenu-title"},FR={class:"fr-grid-row fr-grid-row--gutters"},VR={key:0,class:"fr-col-12"},HR={class:"fr-col-12"},WR={class:"fr-col-12"},jR={class:"fr-col-12"},UR={class:"fr-col-12"},qR={class:"fr-col-12"},YR={class:"fr-col-12"},KR={key:1,class:"fr-col-12 fr-mb-3w text-align-center"},GR=["href"],JR={key:0,class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle justify-between fr-pb-1w"},XR={class:"fr-col-auto fr-my-0",role:"status"},QR={class:"fr-col-auto fr-grid-row fr-grid-row--middle"},ZR={for:"sort-search",class:"fr-col-auto fr-text--sm fr-m-0 fr-mr-1w"},eN={class:"fr-col"},tN={value:""},nN=["value"],rN={key:0},sN={key:1},iN={class:"fr-mt-1w border-default-grey border-top relative z-2"},oN={key:2,class:"fr-mt-2w"},rh=20,Ul=!0,aN=!1,lN=B({inheritAttrs:!1,__name:"Search",props:{downloadLink:{default:""},disableFirstSearch:{type:Boolean,default:!1},organization:{default:""},sorts:{default:()=>[]}},setup(n){const e=n,{t}=Te(),{toast:r}=Mn(),s=new URL(window.location.href),i=new URLSearchParams(s.search),o=wR(),a=yR(),l=hb().filter(V=>V.type!==Uu&&V.type!==ub).map(V=>({label:V.label,value:V.type})),c=Promise.resolve(l),u=$(""),{reuseUrl:d}=zw(u),h=$(""),f=$([]),p=$(0),m=$(1),g=$({organization:e.organization}),b=$(!1),_=$(null),M=$(null),k=$(null),C=(V=Ul)=>{let z=new URL(window.location.href);const F={...De.value};e.organization&&(delete F.organization,delete F.organization_badge),z.search=new URLSearchParams(F).toString(),V&&window.history.pushState(null,"",z);let re=document.querySelectorAll("[data-q]");for(let ce of re)ce.href=d.value},x=td((V=Ul)=>{b.value=!0,_.value&&_.value.cancel(),_.value=Wu(),rl.get("/datasets/search/",{cancelToken:_.value.token,params:{...De.value,page_size:rh}}).then(z=>z.data).then(z=>{f.value=z.data,p.value=z.total,b.value=!1,C(V)}).catch(z=>{Qn.isCancel(z)||(r.error(t("Error getting search results.")),b.value=!1)})},Fh),D=V=>{u.value=V,m.value=1,x()},O=(V,z)=>{z?g.value[V]=z:g.value[V]=void 0,e.organization&&(g.value.organization=e.organization,g.value.organization_badge=void 0),m.value=1,x()},E=()=>{m.value=1,x()},R=V=>{m.value=V,x(),W()},W=()=>{k.value&&k.value.scrollIntoView({behavior:"smooth"})},K=({page:V=1,sort:z="",...F},re=Ul)=>{g.value={...F,organization:e.organization||F.organization},m.value=V,h.value=z,x(re)},_e=()=>{K({})},He=()=>{te(),W()},te=({q:V="",...z}={},F=Ul)=>{u.value=V,K(z,F)},de=A(()=>Object.keys(g.value).some(z=>{var F;return((F=g.value[z])==null?void 0:F.length)&&(e.organization?z!=="organization":!0)})),me=A(()=>e.sorts.map(V=>({value:V.order=="asc"?V.value:"-"+V.value,label:V.label}))),De=A(()=>{let V={},z;for(z in g.value){const F=g.value[z];F&&(V[z]=F)}return m.value>1&&(V.page=m.value.toString()),u.value&&(V.q=u.value),h.value&&(V.sort=h.value),V}),ye=i.get("q");ye&&(u.value=ye,i.delete("q"));const fe=i.get("page");fe&&(m.value=parseInt(fe),i.delete("page"));const Xe=i.get("sort");return Xe&&(h.value=Xe,i.delete("sort")),g.value={...Object.fromEntries(i),organization:e.organization||i.get("organization")||""},e.disableFirstSearch?b.value=!0:x(),Ve(()=>{if(e.disableFirstSearch&&M.value){let V=M.value.dataset.totalResults;if(V&&parseInt(V)>0){let z=M.value.dataset.results;z&&(f.value=JSON.parse(z)),p.value=JSON.parse(V)}b.value=!1}addEventListener("popstate",()=>{const V=new URL(window.location.href),z={};for(const[F,re]of V.searchParams)z[F]=re;te(z,aN)})}),(V,z)=>(w(),S("form",{class:"fr-pt-3v",onSubmit:z[9]||(z[9]=Se((...F)=>y(x)&&y(x)(...F),["prevent"]))},[v("div",{class:"fr-grid-row fr-grid-row--middle justify-between",ref_key:"searchRef",ref:k,"data-cy":"search"},[P(qA,{onChange:D,value:u.value,placeholder:y(t)("Ex. 2022 presidential election")},null,8,["value","placeholder"])],512),v("div",PR,[v("div",RR,[v("nav",NR,[v("div",IR,[v("button",LR,T(y(t)("Filter results")),1),v("div",zR,[v("div",BR,T(y(t)("Filters")),1),v("div",FR,[V.organization?I("",!0):(w(),S("div",VR,[P(vr,{placeholder:y(t)("Organizations"),searchPlaceholder:y(t)("Search an organization..."),allOption:y(t)("All organizations"),listUrl:"/organizations/?sort=-followers",suggestUrl:"/organizations/suggest/",entityUrl:"/organizations/",values:g.value.organization,onChange:z[0]||(z[0]=F=>O("organization",F)),isBlue:!0},null,8,["placeholder","searchPlaceholder","allOption","values"]),P(vr,{initialOptions:y(c),placeholder:y(t)("Organization type"),searchPlaceholder:y(t)("Search an organization type..."),allOption:y(t)("All types"),values:g.value.organization_badge,onChange:z[1]||(z[1]=F=>O("organization_badge",F)),isBlue:!0},null,8,["initialOptions","placeholder","searchPlaceholder","allOption","values"])])),v("div",HR,[P(vr,{placeholder:y(t)("Tags"),searchPlaceholder:y(t)("Search a tag..."),allOption:y(t)("All tags"),suggestUrl:"/tags/suggest/",values:g.value.tag,onChange:z[2]||(z[2]=F=>O("tag",F)),minimumCharacterBeforeSuggest:2,isBlue:!0},null,8,["placeholder","searchPlaceholder","allOption","values"])]),v("div",WR,[P(vr,{placeholder:y(t)("Formats"),searchPlaceholder:y(t)("Search a format..."),allOption:y(t)("All formats"),listUrl:y(o),values:g.value.format,onChange:z[3]||(z[3]=F=>O("format",F)),isBlue:!0},null,8,["placeholder","searchPlaceholder","allOption","listUrl","values"])]),v("div",jR,[P(vr,{placeholder:y(t)("Licenses"),explanation:y(t)("Licenses define reuse rules for published datasets. See page data.gouv.fr/licences"),searchPlaceholder:y(t)("Search a license..."),allOption:y(t)("All licenses"),listUrl:y(a),values:g.value.license,onChange:z[4]||(z[4]=F=>O("license",F)),isBlue:!0},null,8,["placeholder","explanation","searchPlaceholder","allOption","listUrl","values"])]),v("div",UR,[P(kP,{values:g.value.schema||"",onChange:z[5]||(z[5]=F=>O("schema",F)),isBlue:!0},null,8,["values"])]),v("div",qR,[P(vr,{placeholder:y(t)("Spatial coverage"),explanation:y(t)("Geographic areas covered by data and for which they are relevant."),searchPlaceholder:y(t)("Search a spatial coverage..."),allOption:y(t)("All coverages"),suggestUrl:"/spatial/zones/suggest/",entityUrl:"/spatial/zone/",values:g.value.geozone,onChange:z[6]||(z[6]=F=>O("geozone",F)),isBlue:!0},null,8,["placeholder","explanation","searchPlaceholder","allOption","values"])]),v("div",YR,[P(vr,{placeholder:y(t)("Spatial granularity"),explanation:y(t)("Finest level of geographic detail covered by data."),searchPlaceholder:y(t)("Search a granularity..."),allOption:y(t)("All granularities"),listUrl:"/spatial/granularities/",values:g.value.granularity,onChange:z[7]||(z[7]=F=>O("granularity",F)),isBlue:!0},null,8,["placeholder","explanation","searchPlaceholder","allOption","values"])]),de.value||V.downloadLink?(w(),S("div",KR,[de.value?(w(),S("button",{key:0,class:"fr-btn fr-btn--secondary fr-icon-close-circle-line fr-btn--icon-left justify-center w-100",onClick:_e},T(y(t)("Reset filters")),1)):V.downloadLink?(w(),S("a",{key:1,class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500 fr-icon-download-line fr-btn--icon-left justify-center w-100 matomo_download",href:V.downloadLink},T(y(t)("Download list as CSV")),9,GR)):I("",!0)])):I("",!0)])])])])]),v("section",rr({class:"fr-col-12 fr-col-md-8 fr-col-lg-9 fr-mt-2w fr-mt-md-0 search-results",ref_key:"resultsRef",ref:M},V.$attrs),[p.value?(w(),S("div",JR,[v("p",XR,T(y(t)("{count} results",p.value)),1),v("div",QR,[v("label",ZR,T(y(t)("Sort by:")),1),v("div",eN,[yt(v("select",{id:"sort-search",class:"fr-select fr-select--blue",name:"sort","onUpdate:modelValue":z[8]||(z[8]=F=>h.value=F),onChange:E},[v("option",tN,T(y(t)("Relevance")),1),(w(!0),S(J,null,Fe(me.value,({value:F,label:re})=>(w(),S("option",{value:F},T(re),9,nN))),256))],544),[[Bu,h.value]])])])])):I("",!0),P(tl,{mode:"out-in"},{default:q(()=>[b.value?(w(),S("div",rN,[P(jp)])):f.value.length?(w(),S("div",sN,[v("ul",iN,[(w(!0),S(J,null,Fe(f.value,F=>(w(),S("li",{key:F.id},[P(Bw,{dataset:F},null,8,["dataset"])]))),128))]),p.value>rh?(w(),Y(y(Ci),{key:0,page:m.value,pageSize:rh,totalResults:p.value,onChange:R,class:"fr-mt-2w"},null,8,["page","totalResults"])):(w(),Y(mu,{key:1,onResetFilters:He}))])):(w(),S("div",oN,[P(mu,{onResetFilters:He})]))]),_:1})],16)])],32))}}),cN=["disabled","aria-controls"],uN=["id"],dN={class:"fr-container fr-container--fluid fr-container-md"},hN={class:"fr-grid-row fr-grid-row--center"},fN={class:"fr-col-12 fr-col-md-8 fr-col-lg-6"},pN={class:"fr-modal__body"},mN={class:"fr-modal__header"},gN=["aria-controls"],yN={class:"fr-modal__content"},vN={class:"fr-modal__footer"},bN={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-reverse fr-btns-group--inline-lg fr-btns-group--icon-left"},wN=B({__name:"DeleteButton",props:{url:{}},setup(n){const e=n,{t}=Te(),{toast:r}=Mn(),s=Hu,i=xi("delete-modal"),o=i+"-title";function a(){return nl(),mt.delete(e.url).then(()=>window.location.reload()).catch(()=>r.error(t("An error occured during the deletion.")))}return(l,c)=>(w(),S(J,null,[v("button",{type:"button",class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-warning-425 fr-btn--icon-left fr-icon-delete-line",disabled:y(s),"data-fr-opened":"false","aria-controls":y(i)},T(y(t)("Delete")),9,cN),(w(),Y(ws,{to:"body"},[v("dialog",{"aria-labelledby":o,id:y(i),class:"fr-modal",role:"dialog"},[v("div",dN,[v("div",hN,[v("div",fN,[v("div",pN,[v("div",mN,[v("button",{class:"fr-btn--close fr-btn","aria-controls":y(i)},T(y(t)("Close")),9,gN)]),v("div",yN,[v("h1",{id:o,class:"fr-modal__title"},[c[0]||(c[0]=v("span",{class:"fr-icon-delete-line fr-icon--lg"},null,-1)),U(" "+T(y(t)("Are you sure ?")),1)]),v("p",null,T(y(t)("The content will be permanently deleted.")),1)]),v("div",vN,[v("div",bN,[v("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-warning-425 fr-btn--icon-left fr-icon-delete-line",role:"button",onClick:a},T(y(t)("Delete")),1)])])])])])])],8,uN)]))],64))}});function _N(n){return mt.delete("users/".concat(n,"/"))}function kN(n){return mt.delete("users/".concat(n,"/?no_mail=true&delete_comments=true"))}const xN=["disabled","aria-controls"],CN=["id"],SN={class:"fr-container fr-container--fluid fr-container-md"},MN={class:"fr-grid-row fr-grid-row--center"},TN={class:"fr-col-12 fr-col-md-8 fr-col-lg-6"},ON={class:"fr-modal__body"},DN={class:"fr-modal__header"},$N=["aria-controls"],EN={class:"fr-modal__content"},AN={class:"fr-grid-row fr-grid-row--middle fr-mb-2w"},PN={class:"avatar fr-mr-1w"},RN=["src"],NN={class:"fr-modal__footer"},IN={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-reverse fr-btns-group--inline-lg fr-btns-group--icon-left"},LN=B({__name:"DeleteUserButton",props:{id:{},full_name:{},avatar_thumbnail:{}},setup(n){const e=n,{t}=Te(),{toast:r}=Mn(),s=Hu,i=xi("delete-modal"),o=i+"-title";function a(){return _N(e.id).then(()=>window.location.reload()).catch(()=>r.error(t("An error occured during the deletion.")))}function l(){return kN(e.id).then(()=>window.location.reload()).catch(()=>r.error(t("An error occured during the deletion.")))}return(c,u)=>(w(),S(J,null,[v("button",{type:"button",class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-warning-425 fr-btn--icon-left fr-icon-delete-line",disabled:y(s),"data-fr-opened":"false","aria-controls":y(i)},T(y(t)("Delete")),9,xN),(w(),Y(ws,{to:"body"},[v("dialog",{"aria-labelledby":o,id:y(i),class:"fr-modal",role:"dialog"},[v("div",SN,[v("div",MN,[v("div",TN,[v("div",ON,[v("div",DN,[v("button",{class:"fr-btn--close fr-btn","aria-controls":y(i)},T(y(t)("Close")),9,$N)]),v("div",EN,[v("h1",{id:o,class:"fr-modal__title"},[u[0]||(u[0]=v("span",{class:"fr-icon-delete-line fr-icon--lg"},null,-1)),U(" "+T(y(t)("Are you sure ?")),1)]),v("p",AN,[v("div",PN,[v("img",{class:"rounded-circle border border-default-grey",src:e.avatar_thumbnail,width:"40",height:"40",loading:"lazy",alt:""},null,8,RN)]),U(" "+T(e.full_name)+" "+T(y(t)("will be permanently deleted.")),1)])]),v("div",NN,[v("div",IN,[v("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-warning-425 fr-btn--icon-left fr-icon-delete-line",role:"button",onClick:l},T(y(t)("Delete without as spam (no mail sent and discussions are deleted)")),1),v("button",{class:"fr-btn bg-warning-425 fr-btn--icon-left fr-icon-delete-line",role:"button",onClick:a},T(y(t)("Delete")),1)])])])])])])],8,CN)]))],64))}}),zN=B({name:"featured-button",props:{subjectId:{type:String,required:!0},subjectType:{type:String,required:!0},featured:{type:Boolean,required:!0}},setup(n){const{t:e}=Te(),{toast:t}=Mn(),r=$(n.featured),s=$(null),i=()=>{const o=r.value?"delete":"post",a="".concat(n.subjectType.toLowerCase(),"s/").concat(n.subjectId,"/featured/");mt[o](a).then(l=>{r.value=!r.value}).catch(()=>t.error(e("An error occurred while featuring this subject.")))};return Ve(()=>{var o;return(o=s.value)==null?void 0:o.toggleAttribute("checked",r.value)}),{isFeatured:r,t:e,toggleFeatured:i,toggleInput:s}}}),BN={class:"fr-toggle fr-toggle--label-left"},FN=["checked"],VN=["data-fr-checked-label","data-fr-unchecked-label"];function HN(n,e,t,r,s,i){return w(),S("div",BN,[v("input",{ref:"toggleInput",onClick:e[0]||(e[0]=(...o)=>n.toggleFeatured&&n.toggleFeatured(...o)),type:"checkbox",class:"fr-toggle__input",id:"featured-toggle",checked:n.isFeatured},null,8,FN),v("label",{class:"fr-toggle__label",for:"featured-toggle","data-fr-checked-label":n.t("Featured"),"data-fr-unchecked-label":n.t("Standard")},T(n.t("Feature this content")),9,VN)])}const WN=$e(zN,[["render",HN]]),jN=B({props:{followers:Number,url:{type:String,required:!0},following:Boolean},setup(n){const e=$(!1),t=$(n.following),r=Vs.read_only_enabled;return{following:t,animating:e,readOnlyEnabled:r,toggleFollow:()=>{nl();let i;t.value?i=mt.delete(n.url):i=mt.post(n.url),i.then(()=>{t.value=!t.value,t.value&&(e.value=!0,setTimeout(()=>e.value=!1,1300))})}}}}),UN=["disabled"],qN={class:"fr-ml-1w"};function YN(n,e,t,r,s,i){return w(),S("button",{onClick:e[0]||(e[0]=Se((...o)=>n.toggleFollow&&n.toggleFollow(...o),["prevent"])),type:"button",class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 follow-button",disabled:n.readOnlyEnabled},[v("span",{class:ue(["magic fr-grid-row",{active:n.animating}]),style:vo({color:n.following?"inherit":"transparent"})},e[1]||(e[1]=[v("svg",{"aria-hidden":"true",width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},[v("path",{d:"M7.20703 1.24224L5.42968 4.87896L1.41015 5.45318C0.699214 5.56255 0.425776 6.43755 0.945308 6.95709L3.8164 9.77349L3.13281 13.7383C3.02343 14.4493 3.78906 14.9961 4.41796 14.668L8 12.7813L11.5547 14.668C12.1836 14.9961 12.9492 14.4493 12.8398 13.7383L12.1562 9.77349L15.0273 6.95709C15.5469 6.43755 15.2734 5.56255 14.5625 5.45318L10.5703 4.87896L8.76562 1.24224C8.46484 0.613336 7.53515 0.585992 7.20703 1.24224Z",stroke:"#161616"})],-1)]),6),v("span",qN,[n.following?(w(),S(J,{key:0},[U(T(n.$t("Remove from favourites")),1)],64)):(w(),S(J,{key:1},[U(T(n.$t("Add to favourites")),1)],64))])],8,UN)}const KN=$e(jN,[["render",YN]]),GN=B({props:{organization:{type:String,required:!0}},setup(n){const{t:e}=Te(),t=$("");return{askToJoinOrganization:()=>{nl(),t.value=prompt(e("You can add some details here for your membership request"))||"",mt.post("organizations/"+n.organization+"/membership/",{comment:t.value}).then(s=>{alert(e("A request has been sent to the administrators")),window.location.reload()}).catch(s=>{alert(e("Error while requesting membership")),console.error(s)})},comment:t}}});function JN(n,e,t,r,s,i){return w(),S("button",{onClick:e[0]||(e[0]=Se((...o)=>n.askToJoinOrganization&&n.askToJoinOrganization(...o),["prevent"])),class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500 fr-btn--icon-left fr-icon-team-line"},T(n.$t("Ask to join the organization as a producer")),1)}const XN=$e(GN,[["render",JN]]);zu(["pdf","doc","docx","word","xls","excel","xlsx"]);const lo=/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/i,QN=new RegExp("/resources/("+lo.source+")?$",lo.flags),ZN=new RegExp("/resource-("+lo.source+")?$",lo.flags),e9=new RegExp("/community-resources/("+lo.source+")?$",lo.flags),s_=(n,e)=>{for(const t of e?[e9]:[QN,ZN]){let[r,s,i]=t.exec(n)||[];if(s)return s}return null};function i_(){const n=$(window.location.hash),e=()=>n.value=window.location.hash;return Ve(()=>window.addEventListener("hashchange",e)),Nn(()=>window.removeEventListener("hashchange",e)),{hash:n}}function Uv(){history.pushState(null,""," "),window.dispatchEvent(new HashChangeEvent("hashchange"))}const t9={key:0},n9={key:1},r9={class:"fr-grid-row fr-grid-row--middle justify-between"},s9={key:0},i9={key:1},o9=B({__name:"resourceFromHash",props:{canEdit:{type:Boolean},datasetId:{},communityResource:{type:Boolean,default:!1}},setup(n){const e=n,{t}=Te(),{toast:r}=Mn(),s=$(null),i=$(null),o=$(!1),{hash:a}=i_(),l=A(()=>s_(a.value,e.communityResource)),c=A(()=>e.communityResource?"/datasets/community_resources/".concat(l.value):"/datasets/".concat(e.datasetId,"/resources/").concat(l.value));return It(async()=>{if(l.value){o.value=!0;try{const d=await(await mt.get(c.value)).data;d&&(i.value=d,s.value&&s.value.scrollIntoView())}catch(u){console.error(u),r.error(t("An error occurred while fetching the file ")+l.value)}finally{o.value=!1}}}),(u,d)=>l.value?(w(),S("section",{key:0,ref_key:"top",ref:s},[P(tl,{mode:"out-in"},{default:q(()=>[o.value?(w(),S("div",t9,[P(y(Hb))])):(w(),S("div",n9,[P(y(nu),{type:"secondary",color:"success",class:"fr-mb-2w"},{default:q(()=>[v("div",r9,[u.communityResource?(w(),S("span",s9,T(y(t)("You are seeing a specific community resource of this dataset")),1)):(w(),S("span",i9,T(y(t)("You are seeing a specific file of this dataset")),1)),v("button",{class:"fr-btn--close fr-btn fr-mr-0",onClick:d[0]||(d[0]=Se((...h)=>y(Uv)&&y(Uv)(...h),["prevent"]))},T(y(t)("Close")),1)])]),_:1}),i.value?(w(),Y(y(Vb),{key:0,id:"resource-"+l.value,datasetId:u.datasetId,expandedOnMount:!0,resource:i.value,canEdit:u.canEdit,isCommunityResource:u.communityResource},null,8,["id","datasetId","resource","canEdit","isCommunityResource"])):I("",!0)]))]),_:1})],512)):I("",!0)}}),o_=B({__name:"Reuse",props:{reuse:{}},setup(n){return(e,t)=>{var r;return w(),Y(y(i5),{reuse:e.reuse,reuseUrl:e.reuse.page,organizationUrl:(r=e.reuse.organization)==null?void 0:r.page},null,8,["reuse","reuseUrl","organizationUrl"])}}});function a9(n){return{all:n=n||new Map,on:function(e,t){var r=n.get(e);r?r.push(t):n.set(e,[t])},off:function(e,t){var r=n.get(e);r&&(t?r.splice(r.indexOf(t)>>>0,1):n.set(e,[]))},emit:function(e,t){var r=n.get(e);r&&r.slice().map(function(s){s(t)}),(r=n.get("*"))&&r.slice().map(function(s){s(e,t)})}}}const Cf="resourcesSearch",Xp=a9(),l9=n=>{n.config.globalProperties.$bus=Xp},c9=B({props:{eventName:{type:String,default:Cf},type:{type:String}},setup(n){const e=_R("",Fh),t=()=>{Xp.emit(n.eventName,{type:n.type,value:e.value})};dC&&et(e,t);let r;const s=()=>{r=setTimeout(()=>{t()},Fh)};return Nn(()=>clearTimeout(r)),{search:t,searchWithoutAutocomplete:s,searchValue:e}}}),u9=["aria-label"],d9=["for"],h9=["id"],f9={class:"fr-btn",type:"submit"};function p9(n,e,t,r,s,i){return w(),S("form",{onSubmit:e[1]||(e[1]=Se((...o)=>n.searchWithoutAutocomplete&&n.searchWithoutAutocomplete(...o),["prevent"]))},[v("div",{class:"fr-search-bar",role:"search","aria-label":n.$t("Search files")},[v("label",{class:"fr-label",for:n.eventName},T(n.$t("Search files")),9,d9),yt(v("input",{class:"fr-input",placeholder:"Rechercher",type:"search",id:n.eventName,"onUpdate:modelValue":e[0]||(e[0]=o=>n.searchValue=o)},null,8,h9),[[fs,n.searchValue]]),v("button",f9,T(n.$t("Search")),1)],8,u9)],32)}const m9=$e(c9,[["render",p9]]),g9={class:"fr-grid-row"},y9={class:"fr-col"},v9={key:0,class:"fr-col-auto"},b9=["href"],w9={key:0,class:"fr-my-3v"},_9={key:0},k9={key:1,class:"flex flex-direction-column gap-10px"},x9={key:0,class:"fr-my-0 fr-text--sm border-bottom",role:"status"},C9={key:1},qv=!1,S9=B({__name:"resources",props:{canEdit:{type:Boolean,default:!1},canEditResources:{default:()=>({})},datasetId:{},showTotal:{type:Boolean,default:!0},type:{},typeLabel:{},firstGroup:{type:Boolean,default:!0}},setup(n){var O;const e=n,{t}=Te(),{toast:r}=Mn(),s=$(1),{hash:i}=i_(),o=A(()=>s_(i.value,e.type==="community")),a=$([]),l=Vs.resources_default_page_size,c=new URL((O=Vs.admin_root)!=null&&O.startsWith("http")?Vs.admin_root:"".concat(document.location.origin).concat(Vs.admin_root,"community-resource/new/")),u=new URLSearchParams({dataset_id:e.datasetId});c.search=u.toString();const d=c.toString(),h=$(0),f=$(0),p=$(!0),m=$(null),g=$(""),b=$(e.type==="community"),_=A(()=>!b.value&&h.value>Vs.resources_min_count_to_show_search),M=A(()=>h.value!=f.value),k=(E=1,R=!1)=>{p.value=!0,R&&m.value&&m.value.scrollIntoView({behavior:"smooth"});let W;return b.value?W=bR(e.datasetId,E,l):W=vR(e.datasetId,e.type,E,l,g.value),W.then(K=>(K.data&&(a.value=K.data,f.value=K.total),K.total||0)).catch(()=>(r.error(t("An error occurred while fetching resources")),a.value=[],0)).finally(()=>{p.value=!1})},C=(E,R=!0)=>(s.value=E,k(E,R)),x=E=>e.canEdit?e.canEdit:e.canEditResources[E.id];b.value||Xp.on(Cf,({type:E,value:R})=>{E===e.type&&(g.value=R,C(1,qv))});const D=()=>{C(1,qv).then(E=>h.value=E)};return Ve(()=>D()),(E,R)=>o.value?I("",!0):(w(),S("section",{key:0,class:"fr-mb-3v",ref_key:"top",ref:m},[v("div",g9,[v("div",y9,[v("h2",{class:ue([{"fr-mt-4w":!E.firstGroup},"fr-mb-0 subtitle subtitle--uppercase"])},T(E.typeLabel),3)]),b.value?(w(),S("div",v9,[v("a",{class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 fr-icon-add-line fr-btn--icon-left",href:y(d)},T(y(t)("Add a community resource")),9,b9)])):I("",!0)]),_.value?(w(),S("div",w9,[P(m9,{eventName:y(Cf),type:E.type},null,8,["eventName","type"])])):I("",!0),P(tl,{mode:"out-in"},{default:q(()=>[p.value?(w(),S("div",_9,[(w(!0),S(J,null,Fe(y(l),W=>(w(),Y(y(Hb),{class:"fr-mt-2w"}))),256))])):(w(),S("div",k9,[M.value?(w(),S("p",x9,T(y(t)("{count} results",f.value)),1)):I("",!0),(w(!0),S(J,null,Fe(a.value,W=>(w(),Y(y(Vb),{id:"resource-"+W.id,datasetId:E.datasetId,isCommunityResource:b.value,resource:W,canEdit:x(W)},null,8,["id","datasetId","isCommunityResource","resource","canEdit"]))),256)),f.value?f.value>y(l)?(w(),Y(y(Ci),{key:2,class:"fr-mt-3w",page:s.value,"page-size":y(l),"total-results":f.value,onChange:C},null,8,["page","page-size","total-results"])):I("",!0):(w(),S("p",C9,T(y(t)("No files match your search.")),1))]))]),_:1})],512))}});const M9=$e(S9,[["__scopeId","data-v-4aa480fc"]]),T9={key:0},O9=20,D9=B({__name:"CardList",props:{datasets:{},loading:{type:Boolean,default:!1},totalResults:{},pageSize:{default:O9}},emits:["changePage"],setup(n,{emit:e}){const t=e,r=$(1),s=$();function i(){s.value&&s.value.scrollIntoView({behavior:"smooth"})}function o(a){r.value=a,t("changePage",a),i()}return(a,l)=>a.loading?(w(),S("div",T9,[P(jp)])):a.totalResults?(w(),S(J,{key:1},[v("ul",{ref_key:"listRef",ref:s},[(w(!0),S(J,null,Fe(a.datasets,c=>(w(),S("li",{key:c.id},[P(Bw,{dataset:c},null,8,["dataset"])]))),128))],512),a.totalResults>a.pageSize?(w(),Y(y(Ci),{key:0,page:r.value,pageSize:a.pageSize,totalResults:a.totalResults,onChange:o,class:"fr-mt-2w"},null,8,["page","pageSize","totalResults"])):I("",!0)],64)):I("",!0)}}),$9={key:0,class:"subtitle subtitle--uppercase fr-mb-5v"},E9=B({__name:"UserDatasetList",props:{owner:{}},setup(n){const{t:e}=Te(),{toast:t}=Mn(),r=n,s=$([]),i=$(0),o=$(!1),a=$(null),l=3;function c(u){o.value=!0,a.value&&a.value.cancel(),a.value=Wu(),rl.get("/datasets/search/",{cancelToken:a.value.token,params:{page:u,owner:r.owner,page_size:l}}).then(d=>d.data).then(d=>{s.value=d.data,i.value=d.total,o.value=!1}).catch(d=>{Qn.isCancel(d)||(t.error(e("Error getting search results.")),o.value=!1)})}return Ve(()=>{c(1)}),(u,d)=>(w(),S(J,null,[i.value?(w(),S("h2",$9,T(y(e)("{n} datasets",i.value)),1)):I("",!0),P(D9,{"page-size":l,datasets:s.value,loading:o.value,"total-results":i.value,onChangePage:c},null,8,["datasets","loading","total-results"])],64))}}),A9={components:{ContentLoader:il}};function P9(n,e,t,r,s,i){const o=dt("ContentLoader");return w(),Y(o,{width:350,height:180,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},{default:q(()=>e[0]||(e[0]=[v("rect",{x:"43",y:"153",rx:"3",ry:"3",width:"97",height:"6"},null,-1),v("rect",{x:"44",y:"166",rx:"3",ry:"3",width:"97",height:"5"},null,-1),v("rect",{x:"184",y:"7",rx:"5",ry:"5",width:"130",height:"130"},null,-1),v("rect",{x:"198",y:"153",rx:"3",ry:"3",width:"97",height:"6"},null,-1),v("rect",{x:"199",y:"166",rx:"3",ry:"3",width:"97",height:"5"},null,-1),v("rect",{x:"27",y:"8",rx:"5",ry:"5",width:"130",height:"130"},null,-1)])),_:1})}const R9=$e(A9,[["render",P9]]),N9={key:0},I9=20,L9=B({__name:"ReuseList",props:{reuses:{},loading:{type:Boolean,default:!1},totalResults:{},pageSize:{default:I9}},emits:["changePage"],setup(n,{emit:e}){const t=e,r=$(1),s=$();function i(){s.value&&s.value.scrollIntoView({behavior:"smooth"})}function o(a){r.value=a,t("changePage",a),i()}return(a,l)=>a.loading?(w(),S("div",N9,[P(R9)])):a.totalResults?(w(),S(J,{key:1},[v("ul",{ref_key:"listRef",ref:s,class:"fr-grid-row fr-grid-row--gutters"},[(w(!0),S(J,null,Fe(a.reuses,c=>(w(),S("li",{class:ue(["fr-col-12",{"fr-col-md-6":a.reuses.length<=2,"fr-col-md-4":a.reuses.length>=3}]),key:c.id},[P(o_,{reuse:c},null,8,["reuse"])],2))),128))],512),a.totalResults>a.pageSize?(w(),Y(y(Ci),{key:0,page:r.value,pageSize:a.pageSize,totalResults:a.totalResults,onChange:o,class:"fr-mt-2w"},null,8,["page","pageSize","totalResults"])):I("",!0)],64)):I("",!0)}}),z9={key:0,class:"subtitle subtitle--uppercase fr-mb-5v"},B9=B({__name:"UserReuseList",props:{owner:{}},setup(n){const{t:e}=Te(),{toast:t}=Mn(),r=n,s=$([]),i=$(0),o=$(!1),a=$(null),l=6;function c(u){o.value=!0,a.value&&a.value.cancel(),a.value=Wu(),rl.get("/reuses/search/",{cancelToken:a.value.token,params:{page:u,owner:r.owner,page_size:l}}).then(d=>d.data).then(d=>{s.value=d.data,i.value=d.total,o.value=!1}).catch(d=>{Qn.isCancel(d)||(t.error(e("Error getting search results.")),o.value=!1)})}return Ve(()=>{c(1)}),(u,d)=>(w(),S(J,null,[i.value?(w(),S("h2",z9,T(y(e)("{n} reuses",i.value)),1)):I("",!0),P(L9,{"page-size":l,reuses:s.value,loading:o.value,"total-results":i.value,onChangePage:c},null,8,["reuses","loading","total-results"])],64))}}),F9={key:0,class:"border border-blue-400 fr-p-2w bg-alt-grey"},V9={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},H9={class:"fr-col-12 fr-col-sm"},W9={class:"fr-h6 fr-mb-0 text-blue-400"},j9={class:"fr-col-auto flex"},U9=["href"],q9=["href"],Y9=["href"],K9={key:1,class:"border border-blue-400 fr-p-2w fr-dataservice__box fr-dataservice__swagger"},G9={class:"fr-h6 fr-mb-0 text-blue-400"},J9={class:"flex items-center fr-ml-4v"},X9={key:0},Q9=B({__name:"DataserviceLinks",props:{dataservice:{}},setup(n){const e=n,{t}=Te(),r=$(!1),s=$(!1),i=j0(()=>Fs(()=>import("./Swagger.6.2.3.js"),["js/Swagger.6.2.3.js","js/_commonjsHelpers.6.2.3.js","js/sentry.6.2.3.js"])),o=()=>{r.value=!r.value};function a(l){return l.endsWith(".json")||l.endsWith(".yaml")||l.endsWith(".yml")}return Ve(async()=>{e.dataservice.machine_documentation_url&&(s.value=a(e.dataservice.machine_documentation_url))}),(l,c)=>(w(),S("div",null,[!s.value&&l.dataservice.machine_documentation_url||l.dataservice.technical_documentation_url||l.dataservice.business_documentation_url?(w(),S("div",F9,[v("div",V9,[v("div",H9,[v("h2",W9,T(y(t)("API documentation")),1)]),v("div",j9,[l.dataservice.technical_documentation_url?(w(),S("a",{key:0,class:"fr-btn fr-ml-3v",href:l.dataservice.technical_documentation_url,target:"_blank",rel:"ugc nofollow noopener"},T(y(t)("Technical documentation")),9,U9)):I("",!0),!s.value&&l.dataservice.machine_documentation_url?(w(),S("a",{key:1,class:"fr-btn fr-ml-3v",href:l.dataservice.machine_documentation_url,target:"_blank",rel:"ugc nofollow noopener"},T(y(t)("Machine readable documentation")),9,q9)):I("",!0),l.dataservice.business_documentation_url?(w(),S("a",{key:2,class:ue(["fr-btn fr-ml-3v",s.value?"":"fr-btn--secondary"]),href:l.dataservice.business_documentation_url,target:"_blank",rel:"ugc nofollow noopener"},T(y(t)("Business documentation")),11,Y9)):I("",!0)])])])):I("",!0),c[0]||(c[0]=v("br",null,null,-1)),s.value?(w(),S("div",K9,[v("header",{class:"fr-p-2v flex items-center justify-between",onClick:o},[v("h2",G9,T(y(t)("Swagger")),1),v("div",J9,[v("div",{class:ue(["fr-icon--sm fr-ml-4v",{"fr-icon-arrow-up-s-line":r.value,"fr-icon-arrow-down-s-line":!r.value}])},null,2)])]),r.value&&l.dataservice.machine_documentation_url?(w(),S("div",X9,[P(y(i),{url:l.dataservice.machine_documentation_url},null,8,["url"])])):I("",!0)])):I("",!0)]))}});const Z9=$e(Q9,[["__scopeId","data-v-67dee39c"]]),eI=document.querySelectorAll("[data-tabs]");eI.forEach(n=>{const e=n.querySelectorAll("[role=tab]");e.forEach(t=>{t.addEventListener("click",r=>{var a,l,c;r.preventDefault();const s=r.target,i=Array.from(e).find(u=>u.getAttribute("aria-selected")==="true");if(i){i.setAttribute("aria-selected","false");const u=i.getAttribute("aria-controls")||"";(a=document.getElementById(u))==null||a.classList.remove("fr-unhidden")}const o=s.getAttribute("aria-controls")||"";s.setAttribute("aria-selected","true"),(l=document.getElementById(o))==null||l.classList.add("fr-unhidden"),(c=globalThis._paq)==null||c.push(["trackEvent","Move page to tab",window.location.pathname,t.textContent])})})});const tI=document.querySelectorAll("[data-accordion-button]");tI.forEach(n=>{n.addEventListener("click",e=>{e.preventDefault();const t=e.target;if(t instanceof HTMLElement){t.toggleAttribute("aria-expanded");const r=document.querySelector("#"+t.getAttribute("aria-controls"));r&&(r.classList.toggle("active"),cb(r,t.hasAttribute("aria-expanded")))}})});var a_={exports:{}};/*!
 * clipboard.js v2.0.11
 * https://clipboardjs.com/
 *
 * Licensed MIT © Zeno Rocha
 */(function(n,e){(function(r,s){n.exports=s()})(_r,function(){return function(){var t={686:function(i,o,a){a.d(o,{default:function(){return Xe}});var l=a(279),c=a.n(l),u=a(370),d=a.n(u),h=a(817),f=a.n(h);function p(V){try{return document.execCommand(V)}catch(z){return!1}}var m=function(z){var F=f()(z);return p("cut"),F},g=m;function b(V){var z=document.documentElement.getAttribute("dir")==="rtl",F=document.createElement("textarea");F.style.fontSize="12pt",F.style.border="0",F.style.padding="0",F.style.margin="0",F.style.position="absolute",F.style[z?"right":"left"]="-9999px";var re=window.pageYOffset||document.documentElement.scrollTop;return F.style.top="".concat(re,"px"),F.setAttribute("readonly",""),F.value=V,F}var _=function(z,F){var re=b(z);F.container.appendChild(re);var ce=f()(re);return p("copy"),re.remove(),ce},M=function(z){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body},re="";return typeof z=="string"?re=_(z,F):z instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(z==null?void 0:z.type)?re=_(z.value,F):(re=f()(z),p("copy")),re},k=M;function C(V){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?C=function(F){return typeof F}:C=function(F){return F&&typeof Symbol=="function"&&F.constructor===Symbol&&F!==Symbol.prototype?"symbol":typeof F},C(V)}var x=function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},F=z.action,re=F===void 0?"copy":F,ce=z.container,H=z.target,N=z.text;if(re!=="copy"&&re!=="cut")throw new Error('Invalid "action" value, use either "copy" or "cut"');if(H!==void 0)if(H&&C(H)==="object"&&H.nodeType===1){if(re==="copy"&&H.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if(re==="cut"&&(H.hasAttribute("readonly")||H.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes')}else throw new Error('Invalid "target" value, use a valid Element');if(N)return k(N,{container:ce});if(H)return re==="cut"?g(H):k(H,{container:ce})},D=x;function O(V){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?O=function(F){return typeof F}:O=function(F){return F&&typeof Symbol=="function"&&F.constructor===Symbol&&F!==Symbol.prototype?"symbol":typeof F},O(V)}function E(V,z){if(!(V instanceof z))throw new TypeError("Cannot call a class as a function")}function R(V,z){for(var F=0;F<z.length;F++){var re=z[F];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(V,re.key,re)}}function W(V,z,F){return z&&R(V.prototype,z),F&&R(V,F),V}function K(V,z){if(typeof z!="function"&&z!==null)throw new TypeError("Super expression must either be null or a function");V.prototype=Object.create(z&&z.prototype,{constructor:{value:V,writable:!0,configurable:!0}}),z&&_e(V,z)}function _e(V,z){return _e=Object.setPrototypeOf||function(re,ce){return re.__proto__=ce,re},_e(V,z)}function He(V){var z=me();return function(){var re=De(V),ce;if(z){var H=De(this).constructor;ce=Reflect.construct(re,arguments,H)}else ce=re.apply(this,arguments);return te(this,ce)}}function te(V,z){return z&&(O(z)==="object"||typeof z=="function")?z:de(V)}function de(V){if(V===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return V}function me(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(V){return!1}}function De(V){return De=Object.setPrototypeOf?Object.getPrototypeOf:function(F){return F.__proto__||Object.getPrototypeOf(F)},De(V)}function ye(V,z){var F="data-clipboard-".concat(V);if(z.hasAttribute(F))return z.getAttribute(F)}var fe=function(V){K(F,V);var z=He(F);function F(re,ce){var H;return E(this,F),H=z.call(this),H.resolveOptions(ce),H.listenClick(re),H}return W(F,[{key:"resolveOptions",value:function(){var ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.action=typeof ce.action=="function"?ce.action:this.defaultAction,this.target=typeof ce.target=="function"?ce.target:this.defaultTarget,this.text=typeof ce.text=="function"?ce.text:this.defaultText,this.container=O(ce.container)==="object"?ce.container:document.body}},{key:"listenClick",value:function(ce){var H=this;this.listener=d()(ce,"click",function(N){return H.onClick(N)})}},{key:"onClick",value:function(ce){var H=ce.delegateTarget||ce.currentTarget,N=this.action(H)||"copy",Z=D({action:N,container:this.container,target:this.target(H),text:this.text(H)});this.emit(Z?"success":"error",{action:N,text:Z,trigger:H,clearSelection:function(){H&&H.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(ce){return ye("action",ce)}},{key:"defaultTarget",value:function(ce){var H=ye("target",ce);if(H)return document.querySelector(H)}},{key:"defaultText",value:function(ce){return ye("text",ce)}},{key:"destroy",value:function(){this.listener.destroy()}}],[{key:"copy",value:function(ce){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body};return k(ce,H)}},{key:"cut",value:function(ce){return g(ce)}},{key:"isSupported",value:function(){var ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["copy","cut"],H=typeof ce=="string"?[ce]:ce,N=!!document.queryCommandSupported;return H.forEach(function(Z){N=N&&!!document.queryCommandSupported(Z)}),N}}]),F}(c()),Xe=fe},828:function(i){var o=9;if(typeof Element<"u"&&!Element.prototype.matches){var a=Element.prototype;a.matches=a.matchesSelector||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector||a.webkitMatchesSelector}function l(c,u){for(;c&&c.nodeType!==o;){if(typeof c.matches=="function"&&c.matches(u))return c;c=c.parentNode}}i.exports=l},438:function(i,o,a){var l=a(828);function c(h,f,p,m,g){var b=d.apply(this,arguments);return h.addEventListener(p,b,g),{destroy:function(){h.removeEventListener(p,b,g)}}}function u(h,f,p,m,g){return typeof h.addEventListener=="function"?c.apply(null,arguments):typeof p=="function"?c.bind(null,document).apply(null,arguments):(typeof h=="string"&&(h=document.querySelectorAll(h)),Array.prototype.map.call(h,function(b){return c(b,f,p,m,g)}))}function d(h,f,p,m){return function(g){g.delegateTarget=l(g.target,f),g.delegateTarget&&m.call(h,g)}}i.exports=u},879:function(i,o){o.node=function(a){return a!==void 0&&a instanceof HTMLElement&&a.nodeType===1},o.nodeList=function(a){var l=Object.prototype.toString.call(a);return a!==void 0&&(l==="[object NodeList]"||l==="[object HTMLCollection]")&&"length"in a&&(a.length===0||o.node(a[0]))},o.string=function(a){return typeof a=="string"||a instanceof String},o.fn=function(a){var l=Object.prototype.toString.call(a);return l==="[object Function]"}},370:function(i,o,a){var l=a(879),c=a(438);function u(p,m,g){if(!p&&!m&&!g)throw new Error("Missing required arguments");if(!l.string(m))throw new TypeError("Second argument must be a String");if(!l.fn(g))throw new TypeError("Third argument must be a Function");if(l.node(p))return d(p,m,g);if(l.nodeList(p))return h(p,m,g);if(l.string(p))return f(p,m,g);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function d(p,m,g){return p.addEventListener(m,g),{destroy:function(){p.removeEventListener(m,g)}}}function h(p,m,g){return Array.prototype.forEach.call(p,function(b){b.addEventListener(m,g)}),{destroy:function(){Array.prototype.forEach.call(p,function(b){b.removeEventListener(m,g)})}}}function f(p,m,g){return c(document.body,p,m,g)}i.exports=u},817:function(i){function o(a){var l;if(a.nodeName==="SELECT")a.focus(),l=a.value;else if(a.nodeName==="INPUT"||a.nodeName==="TEXTAREA"){var c=a.hasAttribute("readonly");c||a.setAttribute("readonly",""),a.select(),a.setSelectionRange(0,a.value.length),c||a.removeAttribute("readonly"),l=a.value}else{a.hasAttribute("contenteditable")&&a.focus();var u=window.getSelection(),d=document.createRange();d.selectNodeContents(a),u.removeAllRanges(),u.addRange(d),l=u.toString()}return l}i.exports=o},279:function(i){function o(){}o.prototype={on:function(a,l,c){var u=this.e||(this.e={});return(u[a]||(u[a]=[])).push({fn:l,ctx:c}),this},once:function(a,l,c){var u=this;function d(){u.off(a,d),l.apply(c,arguments)}return d._=l,this.on(a,d,c)},emit:function(a){var l=[].slice.call(arguments,1),c=((this.e||(this.e={}))[a]||[]).slice(),u=0,d=c.length;for(u;u<d;u++)c[u].fn.apply(c[u].ctx,l);return this},off:function(a,l){var c=this.e||(this.e={}),u=c[a],d=[];if(u&&l)for(var h=0,f=u.length;h<f;h++)u[h].fn!==l&&u[h].fn._!==l&&d.push(u[h]);return d.length?c[a]=d:delete c[a],this}},i.exports=o,i.exports.TinyEmitter=o}},r={};function s(i){if(r[i])return r[i].exports;var o=r[i]={exports:{}};return t[i](o,o.exports,s),o.exports}return function(){s.n=function(i){var o=i&&i.__esModule?function(){return i.default}:function(){return i};return s.d(o,{a:o}),o}}(),function(){s.d=function(i,o){for(var a in o)s.o(o,a)&&!s.o(i,a)&&Object.defineProperty(i,a,{enumerable:!0,get:o[a]})}}(),function(){s.o=function(i,o){return Object.prototype.hasOwnProperty.call(i,o)}}(),s(686)}().default})})(a_);var nI=a_.exports;const rI=yp(nI);new rI('[id$="-copy"]');function sI(n){n&&n.classList.remove("fr-hidden")}function iI(n){n&&n.classList.add("fr-hidden"),window.localStorage.setItem(n.id,"true")}function oI(n,e=3,t="/"){const r=window.location.pathname,s=n.id;if(window.localStorage.getItem(s)||!1||r.indexOf(t)===-1)return;const o="pv-"+s;let a=parseInt(window.sessionStorage.getItem(o)||"0",10);a>=e&&sI(n),a++,window.sessionStorage.setItem(o,a.toFixed(0))}const aI=document.querySelectorAll("[data-dialogs]");aI.forEach(n=>{oI(n),n.querySelectorAll("[data-dialogs-close]").forEach(t=>{t instanceof HTMLElement&&t.addEventListener("click",()=>iI(n))})});const lI=document.querySelectorAll("[data-select-sort]");lI.forEach(n=>{n.querySelectorAll("option").forEach(t=>{t.disabled=!1}),n.form&&(n.addEventListener("change",t=>{var r;(r=n.form)==null||r.dispatchEvent(new Event("submit"))}),n.form.addEventListener("submit",t=>{var r,s;t.preventDefault(),n.value||(n.disabled=!0),(r=n.form)==null||r.submit(),(s=globalThis._paq)==null||s.push(["trackEvent","Search","Sort",n.value])}))});function l_(n){return"#/".concat(n.dataset.updateUrl||n.getAttribute("aria-controls"))}function Yv(n){n.forEach(e=>{const t=l_(e),r="#".concat(e.dataset.previousUrl);if(r&&window.location.hash.startsWith(r)){const s=window.location.hash.slice(r.length);window.location.hash="".concat(t,"/").concat(s)}if(window.location.hash.includes(t)){const s=e.getAttribute("aria-controls");s||console.error("TabButton without `aria-controls` ID.",e);const i=document.getElementById(s);i||console.error("Unknown TabPanel with id '".concat(s,"'."),e),dsfr(i).tabPanel.disclose()}})}function cI(){const n=document.querySelectorAll("[data-update-url]");window.addEventListener("hashchange",()=>{Yv(n)}),n.forEach(e=>{const t=l_(e);e.addEventListener("click",()=>{var r;if(!window.location.hash.includes(t)){let s=new URL(window.location.href);s.hash=t,window.history.pushState(null,"",s),(r=globalThis._paq)==null||r.push(["trackEvent","Move page to hash",window.location.pathname,t])}})}),setTimeout(()=>{Yv(n)},100)}async function uI(){return(await mt.get(gp("reports/reasons/"))).data}async function dI(n,e,t,r){return(await mt.post("/reports/",{subject:{id:e,class:n},reason:t,message:r})).data}function Kv(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function Ur(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Kv(Object(t),!0).forEach(function(r){hI(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Kv(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function hI(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Gv(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Object.keys(n).reduce((t,r)=>(e.includes(r)||(t[r]=y(n[r])),t),{})}function gu(n){return typeof n=="function"}function fI(n){return H2(n)||W2(n)}function c_(n,e,t){let r=n;const s=e.split(".");for(let i=0;i<s.length;i++){if(!r[s[i]])return t;r=r[s[i]]}return r}function sh(n,e,t){return A(()=>n.some(r=>c_(e,r,{[t]:!1})[t]))}function Jv(n,e,t){return A(()=>n.reduce((r,s)=>{const i=c_(e,s,{[t]:!1})[t]||[];return r.concat(i)},[]))}function u_(n,e,t,r){return n.call(r,y(e),y(t),r)}function d_(n){return n.$valid!==void 0?!n.$valid:!n}function pI(n,e,t,r,s,i,o){let{$lazy:a,$rewardEarly:l}=s,c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:[],u=arguments.length>8?arguments[8]:void 0,d=arguments.length>9?arguments[9]:void 0,h=arguments.length>10?arguments[10]:void 0;const f=$(!!r.value),p=$(0);t.value=!1;const m=et([e,r].concat(c,h),()=>{if(a&&!r.value||l&&!d.value&&!t.value)return;let g;try{g=u_(n,e,u,o)}catch(b){g=Promise.reject(b)}p.value++,t.value=!!p.value,f.value=!1,Promise.resolve(g).then(b=>{p.value--,t.value=!!p.value,i.value=b,f.value=d_(b)}).catch(b=>{p.value--,t.value=!!p.value,i.value=b,f.value=!0})},{immediate:!0,deep:typeof e=="object"});return{$invalid:f,$unwatch:m}}function mI(n,e,t,r,s,i,o,a){let{$lazy:l,$rewardEarly:c}=r;const u=()=>({}),d=A(()=>{if(l&&!t.value||c&&!a.value)return!1;let h=!0;try{const f=u_(n,e,o,i);s.value=f,h=d_(f)}catch(f){s.value=f}return h});return{$unwatch:u,$invalid:d}}function gI(n,e,t,r,s,i,o,a,l,c,u){const d=$(!1),h=n.$params||{},f=$(null);let p,m;n.$async?{$invalid:p,$unwatch:m}=pI(n.$validator,e,d,t,r,f,s,n.$watchTargets,l,c,u):{$invalid:p,$unwatch:m}=mI(n.$validator,e,t,r,f,s,l,c);const g=n.$message;return{$message:gu(g)?A(()=>g(Gv({$pending:d,$invalid:p,$params:Gv(h),$model:e,$response:f,$validator:i,$propertyPath:a,$property:o}))):g||"",$params:h,$pending:d,$invalid:p,$response:f,$unwatch:m}}function yI(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=y(n),t=Object.keys(e),r={},s={},i={};let o=null;return t.forEach(a=>{const l=e[a];switch(!0){case gu(l.$validator):r[a]=l;break;case gu(l):r[a]={$validator:l};break;case a==="$validationGroups":o=l;break;case a.startsWith("$"):i[a]=l;break;default:s[a]=l}}),{rules:r,nestedValidators:s,config:i,validationGroups:o}}const vI="__root";function bI(n,e,t,r,s,i,o,a,l){const c=Object.keys(n),u=r.get(s,n),d=$(!1),h=$(!1),f=$(0);if(u){if(!u.$partial)return u;u.$unwatch(),d.value=u.$dirty.value}const p={$dirty:d,$path:s,$touch:()=>{d.value||(d.value=!0)},$reset:()=>{d.value&&(d.value=!1)},$commit:()=>{}};return c.length?(c.forEach(m=>{p[m]=gI(n[m],e,p.$dirty,i,o,m,t,s,l,h,f)}),p.$externalResults=A(()=>a.value?[].concat(a.value).map((m,g)=>({$propertyPath:s,$property:t,$validator:"$externalResults",$uid:"".concat(s,"-externalResult-").concat(g),$message:m,$params:{},$response:null,$pending:!1})):[]),p.$invalid=A(()=>{const m=c.some(g=>y(p[g].$invalid));return h.value=m,!!p.$externalResults.value.length||m}),p.$pending=A(()=>c.some(m=>y(p[m].$pending))),p.$error=A(()=>p.$dirty.value?p.$pending.value||p.$invalid.value:!1),p.$silentErrors=A(()=>c.filter(m=>y(p[m].$invalid)).map(m=>{const g=p[m];return ki({$propertyPath:s,$property:t,$validator:m,$uid:"".concat(s,"-").concat(m),$message:g.$message,$params:g.$params,$response:g.$response,$pending:g.$pending})}).concat(p.$externalResults.value)),p.$errors=A(()=>p.$dirty.value?p.$silentErrors.value:[]),p.$unwatch=()=>c.forEach(m=>{p[m].$unwatch()}),p.$commit=()=>{h.value=!0,f.value=Date.now()},r.set(s,n,p),p):(u&&r.set(s,n,p),p)}function wI(n,e,t,r,s,i,o){const a=Object.keys(n);return a.length?a.reduce((l,c)=>(l[c]=Sf({validations:n[c],state:e,key:c,parentKey:t,resultsCache:r,globalConfig:s,instance:i,externalResults:o}),l),{}):{}}function _I(n,e,t){const r=A(()=>[e,t].filter(p=>p).reduce((p,m)=>p.concat(Object.values(y(m))),[])),s=A({get(){return n.$dirty.value||(r.value.length?r.value.every(p=>p.$dirty):!1)},set(p){n.$dirty.value=p}}),i=A(()=>{const p=y(n.$silentErrors)||[],m=r.value.filter(g=>(y(g).$silentErrors||[]).length).reduce((g,b)=>g.concat(...b.$silentErrors),[]);return p.concat(m)}),o=A(()=>{const p=y(n.$errors)||[],m=r.value.filter(g=>(y(g).$errors||[]).length).reduce((g,b)=>g.concat(...b.$errors),[]);return p.concat(m)}),a=A(()=>r.value.some(p=>p.$invalid)||y(n.$invalid)||!1),l=A(()=>r.value.some(p=>y(p.$pending))||y(n.$pending)||!1),c=A(()=>r.value.some(p=>p.$dirty)||r.value.some(p=>p.$anyDirty)||s.value),u=A(()=>s.value?l.value||a.value:!1),d=()=>{n.$touch(),r.value.forEach(p=>{p.$touch()})},h=()=>{n.$commit(),r.value.forEach(p=>{p.$commit()})},f=()=>{n.$reset(),r.value.forEach(p=>{p.$reset()})};return r.value.length&&r.value.every(p=>p.$dirty)&&d(),{$dirty:s,$errors:o,$invalid:a,$anyDirty:c,$error:u,$pending:l,$touch:d,$reset:f,$silentErrors:i,$commit:h}}function Sf(n){let{validations:e,state:t,key:r,parentKey:s,childResults:i,resultsCache:o,globalConfig:a={},instance:l,externalResults:c}=n;const u=s?"".concat(s,".").concat(r):r,{rules:d,nestedValidators:h,config:f,validationGroups:p}=yI(e),m=Ur(Ur({},a),f),g=r?A(()=>{const fe=y(t);return fe?y(fe[r]):void 0}):t,b=Ur({},y(c)||{}),_=A(()=>{const fe=y(c);return r?fe?y(fe[r]):void 0:fe}),M=bI(d,g,r,o,u,m,l,_,t),k=wI(h,g,u,o,m,l,_),C={};p&&Object.entries(p).forEach(fe=>{let[Xe,V]=fe;C[Xe]={$invalid:sh(V,k,"$invalid"),$error:sh(V,k,"$error"),$pending:sh(V,k,"$pending"),$errors:Jv(V,k,"$errors"),$silentErrors:Jv(V,k,"$silentErrors")}});const{$dirty:x,$errors:D,$invalid:O,$anyDirty:E,$error:R,$pending:W,$touch:K,$reset:_e,$silentErrors:He,$commit:te}=_I(M,k,i),de=r?A({get:()=>y(g),set:fe=>{x.value=!0;const Xe=y(t),V=y(c);V&&(V[r]=b[r]),Jc(Xe[r])?Xe[r].value=fe:Xe[r]=fe}}):null;r&&m.$autoDirty&&et(g,()=>{x.value||K();const fe=y(c);fe&&(fe[r]=b[r])},{flush:"sync"});async function me(){return K(),m.$rewardEarly&&(te(),await Aa()),await Aa(),new Promise(fe=>{if(!W.value)return fe(!O.value);const Xe=et(W,()=>{fe(!O.value),Xe()})})}function De(fe){return(i.value||{})[fe]}function ye(){Jc(c)?c.value=b:Object.keys(b).length===0?Object.keys(c).forEach(fe=>{delete c[fe]}):Object.assign(c,b)}return ki(Ur(Ur(Ur({},M),{},{$model:de,$dirty:x,$error:R,$errors:D,$invalid:O,$anyDirty:E,$pending:W,$touch:K,$reset:_e,$path:u||vI,$silentErrors:He,$validate:me,$commit:te},i&&{$getResultsForChild:De,$clearExternalResults:ye,$validationGroups:C}),k))}class kI{constructor(){this.storage=new Map}set(e,t,r){this.storage.set(e,{rules:t,result:r})}checkRulesValidity(e,t,r){const s=Object.keys(r),i=Object.keys(t);return i.length!==s.length||!i.every(a=>s.includes(a))?!1:i.every(a=>t[a].$params?Object.keys(t[a].$params).every(l=>y(r[a].$params[l])===y(t[a].$params[l])):!0)}get(e,t){const r=this.storage.get(e);if(!r)return;const{rules:s,result:i}=r,o=this.checkRulesValidity(e,t,s),a=i.$unwatch?i.$unwatch:()=>({});return o?i:{$dirty:i.$dirty,$partial:!0,$unwatch:a}}}const dc={COLLECT_ALL:!0,COLLECT_NONE:!1},Xv=Symbol("vuelidate#injectChildResults"),Qv=Symbol("vuelidate#removeChildResults");function xI(n){let{$scope:e,instance:t}=n;const r={},s=$([]),i=A(()=>s.value.reduce((u,d)=>(u[d]=y(r[d]),u),{}));function o(u,d){let{$registerAs:h,$scope:f,$stopPropagation:p}=d;p||e===dc.COLLECT_NONE||f===dc.COLLECT_NONE||e!==dc.COLLECT_ALL&&e!==f||(r[h]=u,s.value.push(h))}t.__vuelidateInjectInstances=[].concat(t.__vuelidateInjectInstances||[],o);function a(u){s.value=s.value.filter(d=>d!==u),delete r[u]}t.__vuelidateRemoveInstances=[].concat(t.__vuelidateRemoveInstances||[],a);const l=ct(Xv,[]);xt(Xv,t.__vuelidateInjectInstances);const c=ct(Qv,[]);return xt(Qv,t.__vuelidateRemoveInstances),{childResults:i,sendValidationResultsToParent:l,removeValidationResultsFromParent:c}}function h_(n){return new Proxy(n,{get(e,t){return typeof e[t]=="object"?h_(e[t]):A(()=>e[t])}})}let Zv=0;function e1(n,e){var t;let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};arguments.length===1&&(r=n,n=void 0,e=void 0);let{$registerAs:s,$scope:i=dc.COLLECT_ALL,$stopPropagation:o,$externalResults:a,currentVueInstance:l}=r;const c=l||((t=yo())===null||t===void 0?void 0:t.proxy),u=c?c.$options:{};s||(Zv+=1,s="_vuelidate_".concat(Zv));const d=$({}),h=new kI,{childResults:f,sendValidationResultsToParent:p,removeValidationResultsFromParent:m}=c?xI({$scope:i,instance:c}):{childResults:$({})};if(!n&&u.validations){const g=u.validations;e=$({}),hp(()=>{e.value=c,et(()=>gu(g)?g.call(e.value,new h_(e.value)):g,b=>{d.value=Sf({validations:b,state:e,childResults:f,resultsCache:h,globalConfig:r,instance:c,externalResults:a||c.vuelidateExternalResults})},{immediate:!0})}),r=u.validationsConfig||r}else{const g=Jc(n)||fI(n)?n:ki(n||{});et(g,b=>{d.value=Sf({validations:b,state:e,childResults:f,resultsCache:h,globalConfig:r,instance:c!=null?c:{},externalResults:a})},{immediate:!0})}return c&&(p.forEach(g=>g(d,{$registerAs:s,$scope:i,$stopPropagation:o})),U0(()=>m.forEach(g=>g(s)))),A(()=>Ur(Ur({},y(d.value)),f.value))}function f_(n,e,t,r=!1){const s=e1(e,n,{$scope:r}),i=e1(t,n,{$scope:"warning"});return{getErrorText:u=>(i.value[u].$dirty&&s.value[u].$touch(),s.value[u].$errors.map(d=>d.$message).join("\n")),getFunctionalState:CI,getWarningText:u=>i.value[u].$errors.map(d=>d.$message).join("\n"),hasError:SI,hasWarning:Mf,reset:()=>{i.value.$reset(),s.value.$reset()},validateRequiredRules:()=>(i.value.$validate(),s.value.$validate(),s.value.$validate()),v$:s,vWarning$:i}}const CI=(n,e,t)=>n?e?"error":t?"warning":"success":"disabled",SI=(n,e)=>at(n)[e]==="error",Mf=(n,e)=>at(n)[e]==="warning",MI=["for"],TI={key:0,class:"fr-hint-text"},OI=["aria-describedby","id","required","disabled"],DI=["selected"],$I=["value","selected","disabled","hidden"],EI=["id"],AI=["id"],PI=B({__name:"SelectGroup",props:{disabled:{type:Boolean,default:!1},errorText:{default:""},hasError:{type:Boolean,default:!1},hintText:{default:""},isValid:{type:Boolean,default:!1},label:{},modelValue:{default:void 0},options:{},required:{type:Boolean,default:!1},validText:{default:""}},emits:["update:modelValue"],setup(n,{emit:e}){const t=e,r=n,{id:s}=bo("select"),i=A(()=>s+"-desc-error"),o=A(()=>s+"-desc-valid"),a=A(()=>{let u="";return r.isValid?u+=" "+o:r.hasError&&(u+=" "+i),u}),l=A(()=>({"fr-select-group--disabled":r.disabled,"fr-select-group--error":r.hasError,"fr-select-group--valid":r.isValid})),c=u=>{var h;const d=u.target;t("update:modelValue",(h=d==null?void 0:d.value)!=null?h:"")};return(u,d)=>(w(),S("div",{class:ue(["fr-select-group",l.value])},[v("label",{class:"fr-label",for:y(s)},[U(T(u.label)+" ",1),P(Up,{required:u.required},null,8,["required"]),u.hintText?(w(),S("span",TI,T(u.hintText),1)):I("",!0)],8,MI),v("select",{class:ue(["fr-select",{"fr-select--error":u.hasError,"fr-select--valid":u.isValid}]),"aria-describedby":a.value,id:y(s),required:u.required,disabled:u.disabled,onChange:c},[v("option",{value:"",selected:!u.modelValue,disabled:"",hidden:""},T(u.$t("Select an option")),9,DI),(w(!0),S(J,null,Fe(u.options,h=>(w(),S("option",{value:h.value,selected:h.selected,disabled:h.disabled,hidden:h.hidden},T(h.label),9,$I))),256))],42,OI),u.isValid?(w(),S("p",{key:0,id:o.value,class:"fr-valid-text"},T(u.validText),9,EI)):u.hasError?(w(),S("p",{key:1,id:i.value,class:"fr-error-text"},T(u.errorText),9,AI)):I("",!0)],2))}});(function(){try{if(typeof document<"u"){var n=document.createElement("style");n.appendChild(document.createTextNode(".v3dp__popout[data-v-65eb861b]{z-index:10;position:absolute;text-align:center;width:17.5em;background-color:var(--popout-bg-color);box-shadow:var(--box-shadow);border-radius:var(--border-radius);padding:8px 0 1em;color:var(--text-color)}.v3dp__popout *[data-v-65eb861b]{color:inherit;font-size:inherit;font-weight:inherit}.v3dp__popout[data-v-65eb861b] button{background:none;border:none;outline:none}.v3dp__popout[data-v-65eb861b] button:not(:disabled){cursor:pointer}.v3dp__heading[data-v-65eb861b]{width:100%;display:flex;height:var(--heading-size);line-height:var(--heading-size);font-weight:var(--heading-weight)}.v3dp__heading__button[data-v-65eb861b]{background:none;border:none;padding:0;display:flex;justify-content:center;align-items:center;width:var(--heading-size)}button.v3dp__heading__center[data-v-65eb861b]:hover,.v3dp__heading__button[data-v-65eb861b]:not(:disabled):hover{background-color:var(--heading-hover-color)}.v3dp__heading__center[data-v-65eb861b]{flex:1}.v3dp__heading__icon[data-v-65eb861b]{height:12px;stroke:var(--arrow-color)}.v3dp__heading__button:disabled .v3dp__heading__icon[data-v-65eb861b]{stroke:var(--elem-disabled-color)}.v3dp__subheading[data-v-65eb861b],.v3dp__elements[data-v-65eb861b]{display:grid;grid-template-columns:var(--popout-column-definition);font-size:var(--elem-font-size)}.v3dp__subheading[data-v-65eb861b]{margin-top:1em}.v3dp__divider[data-v-65eb861b]{border:1px solid var(--divider-color);border-radius:3px}.v3dp__elements[data-v-65eb861b] button:disabled{color:var(--elem-disabled-color)}.v3dp__elements[data-v-65eb861b] button{padding:.3em .6em}.v3dp__elements[data-v-65eb861b] button span{display:block;line-height:1.9em;height:1.8em;border-radius:var(--elem-border-radius)}.v3dp__elements[data-v-65eb861b] button:not(:disabled):hover span{background-color:var(--elem-hover-bg-color);color:var(--elem-hover-color)}.v3dp__elements[data-v-65eb861b] button.selected span{background-color:var(--elem-selected-bg-color);color:var(--elem-selected-color)}.v3dp__elements[data-v-65eb861b] button.current span{font-weight:var(--elem-current-font-weight);outline:1px solid var(--elem-current-outline-color)}.v3dp__column[data-v-81ac698d]{display:flex;flex-direction:column;overflow-y:auto;height:190px}.v3dp__datepicker{--popout-bg-color: var(--vdp-bg-color, #fff);--box-shadow: var( --vdp-box-shadow, 0 4px 10px 0 rgba(128, 144, 160, .1), 0 0 1px 0 rgba(128, 144, 160, .81) );--text-color: var(--vdp-text-color, #000000);--border-radius: var(--vdp-border-radius, 3px);--heading-size: var(--vdp-heading-size, 2.5em);--heading-weight: var(--vdp-heading-weight, bold);--heading-hover-color: var(--vdp-heading-hover-color, #eeeeee);--arrow-color: var(--vdp-arrow-color, currentColor);--elem-color: var(--vdp-elem-color, currentColor);--elem-disabled-color: var(--vdp-disabled-color, #d5d9e0);--elem-hover-color: var(--vdp-hover-color, #fff);--elem-hover-bg-color: var(--vdp-hover-bg-color, #0baf74);--elem-selected-color: var(--vdp-selected-color, #fff);--elem-selected-bg-color: var(--vdp-selected-bg-color, #0baf74);--elem-current-outline-color: var(--vdp-current-date-outline-color, #888);--elem-current-font-weight: var(--vdp-current-date-font-weight, bold);--elem-font-size: var(--vdp-elem-font-size, .8em);--elem-border-radius: var(--vdp-elem-border-radius, 3px);--divider-color: var(--vdp-divider-color, var(--elem-disabled-color));position:relative}.v3dp__clearable{display:inline;position:relative;left:-15px;cursor:pointer}")),document.head.appendChild(n)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();const RI=["year","month","day","time","custom"],NI=B({emits:{elementClick:n=>hn(n),left:()=>!0,right:()=>!0,heading:()=>!0},props:{headingClickable:{type:Boolean,default:!1},leftDisabled:{type:Boolean,default:!1},rightDisabled:{type:Boolean,default:!1},columnCount:{type:Number,default:7},items:{type:Array,default:()=>[]},viewMode:{type:String,required:!0,validate:n=>typeof n=="string"&&RI.includes(n)}}}),wo=(n,e)=>{const t=n.__vccOpts||n;for(const[r,s]of e)t[r]=s;return t},Qp=n=>(j2("data-v-65eb861b"),n=n(),U2(),n),II={class:"v3dp__heading"},LI=["disabled"],zI=Qp(()=>v("svg",{class:"v3dp__heading__icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 6 8"},[v("g",{fill:"none","fill-rule":"evenodd"},[v("path",{stroke:"none",d:"M-9 16V-8h24v24z"}),v("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 0L1 4l4 4"})])],-1)),BI=["disabled"],FI=Qp(()=>v("svg",{class:"v3dp__heading__icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 6 8"},[v("g",{fill:"none","fill-rule":"evenodd"},[v("path",{stroke:"none",d:"M15-8v24H-9V-8z"}),v("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M1 8l4-4-4-4"})])],-1)),VI={class:"v3dp__body"},HI={class:"v3dp__subheading"},WI=Qp(()=>v("hr",{class:"v3dp__divider"},null,-1)),jI={class:"v3dp__elements"},UI=["disabled","onClick"];function qI(n,e,t,r,s,i){return w(),S("div",{class:ue(["v3dp__popout","v3dp__popout-".concat(n.viewMode)]),style:vo({"--popout-column-definition":"repeat(".concat(n.columnCount,", 1fr)")}),onMousedown:e[3]||(e[3]=Se(()=>{},["prevent"]))},[v("div",II,[v("button",{class:"v3dp__heading__button v3dp__heading__button__left",disabled:n.leftDisabled,onClick:e[0]||(e[0]=Se(o=>n.$emit("left"),["stop","prevent"]))},[Ye(n.$slots,"arrow-left",{},()=>[zI],!0)],8,LI),(w(),Y(Js(n.headingClickable?"button":"span"),{class:"v3dp__heading__center",onClick:e[1]||(e[1]=Se(o=>n.$emit("heading"),["stop","prevent"]))},{default:q(()=>[Ye(n.$slots,"heading",{},void 0,!0)]),_:3})),v("button",{class:"v3dp__heading__button v3dp__heading__button__right",disabled:n.rightDisabled,onClick:e[2]||(e[2]=Se(o=>n.$emit("right"),["stop","prevent"]))},[Ye(n.$slots,"arrow-right",{},()=>[FI],!0)],8,BI)]),v("div",VI,["subheading"in n.$slots?(w(),S(J,{key:0},[v("div",HI,[Ye(n.$slots,"subheading",{},void 0,!0)]),WI],64)):I("",!0),v("div",jI,[Ye(n.$slots,"body",{},()=>[(w(!0),S(J,null,Fe(n.items,o=>(w(),S("button",{key:o.key,disabled:o.disabled,class:ue([{selected:o.selected,current:o.current},"v3dp__element__button__".concat(n.viewMode)]),onClick:Se(a=>n.$emit("elementClick",o.value),["stop","prevent"])},[v("span",null,T(o.display),1)],10,UI))),128))],!0)])])],38)}const nd=wo(NI,[["render",qI],["__scopeId","data-v-65eb861b"]]),YI=B({components:{PickerPopup:nd},emits:{"update:pageDate":n=>hn(n),select:n=>hn(n)},props:{selected:{type:Date,required:!1},pageDate:{type:Date,required:!0},lowerLimit:{type:Date,required:!1},upperLimit:{type:Date,required:!1}},setup(n,{emit:e}){const t=A(()=>mR(n.pageDate)),r=A(()=>BP(n.pageDate)),s=(c,u,d)=>!u&&!d?!0:!(u&&Dn(c)<Dn(u)||d&&Dn(c)>Dn(d)),i=A(()=>zP({start:t.value,end:r.value}).map(c=>({value:c,key:String(Dn(c)),display:Dn(c),selected:!!n.selected&&Dn(c)===Dn(n.selected),disabled:!s(c,n.lowerLimit,n.upperLimit)}))),o=A(()=>{const c=Dn(t.value),u=Dn(r.value);return"".concat(c," - ").concat(u)}),a=A(()=>n.lowerLimit&&(jl(n.lowerLimit)===jl(n.pageDate)||Wa(n.pageDate,n.lowerLimit))),l=A(()=>n.upperLimit&&(jl(n.upperLimit)===jl(n.pageDate)||Ha(n.pageDate,n.upperLimit)));return{years:i,heading:o,leftDisabled:a,rightDisabled:l,previousPage:()=>e("update:pageDate",r_(n.pageDate,10)),nextPage:()=>e("update:pageDate",Yp(n.pageDate,10))}}});function KI(n,e,t,r,s,i){const o=dt("picker-popup");return w(),Y(o,{columnCount:3,leftDisabled:n.leftDisabled,rightDisabled:n.rightDisabled,items:n.years,viewMode:"year",onLeft:n.previousPage,onRight:n.nextPage,onElementClick:e[0]||(e[0]=a=>n.$emit("select",a))},{heading:q(()=>[U(T(n.heading),1)]),_:1},8,["leftDisabled","rightDisabled","items","onLeft","onRight"])}const GI=wo(YI,[["render",KI]]),JI=B({components:{PickerPopup:nd},emits:{"update:pageDate":n=>hn(n),select:n=>hn(n),back:()=>!0},props:{selected:{type:Date,required:!1},pageDate:{type:Date,required:!0},format:{type:String,required:!1,default:"LLL"},locale:{type:Object,required:!1},lowerLimit:{type:Date,required:!1},upperLimit:{type:Date,required:!1}},setup(n,{emit:e}){const t=A(()=>LP(n.pageDate)),r=A(()=>IP(n.pageDate)),s=A(()=>u=>ao(u,n.format,{locale:n.locale})),i=(u,d,h)=>!d&&!h?!0:!(d&&Wa(u,Hw(d))||h&&Ha(u,Vw(h))),o=A(()=>NP({start:t.value,end:r.value}).map(u=>({value:u,display:s.value(u),key:s.value(u),selected:!!n.selected&&xf(n.selected,u),disabled:!i(u,n.lowerLimit,n.upperLimit)}))),a=A(()=>Dn(t.value)),l=A(()=>n.lowerLimit&&(Wv(n.lowerLimit,n.pageDate)||Wa(n.pageDate,n.lowerLimit))),c=A(()=>n.upperLimit&&(Wv(n.upperLimit,n.pageDate)||Ha(n.pageDate,n.upperLimit)));return{months:o,heading:a,leftDisabled:l,rightDisabled:c,previousPage:()=>e("update:pageDate",r_(n.pageDate,1)),nextPage:()=>e("update:pageDate",Yp(n.pageDate,1))}}});function XI(n,e,t,r,s,i){const o=dt("picker-popup");return w(),Y(o,{headingClickable:"",columnCount:3,items:n.months,leftDisabled:n.leftDisabled,rightDisabled:n.rightDisabled,viewMode:"month",onLeft:n.previousPage,onRight:n.nextPage,onHeading:e[0]||(e[0]=a=>n.$emit("back")),onElementClick:e[1]||(e[1]=a=>n.$emit("select",a))},{heading:q(()=>[U(T(n.heading),1)]),_:1},8,["items","leftDisabled","rightDisabled","onLeft","onRight"])}const QI=wo(JI,[["render",XI]]),ZI=B({components:{PickerPopup:nd},emits:{"update:pageDate":n=>hn(n),select:n=>hn(n),back:()=>!0},props:{selected:{type:Date,required:!1},pageDate:{type:Date,required:!0},format:{type:String,required:!1,default:"dd"},headingFormat:{type:String,required:!1,default:"LLLL yyyy"},weekdayFormat:{type:String,required:!1,default:"EE"},locale:{type:Object,required:!1},weekStartsOn:{type:Number,required:!1,default:1,validator:n=>typeof n=="number"&&Number.isInteger(n)&&n>=0&&n<=6},lowerLimit:{type:Date,required:!1},upperLimit:{type:Date,required:!1},disabledDates:{type:Object,required:!1},allowOutsideInterval:{type:Boolean,required:!1,default:!1}},setup(n,{emit:e}){const t=A(()=>f=>p=>ao(p,f,{locale:n.locale,weekStartsOn:n.weekStartsOn})),r=A(()=>Hw(n.pageDate)),s=A(()=>Vw(n.pageDate)),i=A(()=>({start:r.value,end:s.value})),o=A(()=>({start:MP(r.value,{weekStartsOn:n.weekStartsOn}),end:FP(s.value,{weekStartsOn:n.weekStartsOn})})),a=A(()=>{const f=n.weekStartsOn,p=t.value(n.weekdayFormat);return Array.from(Array(7)).map((m,g)=>(f+g)%7).map(m=>pR(new Date,m,{weekStartsOn:n.weekStartsOn})).map(p)}),l=(f,p,m,g)=>{var b,_;return(b=g==null?void 0:g.dates)!=null&&b.some(M=>nh(f,M))||(_=g==null?void 0:g.predicate)!=null&&_.call(g,f)?!1:!p&&!m?!0:!(p&&Wa(f,wf(p))||m&&Ha(f,PP(m)))},c=A(()=>{const f=new Date,p=t.value(n.format);return RP(o.value).map(m=>({value:m,display:p(m),selected:!!n.selected&&nh(n.selected,m),current:nh(f,m),disabled:!n.allowOutsideInterval&&!hR(m,i.value)||!l(m,n.lowerLimit,n.upperLimit,n.disabledDates),key:t.value("yyyy-MM-dd")(m)}))}),u=A(()=>t.value(n.headingFormat)(n.pageDate)),d=A(()=>n.lowerLimit&&(xf(n.lowerLimit,n.pageDate)||Wa(n.pageDate,n.lowerLimit))),h=A(()=>n.upperLimit&&(xf(n.upperLimit,n.pageDate)||Ha(n.pageDate,n.upperLimit)));return{weekDays:a,days:c,heading:u,leftDisabled:d,rightDisabled:h,previousPage:()=>e("update:pageDate",gR(n.pageDate,1)),nextPage:()=>e("update:pageDate",qp(n.pageDate,1))}}});function eL(n,e,t,r,s,i){const o=dt("picker-popup");return w(),Y(o,{headingClickable:"",leftDisabled:n.leftDisabled,rightDisabled:n.rightDisabled,items:n.days,viewMode:"day",onLeft:n.previousPage,onRight:n.nextPage,onHeading:e[0]||(e[0]=a=>n.$emit("back")),onElementClick:e[1]||(e[1]=a=>n.$emit("select",a))},{heading:q(()=>[U(T(n.heading),1)]),subheading:q(()=>[(w(!0),S(J,null,Fe(n.weekDays,(a,l)=>(w(),S("span",{key:a,class:ue("v3dp__subheading__weekday__".concat(l))},T(a),3))),128))]),_:1},8,["leftDisabled","rightDisabled","items","onLeft","onRight"])}const tL=wo(ZI,[["render",eL]]);function t1(n,e){const t=n.getBoundingClientRect(),r={height:n.clientHeight,width:n.clientWidth},s=e.getBoundingClientRect();if(!(s.top>=t.top&&s.bottom<=t.top+r.height)){const i=s.top-t.top,o=s.bottom-t.bottom;Math.abs(i)<Math.abs(o)?n.scrollTop+=i:n.scrollTop+=o}}const nL=B({components:{PickerPopup:nd},emits:{select:n=>hn(n),back:()=>!0},props:{selected:{type:Date,required:!1},pageDate:{type:Date,required:!0},visible:{type:Boolean,required:!0},disabledTime:{type:Object,required:!1}},setup(n,{emit:e}){const t=$(null),r=$(null),s=A(()=>{var d;return(d=n.pageDate)!=null?d:n.selected}),i=$(s.value.getHours()),o=$(s.value.getMinutes());et(()=>n.selected,d=>{let h=0,f=0;d&&(h=d.getHours(),f=d.getMinutes()),i.value=h,o.value=f});const a=A(()=>[...Array(24).keys()].map(d=>({value:d,date:jv(new Date(s.value.getTime()),{hours:d,minutes:o.value,seconds:0}),selected:i.value===d,ref:$(null)}))),l=A(()=>[...Array(60).keys()].map(d=>({value:d,date:jv(new Date(s.value.getTime()),{hours:i.value,minutes:d,seconds:0}),selected:o.value===d,ref:$(null)}))),c=d=>{o.value=d.value,e("select",d.date)},u=()=>{const d=a.value.find(f=>{var g;var p,m;return(g=(m=(p=f.ref.value)==null?void 0:p.classList)==null?void 0:m.contains("selected"))!=null?g:!1}),h=l.value.find(f=>{var g;var p,m;return(g=(m=(p=f.ref.value)==null?void 0:p.classList)==null?void 0:m.contains("selected"))!=null?g:!1});d&&h&&(t1(t.value,d.ref.value),t1(r.value,h.ref.value))};return et(()=>n.visible,d=>{d&&Aa(u)}),{hoursListRef:t,minutesListRef:r,hours:i,minutes:o,hoursList:a,minutesList:l,padStartZero:d=>"0".concat(d).substr(-2),selectMinutes:c,isEnabled:d=>{var h,f,p,m;return!((f=(h=n.disabledTime)==null?void 0:h.dates)!=null&&f.some(g=>uR(d,g)&&dR(d,g))||(m=(p=n.disabledTime)==null?void 0:p.predicate)!=null&&m.call(p,d))},scroll:u}}}),rL={ref:"hoursListRef",class:"v3dp__column"},sL=["disabled","onClick"],iL={ref:"minutesListRef",class:"v3dp__column"},oL=["disabled","onClick"];function aL(n,e,t,r,s,i){const o=dt("picker-popup");return w(),Y(o,{headingClickable:"",columnCount:2,leftDisabled:!0,rightDisabled:!0,viewMode:"time",onHeading:e[0]||(e[0]=a=>n.$emit("back"))},{heading:q(()=>[U(T(n.padStartZero(n.hours))+":"+T(n.padStartZero(n.minutes)),1)]),body:q(()=>[v("div",rL,[(w(!0),S(J,null,Fe(n.hoursList,a=>(w(),S("button",{key:a.value,ref_for:!0,ref:a.ref,class:ue([{selected:a.selected},"v3dp__element_button__hour"]),disabled:!n.isEnabled(a.date),onClick:Se(l=>n.hours=a.value,["stop","prevent"])},[v("span",null,T(n.padStartZero(a.value)),1)],10,sL))),128))],512),v("div",iL,[(w(!0),S(J,null,Fe(n.minutesList,a=>(w(),S("button",{key:a.value,ref_for:!0,ref:a.ref,class:ue([{selected:a.selected},"v3dp__element_button__minute"]),disabled:!n.isEnabled(a.date),onClick:Se(l=>n.selectMinutes(a),["stop","prevent"])},[v("span",null,T(n.padStartZero(a.value)),1)],10,oL))),128))],512)]),_:1})}const lL=wo(nL,[["render",aL],["__scopeId","data-v-81ac698d"]]),ql=["time","day","month","year"],cL=(n,e,t=void 0)=>{let r=t||new Date;return n&&(r=TP([n,r])),e&&(r=OP([e,r])),r},uL=B({components:{YearPicker:GI,MonthPicker:QI,DayPicker:tL,TimePicker:lL},inheritAttrs:!1,props:{placeholder:{type:String,default:""},modelValue:{type:Date,required:!1},disabledDates:{type:Object,required:!1},allowOutsideInterval:{type:Boolean,required:!1,default:!1},disabledTime:{type:Object,required:!1},upperLimit:{type:Date,required:!1},lowerLimit:{type:Date,required:!1},startingView:{type:String,required:!1,default:"day",validate:n=>typeof n=="string"&&ql.includes(n)},startingViewDate:{type:Date,required:!1,default:()=>new Date},dayPickerHeadingFormat:{type:String,required:!1,default:"LLLL yyyy"},monthListFormat:{type:String,required:!1,default:"LLL"},weekdayFormat:{type:String,required:!1,default:"EE"},dayFormat:{type:String,required:!1,default:"dd"},inputFormat:{type:String,required:!1,default:"yyyy-MM-dd"},locale:{type:Object,required:!1},weekStartsOn:{type:Number,required:!1,default:1,validator:n=>[0,1,2,3,4,5,6].includes(n)},disabled:{type:Boolean,required:!1,default:!1},clearable:{type:Boolean,required:!1,default:!1},typeable:{type:Boolean,required:!1,default:!1},minimumView:{type:String,required:!1,default:"day",validate:n=>typeof n=="string"&&ql.includes(n)}},emits:{"update:modelValue":n=>n==null||hn(n),decadePageChanged:n=>!0,yearPageChanged:n=>!0,monthPageChanged:n=>!0,opened:()=>!0,closed:()=>!0},setup(n,{emit:e,attrs:t}){const r=$("none"),s=$(n.startingViewDate),i=$(null),o=$(!1),a=$("");It(()=>{const k=Vv(a.value,n.inputFormat,new Date,{locale:n.locale});hn(k)&&(s.value=k)}),It(()=>a.value=n.modelValue&&hn(n.modelValue)?ao(n.modelValue,n.inputFormat,{locale:n.locale}):"");const l=(k="none")=>{n.disabled||(k!=="none"&&r.value==="none"&&(s.value=n.modelValue||cL(n.lowerLimit,n.upperLimit,s.value)),r.value=k,e(k!=="none"?"opened":"closed"))};It(()=>{n.disabled&&(r.value="none")});const c=(k,C)=>{s.value=C,k==="year"?e("decadePageChanged",C):k==="month"?e("yearPageChanged",C):k==="day"&&e("monthPageChanged",C)},u=k=>{s.value=k,n.minimumView==="year"?(l("none"),e("update:modelValue",k)):r.value="month"},d=k=>{s.value=k,n.minimumView==="month"?(l("none"),e("update:modelValue",k)):r.value="day"},h=k=>{s.value=k,n.minimumView==="day"?(l("none"),e("update:modelValue",k)):r.value="time"},f=k=>{l("none"),e("update:modelValue",k)},p=()=>{n.clearable&&(l("none"),e("update:modelValue",null),s.value=n.startingViewDate)},m=()=>o.value=!0,g=()=>l(M.value),b=()=>{o.value=!1,l()},_=k=>{const C=k.keyCode?k.keyCode:k.which;if([27,13].includes(C)&&i.value.blur(),n.typeable){const x=Vv(i.value.value,n.inputFormat,new Date,{locale:n.locale});hn(x)&&a.value===ao(x,n.inputFormat,{locale:n.locale})&&(a.value=i.value.value,e("update:modelValue",x))}},M=A(()=>{const k=ql.indexOf(n.startingView),C=ql.indexOf(n.minimumView);return k<C?n.minimumView:n.startingView});return{blur:b,focus:g,click:m,input:a,inputRef:i,pageDate:s,renderView:l,updatePageDate:c,selectYear:u,selectMonth:d,selectDay:h,selectTime:f,keyUp:_,viewShown:r,goBackFromTimepicker:()=>n.startingView==="time"&&n.minimumView==="time"?null:r.value="day",clearModelValue:p,initialView:M,log:k=>console.log(k),variables:k=>Object.fromEntries(Object.entries(k!=null?k:{}).filter(([C,x])=>C.startsWith("--")))}}}),dL={class:"v3dp__input_wrapper"},hL=["readonly","placeholder","disabled","tabindex"],fL={class:"v3dp__clearable"};function pL(n,e,t,r,s,i){const o=dt("year-picker"),a=dt("month-picker"),l=dt("day-picker"),c=dt("time-picker");return w(),S("div",{class:"v3dp__datepicker",style:vo(n.variables(n.$attrs.style))},[v("div",dL,[yt(v("input",rr({type:"text",ref:"inputRef",readonly:!n.typeable,"onUpdate:modelValue":e[0]||(e[0]=u=>n.input=u)},n.$attrs,{placeholder:n.placeholder,disabled:n.disabled,tabindex:n.disabled?-1:0,onKeyup:e[1]||(e[1]=(...u)=>n.keyUp&&n.keyUp(...u)),onBlur:e[2]||(e[2]=(...u)=>n.blur&&n.blur(...u)),onFocus:e[3]||(e[3]=(...u)=>n.focus&&n.focus(...u)),onClick:e[4]||(e[4]=(...u)=>n.click&&n.click(...u))}),null,16,hL),[[fs,n.input]]),yt(v("div",fL,[Ye(n.$slots,"clear",{onClear:n.clearModelValue},()=>[v("i",{onClick:e[5]||(e[5]=u=>n.clearModelValue())},"x")])],512),[[Kr,n.clearable&&n.modelValue]])]),yt(P(o,{pageDate:n.pageDate,"onUpdate:pageDate":e[6]||(e[6]=u=>n.updatePageDate("year",u)),selected:n.modelValue,lowerLimit:n.lowerLimit,upperLimit:n.upperLimit,onSelect:n.selectYear},null,8,["pageDate","selected","lowerLimit","upperLimit","onSelect"]),[[Kr,n.viewShown==="year"]]),yt(P(a,{pageDate:n.pageDate,"onUpdate:pageDate":e[7]||(e[7]=u=>n.updatePageDate("month",u)),selected:n.modelValue,onSelect:n.selectMonth,lowerLimit:n.lowerLimit,upperLimit:n.upperLimit,format:n.monthListFormat,locale:n.locale,onBack:e[8]||(e[8]=u=>n.viewShown="year")},null,8,["pageDate","selected","onSelect","lowerLimit","upperLimit","format","locale"]),[[Kr,n.viewShown==="month"]]),yt(P(l,{pageDate:n.pageDate,"onUpdate:pageDate":e[9]||(e[9]=u=>n.updatePageDate("day",u)),selected:n.modelValue,weekStartsOn:n.weekStartsOn,lowerLimit:n.lowerLimit,upperLimit:n.upperLimit,headingFormat:n.dayPickerHeadingFormat,disabledDates:n.disabledDates,locale:n.locale,weekdayFormat:n.weekdayFormat,"allow-outside-interval":n.allowOutsideInterval,format:n.dayFormat,onSelect:n.selectDay,onBack:e[10]||(e[10]=u=>n.viewShown="month")},null,8,["pageDate","selected","weekStartsOn","lowerLimit","upperLimit","headingFormat","disabledDates","locale","weekdayFormat","allow-outside-interval","format","onSelect"]),[[Kr,n.viewShown==="day"]]),yt(P(c,{pageDate:n.pageDate,visible:n.viewShown==="time",selected:n.modelValue,disabledTime:n.disabledTime,onSelect:n.selectTime,onBack:n.goBackFromTimepicker},null,8,["pageDate","visible","selected","disabledTime","onSelect","onBack"]),[[Kr,n.viewShown==="time"]])],4)}const p_=wo(uL,[["render",pL]]),mL=B({components:{Datepicker:p_},emits:["change","update:modelValue"],props:{modelValue:{type:Object,default:()=>({start:null,end:null})}},setup(n,{emit:e}){const t=$(n.modelValue.start),r=$(n.modelValue.end),s=Ra("startRef"),i=Ra("endRef"),o=$(null),a="START",l="END",c="L";et([t,r],()=>{let m={start:null,end:null};t.value&&r.value&&(m={start:ao(t.value,"yyyy-MM-dd"),end:ao(r.value,"yyyy-MM-dd")}),e("update:modelValue",m),e("change",m)});const u=()=>{t.value=null,r.value=null},d=m=>{m.value&&m.value.renderView(m.value.initialView)};return{start:t,end:r,showStartSelector:()=>{o.value=a,d(s)},showEndSelector:()=>{o.value=l,d(i)},hideSelector:()=>{o.value=null},selectorShown:o,selectorShownStart:a,selectorShownEnd:l,locale:K0(mp),clear:u,formatDate:ps,formatTemplate:c}}}),gL={class:"rangepicker__hint fr-m-0"},yL={class:"rangepicker__hint fr-m-0"};function vL(n,e,t,r,s,i){const o=dt("Datepicker");return w(),S("div",{class:ue(["rangepicker fr-select",{"rangepicker--selected":n.start}])},[yt(v("div",null,[v("p",gL,T(n.$t("Select lower bound:")),1),P(o,{modelValue:n.start,"onUpdate:modelValue":[e[0]||(e[0]=a=>n.start=a),n.showEndSelector],upperLimit:n.end,locale:n.locale,ref:"startRef"},null,8,["modelValue","upperLimit","locale","onUpdate:modelValue"])],512),[[Kr,n.selectorShown===n.selectorShownStart]]),yt(v("div",null,[v("p",yL,T(n.$t("Select upper bound:")),1),P(o,{modelValue:n.end,"onUpdate:modelValue":[e[1]||(e[1]=a=>n.end=a),n.hideSelector],lowerLimit:n.start,locale:n.locale,ref:"endRef"},null,8,["modelValue","lowerLimit","locale","onUpdate:modelValue"])],512),[[Kr,n.selectorShown===n.selectorShownEnd]]),n.selectorShown===null?(w(),S("button",{key:0,class:"rangepicker__button w-100 text-align-left",onClick:e[3]||(e[3]=Se((...a)=>n.showStartSelector&&n.showStartSelector(...a),["prevent"]))},[n.start?(w(),S(J,{key:1},[U(T(n.formatDate(n.start,n.formatTemplate)),1),n.end?(w(),S(J,{key:0},[U("–"+T(n.formatDate(n.end,n.formatTemplate)),1)],64)):I("",!0),n.start?(w(),S("button",{key:1,class:"fr-fi-close-line clear",onClick:e[2]||(e[2]=Se((...a)=>n.clear&&n.clear(...a),["stop"]))})):I("",!0)],64)):(w(),S(J,{key:0},[U(T(n.$t("from dd/mm/yyyy to dd/mm/yyyy")),1)],64))])):I("",!0)],2)}const bL=$e(mL,[["render",vL]]),rd=Symbol("editorInfoCtxKey");function wL(){const{dom:n,loading:e,editor:t,editorFactory:r}=ct(rd,{}),s=$();return Ve(()=>{if(!n.value)return;const i=r.value(n.value);i&&(e.value=!0,s.value=i,i.create().then(o=>{t.value=o}).finally(()=>{e.value=!1}).catch(console.error))}),Nn(()=>{var i;(i=s.value)==null||i.destroy().catch(console.error)}),n}const _L=B({name:"Milkdown",setup:()=>{const n=wL();return()=>P("div",{"data-milkdown-root":!0,ref:n},null)}}),kL=B({name:"MilkdownProvider",setup:(n,{slots:e})=>{const t=$(null),r=$(void 0),s=$(void 0),i=$(!0);return xt(rd,{loading:i,dom:t,editor:s,editorFactory:r}),()=>{var o;return P(J,null,[(o=e.default)==null?void 0:o.call(e)])}}});function xL(n){const{editorFactory:e,loading:t,editor:r}=ct(rd);return e.value=n,{loading:t,get:()=>r.value}}function cl(){const n=ct(rd);return[n.loading,()=>n.editor.value]}var CL=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)},m_=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},Tf=(n,e,t)=>(CL(n,e,"access private method"),t),hc,Of;let SL=class{constructor({node:e,view:t,getPos:r,decorations:s,innerDecorations:i,options:o}){m_(this,hc),this.selected=!1,this.selectNode=()=>{var a,l;this.selected=!0,(l=(a=this.options).selectNode)==null||l.call(a)},this.deselectNode=()=>{var a,l;this.selected=!1,(l=(a=this.options).deselectNode)==null||l.call(a)},this.shouldUpdate=a=>!(a.type!==this.node.type||a.sameMarkup(this.node)&&a.content.eq(this.node.content)),this.update=(a,l,c)=>{var u,d;const h=this.options.update;let f;return h&&(f=h(a,l,c)),typeof f!="boolean"&&(f=this.shouldUpdate(a)),this.node=a,this.decorations=l,this.innerDecorations=c,f&&((d=(u=this.options).onUpdate)==null||d.call(u)),f},this.shouldIgnoreMutation=a=>!this.dom||!this.contentDOM||this.node.isLeaf||this.node.isAtom?!0:a.type==="selection"?!1:this.contentDOM===a.target&&a.type==="attributes"?!0:!this.contentDOM.contains(a.target),this.ignoreMutation=a=>{if(!this.dom||!this.contentDOM)return!0;let l;const c=this.options.ignoreMutation;return c&&(l=c(a)),typeof l!="boolean"&&(l=this.shouldIgnoreMutation(a)),l},this.destroy=()=>{var a,l,c;(l=(a=this.options).destroy)==null||l.call(a),this.dom.remove(),(c=this.contentDOM)==null||c.remove()},this.setAttrs=a=>{const{dispatch:l,state:c}=this.view,u=this.getPos();if(typeof u=="number")return l(c.tr.setNodeMarkup(u,void 0,{...this.node.attrs,...a}))},this.node=e,this.view=t,this.getPos=r,this.decorations=s,this.innerDecorations=i,this.options=o,this.dom=this.createDOM(o.as),this.contentDOM=e.isLeaf?null:this.createContentDOM(o.contentAs),this.dom.setAttribute("data-node-view-root","true"),this.contentDOM&&(this.contentDOM.setAttribute("data-node-view-content","true"),this.contentDOM.style.whiteSpace="inherit"),this.setSelection=o.setSelection,this.stopEvent=o.stopEvent}createDOM(e){return Tf(this,hc,Of).call(this,e)}createContentDOM(e){return Tf(this,hc,Of).call(this,e)}get component(){return this.options.component}};hc=new WeakSet,Of=function(n){const{node:e}=this;return n==null?document.createElement(e.isInline?"span":"div"):n instanceof HTMLElement?n:n instanceof Function?n(e):document.createElement(n)};class ML{constructor(e){this.view=e.view,this.options=e.options}get component(){return this.options.component}get root(){var s;var e,t;let r=(t=(e=this.options).root)==null?void 0:t.call(e,this.view.dom);return r||(r=(s=this.view.dom.parentElement)!=null?s:document.body),r}update(e,t){var r,s;this.view=e,this.prevState=t,(s=(r=this.options).update)==null||s.call(r,e,t)}destroy(){var e,t;(t=(e=this.options).destroy)==null||t.call(e)}}var Df,g_;let TL=class{constructor({pos:e,spec:t,options:r}){m_(this,Df),this.pos=e,this.options=r,this.spec=t,this.dom=Tf(this,Df,g_).call(this,r.as),this.dom.setAttribute("data-widget-view-root","true")}bind(e,t){this.view=e,this.getPos=t}get component(){return this.options.component}};Df=new WeakSet,g_=function(n){return n instanceof HTMLElement?n:document.createElement(n)};let Zp=(n=21)=>crypto.getRandomValues(new Uint8Array(n)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");function At(n){this.content=n}At.prototype={constructor:At,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,s=r.find(n),i=r.content.slice();return s==-1?i.push(t||n,e):(i[s+1]=e,t&&(i[s]=t)),new At(i)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new At(t)},addToStart:function(n,e){return new At([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new At(t)},addBefore:function(n,e,t){var r=this.remove(e),s=r.content.slice(),i=r.find(n);return s.splice(i==-1?s.length:i,0,e,t),new At(s)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=At.from(n),n.size?new At(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=At.from(n),n.size?new At(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=At.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};At.from=function(n){if(n instanceof At)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new At(e)};function y_(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let s=n.child(r),i=e.child(r);if(s==i){t+=s.nodeSize;continue}if(!s.sameMarkup(i))return t;if(s.isText&&s.text!=i.text){for(let o=0;s.text[o]==i.text[o];o++)t++;return t}if(s.content.size||i.content.size){let o=y_(s.content,i.content,t+1);if(o!=null)return o}t+=s.nodeSize}}function v_(n,e,t,r){for(let s=n.childCount,i=e.childCount;;){if(s==0||i==0)return s==i?null:{a:t,b:r};let o=n.child(--s),a=e.child(--i),l=o.nodeSize;if(o==a){t-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:t,b:r};if(o.isText&&o.text!=a.text){let c=0,u=Math.min(o.text.length,a.text.length);for(;c<u&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(o.content.size||a.content.size){let c=v_(o.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}class j{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,s=0,i){for(let o=0,a=0;a<t;o++){let l=this.content[o],c=a+l.nodeSize;if(c>e&&r(l,s+a,i||null,o)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,s+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,s){let i="",o=!0;return this.nodesBetween(e,t,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,t-l):a.isLeaf?s?typeof s=="function"?s(a):s:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(o?o=!1:i+=r),i+=c},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,s=this.content.slice(),i=0;for(t.isText&&t.sameMarkup(r)&&(s[s.length-1]=t.withText(t.text+r.text),i=1);i<e.content.length;i++)s.push(e.content[i]);return new j(s,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],s=0;if(t>e)for(let i=0,o=0;o<t;i++){let a=this.content[i],l=o+a.nodeSize;l>e&&((o<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-o),Math.min(a.text.length,t-o)):a=a.cut(Math.max(0,e-o-1),Math.min(a.content.size,t-o-1))),r.push(a),s+=a.nodeSize),o=l}return new j(r,s)}cutByIndex(e,t){return e==t?j.empty:e==0&&t==this.content.length?this:new j(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let s=this.content.slice(),i=this.size+t.nodeSize-r.nodeSize;return s[e]=t,new j(s,i)}addToStart(e){return new j([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new j(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let s=this.content[t];e(s,r,t),r+=s.nodeSize}}findDiffStart(e,t=0){return y_(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return v_(this,e,t,r)}findIndex(e,t=-1){if(e==0)return Yl(0,e);if(e==this.size)return Yl(this.content.length,e);if(e>this.size||e<0)throw new RangeError("Position ".concat(e," outside of fragment (").concat(this,")"));for(let r=0,s=0;;r++){let i=this.child(r),o=s+i.nodeSize;if(o>=e)return o==e||t>0?Yl(r+1,o):Yl(r,s);s=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return j.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new j(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return j.empty;let t,r=0;for(let s=0;s<e.length;s++){let i=e[s];r+=i.nodeSize,s&&i.isText&&e[s-1].sameMarkup(i)?(t||(t=e.slice(0,s)),t[t.length-1]=i.withText(t[t.length-1].text+i.text)):t&&t.push(i)}return new j(t||e,r)}static from(e){if(!e)return j.empty;if(e instanceof j)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new j([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}j.empty=new j([],0);const ih={index:0,offset:0};function Yl(n,e){return ih.index=n,ih.offset=e,ih}function yu(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!yu(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!yu(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}class Pe{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let s=0;s<e.length;s++){let i=e[s];if(this.eq(i))return e;if(this.type.excludes(i.type))t||(t=e.slice(0,s));else{if(i.type.excludes(this.type))return e;!r&&i.type.rank>this.type.rank&&(t||(t=e.slice(0,s)),t.push(this),r=!0),t&&t.push(i)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&yu(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError("There is no mark type ".concat(t.type," in this schema"));let s=r.create(t.attrs);return r.checkAttrs(s.attrs),s}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Pe.none;if(e instanceof Pe)return[e];let t=e.slice();return t.sort((r,s)=>r.type.rank-s.type.rank),t}}Pe.none=[];class vu extends Error{}let Q=class Ri{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=w_(this.content,e+this.openStart,t);return r&&new Ri(r,this.openStart,this.openEnd)}removeBetween(e,t){return new Ri(b_(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return Ri.empty;let r=t.openStart||0,s=t.openEnd||0;if(typeof r!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Ri(j.fromJSON(e,t.content),r,s)}static maxOpen(e,t=!0){let r=0,s=0;for(let i=e.firstChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.firstChild)r++;for(let i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)s++;return new Ri(e,r,s)}};Q.empty=new Q(j.empty,0,0);function b_(n,e,t){let{index:r,offset:s}=n.findIndex(e),i=n.maybeChild(r),{index:o,offset:a}=n.findIndex(t);if(s==e||i.isText){if(a!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,i.copy(b_(i.content,e-s-1,t-s-1)))}function w_(n,e,t,r){let{index:s,offset:i}=n.findIndex(e),o=n.maybeChild(s);if(i==e||o.isText)return r&&!r.canReplace(s,s,t)?null:n.cut(0,e).append(t).append(n.cut(e));let a=w_(o.content,e-i-1,t);return a&&n.replaceChild(s,o.copy(a))}function OL(n,e,t){if(t.openStart>n.depth)throw new vu("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new vu("Inconsistent open depths");return __(n,e,t,0)}function __(n,e,t,r){let s=n.index(r),i=n.node(r);if(s==e.index(r)&&r<n.depth-t.openStart){let o=__(n,e,t,r+1);return i.copy(i.content.replaceChild(s,o))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let o=n.parent,a=o.content;return ei(o,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:o,end:a}=DL(t,n);return ei(i,x_(n,o,a,e,r))}else return ei(i,bu(n,e,r))}function k_(n,e){if(!e.type.compatibleContent(n.type))throw new vu("Cannot join "+e.type.name+" onto "+n.type.name)}function $f(n,e,t){let r=n.node(t);return k_(r,e.node(t)),r}function Zs(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function xa(n,e,t,r){let s=(e||n).node(t),i=0,o=e?e.index(t):s.childCount;n&&(i=n.index(t),n.depth>t?i++:n.textOffset&&(Zs(n.nodeAfter,r),i++));for(let a=i;a<o;a++)Zs(s.child(a),r);e&&e.depth==t&&e.textOffset&&Zs(e.nodeBefore,r)}function ei(n,e){return n.type.checkContent(e),n.copy(e)}function x_(n,e,t,r,s){let i=n.depth>s&&$f(n,e,s+1),o=r.depth>s&&$f(t,r,s+1),a=[];return xa(null,n,s,a),i&&o&&e.index(s)==t.index(s)?(k_(i,o),Zs(ei(i,x_(n,e,t,r,s+1)),a)):(i&&Zs(ei(i,bu(n,e,s+1)),a),xa(e,t,s,a),o&&Zs(ei(o,bu(t,r,s+1)),a)),xa(r,null,s,a),new j(a)}function bu(n,e,t){let r=[];if(xa(null,n,t,r),n.depth>t){let s=$f(n,e,t+1);Zs(ei(s,bu(n,e,t+1)),r)}return xa(e,null,t,r),new j(r)}function DL(n,e){let t=e.depth-n.openStart,s=e.node(t).copy(n.content);for(let i=t-1;i>=0;i--)s=e.node(i).copy(j.from(s));return{start:s.resolveNoCache(n.openStart+t),end:s.resolveNoCache(s.content.size-n.openEnd-t)}}class ja{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],s=e.child(t);return r?e.child(t).cut(r):s}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],s=t==0?0:this.path[t*3-1]+1;for(let i=0;i<e;i++)s+=r.child(i).nodeSize;return s}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return Pe.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),s=e.maybeChild(t);if(!r){let a=r;r=s,s=a}let i=r.marks;for(var o=0;o<i.length;o++)i[o].type.spec.inclusive===!1&&(!s||!i[o].isInSet(s.marks))&&(i=i[o--].removeFromSet(i));return i}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,s=e.parent.maybeChild(e.index());for(var i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!s||!r[i].isInSet(s.marks))&&(r=r[i--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new C_(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],s=0,i=t;for(let o=e;;){let{index:a,offset:l}=o.content.findIndex(i),c=i-l;if(r.push(o,a,s+l),!c||(o=o.child(a),o.isText))break;i=c-1,s+=l+1}return new ja(t,r,i)}static resolveCached(e,t){let r=n1.get(e);if(r)for(let i=0;i<r.elts.length;i++){let o=r.elts[i];if(o.pos==t)return o}else n1.set(e,r=new $L);let s=r.elts[r.i]=ja.resolve(e,t);return r.i=(r.i+1)%EL,s}}class $L{constructor(){this.elts=[],this.i=0}}const EL=12,n1=new WeakMap;class C_{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const AL=Object.create(null);let as=class Ef{constructor(e,t,r,s=Pe.none){this.type=e,this.attrs=t,this.marks=s,this.content=r||j.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,s=0){this.content.nodesBetween(e,t,r,s,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,s){return this.content.textBetween(e,t,r,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&yu(this.attrs,t||e.defaultAttrs||AL)&&Pe.sameSet(this.marks,r||Pe.none)}copy(e=null){return e==this.content?this:new Ef(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Ef(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return Q.empty;let s=this.resolve(e),i=this.resolve(t),o=r?0:s.sharedDepth(t),a=s.start(o),c=s.node(o).content.cut(s.pos-a,i.pos-a);return new Q(c,s.depth-o,i.depth-o)}replace(e,t,r){return OL(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:s}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(s==e||t.isText)return t;e-=s+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let s=this.content.child(t-1);return{node:s,index:t-1,offset:r-s.nodeSize}}resolve(e){return ja.resolveCached(this,e)}resolveNoCache(e){return ja.resolve(this,e)}rangeHasMark(e,t,r){let s=!1;return t>e&&this.nodesBetween(e,t,i=>(r.isInSet(i.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),S_(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=j.empty,s=0,i=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,s,i),a=o&&o.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=s;l<i;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,t,r,s){if(s&&!this.type.allowsMarks(s))return!1;let i=this.contentMatchAt(e).matchType(r),o=i&&i.matchFragment(this.content,t);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Pe.none;for(let t=0;t<this.marks.length;t++){let r=this.marks[t];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Pe.sameSet(e,this.marks))throw new RangeError("Invalid collection of marks for node ".concat(this.type.name,": ").concat(this.marks.map(t=>t.type.name)));this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let s=j.fromJSON(e,t.content),i=e.nodeType(t.type).create(t.attrs,s,r);return i.type.checkAttrs(i.attrs),i}};as.prototype.text=void 0;class wu extends as{constructor(e,t,r,s){if(super(e,t,null,s),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):S_(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new wu(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new wu(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function S_(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class gi{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new PL(e,t);if(r.next==null)return gi.empty;let s=M_(r);r.next&&r.err("Unexpected trailing text");let i=FL(BL(s));return VL(i,r),i}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let s=this;for(let i=t;s&&i<r;i++)s=s.matchType(e.child(i).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let s=[this];function i(o,a){let l=o.matchFragment(e,r);if(l&&(!t||l.validEnd))return j.from(a.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:u,next:d}=o.next[c];if(!(u.isText||u.hasRequiredAttrs())&&s.indexOf(d)==-1){s.push(d);let h=i(d,a.concat(u));if(h)return h}}return null}return i(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let s=r.shift(),i=s.match;if(i.matchType(e)){let o=[];for(let a=s;a.type;a=a.via)o.push(a.type);return o.reverse()}for(let o=0;o<i.next.length;o++){let{type:a,next:l}=i.next[o];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!s.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:s}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError("There's no ".concat(e,"th edge in this content match"));return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let s=0;s<r.next.length;s++)e.indexOf(r.next[s].next)==-1&&t(r.next[s].next)}return t(this),e.map((r,s)=>{let i=s+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)i+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return i}).join("\n")}}gi.empty=new gi(!0);class PL{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function M_(n){let e=[];do e.push(RL(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function RL(n){let e=[];do e.push(NL(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function NL(n){let e=zL(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=IL(n,e);else break;return e}function r1(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function IL(n,e){let t=r1(n),r=t;return n.eat(",")&&(n.next!="}"?r=r1(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function LL(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let s=[];for(let i in t){let o=t[i];o.isInGroup(e)&&s.push(o)}return s.length==0&&n.err("No node type or group '"+e+"' found"),s}function zL(n){if(n.eat("(")){let e=M_(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=LL(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function BL(n){let e=[[]];return s(i(n,0),t()),e;function t(){return e.push([])-1}function r(o,a,l){let c={term:l,to:a};return e[o].push(c),c}function s(o,a){o.forEach(l=>l.to=a)}function i(o,a){if(o.type=="choice")return o.exprs.reduce((l,c)=>l.concat(i(c,a)),[]);if(o.type=="seq")for(let l=0;;l++){let c=i(o.exprs[l],a);if(l==o.exprs.length-1)return c;s(c,a=t())}else if(o.type=="star"){let l=t();return r(a,l),s(i(o.expr,l),l),[r(l)]}else if(o.type=="plus"){let l=t();return s(i(o.expr,a),l),s(i(o.expr,l),l),[r(l)]}else{if(o.type=="opt")return[r(a)].concat(i(o.expr,a));if(o.type=="range"){let l=a;for(let c=0;c<o.min;c++){let u=t();s(i(o.expr,l),u),l=u}if(o.max==-1)s(i(o.expr,l),l);else for(let c=o.min;c<o.max;c++){let u=t();r(l,u),s(i(o.expr,l),u),l=u}return[r(l)]}else{if(o.type=="name")return[r(a,void 0,o.value)];throw new Error("Unknown expr type")}}}}function T_(n,e){return e-n}function s1(n,e){let t=[];return r(e),t.sort(T_);function r(s){let i=n[s];if(i.length==1&&!i[0].term)return r(i[0].to);t.push(s);for(let o=0;o<i.length;o++){let{term:a,to:l}=i[o];!a&&t.indexOf(l)==-1&&r(l)}}}function FL(n){let e=Object.create(null);return t(s1(n,0));function t(r){let s=[];r.forEach(o=>{n[o].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<s.length;u++)s[u][0]==a&&(c=s[u][1]);s1(n,l).forEach(u=>{c||s.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let i=e[r.join(",")]=new gi(r.indexOf(n.length-1)>-1);for(let o=0;o<s.length;o++){let a=s[o][1].sort(T_);i.next.push({type:s[o][0],next:e[a.join(",")]||t(a)})}return i}}function VL(n,e){for(let t=0,r=[n];t<r.length;t++){let s=r[t],i=!s.validEnd,o=[];for(let a=0;a<s.next.length;a++){let{type:l,next:c}=s.next[a];o.push(l.name),i&&!(l.isText||l.hasRequiredAttrs())&&(i=!1),r.indexOf(c)==-1&&r.push(c)}i&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function O_(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function D_(n,e){let t=Object.create(null);for(let r in n){let s=e&&e[r];if(s===void 0){let i=n[r];if(i.hasDefault)s=i.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=s}return t}function $_(n,e,t,r){for(let s in e)if(!(s in n))throw new RangeError("Unsupported attribute ".concat(s," for ").concat(t," of type ").concat(s));for(let s in n){let i=n[s];i.validate&&i.validate(e[s])}}function E_(n,e){let t=Object.create(null);if(e)for(let r in e)t[r]=new WL(n,r,e[r]);return t}let i1=class A_{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=E_(e,r.attrs),this.defaultAttrs=O_(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==gi.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:D_(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new as(this,this.computeAttrs(e),j.from(t),Pe.setFrom(r))}createChecked(e=null,t,r){return t=j.from(t),this.checkContent(t),new as(this,this.computeAttrs(e),t,Pe.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=j.from(t),t.size){let o=this.contentMatch.fillBefore(t);if(!o)return null;t=o.append(t)}let s=this.contentMatch.matchFragment(t),i=s&&s.fillBefore(j.empty,!0);return i?new as(this,e,t.append(i),Pe.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError("Invalid content for node ".concat(this.name,": ").concat(e.toString().slice(0,50)))}checkAttrs(e){$_(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:Pe.none:e}static compile(e,t){let r=Object.create(null);e.forEach((i,o)=>r[i]=new A_(i,t,o));let s=t.spec.topNode||"doc";if(!r[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function HL(n,e,t){let r=t.split("|");return s=>{let i=s===null?"null":typeof s;if(r.indexOf(i)<0)throw new RangeError("Expected value of type ".concat(r," for attribute ").concat(e," on type ").concat(n,", got ").concat(i))}}class WL{constructor(e,t,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?HL(e,t,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class sd{constructor(e,t,r,s){this.name=e,this.rank=t,this.schema=r,this.spec=s,this.attrs=E_(e,s.attrs),this.excluded=null;let i=O_(this.attrs);this.instance=i?new Pe(this,i):null}create(e=null){return!e&&this.instance?this.instance:new Pe(this,D_(this.attrs,e))}static compile(e,t){let r=Object.create(null),s=0;return e.forEach((i,o)=>r[i]=new sd(i,s++,t,o)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){$_(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class jL{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let s in e)t[s]=e[s];t.nodes=At.from(e.nodes),t.marks=At.from(e.marks||{}),this.nodes=i1.compile(this.spec.nodes,this),this.marks=sd.compile(this.spec.marks,this);let r=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let i=this.nodes[s],o=i.spec.content||"",a=i.spec.marks;if(i.contentMatch=r[o]||(r[o]=gi.parse(o,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=a=="_"?null:a?o1(this,a.split(" ")):a==""||!i.inlineContent?[]:null}for(let s in this.marks){let i=this.marks[s],o=i.spec.excludes;i.excluded=o==null?[i]:o==""?[]:o1(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,s){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof i1){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,s)}text(e,t){let r=this.nodes.text;return new wu(r,r.defaultAttrs,e,Pe.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return as.fromJSON(this,e)}markFromJSON(e){return Pe.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function o1(n,e){let t=[];for(let r=0;r<e.length;r++){let s=e[r],i=n.marks[s],o=i;if(i)t.push(i);else for(let a in n.marks){let l=n.marks[a];(s=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(s)>-1)&&t.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function UL(n){return n.tag!=null}function qL(n){return n.style!=null}class co{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let r=this.matchedStyles=[];t.forEach(s=>{if(UL(s))this.tags.push(s);else if(qL(s)){let i=/[^=]*/.exec(s.style)[0];r.indexOf(i)<0&&r.push(i),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let i=e.nodes[s.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let r=new l1(this,t,!1);return r.addAll(e,Pe.none,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new l1(this,t,!0);return r.addAll(e,Pe.none,t.from,t.to),Q.maxOpen(r.finish())}matchTag(e,t,r){for(let s=r?this.tags.indexOf(r)+1:0;s<this.tags.length;s++){let i=this.tags[s];if(GL(e,i.tag)&&(i.namespace===void 0||e.namespaceURI==i.namespace)&&(!i.context||t.matchesContext(i.context))){if(i.getAttrs){let o=i.getAttrs(e);if(o===!1)continue;i.attrs=o||void 0}return i}}}matchStyle(e,t,r,s){for(let i=s?this.styles.indexOf(s)+1:0;i<this.styles.length;i++){let o=this.styles[i],a=o.style;if(!(a.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(o.getAttrs){let l=o.getAttrs(t);if(l===!1)continue;o.attrs=l||void 0}return o}}}static schemaRules(e){let t=[];function r(s){let i=s.priority==null?50:s.priority,o=0;for(;o<t.length;o++){let a=t[o];if((a.priority==null?50:a.priority)<i)break}t.splice(o,0,s)}for(let s in e.marks){let i=e.marks[s].spec.parseDOM;i&&i.forEach(o=>{r(o=c1(o)),o.mark||o.ignore||o.clearMark||(o.mark=s)})}for(let s in e.nodes){let i=e.nodes[s].spec.parseDOM;i&&i.forEach(o=>{r(o=c1(o)),o.node||o.ignore||o.mark||(o.node=s)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new co(e,co.schemaRules(e)))}}const P_={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},YL={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},R_={ol:!0,ul:!0},Ua=1,Af=2,Ca=4;function a1(n,e,t){return e!=null?(e?Ua:0)|(e==="full"?Af:0):n&&n.whitespace=="pre"?Ua|Af:t&~Ca}class Kl{constructor(e,t,r,s,i,o){this.type=e,this.attrs=t,this.marks=r,this.solid=s,this.options=o,this.content=[],this.activeMarks=Pe.none,this.match=i||(o&Ca?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(j.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,s;return(s=r.findWrapping(e.type))?(this.match=r,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Ua)){let r=this.content[this.content.length-1],s;if(r&&r.isText&&(s=/[ \t\r\n\u000c]+$/.exec(r.text))){let i=r;r.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-s[0].length))}}let t=j.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(j.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!P_.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class l1{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let s=t.topNode,i,o=a1(null,t.preserveWhitespace,0)|(r?Ca:0);s?i=new Kl(s.type,s.attrs,Pe.none,!0,t.topMatch||s.type.contentMatch,o):r?i=new Kl(null,null,Pe.none,!0,null,o):i=new Kl(e.schema.topNodeType,null,Pe.none,!0,null,o),this.nodes=[i],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let r=e.nodeValue,s=this.top,i=s.options&Af?"full":this.localPreserveWS||(s.options&Ua)>0;if(i==="full"||s.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(i)i!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,"\n");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let o=s.content[s.content.length-1],a=e.previousSibling;(!o||a&&a.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),t,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,t,r){let s=this.localPreserveWS,i=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),a;R_.hasOwnProperty(o)&&this.parser.normalizeLists&&KL(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,r));e:if(l?l.ignore:YL.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,t);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let c,u=this.needsBlock;if(P_.hasOwnProperty(o))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),c=!0,i.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let d=l&&l.skip?t:this.readStyles(e,t);d&&this.addAll(e,d),c&&this.sync(i),this.needsBlock=u}else{let c=this.readStyles(e,t);c&&this.addElementByRule(e,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=s}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let r=e.style;if(r&&r.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let i=this.parser.matchedStyles[s],o=r.getPropertyValue(i);if(o)for(let a=void 0;;){let l=this.parser.matchStyle(i,o,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?t=t.filter(c=>!l.clearMark(c)):t=t.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return t}addElementByRule(e,t,r,s){let i,o;if(t.node)if(o=this.parser.schema.nodes[t.node],o.isLeaf)this.insertNode(o.create(t.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let l=this.enter(o,t.attrs||null,r,t.preserveWhitespace);l&&(i=!0,r=l)}else{let l=this.parser.schema.marks[t.mark];r=r.concat(l.create(t.attrs))}let a=this.top;if(o&&o.isLeaf)this.findInside(e);else if(s)this.addElement(e,r,s);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r,!1));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}i&&this.sync(a)&&this.open--}addAll(e,t,r,s){let i=r||0;for(let o=r?e.childNodes[r]:e.firstChild,a=s==null?null:e.childNodes[s];o!=a;o=o.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(o,t);this.findAtPoint(e,i)}findPlace(e,t,r){let s,i;for(let o=this.open,a=0;o>=0;o--){let l=this.nodes[o],c=l.findWrapping(e);if(c&&(!s||s.length>c.length+a)&&(s=c,i=l,!c.length))break;if(l.solid){if(r)break;a+=2}}if(!s)return null;this.sync(i);for(let o=0;o<s.length;o++)t=this.enterInner(s[o],null,t,!1);return t}insertNode(e,t,r){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(t=this.enterInner(i,null,t))}let s=this.findPlace(e,t,r);if(s){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let o=Pe.none;for(let a of s.concat(e.marks))(i.type?i.type.allowsMarkType(a.type):u1(a.type,e.type))&&(o=a.addToSet(o));return i.content.push(e.mark(o)),!0}return!1}enter(e,t,r,s){let i=this.findPlace(e.create(t),r,!1);return i&&(i=this.enterInner(e,t,r,!0,s)),i}enterInner(e,t,r,s=!1,i){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let a=a1(e,i,o.options);o.options&Ca&&o.content.length==0&&(a|=Ca);let l=Pe.none;return r=r.filter(c=>(o.type?o.type.allowsMarkType(c.type):u1(c.type,e))?(l=c.addToSet(l),!1):!0),this.nodes.push(new Kl(e,t,l,s,null,a)),this.open++,r}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=Ua)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let s=r.length-1;s>=0;s--)e+=r[s].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&e.nodeType==1&&e.contains(this.find[s].node)&&t.compareDocumentPosition(this.find[s].node)&(r?2:4)&&(this.find[s].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,s=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(s?0:1),o=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=i;l--)if(o(a-1,l))return!0;return!1}else{let u=l>0||l==0&&s?this.nodes[l].type:r&&l>=i?r.node(l-i).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;l--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}}function KL(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&R_.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function GL(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function c1(n){let e={};for(let t in n)e[t]=n[t];return e}function u1(n,e){let t=e.schema.nodes;for(let r in t){let s=t[r];if(!s.allowsMarkType(n))continue;let i=[],o=a=>{i.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||i.indexOf(u)<0&&o(u))return!0}};if(o(s.contentMatch))return!0}}class _o{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=oh(t).createDocumentFragment());let s=r,i=[];return e.forEach(o=>{if(i.length||o.marks.length){let a=0,l=0;for(;a<i.length&&l<o.marks.length;){let c=o.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(i[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<i.length;)s=i.pop()[1];for(;l<o.marks.length;){let c=o.marks[l++],u=this.serializeMark(c,o.isInline,t);u&&(i.push([c,s]),s.appendChild(u.dom),s=u.contentDOM||u.dom)}}s.appendChild(this.serializeNodeInner(o,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:s}=fc(oh(t),this.nodes[e.type.name](e),null,e.attrs);if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,s)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let s=e.marks.length-1;s>=0;s--){let i=this.serializeMark(e.marks[s],e.isInline,t);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r}serializeMark(e,t,r={}){let s=this.marks[e.type.name];return s&&fc(oh(r),s(e,t),null,e.attrs)}static renderSpec(e,t,r=null,s){return fc(e,t,r,s)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new _o(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=d1(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return d1(e.marks)}}function d1(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function oh(n){return n.document||window.document}const h1=new WeakMap;function JL(n){let e=h1.get(n);return e===void 0&&h1.set(n,e=XL(n)),e}function XL(n){let e=null;function t(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let s=0;s<r.length;s++)t(r[s]);else for(let s in r)t(r[s])}return t(n),e}function fc(n,e,t,r){if(typeof e=="string")return{dom:n.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let s=e[0],i;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(i=JL(r))&&i.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=s.indexOf(" ");o>0&&(t=s.slice(0,o),s=s.slice(o+1));let a,l=t?n.createElementNS(t,s):n.createElement(s),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let d in c)if(c[d]!=null){let h=d.indexOf(" ");h>0?l.setAttributeNS(d.slice(0,h),d.slice(h+1),c[d]):l.setAttribute(d,c[d])}}for(let d=u;d<e.length;d++){let h=e[d];if(h===0){if(d<e.length-1||d>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:f,contentDOM:p}=fc(n,h,t,r);if(l.appendChild(f),p){if(a)throw new RangeError("Multiple content holes");a=p}}}return{dom:l,contentDOM:a}}const N_=65535,I_=Math.pow(2,16);function QL(n,e){return n+e*I_}function f1(n){return n&N_}function ZL(n){return(n-(n&N_))/I_}const L_=1,z_=2,pc=4,B_=8;class Pf{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&B_)>0}get deletedBefore(){return(this.delInfo&(L_|pc))>0}get deletedAfter(){return(this.delInfo&(z_|pc))>0}get deletedAcross(){return(this.delInfo&pc)>0}}class un{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&un.empty)return un.empty}recover(e){let t=0,r=f1(e);if(!this.inverted)for(let s=0;s<r;s++)t+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[r*3]+t+ZL(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let s=0,i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?s:0);if(l>e)break;let c=this.ranges[a+i],u=this.ranges[a+o],d=l+c;if(e<=d){let h=c?e==l?-1:e==d?1:t:t,f=l+s+(h<0?0:u);if(r)return f;let p=e==(t<0?l:d)?null:QL(a/3,e-l),m=e==l?z_:e==d?L_:pc;return(t<0?e!=l:e!=d)&&(m|=B_),new Pf(f,m,p)}s+=u-c}return r?e+s:new Pf(e+s,0,null)}touches(e,t){let r=0,s=f1(t),i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+i],u=l+c;if(e<=u&&a==s*3)return!0;r+=this.ranges[a+o]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let s=0,i=0;s<this.ranges.length;s+=3){let o=this.ranges[s],a=o-(this.inverted?i:0),l=o+(this.inverted?0:i),c=this.ranges[s+t],u=this.ranges[s+r];e(a,a+c,l,l+u),i+=u-c}}invert(){return new un(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?un.empty:new un(e<0?[0,-e,0]:[0,0,e])}}un.empty=new un([]);class qa{constructor(e,t,r=0,s=e?e.length:0){this.mirror=t,this.from=r,this.to=s,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new qa(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),t!=null&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,r=this._maps.length;t<e._maps.length;t++){let s=e.getMirror(t);this.appendMap(e._maps[t],s!=null&&s<t?r+s:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this._maps.length+e._maps.length;t>=0;t--){let s=e.getMirror(t);this.appendMap(e._maps[t].invert(),s!=null&&s>t?r-s-1:void 0)}}invert(){let e=new qa;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let s=0;for(let i=this.from;i<this.to;i++){let o=this._maps[i],a=o.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(i);if(l!=null&&l>i&&l<this.to){i=l,e=this._maps[l].recover(a.recover);continue}}s|=a.delInfo,e=a.pos}return r?e:new Pf(e,s,null)}}const ah=Object.create(null);class Ut{getMap(){return un.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=ah[t.stepType];if(!r)throw new RangeError("No step type ".concat(t.stepType," defined"));return r.fromJSON(e,t)}static jsonID(e,t){if(e in ah)throw new RangeError("Duplicate use of step JSON ID "+e);return ah[e]=t,t.prototype.jsonID=e,t}}class bt{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new bt(e,null)}static fail(e){return new bt(null,e)}static fromReplace(e,t,r,s){try{return bt.ok(e.replace(t,r,s))}catch(i){if(i instanceof vu)return bt.fail(i.message);throw i}}}function em(n,e,t){let r=[];for(let s=0;s<n.childCount;s++){let i=n.child(s);i.content.size&&(i=i.copy(em(i.content,e,i))),i.isInline&&(i=e(i,t,s)),r.push(i)}return j.fromArray(r)}class Mr extends Ut{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),s=r.node(r.sharedDepth(this.to)),i=new Q(em(t.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),s),t.openStart,t.openEnd);return bt.fromReplace(e,this.from,this.to,i)}invert(){return new Zn(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Mr(t.pos,r.pos,this.mark)}merge(e){return e instanceof Mr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Mr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Mr(t.from,t.to,e.markFromJSON(t.mark))}}Ut.jsonID("addMark",Mr);class Zn extends Ut{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new Q(em(t.content,s=>s.mark(this.mark.removeFromSet(s.marks)),e),t.openStart,t.openEnd);return bt.fromReplace(e,this.from,this.to,r)}invert(){return new Mr(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Zn(t.pos,r.pos,this.mark)}merge(e){return e instanceof Zn&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Zn(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Zn(t.from,t.to,e.markFromJSON(t.mark))}}Ut.jsonID("removeMark",Zn);class ns extends Ut{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return bt.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return bt.fromReplace(e,this.pos,this.pos+1,new Q(j.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let s=0;s<t.marks.length;s++)if(!t.marks[s].isInSet(r))return new ns(this.pos,t.marks[s]);return new ns(this.pos,this.mark)}}return new yi(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ns(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new ns(t.pos,e.markFromJSON(t.mark))}}Ut.jsonID("addNodeMark",ns);class yi extends Ut{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return bt.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return bt.fromReplace(e,this.pos,this.pos+1,new Q(j.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new ns(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new yi(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new yi(t.pos,e.markFromJSON(t.mark))}}Ut.jsonID("removeNodeMark",yi);class Pt extends Ut{constructor(e,t,r,s=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=s}apply(e){return this.structure&&Rf(e,this.from,this.to)?bt.fail("Structure replace would overwrite content"):bt.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new un([this.from,this.to-this.from,this.slice.size])}invert(e){return new Pt(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new Pt(t.pos,Math.max(t.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Pt)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?Q.empty:new Q(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Pt(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?Q.empty:new Q(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Pt(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Pt(t.from,t.to,Q.fromJSON(e,t.slice),!!t.structure)}}Ut.jsonID("replace",Pt);class Wt extends Ut{constructor(e,t,r,s,i,o,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=s,this.slice=i,this.insert=o,this.structure=a}apply(e){if(this.structure&&(Rf(e,this.from,this.gapFrom)||Rf(e,this.gapTo,this.to)))return bt.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return bt.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?bt.fromReplace(e,this.from,this.to,r):bt.fail("Content does not fit in gap")}getMap(){return new un([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Wt(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),s=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||s<t.pos||i>r.pos?null:new Wt(t.pos,r.pos,s,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Wt(t.from,t.to,t.gapFrom,t.gapTo,Q.fromJSON(e,t.slice),t.insert,!!t.structure)}}Ut.jsonID("replaceAround",Wt);function Rf(n,e,t){let r=n.resolve(e),s=t-e,i=r.depth;for(;s>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,s--;if(s>0){let o=r.node(i).maybeChild(r.indexAfter(i));for(;s>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,s--}}return!1}function ez(n,e,t,r){let s=[],i=[],o,a;n.doc.nodesBetween(e,t,(l,c,u)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let h=Math.max(c,e),f=Math.min(c+l.nodeSize,t),p=r.addToSet(d);for(let m=0;m<d.length;m++)d[m].isInSet(p)||(o&&o.to==h&&o.mark.eq(d[m])?o.to=f:s.push(o=new Zn(h,f,d[m])));a&&a.to==h?a.to=f:i.push(a=new Mr(h,f,r))}}),s.forEach(l=>n.step(l)),i.forEach(l=>n.step(l))}function tz(n,e,t,r){let s=[],i=0;n.doc.nodesBetween(e,t,(o,a)=>{if(!o.isInline)return;i++;let l=null;if(r instanceof sd){let c=o.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(o.marks)&&(l=[r]):l=o.marks;if(l&&l.length){let c=Math.min(a+o.nodeSize,t);for(let u=0;u<l.length;u++){let d=l[u],h;for(let f=0;f<s.length;f++){let p=s[f];p.step==i-1&&d.eq(s[f].style)&&(h=p)}h?(h.to=c,h.step=i):s.push({style:d,from:Math.max(a,e),to:c,step:i})}}}),s.forEach(o=>n.step(new Zn(o.from,o.to,o.style)))}function tm(n,e,t,r=t.contentMatch,s=!0){let i=n.doc.nodeAt(e),o=[],a=e+1;for(let l=0;l<i.childCount;l++){let c=i.child(l),u=a+c.nodeSize,d=r.matchType(c.type);if(!d)o.push(new Pt(a,u,Q.empty));else{r=d;for(let h=0;h<c.marks.length;h++)t.allowsMarkType(c.marks[h].type)||n.step(new Zn(a,u,c.marks[h]));if(s&&c.isText&&t.whitespace!="pre"){let h,f=/\r?\n|\r/g,p;for(;h=f.exec(c.text);)p||(p=new Q(j.from(t.schema.text(" ",t.allowedMarks(c.marks))),0,0)),o.push(new Pt(a+h.index,a+h.index+h[0].length,p))}}a=u}if(!r.validEnd){let l=r.fillBefore(j.empty,!0);n.replace(a,a,new Q(l,0,0))}for(let l=o.length-1;l>=0;l--)n.step(o[l])}function nz(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function id(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let s=n.$from.node(r),i=n.$from.index(r),o=n.$to.indexAfter(r);if(r<n.depth&&s.canReplace(i,o,t))return r;if(r==0||s.type.spec.isolating||!nz(s,i,o))break}return null}function rz(n,e,t){let{$from:r,$to:s,depth:i}=e,o=r.before(i+1),a=s.after(i+1),l=o,c=a,u=j.empty,d=0;for(let p=i,m=!1;p>t;p--)m||r.index(p)>0?(m=!0,u=j.from(r.node(p).copy(u)),d++):l--;let h=j.empty,f=0;for(let p=i,m=!1;p>t;p--)m||s.after(p+1)<s.end(p)?(m=!0,h=j.from(s.node(p).copy(h)),f++):c++;n.step(new Wt(l,c,o,a,new Q(u.append(h),d,f),u.size-d,!0))}function F_(n,e,t=null,r=n){let s=sz(n,e),i=s&&iz(r,e);return i?s.map(p1).concat({type:e,attrs:t}).concat(i.map(p1)):null}function p1(n){return{type:n,attrs:null}}function sz(n,e){let{parent:t,startIndex:r,endIndex:s}=n,i=t.contentMatchAt(r).findWrapping(e);if(!i)return null;let o=i.length?i[0]:e;return t.canReplaceWith(r,s,o)?i:null}function iz(n,e){let{parent:t,startIndex:r,endIndex:s}=n,i=t.child(r),o=e.contentMatch.findWrapping(i.type);if(!o)return null;let l=(o.length?o[o.length-1]:e).contentMatch;for(let c=r;l&&c<s;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:o}function oz(n,e,t){let r=j.empty;for(let o=t.length-1;o>=0;o--){if(r.size){let a=t[o].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=j.from(t[o].type.create(t[o].attrs,r))}let s=e.start,i=e.end;n.step(new Wt(s,i,s,i,new Q(r,0,0),t.length,!0))}function az(n,e,t,r,s){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=n.steps.length;n.doc.nodesBetween(e,t,(o,a)=>{let l=typeof s=="function"?s(o):s;if(o.isTextblock&&!o.hasMarkup(r,l)&&lz(n.doc,n.mapping.slice(i).map(a),r)){let c=null;if(r.schema.linebreakReplacement){let f=r.whitespace=="pre",p=!!r.contentMatch.matchType(r.schema.linebreakReplacement);f&&!p?c=!1:!f&&p&&(c=!0)}c===!1&&H_(n,o,a,i),tm(n,n.mapping.slice(i).map(a,1),r,void 0,c===null);let u=n.mapping.slice(i),d=u.map(a,1),h=u.map(a+o.nodeSize,1);return n.step(new Wt(d,h,d+1,h-1,new Q(j.from(r.create(l,null,o.marks)),0,0),1,!0)),c===!0&&V_(n,o,a,i),!1}})}function V_(n,e,t,r){e.forEach((s,i)=>{if(s.isText){let o,a=/\r?\n|\r/g;for(;o=a.exec(s.text);){let l=n.mapping.slice(r).map(t+1+i+o.index);n.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function H_(n,e,t,r){e.forEach((s,i)=>{if(s.type==s.type.schema.linebreakReplacement){let o=n.mapping.slice(r).map(t+1+i);n.replaceWith(o,o+1,e.type.schema.text("\n"))}})}function lz(n,e,t){let r=n.resolve(e),s=r.index();return r.parent.canReplaceWith(s,s+1,t)}function cz(n,e,t,r,s){let i=n.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");t||(t=i.type);let o=t.create(r,null,s||i.marks);if(i.isLeaf)return n.replaceWith(e,e+i.nodeSize,o);if(!t.validContent(i.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new Wt(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new Q(j.from(o),0,0),1,!0))}function Sa(n,e,t=1,r){let s=n.resolve(e),i=s.depth-t,o=r&&r[r.length-1]||s.parent;if(i<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!o.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let c=s.depth-1,u=t-2;c>i;c--,u--){let d=s.node(c),h=s.index(c);if(d.type.spec.isolating)return!1;let f=d.content.cutByIndex(h,d.childCount),p=r&&r[u+1];p&&(f=f.replaceChild(0,p.type.create(p.attrs)));let m=r&&r[u]||d;if(!d.canReplace(h+1,d.childCount)||!m.type.validContent(f))return!1}let a=s.indexAfter(i),l=r&&r[0];return s.node(i).canReplaceWith(a,a,l?l.type:s.node(i+1).type)}function uz(n,e,t=1,r){let s=n.doc.resolve(e),i=j.empty,o=j.empty;for(let a=s.depth,l=s.depth-t,c=t-1;a>l;a--,c--){i=j.from(s.node(a).copy(i));let u=r&&r[c];o=j.from(u?u.type.create(u.attrs,o):s.node(a).copy(o))}n.step(new Pt(e,e,new Q(i.append(o),t,t),!0))}function od(n,e){let t=n.resolve(e),r=t.index();return hz(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function dz(n,e){e.content.size||n.type.compatibleContent(e.type);let t=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let s=0;s<e.childCount;s++){let i=e.child(s),o=i.type==r?n.type.schema.nodes.text:i.type;if(t=t.matchType(o),!t||!n.type.allowsMarks(i.marks))return!1}return t.validEnd}function hz(n,e){return!!(n&&e&&!n.isLeaf&&dz(n,e))}function fz(n,e,t){let r=null,{linebreakReplacement:s}=n.doc.type.schema,i=n.doc.resolve(e-t),o=i.node().type;if(s&&o.inlineContent){let u=o.whitespace=="pre",d=!!o.contentMatch.matchType(s);u&&!d?r=!1:!u&&d&&(r=!0)}let a=n.steps.length;if(r===!1){let u=n.doc.resolve(e+t);H_(n,u.node(),u.before(),a)}o.inlineContent&&tm(n,e+t-1,o,i.node().contentMatchAt(i.index()),r==null);let l=n.mapping.slice(a),c=l.map(e-t);if(n.step(new Pt(c,l.map(e+t,-1),Q.empty,!0)),r===!0){let u=n.doc.resolve(c);V_(n,u.node(),u.before(),n.steps.length)}return n}function pz(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let s=r.depth-1;s>=0;s--){let i=r.index(s);if(r.node(s).canReplaceWith(i,i,t))return r.before(s+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(let s=r.depth-1;s>=0;s--){let i=r.indexAfter(s);if(r.node(s).canReplaceWith(i,i,t))return r.after(s+1);if(i<r.node(s).childCount)return null}return null}function mz(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let s=t.content;for(let i=0;i<t.openStart;i++)s=s.firstChild.content;for(let i=1;i<=(t.openStart==0&&t.size?2:1);i++)for(let o=r.depth;o>=0;o--){let a=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,l=r.index(o)+(a>0?1:0),c=r.node(o),u=!1;if(i==1)u=c.canReplace(l,l,s);else{let d=c.contentMatchAt(l).findWrapping(s.firstChild.type);u=d&&c.canReplaceWith(l,l,d[0])}if(u)return a==0?r.pos:a<0?r.before(o+1):r.after(o+1)}return null}function nm(n,e,t=e,r=Q.empty){if(e==t&&!r.size)return null;let s=n.resolve(e),i=n.resolve(t);return W_(s,i,r)?new Pt(e,t,r):new gz(s,i,r).fit()}function W_(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class gz{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=j.empty;for(let s=0;s<=e.depth;s++){let i=e.node(s);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(s))})}for(let s=e.depth;s>0;s--)this.placed=j.from(e.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,s=this.close(e<0?this.$to:r.doc.resolve(e));if(!s)return null;let i=this.placed,o=r.depth,a=s.depth;for(;o&&a&&i.childCount==1;)i=i.firstChild.content,o--,a--;let l=new Q(i,o,a);return e>-1?new Wt(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new Pt(r.pos,s.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,s=this.unplaced.openEnd;r<e;r++){let i=t.firstChild;if(t.childCount>1&&(s=0),i.type.spec.isolating&&s<=r){e=r;break}t=i.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let s,i=null;r?(i=lh(this.unplaced.content,r-1).firstChild,s=i.content):s=this.unplaced.content;let o=s.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,d=null;if(t==1&&(o?c.matchType(o.type)||(d=c.fillBefore(j.from(o),!1)):i&&l.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:a,parent:i,inject:d};if(t==2&&o&&(u=c.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:a,parent:i,wrap:u};if(i&&c.matchType(i.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=lh(e,t);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new Q(e,t+1,Math.max(r,s.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=lh(e,t);if(s.childCount<=1&&t>0){let i=e.size-t<=t+s.size;this.unplaced=new Q(Wo(e,t-1,1),t-1,i?t-1:r)}else this.unplaced=new Q(Wo(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:s,wrap:i}){for(;this.depth>t;)this.closeFrontierNode();if(i)for(let m=0;m<i.length;m++)this.openFrontierNode(i[m]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-e,c=0,u=[],{match:d,type:h}=this.frontier[t];if(s){for(let m=0;m<s.childCount;m++)u.push(s.child(m));d=d.matchFragment(s)}let f=a.size+e-(o.content.size-o.openEnd);for(;c<a.childCount;){let m=a.child(c),g=d.matchType(m.type);if(!g)break;c++,(c>1||l==0||m.content.size)&&(d=g,u.push(j_(m.mark(h.allowedMarks(m.marks)),c==1?l:0,c==a.childCount?f:-1)))}let p=c==a.childCount;p||(f=-1),this.placed=jo(this.placed,t,j.from(u)),this.frontier[t].match=d,p&&f<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,g=a;m<f;m++){let b=g.lastChild;this.frontier.push({type:b.type,match:b.contentMatchAt(b.childCount)}),g=b.content}this.unplaced=p?e==0?Q.empty:new Q(Wo(o.content,e-1,1),e-1,f<0?o.openEnd:e-1):new Q(Wo(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!ch(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,s=this.$to.after(r);for(;r>1&&s==this.$to.end(--r);)++s;return s}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:s}=this.frontier[t],i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=ch(e,t,s,r,i);if(o){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=ch(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:o,move:i?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=jo(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let s=e.node(r),i=s.type.contentMatch.fillBefore(s.content,!0,e.index(r));this.openFrontierNode(s.type,s.attrs,i)}return e}openFrontierNode(e,t=null,r){let s=this.frontier[this.depth];s.match=s.match.matchType(e),this.placed=jo(this.placed,this.depth,j.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(j.empty,!0);t.childCount&&(this.placed=jo(this.placed,this.frontier.length,t))}}function Wo(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Wo(n.firstChild.content,e-1,t)))}function jo(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(jo(n.lastChild.content,e-1,t)))}function lh(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function j_(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,j_(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(j.empty,!0)))),n.copy(r)}function ch(n,e,t,r,s){let i=n.node(e),o=s?n.indexAfter(e):n.index(e);if(o==i.childCount&&!t.compatibleContent(i.type))return null;let a=r.fillBefore(i.content,!0,o);return a&&!yz(t,i.content,o)?a:null}function yz(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function vz(n){return n.spec.defining||n.spec.definingForContent}function bz(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let s=n.doc.resolve(e),i=n.doc.resolve(t);if(W_(s,i,r))return n.step(new Pt(e,t,r));let o=q_(s,n.doc.resolve(t));o[o.length-1]==0&&o.pop();let a=-(s.depth+1);o.unshift(a);for(let h=s.depth,f=s.pos-1;h>0;h--,f--){let p=s.node(h).type.spec;if(p.defining||p.definingAsContext||p.isolating)break;o.indexOf(h)>-1?a=h:s.before(h)==f&&o.splice(1,0,-h)}let l=o.indexOf(a),c=[],u=r.openStart;for(let h=r.content,f=0;;f++){let p=h.firstChild;if(c.push(p),f==r.openStart)break;h=p.content}for(let h=u-1;h>=0;h--){let f=c[h],p=vz(f.type);if(p&&!f.sameMarkup(s.node(Math.abs(a)-1)))u=h;else if(p||!f.type.isTextblock)break}for(let h=r.openStart;h>=0;h--){let f=(h+u+1)%(r.openStart+1),p=c[f];if(p)for(let m=0;m<o.length;m++){let g=o[(m+l)%o.length],b=!0;g<0&&(b=!1,g=-g);let _=s.node(g-1),M=s.index(g-1);if(_.canReplaceWith(M,M,p.type,p.marks))return n.replace(s.before(g),b?i.after(g):t,new Q(U_(r.content,0,r.openStart,f),f,r.openEnd))}}let d=n.steps.length;for(let h=o.length-1;h>=0&&(n.replace(e,t,r),!(n.steps.length>d));h--){let f=o[h];f<0||(e=s.before(f),t=i.after(f))}}function U_(n,e,t,r,s){if(e<t){let i=n.firstChild;n=n.replaceChild(0,i.copy(U_(i.content,e+1,t,r,i)))}if(e>r){let i=s.contentMatchAt(0),o=i.fillBefore(n).append(n);n=o.append(i.matchFragment(o).fillBefore(j.empty,!0))}return n}function wz(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let s=pz(n.doc,e,r.type);s!=null&&(e=t=s)}n.replaceRange(e,t,new Q(j.from(r),0,0))}function _z(n,e,t){let r=n.doc.resolve(e),s=n.doc.resolve(t),i=q_(r,s);for(let o=0;o<i.length;o++){let a=i[o],l=o==i.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),s.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),s.indexAfter(a-1))))return n.delete(r.before(a),s.after(a))}for(let o=1;o<=r.depth&&o<=s.depth;o++)if(e-r.start(o)==r.depth-o&&t>r.end(o)&&s.end(o)-t!=s.depth-o&&r.start(o-1)==s.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),s.index(o-1)))return n.delete(r.before(o),t);n.delete(e,t)}function q_(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let s=r;s>=0;s--){let i=n.start(s);if(i<n.pos-(n.depth-s)||e.end(s)>e.pos+(e.depth-s)||n.node(s).type.spec.isolating||e.node(s).type.spec.isolating)break;(i==e.start(s)||s==n.depth&&s==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&s&&e.start(s-1)==i-1)&&t.push(s)}return t}class Ji extends Ut{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return bt.fail("No node at attribute step's position");let r=Object.create(null);for(let i in t.attrs)r[i]=t.attrs[i];r[this.attr]=this.value;let s=t.type.create(r,null,t.marks);return bt.fromReplace(e,this.pos,this.pos+1,new Q(j.from(s),0,t.isLeaf?0:1))}getMap(){return un.empty}invert(e){return new Ji(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ji(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Ji(t.pos,t.attr,t.value)}}Ut.jsonID("attr",Ji);class Ya extends Ut{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let s in e.attrs)t[s]=e.attrs[s];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return bt.ok(r)}getMap(){return un.empty}invert(e){return new Ya(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Ya(t.attr,t.value)}}Ut.jsonID("docAttr",Ya);let uo=class extends Error{};uo=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};uo.prototype=Object.create(Error.prototype);uo.prototype.constructor=uo;uo.prototype.name="TransformError";class Y_{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new qa}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new uo(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=Q.empty){let s=nm(this.doc,e,t,r);return s&&this.step(s),this}replaceWith(e,t,r){return this.replace(e,t,new Q(j.from(r),0,0))}delete(e,t){return this.replace(e,t,Q.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return bz(this,e,t,r),this}replaceRangeWith(e,t,r){return wz(this,e,t,r),this}deleteRange(e,t){return _z(this,e,t),this}lift(e,t){return rz(this,e,t),this}join(e,t=1){return fz(this,e,t),this}wrap(e,t){return oz(this,e,t),this}setBlockType(e,t=e,r,s=null){return az(this,e,t,r,s),this}setNodeMarkup(e,t,r=null,s){return cz(this,e,t,r,s),this}setNodeAttribute(e,t,r){return this.step(new Ji(e,t,r)),this}setDocAttribute(e,t){return this.step(new Ya(e,t)),this}addNodeMark(e,t){return this.step(new ns(e,t)),this}removeNodeMark(e,t){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t instanceof Pe)t.isInSet(r.marks)&&this.step(new yi(e,t));else{let s=r.marks,i,o=[];for(;i=t.isInSet(s);)o.push(new yi(e,i)),s=i.removeFromSet(s);for(let a=o.length-1;a>=0;a--)this.step(o[a])}return this}split(e,t=1,r){return uz(this,e,t,r),this}addMark(e,t,r){return ez(this,e,t,r),this}removeMark(e,t,r){return tz(this,e,t,r),this}clearIncompatible(e,t,r){return tm(this,e,t,r),this}}const uh=Object.create(null);class ge{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new _u(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=Q.empty){let r=t.content.lastChild,s=null;for(let a=0;a<t.openEnd;a++)s=r,r=r.lastChild;let i=e.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:c}=o[a],u=e.mapping.slice(i);e.replaceRange(u.map(l.pos),u.map(c.pos),a?Q.empty:t),a==0&&y1(e,i,(r?r.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,s=this.ranges;for(let i=0;i<s.length;i++){let{$from:o,$to:a}=s[i],l=e.mapping.slice(r),c=l.map(o.pos),u=l.map(a.pos);i?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),y1(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let s=e.parent.inlineContent?new we(e):Ni(e.node(0),e.parent,e.pos,e.index(),t,r);if(s)return s;for(let i=e.depth-1;i>=0;i--){let o=t<0?Ni(e.node(0),e.node(i),e.before(i+1),e.index(i),t,r):Ni(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,t,r);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new pn(e.node(0))}static atStart(e){return Ni(e,e,0,0,1)||new pn(e)}static atEnd(e){return Ni(e,e,e.content.size,e.childCount,-1)||new pn(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=uh[t.type];if(!r)throw new RangeError("No selection type ".concat(t.type," defined"));return r.fromJSON(e,t)}static jsonID(e,t){if(e in uh)throw new RangeError("Duplicate use of selection JSON ID "+e);return uh[e]=t,t.prototype.jsonID=e,t}getBookmark(){return we.between(this.$anchor,this.$head).getBookmark()}}ge.prototype.visible=!0;class _u{constructor(e,t){this.$from=e,this.$to=t}}let m1=!1;function g1(n){!m1&&!n.parent.inlineContent&&(m1=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class we extends ge{constructor(e,t=e){g1(e),g1(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return ge.near(r);let s=e.resolve(t.map(this.anchor));return new we(s.parent.inlineContent?s:r,r)}replace(e,t=Q.empty){if(super.replace(e,t),t==Q.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof we&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new ad(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new we(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let s=e.resolve(t);return new this(s,r==t?s:e.resolve(r))}static between(e,t,r){let s=e.pos-t.pos;if((!r||s)&&(r=s>=0?1:-1),!t.parent.inlineContent){let i=ge.findFrom(t,r,!0)||ge.findFrom(t,-r,!0);if(i)t=i.$head;else return ge.near(t,r)}return e.parent.inlineContent||(s==0?e=t:(e=(ge.findFrom(e,-r,!0)||ge.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=s<0&&(e=t))),new we(e,t)}}ge.jsonID("text",we);class ad{constructor(e,t){this.anchor=e,this.head=t}map(e){return new ad(e.map(this.anchor),e.map(this.head))}resolve(e){return we.between(e.resolve(this.anchor),e.resolve(this.head))}}class pe extends ge{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:s}=t.mapResult(this.anchor),i=e.resolve(s);return r?ge.near(i):new pe(i)}content(){return new Q(j.from(this.node),0,0)}eq(e){return e instanceof pe&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new rm(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new pe(e.resolve(t.anchor))}static create(e,t){return new pe(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}pe.prototype.visible=!1;ge.jsonID("node",pe);class rm{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new ad(r,r):new rm(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&pe.isSelectable(r)?new pe(t):ge.near(t)}}class pn extends ge{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=Q.empty){if(t==Q.empty){e.delete(0,e.doc.content.size);let r=ge.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new pn(e)}map(e){return new pn(e)}eq(e){return e instanceof pn}getBookmark(){return kz}}ge.jsonID("all",pn);const kz={map(){return this},resolve(n){return new pn(n)}};function Ni(n,e,t,r,s,i=!1){if(e.inlineContent)return we.create(n,t);for(let o=r-(s>0?0:1);s>0?o<e.childCount:o>=0;o+=s){let a=e.child(o);if(a.isAtom){if(!i&&pe.isSelectable(a))return pe.create(n,t-(s<0?a.nodeSize:0))}else{let l=Ni(n,a,t+s,s<0?a.childCount:0,s,i);if(l)return l}t+=a.nodeSize*s}return null}function y1(n,e,t){let r=n.steps.length-1;if(r<e)return;let s=n.steps[r];if(!(s instanceof Pt||s instanceof Wt))return;let i=n.mapping.maps[r],o;i.forEach((a,l,c,u)=>{o==null&&(o=u)}),n.setSelection(ge.near(n.doc.resolve(o),t))}const v1=1,Gl=2,b1=4;class xz extends Y_{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|v1)&~Gl,this.storedMarks=null,this}get selectionSet(){return(this.updated&v1)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Gl,this}ensureMarks(e){return Pe.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Gl)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~Gl,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Pe.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let s=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r==null?t:r,!e)return this.deleteRange(t,r);let i=this.storedMarks;if(!i){let o=this.doc.resolve(t);i=r==t?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,s.text(e,i)),this.selection.empty||this.setSelection(ge.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=b1,this}get scrolledIntoView(){return(this.updated&b1)>0}}function w1(n,e){return!e||!n?n:n.bind(e)}class Uo{constructor(e,t,r){this.name=e,this.init=w1(t.init,r),this.apply=w1(t.apply,r)}}const Cz=[new Uo("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Uo("selection",{init(n,e){return n.selection||ge.atStart(e.doc)},apply(n){return n.selection}}),new Uo("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new Uo("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class dh{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Cz.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Uo(r.key,r.spec.state,r))})}}class qi{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let s=this.config.plugins[r];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),s=null;for(;;){let i=!1;for(let o=0;o<this.config.plugins.length;o++){let a=this.config.plugins[o];if(a.spec.appendTransaction){let l=s?s[o].n:0,c=s?s[o].state:this,u=l<t.length&&a.spec.appendTransaction.call(a,l?t.slice(l):t,c,r);if(u&&r.filterTransaction(u,o)){if(u.setMeta("appendedTransaction",e),!s){s=[];for(let d=0;d<this.config.plugins.length;d++)s.push(d<o?{state:r,n:t.length}:{state:this,n:0})}t.push(u),r=r.applyInner(u),i=!0}s&&(s[o]={state:r,n:t.length})}}if(!i)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new qi(this.config),r=this.config.fields;for(let s=0;s<r.length;s++){let i=r[s];t[i.name]=i.apply(e,this[i.name],this,t)}return t}get tr(){return new xz(this)}static create(e){let t=new dh(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new qi(t);for(let s=0;s<t.fields.length;s++)r[t.fields[s].name]=t.fields[s].init(e,r);return r}reconfigure(e){let t=new dh(this.schema,e.plugins),r=t.fields,s=new qi(t);for(let i=0;i<r.length;i++){let o=r[i].name;s[o]=this.hasOwnProperty(o)?this[o]:r[i].init(e,s)}return s}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=e[r],i=s.spec.state;i&&i.toJSON&&(t[r]=i.toJSON.call(s,this[s.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let s=new dh(e.schema,e.plugins),i=new qi(s);return s.fields.forEach(o=>{if(o.name=="doc")i.doc=as.fromJSON(e.schema,t.doc);else if(o.name=="selection")i.selection=ge.fromJSON(i.doc,t.selection);else if(o.name=="storedMarks")t.storedMarks&&(i.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,a)){i[o.name]=c.fromJSON.call(l,e,t[a],i);return}}i[o.name]=o.init(e,i)}}),i}}function K_(n,e,t){for(let r in n){let s=n[r];s instanceof Function?s=s.bind(e):r=="handleDOMEvents"&&(s=K_(s,e,{})),t[r]=s}return t}class Lt{constructor(e){this.spec=e,this.props={},e.props&&K_(e.props,this,this.props),this.key=e.key?e.key.key:G_("plugin")}getState(e){return e[this.key]}}const hh=Object.create(null);function G_(n){return n in hh?n+"$"+ ++hh[n]:(hh[n]=0,n+"$")}class Dt{constructor(e="key"){this.key=G_(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Rt=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},ho=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let Nf=null;const br=function(n,e,t){let r=Nf||(Nf=document.createRange());return r.setEnd(n,t==null?n.nodeValue.length:t),r.setStart(n,e||0),r},Sz=function(){Nf=null},vi=function(n,e,t,r){return t&&(_1(n,e,t,r,-1)||_1(n,e,t,r,1))},Mz=/^(img|br|input|textarea|hr)$/i;function _1(n,e,t,r,s){for(;;){if(n==t&&e==r)return!0;if(e==(s<0?0:_n(n))){let i=n.parentNode;if(!i||i.nodeType!=1||ul(n)||Mz.test(n.nodeName)||n.contentEditable=="false")return!1;e=Rt(n)+(s<0?0:1),n=i}else if(n.nodeType==1){if(n=n.childNodes[e+(s<0?-1:0)],n.contentEditable=="false")return!1;e=s<0?_n(n):0}else return!1}}function _n(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Tz(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=_n(n)}else if(n.parentNode&&!ul(n))e=Rt(n),n=n.parentNode;else return null}}function Oz(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!ul(n))e=Rt(n)+1,n=n.parentNode;else return null}}function Dz(n,e,t){for(let r=e==0,s=e==_n(n);r||s;){if(n==t)return!0;let i=Rt(n);if(n=n.parentNode,!n)return!1;r=r&&i==0,s=s&&i==_n(n)}}function ul(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const ld=function(n){return n.focusNode&&vi(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function Hs(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function $z(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Ez(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:Math.min(_n(r.offsetNode),r.offset)}}catch(r){}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:Math.min(_n(r.startContainer),r.startOffset)}}}const sr=typeof navigator<"u"?navigator:null,k1=typeof document<"u"?document:null,ks=sr&&sr.userAgent||"",If=/Edge\/(\d+)/.exec(ks),J_=/MSIE \d/.exec(ks),Lf=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ks),Qt=!!(J_||Lf||If),ls=J_?document.documentMode:Lf?+Lf[1]:If?+If[1]:0,In=!Qt&&/gecko\/(\d+)/i.test(ks);In&&+(/Firefox\/(\d+)/.exec(ks)||[0,0])[1];const zf=!Qt&&/Chrome\/(\d+)/.exec(ks),Ht=!!zf,X_=zf?+zf[1]:0,qt=!Qt&&!!sr&&/Apple Computer/.test(sr.vendor),fo=qt&&(/Mobile\/\w+/.test(ks)||!!sr&&sr.maxTouchPoints>2),wn=fo||(sr?/Mac/.test(sr.platform):!1),Az=sr?/Win/.test(sr.platform):!1,Tr=/Android \d/.test(ks),dl=!!k1&&"webkitFontSmoothing"in k1.documentElement.style,Pz=dl?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Rz(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function fr(n,e){return typeof n=="number"?n:n[e]}function Nz(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function x1(n,e,t){let r=n.someProp("scrollThreshold")||0,s=n.someProp("scrollMargin")||5,i=n.dom.ownerDocument;for(let o=t||n.dom;o;){if(o.nodeType!=1){o=ho(o);continue}let a=o,l=a==i.body,c=l?Rz(i):Nz(a),u=0,d=0;if(e.top<c.top+fr(r,"top")?d=-(c.top-e.top+fr(s,"top")):e.bottom>c.bottom-fr(r,"bottom")&&(d=e.bottom-e.top>c.bottom-c.top?e.top+fr(s,"top")-c.top:e.bottom-c.bottom+fr(s,"bottom")),e.left<c.left+fr(r,"left")?u=-(c.left-e.left+fr(s,"left")):e.right>c.right-fr(r,"right")&&(u=e.right-c.right+fr(s,"right")),u||d)if(l)i.defaultView.scrollBy(u,d);else{let f=a.scrollLeft,p=a.scrollTop;d&&(a.scrollTop+=d),u&&(a.scrollLeft+=u);let m=a.scrollLeft-f,g=a.scrollTop-p;e={left:e.left-m,top:e.top-g,right:e.right-m,bottom:e.bottom-g}}let h=l?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(h))break;o=h=="absolute"?o.offsetParent:ho(o)}}function Iz(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,s;for(let i=(e.left+e.right)/2,o=t+1;o<Math.min(innerHeight,e.bottom);o+=5){let a=n.root.elementFromPoint(i,o);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=t-20){r=a,s=l.top;break}}return{refDOM:r,refTop:s,stack:Q_(n.dom)}}function Q_(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=ho(r));return e}function Lz({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;Z_(t,r==0?0:r-e)}function Z_(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:s,left:i}=n[t];r.scrollTop!=s+e&&(r.scrollTop=s+e),r.scrollLeft!=i&&(r.scrollLeft=i)}}let Ei=null;function zz(n){if(n.setActive)return n.setActive();if(Ei)return n.focus(Ei);let e=Q_(n);n.focus(Ei==null?{get preventScroll(){return Ei={preventScroll:!0},!0}}:void 0),Ei||(Ei=!1,Z_(e,0))}function ek(n,e){let t,r=2e8,s,i=0,o=e.top,a=e.top,l,c;for(let u=n.firstChild,d=0;u;u=u.nextSibling,d++){let h;if(u.nodeType==1)h=u.getClientRects();else if(u.nodeType==3)h=br(u).getClientRects();else continue;for(let f=0;f<h.length;f++){let p=h[f];if(p.top<=o&&p.bottom>=a){o=Math.max(p.bottom,o),a=Math.min(p.top,a);let m=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(m<r){t=u,r=m,s=m&&t.nodeType==3?{left:p.right<e.left?p.right:p.left,top:e.top}:e,u.nodeType==1&&m&&(i=d+(e.left>=(p.left+p.right)/2?1:0));continue}}else p.top>e.top&&!l&&p.left<=e.left&&p.right>=e.left&&(l=u,c={left:Math.max(p.left,Math.min(p.right,e.left)),top:p.top});!t&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(i=d+1)}}return!t&&l&&(t=l,s=c,r=0),t&&t.nodeType==3?Bz(t,s):!t||r&&t.nodeType==1?{node:n,offset:i}:ek(t,s)}function Bz(n,e){let t=n.nodeValue.length,r=document.createRange();for(let s=0;s<t;s++){r.setEnd(n,s+1),r.setStart(n,s);let i=zr(r,1);if(i.top!=i.bottom&&sm(e,i))return{node:n,offset:s+(e.left>=(i.left+i.right)/2?1:0)}}return{node:n,offset:0}}function sm(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function Fz(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function Vz(n,e,t){let{node:r,offset:s}=ek(e,t),i=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();i=o.left!=o.right&&t.left>(o.left+o.right)/2?1:-1}return n.docView.posFromDOM(r,s,i)}function Hz(n,e,t,r){let s=-1;for(let i=e,o=!1;i!=n.dom;){let a=n.docView.nearestDesc(i,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&(!o&&l.left>r.left||l.top>r.top?s=a.posBefore:(!o&&l.right<r.left||l.bottom<r.top)&&(s=a.posAfter),o=!0),!a.contentDOM&&s<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;i=a.dom.parentNode}return s>-1?s:n.docView.posFromDOM(e,t,-1)}function tk(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let s=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),i=s;;){let o=n.childNodes[i];if(o.nodeType==1){let a=o.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(sm(e,c))return tk(o,e,c)}}if((i=(i+1)%r)==s)break}return n}function Wz(n,e){let t=n.dom.ownerDocument,r,s=0,i=Ez(t,e.left,e.top);i&&({node:r,offset:s}=i);let o=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),a;if(!o||!n.dom.contains(o.nodeType!=1?o.parentNode:o)){let c=n.dom.getBoundingClientRect();if(!sm(e,c)||(o=tk(n.dom,e,c),!o))return null}if(qt)for(let c=o;r&&c;c=ho(c))c.draggable&&(r=void 0);if(o=Fz(o,e),r){if(In&&r.nodeType==1&&(s=Math.min(s,r.childNodes.length),s<r.childNodes.length)){let u=r.childNodes[s],d;u.nodeName=="IMG"&&(d=u.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&s++}let c;dl&&s&&r.nodeType==1&&(c=r.childNodes[s-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&s--,r==n.dom&&s==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(s==0||r.nodeType!=1||r.childNodes[s-1].nodeName!="BR")&&(a=Hz(n,r,s,e))}a==null&&(a=Vz(n,o,e));let l=n.docView.nearestDesc(o,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function C1(n){return n.top<n.bottom||n.left<n.right}function zr(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(C1(r))return r}return Array.prototype.find.call(t,C1)||n.getBoundingClientRect()}const jz=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function nk(n,e,t){let{node:r,offset:s,atom:i}=n.docView.domFromPos(e,t<0?-1:1),o=dl||In;if(r.nodeType==3)if(o&&(jz.test(r.nodeValue)||(t<0?!s:s==r.nodeValue.length))){let l=zr(br(r,s,s),t);if(In&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let c=zr(br(r,s-1,s-1),-1);if(c.top==l.top){let u=zr(br(r,s,s+1),-1);if(u.top!=l.top)return Lo(u,u.left<c.left)}}return l}else{let l=s,c=s,u=t<0?1:-1;return t<0&&!s?(c++,u=-1):t>=0&&s==r.nodeValue.length?(l--,u=1):t<0?l--:c++,Lo(zr(br(r,l,c),u),u<0)}if(!n.state.doc.resolve(e-(i||0)).parent.inlineContent){if(i==null&&s&&(t<0||s==_n(r))){let l=r.childNodes[s-1];if(l.nodeType==1)return fh(l.getBoundingClientRect(),!1)}if(i==null&&s<_n(r)){let l=r.childNodes[s];if(l.nodeType==1)return fh(l.getBoundingClientRect(),!0)}return fh(r.getBoundingClientRect(),t>=0)}if(i==null&&s&&(t<0||s==_n(r))){let l=r.childNodes[s-1],c=l.nodeType==3?br(l,_n(l)-(o?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return Lo(zr(c,1),!1)}if(i==null&&s<_n(r)){let l=r.childNodes[s];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?br(l,0,o?0:1):l.nodeType==1?l:null:null;if(c)return Lo(zr(c,-1),!0)}return Lo(zr(r.nodeType==3?br(r):r,-t),t>=0)}function Lo(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function fh(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function rk(n,e,t){let r=n.state,s=n.root.activeElement;r!=e&&n.updateState(e),s!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),s!=n.dom&&s&&s.focus()}}function Uz(n,e,t){let r=e.selection,s=t=="up"?r.$from:r.$to;return rk(n,e,()=>{let{node:i}=n.docView.domFromPos(s.pos,t=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(i,!0);if(!a)break;if(a.node.isBlock){i=a.contentDOM||a.dom;break}i=a.dom.parentNode}let o=nk(n,s.pos,1);for(let a=i.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=br(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(t=="up"?o.top-u.top>(u.bottom-o.top)*2:u.bottom-o.bottom>(o.bottom-u.top)*2))return!1}}return!0})}const qz=/[\u0590-\u08ac]/;function Yz(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,i=!s,o=s==r.parent.content.size,a=n.domSelection();return a?!qz.test(r.parent.textContent)||!a.modify?t=="left"||t=="backward"?i:o:rk(n,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:d}=n.domSelectionRange(),h=a.caretBidiLevel;a.modify("move",t,"character");let f=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:p,focusOffset:m}=n.domSelectionRange(),g=p&&!f.contains(p.nodeType==1?p:p.parentNode)||l==p&&c==m;try{a.collapse(u,d),l&&(l!=u||c!=d)&&a.extend&&a.extend(l,c)}catch(b){}return h!=null&&(a.caretBidiLevel=h),g}):r.pos==r.start()||r.pos==r.end()}let S1=null,M1=null,T1=!1;function Kz(n,e,t){return S1==e&&M1==t?T1:(S1=e,M1=t,T1=t=="up"||t=="down"?Uz(n,e,t):Yz(n,e,t))}const xn=0,O1=1,Ks=2,ir=3;class hl{constructor(e,t,r,s){this.parent=e,this.children=t,this.dom=r,this.contentDOM=s,this.dirty=xn,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let s=this.children[t];if(s==e)return r;r+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let i,o;if(e==this.contentDOM)i=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.previousSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(o)+o.size:this.posAtStart}else{let i,o;if(e==this.contentDOM)i=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(o):this.posAtEnd}let s;if(e==this.dom&&this.contentDOM)s=t>Rt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!1;break}if(i.previousSibling)break}if(s==null&&t==e.childNodes.length)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!0;break}if(i.nextSibling)break}}return(s==null?r>0:s)?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,s=e;s;s=s.parentNode){let i=this.getDesc(s),o;if(i&&(!t||i.node))if(r&&(o=i.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return i}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let s=e;s;s=s.parentNode){let i=this.getDesc(s);if(i)return i.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let s=this.children[t],i=r+s.size;if(r==e&&i!=r){for(;!s.border&&s.children.length;)for(let o=0;o<s.children.length;o++){let a=s.children[o];if(a.size){s=a;break}}return s}if(e<i)return s.descAt(e-r-s.border);r=i}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,s=0;for(let i=0;r<this.children.length;r++){let o=this.children[r],a=i+o.size;if(a>e||o instanceof ik){s=e-i;break}i=a}if(s)return this.children[r].domFromPos(s-this.children[r].border,t);for(let i;r&&!(i=this.children[r-1]).size&&i instanceof sk&&i.side>=0;r--);if(t<=0){let i,o=!0;for(;i=r?this.children[r-1]:null,!(!i||i.dom.parentNode==this.contentDOM);r--,o=!1);return i&&t&&o&&!i.border&&!i.domAtom?i.domFromPos(i.size,t):{node:this.contentDOM,offset:i?Rt(i.dom)+1:0}}else{let i,o=!0;for(;i=r<this.children.length?this.children[r]:null,!(!i||i.dom.parentNode==this.contentDOM);r++,o=!1);return i&&o&&!i.border&&!i.domAtom?i.domFromPos(0,t):{node:this.contentDOM,offset:i?Rt(i.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,i=-1;for(let o=r,a=0;;a++){let l=this.children[a],c=o+l.size;if(s==-1&&e<=c){let u=o+l.border;if(e>=u&&t<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,t,u);e=o;for(let d=a;d>0;d--){let h=this.children[d-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){s=Rt(h.dom)+1;break}e-=h.size}s==-1&&(s=0)}if(s>-1&&(c>t||a==this.children.length-1)){t=c;for(let u=a+1;u<this.children.length;u++){let d=this.children[u];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){i=Rt(d.dom);break}t+=d.size}i==-1&&(i=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:e,to:t,fromOffset:s,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,s=!1){let i=Math.min(e,t),o=Math.max(e,t);for(let f=0,p=0;f<this.children.length;f++){let m=this.children[f],g=p+m.size;if(i>p&&o<g)return m.setSelection(e-p-m.border,t-p-m.border,r,s);p=g}let a=this.domFromPos(e,e?-1:1),l=t==e?a:this.domFromPos(t,t?-1:1),c=r.root.getSelection(),u=r.domSelectionRange(),d=!1;if((In||qt)&&e==t){let{node:f,offset:p}=a;if(f.nodeType==3){if(d=!!(p&&f.nodeValue[p-1]=="\n"),d&&p==f.nodeValue.length)for(let m=f,g;m;m=m.parentNode){if(g=m.nextSibling){g.nodeName=="BR"&&(a=l={node:g.parentNode,offset:Rt(g)+1});break}let b=m.pmViewDesc;if(b&&b.node&&b.node.isBlock)break}}else{let m=f.childNodes[p-1];d=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(In&&u.focusNode&&u.focusNode!=l.node&&u.focusNode.nodeType==1){let f=u.focusNode.childNodes[u.focusOffset];f&&f.contentEditable=="false"&&(s=!0)}if(!(s||d&&qt)&&vi(a.node,a.offset,u.anchorNode,u.anchorOffset)&&vi(l.node,l.offset,u.focusNode,u.focusOffset))return;let h=!1;if((c.extend||e==t)&&!d){c.collapse(a.node,a.offset);try{e!=t&&c.extend(l.node,l.offset),h=!0}catch(f){}}if(!h){if(e>t){let p=a;a=l,l=p}let f=document.createRange();f.setEnd(l.node,l.offset),f.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(f)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,s=0;s<this.children.length;s++){let i=this.children[s],o=r+i.size;if(r==o?e<=o&&t>=r:e<o&&t>r){let a=r+i.border,l=o-i.border;if(e>=a&&t<=l){this.dirty=e==r||t==o?Ks:O1,e==a&&t==l&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=ir:i.markDirty(e-a,t-a);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?Ks:ir}r=o}this.dirty=Ks}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?Ks:O1;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class sk extends hl{constructor(e,t,r,s){let i,o=t.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!i)return s;if(i.parent)return i.parent.posBeforeChild(i)})),!t.type.spec.raw){if(o.nodeType!=1){let a=document.createElement("span");a.appendChild(o),o=a}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=t,this.widget=t,i=this}matchesWidget(e){return this.dirty==xn&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class Gz extends hl{constructor(e,t,r,s){super(e,[],t,null),this.textDOM=r,this.text=s}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class bi extends hl{constructor(e,t,r,s,i){super(e,[],r,s),this.mark=t,this.spec=i}static create(e,t,r,s){let i=s.nodeViews[t.type.name],o=i&&i(t,s,r);return(!o||!o.dom)&&(o=_o.renderSpec(document,t.type.spec.toDOM(t,r),null,t.attrs)),new bi(e,t,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&ir||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=ir&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=xn){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=xn}}slice(e,t,r){let s=bi.create(this.parent,this.mark,!0,r),i=this.children,o=this.size;t<o&&(i=Ff(i,t,o,r)),e>0&&(i=Ff(i,0,e,r));for(let a=0;a<i.length;a++)i[a].parent=s;return s.children=i,s}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class cs extends hl{constructor(e,t,r,s,i,o,a,l,c){super(e,[],i,o),this.node=t,this.outerDeco=r,this.innerDeco=s,this.nodeDOM=a}static create(e,t,r,s,i,o){let a=i.nodeViews[t.type.name],l,c=a&&a(t,i,()=>{if(!l)return o;if(l.parent)return l.parent.posBeforeChild(l)},r,s),u=c&&c.dom,d=c&&c.contentDOM;if(t.isText){if(!u)u=document.createTextNode(t.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:d}=_o.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!d&&!t.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));let h=u;return u=lk(u,r,t),c?l=new Jz(e,t,r,s,u,d||null,h,c,i,o+1):t.isText?new cd(e,t,r,s,u,h,i):new cs(e,t,r,s,u,d||null,h,i,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>j.empty)}return e}matchesNode(e,t,r){return this.dirty==xn&&e.eq(this.node)&&ku(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,s=t,i=e.composing?this.localCompositionInfo(e,t):null,o=i&&i.pos>-1?i:null,a=i&&i.pos<0,l=new Qz(this,o&&o.node,e);tB(this.node,this.innerDeco,(c,u,d)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!d&&l.syncToMarks(u==this.node.childCount?Pe.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,s)},(c,u,d,h)=>{l.syncToMarks(c.marks,r,e);let f;l.findNodeMatch(c,u,d,h)||a&&e.state.selection.from>s&&e.state.selection.to<s+c.nodeSize&&(f=l.findIndexWithChild(i.node))>-1&&l.updateNodeAt(c,u,d,f,e)||l.updateNextNode(c,u,d,e,h,s)||l.addNode(c,u,d,e,s),s+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Ks)&&(o&&this.protectLocalComposition(e,o),ok(this.contentDOM,this.children,e),fo&&nB(this.dom))}localCompositionInfo(e,t){let{from:r,to:s}=e.state.selection;if(!(e.state.selection instanceof we)||r<t||s>t+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let o=i.nodeValue,a=rB(this.node.content,o,r-t,s-t);return a<0?null:{node:i,pos:a,text:o}}else return{node:i,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:s}){if(this.getDesc(t))return;let i=t;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let o=new Gz(this,i,t,s);e.input.compositionNodes.push(o),this.children=Ff(this.children,r,r+s.length,e,o)}update(e,t,r,s){return this.dirty==ir||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,s),!0)}updateInner(e,t,r,s){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=xn}updateOuterDeco(e){if(ku(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=ak(this.dom,this.nodeDOM,Bf(this.outerDeco,this.node,t),Bf(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function D1(n,e,t,r,s){lk(r,e,n);let i=new cs(void 0,n,e,t,r,r,r,s,0);return i.contentDOM&&i.updateChildren(s,0),i}class cd extends cs{constructor(e,t,r,s,i,o,a){super(e,t,r,s,i,null,o,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,s){return this.dirty==ir||this.dirty!=xn&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=xn||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=e,this.dirty=xn,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let s=this.node.cut(e,t),i=document.createTextNode(s.text);return new cd(this.parent,s,this.outerDeco,this.innerDeco,i,i,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=ir)}get domAtom(){return!1}isText(e){return this.node.text==e}}class ik extends hl{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==xn&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class Jz extends cs{constructor(e,t,r,s,i,o,a,l,c,u){super(e,t,r,s,i,o,a,c,u),this.spec=l}update(e,t,r,s){if(this.dirty==ir)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let i=this.spec.update(e,t,r);return i&&this.updateInner(e,t,r,s),i}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,s){this.spec.setSelection?this.spec.setSelection(e,t,r.root):super.setSelection(e,t,r,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function ok(n,e,t){let r=n.firstChild,s=!1;for(let i=0;i<e.length;i++){let o=e[i],a=o.dom;if(a.parentNode==n){for(;a!=r;)r=$1(r),s=!0;r=r.nextSibling}else s=!0,n.insertBefore(a,r);if(o instanceof bi){let l=r?r.previousSibling:n.lastChild;ok(o.contentDOM,o.children,t),r=l?l.nextSibling:n.firstChild}}for(;r;)r=$1(r),s=!0;s&&t.trackWrites==n&&(t.trackWrites=null)}const Ma=function(n){n&&(this.nodeName=n)};Ma.prototype=Object.create(null);const Gs=[new Ma];function Bf(n,e,t){if(n.length==0)return Gs;let r=t?Gs[0]:new Ma,s=[r];for(let i=0;i<n.length;i++){let o=n[i].type.attrs;if(o){o.nodeName&&s.push(r=new Ma(o.nodeName));for(let a in o){let l=o[a];l!=null&&(t&&s.length==1&&s.push(r=new Ma(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return s}function ak(n,e,t,r){if(t==Gs&&r==Gs)return e;let s=e;for(let i=0;i<r.length;i++){let o=r[i],a=t[i];if(i){let l;a&&a.nodeName==o.nodeName&&s!=n&&(l=s.parentNode)&&l.nodeName.toLowerCase()==o.nodeName||(l=document.createElement(o.nodeName),l.pmIsDeco=!0,l.appendChild(s),a=Gs[0]),s=l}Xz(s,a||Gs[0],o)}return s}function Xz(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],s=t.class?t.class.split(" ").filter(Boolean):[];for(let i=0;i<r.length;i++)s.indexOf(r[i])==-1&&n.classList.remove(r[i]);for(let i=0;i<s.length;i++)r.indexOf(s[i])==-1&&n.classList.add(s[i]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=r.exec(e.style);)n.style.removeProperty(s[1])}t.style&&(n.style.cssText+=t.style)}}function lk(n,e,t){return ak(n,n,Gs,Bf(e,t,n.nodeType!=1))}function ku(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function $1(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class Qz{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=Zz(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let s=0,i=this.stack.length>>1,o=Math.min(i,e.length);for(;s<o&&(s==i-1?this.top:this.stack[s+1<<1]).matchesMark(e[s])&&e[s].type.spec.spanning!==!1;)s++;for(;s<i;)this.destroyRest(),this.top.dirty=xn,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[i])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=bi.create(this.top,e[i],t,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,i++}}findNodeMatch(e,t,r,s){let i=-1,o;if(s>=this.preMatch.index&&(o=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,r))i=this.top.children.indexOf(o,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){i=a;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,r,s,i){let o=this.top.children[s];return o.dirty==ir&&o.dom==o.contentDOM&&(o.dirty=Ks),o.update(e,t,r,i)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==r)return s}return-1}e=t}}updateNextNode(e,t,r,s,i,o){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof cs){let c=this.preMatch.matched.get(l);if(c!=null&&c!=i)return!1;let u=l.dom,d,h=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=ir&&ku(t,l.outerDeco));if(!h&&l.update(e,t,r,s))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!h&&(d=this.recreateWrapper(l,e,t,r,s,o)))return this.destroyBetween(this.index,a),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=Ks,d.updateChildren(s,o+1),d.dirty=xn),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,s,i,o){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!ku(r,e.outerDeco)||!s.eq(e.innerDeco))return null;let a=cs.create(this.top,t,r,s,i,o);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,t,r,s,i){let o=cs.create(this.top,e,t,r,s,i);o.contentDOM&&o.updateChildren(s,i+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,t,r){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(e)&&(e==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let i=new sk(this.top,e,t,r);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof bi;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof cd)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((qt||Ht)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let s=new ik(this.top,[],r,null);t!=this.top?t.children.push(s):t.children.splice(this.index++,0,s),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function Zz(n,e){let t=e,r=t.children.length,s=n.childCount,i=new Map,o=[];e:for(;s>0;){let a;for(;;)if(r){let c=t.children[r-1];if(c instanceof bi)t=c,r=c.children.length;else{a=c,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let l=a.node;if(l){if(l!=n.child(s-1))break;--s,i.set(a,s),o.push(a)}}return{index:s,matched:i,matches:o.reverse()}}function eB(n,e){return n.type.side-e.type.side}function tB(n,e,t,r){let s=e.locals(n),i=0;if(s.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);r(u,s,e.forChild(i,u),c),i+=u.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){let u,d;for(;o<s.length&&s[o].to==i;){let g=s[o++];g.widget&&(u?(d||(d=[u])).push(g):u=g)}if(u)if(d){d.sort(eB);for(let g=0;g<d.length;g++)t(d[g],c,!!l)}else t(u,c,!!l);let h,f;if(l)f=-1,h=l,l=null;else if(c<n.childCount)f=c,h=n.child(c++);else break;for(let g=0;g<a.length;g++)a[g].to<=i&&a.splice(g--,1);for(;o<s.length&&s[o].from<=i&&s[o].to>i;)a.push(s[o++]);let p=i+h.nodeSize;if(h.isText){let g=p;o<s.length&&s[o].from<g&&(g=s[o].from);for(let b=0;b<a.length;b++)a[b].to<g&&(g=a[b].to);g<p&&(l=h.cut(g-i),h=h.cut(0,g-i),p=g,f=-1)}else for(;o<s.length&&s[o].to<p;)o++;let m=h.isInline&&!h.isLeaf?a.filter(g=>!g.inline):a.slice();r(h,m,e.forChild(i,h),f),i=p}}function nB(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function rB(n,e,t,r){for(let s=0,i=0;s<n.childCount&&i<=r;){let o=n.child(s++),a=i;if(i+=o.nodeSize,!o.isText)continue;let l=o.text;for(;s<n.childCount;){let c=n.child(s++);if(i+=c.nodeSize,!c.isText)break;l+=c.text}if(i>=t){if(i>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=t)return a+c;if(t==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function Ff(n,e,t,r,s){let i=[];for(let o=0,a=0;o<n.length;o++){let l=n[o],c=a,u=a+=l.size;c>=t||u<=e?i.push(l):(c<e&&i.push(l.slice(0,e-c,r)),s&&(i.push(s),s=void 0),u>t&&i.push(l.slice(t-c,l.size,r)))}return i}function im(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let s=n.docView.nearestDesc(t.focusNode),i=s&&s.size==0,o=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(o<0)return null;let a=r.resolve(o),l,c;if(ld(t)){for(l=o;s&&!s.node;)s=s.parent;let d=s.node;if(s&&d.isAtom&&pe.isSelectable(d)&&s.parent&&!(d.isInline&&Dz(t.focusNode,t.focusOffset,s.dom))){let h=s.posBefore;c=new pe(o==h?a:r.resolve(h))}}else{if(t instanceof n.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let d=o,h=o;for(let f=0;f<t.rangeCount;f++){let p=t.getRangeAt(f);d=Math.min(d,n.docView.posFromDOM(p.startContainer,p.startOffset,1)),h=Math.max(h,n.docView.posFromDOM(p.endContainer,p.endOffset,-1))}if(d<0)return null;[l,o]=h==n.state.selection.anchor?[h,d]:[d,h],a=r.resolve(o)}else l=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(l<0)return null}let u=r.resolve(l);if(!c){let d=e=="pointer"||n.state.selection.head<a.pos&&!i?1:-1;c=om(n,u,a,d)}return c}function ck(n){return n.editable?n.hasFocus():dk(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Or(n,e=!1){let t=n.state.selection;if(uk(n,t),!!ck(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Ht){let r=n.domSelectionRange(),s=n.domObserver.currentSelection;if(r.anchorNode&&s.anchorNode&&vi(r.anchorNode,r.anchorOffset,s.anchorNode,s.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)iB(n);else{let{anchor:r,head:s}=t,i,o;E1&&!(t instanceof we)&&(t.$from.parent.inlineContent||(i=A1(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(o=A1(n,t.to))),n.docView.setSelection(r,s,n,e),E1&&(i&&P1(i),o&&P1(o)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&sB(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const E1=qt||Ht&&X_<63;function A1(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),s=r<t.childNodes.length?t.childNodes[r]:null,i=r?t.childNodes[r-1]:null;if(qt&&s&&s.contentEditable=="false")return ph(s);if((!s||s.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(s)return ph(s);if(i)return ph(i)}}function ph(n){return n.contentEditable="true",qt&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function P1(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function sB(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,s=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=s)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!ck(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function iB(n){let e=n.domSelection(),t=document.createRange();if(!e)return;let r=n.cursorWrapper.dom,s=r.nodeName=="IMG";s?t.setStart(r.parentNode,Rt(r)+1):t.setStart(r,0),t.collapse(!0),e.removeAllRanges(),e.addRange(t),!s&&!n.state.selection.visible&&Qt&&ls<=11&&(r.disabled=!0,r.disabled=!1)}function uk(n,e){if(e instanceof pe){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(R1(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else R1(n)}function R1(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function om(n,e,t,r){return n.someProp("createSelectionBetween",s=>s(n,e,t))||we.between(e,t,r)}function N1(n){return n.editable&&!n.hasFocus()?!1:dk(n)}function dk(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch(t){return!1}}function oB(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return vi(e.node,e.offset,t.anchorNode,t.anchorOffset)}function Vf(n,e){let{$anchor:t,$head:r}=n.selection,s=e>0?t.max(r):t.min(r),i=s.parent.inlineContent?s.depth?n.doc.resolve(e>0?s.after():s.before()):null:s;return i&&ge.findFrom(i,e)}function qr(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function I1(n,e,t){let r=n.state.selection;if(r instanceof we)if(t.indexOf("s")>-1){let{$head:s}=r,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let o=n.state.doc.resolve(s.pos+i.nodeSize*(e<0?-1:1));return qr(n,new we(r.$anchor,o))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let s=Vf(n.state,e);return s&&s instanceof pe?qr(n,s):!1}else if(!(wn&&t.indexOf("m")>-1)){let s=r.$head,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter,o;if(!i||i.isText)return!1;let a=e<0?s.pos-i.nodeSize:s.pos;return i.isAtom||(o=n.docView.descAt(a))&&!o.contentDOM?pe.isSelectable(i)?qr(n,new pe(e<0?n.state.doc.resolve(s.pos-i.nodeSize):s)):dl?qr(n,new we(n.state.doc.resolve(e<0?a:a+i.nodeSize))):!1:!1}}else return!1;else{if(r instanceof pe&&r.node.isInline)return qr(n,new we(e>0?r.$to:r.$from));{let s=Vf(n.state,e);return s?qr(n,s):!1}}}function xu(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Ta(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function Ai(n,e){return e<0?aB(n):lB(n)}function aB(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s,i,o=!1;for(In&&t.nodeType==1&&r<xu(t)&&Ta(t.childNodes[r],-1)&&(o=!0);;)if(r>0){if(t.nodeType!=1)break;{let a=t.childNodes[r-1];if(Ta(a,-1))s=t,i=--r;else if(a.nodeType==3)t=a,r=t.nodeValue.length;else break}}else{if(hk(t))break;{let a=t.previousSibling;for(;a&&Ta(a,-1);)s=t.parentNode,i=Rt(a),a=a.previousSibling;if(a)t=a,r=xu(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}o?Hf(n,t,r):s&&Hf(n,s,i)}function lB(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s=xu(t),i,o;for(;;)if(r<s){if(t.nodeType!=1)break;let a=t.childNodes[r];if(Ta(a,1))i=t,o=++r;else break}else{if(hk(t))break;{let a=t.nextSibling;for(;a&&Ta(a,1);)i=a.parentNode,o=Rt(a)+1,a=a.nextSibling;if(a)t=a,r=0,s=xu(t);else{if(t=t.parentNode,t==n.dom)break;r=s=0}}}i&&Hf(n,i,o)}function hk(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function cB(n,e){for(;n&&e==n.childNodes.length&&!ul(n);)e=Rt(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function uB(n,e){for(;n&&!e&&!ul(n);)e=Rt(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function Hf(n,e,t){if(e.nodeType!=3){let i,o;(o=cB(e,t))?(e=o,t=0):(i=uB(e,t))&&(e=i,t=i.nodeValue.length)}let r=n.domSelection();if(!r)return;if(ld(r)){let i=document.createRange();i.setEnd(e,t),i.setStart(e,t),r.removeAllRanges(),r.addRange(i)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:s}=n;setTimeout(()=>{n.state==s&&Or(n)},50)}function L1(n,e){let t=n.state.doc.resolve(e);if(!(Ht||Az)&&t.parent.inlineContent){let s=n.coordsAtPos(e);if(e>t.start()){let i=n.coordsAtPos(e-1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left<s.left?"ltr":"rtl"}if(e<t.end()){let i=n.coordsAtPos(e+1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left>s.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function z1(n,e,t){let r=n.state.selection;if(r instanceof we&&!r.empty||t.indexOf("s")>-1||wn&&t.indexOf("m")>-1)return!1;let{$from:s,$to:i}=r;if(!s.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let o=Vf(n.state,e);if(o&&o instanceof pe)return qr(n,o)}if(!s.parent.inlineContent){let o=e<0?s:i,a=r instanceof pn?ge.near(o,e):ge.findFrom(o,e);return a?qr(n,a):!1}return!1}function B1(n,e){if(!(n.state.selection instanceof we))return!0;let{$head:t,$anchor:r,empty:s}=n.state.selection;if(!t.sameParent(r))return!0;if(!s)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(i&&!i.isText){let o=n.state.tr;return e<0?o.delete(t.pos-i.nodeSize,t.pos):o.delete(t.pos,t.pos+i.nodeSize),n.dispatch(o),!0}return!1}function F1(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function dB(n){if(!qt||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;F1(n,r,"true"),setTimeout(()=>F1(n,r,"false"),20)}return!1}function hB(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function fB(n,e){let t=e.keyCode,r=hB(e);if(t==8||wn&&t==72&&r=="c")return B1(n,-1)||Ai(n,-1);if(t==46&&!e.shiftKey||wn&&t==68&&r=="c")return B1(n,1)||Ai(n,1);if(t==13||t==27)return!0;if(t==37||wn&&t==66&&r=="c"){let s=t==37?L1(n,n.state.selection.from)=="ltr"?-1:1:-1;return I1(n,s,r)||Ai(n,s)}else if(t==39||wn&&t==70&&r=="c"){let s=t==39?L1(n,n.state.selection.from)=="ltr"?1:-1:1;return I1(n,s,r)||Ai(n,s)}else{if(t==38||wn&&t==80&&r=="c")return z1(n,-1,r)||Ai(n,-1);if(t==40||wn&&t==78&&r=="c")return dB(n)||z1(n,1,r)||Ai(n,1);if(r==(wn?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function am(n,e){n.someProp("transformCopied",f=>{e=f(e,n)});let t=[],{content:r,openStart:s,openEnd:i}=e;for(;s>1&&i>1&&r.childCount==1&&r.firstChild.childCount==1;){s--,i--;let f=r.firstChild;t.push(f.type.name,f.attrs!=f.type.defaultAttrs?f.attrs:null),r=f.content}let o=n.someProp("clipboardSerializer")||_o.fromSchema(n.state.schema),a=vk(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let c=l.firstChild,u,d=0;for(;c&&c.nodeType==1&&(u=yk[c.nodeName.toLowerCase()]);){for(let f=u.length-1;f>=0;f--){let p=a.createElement(u[f]);for(;l.firstChild;)p.appendChild(l.firstChild);l.appendChild(p),d++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice","".concat(s," ").concat(i).concat(d?" -".concat(d):""," ").concat(JSON.stringify(t)));let h=n.someProp("clipboardTextSerializer",f=>f(e,n))||e.content.textBetween(0,e.content.size,"\n\n");return{dom:l,text:h,slice:e}}function fk(n,e,t,r,s){let i=s.parent.type.spec.code,o,a;if(!t&&!e)return null;let l=e&&(r||i||!t);if(l){if(n.someProp("transformPastedText",h=>{e=h(e,i||r,n)}),i)return e?new Q(j.from(n.state.schema.text(e.replace(/\r\n?/g,"\n"))),0,0):Q.empty;let d=n.someProp("clipboardTextParser",h=>h(e,s,r,n));if(d)a=d;else{let h=s.marks(),{schema:f}=n.state,p=_o.fromSchema(f);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let g=o.appendChild(document.createElement("p"));m&&g.appendChild(p.serializeNode(f.text(m,h)))})}}else n.someProp("transformPastedHTML",d=>{t=d(t,n)}),o=yB(t),dl&&vB(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let h=o.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;o=h}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||co.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(l||u),context:s,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!pB.test(h.parentNode.nodeName)?{ignore:!0}:null}})),u)a=bB(V1(a,+u[1],+u[2]),u[4]);else if(a=Q.maxOpen(mB(a.content,s),!0),a.openStart||a.openEnd){let d=0,h=0;for(let f=a.content.firstChild;d<a.openStart&&!f.type.spec.isolating;d++,f=f.firstChild);for(let f=a.content.lastChild;h<a.openEnd&&!f.type.spec.isolating;h++,f=f.lastChild);a=V1(a,d,h)}return n.someProp("transformPasted",d=>{a=d(a,n)}),a}const pB=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function mB(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let s=e.node(t).contentMatchAt(e.index(t)),i,o=[];if(n.forEach(a=>{if(!o)return;let l=s.findWrapping(a.type),c;if(!l)return o=null;if(c=o.length&&i.length&&mk(l,i,a,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=gk(o[o.length-1],i.length));let u=pk(a,l);o.push(u),s=s.matchType(u.type),i=l}}),o)return j.from(o)}return n}function pk(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,j.from(n));return n}function mk(n,e,t,r,s){if(s<n.length&&s<e.length&&n[s]==e[s]){let i=mk(n,e,t,r.lastChild,s+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(s==n.length-1?t.type:n[s+1]))return r.copy(r.content.append(j.from(pk(t,n,s+1))))}}function gk(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,gk(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(j.empty,!0);return n.copy(t.append(r))}function Wf(n,e,t,r,s,i){let o=e<0?n.firstChild:n.lastChild,a=o.content;return n.childCount>1&&(i=0),s<r-1&&(a=Wf(a,e,t,r,s+1,i)),s>=t&&(a=e<0?o.contentMatchAt(0).fillBefore(a,i<=s).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(j.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,o.copy(a))}function V1(n,e,t){return e<n.openStart&&(n=new Q(Wf(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new Q(Wf(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const yk={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let H1=null;function vk(){return H1||(H1=document.implementation.createHTMLDocument("title"))}let mh=null;function gB(n){let e=window.trustedTypes;return e?(mh||(mh=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),mh.createHTML(n)):n}function yB(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=vk().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),s;if((s=r&&yk[r[1].toLowerCase()])&&(n=s.map(i=>"<"+i+">").join("")+n+s.map(i=>"</"+i+">").reverse().join("")),t.innerHTML=gB(n),s)for(let i=0;i<s.length;i++)t=t.querySelector(s[i])||t;return t}function vB(n){let e=n.querySelectorAll(Ht?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==" "&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function bB(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch(a){return n}let{content:s,openStart:i,openEnd:o}=n;for(let a=r.length-2;a>=0;a-=2){let l=t.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;s=j.from(l.create(r[a+1],s)),i++,o++}return new Q(s,i,o)}const Yt={},Kt={},wB={touchstart:!0,touchmove:!0};class _B{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function kB(n){for(let e in Yt){let t=Yt[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{CB(n,r)&&!lm(n,r)&&(n.editable||!(r.type in Kt))&&t(n,r)},wB[e]?{passive:!0}:void 0)}qt&&n.dom.addEventListener("input",()=>null),jf(n)}function rs(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function xB(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function jf(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>lm(n,r))})}function lm(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function CB(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function SB(n,e){!lm(n,e)&&Yt[e.type]&&(n.editable||!(e.type in Kt))&&Yt[e.type](n,e)}Kt.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!wk(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(Tr&&Ht&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),fo&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",s=>s(n,Hs(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||fB(n,t)?t.preventDefault():rs(n,"key")};Kt.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};Kt.keypress=(n,e)=>{let t=e;if(wk(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||wn&&t.metaKey)return;if(n.someProp("handleKeyPress",s=>s(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof we)||!r.$from.sameParent(r.$to)){let s=String.fromCharCode(t.charCode);!/[\r\n]/.test(s)&&!n.someProp("handleTextInput",i=>i(n,r.$from.pos,r.$to.pos,s))&&n.dispatch(n.state.tr.insertText(s).scrollIntoView()),t.preventDefault()}};function ud(n){return{left:n.clientX,top:n.clientY}}function MB(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function cm(n,e,t,r,s){if(r==-1)return!1;let i=n.state.doc.resolve(r);for(let o=i.depth+1;o>0;o--)if(n.someProp(e,a=>o>i.depth?a(n,t,i.nodeAfter,i.before(o),s,!0):a(n,t,i.node(o),i.before(o),s,!1)))return!0;return!1}function Xi(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let r=n.state.tr.setSelection(e);t=="pointer"&&r.setMeta("pointer",!0),n.dispatch(r)}function TB(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&pe.isSelectable(r)?(Xi(n,new pe(t),"pointer"),!0):!1}function OB(n,e){if(e==-1)return!1;let t=n.state.selection,r,s;t instanceof pe&&(r=t.node);let i=n.state.doc.resolve(e);for(let o=i.depth+1;o>0;o--){let a=o>i.depth?i.nodeAfter:i.node(o);if(pe.isSelectable(a)){r&&t.$from.depth>0&&o>=t.$from.depth&&i.before(t.$from.depth+1)==t.$from.pos?s=i.before(t.$from.depth):s=i.before(o);break}}return s!=null?(Xi(n,pe.create(n.state.doc,s),"pointer"),!0):!1}function DB(n,e,t,r,s){return cm(n,"handleClickOn",e,t,r)||n.someProp("handleClick",i=>i(n,e,r))||(s?OB(n,t):TB(n,t))}function $B(n,e,t,r){return cm(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",s=>s(n,e,r))}function EB(n,e,t,r){return cm(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",s=>s(n,e,r))||AB(n,t,r)}function AB(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(Xi(n,we.create(r,0,r.content.size),"pointer"),!0):!1;let s=r.resolve(e);for(let i=s.depth+1;i>0;i--){let o=i>s.depth?s.nodeAfter:s.node(i),a=s.before(i);if(o.inlineContent)Xi(n,we.create(r,a+1,a+1+o.content.size),"pointer");else if(pe.isSelectable(o))Xi(n,pe.create(r,a),"pointer");else continue;return!0}}function um(n){return Cu(n)}const bk=wn?"metaKey":"ctrlKey";Yt.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=um(n),s=Date.now(),i="singleClick";s-n.input.lastClick.time<500&&MB(t,n.input.lastClick)&&!t[bk]&&(n.input.lastClick.type=="singleClick"?i="doubleClick":n.input.lastClick.type=="doubleClick"&&(i="tripleClick")),n.input.lastClick={time:s,x:t.clientX,y:t.clientY,type:i};let o=n.posAtCoords(ud(t));o&&(i=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new PB(n,o,t,!!r)):(i=="doubleClick"?$B:EB)(n,o.pos,o.inside,t)?t.preventDefault():rs(n,"pointer"))};class PB{constructor(e,t,r,s){this.view=e,this.pos=t,this.event=r,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[bk],this.allowDefault=r.shiftKey;let i,o;if(t.inside>-1)i=e.state.doc.nodeAt(t.inside),o=t.inside;else{let u=e.state.doc.resolve(t.pos);i=u.parent,o=u.depth?u.before():0}const a=s?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.dom.nodeType==1?l.dom:null;let{selection:c}=e.state;(r.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||c instanceof pe&&c.from<=o&&c.to>o)&&(this.mightDrag={node:i,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&In&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),rs(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Or(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(ud(e))),this.updateAllowDefault(e),this.allowDefault||!t?rs(this.view,"pointer"):DB(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||qt&&this.mightDrag&&!this.mightDrag.node.isAtom||Ht&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Xi(this.view,ge.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):rs(this.view,"pointer")}move(e){this.updateAllowDefault(e),rs(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Yt.touchstart=n=>{n.input.lastTouch=Date.now(),um(n),rs(n,"pointer")};Yt.touchmove=n=>{n.input.lastTouch=Date.now(),rs(n,"pointer")};Yt.contextmenu=n=>um(n);function wk(n,e){return n.composing?!0:qt&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const RB=Tr?5e3:-1;Kt.compositionstart=Kt.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof we&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),Cu(n,!0),n.markCursor=null;else if(Cu(n,!e.selection.empty),In&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let s=r.focusNode,i=r.focusOffset;s&&s.nodeType==1&&i!=0;){let o=i<0?s.lastChild:s.childNodes[i-1];if(!o)break;if(o.nodeType==3){let a=n.domSelection();a&&a.collapse(o,o.nodeValue.length);break}else s=o,i=-1}}n.input.composing=!0}_k(n,RB)};Kt.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,_k(n,20))};function _k(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>Cu(n),e))}function kk(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=IB());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function NB(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=Tz(e.focusNode,e.focusOffset),r=Oz(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let s=r.pmViewDesc,i=n.domObserver.lastChangedTextNode;if(t==i||r==i)return i;if(!s||!s.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let o=t.pmViewDesc;if(!(!o||!o.isText(t.nodeValue)))return r}}return t||r}function IB(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Cu(n,e=!1){if(!(Tr&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),kk(n),e||n.docView&&n.docView.dirty){let t=im(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!n.state.selection.empty?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function LB(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const Ka=Qt&&ls<15||fo&&Pz<604;Yt.copy=Kt.cut=(n,e)=>{let t=e,r=n.state.selection,s=t.type=="cut";if(r.empty)return;let i=Ka?null:t.clipboardData,o=r.content(),{dom:a,text:l}=am(n,o);i?(t.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",l)):LB(n,a),s&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function zB(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function BB(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let s=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?Ga(n,r.value,null,s,e):Ga(n,r.textContent,r.innerHTML,s,e)},50)}function Ga(n,e,t,r,s){let i=fk(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,s,i||Q.empty)))return!0;if(!i)return!1;let o=zB(i),a=o?n.state.tr.replaceSelectionWith(o,r):n.state.tr.replaceSelection(i);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function xk(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}Kt.paste=(n,e)=>{let t=e;if(n.composing&&!Tr)return;let r=Ka?null:t.clipboardData,s=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&Ga(n,xk(r),r.getData("text/html"),s,t)?t.preventDefault():BB(n,t)};class Ck{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const FB=wn?"altKey":"ctrlKey";function Sk(n,e){let t=n.someProp("dragCopies",r=>!r(e));return t!=null?t:!e[FB]}Yt.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let s=n.state.selection,i=s.empty?null:n.posAtCoords(ud(t)),o;if(!(i&&i.pos>=s.from&&i.pos<=(s instanceof pe?s.to-1:s.to))){if(r&&r.mightDrag)o=pe.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let d=n.docView.nearestDesc(t.target,!0);d&&d.node.type.spec.draggable&&d!=n.docView&&(o=pe.create(n.state.doc,d.posBefore))}}let a=(o||n.state.selection).content(),{dom:l,text:c,slice:u}=am(n,a);(!t.dataTransfer.files.length||!Ht||X_>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(Ka?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",Ka||t.dataTransfer.setData("text/plain",c),n.dragging=new Ck(u,Sk(n,t),o)};Yt.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};Kt.dragover=Kt.dragenter=(n,e)=>e.preventDefault();Kt.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let s=n.posAtCoords(ud(t));if(!s)return;let i=n.state.doc.resolve(s.pos),o=r&&r.slice;o?n.someProp("transformPasted",p=>{o=p(o,n)}):o=fk(n,xk(t.dataTransfer),Ka?null:t.dataTransfer.getData("text/html"),!1,i);let a=!!(r&&Sk(n,t));if(n.someProp("handleDrop",p=>p(n,t,o||Q.empty,a))){t.preventDefault();return}if(!o)return;t.preventDefault();let l=o?mz(n.state.doc,i.pos,o):i.pos;l==null&&(l=i.pos);let c=n.state.tr;if(a){let{node:p}=r;p?p.replace(c):c.deleteSelection()}let u=c.mapping.map(l),d=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,h=c.doc;if(d?c.replaceRangeWith(u,u,o.content.firstChild):c.replaceRange(u,u,o),c.doc.eq(h))return;let f=c.doc.resolve(u);if(d&&pe.isSelectable(o.content.firstChild)&&f.nodeAfter&&f.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new pe(f));else{let p=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((m,g,b,_)=>p=_),c.setSelection(om(n,f,c.doc.resolve(p)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};Yt.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&Or(n)},20))};Yt.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Yt.beforeinput=(n,e)=>{if(Ht&&Tr&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",i=>i(n,Hs(8,"Backspace")))))return;let{$cursor:s}=n.state.selection;s&&s.pos>0&&n.dispatch(n.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let n in Kt)Yt[n]=Kt[n];function Ja(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class Su{constructor(e,t){this.toDOM=e,this.spec=t||ti,this.side=this.spec.side||0}map(e,t,r,s){let{pos:i,deleted:o}=e.mapResult(t.from+s,this.side<0?-1:1);return o?null:new Tt(i-r,i-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Su&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Ja(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class us{constructor(e,t){this.attrs=e,this.spec=t||ti}map(e,t,r,s){let i=e.map(t.from+s,this.spec.inclusiveStart?-1:1)-r,o=e.map(t.to+s,this.spec.inclusiveEnd?1:-1)-r;return i>=o?null:new Tt(i,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof us&&Ja(this.attrs,e.attrs)&&Ja(this.spec,e.spec)}static is(e){return e.type instanceof us}destroy(){}}class dm{constructor(e,t){this.attrs=e,this.spec=t||ti}map(e,t,r,s){let i=e.mapResult(t.from+s,1);if(i.deleted)return null;let o=e.mapResult(t.to+s,-1);return o.deleted||o.pos<=i.pos?null:new Tt(i.pos-r,o.pos-r,this)}valid(e,t){let{index:r,offset:s}=e.content.findIndex(t.from),i;return s==t.from&&!(i=e.child(r)).isText&&s+i.nodeSize==t.to}eq(e){return this==e||e instanceof dm&&Ja(this.attrs,e.attrs)&&Ja(this.spec,e.spec)}destroy(){}}class Tt{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new Tt(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new Tt(e,e,new Su(t,r))}static inline(e,t,r,s){return new Tt(e,t,new us(r,s))}static node(e,t,r,s){return new Tt(e,t,new dm(r,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof us}get widget(){return this.type instanceof Su}}const Ii=[],ti={};class Ue{constructor(e,t){this.local=e.length?e:Ii,this.children=t.length?t:Ii}static create(e,t){return t.length?Mu(t,e,0,ti):Ft}find(e,t,r){let s=[];return this.findInner(e==null?0:e,t==null?1e9:t,s,0,r),s}findInner(e,t,r,s,i){for(let o=0;o<this.local.length;o++){let a=this.local[o];a.from<=t&&a.to>=e&&(!i||i(a.spec))&&r.push(a.copy(a.from+s,a.to+s))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let a=this.children[o]+1;this.children[o+2].findInner(e-a,t-a,r,s+a,i)}}map(e,t,r){return this==Ft||e.maps.length==0?this:this.mapInner(e,t,0,0,r||ti)}mapInner(e,t,r,s,i){let o;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,s);l&&l.type.valid(t,l)?(o||(o=[])).push(l):i.onRemove&&i.onRemove(this.local[a].spec)}return this.children.length?VB(this.children,o||[],e,t,r,s,i):o?new Ue(o.sort(ni),Ii):Ft}add(e,t){return t.length?this==Ft?Ue.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let s,i=0;e.forEach((a,l)=>{let c=l+r,u;if(u=Tk(t,a,c)){for(s||(s=this.children.slice());i<s.length&&s[i]<l;)i+=3;s[i]==l?s[i+2]=s[i+2].addInner(a,u,c+1):s.splice(i,0,l,l+a.nodeSize,Mu(u,a,c+1,ti)),i+=3}});let o=Mk(i?Ok(t):t,-r);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||o.splice(a--,1);return new Ue(o.length?this.local.concat(o).sort(ni):this.local,s||this.children)}remove(e){return e.length==0||this==Ft?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,s=this.local;for(let i=0;i<r.length;i+=3){let o,a=r[i]+t,l=r[i+1]+t;for(let u=0,d;u<e.length;u++)(d=e[u])&&d.from>a&&d.to<l&&(e[u]=null,(o||(o=[])).push(d));if(!o)continue;r==this.children&&(r=this.children.slice());let c=r[i+2].removeInner(o,a+1);c!=Ft?r[i+2]=c:(r.splice(i,3),i-=3)}if(s.length){for(let i=0,o;i<e.length;i++)if(o=e[i])for(let a=0;a<s.length;a++)s[a].eq(o,t)&&(s==this.local&&(s=this.local.slice()),s.splice(a--,1))}return r==this.children&&s==this.local?this:s.length||r.length?new Ue(s,r):Ft}forChild(e,t){if(this==Ft)return this;if(t.isLeaf)return Ue.empty;let r,s;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let i=e+1,o=i+t.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<o&&l.to>i&&l.type instanceof us){let c=Math.max(i,l.from)-i,u=Math.min(o,l.to)-i;c<u&&(s||(s=[])).push(l.copy(c,u))}}if(s){let a=new Ue(s.sort(ni),Ii);return r?new Gr([a,r]):a}return r||Ft}eq(e){if(this==e)return!0;if(!(e instanceof Ue)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return hm(this.localsInner(e))}localsInner(e){if(this==Ft)return Ii;if(e.inlineContent||!this.local.some(us.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof us||t.push(this.local[r]);return t}forEachSet(e){e(this)}}Ue.empty=new Ue([],[]);Ue.removeOverlap=hm;const Ft=Ue.empty;class Gr{constructor(e){this.members=e}map(e,t){const r=this.members.map(s=>s.map(e,t,ti));return Gr.from(r)}forChild(e,t){if(t.isLeaf)return Ue.empty;let r=[];for(let s=0;s<this.members.length;s++){let i=this.members[s].forChild(e,t);i!=Ft&&(i instanceof Gr?r=r.concat(i.members):r.push(i))}return Gr.from(r)}eq(e){if(!(e instanceof Gr)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let s=0;s<this.members.length;s++){let i=this.members[s].localsInner(e);if(i.length)if(!t)t=i;else{r&&(t=t.slice(),r=!1);for(let o=0;o<i.length;o++)t.push(i[o])}}return t?hm(r?t:t.sort(ni)):Ii}static from(e){switch(e.length){case 0:return Ft;case 1:return e[0];default:return new Gr(e.every(t=>t instanceof Ue)?e:e.reduce((t,r)=>t.concat(r instanceof Ue?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function VB(n,e,t,r,s,i,o){let a=n.slice();for(let c=0,u=i;c<t.maps.length;c++){let d=0;t.maps[c].forEach((h,f,p,m)=>{let g=m-p-(f-h);for(let b=0;b<a.length;b+=3){let _=a[b+1];if(_<0||h>_+u-d)continue;let M=a[b]+u-d;f>=M?a[b+1]=h<=M?-2:-1:h>=u&&g&&(a[b]+=g,a[b+1]+=g)}d+=g}),u=t.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=t.map(n[c]+i),d=u-s;if(d<0||d>=r.content.size){l=!0;continue}let h=t.map(n[c+1]+i,-1),f=h-s,{index:p,offset:m}=r.content.findIndex(d),g=r.maybeChild(p);if(g&&m==d&&m+g.nodeSize==f){let b=a[c+2].mapInner(t,g,u+1,n[c]+i+1,o);b!=Ft?(a[c]=d,a[c+1]=f,a[c+2]=b):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=HB(a,n,e,t,s,i,o),u=Mu(c,r,0,o);e=u.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,h=0;d<u.children.length;d+=3){let f=u.children[d];for(;h<a.length&&a[h]<f;)h+=3;a.splice(h,0,u.children[d],u.children[d+1],u.children[d+2])}}return new Ue(e.sort(ni),a)}function Mk(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let s=n[r];t.push(new Tt(s.from+e,s.to+e,s.type))}return t}function HB(n,e,t,r,s,i,o){function a(l,c){for(let u=0;u<l.local.length;u++){let d=l.local[u].map(r,s,c);d?t.push(d):o.onRemove&&o.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],e[l]+i+1);return t}function Tk(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,s=null;for(let i=0,o;i<n.length;i++)(o=n[i])&&o.from>t&&o.to<r&&((s||(s=[])).push(o),n[i]=null);return s}function Ok(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function Mu(n,e,t,r){let s=[],i=!1;e.forEach((a,l)=>{let c=Tk(n,a,l+t);if(c){i=!0;let u=Mu(c,a,t+l+1,r);u!=Ft&&s.push(l,l+a.nodeSize,u)}});let o=Mk(i?Ok(n):n,-t).sort(ni);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||(r.onRemove&&r.onRemove(o[a].spec),o.splice(a--,1));return o.length||s.length?new Ue(o,s):Ft}function ni(n,e){return n.from-e.from||n.to-e.to}function hm(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let s=t+1;s<e.length;s++){let i=e[s];if(i.from==r.from){i.to!=r.to&&(e==n&&(e=n.slice()),e[s]=i.copy(i.from,r.to),W1(e,s+1,i.copy(r.to,i.to)));continue}else{i.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,i.from),W1(e,s,r.copy(i.from,r.to)));break}}}return e}function W1(n,e,t){for(;e<n.length&&ni(t,n[e])>0;)e++;n.splice(e,0,t)}function gh(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=Ft&&e.push(r)}),n.cursorWrapper&&e.push(Ue.create(n.state.doc,[n.cursorWrapper.deco])),Gr.from(e)}const WB={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},jB=Qt&&ls<=11;class UB{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class qB{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new UB,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let s=0;s<r.length;s++)this.queue.push(r[s]);Qt&&ls<=11&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),jB&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,WB)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(N1(this.view)){if(this.suppressingSelectionUpdates)return Or(this.view);if(Qt&&ls<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&vi(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let i=e.focusNode;i;i=ho(i))t.add(i);for(let i=e.anchorNode;i;i=ho(i))if(t.has(i)){r=i;break}let s=r&&this.view.docView.nearestDesc(r);if(s&&s.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&N1(e)&&!this.ignoreSelectionChange(r),i=-1,o=-1,a=!1,l=[];if(e.editable)for(let u=0;u<t.length;u++){let d=this.registerMutation(t[u],l);d&&(i=i<0?d.from:Math.min(d.from,i),o=o<0?d.to:Math.max(d.to,o),d.typeOver&&(a=!0))}if(In&&l.length){let u=l.filter(d=>d.nodeName=="BR");if(u.length==2){let[d,h]=u;d.parentNode&&d.parentNode.parentNode==h.parentNode?h.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let h of u){let f=h.parentNode;f&&f.nodeName=="LI"&&(!d||GB(e,d)!=f)&&h.remove()}}}let c=null;i<0&&s&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&ld(r)&&(c=im(e))&&c.eq(ge.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Or(e),this.currentSelection.set(r),e.scrollToSelection()):(i>-1||s)&&(i>-1&&(e.docView.markDirty(i,o),YB(e)),this.handleDOMChange(i,o,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Or(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let d=e.addedNodes[u];t.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let s=e.previousSibling,i=e.nextSibling;if(Qt&&ls<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:d,nextSibling:h}=e.addedNodes[u];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(s=d),(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(i=h)}let o=s&&s.parentNode==e.target?Rt(s)+1:0,a=r.localPosFromDOM(e.target,o,-1),l=i&&i.parentNode==e.target?Rt(i):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let j1=new WeakMap,U1=!1;function YB(n){if(!j1.has(n)&&(j1.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=In,U1)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),U1=!0}}function q1(n,e){let t=e.startContainer,r=e.startOffset,s=e.endContainer,i=e.endOffset,o=n.domAtPos(n.state.selection.anchor);return vi(o.node,o.offset,s,i)&&([t,r,s,i]=[s,i,t,r]),{anchorNode:t,anchorOffset:r,focusNode:s,focusOffset:i}}function KB(n,e){if(e.getComposedRanges){let s=e.getComposedRanges(n.root)[0];if(s)return q1(n,s)}let t;function r(s){s.preventDefault(),s.stopImmediatePropagation(),t=s.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),t?q1(n,t):null}function GB(n,e){for(let t=e.parentNode;t&&t!=n.dom;t=t.parentNode){let r=n.docView.nearestDesc(t,!0);if(r&&r.node.isBlock)return t}return null}function JB(n,e,t){let{node:r,fromOffset:s,toOffset:i,from:o,to:a}=n.docView.parseRange(e,t),l=n.domSelectionRange(),c,u=l.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],ld(l)||c.push({node:l.focusNode,offset:l.focusOffset})),Ht&&n.input.lastKeyCode===8)for(let g=i;g>s;g--){let b=r.childNodes[g-1],_=b.pmViewDesc;if(b.nodeName=="BR"&&!_){i=g;break}if(!_||_.size)break}let d=n.state.doc,h=n.someProp("domParser")||co.fromSchema(n.state.schema),f=d.resolve(o),p=null,m=h.parse(r,{topNode:f.parent,topMatch:f.parent.contentMatchAt(f.index()),topOpen:!0,from:s,to:i,preserveWhitespace:f.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:XB,context:f});if(c&&c[0].pos!=null){let g=c[0].pos,b=c[1]&&c[1].pos;b==null&&(b=g),p={anchor:g+o,head:b+o}}return{doc:m,sel:p,from:o,to:a}}function XB(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(qt&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||qt&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const QB=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function ZB(n,e,t,r,s){let i=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let E=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,R=im(n,E);if(R&&!n.state.selection.eq(R)){if(Ht&&Tr&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",K=>K(n,Hs(13,"Enter"))))return;let W=n.state.tr.setSelection(R);E=="pointer"?W.setMeta("pointer",!0):E=="key"&&W.scrollIntoView(),i&&W.setMeta("composition",i),n.dispatch(W)}return}let o=n.state.doc.resolve(e),a=o.sharedDepth(t);e=o.before(a+1),t=n.state.doc.resolve(t).after(a+1);let l=n.state.selection,c=JB(n,e,t),u=n.state.doc,d=u.slice(c.from,c.to),h,f;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(h=n.state.selection.to,f="end"):(h=n.state.selection.from,f="start"),n.input.lastKeyCode=null;let p=nF(d.content,c.doc.content,c.from,h,f);if(p&&n.input.domChangeCount++,(fo&&n.input.lastIOSEnter>Date.now()-225||Tr)&&s.some(E=>E.nodeType==1&&!QB.test(E.nodeName))&&(!p||p.endA>=p.endB)&&n.someProp("handleKeyDown",E=>E(n,Hs(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!p)if(r&&l instanceof we&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))p={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let E=Y1(n,n.state.doc,c.sel);if(E&&!E.eq(n.state.selection)){let R=n.state.tr.setSelection(E);i&&R.setMeta("composition",i),n.dispatch(R)}}return}n.state.selection.from<n.state.selection.to&&p.start==p.endB&&n.state.selection instanceof we&&(p.start>n.state.selection.from&&p.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?p.start=n.state.selection.from:p.endA<n.state.selection.to&&p.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(p.endB+=n.state.selection.to-p.endA,p.endA=n.state.selection.to)),Qt&&ls<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>c.from&&c.doc.textBetween(p.start-c.from-1,p.start-c.from+1)=="  "&&(p.start--,p.endA--,p.endB--);let m=c.doc.resolveNoCache(p.start-c.from),g=c.doc.resolveNoCache(p.endB-c.from),b=u.resolve(p.start),_=m.sameParent(g)&&m.parent.inlineContent&&b.end()>=p.endA,M;if((fo&&n.input.lastIOSEnter>Date.now()-225&&(!_||s.some(E=>E.nodeName=="DIV"||E.nodeName=="P"))||!_&&m.pos<c.doc.content.size&&(!m.sameParent(g)||!m.parent.inlineContent)&&!/\S/.test(c.doc.textBetween(m.pos,g.pos,"",""))&&(M=ge.findFrom(c.doc.resolve(m.pos+1),1,!0))&&M.head>m.pos)&&n.someProp("handleKeyDown",E=>E(n,Hs(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>p.start&&tF(u,p.start,p.endA,m,g)&&n.someProp("handleKeyDown",E=>E(n,Hs(8,"Backspace")))){Tr&&Ht&&n.domObserver.suppressSelectionUpdates();return}Ht&&p.endB==p.start&&(n.input.lastChromeDelete=Date.now()),Tr&&!_&&m.start()!=g.start()&&g.parentOffset==0&&m.depth==g.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==p.endA&&(p.endB-=2,g=c.doc.resolveNoCache(p.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(E){return E(n,Hs(13,"Enter"))})},20));let k=p.start,C=p.endA,x,D,O;if(_){if(m.pos==g.pos)Qt&&ls<=11&&m.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>Or(n),20)),x=n.state.tr.delete(k,C),D=u.resolve(p.start).marksAcross(u.resolve(p.endA));else if(p.endA==p.endB&&(O=eF(m.parent.content.cut(m.parentOffset,g.parentOffset),b.parent.content.cut(b.parentOffset,p.endA-b.start()))))x=n.state.tr,O.type=="add"?x.addMark(k,C,O.mark):x.removeMark(k,C,O.mark);else if(m.parent.child(m.index()).isText&&m.index()==g.index()-(g.textOffset?0:1)){let E=m.parent.textBetween(m.parentOffset,g.parentOffset);if(n.someProp("handleTextInput",R=>R(n,k,C,E)))return;x=n.state.tr.insertText(E,k,C)}}if(x||(x=n.state.tr.replace(k,C,c.doc.slice(p.start-c.from,p.endB-c.from))),c.sel){let E=Y1(n,x.doc,c.sel);E&&!(Ht&&n.composing&&E.empty&&(p.start!=p.endB||n.input.lastChromeDelete<Date.now()-100)&&(E.head==k||E.head==x.mapping.map(C)-1)||Qt&&E.empty&&E.head==k)&&x.setSelection(E)}D&&x.ensureMarks(D),i&&x.setMeta("composition",i),n.dispatch(x.scrollIntoView())}function Y1(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:om(n,e.resolve(t.anchor),e.resolve(t.head))}function eF(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,s=t,i=r,o,a,l;for(let u=0;u<r.length;u++)s=r[u].removeFromSet(s);for(let u=0;u<t.length;u++)i=t[u].removeFromSet(i);if(s.length==1&&i.length==0)a=s[0],o="add",l=u=>u.mark(a.addToSet(u.marks));else if(s.length==0&&i.length==1)a=i[0],o="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(j.from(c).eq(n))return{mark:a,type:o}}function tF(n,e,t,r,s){if(t-e<=s.pos-r.pos||yh(r,!0,!1)<s.pos)return!1;let i=n.resolve(e);if(!r.parent.isTextblock){let a=i.nodeAfter;return a!=null&&t==e+a.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let o=n.resolve(yh(i,!0,!0));return!o.parent.isTextblock||o.pos>t||yh(o,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function yh(n,e,t){let r=n.depth,s=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,s++,e=!1;if(t){let i=n.node(r).maybeChild(n.indexAfter(r));for(;i&&!i.isLeaf;)i=i.firstChild,s++}return s}function nF(n,e,t,r,s){let i=n.findDiffStart(e,t);if(i==null)return null;let{a:o,b:a}=n.findDiffEnd(e,t+n.size,t+e.size);if(s=="end"){let l=Math.max(0,i-Math.min(o,a));r-=o+l-i}if(o<i&&n.size<e.size){let l=r<=i&&r>=o?i-r:0;i-=l,i&&i<e.size&&K1(e.textBetween(i-1,i+1))&&(i+=l?1:-1),a=i+(a-o),o=i}else if(a<i){let l=r<=i&&r>=a?i-r:0;i-=l,i&&i<n.size&&K1(n.textBetween(i-1,i+1))&&(i+=l?1:-1),o=i+(o-a),a=i}return{start:i,endA:o,endB:a}}function K1(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class rF{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new _B,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(Z1),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=X1(this),J1(this),this.nodeViews=Q1(this),this.docView=D1(this.state.doc,G1(this),gh(this),this.dom,this),this.domObserver=new qB(this,(r,s,i,o)=>ZB(this,r,s,i,o)),this.domObserver.start(),kB(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&jf(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Z1),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let s=this.state,i=!1,o=!1;e.storedMarks&&this.composing&&(kk(this),o=!0),this.state=e;let a=s.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let f=Q1(this);iF(f,this.nodeViews)&&(this.nodeViews=f,i=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&jf(this),this.editable=X1(this),J1(this);let l=gh(this),c=G1(this),u=s.plugins!=e.plugins&&!s.doc.eq(e.doc)?"reset":e.scrollToSelection>s.scrollToSelection?"to selection":"preserve",d=i||!this.docView.matchesNode(e.doc,c,l);(d||!e.selection.eq(s.selection))&&(o=!0);let h=u=="preserve"&&o&&this.dom.style.overflowAnchor==null&&Iz(this);if(o){this.domObserver.stop();let f=d&&(Qt||Ht)&&!this.composing&&!s.selection.empty&&!e.selection.empty&&sF(s.selection,e.selection);if(d){let p=Ht?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=NB(this)),(i||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=D1(e.doc,c,l,this.dom,this)),p&&!this.trackWrites&&(f=!0)}f||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&oB(this))?Or(this,f):(uk(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((r=this.dragging)===null||r===void 0)&&r.node&&!s.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,s),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():h&&Lz(h)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof pe){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&x1(this,t.getBoundingClientRect(),e)}else x1(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,s=-1;if(this.state.doc.nodeAt(r.from)==r.node)s=r.from;else{let i=r.from+(this.state.doc.content.size-t.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==r.node&&(s=i)}this.dragging=new Ck(e.slice,e.move,s<0?void 0:pe.create(this.state.doc,s))}someProp(e,t){let r=this._props&&this._props[e],s;if(r!=null&&(s=t?t(r):r))return s;for(let o=0;o<this.directPlugins.length;o++){let a=this.directPlugins[o].props[e];if(a!=null&&(s=t?t(a):a))return s}let i=this.state.plugins;if(i)for(let o=0;o<i.length;o++){let a=i[o].props[e];if(a!=null&&(s=t?t(a):a))return s}}hasFocus(){if(Qt){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&zz(this.dom),Or(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return Wz(this,e)}coordsAtPos(e,t=1){return nk(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let s=this.docView.posFromDOM(e,t,r);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(e,t){return Kz(this,t||this.state,e)}pasteHTML(e,t){return Ga(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return Ga(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return am(this,e)}destroy(){this.docView&&(xB(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],gh(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,Sz())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return SB(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return e?qt&&this.root.nodeType===11&&$z(this.dom.ownerDocument)==this.dom&&KB(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function G1(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[Tt.node(0,n.state.doc.content.size,e)]}function J1(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:Tt.widget(n.state.selection.from,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function X1(n){return!n.someProp("editable",e=>e(n.state)===!1)}function sF(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function Q1(n){let e=Object.create(null);function t(r){for(let s in r)Object.prototype.hasOwnProperty.call(e,s)||(e[s]=r[s])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function iF(n,e){let t=0,r=0;for(let s in n){if(n[s]!=e[s])return!0;t++}for(let s in e)r++;return t!=r}function Z1(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var oF=Object.defineProperty,aF=(n,e,t)=>e in n?oF(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,kn=(n,e,t)=>(aF(n,typeof e!="symbol"?e+"":e,t),t);const lF=Symbol("[ProsemirrorAdapter]nodeViewContext"),cF=Symbol("[ProsemirrorAdapter]useNodeViewFactory");class uF extends SL{constructor(){super(...arguments),kn(this,"key",Zp()),kn(this,"context",{contentRef:e=>{e&&e instanceof HTMLElement&&this.contentDOM&&e.firstChild!==this.contentDOM&&e.appendChild(this.contentDOM)},view:this.view,getPos:this.getPos,setAttrs:this.setAttrs,node:Xr(this.node),selected:Xr(this.selected),decorations:Xr(this.decorations),innerDecorations:Xr(this.innerDecorations)}),kn(this,"updateContext",()=>{Object.entries({node:this.node,selected:this.selected,decorations:this.decorations,innerDecorations:this.innerDecorations}).forEach(([e,t])=>{const r=this.context[e];r.value!==t&&(r.value=t)})}),kn(this,"render",()=>{const e=this.component;return Fu(B({name:"ProsemirrorNodeView",setup:()=>(xt(lF,this.context),()=>P(ws,{key:this.key,to:this.dom},{default:()=>[P(e,null,null)]}))}))})}}const dF=(n,e)=>t=>(r,s,i,o,a)=>{const l=new uF({node:r,view:s,getPos:i,decorations:o,innerDecorations:a,options:{...t,onUpdate(){var c;(c=t.onUpdate)==null||c.call(t),l.updateContext()},selectNode(){var c;(c=t.selectNode)==null||c.call(t),l.updateContext()},deselectNode(){var c;(c=t.deselectNode)==null||c.call(t),l.updateContext()},destroy(){var c;(c=t.destroy)==null||c.call(t),e(l)}}});return n(l),l},Dk=Symbol("[ProsemirrorAdapter]nodeViewContext"),dd=()=>ct(Dk),$k=Symbol("[ProsemirrorAdapter]usePluginViewFactory"),fm=()=>ct($k);class hF extends ML{constructor(){super(...arguments),kn(this,"key",Zp()),kn(this,"context",{view:Xr(this.view),prevState:Xr(this.prevState)}),kn(this,"updateContext",()=>{Object.entries({view:this.view,prevState:this.prevState}).forEach(([e,t])=>{const r=this.context[e];if(e==="view"){const s=Object.assign(Object.create(Object.getPrototypeOf(t)),t);r.value=s;return}r.value=t})}),kn(this,"render",()=>{const e=this.component;return Fu(B({name:"ProsemirrorNodeView",setup:()=>(xt(Dk,this.context),()=>P(ws,{key:this.key,to:this.root},{default:()=>[P(e,null,null)]}))}))})}}const fF=(n,e)=>t=>r=>{const s=new hF({view:r,options:{...t,update:(i,o)=>{var a;(a=t.update)==null||a.call(t,i,o),s.updateContext()},destroy:()=>{var i;(i=t.destroy)==null||i.call(t),e(s)}}});return n(s),s},pF=()=>{const n=$({}),e=yo(),t=Fu({});return hp(()=>{t.updater=()=>{e==null||e.update()}}),Nn(()=>{t.updater=void 0}),{portals:n,renderVueRenderer:r=>{var s;n.value[r.key]=r.render(),(s=t.updater)==null||s.call(t)},removeVueRenderer:r=>{delete n.value[r.key]}}},Ek=Symbol("[ProsemirrorAdapter]widgetViewContext"),mF=()=>ct(Ek),Ak=Symbol("[ProsemirrorAdapter]useWidgetViewFactory"),gF=()=>ct(Ak);class yF extends TL{constructor(){super(...arguments),kn(this,"key",Zp()),kn(this,"context",{view:this.view,getPos:this.getPos,spec:this.spec}),kn(this,"updateContext",()=>{Object.assign(this.context,{view:this.view,getPos:this.getPos,spec:this.spec})}),kn(this,"render",()=>{const e=this.component;return Fu(B({name:"ProsemirrorWidgetView",setup:()=>(xt(Ek,this.context),()=>P(ws,{key:this.key,to:this.dom},{default:()=>[P(e,null,null)]}))}))})}}const vF=(n,e)=>t=>(r,s={})=>{const i=new yF({pos:r,options:t}),o={...s,destroy:a=>{var l;(l=s.destroy)==null||l.call(s,a),e(i)}};return i.spec=o,Tt.widget(r,(a,l)=>(i.bind(a,l),i.updateContext(),n(i),i.dom),o)},bF=B({name:"ProsemirrorAdapterProvider",setup:(n,{slots:e})=>{const{portals:t,renderVueRenderer:r,removeVueRenderer:s}=pF(),i=dF(r,s),o=fF(r,s),a=vF(r,s);return xt(cF,i),xt($k,o),xt(Ak,a),()=>{var l;return P(J,null,[(l=e.default)==null?void 0:l.call(e),Object.values(t.value).map(c=>wt(c))])}}});var gn=(n=>(n.docTypeError="docTypeError",n.contextNotFound="contextNotFound",n.timerNotFound="timerNotFound",n.ctxCallOutOfScope="ctxCallOutOfScope",n.createNodeInParserFail="createNodeInParserFail",n.stackOverFlow="stackOverFlow",n.parserMatchError="parserMatchError",n.serializerMatchError="serializerMatchError",n.getAtomFromSchemaFail="getAtomFromSchemaFail",n.expectDomTypeError="expectDomTypeError",n.callCommandBeforeEditorView="callCommandBeforeEditorView",n.missingRootElement="missingRootElement",n.missingNodeInSchema="missingNodeInSchema",n.missingMarkInSchema="missingMarkInSchema",n.ctxNotBind="ctxNotBind",n.missingYjsDoc="missingYjsDoc",n))(gn||{});class Tn extends Error{constructor(e,t){super(t),this.name="MilkdownError",this.code=e}}const wF=(n,e)=>typeof e=="function"?"[Function]":e,hd=n=>JSON.stringify(n,wF);function _F(n){return new Tn(gn.docTypeError,"Doc type error, unsupported type: ".concat(hd(n)))}function kF(n){return new Tn(gn.contextNotFound,'Context "'.concat(n,'" not found, do you forget to inject it?'))}function xF(n){return new Tn(gn.timerNotFound,'Timer "'.concat(n,'" not found, do you forget to record it?'))}function pm(){return new Tn(gn.ctxCallOutOfScope,"Should not call a context out of the plugin.")}function CF(n,e,t){const r="name"in n?n.name:n,s="Cannot create node for ".concat(r),i=u=>{if(u==null)return"null";if(Array.isArray(u))return"[".concat(u.map(i).join(", "),"]");if(typeof u=="object")return"toJSON"in u&&typeof u.toJSON=="function"?JSON.stringify(u.toJSON()):"spec"in u?JSON.stringify(u.spec):JSON.stringify(u);if(typeof u=="string"||typeof u=="number"||typeof u=="boolean")return JSON.stringify(u);if(typeof u=="function")return"[Function: ".concat(u.name||"anonymous","]");try{return String(u)}catch(d){return"[Unserializable]"}},o=["[Description]",s],a=["[Attributes]",e],l=["[Content]",(t!=null?t:[]).map(u=>u?typeof u=="object"&&"type"in u?"".concat(u):i(u):"null")],c=[o,a,l].reduce((u,[d,h])=>{const f="".concat(d,": ").concat(i(h),".");return u.concat(f)},[]);return new Tn(gn.createNodeInParserFail,c.join("\n"))}function Pk(){return new Tn(gn.stackOverFlow,"Stack over flow, cannot pop on an empty stack.")}function SF(n){return new Tn(gn.parserMatchError,"Cannot match target parser for node: ".concat(hd(n),"."))}function MF(n){return new Tn(gn.serializerMatchError,"Cannot match target serializer for node: ".concat(hd(n),"."))}function cr(n){return new Tn(gn.expectDomTypeError,"Expect to be a dom, but get: ".concat(hd(n),"."))}function vh(){return new Tn(gn.callCommandBeforeEditorView,"You're trying to call a command before editor view initialized, make sure to get commandManager from ctx after editor view has been initialized")}function TF(n){return new Tn(gn.missingNodeInSchema,'Missing node in schema, milkdown cannot find "'.concat(n,'" in schema.'))}function OF(n){return new Tn(gn.missingMarkInSchema,'Missing mark in schema, milkdown cannot find "'.concat(n,'" in schema.'))}var Rk=n=>{throw TypeError(n)},Nk=(n,e,t)=>e.has(n)||Rk("Cannot "+t),ie=(n,e,t)=>(Nk(n,e,"read from private field"),t?t.call(n):e.get(n)),ot=(n,e,t)=>e.has(n)?Rk("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Ie=(n,e,t,r)=>(Nk(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),Un,Br,qo,mc,gc,yc,Li,Yo,Is,Ko,Go,Jo,Fr,Vr,vc,$n,zi,Ls,Xo,Hr,Qo,bc;class Ik{constructor(){this.sliceMap=new Map,this.get=e=>{const t=typeof e=="string"?[...this.sliceMap.values()].find(r=>r.type.name===e):this.sliceMap.get(e.id);if(!t){const r=typeof e=="string"?e:e.name;throw kF(r)}return t},this.remove=e=>{const t=typeof e=="string"?[...this.sliceMap.values()].find(r=>r.type.name===e):this.sliceMap.get(e.id);t&&this.sliceMap.delete(t.type.id)},this.has=e=>typeof e=="string"?[...this.sliceMap.values()].some(t=>t.type.name===e):this.sliceMap.has(e.id)}}class DF{constructor(e,t,r){ot(this,Un),ot(this,Br),ot(this,qo),Ie(this,Un,[]),Ie(this,qo,()=>{ie(this,Un).forEach(s=>s(ie(this,Br)))}),this.set=s=>{Ie(this,Br,s),ie(this,qo).call(this)},this.get=()=>ie(this,Br),this.update=s=>{Ie(this,Br,s(ie(this,Br))),ie(this,qo).call(this)},this.type=r,Ie(this,Br,t),e.set(r.id,this)}on(e){return ie(this,Un).push(e),()=>{Ie(this,Un,ie(this,Un).filter(t=>t!==e))}}once(e){const t=this.on(r=>{e(r),t()});return t}off(e){Ie(this,Un,ie(this,Un).filter(t=>t!==e))}offAll(){Ie(this,Un,[])}}Un=new WeakMap;Br=new WeakMap;qo=new WeakMap;class $F{constructor(e,t){this.id=Symbol("Context-".concat(t)),this.name=t,this._defaultValue=e,this._typeInfo=()=>{throw pm()}}create(e,t=this._defaultValue){return new DF(e,t,this)}}const Le=(n,e)=>new $F(n,e);class EF{constructor(e,t,r){ot(this,mc),ot(this,gc),ot(this,yc),ot(this,Li),ot(this,Yo),ot(this,Is),ot(this,Ko),ot(this,Go),ot(this,Jo),Ie(this,Li,new Set),Ie(this,Yo,new Set),Ie(this,Is,new Map),Ie(this,Ko,new Map),this.read=()=>({metadata:ie(this,mc),injectedSlices:[...ie(this,Li)].map(s=>({name:typeof s=="string"?s:s.name,value:ie(this,Go).call(this,s)})),consumedSlices:[...ie(this,Yo)].map(s=>({name:typeof s=="string"?s:s.name,value:ie(this,Go).call(this,s)})),recordedTimers:[...ie(this,Is)].map(([s,{duration:i}])=>({name:s.name,duration:i,status:ie(this,Jo).call(this,s)})),waitTimers:[...ie(this,Ko)].map(([s,{duration:i}])=>({name:s.name,duration:i,status:ie(this,Jo).call(this,s)}))}),this.onRecord=s=>{ie(this,Is).set(s,{start:Date.now(),duration:0})},this.onClear=s=>{ie(this,Is).delete(s)},this.onDone=s=>{const i=ie(this,Is).get(s);i&&(i.duration=Date.now()-i.start)},this.onWait=(s,i)=>{const o=Date.now();i.finally(()=>{ie(this,Ko).set(s,{duration:Date.now()-o})}).catch(console.error)},this.onInject=s=>{ie(this,Li).add(s)},this.onRemove=s=>{ie(this,Li).delete(s)},this.onUse=s=>{ie(this,Yo).add(s)},Ie(this,Go,s=>ie(this,gc).get(s).get()),Ie(this,Jo,s=>ie(this,yc).get(s).status),Ie(this,gc,e),Ie(this,yc,t),Ie(this,mc,r)}}mc=new WeakMap;gc=new WeakMap;yc=new WeakMap;Li=new WeakMap;Yo=new WeakMap;Is=new WeakMap;Ko=new WeakMap;Go=new WeakMap;Jo=new WeakMap;const AF=class Lk{constructor(e,t,r){ot(this,Fr),ot(this,Vr),ot(this,vc),ot(this,$n),this.produce=s=>s&&Object.keys(s).length?new Lk(ie(this,Fr),ie(this,Vr),{...s}):this,this.inject=(s,i)=>{var o;const a=s.create(ie(this,Fr).sliceMap);return i!=null&&a.set(i),(o=ie(this,$n))==null||o.onInject(s),this},this.remove=s=>{var i;return ie(this,Fr).remove(s),(i=ie(this,$n))==null||i.onRemove(s),this},this.record=s=>{var i;return s.create(ie(this,Vr).store),(i=ie(this,$n))==null||i.onRecord(s),this},this.clearTimer=s=>{var i;return ie(this,Vr).remove(s),(i=ie(this,$n))==null||i.onClear(s),this},this.isInjected=s=>ie(this,Fr).has(s),this.isRecorded=s=>ie(this,Vr).has(s),this.use=s=>{var i;return(i=ie(this,$n))==null||i.onUse(s),ie(this,Fr).get(s)},this.get=s=>this.use(s).get(),this.set=(s,i)=>this.use(s).set(i),this.update=(s,i)=>this.use(s).update(i),this.timer=s=>ie(this,Vr).get(s),this.done=s=>{var i;this.timer(s).done(),(i=ie(this,$n))==null||i.onDone(s)},this.wait=s=>{var i;const o=this.timer(s).start();return(i=ie(this,$n))==null||i.onWait(s,o),o},this.waitTimers=async s=>{await Promise.all(this.get(s).map(i=>this.wait(i)))},Ie(this,Fr,e),Ie(this,Vr,t),Ie(this,vc,r),r&&Ie(this,$n,new EF(e,t,r))}get meta(){return ie(this,vc)}get inspector(){return ie(this,$n)}};Fr=new WeakMap;Vr=new WeakMap;vc=new WeakMap;$n=new WeakMap;let PF=AF;class RF{constructor(){this.store=new Map,this.get=e=>{const t=this.store.get(e.id);if(!t)throw xF(e.name);return t},this.remove=e=>{this.store.delete(e.id)},this.has=e=>this.store.has(e.id)}}class NF{constructor(e,t){ot(this,zi),ot(this,Ls),ot(this,Xo),ot(this,Hr),ot(this,Qo),ot(this,bc),Ie(this,zi,null),Ie(this,Ls,null),Ie(this,Hr,"pending"),this.start=()=>{var r;return(r=ie(this,zi))!=null||Ie(this,zi,new Promise((s,i)=>{Ie(this,Ls,o=>{o instanceof CustomEvent&&o.detail.id===ie(this,Xo)&&(Ie(this,Hr,"resolved"),ie(this,Qo).call(this),o.stopImmediatePropagation(),s())}),ie(this,bc).call(this,()=>{ie(this,Hr)==="pending"&&Ie(this,Hr,"rejected"),ie(this,Qo).call(this),i(new Error("Timing ".concat(this.type.name," timeout.")))}),Ie(this,Hr,"pending"),addEventListener(this.type.name,ie(this,Ls))})),ie(this,zi)},this.done=()=>{const r=new CustomEvent(this.type.name,{detail:{id:ie(this,Xo)}});dispatchEvent(r)},Ie(this,Qo,()=>{ie(this,Ls)&&removeEventListener(this.type.name,ie(this,Ls))}),Ie(this,bc,r=>{setTimeout(()=>{r()},this.type.timeout)}),Ie(this,Xo,Symbol(t.name)),this.type=t,e.set(t.id,this)}get status(){return ie(this,Hr)}}zi=new WeakMap;Ls=new WeakMap;Xo=new WeakMap;Hr=new WeakMap;Qo=new WeakMap;bc=new WeakMap;class IF{constructor(e,t=3e3){this.create=r=>new NF(r,this),this.id=Symbol("Timer-".concat(e)),this.name=e,this.timeout=t}}const xs=(n,e=3e3)=>new IF(n,e);var zk=n=>{throw TypeError(n)},Bk=(n,e,t)=>e.has(n)||zk("Cannot "+t),Ce=(n,e,t)=>(Bk(n,e,"read from private field"),t?t.call(n):e.get(n)),gt=(n,e,t)=>e.has(n)?zk("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Qe=(n,e,t,r)=>(Bk(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),qn,Zo,wc,_c,kc,ea,ta,gr,na,xc,Cc,ra,Sc,sa,Mc,Tc,Bi,zs,Oc,ia;class Fk{}class Vk{constructor(){this.elements=[],this.size=()=>this.elements.length,this.top=()=>this.elements.at(-1),this.push=e=>{var t;(t=this.top())==null||t.push(e)},this.open=e=>{this.elements.push(e)},this.close=()=>{const e=this.elements.pop();if(!e)throw Pk();return e}}}class mm extends Fk{constructor(e,t,r){super(),this.type=e,this.content=t,this.attrs=r}push(e,...t){this.content.push(e,...t)}pop(){return this.content.pop()}static create(e,t,r){return new mm(e,t,r)}}const Uf=class extends Vk{constructor(e){super(),gt(this,qn),gt(this,Zo),gt(this,wc),gt(this,_c),gt(this,kc),gt(this,ea),gt(this,ta),Qe(this,qn,Pe.none),Qe(this,Zo,t=>t.isText),Qe(this,wc,(t,r)=>{if(Ce(this,Zo).call(this,t)&&Ce(this,Zo).call(this,r)&&Pe.sameSet(t.marks,r.marks))return this.schema.text(t.text+r.text,t.marks)}),Qe(this,_c,t=>{const r=Object.values({...this.schema.nodes,...this.schema.marks}).find(s=>s.spec.parseMarkdown.match(t));if(!r)throw SF(t);return r}),Qe(this,kc,t=>{const r=Ce(this,_c).call(this,t);r.spec.parseMarkdown.runner(this,t,r)}),this.injectRoot=(t,r,s)=>(this.openNode(r,s),this.next(t.children),this),this.openNode=(t,r)=>(this.open(mm.create(t,[],r)),this),Qe(this,ea,()=>{Qe(this,qn,Pe.none);const t=this.close();return Ce(this,ta).call(this,t.type,t.attrs,t.content)}),this.closeNode=()=>{try{Ce(this,ea).call(this)}catch(t){console.error(t)}return this},Qe(this,ta,(t,r,s)=>{const i=t.createAndFill(r,s,Ce(this,qn));if(!i)throw CF(t,r,s);return this.push(i),i}),this.addNode=(t,r,s)=>{try{Ce(this,ta).call(this,t,r,s)}catch(i){console.error(i)}return this},this.openMark=(t,r)=>{const s=t.create(r);return Qe(this,qn,s.addToSet(Ce(this,qn))),this},this.closeMark=t=>(Qe(this,qn,t.removeFromSet(Ce(this,qn))),this),this.addText=t=>{try{const r=this.top();if(!r)throw Pk();const s=r.pop(),i=this.schema.text(t,Ce(this,qn));if(!s)return r.push(i),this;const o=Ce(this,wc).call(this,s,i);return o?(r.push(o),this):(r.push(s,i),this)}catch(r){return console.error(r),this}},this.build=()=>{let t;do t=Ce(this,ea).call(this);while(this.size());return t},this.next=(t=[])=>([t].flat().forEach(r=>Ce(this,kc).call(this,r)),this),this.toDoc=()=>this.build(),this.run=(t,r)=>{const s=t.runSync(t.parse(r),r);return this.next(s),this},this.schema=e}};qn=new WeakMap;Zo=new WeakMap;wc=new WeakMap;_c=new WeakMap;kc=new WeakMap;ea=new WeakMap;ta=new WeakMap;Uf.create=(n,e)=>{const t=new Uf(n);return r=>(t.run(e,r),t.toDoc())};let LF=Uf;const qf=class extends Fk{constructor(e,t,r,s={}){super(),this.type=e,this.children=t,this.value=r,this.props=s,this.push=(i,...o)=>{this.children||(this.children=[]),this.children.push(i,...o)},this.pop=()=>{var i;return(i=this.children)==null?void 0:i.pop()}}};qf.create=(n,e,t,r={})=>new qf(n,e,t,r);let e0=qf;const zF=n=>Object.prototype.hasOwnProperty.call(n,"size"),Yf=class extends Vk{constructor(e){super(),gt(this,gr),gt(this,na),gt(this,xc),gt(this,Cc),gt(this,ra),gt(this,Sc),gt(this,sa),gt(this,Mc),gt(this,Tc),gt(this,Bi),gt(this,zs),gt(this,Oc),gt(this,ia),Qe(this,gr,Pe.none),Qe(this,na,t=>{const r=Object.values({...this.schema.nodes,...this.schema.marks}).find(s=>s.spec.toMarkdown.match(t));if(!r)throw MF(t.type);return r}),Qe(this,xc,t=>Ce(this,na).call(this,t).spec.toMarkdown.runner(this,t)),Qe(this,Cc,(t,r)=>Ce(this,na).call(this,t).spec.toMarkdown.runner(this,t,r)),Qe(this,ra,t=>{const{marks:r}=t,s=a=>{var l;return(l=a.type.spec.priority)!=null?l:50};[...r].sort((a,l)=>s(a)-s(l)).every(a=>!Ce(this,Cc).call(this,a,t))&&Ce(this,xc).call(this,t),r.forEach(a=>Ce(this,ia).call(this,a))}),Qe(this,Sc,(t,r)=>{var s;if(t.type===r||((s=t.children)==null?void 0:s.length)!==1)return t;const i=c=>{var u;if(c.type===r)return c;if(((u=c.children)==null?void 0:u.length)!==1)return null;const[d]=c.children;return d?i(d):null},o=i(t);if(!o)return t;const a=o.children?[...o.children]:void 0,l={...t,children:a};return l.children=a,o.children=[l],o}),Qe(this,sa,t=>{const{children:r}=t;return r&&(t.children=r.reduce((s,i,o)=>{if(o===0)return[i];const a=s.at(-1);if(a&&a.isMark&&i.isMark){i=Ce(this,Sc).call(this,i,a.type);const{children:l,...c}=i,{children:u,...d}=a;if(i.type===a.type&&l&&u&&JSON.stringify(c)===JSON.stringify(d)){const h={...d,children:[...u,...l]};return s.slice(0,-1).concat(Ce(this,sa).call(this,h))}}return s.concat(i)},[])),t}),Qe(this,Mc,t=>{const r={...t.props,type:t.type};return t.children&&(r.children=t.children),t.value&&(r.value=t.value),r}),this.openNode=(t,r,s)=>(this.open(e0.create(t,void 0,r,s)),this),Qe(this,Tc,(t,r)=>{let s="",i="";const o=t.children;let a=-1,l=-1;const c=d=>{d&&d.forEach((h,f)=>{h.type==="text"&&h.value&&(a<0&&(a=f),l=f)})};if(o){c(o);const d=o==null?void 0:o[l],h=o==null?void 0:o[a];d&&d.value.endsWith(" ")&&(i=d.value.match(/ +$/)[0],d.value=d.value.trimEnd()),h&&h.value.startsWith(" ")&&(s=h.value.match(/^ +/)[0],h.value=h.value.trimStart())}s.length&&Ce(this,zs).call(this,"text",void 0,s);const u=r();return i.length&&Ce(this,zs).call(this,"text",void 0,i),u}),Qe(this,Bi,(t=!1)=>{const r=this.close(),s=()=>Ce(this,zs).call(this,r.type,r.children,r.value,r.props);return t?Ce(this,Tc).call(this,r,s):s()}),this.closeNode=()=>(Ce(this,Bi).call(this),this),Qe(this,zs,(t,r,s,i)=>{const o=e0.create(t,r,s,i),a=Ce(this,sa).call(this,Ce(this,Mc).call(this,o));return this.push(a),a}),this.addNode=(t,r,s,i)=>(Ce(this,zs).call(this,t,r,s,i),this),Qe(this,Oc,(t,r,s,i)=>t.isInSet(Ce(this,gr))?this:(Qe(this,gr,t.addToSet(Ce(this,gr))),this.openNode(r,s,{...i,isMark:!0}))),Qe(this,ia,t=>{t.isInSet(Ce(this,gr))&&(Qe(this,gr,t.type.removeFromSet(Ce(this,gr))),Ce(this,Bi).call(this,!0))}),this.withMark=(t,r,s,i)=>(Ce(this,Oc).call(this,t,r,s,i),this),this.closeMark=t=>(Ce(this,ia).call(this,t),this),this.build=()=>{let t=null;do t=Ce(this,Bi).call(this);while(this.size());return t},this.next=t=>zF(t)?(t.forEach(r=>{Ce(this,ra).call(this,r)}),this):(Ce(this,ra).call(this,t),this),this.toString=t=>t.stringify(this.build()),this.run=t=>(this.next(t),this),this.schema=e}};gr=new WeakMap;na=new WeakMap;xc=new WeakMap;Cc=new WeakMap;ra=new WeakMap;Sc=new WeakMap;sa=new WeakMap;Mc=new WeakMap;Tc=new WeakMap;Bi=new WeakMap;zs=new WeakMap;Oc=new WeakMap;ia=new WeakMap;Yf.create=(n,e)=>{const t=new Yf(n);return r=>(t.run(r),t.toString(e))};let BF=Yf;const gm=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function FF(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const Hk=(n,e,t)=>{let r=FF(n,t);if(!r)return!1;let s=jk(r);if(!s){let o=r.blockRange(),a=o&&id(o);return a==null?!1:(e&&e(n.tr.lift(o,a).scrollIntoView()),!0)}let i=s.nodeBefore;if(qk(n,s,e,-1))return!0;if(r.parent.content.size==0&&(po(i,"end")||pe.isSelectable(i)))for(let o=r.depth;;o--){let a=nm(n.doc,r.before(o),r.after(o),Q.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=n.tr.step(a);l.setSelection(po(i,"end")?ge.findFrom(l.doc.resolve(l.mapping.map(s.pos,-1)),-1):pe.create(l.doc,s.pos-i.nodeSize)),e(l.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return i.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos-i.nodeSize,s.pos).scrollIntoView()),!0):!1};function po(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const Wk=(n,e,t)=>{let{$head:r,empty:s}=n.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;i=jk(r)}let o=i&&i.nodeBefore;return!o||!pe.isSelectable(o)?!1:(e&&e(n.tr.setSelection(pe.create(n.doc,i.pos-o.nodeSize)).scrollIntoView()),!0)};function jk(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function VF(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const HF=(n,e,t)=>{let r=VF(n,t);if(!r)return!1;let s=Uk(r);if(!s)return!1;let i=s.nodeAfter;if(qk(n,s,e,1))return!0;if(r.parent.content.size==0&&(po(i,"start")||pe.isSelectable(i))){let o=nm(n.doc,r.before(),r.after(),Q.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=n.tr.step(o);a.setSelection(po(i,"start")?ge.findFrom(a.doc.resolve(a.mapping.map(s.pos)),1):pe.create(a.doc,a.mapping.map(s.pos))),e(a.scrollIntoView())}return!0}}return i.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos,s.pos+i.nodeSize).scrollIntoView()),!0):!1},WF=(n,e,t)=>{let{$head:r,empty:s}=n.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;i=Uk(r)}let o=i&&i.nodeAfter;return!o||!pe.isSelectable(o)?!1:(e&&e(n.tr.setSelection(pe.create(n.doc,i.pos)).scrollIntoView()),!0)};function Uk(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const jF=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText("\n").scrollIntoView()),!0)};function ym(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const UF=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let s=t.node(-1),i=t.indexAfter(-1),o=ym(s.contentMatchAt(i));if(!o||!s.canReplaceWith(i,i,o))return!1;if(e){let a=t.after(),l=n.tr.replaceWith(a,a,o.createAndFill());l.setSelection(ge.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},qF=(n,e)=>{let t=n.selection,{$from:r,$to:s}=t;if(t instanceof pn||r.parent.inlineContent||s.parent.inlineContent)return!1;let i=ym(s.parent.contentMatchAt(s.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let o=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,a=n.tr.insert(o,i.createAndFill());a.setSelection(we.create(a.doc,o+1)),e(a.scrollIntoView())}return!0},YF=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let i=t.before();if(Sa(n.doc,i))return e&&e(n.tr.split(i).scrollIntoView()),!0}let r=t.blockRange(),s=r&&id(r);return s==null?!1:(e&&e(n.tr.lift(r,s).scrollIntoView()),!0)};function KF(n){return(e,t)=>{let{$from:r,$to:s}=e.selection;if(e.selection instanceof pe&&e.selection.node.isBlock)return!r.parentOffset||!Sa(e.doc,r.pos)?!1:(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let i=[],o,a,l=!1,c=!1;for(let f=r.depth;;f--)if(r.node(f).isBlock){l=r.end(f)==r.pos+(r.depth-f),c=r.start(f)==r.pos-(r.depth-f),a=ym(r.node(f-1).contentMatchAt(r.indexAfter(f-1)));let m=n&&n(s.parent,l,r);i.unshift(m||(l&&a?{type:a}:null)),o=f;break}else{if(f==1)return!1;i.unshift(null)}let u=e.tr;(e.selection instanceof we||e.selection instanceof pn)&&u.deleteSelection();let d=u.mapping.map(r.pos),h=Sa(u.doc,d,i.length,i);if(h||(i[0]=a?{type:a}:null,h=Sa(u.doc,d,i.length,i)),!h)return!1;if(u.split(d,i.length,i),!l&&c&&r.node(o).type!=a){let f=u.mapping.map(r.before(o)),p=u.doc.resolve(f);a&&r.node(o-1).canReplaceWith(p.index(),p.index()+1,a)&&u.setNodeMarkup(u.mapping.map(r.before(o)),a)}return t&&t(u.scrollIntoView()),!0}}const GF=KF(),JF=(n,e)=>(e&&e(n.tr.setSelection(new pn(n.doc))),!0);function XF(n,e,t){let r=e.nodeBefore,s=e.nodeAfter,i=e.index();return!r||!s||!r.type.compatibleContent(s.type)?!1:!r.content.size&&e.parent.canReplace(i-1,i)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(i,i+1)||!(s.isTextblock||od(n.doc,e.pos))?!1:(t&&t(n.tr.join(e.pos).scrollIntoView()),!0)}function qk(n,e,t,r){let s=e.nodeBefore,i=e.nodeAfter,o,a,l=s.type.spec.isolating||i.type.spec.isolating;if(!l&&XF(n,e,t))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(o=(a=s.contentMatchAt(s.childCount)).findWrapping(i.type))&&a.matchType(o[0]||i.type).validEnd){if(t){let f=e.pos+i.nodeSize,p=j.empty;for(let b=o.length-1;b>=0;b--)p=j.from(o[b].create(null,p));p=j.from(s.copy(p));let m=n.tr.step(new Wt(e.pos-1,f,e.pos,f,new Q(p,1,0),o.length,!0)),g=m.doc.resolve(f+2*o.length);g.nodeAfter&&g.nodeAfter.type==s.type&&od(m.doc,g.pos)&&m.join(g.pos),t(m.scrollIntoView())}return!0}let u=i.type.spec.isolating||r>0&&l?null:ge.findFrom(e,1),d=u&&u.$from.blockRange(u.$to),h=d&&id(d);if(h!=null&&h>=e.depth)return t&&t(n.tr.lift(d,h).scrollIntoView()),!0;if(c&&po(i,"start",!0)&&po(s,"end")){let f=s,p=[];for(;p.push(f),!f.isTextblock;)f=f.lastChild;let m=i,g=1;for(;!m.isTextblock;m=m.firstChild)g++;if(f.canReplace(f.childCount,f.childCount,m.content)){if(t){let b=j.empty;for(let M=p.length-1;M>=0;M--)b=j.from(p[M].copy(b));let _=n.tr.step(new Wt(e.pos-p.length,e.pos+i.nodeSize,e.pos+g,e.pos+i.nodeSize-g,new Q(b,p.length,0),0,!0));t(_.scrollIntoView())}return!0}}return!1}function Yk(n){return function(e,t){let r=e.selection,s=n<0?r.$from:r.$to,i=s.depth;for(;s.node(i).isInline;){if(!i)return!1;i--}return s.node(i).isTextblock?(t&&t(e.tr.setSelection(we.create(e.doc,n<0?s.start(i):s.end(i)))),!0):!1}}const QF=Yk(-1),ZF=Yk(1);function vm(n,e=null){return function(t,r){let{$from:s,$to:i}=t.selection,o=s.blockRange(i),a=o&&F_(o,n,e);return a?(r&&r(t.tr.wrap(o,a).scrollIntoView()),!0):!1}}function Xa(n,e=null){return function(t,r){let s=!1;for(let i=0;i<t.selection.ranges.length&&!s;i++){let{$from:{pos:o},$to:{pos:a}}=t.selection.ranges[i];t.doc.nodesBetween(o,a,(l,c)=>{if(s)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)s=!0;else{let u=t.doc.resolve(c),d=u.index();s=u.parent.canReplaceWith(d,d+1,n)}})}if(!s)return!1;if(r){let i=t.tr;for(let o=0;o<t.selection.ranges.length;o++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[o];i.setBlockType(a,l,n,e)}r(i.scrollIntoView())}return!0}}function eV(n,e,t,r){for(let s=0;s<e.length;s++){let{$from:i,$to:o}=e[s],a=i.depth==0?n.inlineContent&&n.type.allowsMarkType(t):!1;if(n.nodesBetween(i.pos,o.pos,(l,c)=>{if(a||!r&&l.isAtom&&l.isInline&&c>=i.pos&&c+l.nodeSize<=o.pos)return!1;a=l.inlineContent&&l.type.allowsMarkType(t)}),a)return!0}return!1}function tV(n){let e=[];for(let t=0;t<n.length;t++){let{$from:r,$to:s}=n[t];r.doc.nodesBetween(r.pos,s.pos,(i,o)=>{if(i.isAtom&&i.content.size&&i.isInline&&o>=r.pos&&o+i.nodeSize<=s.pos)return o+1>r.pos&&e.push(new _u(r,r.doc.resolve(o+1))),r=r.doc.resolve(o+1+i.content.size),!1}),r.pos<s.pos&&e.push(new _u(r,s))}return e}function fd(n,e=null,t){let r=(t&&t.removeWhenPresent)!==!1,s=(t&&t.enterInlineAtoms)!==!1,i=!(t&&t.includeWhitespace);return function(o,a){let{empty:l,$cursor:c,ranges:u}=o.selection;if(l&&!c||!eV(o.doc,u,n,s))return!1;if(a)if(c)n.isInSet(o.storedMarks||c.marks())?a(o.tr.removeStoredMark(n)):a(o.tr.addStoredMark(n.create(e)));else{let d,h=o.tr;s||(u=tV(u)),r?d=!u.some(f=>o.doc.rangeHasMark(f.$from.pos,f.$to.pos,n)):d=!u.every(f=>{let p=!1;return h.doc.nodesBetween(f.$from.pos,f.$to.pos,(m,g,b)=>{if(p)return!1;p=!n.isInSet(m.marks)&&!!b&&b.type.allowsMarkType(n)&&!(m.isText&&/^\s*$/.test(m.textBetween(Math.max(0,f.$from.pos-g),Math.min(m.nodeSize,f.$to.pos-g))))}),!p});for(let f=0;f<u.length;f++){let{$from:p,$to:m}=u[f];if(!d)h.removeMark(p.pos,m.pos,n);else{let g=p.pos,b=m.pos,_=p.nodeAfter,M=m.nodeBefore,k=i&&_&&_.isText?/^\s*/.exec(_.text)[0].length:0,C=i&&M&&M.isText?/\s*$/.exec(M.text)[0].length:0;g+k<b&&(g+=k,b-=C),h.addMark(g,b,n.create(e))}}a(h.scrollIntoView())}return!0}}function fl(...n){return function(e,t,r){for(let s=0;s<n.length;s++)if(n[s](e,t,r))return!0;return!1}}let bh=fl(gm,Hk,Wk),t0=fl(gm,HF,WF);const wr={Enter:fl(jF,qF,YF,GF),"Mod-Enter":UF,Backspace:bh,"Mod-Backspace":bh,"Shift-Backspace":bh,Delete:t0,"Mod-Delete":t0,"Mod-a":JF},Kk={"Ctrl-h":wr.Backspace,"Alt-Backspace":wr["Mod-Backspace"],"Ctrl-d":wr.Delete,"Ctrl-Alt-Backspace":wr["Mod-Delete"],"Alt-Delete":wr["Mod-Delete"],"Alt-d":wr["Mod-Delete"],"Ctrl-a":QF,"Ctrl-e":ZF};for(let n in wr)Kk[n]=wr[n];const nV=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1,rV=nV?Kk:wr;class yn{constructor(e,t,r={}){this.match=e,this.match=e,this.handler=typeof t=="string"?sV(t):t,this.undoable=r.undoable!==!1,this.inCode=r.inCode||!1,this.inCodeMark=r.inCodeMark!==!1}}function sV(n){return function(e,t,r,s){let i=n;if(t[1]){let o=t[0].lastIndexOf(t[1]);i+=t[0].slice(o+t[1].length),r+=o;let a=r-s;a>0&&(i=t[0].slice(o-a,o)+i,r=s)}return e.tr.insertText(i,r,s)}}const iV=(n,e)=>{let t=n.plugins;for(let r=0;r<t.length;r++){let s=t[r],i;if(s.spec.isInputRules&&(i=s.getState(n))){if(e){let o=n.tr,a=i.transform;for(let l=a.steps.length-1;l>=0;l--)o.step(a.steps[l].invert(a.docs[l]));if(i.text){let l=o.doc.resolve(i.from).marks();o.replaceWith(i.from,i.to,n.schema.text(i.text,l))}else o.delete(i.from,i.to);e(o)}return!0}}return!1};new yn(/--$/,"—",{inCodeMark:!1});new yn(/\.\.\.$/,"…",{inCodeMark:!1});new yn(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“",{inCodeMark:!1});new yn(/"$/,"”",{inCodeMark:!1});new yn(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘",{inCodeMark:!1});new yn(/'$/,"’",{inCodeMark:!1});function bm(n,e,t=null,r){return new yn(n,(s,i,o,a)=>{let l=t instanceof Function?t(i):t,c=s.tr.delete(o,a),u=c.doc.resolve(o),d=u.blockRange(),h=d&&F_(d,e,l);if(!h)return null;c.wrap(d,h);let f=c.doc.resolve(o-1).nodeBefore;return f&&f.type==e&&od(c.doc,o-1)&&(!r||r(i,f))&&c.join(o-1),c})}function Gk(n,e,t=null){return new yn(n,(r,s,i,o)=>{let a=r.doc.resolve(i),l=t instanceof Function?t(s):t;return a.node(-1).canReplaceWith(a.index(-1),a.indexAfter(-1),e)?r.tr.delete(i,o).setBlockType(i,i,e,l):null})}const ys=typeof navigator<"u"?navigator:null,n0=typeof document<"u"?document:null,Mi=ys&&ys.userAgent||"",Kf=/Edge\/(\d+)/.exec(Mi),Jk=/MSIE \d/.exec(Mi),Gf=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Mi),wm=!!(Jk||Gf||Kf);Jk?document.documentMode:Gf?+Gf[1]:Kf&&+Kf[1];const oV=!wm&&/gecko\/(\d+)/i.test(Mi);oV&&+(/Firefox\/(\d+)/.exec(Mi)||[0,0])[1];const r0=!wm&&/Chrome\/(\d+)/.exec(Mi);r0&&+r0[1];const aV=!wm&&!!ys&&/Apple Computer/.test(ys.vendor),lV=aV&&(/Mobile\/\w+/.test(Mi)||!!ys&&ys.maxTouchPoints>2);lV||ys&&/Mac/.test(ys.platform);const cV=!!n0&&"webkitFontSmoothing"in n0.documentElement.style;cV&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];function wh(n,e,t,r,s,i){if(n.composing)return!1;const o=n.state,a=o.doc.resolve(e);if(a.parent.type.spec.code)return!1;const l=a.parent.textBetween(Math.max(0,a.parentOffset-500),a.parentOffset,void 0,"￼")+r;for(let c of s){const u=c,d=u.match.exec(l),h=d&&d[0]&&u.handler(o,d,e-(d[0].length-r.length),t);if(h)return u.undoable!==!1&&h.setMeta(i,{transform:h,from:e,to:t,text:r}),n.dispatch(h),!0}return!1}const uV=new Dt("MILKDOWN_CUSTOM_INPUTRULES");function dV({rules:n}){const e=new Lt({key:uV,isInputRules:!0,state:{init(){return null},apply(t,r){const s=t.getMeta(this);return s||(t.selectionSet||t.docChanged?null:r)}},props:{handleTextInput(t,r,s,i){return wh(t,r,s,i,n,e)},handleDOMEvents:{compositionend:t=>(setTimeout(()=>{const{$cursor:r}=t.state.selection;r&&wh(t,r.pos,r.pos,"",n,e)}),!1)},handleKeyDown(t,r){if(r.key!=="Enter")return!1;const{$cursor:s}=t.state.selection;return s?wh(t,s.pos,s.pos,"\n",n,e):!1}}});return e}function pl(n,e,t={}){return new yn(n,(r,s,i,o)=>{var a,l,c,u;const{tr:d}=r,h=s.length;let f=s[h-1],p=s[0],m=[],g=o;const b={group:f,fullMatch:p,start:i,end:o},_=(a=t.updateCaptured)==null?void 0:a.call(t,b);if(Object.assign(b,_),{group:f,fullMatch:p,start:i,end:o}=b,p===null||(f==null?void 0:f.trim())==="")return null;if(f){const M=p.search(/\S/),k=i+p.indexOf(f),C=k+f.length;m=(l=d.storedMarks)!=null?l:[],C<o&&d.delete(C,o),k>i&&d.delete(i+M,k),g=i+M+f.length;const x=(c=t.getAttr)==null?void 0:c.call(t,s);d.addMark(i,g,e.create(x)),d.setStoredMarks(m),(u=t.beforeDispatch)==null||u.call(t,{match:s,start:i,end:o,tr:d})}return d})}var hV=Object.defineProperty,fV=Object.defineProperties,pV=Object.getOwnPropertyDescriptors,s0=Object.getOwnPropertySymbols,mV=Object.prototype.hasOwnProperty,gV=Object.prototype.propertyIsEnumerable,i0=(n,e,t)=>e in n?hV(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,yV=(n,e)=>{for(var t in e||(e={}))mV.call(e,t)&&i0(n,t,e[t]);if(s0)for(var t of s0(e))gV.call(e,t)&&i0(n,t,e[t]);return n},vV=(n,e)=>fV(n,pV(e));function o0(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function _m(n,e,t){const s=n.state.doc.content.size,i=o0(e,0,s),o=o0(t,0,s),a=n.coordsAtPos(i),l=n.coordsAtPos(o,-1),c=Math.min(a.top,l.top),u=Math.max(a.bottom,l.bottom),d=Math.min(a.left,l.left),h=Math.max(a.right,l.right),f=h-d,p=u-c,b={top:c,bottom:u,left:d,right:h,width:f,height:p,x:d,y:c};return vV(yV({},b),{toJSON:()=>b})}function pd(n){return Object.assign(Object.create(n),n).setTime(Date.now())}function bV(n,e){return Array.isArray(n)&&n.includes(e.type)||e.type===n}function wV(n){return e=>{for(let t=e.depth;t>0;t-=1){const r=e.node(t);if(n(r)){const s=e.before(t),i=e.after(t);return{from:s,to:i,node:r}}}}}function _V(n,e){return wV(t=>t.type===e)(n)}function Xk(n){return e=>{for(let t=e.depth;t>0;t--){const r=e.node(t);if(n(r))return{pos:t>0?e.before(t):0,start:e.start(t),depth:t,node:r}}}}function kV(n,e){if(!(n instanceof pe))return;const{node:t,$from:r}=n;if(bV(e,t))return{node:t,pos:r.pos,start:r.start(r.depth),depth:r.depth}}var vs={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Tu={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},xV=typeof navigator<"u"&&/Mac/.test(navigator.platform),CV=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Nt=0;Nt<10;Nt++)vs[48+Nt]=vs[96+Nt]=String(Nt);for(var Nt=1;Nt<=24;Nt++)vs[Nt+111]="F"+Nt;for(var Nt=65;Nt<=90;Nt++)vs[Nt]=String.fromCharCode(Nt+32),Tu[Nt]=String.fromCharCode(Nt);for(var _h in vs)Tu.hasOwnProperty(_h)||(Tu[_h]=vs[_h]);function SV(n){var e=xV&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||CV&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Tu:vs)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const MV=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),TV=typeof navigator<"u"&&/Win/.test(navigator.platform);function OV(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,s,i,o;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))MV?o=!0:s=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(t="Alt-"+t),s&&(t="Ctrl-"+t),o&&(t="Meta-"+t),i&&(t="Shift-"+t),t}function DV(n){let e=Object.create(null);for(let t in n)e[OV(t)]=n[t];return e}function kh(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function Qk(n){return new Lt({props:{handleKeyDown:Zk(n)}})}function Zk(n){let e=DV(n);return function(t,r){let s=SV(r),i,o=e[kh(s,r)];if(o&&o(t.state,t.dispatch,t))return!0;if(s.length==1&&s!=" "){if(r.shiftKey){let a=e[kh(s,r,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(TV&&r.ctrlKey&&r.altKey)&&(i=vs[r.keyCode])&&i!=s){let a=e[kh(i,r)];if(a&&a(t.state,t.dispatch,t))return!0}}return!1}}var ex=n=>{throw TypeError(n)},tx=(n,e,t)=>e.has(n)||ex("Cannot "+t),ae=(n,e,t)=>(tx(n,e,"read from private field"),t?t.call(n):e.get(n)),Et=(n,e,t)=>e.has(n)?ex("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),st=(n,e,t,r)=>(tx(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),Fi,En,Vi,bn,Wr,oa,Dc,$c,sn,jr,Hi,Ec,Wi,aa,Ac,Bs,la;function Cs(n,e){return n.meta={package:"@milkdown/core",group:"System",...e},n}const nx={strong:(n,e,t,r)=>{const s=n.marker||t.options.strong||"*",i=t.enter("strong"),o=t.createTracker(r);let a=o.move(s+s);return a+=o.move(t.containerPhrasing(n,{before:a,after:s,...o.current()})),a+=o.move(s+s),i(),a},emphasis:(n,e,t,r)=>{const s=n.marker||t.options.emphasis||"*",i=t.enter("emphasis"),o=t.createTracker(r);let a=o.move(s);return a+=o.move(t.containerPhrasing(n,{before:a,after:s,...o.current()})),a+=o.move(s),i(),a}},Dr=Le({},"editorView"),ca=Le({},"editorState"),xh=Le([],"initTimer"),a0=Le({},"editor"),Qa=Le([],"inputRules"),or=Le([],"prosePlugins"),Za=Le([],"remarkPlugins"),Jf=Le([],"nodeView"),Xf=Le([],"markView"),ri=Le(Vh().use(Hh).use(Wh),"remark"),Oa=Le({handlers:nx},"remarkStringifyOptions"),Pc=xs("ConfigReady");function $V(n){const e=t=>(t.record(Pc),async()=>(await n(t),t.done(Pc),()=>{t.clearTimer(Pc)}));return Cs(e,{displayName:"Config"}),e}const si=xs("InitReady");function EV(n){const e=t=>(t.inject(a0,n).inject(or,[]).inject(Za,[]).inject(Qa,[]).inject(Jf,[]).inject(Xf,[]).inject(Oa,{handlers:nx}).inject(ri,Vh().use(Hh).use(Wh)).inject(xh,[Pc]).record(si),async()=>{await t.waitTimers(xh);const r=t.get(Oa);return t.set(ri,Vh().use(Hh).use(Wh,r)),t.done(si),()=>{t.remove(a0).remove(or).remove(Za).remove(Qa).remove(Jf).remove(Xf).remove(Oa).remove(ri).remove(xh).clearTimer(si)}});return Cs(e,{displayName:"Init"}),e}const tr=xs("SchemaReady"),Ch=Le([],"schemaTimer"),ds=Le({},"schema"),Qi=Le([],"nodes"),Zi=Le([],"marks");function l0(n){var e;return{...n,parseDOM:(e=n.parseDOM)==null?void 0:e.map(t=>({priority:n.priority,...t}))}}const rx=n=>(n.inject(ds,{}).inject(Qi,[]).inject(Zi,[]).inject(Ch,[si]).record(tr),async()=>{await n.waitTimers(Ch);const e=n.get(ri),r=n.get(Za).reduce((a,l)=>a.use(l.plugin,l.options),e);n.set(ri,r);const s=Object.fromEntries(n.get(Qi).map(([a,l])=>[a,l0(l)])),i=Object.fromEntries(n.get(Zi).map(([a,l])=>[a,l0(l)])),o=new jL({nodes:s,marks:i});return n.set(ds,o),n.done(tr),()=>{n.remove(ds).remove(Qi).remove(Zi).remove(Ch).clearTimer(tr)}});Cs(rx,{displayName:"Schema"});class sx{constructor(){Et(this,Fi),Et(this,En),st(this,Fi,new Ik),st(this,En,null),this.setCtx=e=>{st(this,En,e)},this.chain=()=>{if(ae(this,En)==null)throw vh();const e=ae(this,En),t=[],r=this.get,s={run:()=>{const o=fl(...t),a=e.get(Dr);return o(a.state,a.dispatch,a)},inline:o=>(t.push(o),s),pipe:i};function i(o,a){const l=r(o);return t.push(l(a)),s}return s}}get ctx(){return ae(this,En)}create(e,t){const r=e.create(ae(this,Fi).sliceMap);return r.set(t),r}get(e){return ae(this,Fi).get(e).get()}remove(e){return ae(this,Fi).remove(e)}call(e,t){if(ae(this,En)==null)throw vh();const s=this.get(e)(t),i=ae(this,En).get(Dr);return s(i.state,i.dispatch,i)}inline(e){if(ae(this,En)==null)throw vh();const t=ae(this,En).get(Dr);return e(t.state,t.dispatch,t)}}Fi=new WeakMap;En=new WeakMap;function AV(n="cmdKey"){return Le(()=>()=>!1,n)}const ve=Le(new sx,"commands"),Sh=Le([tr],"commandsTimer"),Da=xs("CommandsReady"),ix=n=>{const e=new sx;return e.setCtx(n),n.inject(ve,e).inject(Sh,[tr]).record(Da),async()=>(await n.waitTimers(Sh),n.done(Da),()=>{n.remove(ve).remove(Sh).clearTimer(Da)})};Cs(ix,{displayName:"Commands"});const Rc=xs("ParserReady"),ox=()=>{throw pm()},Nc=Le(ox,"parser"),Mh=Le([],"parserTimer"),ax=n=>(n.inject(Nc,ox).inject(Mh,[tr]).record(Rc),async()=>{await n.waitTimers(Mh);const e=n.get(ri),t=n.get(ds);return n.set(Nc,LF.create(t,e)),n.done(Rc),()=>{n.remove(Nc).remove(Mh).clearTimer(Rc)}});Cs(ax,{displayName:"Parser"});const $a=xs("SerializerReady"),Th=Le([],"serializerTimer"),lx=()=>{throw pm()},Ic=Le(lx,"serializer"),cx=n=>(n.inject(Ic,lx).inject(Th,[tr]).record($a),async()=>{await n.waitTimers(Th);const e=n.get(ri),t=n.get(ds);return n.set(Ic,BF.create(t,e)),n.done($a),()=>{n.remove(Ic).remove(Th).clearTimer($a)}});Cs(cx,{displayName:"Serializer"});const Lc=Le("","defaultValue"),Oh=Le(n=>n,"stateOptions"),Dh=Le([],"editorStateTimer"),zc=xs("EditorStateReady");function PV(n,e,t){if(typeof n=="string")return e(n);if(n.type==="html")return co.fromSchema(t).parse(n.dom);if(n.type==="json")return as.fromJSON(t,n.value);throw _F(n)}const RV=new Dt("MILKDOWN_STATE_TRACKER");function NV(n){const e=fl(iV,gm,Hk,Wk);return n.Backspace=e,n}const ux=n=>(n.inject(Lc,"").inject(ca,{}).inject(Oh,e=>e).inject(Dh,[Rc,$a,Da]).record(zc),async()=>{await n.waitTimers(Dh);const e=n.get(ds),t=n.get(Nc),r=n.get(Qa),s=n.get(Oh),i=n.get(or),o=n.get(Lc),a=PV(o,t,e),l=[...i,new Lt({key:RV,state:{init:()=>{},apply:(d,h,f,p)=>{n.set(ca,p)}}}),dV({rules:r}),Qk(NV(rV))];n.set(or,l);const c=s({schema:e,doc:a,plugins:l}),u=qi.create(c);return n.set(ca,u),n.done(zc),()=>{n.remove(Lc).remove(ca).remove(Oh).remove(Dh).clearTimer(zc)}});Cs(ux,{displayName:"EditorState"});const Bc=xs("EditorViewReady"),$h=Le([],"editorViewTimer"),Fc=Le({},"editorViewOptions"),Vc=Le(null,"root"),Qf=Le(null,"rootDOM"),Zf=Le({},"rootAttrs");function IV(n,e){const t=document.createElement("div");t.className="milkdown",n.appendChild(t),e.set(Qf,t);const r=e.get(Zf);return Object.entries(r).forEach(([s,i])=>t.setAttribute(s,i)),t}function LV(n){n.classList.add("editor"),n.setAttribute("role","textbox")}const zV=new Dt("MILKDOWN_VIEW_CLEAR"),dx=n=>(n.inject(Vc,document.body).inject(Dr,{}).inject(Fc,{}).inject(Qf,null).inject(Zf,{}).inject($h,[zc]).record(Bc),async()=>{await n.wait(si);const e=n.get(Vc)||document.body,t=typeof e=="string"?document.querySelector(e):e;n.update(or,l=>[new Lt({key:zV,view:c=>{const u=t?IV(t,n):void 0;return(()=>{if(u&&t){const h=c.dom;t.replaceChild(u,h),u.appendChild(h)}})(),{destroy:()=>{u!=null&&u.parentNode&&(u==null||u.parentNode.replaceChild(c.dom,u)),u==null||u.remove()}}}}),...l]),await n.waitTimers($h);const r=n.get(ca),s=n.get(Fc),i=Object.fromEntries(n.get(Jf)),o=Object.fromEntries(n.get(Xf)),a=new rF(t,{state:r,nodeViews:i,markViews:o,...s});return LV(a.dom),n.set(Dr,a),n.done(Bc),()=>{a==null||a.destroy(),n.remove(Vc).remove(Dr).remove(Fc).remove(Qf).remove(Zf).remove($h).clearTimer(Bc)}});Cs(dx,{displayName:"EditorView"});const BV=class hx{constructor(){Et(this,Vi),Et(this,bn),Et(this,Wr),Et(this,oa),Et(this,Dc),Et(this,$c),Et(this,sn),Et(this,jr),Et(this,Hi),Et(this,Ec),Et(this,Wi),Et(this,aa),Et(this,Ac),Et(this,Bs),Et(this,la),st(this,Vi,!1),st(this,bn,"Idle"),st(this,Wr,[]),st(this,oa,()=>{}),st(this,Dc,new Ik),st(this,$c,new RF),st(this,sn,new Map),st(this,jr,new Map),st(this,Hi,new PF(ae(this,Dc),ae(this,$c))),st(this,Ec,()=>{const e=$V(async r=>{await Promise.all(ae(this,Wr).map(s=>s(r)))}),t=[rx,ax,cx,ix,ux,dx,EV(this),e];ae(this,Wi).call(this,t,ae(this,jr))}),st(this,Wi,(e,t)=>{e.forEach(r=>{const s=ae(this,Hi).produce(ae(this,Vi)?r.meta:void 0),i=r(s);t.set(r,{ctx:s,handler:i,cleanup:void 0})})}),st(this,aa,(e,t=!1)=>Promise.all([e].flat().map(r=>{const s=ae(this,sn).get(r),i=s==null?void 0:s.cleanup;return t?ae(this,sn).delete(r):ae(this,sn).set(r,{ctx:void 0,handler:void 0,cleanup:void 0}),typeof i=="function"?i():i}))),st(this,Ac,async()=>{await Promise.all([...ae(this,jr).entries()].map(([e,{cleanup:t}])=>typeof t=="function"?t():t)),ae(this,jr).clear()}),st(this,Bs,e=>{st(this,bn,e),ae(this,oa).call(this,e)}),st(this,la,e=>[...e.entries()].map(async([t,r])=>{const{ctx:s,handler:i}=r;if(!i)return;const o=await i();e.set(t,{ctx:s,handler:i,cleanup:o})})),this.enableInspector=(e=!0)=>(st(this,Vi,e),this),this.onStatusChange=e=>(st(this,oa,e),this),this.config=e=>(ae(this,Wr).push(e),this),this.removeConfig=e=>(st(this,Wr,ae(this,Wr).filter(t=>t!==e)),this),this.use=e=>{const t=[e].flat();return t.flat().forEach(r=>{ae(this,sn).set(r,{ctx:void 0,handler:void 0,cleanup:void 0})}),ae(this,bn)==="Created"&&ae(this,Wi).call(this,t,ae(this,sn)),this},this.remove=async e=>ae(this,bn)==="OnCreate"?(console.warn("[Milkdown]: You are trying to remove plugins when the editor is creating, this is not recommended, please check your code."),new Promise(t=>{setTimeout(()=>{t(this.remove(e))},50)})):(await ae(this,aa).call(this,[e].flat(),!0),this),this.create=async()=>ae(this,bn)==="OnCreate"?this:(ae(this,bn)==="Created"&&await this.destroy(),ae(this,Bs).call(this,"OnCreate"),ae(this,Ec).call(this),ae(this,Wi).call(this,[...ae(this,sn).keys()],ae(this,sn)),await Promise.all([ae(this,la).call(this,ae(this,jr)),ae(this,la).call(this,ae(this,sn))].flat()),ae(this,Bs).call(this,"Created"),this),this.destroy=async(e=!1)=>ae(this,bn)==="Destroyed"||ae(this,bn)==="OnDestroy"?this:ae(this,bn)==="OnCreate"?new Promise(t=>{setTimeout(()=>{t(this.destroy(e))},50)}):(e&&st(this,Wr,[]),ae(this,Bs).call(this,"OnDestroy"),await ae(this,aa).call(this,[...ae(this,sn).keys()],e),await ae(this,Ac).call(this),ae(this,Bs).call(this,"Destroyed"),this),this.action=e=>e(ae(this,Hi)),this.inspect=()=>ae(this,Vi)?[...ae(this,jr).values(),...ae(this,sn).values()].map(({ctx:e})=>{var t;return(t=e==null?void 0:e.inspector)==null?void 0:t.read()}).filter(e=>!!e):(console.warn("[Milkdown]: You are trying to collect inspection when inspector is disabled, please enable inspector by `editor.enableInspector()` first."),[])}static make(){return new hx}get ctx(){return ae(this,Hi)}get status(){return ae(this,bn)}};Vi=new WeakMap;bn=new WeakMap;Wr=new WeakMap;oa=new WeakMap;Dc=new WeakMap;$c=new WeakMap;sn=new WeakMap;jr=new WeakMap;Hi=new WeakMap;Ec=new WeakMap;Wi=new WeakMap;aa=new WeakMap;Ac=new WeakMap;Bs=new WeakMap;la=new WeakMap;let FV=BV;var Ou=200,Ot=function(){};Ot.prototype.append=function(e){return e.length?(e=Ot.from(e),!this.length&&e||e.length<Ou&&this.leafAppend(e)||this.length<Ou&&e.leafPrepend(this)||this.appendInner(e)):this};Ot.prototype.prepend=function(e){return e.length?Ot.from(e).append(this):this};Ot.prototype.appendInner=function(e){return new VV(this,e)};Ot.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?Ot.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};Ot.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Ot.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};Ot.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var s=[];return this.forEach(function(i,o){return s.push(e(i,o))},t,r),s};Ot.from=function(e){return e instanceof Ot?e:e&&e.length?new fx(e):Ot.empty};var fx=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(s,i){return s==0&&i==this.length?this:new e(this.values.slice(s,i))},e.prototype.getInner=function(s){return this.values[s]},e.prototype.forEachInner=function(s,i,o,a){for(var l=i;l<o;l++)if(s(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(s,i,o,a){for(var l=i-1;l>=o;l--)if(s(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(s){if(this.length+s.length<=Ou)return new e(this.values.concat(s.flatten()))},e.prototype.leafPrepend=function(s){if(this.length+s.length<=Ou)return new e(s.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(Ot);Ot.empty=new fx([]);var VV=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,s,i,o){var a=this.left.length;if(s<a&&this.left.forEachInner(r,s,Math.min(i,a),o)===!1||i>a&&this.right.forEachInner(r,Math.max(s-a,0),Math.min(this.length,i)-a,o+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,s,i,o){var a=this.left.length;if(s>a&&this.right.forEachInvertedInner(r,s-a,Math.max(i,a)-a,o+a)===!1||i<a&&this.left.forEachInvertedInner(r,Math.min(s,a),i,o)===!1)return!1},e.prototype.sliceInner=function(r,s){if(r==0&&s==this.length)return this;var i=this.left.length;return s<=i?this.left.slice(r,s):r>=i?this.right.slice(r-i,s-i):this.left.slice(r,i).append(this.right.slice(0,s-i))},e.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new e(this.left,s)},e.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new e(s,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(Ot);const HV=500;class An{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,i;t&&(s=this.remapping(r,this.items.length),i=s.maps.length);let o=e.tr,a,l,c=[],u=[];return this.items.forEach((d,h)=>{if(!d.step){s||(s=this.remapping(r,h+1),i=s.maps.length),i--,u.push(d);return}if(s){u.push(new Kn(d.map));let f=d.step.map(s.slice(i)),p;f&&o.maybeStep(f).doc&&(p=o.mapping.maps[o.mapping.maps.length-1],c.push(new Kn(p,void 0,void 0,c.length+u.length))),i--,p&&s.appendMap(p,i)}else o.maybeStep(d.step);if(d.selection)return a=s?d.selection.map(s.slice(i)):d.selection,l=new An(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:o,selection:a}}addTransform(e,t,r,s){let i=[],o=this.eventCount,a=this.items,l=!s&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let d=e.steps[u].invert(e.docs[u]),h=new Kn(e.mapping.maps[u],d,t),f;(f=l&&l.merge(h))&&(h=f,u?i.pop():a=a.slice(0,a.length-1)),i.push(h),t&&(o++,t=void 0),s||(l=h)}let c=o-r.depth;return c>jV&&(a=WV(a,c),o-=c),new An(a.append(i),o)}remapping(e,t){let r=new qa;return this.items.forEach((s,i)=>{let o=s.mirrorOffset!=null&&i-s.mirrorOffset>=e?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,o)},e,t),r}addMaps(e){return this.eventCount==0?this:new An(this.items.append(e.map(t=>new Kn(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-t),i=e.mapping,o=e.steps.length,a=this.eventCount;this.items.forEach(h=>{h.selection&&a--},s);let l=t;this.items.forEach(h=>{let f=i.getMirror(--l);if(f==null)return;o=Math.min(o,f);let p=i.maps[f];if(h.step){let m=e.steps[f].invert(e.docs[f]),g=h.selection&&h.selection.map(i.slice(l+1,f));g&&a++,r.push(new Kn(p,m,g))}else r.push(new Kn(p))},s);let c=[];for(let h=t;h<o;h++)c.push(new Kn(i.maps[h]));let u=this.items.slice(0,s).append(c).append(r),d=new An(u,a);return d.emptyItemCount()>HV&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,s=[],i=0;return this.items.forEach((o,a)=>{if(a>=e)s.push(o),o.selection&&i++;else if(o.step){let l=o.step.map(t.slice(r)),c=l&&l.getMap();if(r--,c&&t.appendMap(c,r),l){let u=o.selection&&o.selection.map(t.slice(r));u&&i++;let d=new Kn(c.invert(),l,u),h,f=s.length-1;(h=s.length&&s[f].merge(d))?s[f]=h:s.push(d)}}else o.map&&r--},this.items.length,0),new An(Ot.from(s.reverse()),i)}}An.empty=new An(Ot.empty,0);function WV(n,e){let t;return n.forEach((r,s)=>{if(r.selection&&e--==0)return t=s,!1}),n.slice(t)}class Kn{constructor(e,t,r,s){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=s}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new Kn(t.getMap().invert(),t,this.selection)}}}class Yr{constructor(e,t,r,s,i){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=s,this.prevComposition=i}}const jV=20;function UV(n,e,t,r){let s=t.getMeta(ii),i;if(s)return s.historyState;t.getMeta(KV)&&(n=new Yr(n.done,n.undone,null,0,-1));let o=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(o&&o.getMeta(ii))return o.getMeta(ii).redo?new Yr(n.done.addTransform(t,void 0,r,Hc(e)),n.undone,c0(t.mapping.maps),n.prevTime,n.prevComposition):new Yr(n.done,n.undone.addTransform(t,void 0,r,Hc(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let a=t.getMeta("composition"),l=n.prevTime==0||!o&&n.prevComposition!=a&&(n.prevTime<(t.time||0)-r.newGroupDelay||!qV(t,n.prevRanges)),c=o?Eh(n.prevRanges,t.mapping):c0(t.mapping.maps);return new Yr(n.done.addTransform(t,l?e.selection.getBookmark():void 0,r,Hc(e)),An.empty,c,t.time,a==null?n.prevComposition:a)}else return(i=t.getMeta("rebased"))?new Yr(n.done.rebased(t,i),n.undone.rebased(t,i),Eh(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new Yr(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),Eh(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function qV(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,s)=>{for(let i=0;i<e.length;i+=2)r<=e[i+1]&&s>=e[i]&&(t=!0)}),t}function c0(n){let e=[];for(let t=n.length-1;t>=0&&e.length==0;t--)n[t].forEach((r,s,i,o)=>e.push(i,o));return e}function Eh(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let s=e.map(n[r],1),i=e.map(n[r+1],-1);s<=i&&t.push(s,i)}return t}function YV(n,e,t){let r=Hc(e),s=ii.get(e).spec.config,i=(t?n.undone:n.done).popEvent(e,r);if(!i)return null;let o=i.selection.resolve(i.transform.doc),a=(t?n.done:n.undone).addTransform(i.transform,e.selection.getBookmark(),s,r),l=new Yr(t?a:i.remaining,t?i.remaining:a,null,0,-1);return i.transform.setSelection(o).setMeta(ii,{redo:t,historyState:l})}let Ah=!1,u0=null;function Hc(n){let e=n.plugins;if(u0!=e){Ah=!1,u0=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Ah=!0;break}}return Ah}const ii=new Dt("history"),KV=new Dt("closeHistory");function GV(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new Lt({key:ii,state:{init(){return new Yr(An.empty,An.empty,null,0,-1)},apply(e,t,r){return UV(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,s=r=="historyUndo"?mx:r=="historyRedo"?gx:null;return s?(t.preventDefault(),s(e.state,e.dispatch)):!1}}}})}function px(n,e){return(t,r)=>{let s=ii.getState(t);if(!s||(n?s.undone:s.done).eventCount==0)return!1;if(r){let i=YV(s,t,n);i&&r(e?i.scrollIntoView():i)}return!0}}const mx=px(!1,!0),gx=px(!0,!0);let JV=n=>crypto.getRandomValues(new Uint8Array(n)),XV=(n,e,t)=>{let r=(2<<Math.log2(n.length-1))-1,s=-~(1.6*r*e/n.length);return(i=e)=>{let o="";for(;;){let a=t(s),l=s|0;for(;l--;)if(o+=n[a[l]&r]||"",o.length>=i)return o}}},QV=(n,e=21)=>XV(n,e|0,JV);QV("abcedfghicklmn",10);function xe(n,e){const t=AV(n),r=s=>async()=>{r.key=t,await s.wait(Da);const i=e(s);return s.get(ve).create(t,i),r.run=o=>s.get(ve).call(n,o),()=>{s.get(ve).remove(t)}};return r}function en(n){const e=t=>async()=>{await t.wait(tr);const r=n(t);return t.update(Qa,s=>[...s,r]),e.inputRule=r,()=>{t.update(Qa,s=>s.filter(i=>i!==r))}};return e}function ZV(n,e){const t=r=>async()=>{const s=e(r);return r.update(Zi,i=>[...i.filter(o=>o[0]!==n),[n,s]]),t.id=n,t.schema=s,()=>{r.update(Zi,i=>i.filter(([o])=>o!==n))}};return t.type=r=>{const s=r.get(ds).marks[n];if(!s)throw OF(n);return s},t}function km(n,e){const t=r=>async()=>{const s=e(r);return r.update(Qi,i=>[...i.filter(o=>o[0]!==n),[n,s]]),t.id=n,t.schema=s,()=>{r.update(Qi,i=>i.filter(([o])=>o!==n))}};return t.type=r=>{const s=r.get(ds).nodes[n];if(!s)throw TF(n);return s},t}function vn(n){let e;const t=r=>async()=>(await r.wait(tr),e=n(r),r.update(or,s=>[...s,e]),()=>{r.update(or,s=>s.filter(i=>i!==e))});return t.plugin=()=>e,t.key=()=>e.spec.key,t}function eH(n){const e=t=>async()=>{await t.wait(tr);const r=n(t),s=Qk(r);return t.update(or,i=>[...i,s]),e.keymap=r,()=>{t.update(or,i=>i.filter(o=>o!==s))}};return e}function tn(n,e){const t=Le(n,e),r=s=>(s.inject(t),()=>()=>{s.remove(t)});return r.key=t,r}function $t(n,e){const t=tn(e,n),r=km(n,i=>i.get(t.key)(i)),s=[t,r];return s.id=r.id,s.node=r,s.type=i=>r.type(i),s.schema=r.schema,s.ctx=t,s.key=t.key,s.extendSchema=i=>o=>()=>{const a=o.get(t.key),c=i(a)(o);o.update(Qi,u=>[...u.filter(d=>d[0]!==n),[n,c]]),s.schema=c},s}function ml(n,e){const t=tn(e,n),r=ZV(n,i=>i.get(t.key)(i)),s=[t,r];return s.id=r.id,s.mark=r,s.type=r.type,s.schema=r.schema,s.ctx=t,s.key=t.key,s.extendSchema=i=>o=>()=>{const a=o.get(t.key),c=i(a)(o);o.update(Zi,u=>[...u.filter(d=>d[0]!==n),[n,c]]),s.schema=c},s}function nn(n,e){const t=Object.fromEntries(Object.entries(e).map(([o,{shortcuts:a}])=>[o,a])),r=tn(t,"".concat(n,"Keymap")),s=eH(o=>{const a=o.get(r.key),l=Object.entries(e).flatMap(([c,{command:u}])=>[a[c]].flat().map(h=>[h,u(o)]));return Object.fromEntries(l)}),i=[r,s];return i.ctx=r,i.shortcuts=s,i.key=r.key,i.keymap=s.keymap,i}const Bn=(n,e=()=>({}))=>tn(e,"".concat(n,"Attr")),gl=(n,e=()=>({}))=>tn(e,"".concat(n,"Attr"));function Ti(n,e,t){const r=tn(t!=null?t:{},n),s=o=>async()=>{await o.wait(si);const l={plugin:e(o),options:o.get(r.key)};return o.update(Za,c=>[...c,l]),()=>{o.update(Za,c=>c.filter(u=>u!==l))}},i=[r,s];return i.id=n,i.plugin=s,i.options=r,i}function tH(n,e){return t=>t.get(ve).call(n,e)}function ko(n,e){return Object.assign(n,{meta:{package:"@milkdown/plugin-history",...e}}),n}const md=xe("Undo",()=>()=>mx);ko(md,{displayName:"Command<undo>"});const gd=xe("Redo",()=>()=>gx);ko(gd,{displayName:"Command<redo>"});const xm=tn({},"historyProviderConfig");ko(xm,{displayName:"Ctx<historyProviderConfig>"});const yx=vn(n=>GV(n.get(xm.key)));ko(yx,{displayName:"Ctx<historyProviderPlugin>"});const Cm=nn("historyKeymap",{Undo:{shortcuts:"Mod-z",command:n=>{const e=n.get(ve);return()=>e.call(md.key)}},Redo:{shortcuts:["Mod-y","Shift-Mod-z"],command:n=>{const e=n.get(ve);return()=>e.call(gd.key)}}});ko(Cm.ctx,{displayName:"KeymapCtx<history>"});ko(Cm.shortcuts,{displayName:"Keymap<history>"});const nH=[xm,yx,Cm,md,gd].flat();var rH="Expected a function",d0=0/0,sH="[object Symbol]",iH=/^\s+|\s+$/g,oH=/^[-+]0x[0-9a-f]+$/i,aH=/^0b[01]+$/i,lH=/^0o[0-7]+$/i,cH=parseInt,uH=typeof _r=="object"&&_r&&_r.Object===Object&&_r,dH=typeof self=="object"&&self&&self.Object===Object&&self,hH=uH||dH||Function("return this")(),fH=Object.prototype,pH=fH.toString,mH=Math.max,gH=Math.min,Ph=function(){return hH.Date.now()};function yH(n,e,t){var r,s,i,o,a,l,c=0,u=!1,d=!1,h=!0;if(typeof n!="function")throw new TypeError(rH);e=h0(e)||0,ep(t)&&(u=!!t.leading,d="maxWait"in t,i=d?mH(h0(t.maxWait)||0,e):i,h="trailing"in t?!!t.trailing:h);function f(x){var D=r,O=s;return r=s=void 0,c=x,o=n.apply(O,D),o}function p(x){return c=x,a=setTimeout(b,e),u?f(x):o}function m(x){var D=x-l,O=x-c,E=e-D;return d?gH(E,i-O):E}function g(x){var D=x-l,O=x-c;return l===void 0||D>=e||D<0||d&&O>=i}function b(){var x=Ph();if(g(x))return _(x);a=setTimeout(b,m(x))}function _(x){return a=void 0,h&&r?f(x):(r=s=void 0,o)}function M(){a!==void 0&&clearTimeout(a),c=0,r=l=s=a=void 0}function k(){return a===void 0?o:_(Ph())}function C(){var x=Ph(),D=g(x);if(r=arguments,s=this,l=x,D){if(a===void 0)return p(l);if(d)return a=setTimeout(b,e),f(l)}return a===void 0&&(a=setTimeout(b,e)),o}return C.cancel=M,C.flush=k,C}function ep(n){var e=typeof n;return!!n&&(e=="object"||e=="function")}function vH(n){return!!n&&typeof n=="object"}function bH(n){return typeof n=="symbol"||vH(n)&&pH.call(n)==sH}function h0(n){if(typeof n=="number")return n;if(bH(n))return d0;if(ep(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=ep(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=n.replace(iH,"");var t=aH.test(n);return t||lH.test(n)?cH(n.slice(2),t?2:8):oH.test(n)?d0:+n}var wH=yH;const _H=yp(wH);class vx{constructor(){this.beforeMountedListeners=[],this.mountedListeners=[],this.updatedListeners=[],this.markdownUpdatedListeners=[],this.blurListeners=[],this.focusListeners=[],this.destroyListeners=[],this.beforeMount=e=>(this.beforeMountedListeners.push(e),this),this.mounted=e=>(this.mountedListeners.push(e),this),this.updated=e=>(this.updatedListeners.push(e),this)}get listeners(){return{beforeMount:this.beforeMountedListeners,mounted:this.mountedListeners,updated:this.updatedListeners,markdownUpdated:this.markdownUpdatedListeners,blur:this.blurListeners,focus:this.focusListeners,destroy:this.destroyListeners}}markdownUpdated(e){return this.markdownUpdatedListeners.push(e),this}blur(e){return this.blurListeners.push(e),this}focus(e){return this.focusListeners.push(e),this}destroy(e){return this.destroyListeners.push(e),this}}const Du=Le(new vx,"listener"),kH=new Dt("MILKDOWN_LISTENER"),bx=n=>(n.inject(Du,new vx),async()=>{await n.wait(si);const e=n.get(Du),{listeners:t}=e;t.beforeMount.forEach(a=>a(n)),await n.wait($a);const r=n.get(Ic);let s=null,i=null;const o=new Lt({key:kH,view:()=>({destroy:()=>{t.destroy.forEach(a=>a(n))}}),props:{handleDOMEvents:{focus:()=>(t.focus.forEach(a=>a(n)),!1),blur:()=>(t.blur.forEach(a=>a(n)),!1)}},state:{init:(a,l)=>{s=l.doc,i=r(l.doc)},apply:a=>!a.docChanged||a.getMeta("addToHistory")===!1?void 0:_H(()=>{const{doc:c}=a;if(t.updated.length>0&&s&&!s.eq(c)&&t.updated.forEach(u=>{u(n,c,s)}),t.markdownUpdated.length>0&&s&&!s.eq(c)){const u=r(c);t.markdownUpdated.forEach(d=>{d(n,u,i)}),i=u}s=c},200)()}});n.update(or,a=>a.concat(o)),await n.wait(Bc),t.mounted.forEach(a=>a(n))});bx.meta={package:"@milkdown/plugin-listener",displayName:"Listener"};function xH(n,e){return function(t,r){let{$from:s,$to:i,node:o}=t.selection;if(o&&o.isBlock||s.depth<2||!s.sameParent(i))return!1;let a=s.node(-1);if(a.type!=n)return!1;if(s.parent.content.size==0&&s.node(-1).childCount==s.indexAfter(-1)){if(s.depth==3||s.node(-3).type!=n||s.index(-2)!=s.node(-2).childCount-1)return!1;if(r){let d=j.empty,h=s.index(-1)?1:s.index(-2)?2:3;for(let b=s.depth-h;b>=s.depth-3;b--)d=j.from(s.node(b).copy(d));let f=s.indexAfter(-1)<s.node(-2).childCount?1:s.indexAfter(-2)<s.node(-3).childCount?2:3;d=d.append(j.from(n.createAndFill()));let p=s.before(s.depth-(h-1)),m=t.tr.replace(p,s.after(-f),new Q(d,4-h,0)),g=-1;m.doc.nodesBetween(p,m.doc.content.size,(b,_)=>{if(g>-1)return!1;b.isTextblock&&b.content.size==0&&(g=_+1)}),g>-1&&m.setSelection(ge.near(m.doc.resolve(g))),r(m.scrollIntoView())}return!0}let l=i.pos==s.end()?a.contentMatchAt(0).defaultType:null,c=t.tr.delete(s.pos,i.pos),u=l?[e?{type:n,attrs:e}:null,{type:l}]:void 0;return Sa(c.doc,s.pos,2,u)?(r&&r(c.split(s.pos,2,u).scrollIntoView()),!0):!1}}function wx(n){return function(e,t){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,o=>o.childCount>0&&o.firstChild.type==n);return i?t?r.node(i.depth-1).type==n?CH(e,t,n,i):SH(e,t,i):!0:!1}}function CH(n,e,t,r){let s=n.tr,i=r.end,o=r.$to.end(r.depth);i<o&&(s.step(new Wt(i-1,o,i,o,new Q(j.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new C_(s.doc.resolve(r.$from.pos),s.doc.resolve(o),r.depth));const a=id(r);if(a==null)return!1;s.lift(r,a);let l=s.doc.resolve(s.mapping.map(i,-1)-1);return od(s.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&s.join(l.pos),e(s.scrollIntoView()),!0}function SH(n,e,t){let r=n.tr,s=t.parent;for(let f=t.end,p=t.endIndex-1,m=t.startIndex;p>m;p--)f-=s.child(p).nodeSize,r.delete(f-1,f+1);let i=r.doc.resolve(t.start),o=i.nodeAfter;if(r.mapping.map(t.end)!=t.start+i.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==s.childCount,c=i.node(-1),u=i.index(-1);if(!c.canReplace(u+(a?0:1),u+1,o.content.append(l?j.empty:j.from(s))))return!1;let d=i.pos,h=d+o.nodeSize;return r.step(new Wt(d-(a?1:0),h+(l?1:0),d+1,h-1,new Q((a?j.empty:j.from(s.copy(j.empty))).append(l?j.empty:j.from(s.copy(j.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function MH(n){return function(e,t){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,c=>c.childCount>0&&c.firstChild.type==n);if(!i)return!1;let o=i.startIndex;if(o==0)return!1;let a=i.parent,l=a.child(o-1);if(l.type!=n)return!1;if(t){let c=l.lastChild&&l.lastChild.type==a.type,u=j.from(c?n.create():null),d=new Q(j.from(n.create(null,j.from(a.type.create(null,u)))),c?3:1,0),h=i.start,f=i.end;t(e.tr.step(new Wt(h-(c?3:1),f,h,f,d,1,!0)).scrollIntoView())}return!0}}function TH(n){const e=new Map;if(!n||!n.type)throw new Error("mdast-util-definitions expected node");return sl(n,"definition",function(r){const s=f0(r.identifier);s&&!e.get(s)&&e.set(s,r)}),t;function t(r){const s=f0(r);return e.get(s)}}function f0(n){return String(n||"").toUpperCase()}function OH(){return function(n){const e=TH(n);sl(n,function(t,r,s){if(t.type==="definition"&&s!==void 0&&typeof r=="number")return s.children.splice(r,1),[ty,r];if(t.type==="imageReference"||t.type==="linkReference"){const i=e(t.identifier);if(i&&s&&typeof r=="number")return s.children[r]=t.type==="imageReference"?{type:"image",url:i.url,title:i.title,alt:t.alt}:{type:"link",url:i.url,title:i.title,children:t.children},[ty,r]}})}}function _x(n,e){var t;if(!(e.childCount>=1&&((t=e.lastChild)==null?void 0:t.type.name)==="hardbreak")){n.next(e.content);return}const s=[];e.content.forEach((i,o,a)=>{a!==e.childCount-1&&s.push(i)}),n.next(j.fromArray(s))}function L(n,e){return Object.assign(n,{meta:{package:"@milkdown/preset-commonmark",...e}}),n}const Sm=gl("emphasis");L(Sm,{displayName:"Attr<emphasis>",group:"Emphasis"});const xo=ml("emphasis",n=>({attrs:{marker:{default:n.get(Oa).emphasis||"*",validate:"string"}},parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:e=>e==="italic"}],toDOM:e=>["em",n.get(Sm.key)(e)],parseMarkdown:{match:e=>e.type==="emphasis",runner:(e,t,r)=>{e.openMark(r,{marker:t.marker}),e.next(t.children),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="emphasis",runner:(e,t)=>{e.withMark(t,"emphasis",void 0,{marker:t.attrs.marker})}}}));L(xo.mark,{displayName:"MarkSchema<emphasis>",group:"Emphasis"});L(xo.ctx,{displayName:"MarkSchemaCtx<emphasis>",group:"Emphasis"});const yd=xe("ToggleEmphasis",n=>()=>fd(xo.type(n)));L(yd,{displayName:"Command<toggleEmphasisCommand>",group:"Emphasis"});const kx=en(n=>pl(/(?:^|[^*])\*([^*]+)\*$/,xo.type(n),{getAttr:()=>({marker:"*"}),updateCaptured:({fullMatch:e,start:t})=>e.startsWith("*")?{}:{fullMatch:e.slice(1),start:t+1}}));L(kx,{displayName:"InputRule<emphasis>|Star",group:"Emphasis"});const xx=en(n=>pl(/(?:^|[^_])_([^_]+)_$/,xo.type(n),{getAttr:()=>({marker:"_"}),updateCaptured:({fullMatch:e,start:t})=>e.startsWith("_")?{}:{fullMatch:e.slice(1),start:t+1}}));L(xx,{displayName:"InputRule<emphasis>|Underscore",group:"Emphasis"});const Mm=nn("emphasisKeymap",{ToggleEmphasis:{shortcuts:"Mod-i",command:n=>{const e=n.get(ve);return()=>e.call(yd.key)}}});L(Mm.ctx,{displayName:"KeymapCtx<emphasis>",group:"Emphasis"});L(Mm.shortcuts,{displayName:"Keymap<emphasis>",group:"Emphasis"});const Tm=gl("strong");L(Tm,{displayName:"Attr<strong>",group:"Strong"});const yl=ml("strong",n=>({attrs:{marker:{default:n.get(Oa).strong||"*",validate:"string"}},parseDOM:[{tag:"b",getAttrs:e=>e.style.fontWeight!="normal"&&null},{tag:"strong"},{style:"font-style",getAttrs:e=>e==="bold"},{style:"font-weight=400",clearMark:e=>e.type.name=="strong"},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],toDOM:e=>["strong",n.get(Tm.key)(e)],parseMarkdown:{match:e=>e.type==="strong",runner:(e,t,r)=>{e.openMark(r,{marker:t.marker}),e.next(t.children),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="strong",runner:(e,t)=>{e.withMark(t,"strong",void 0,{marker:t.attrs.marker})}}}));L(yl.mark,{displayName:"MarkSchema<strong>",group:"Strong"});L(yl.ctx,{displayName:"MarkSchemaCtx<strong>",group:"Strong"});const vd=xe("ToggleStrong",n=>()=>fd(yl.type(n)));L(vd,{displayName:"Command<toggleStrongCommand>",group:"Strong"});const Cx=en(n=>pl(/(?:\*\*|__)([^*_]+)(?:\*\*|__)$/,yl.type(n),{getAttr:e=>({marker:e[0].startsWith("*")?"*":"_"})}));L(Cx,{displayName:"InputRule<strong>",group:"Strong"});const Om=nn("strongKeymap",{ToggleBold:{shortcuts:["Mod-b"],command:n=>{const e=n.get(ve);return()=>e.call(vd.key)}}});L(Om.ctx,{displayName:"KeymapCtx<strong>",group:"Strong"});L(Om.shortcuts,{displayName:"Keymap<strong>",group:"Strong"});const Dm=gl("inlineCode");L(Dm,{displayName:"Attr<inlineCode>",group:"InlineCode"});const ss=ml("inlineCode",n=>({priority:100,code:!0,parseDOM:[{tag:"code"}],toDOM:e=>["code",n.get(Dm.key)(e)],parseMarkdown:{match:e=>e.type==="inlineCode",runner:(e,t,r)=>{e.openMark(r),e.addText(t.value),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="inlineCode",runner:(e,t,r)=>{e.withMark(t,"inlineCode",r.text||"")}}}));L(ss.mark,{displayName:"MarkSchema<inlineCode>",group:"InlineCode"});L(ss.ctx,{displayName:"MarkSchemaCtx<inlineCode>",group:"InlineCode"});const $m=xe("ToggleInlineCode",n=>()=>(e,t)=>{const{selection:r,tr:s}=e;if(r.empty)return!1;const{from:i,to:o}=r;return e.doc.rangeHasMark(i,o,ss.type(n))?(t==null||t(s.removeMark(i,o,ss.type(n))),!0):(Object.keys(e.schema.marks).filter(c=>c!==ss.type.name).map(c=>e.schema.marks[c]).forEach(c=>{s.removeMark(i,o,c)}),t==null||t(s.addMark(i,o,ss.type(n).create())),!0)});L($m,{displayName:"Command<toggleInlineCodeCommand>",group:"InlineCode"});const Sx=en(n=>pl(/(?:`)([^`]+)(?:`)$/,ss.type(n)));L(Sx,{displayName:"InputRule<inlineCodeInputRule>",group:"InlineCode"});const Em=nn("inlineCodeKeymap",{ToggleInlineCode:{shortcuts:"Mod-e",command:n=>{const e=n.get(ve);return()=>e.call($m.key)}}});L(Em.ctx,{displayName:"KeymapCtx<inlineCode>",group:"InlineCode"});L(Em.shortcuts,{displayName:"Keymap<inlineCode>",group:"InlineCode"});const Am=gl("link");L(Am,{displayName:"Attr<link>",group:"Link"});const hs=ml("link",n=>({attrs:{href:{validate:"string"},title:{default:null,validate:"string|null"}},parseDOM:[{tag:"a[href]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw cr(e);return{href:e.getAttribute("href"),title:e.getAttribute("title")}}}],toDOM:e=>["a",{...n.get(Am.key)(e),...e.attrs}],parseMarkdown:{match:e=>e.type==="link",runner:(e,t,r)=>{const s=t.url,i=t.title;e.openMark(r,{href:s,title:i}),e.next(t.children),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="link",runner:(e,t)=>{e.withMark(t,"link",void 0,{title:t.attrs.title,url:t.attrs.href})}}}));L(hs.mark,{displayName:"MarkSchema<link>",group:"Link"});const Mx=xe("ToggleLink",n=>(e={})=>fd(hs.type(n),e));L(Mx,{displayName:"Command<toggleLinkCommand>",group:"Link"});const Tx=xe("UpdateLink",n=>(e={})=>(t,r)=>{if(!r)return!1;let s,i=-1;const{selection:o}=t,{from:a,to:l}=o;if(t.doc.nodesBetween(a,a===l?l+1:l,(p,m)=>{if(hs.type(n).isInSet(p.marks))return s=p,i=m,!1}),!s)return!1;const c=s.marks.find(({type:p})=>p===hs.type(n));if(!c)return!1;const u=i,d=i+s.nodeSize,{tr:h}=t,f=hs.type(n).create({...c.attrs,...e});return f?(r(h.removeMark(u,d,c).addMark(u,d,f).setSelection(new we(h.selection.$anchor)).scrollIntoView()),!0):!1});L(Tx,{displayName:"Command<updateLinkCommand>",group:"Link"});const Ox=km("doc",()=>({content:"block+",parseMarkdown:{match:({type:n})=>n==="root",runner:(n,e,t)=>{n.injectRoot(e,t)}},toMarkdown:{match:n=>n.type.name==="doc",runner:(n,e)=>{n.openNode("root"),n.next(e.content)}}}));L(Ox,{displayName:"NodeSchema<doc>",group:"Doc"});function DH(n){return hC(n,e=>{var t;return e.type==="html"&&["<br />","<br>","<br >","<br/>"].includes((t=e.value)==null?void 0:t.trim())},(e,t)=>{if(!t.length)return;const r=t[t.length-1];if(!r)return;const s=r.children.indexOf(e);s!==-1&&r.children.splice(s,1)},!0)}const bd=Ti("remark-preserve-empty-line",()=>()=>DH);L(bd.plugin,{displayName:"Remark<remarkPreserveEmptyLine>",group:"Remark"});L(bd.options,{displayName:"RemarkConfig<remarkPreserveEmptyLine>",group:"Remark"});const wd=Bn("paragraph");L(wd,{displayName:"Attr<paragraph>",group:"Paragraph"});const Ss=$t("paragraph",n=>({content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:e=>["p",n.get(wd.key)(e),0],parseMarkdown:{match:e=>e.type==="paragraph",runner:(e,t,r)=>{e.openNode(r),t.children?e.next(t.children):e.addText(t.value||""),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="paragraph",runner:(e,t)=>{var r;const i=(r=n.get(Dr).state)==null?void 0:r.doc.lastChild;e.openNode("paragraph"),(!t.content||t.content.size===0)&&t!==i&&$H(n)?e.addNode("html",void 0,"<br />"):_x(e,t),e.closeNode()}}}));function $H(n){let e=!1;try{n.get(bd.id),e=!0}catch(t){e=!1}return e}L(Ss.node,{displayName:"NodeSchema<paragraph>",group:"Paragraph"});L(Ss.ctx,{displayName:"NodeSchemaCtx<paragraph>",group:"Paragraph"});const Pm=xe("TurnIntoText",n=>()=>Xa(Ss.type(n)));L(Pm,{displayName:"Command<turnIntoTextCommand>",group:"Paragraph"});const Rm=nn("paragraphKeymap",{TurnIntoText:{shortcuts:"Mod-Alt-0",command:n=>{const e=n.get(ve);return()=>e.call(Pm.key)}}});L(Rm.ctx,{displayName:"KeymapCtx<paragraph>",group:"Paragraph"});L(Rm.shortcuts,{displayName:"Keymap<paragraph>",group:"Paragraph"});const EH=Array(6).fill(0).map((n,e)=>e+1);function AH(n){return n.textContent.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-")}const _d=tn(AH,"headingIdGenerator");L(_d,{displayName:"Ctx<HeadingIdGenerator>",group:"Heading"});const kd=Bn("heading");L(kd,{displayName:"Attr<heading>",group:"Heading"});const Oi=$t("heading",n=>{const e=n.get(_d.key);return{content:"inline*",group:"block",defining:!0,attrs:{id:{default:"",validate:"string"},level:{default:1,validate:"number"}},parseDOM:EH.map(t=>({tag:"h".concat(t),getAttrs:r=>{if(!(r instanceof HTMLElement))throw cr(r);return{level:t,id:r.id}}})),toDOM:t=>["h".concat(t.attrs.level),{...n.get(kd.key)(t),id:t.attrs.id||e(t)},0],parseMarkdown:{match:({type:t})=>t==="heading",runner:(t,r,s)=>{const i=r.depth;t.openNode(s,{level:i}),t.next(r.children),t.closeNode()}},toMarkdown:{match:t=>t.type.name==="heading",runner:(t,r)=>{t.openNode("heading",void 0,{depth:r.attrs.level}),_x(t,r),t.closeNode()}}}});L(Oi.node,{displayName:"NodeSchema<heading>",group:"Heading"});L(Oi.ctx,{displayName:"NodeSchemaCtx<heading>",group:"Heading"});const Dx=en(n=>Gk(new RegExp("^(?<hashes>#+)\\s$"),Oi.type(n),e=>{var t,r;const s=((r=(t=e.groups)==null?void 0:t.hashes)==null?void 0:r.length)||0,i=n.get(Dr),{$from:o}=i.state.selection,a=o.node();if(a.type.name==="heading"){let l=Number(a.attrs.level)+Number(s);return l>6&&(l=6),{level:l}}return{level:s}}));L(Dx,{displayName:"InputRule<wrapInHeadingInputRule>",group:"Heading"});const Gn=xe("WrapInHeading",n=>e=>(e!=null||(e=1),e<1?Xa(Ss.type(n)):Xa(Oi.type(n),{level:e})));L(Gn,{displayName:"Command<wrapInHeadingCommand>",group:"Heading"});const Nm=xe("DowngradeHeading",n=>()=>(e,t,r)=>{const{$from:s}=e.selection,i=s.node();if(i.type!==Oi.type(n)||!e.selection.empty||s.parentOffset!==0)return!1;const o=i.attrs.level-1;return o?(t==null||t(e.tr.setNodeMarkup(e.selection.$from.before(),void 0,{...i.attrs,level:o})),!0):Xa(Ss.type(n))(e,t,r)});L(Nm,{displayName:"Command<downgradeHeadingCommand>",group:"Heading"});const Im=nn("headingKeymap",{TurnIntoH1:{shortcuts:"Mod-Alt-1",command:n=>{const e=n.get(ve);return()=>e.call(Gn.key,1)}},TurnIntoH2:{shortcuts:"Mod-Alt-2",command:n=>{const e=n.get(ve);return()=>e.call(Gn.key,2)}},TurnIntoH3:{shortcuts:"Mod-Alt-3",command:n=>{const e=n.get(ve);return()=>e.call(Gn.key,3)}},TurnIntoH4:{shortcuts:"Mod-Alt-4",command:n=>{const e=n.get(ve);return()=>e.call(Gn.key,4)}},TurnIntoH5:{shortcuts:"Mod-Alt-5",command:n=>{const e=n.get(ve);return()=>e.call(Gn.key,5)}},TurnIntoH6:{shortcuts:"Mod-Alt-6",command:n=>{const e=n.get(ve);return()=>e.call(Gn.key,6)}},DowngradeHeading:{shortcuts:["Delete","Backspace"],command:n=>{const e=n.get(ve);return()=>e.call(Nm.key)}}});L(Im.ctx,{displayName:"KeymapCtx<heading>",group:"Heading"});L(Im.shortcuts,{displayName:"Keymap<heading>",group:"Heading"});const Lm=Bn("blockquote");L(Lm,{displayName:"Attr<blockquote>",group:"Blockquote"});const vl=$t("blockquote",n=>({content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:e=>["blockquote",n.get(Lm.key)(e),0],parseMarkdown:{match:({type:e})=>e==="blockquote",runner:(e,t,r)=>{e.openNode(r).next(t.children).closeNode()}},toMarkdown:{match:e=>e.type.name==="blockquote",runner:(e,t)=>{e.openNode("blockquote").next(t.content).closeNode()}}}));L(vl.node,{displayName:"NodeSchema<blockquote>",group:"Blockquote"});L(vl.ctx,{displayName:"NodeSchemaCtx<blockquote>",group:"Blockquote"});const $x=en(n=>bm(/^\s*>\s$/,vl.type(n)));L($x,{displayName:"InputRule<wrapInBlockquoteInputRule>",group:"Blockquote"});const xd=xe("WrapInBlockquote",n=>()=>vm(vl.type(n)));L(xd,{displayName:"Command<wrapInBlockquoteCommand>",group:"Blockquote"});const zm=nn("blockquoteKeymap",{WrapInBlockquote:{shortcuts:"Mod-Shift-b",command:n=>{const e=n.get(ve);return()=>e.call(xd.key)}}});L(zm.ctx,{displayName:"KeymapCtx<blockquote>",group:"Blockquote"});L(zm.shortcuts,{displayName:"Keymap<blockquote>",group:"Blockquote"});const Bm=Bn("codeBlock",()=>({pre:{},code:{}}));L(Bm,{displayName:"Attr<codeBlock>",group:"CodeBlock"});const bl=$t("code_block",n=>({content:"text*",group:"block",marks:"",defining:!0,code:!0,attrs:{language:{default:"",validate:"string"}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:e=>{if(!(e instanceof HTMLElement))throw cr(e);return{language:e.dataset.language}}}],toDOM:e=>{const t=n.get(Bm.key)(e);return["pre",{...t.pre,"data-language":e.attrs.language},["code",t.code,0]]},parseMarkdown:{match:({type:e})=>e==="code",runner:(e,t,r)=>{const s=t.lang,i=t.value;e.openNode(r,{language:s}),i&&e.addText(i),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="code_block",runner:(e,t)=>{var r;e.addNode("code",void 0,((r=t.content.firstChild)==null?void 0:r.text)||"",{lang:t.attrs.language})}}}));L(bl.node,{displayName:"NodeSchema<codeBlock>",group:"CodeBlock"});L(bl.ctx,{displayName:"NodeSchemaCtx<codeBlock>",group:"CodeBlock"});const Ex=en(n=>Gk(new RegExp("^```(?<language>[a-z]*)?[\\s\\n]$"),bl.type(n),e=>{var r;var t;return{language:(r=(t=e.groups)==null?void 0:t.language)!=null?r:""}}));L(Ex,{displayName:"InputRule<createCodeBlockInputRule>",group:"CodeBlock"});const Cd=xe("CreateCodeBlock",n=>(e="")=>Xa(bl.type(n),{language:e}));L(Cd,{displayName:"Command<createCodeBlockCommand>",group:"CodeBlock"});const PH=xe("UpdateCodeBlockLanguage",()=>({pos:n,language:e}={pos:-1,language:""})=>(t,r)=>n>=0?(r==null||r(t.tr.setNodeAttribute(n,"language",e)),!0):!1);L(PH,{displayName:"Command<updateCodeBlockLanguageCommand>",group:"CodeBlock"});const Fm=nn("codeBlockKeymap",{CreateCodeBlock:{shortcuts:"Mod-Alt-c",command:n=>{const e=n.get(ve);return()=>e.call(Cd.key)}}});L(Fm.ctx,{displayName:"KeymapCtx<codeBlock>",group:"CodeBlock"});L(Fm.shortcuts,{displayName:"Keymap<codeBlock>",group:"CodeBlock"});const Vm=Bn("image");L(Vm,{displayName:"Attr<image>",group:"Image"});const Co=$t("image",n=>({inline:!0,group:"inline",selectable:!0,draggable:!0,marks:"",atom:!0,defining:!0,isolating:!0,attrs:{src:{default:"",validate:"string"},alt:{default:"",validate:"string"},title:{default:"",validate:"string"}},parseDOM:[{tag:"img[src]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw cr(e);return{src:e.getAttribute("src")||"",alt:e.getAttribute("alt")||"",title:e.getAttribute("title")||e.getAttribute("alt")||""}}}],toDOM:e=>["img",{...n.get(Vm.key)(e),...e.attrs}],parseMarkdown:{match:({type:e})=>e==="image",runner:(e,t,r)=>{const s=t.url,i=t.alt,o=t.title;e.addNode(r,{src:s,alt:i,title:o})}},toMarkdown:{match:e=>e.type.name==="image",runner:(e,t)=>{e.addNode("image",void 0,void 0,{title:t.attrs.title,url:t.attrs.src,alt:t.attrs.alt})}}}));L(Co.node,{displayName:"NodeSchema<image>",group:"Image"});L(Co.ctx,{displayName:"NodeSchemaCtx<image>",group:"Image"});const Hm=xe("InsertImage",n=>(e={})=>(t,r)=>{if(!r)return!0;const{src:s="",alt:i="",title:o=""}=e,a=Co.type(n).create({src:s,alt:i,title:o});return a&&r(t.tr.replaceSelectionWith(a).scrollIntoView()),!0});L(Hm,{displayName:"Command<insertImageCommand>",group:"Image"});const Ax=xe("UpdateImage",n=>(e={})=>(t,r)=>{const s=kV(t.selection,Co.type(n));if(!s)return!1;const{node:i,pos:o}=s,a={...i.attrs},{src:l,alt:c,title:u}=e;return l!==void 0&&(a.src=l),c!==void 0&&(a.alt=c),u!==void 0&&(a.title=u),r==null||r(t.tr.setNodeMarkup(o,void 0,a).scrollIntoView()),!0});L(Ax,{displayName:"Command<updateImageCommand>",group:"Image"});const RH=en(n=>new yn(new RegExp('!\\[(?<alt>.*?)]\\((?<filename>.*?)\\s*(?="|\\))"?(?<title>[^"]+)?"?\\)'),(e,t,r,s)=>{const[i,o,a="",l]=t;return i?e.tr.replaceWith(r,s,Co.type(n).create({src:a,alt:o,title:l})):null}));L(RH,{displayName:"InputRule<insertImageInputRule>",group:"Image"});const $u=Bn("hardbreak",n=>({"data-type":"hardbreak","data-is-inline":n.attrs.isInline}));L($u,{displayName:"Attr<hardbreak>",group:"Hardbreak"});const oi=$t("hardbreak",n=>({inline:!0,group:"inline",attrs:{isInline:{default:!1,validate:"boolean"}},selectable:!1,parseDOM:[{tag:"br"},{tag:'span[data-type="hardbreak"]',getAttrs:()=>({isInline:!0})}],toDOM:e=>e.attrs.isInline?["span",n.get($u.key)(e)," "]:["br",n.get($u.key)(e)],parseMarkdown:{match:({type:e})=>e==="break",runner:(e,t,r)=>{var s;e.addNode(r,{isInline:!!((s=t.data)!=null&&s.isInline)})}},leafText:()=>"\n",toMarkdown:{match:e=>e.type.name==="hardbreak",runner:(e,t)=>{t.attrs.isInline?e.addNode("text",void 0,"\n"):e.addNode("break")}}}));L(oi.node,{displayName:"NodeSchema<hardbreak>",group:"Hardbreak"});L(oi.ctx,{displayName:"NodeSchemaCtx<hardbreak>",group:"Hardbreak"});const Wm=xe("InsertHardbreak",n=>()=>(e,t)=>{var r;const{selection:s,tr:i}=e;if(!(s instanceof we))return!1;if(s.empty){const o=s.$from.node();if(o.childCount>0&&((r=o.lastChild)==null?void 0:r.type.name)==="hardbreak")return t==null||t(i.replaceRangeWith(s.to-1,s.to,e.schema.node("paragraph")).setSelection(ge.near(i.doc.resolve(s.to))).scrollIntoView()),!0}return t==null||t(i.setMeta("hardbreak",!0).replaceSelectionWith(oi.type(n).create()).scrollIntoView()),!0});L(Wm,{displayName:"Command<insertHardbreakCommand>",group:"Hardbreak"});const jm=nn("hardbreakKeymap",{InsertHardbreak:{shortcuts:"Shift-Enter",command:n=>{const e=n.get(ve);return()=>e.call(Wm.key)}}});L(jm.ctx,{displayName:"KeymapCtx<hardbreak>",group:"Hardbreak"});L(jm.shortcuts,{displayName:"Keymap<hardbreak>",group:"Hardbreak"});const Um=Bn("hr");L(Um,{displayName:"Attr<hr>",group:"Hr"});const wl=$t("hr",n=>({group:"block",parseDOM:[{tag:"hr"}],toDOM:e=>["hr",n.get(Um.key)(e)],parseMarkdown:{match:({type:e})=>e==="thematicBreak",runner:(e,t,r)=>{e.addNode(r)}},toMarkdown:{match:e=>e.type.name==="hr",runner:e=>{e.addNode("thematicBreak")}}}));L(wl.node,{displayName:"NodeSchema<hr>",group:"Hr"});L(wl.ctx,{displayName:"NodeSchemaCtx<hr>",group:"Hr"});const Px=en(n=>new yn(/^(?:---|___\s|\*\*\*\s)$/,(e,t,r,s)=>{const{tr:i}=e;return t[0]&&i.replaceWith(r-1,s,wl.type(n).create()),i}));L(Px,{displayName:"InputRule<insertHrInputRule>",group:"Hr"});const Rx=xe("InsertHr",n=>()=>(e,t)=>{if(!t)return!0;const r=Ss.node.type(n).create(),{tr:s,selection:i}=e,{from:o}=i,a=wl.type(n).create();if(!a)return!0;const l=s.replaceSelectionWith(a).insert(o,r),c=ge.findFrom(l.doc.resolve(o),1,!0);return c&&t(l.setSelection(c).scrollIntoView()),!0});L(Rx,{displayName:"Command<insertHrCommand>",group:"Hr"});const qm=Bn("bulletList");L(qm,{displayName:"Attr<bulletList>",group:"BulletList"});const So=$t("bullet_list",n=>({content:"listItem+",group:"block",attrs:{spread:{default:!1,validate:"boolean"}},parseDOM:[{tag:"ul",getAttrs:e=>{if(!(e instanceof HTMLElement))throw cr(e);return{spread:e.dataset.spread==="true"}}}],toDOM:e=>["ul",{...n.get(qm.key)(e),"data-spread":e.attrs.spread},0],parseMarkdown:{match:({type:e,ordered:t})=>e==="list"&&!t,runner:(e,t,r)=>{const s=t.spread!=null?"".concat(t.spread):"false";e.openNode(r,{spread:s}).next(t.children).closeNode()}},toMarkdown:{match:e=>e.type.name==="bullet_list",runner:(e,t)=>{e.openNode("list",void 0,{ordered:!1,spread:t.attrs.spread}).next(t.content).closeNode()}}}));L(So.node,{displayName:"NodeSchema<bulletList>",group:"BulletList"});L(So.ctx,{displayName:"NodeSchemaCtx<bulletList>",group:"BulletList"});const Nx=en(n=>bm(/^\s*([-+*])\s$/,So.type(n)));L(Nx,{displayName:"InputRule<wrapInBulletListInputRule>",group:"BulletList"});const Sd=xe("WrapInBulletList",n=>()=>vm(So.type(n)));L(Sd,{displayName:"Command<wrapInBulletListCommand>",group:"BulletList"});const Ym=nn("bulletListKeymap",{WrapInBulletList:{shortcuts:"Mod-Alt-8",command:n=>{const e=n.get(ve);return()=>e.call(Sd.key)}}});L(Ym.ctx,{displayName:"KeymapCtx<bulletListKeymap>",group:"BulletList"});L(Ym.shortcuts,{displayName:"Keymap<bulletListKeymap>",group:"BulletList"});const Km=Bn("orderedList");L(Km,{displayName:"Attr<orderedList>",group:"OrderedList"});const Mo=$t("ordered_list",n=>({content:"listItem+",group:"block",attrs:{order:{default:1,validate:"number"},spread:{default:!1,validate:"boolean"}},parseDOM:[{tag:"ol",getAttrs:e=>{if(!(e instanceof HTMLElement))throw cr(e);return{spread:e.dataset.spread,order:e.hasAttribute("start")?Number(e.getAttribute("start")):1}}}],toDOM:e=>["ol",{...n.get(Km.key)(e),...e.attrs.order===1?{}:e.attrs.order,"data-spread":e.attrs.spread},0],parseMarkdown:{match:({type:e,ordered:t})=>e==="list"&&!!t,runner:(e,t,r)=>{const s=t.spread!=null?"".concat(t.spread):"true";e.openNode(r,{spread:s}).next(t.children).closeNode()}},toMarkdown:{match:e=>e.type.name==="ordered_list",runner:(e,t)=>{e.openNode("list",void 0,{ordered:!0,start:1,spread:t.attrs.spread==="true"}),e.next(t.content),e.closeNode()}}}));L(Mo.node,{displayName:"NodeSchema<orderedList>",group:"OrderedList"});L(Mo.ctx,{displayName:"NodeSchemaCtx<orderedList>",group:"OrderedList"});const Ix=en(n=>bm(/^\s*(\d+)\.\s$/,Mo.type(n),e=>({order:Number(e[1])}),(e,t)=>t.childCount+t.attrs.order===Number(e[1])));L(Ix,{displayName:"InputRule<wrapInOrderedListInputRule>",group:"OrderedList"});const Md=xe("WrapInOrderedList",n=>()=>vm(Mo.type(n)));L(Md,{displayName:"Command<wrapInOrderedListCommand>",group:"OrderedList"});const Gm=nn("orderedListKeymap",{WrapInOrderedList:{shortcuts:"Mod-Alt-7",command:n=>{const e=n.get(ve);return()=>e.call(Md.key)}}});L(Gm.ctx,{displayName:"KeymapCtx<orderedList>",group:"OrderedList"});L(Gm.shortcuts,{displayName:"Keymap<orderedList>",group:"OrderedList"});const Jm=Bn("listItem");L(Jm,{displayName:"Attr<listItem>",group:"ListItem"});const ar=$t("list_item",n=>({group:"listItem",content:"paragraph block*",attrs:{label:{default:"•",validate:"string"},listType:{default:"bullet",validate:"string"},spread:{default:!0,validate:"boolean"}},defining:!0,parseDOM:[{tag:"li",getAttrs:e=>{if(!(e instanceof HTMLElement))throw cr(e);return{label:e.dataset.label,listType:e.dataset.listType,spread:e.dataset.spread==="true"}}}],toDOM:e=>["li",{...n.get(Jm.key)(e),"data-label":e.attrs.label,"data-list-type":e.attrs.listType,"data-spread":e.attrs.spread},0],parseMarkdown:{match:({type:e})=>e==="listItem",runner:(e,t,r)=>{const s=t.label!=null?"".concat(t.label,"."):"•",i=t.label!=null?"ordered":"bullet",o=t.spread!=null?"".concat(t.spread):"true";e.openNode(r,{label:s,listType:i,spread:o}),e.next(t.children),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="list_item",runner:(e,t)=>{e.openNode("listItem",void 0,{spread:t.attrs.spread}),e.next(t.content),e.closeNode()}}}));L(ar.node,{displayName:"NodeSchema<listItem>",group:"ListItem"});L(ar.ctx,{displayName:"NodeSchemaCtx<listItem>",group:"ListItem"});const Xm=xe("SinkListItem",n=>()=>MH(ar.type(n)));L(Xm,{displayName:"Command<sinkListItemCommand>",group:"ListItem"});const Qm=xe("LiftListItem",n=>()=>wx(ar.type(n)));L(Qm,{displayName:"Command<liftListItemCommand>",group:"ListItem"});const Zm=xe("SplitListItem",n=>()=>xH(ar.type(n)));L(Zm,{displayName:"Command<splitListItemCommand>",group:"ListItem"});function NH(n){return(e,t,r)=>{const{selection:s}=e;if(!(s instanceof we))return!1;const{empty:i,$from:o}=s;if(!i||o.parentOffset!==0)return!1;const a=o.node(-1);return a.type!==ar.type(n)||a.firstChild!==o.node()||o.node(-2).childCount>1?!1:wx(ar.type(n))(e,t,r)}}const eg=xe("LiftFirstListItem",n=>()=>NH(n));L(eg,{displayName:"Command<liftFirstListItemCommand>",group:"ListItem"});const tg=nn("listItemKeymap",{NextListItem:{shortcuts:"Enter",command:n=>{const e=n.get(ve);return()=>e.call(Zm.key)}},SinkListItem:{shortcuts:["Tab","Mod-]"],command:n=>{const e=n.get(ve);return()=>e.call(Xm.key)}},LiftListItem:{shortcuts:["Shift-Tab","Mod-["],command:n=>{const e=n.get(ve);return()=>e.call(Qm.key)}},LiftFirstListItem:{shortcuts:["Backspace","Delete"],command:n=>{const e=n.get(ve);return()=>e.call(eg.key)}}});L(tg.ctx,{displayName:"KeymapCtx<listItem>",group:"ListItem"});L(tg.shortcuts,{displayName:"Keymap<listItem>",group:"ListItem"});const Lx=km("text",()=>({group:"inline",parseMarkdown:{match:({type:n})=>n==="text",runner:(n,e)=>{n.addText(e.value)}},toMarkdown:{match:n=>n.type.name==="text",runner:(n,e)=>{n.addNode("text",void 0,e.text)}}}));L(Lx,{displayName:"NodeSchema<text>",group:"Text"});const ng=Bn("html");L(ng,{displayName:"Attr<html>",group:"Html"});const rg=$t("html",n=>({atom:!0,group:"inline",inline:!0,attrs:{value:{default:"",validate:"string"}},toDOM:e=>{const t=document.createElement("span"),r={...n.get(ng.key)(e),"data-value":e.attrs.value,"data-type":"html"};return t.textContent=e.attrs.value,["span",r,e.attrs.value]},parseDOM:[{tag:'span[data-type="html"]',getAttrs:e=>{var t;return{value:(t=e.dataset.value)!=null?t:""}}}],parseMarkdown:{match:({type:e})=>e==="html",runner:(e,t,r)=>{e.addNode(r,{value:t.value})}},toMarkdown:{match:e=>e.type.name==="html",runner:(e,t)=>{e.addNode("html",void 0,t.attrs.value)}}}));L(rg.node,{displayName:"NodeSchema<html>",group:"Html"});L(rg.ctx,{displayName:"NodeSchemaCtx<html>",group:"Html"});const IH=[Ox,wd,Ss,_d,kd,Oi,$u,oi,Lm,vl,Bm,bl,Um,wl,Vm,Co,qm,So,Km,Mo,Jm,ar,Sm,xo,Tm,yl,Dm,ss,Am,hs,ng,rg,Lx].flat(),LH=[$x,Nx,Ix,Ex,Px,Dx].flat(),zH=[kx,xx,Sx,Cx],BH=[Pm,xd,Gn,Nm,Cd,Wm,Rx,Hm,Ax,Md,Sd,Xm,Zm,Qm,eg,yd,$m,vd,Mx,Tx],FH=[zm,Fm,jm,Im,tg,Gm,Ym,Rm,Mm,Em,Om].flat(),sg=Ti("remarkAddOrderInList",()=>()=>n=>{sl(n,"list",e=>{var t;if(e.ordered){const r=(t=e.start)!=null?t:1;e.children.forEach((s,i)=>{s.label=i+r})}})});L(sg.plugin,{displayName:"Remark<remarkAddOrderInListPlugin>",group:"Remark"});L(sg.options,{displayName:"RemarkConfig<remarkAddOrderInListPlugin>",group:"Remark"});const ig=Ti("remarkLineBreak",()=>()=>n=>{const e=/[\t ]*(?:\r?\n|\r)/g;sl(n,"text",(t,r,s)=>{if(!t.value||typeof t.value!="string")return;const i=[];let o=0;e.lastIndex=0;let a=e.exec(t.value);for(;a;){const c=a.index;o!==c&&i.push({type:"text",value:t.value.slice(o,c)}),i.push({type:"break",data:{isInline:!0}}),o=c+a[0].length,a=e.exec(t.value)}if(i.length>0&&s&&typeof r=="number")return o<t.value.length&&i.push({type:"text",value:t.value.slice(o)}),s.children.splice(r,1,...i),r+i.length})});L(ig.plugin,{displayName:"Remark<remarkLineBreak>",group:"Remark"});L(ig.options,{displayName:"RemarkConfig<remarkLineBreak>",group:"Remark"});const og=Ti("remarkInlineLink",()=>OH);L(og.plugin,{displayName:"Remark<remarkInlineLinkPlugin>",group:"Remark"});L(og.options,{displayName:"RemarkConfig<remarkInlineLinkPlugin>",group:"Remark"});const VH=n=>!!n.children,HH=n=>n.type==="html";function WH(n,e){return t(n,0,null)[0];function t(r,s,i){if(VH(r)){const o=[];for(let a=0,l=r.children.length;a<l;a++){const c=r.children[a];if(c){const u=t(c,a,r);if(u)for(let d=0,h=u.length;d<h;d++){const f=u[d];f&&o.push(f)}}}r.children=o}return e(r,s,i)}}const ag=Ti("remarkHTMLTransformer",()=>()=>n=>{WH(n,(e,t,r)=>HH(e)?((r==null?void 0:r.type)==="root"&&(e.children=[{...e}],delete e.value,e.type="paragraph"),[e]):[e])});L(ag.plugin,{displayName:"Remark<remarkHtmlTransformer>",group:"Remark"});L(ag.options,{displayName:"RemarkConfig<remarkHtmlTransformer>",group:"Remark"});const lg=Ti("remarkMarker",()=>()=>(n,e)=>{const t=r=>e.value.charAt(r.position.start.offset);sl(n,r=>["strong","emphasis"].includes(r.type),r=>{r.marker=t(r)})});L(lg.plugin,{displayName:"Remark<remarkMarker>",group:"Remark"});L(lg.options,{displayName:"RemarkConfig<remarkMarker>",group:"Remark"});const zx=vn(()=>{let n=!1;const e=new Dt("MILKDOWN_INLINE_NODES_CURSOR"),t=new Lt({key:e,state:{init(){return!1},apply(r){if(!r.selection.empty)return!1;const s=r.selection.$from,i=s.nodeBefore,o=s.nodeAfter;return!!(i&&o&&i.isInline&&!i.isText&&o.isInline&&!o.isText)}},props:{handleDOMEvents:{compositionend:(r,s)=>n?(n=!1,requestAnimationFrame(()=>{if(t.getState(r.state)){const o=r.state.selection.from;s.preventDefault(),r.dispatch(r.state.tr.insertText(s.data||"",o))}}),!0):!1,compositionstart:r=>(t.getState(r.state)&&(n=!0),!1),beforeinput:(r,s)=>{if(t.getState(r.state)&&s instanceof InputEvent&&s.data&&!n){const o=r.state.selection.from;return s.preventDefault(),r.dispatch(r.state.tr.insertText(s.data||"",o)),!0}return!1}},decorations(r){if(t.getState(r)){const o=r.selection.$from.pos,a=document.createElement("span"),l=Tt.widget(o,a,{side:-1}),c=document.createElement("span"),u=Tt.widget(o,c);return setTimeout(()=>{a.contentEditable="true",c.contentEditable="true"}),Ue.create(r.doc,[l,u])}return Ue.empty}}});return t});L(zx,{displayName:"Prose<inlineNodesCursorPlugin>",group:"Prose"});const Bx=vn(n=>new Lt({key:new Dt("MILKDOWN_HARDBREAK_MARKS"),appendTransaction:(e,t,r)=>{if(!e.length)return;const[s]=e;if(!s)return;const[i]=s.steps;if(s.getMeta("hardbreak")){if(!(i instanceof Pt))return;const{from:l}=i;return r.tr.setNodeMarkup(l,oi.type(n),void 0,[])}if(i instanceof Mr){let l=r.tr;const{from:c,to:u}=i;return r.doc.nodesBetween(c,u,(d,h)=>{d.type===oi.type(n)&&(l=l.setNodeMarkup(h,oi.type(n),void 0,[]))}),l}}}));L(Bx,{displayName:"Prose<hardbreakClearMarkPlugin>",group:"Prose"});const cg=tn(["table","code_block"],"hardbreakFilterNodes");L(cg,{displayName:"Ctx<hardbreakFilterNodes>",group:"Prose"});const Fx=vn(n=>{const e=n.get(cg.key);return new Lt({key:new Dt("MILKDOWN_HARDBREAK_FILTER"),filterTransaction:(t,r)=>{const s=t.getMeta("hardbreak"),[i]=t.steps;if(s&&i){const{from:o}=i,a=r.doc.resolve(o);let l=a.depth,c=!0;for(;l>0;)e.includes(a.node(l).type.name)&&(c=!1),l--;return c}return!0}})});L(Fx,{displayName:"Prose<hardbreakFilterPlugin>",group:"Prose"});const Vx=vn(n=>{const e=new Dt("MILKDOWN_HEADING_ID"),t=r=>{if(r.composing)return;const s=n.get(_d.key),i=r.state.tr.setMeta("addToHistory",!1);let o=!1;const a={};r.state.doc.descendants((l,c)=>{if(l.type===Oi.type(n)){if(l.textContent.trim().length===0)return;const u=l.attrs;let d=s(l);a[d]?(a[d]+=1,d+="-#".concat(a[d])):a[d]=1,u.id!==d&&(o=!0,i.setMeta(e,!0).setNodeMarkup(c,void 0,{...u,id:d}))}}),o&&r.dispatch(i)};return new Lt({key:e,view:r=>(t(r),{update:(s,i)=>{s.state.doc.eq(i.doc)||t(s)}})})});L(Vx,{displayName:"Prose<syncHeadingIdPlugin>",group:"Prose"});const Hx=vn(n=>{const e=t=>{if(t.composing||!t.editable)return;const r=Mo.type(n),s=So.type(n),i=ar.type(n),o=t.state,a=(u,d)=>{let h=!1;const f="".concat(d+1,".");return u.label!==f&&(u.label=f,h=!0),h};let l=o.tr,c=!1;o.doc.descendants((u,d,h,f)=>{if(u.type===s){const p=u.maybeChild(0);(p==null?void 0:p.type)===i&&p.attrs.listType==="ordered"&&(c=!0,l.setNodeMarkup(d,r,{spread:"true"}),u.descendants((m,g,b,_)=>{if(m.type===i){const M={...m.attrs};a(M,_)&&(l=l.setNodeMarkup(g,void 0,M))}return!1}))}else if(u.type===i&&(h==null?void 0:h.type)===r){const p={...u.attrs};let m=!1;p.listType!=="ordered"&&(p.listType="ordered",m=!0),(h==null?void 0:h.maybeChild(0))&&(m=a(p,f)),m&&(l=l.setNodeMarkup(d,void 0,p),c=!0)}}),c&&t.dispatch(l.setMeta("addToHistory",!1))};return new Lt({key:new Dt("MILKDOWN_KEEP_LIST_ORDER"),view:t=>(e(t),{update:r=>{e(r)}})})});L(Hx,{displayName:"Prose<syncListOrderPlugin>",group:"Prose"});const jH=[Bx,cg,Fx,zx,sg,og,ig,ag,lg,bd,Vx,Hx].flat(),UH=[IH,LH,zH,BH,FH,jH].flat();var tp,np;if(typeof WeakMap<"u"){let n=new WeakMap;tp=e=>n.get(e),np=(e,t)=>(n.set(e,t),t)}else{const n=[];let t=0;tp=r=>{for(let s=0;s<n.length;s+=2)if(n[s]==r)return n[s+1]},np=(r,s)=>(t==10&&(t=0),n[t++]=r,n[t++]=s)}var Be=class{constructor(n,e,t,r){this.width=n,this.height=e,this.map=t,this.problems=r}findCell(n){for(let e=0;e<this.map.length;e++){const t=this.map[e];if(t!=n)continue;const r=e%this.width,s=e/this.width|0;let i=r+1,o=s+1;for(let a=1;i<this.width&&this.map[e+a]==t;a++)i++;for(let a=1;o<this.height&&this.map[e+this.width*a]==t;a++)o++;return{left:r,top:s,right:i,bottom:o}}throw new RangeError("No cell with offset ".concat(n," found"))}colCount(n){for(let e=0;e<this.map.length;e++)if(this.map[e]==n)return e%this.width;throw new RangeError("No cell with offset ".concat(n," found"))}nextCell(n,e,t){const{left:r,right:s,top:i,bottom:o}=this.findCell(n);return e=="horiz"?(t<0?r==0:s==this.width)?null:this.map[i*this.width+(t<0?r-1:s)]:(t<0?i==0:o==this.height)?null:this.map[r+this.width*(t<0?i-1:o)]}rectBetween(n,e){const{left:t,right:r,top:s,bottom:i}=this.findCell(n),{left:o,right:a,top:l,bottom:c}=this.findCell(e);return{left:Math.min(t,o),top:Math.min(s,l),right:Math.max(r,a),bottom:Math.max(i,c)}}cellsInRect(n){const e=[],t={};for(let r=n.top;r<n.bottom;r++)for(let s=n.left;s<n.right;s++){const i=r*this.width+s,o=this.map[i];t[o]||(t[o]=!0,!(s==n.left&&s&&this.map[i-1]==o||r==n.top&&r&&this.map[i-this.width]==o)&&e.push(o))}return e}positionAt(n,e,t){for(let r=0,s=0;;r++){const i=s+t.child(r).nodeSize;if(r==n){let o=e+n*this.width;const a=(n+1)*this.width;for(;o<a&&this.map[o]<s;)o++;return o==a?i-1:this.map[o]}s=i}}static get(n){return tp(n)||np(n,qH(n))}};function qH(n){if(n.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+n.type.name);const e=YH(n),t=n.childCount,r=[];let s=0,i=null;const o=[];for(let c=0,u=e*t;c<u;c++)r[c]=0;for(let c=0,u=0;c<t;c++){const d=n.child(c);u++;for(let p=0;;p++){for(;s<r.length&&r[s]!=0;)s++;if(p==d.childCount)break;const m=d.child(p),{colspan:g,rowspan:b,colwidth:_}=m.attrs;for(let M=0;M<b;M++){if(M+c>=t){(i||(i=[])).push({type:"overlong_rowspan",pos:u,n:b-M});break}const k=s+M*e;for(let C=0;C<g;C++){r[k+C]==0?r[k+C]=u:(i||(i=[])).push({type:"collision",row:c,pos:u,n:g-C});const x=_&&_[C];if(x){const D=(k+C)%e*2,O=o[D];O==null||O!=x&&o[D+1]==1?(o[D]=x,o[D+1]=1):O==x&&o[D+1]++}}}s+=g,u+=m.nodeSize}const h=(c+1)*e;let f=0;for(;s<h;)r[s++]==0&&f++;f&&(i||(i=[])).push({type:"missing",row:c,n:f}),u++}(e===0||t===0)&&(i||(i=[])).push({type:"zero_sized"});const a=new Be(e,t,r,i);let l=!1;for(let c=0;!l&&c<o.length;c+=2)o[c]!=null&&o[c+1]<t&&(l=!0);return l&&KH(a,o,n),a}function YH(n){let e=-1,t=!1;for(let r=0;r<n.childCount;r++){const s=n.child(r);let i=0;if(t)for(let o=0;o<r;o++){const a=n.child(o);for(let l=0;l<a.childCount;l++){const c=a.child(l);o+c.attrs.rowspan>r&&(i+=c.attrs.colspan)}}for(let o=0;o<s.childCount;o++){const a=s.child(o);i+=a.attrs.colspan,a.attrs.rowspan>1&&(t=!0)}e==-1?e=i:e!=i&&(e=Math.max(e,i))}return e}function KH(n,e,t){n.problems||(n.problems=[]);const r={};for(let s=0;s<n.map.length;s++){const i=n.map[s];if(r[i])continue;r[i]=!0;const o=t.nodeAt(i);if(!o)throw new RangeError("No cell with offset ".concat(i," found"));let a=null;const l=o.attrs;for(let c=0;c<l.colspan;c++){const u=(s+c)%n.width,d=e[u*2];d!=null&&(!l.colwidth||l.colwidth[c]!=d)&&((a||(a=GH(l)))[c]=d)}a&&n.problems.unshift({type:"colwidth mismatch",pos:i,colwidth:a})}}function GH(n){if(n.colwidth)return n.colwidth.slice();const e=[];for(let t=0;t<n.colspan;t++)e.push(0);return e}function p0(n,e){if(typeof n=="string")return{};const t=n.getAttribute("data-colwidth"),r=t&&/^\d+(,\d+)*$/.test(t)?t.split(",").map(o=>Number(o)):null,s=Number(n.getAttribute("colspan")||1),i={colspan:s,rowspan:Number(n.getAttribute("rowspan")||1),colwidth:r&&r.length==s?r:null};for(const o in e){const a=e[o].getFromDOM,l=a&&a(n);l!=null&&(i[o]=l)}return i}function m0(n,e){const t={};n.attrs.colspan!=1&&(t.colspan=n.attrs.colspan),n.attrs.rowspan!=1&&(t.rowspan=n.attrs.rowspan),n.attrs.colwidth&&(t["data-colwidth"]=n.attrs.colwidth.join(","));for(const r in e){const s=e[r].setDOMAttr;s&&s(n.attrs[r],t)}return t}function JH(n){if(n!==null){if(!Array.isArray(n))throw new TypeError("colwidth must be null or an array");for(const e of n)if(typeof e!="number")throw new TypeError("colwidth must be null or an array of numbers")}}function XH(n){const e=n.cellAttributes||{},t={colspan:{default:1,validate:"number"},rowspan:{default:1,validate:"number"},colwidth:{default:null,validate:JH}};for(const r in e)t[r]={default:e[r].default,validate:e[r].validate};return{table:{content:"table_row+",tableRole:"table",isolating:!0,group:n.tableGroup,parseDOM:[{tag:"table"}],toDOM(){return["table",["tbody",0]]}},table_row:{content:"(table_cell | table_header)*",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM(){return["tr",0]}},table_cell:{content:n.cellContent,attrs:t,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs:r=>p0(r,e)}],toDOM(r){return["td",m0(r,e),0]}},table_header:{content:n.cellContent,attrs:t,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs:r=>p0(r,e)}],toDOM(r){return["th",m0(r,e),0]}}}}function Sn(n){let e=n.cached.tableNodeTypes;if(!e){e=n.cached.tableNodeTypes={};for(const t in n.nodes){const r=n.nodes[t],s=r.spec.tableRole;s&&(e[s]=r)}}return e}var Jr=new Dt("selectingCells");function _l(n){for(let e=n.depth-1;e>0;e--)if(n.node(e).type.spec.tableRole=="row")return n.node(0).resolve(n.before(e+1));return null}function On(n){const e=n.selection.$head;for(let t=e.depth;t>0;t--)if(e.node(t).type.spec.tableRole=="row")return!0;return!1}function Td(n){const e=n.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&e.node.type.spec.tableRole=="cell")return e.$anchor;const t=_l(e.$head)||QH(e.$head);if(t)return t;throw new RangeError("No cell found around position ".concat(e.head))}function QH(n){for(let e=n.nodeAfter,t=n.pos;e;e=e.firstChild,t++){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t)}for(let e=n.nodeBefore,t=n.pos;e;e=e.lastChild,t--){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t-e.nodeSize)}}function rp(n){return n.parent.type.spec.tableRole=="row"&&!!n.nodeAfter}function ZH(n){return n.node(0).resolve(n.pos+n.nodeAfter.nodeSize)}function ug(n,e){return n.depth==e.depth&&n.pos>=e.start(-1)&&n.pos<=e.end(-1)}function Wx(n,e,t){const r=n.node(-1),s=Be.get(r),i=n.start(-1),o=s.nextCell(n.pos-i,e,t);return o==null?null:n.node(0).resolve(i+o)}function wi(n,e,t=1){const r={...n,colspan:n.colspan-t};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,t),r.colwidth.some(s=>s>0)||(r.colwidth=null)),r}function eW(n,e,t=1){const r={...n,colspan:n.colspan+t};if(r.colwidth){r.colwidth=r.colwidth.slice();for(let s=0;s<t;s++)r.colwidth.splice(e,0,0)}return r}function tW(n,e,t){const r=Sn(e.type.schema).header_cell;for(let s=0;s<n.height;s++)if(e.nodeAt(n.map[t+s*n.width]).type!=r)return!1;return!0}var Ge=class yr extends ge{constructor(e,t=e){const r=e.node(-1),s=Be.get(r),i=e.start(-1),o=s.rectBetween(e.pos-i,t.pos-i),a=e.node(0),l=s.cellsInRect(o).filter(u=>u!=t.pos-i);l.unshift(t.pos-i);const c=l.map(u=>{const d=r.nodeAt(u);if(!d)throw RangeError("No cell with offset ".concat(u," found"));const h=i+u+1;return new _u(a.resolve(h),a.resolve(h+d.content.size))});super(c[0].$from,c[0].$to,c),this.$anchorCell=e,this.$headCell=t}map(e,t){const r=e.resolve(t.map(this.$anchorCell.pos)),s=e.resolve(t.map(this.$headCell.pos));if(rp(r)&&rp(s)&&ug(r,s)){const i=this.$anchorCell.node(-1)!=r.node(-1);return i&&this.isRowSelection()?yr.rowSelection(r,s):i&&this.isColSelection()?yr.colSelection(r,s):new yr(r,s)}return we.between(r,s)}content(){const e=this.$anchorCell.node(-1),t=Be.get(e),r=this.$anchorCell.start(-1),s=t.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),i={},o=[];for(let l=s.top;l<s.bottom;l++){const c=[];for(let u=l*t.width+s.left,d=s.left;d<s.right;d++,u++){const h=t.map[u];if(i[h])continue;i[h]=!0;const f=t.findCell(h);let p=e.nodeAt(h);if(!p)throw RangeError("No cell with offset ".concat(h," found"));const m=s.left-f.left,g=f.right-s.right;if(m>0||g>0){let b=p.attrs;if(m>0&&(b=wi(b,0,m)),g>0&&(b=wi(b,b.colspan-g,g)),f.left<s.left){if(p=p.type.createAndFill(b),!p)throw RangeError("Could not create cell with attrs ".concat(JSON.stringify(b)))}else p=p.type.create(b,p.content)}if(f.top<s.top||f.bottom>s.bottom){const b={...p.attrs,rowspan:Math.min(f.bottom,s.bottom)-Math.max(f.top,s.top)};f.top<s.top?p=p.type.createAndFill(b):p=p.type.create(b,p.content)}c.push(p)}o.push(e.child(l).copy(j.from(c)))}const a=this.isColSelection()&&this.isRowSelection()?e:o;return new Q(j.from(a),1,1)}replace(e,t=Q.empty){const r=e.steps.length,s=this.ranges;for(let o=0;o<s.length;o++){const{$from:a,$to:l}=s[o],c=e.mapping.slice(r);e.replace(c.map(a.pos),c.map(l.pos),o?Q.empty:t)}const i=ge.findFrom(e.doc.resolve(e.mapping.slice(r).map(this.to)),-1);i&&e.setSelection(i)}replaceWith(e,t){this.replace(e,new Q(j.from(t),0,0))}forEachCell(e){const t=this.$anchorCell.node(-1),r=Be.get(t),s=this.$anchorCell.start(-1),i=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-s,this.$headCell.pos-s));for(let o=0;o<i.length;o++)e(t.nodeAt(i[o]),s+i[o])}isColSelection(){const e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);if(Math.min(e,t)>0)return!1;const r=e+this.$anchorCell.nodeAfter.attrs.rowspan,s=t+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,s)==this.$headCell.node(-1).childCount}static colSelection(e,t=e){const r=e.node(-1),s=Be.get(r),i=e.start(-1),o=s.findCell(e.pos-i),a=s.findCell(t.pos-i),l=e.node(0);return o.top<=a.top?(o.top>0&&(e=l.resolve(i+s.map[o.left])),a.bottom<s.height&&(t=l.resolve(i+s.map[s.width*(s.height-1)+a.right-1]))):(a.top>0&&(t=l.resolve(i+s.map[a.left])),o.bottom<s.height&&(e=l.resolve(i+s.map[s.width*(s.height-1)+o.right-1]))),new yr(e,t)}isRowSelection(){const e=this.$anchorCell.node(-1),t=Be.get(e),r=this.$anchorCell.start(-1),s=t.colCount(this.$anchorCell.pos-r),i=t.colCount(this.$headCell.pos-r);if(Math.min(s,i)>0)return!1;const o=s+this.$anchorCell.nodeAfter.attrs.colspan,a=i+this.$headCell.nodeAfter.attrs.colspan;return Math.max(o,a)==t.width}eq(e){return e instanceof yr&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,t=e){const r=e.node(-1),s=Be.get(r),i=e.start(-1),o=s.findCell(e.pos-i),a=s.findCell(t.pos-i),l=e.node(0);return o.left<=a.left?(o.left>0&&(e=l.resolve(i+s.map[o.top*s.width])),a.right<s.width&&(t=l.resolve(i+s.map[s.width*(a.top+1)-1]))):(a.left>0&&(t=l.resolve(i+s.map[a.top*s.width])),o.right<s.width&&(e=l.resolve(i+s.map[s.width*(o.top+1)-1]))),new yr(e,t)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,t){return new yr(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){return new yr(e.resolve(t),e.resolve(r))}getBookmark(){return new nW(this.$anchorCell.pos,this.$headCell.pos)}};Ge.prototype.visible=!1;ge.jsonID("cell",Ge);var nW=class jx{constructor(e,t){this.anchor=e,this.head=t}map(e){return new jx(e.map(this.anchor),e.map(this.head))}resolve(e){const t=e.resolve(this.anchor),r=e.resolve(this.head);return t.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&t.index()<t.parent.childCount&&r.index()<r.parent.childCount&&ug(t,r)?new Ge(t,r):ge.near(r,1)}};function rW(n){if(!(n.selection instanceof Ge))return null;const e=[];return n.selection.forEachCell((t,r)=>{e.push(Tt.node(r,r+t.nodeSize,{class:"selectedCell"}))}),Ue.create(n.doc,e)}function sW({$from:n,$to:e}){if(n.pos==e.pos||n.pos<e.pos-6)return!1;let t=n.pos,r=e.pos,s=n.depth;for(;s>=0&&!(n.after(s+1)<n.end(s));s--,t++);for(let i=e.depth;i>=0&&!(e.before(i+1)>e.start(i));i--,r--);return t==r&&/row|table/.test(n.node(s).type.spec.tableRole)}function iW({$from:n,$to:e}){let t,r;for(let s=n.depth;s>0;s--){const i=n.node(s);if(i.type.spec.tableRole==="cell"||i.type.spec.tableRole==="header_cell"){t=i;break}}for(let s=e.depth;s>0;s--){const i=e.node(s);if(i.type.spec.tableRole==="cell"||i.type.spec.tableRole==="header_cell"){r=i;break}}return t!==r&&e.parentOffset===0}function oW(n,e,t){const r=(e||n).selection,s=(e||n).doc;let i,o;if(r instanceof pe&&(o=r.node.type.spec.tableRole)){if(o=="cell"||o=="header_cell")i=Ge.create(s,r.from);else if(o=="row"){const a=s.resolve(r.from+1);i=Ge.rowSelection(a,a)}else if(!t){const a=Be.get(r.node),l=r.from+1,c=l+a.map[a.width*a.height-1];i=Ge.create(s,l+1,c)}}else r instanceof we&&sW(r)?i=we.create(s,r.from):r instanceof we&&iW(r)&&(i=we.create(s,r.$from.start(),r.$from.end()));return i&&(e||(e=n.tr)).setSelection(i),e}var aW=new Dt("fix-tables");function Ux(n,e,t,r){const s=n.childCount,i=e.childCount;e:for(let o=0,a=0;o<i;o++){const l=e.child(o);for(let c=a,u=Math.min(s,o+3);c<u;c++)if(n.child(c)==l){a=c+1,t+=l.nodeSize;continue e}r(l,t),a<s&&n.child(a).sameMarkup(l)?Ux(n.child(a),l,t+1,r):l.nodesBetween(0,l.content.size,r,t+1),t+=l.nodeSize}}function lW(n,e){let t;const r=(s,i)=>{s.type.spec.tableRole=="table"&&(t=cW(n,s,i,t))};return e?e.doc!=n.doc&&Ux(e.doc,n.doc,0,r):n.doc.descendants(r),t}function cW(n,e,t,r){const s=Be.get(e);if(!s.problems)return r;r||(r=n.tr);const i=[];for(let l=0;l<s.height;l++)i.push(0);for(let l=0;l<s.problems.length;l++){const c=s.problems[l];if(c.type=="collision"){const u=e.nodeAt(c.pos);if(!u)continue;const d=u.attrs;for(let h=0;h<d.rowspan;h++)i[c.row+h]+=c.n;r.setNodeMarkup(r.mapping.map(t+1+c.pos),null,wi(d,d.colspan-c.n,c.n))}else if(c.type=="missing")i[c.row]+=c.n;else if(c.type=="overlong_rowspan"){const u=e.nodeAt(c.pos);if(!u)continue;r.setNodeMarkup(r.mapping.map(t+1+c.pos),null,{...u.attrs,rowspan:u.attrs.rowspan-c.n})}else if(c.type=="colwidth mismatch"){const u=e.nodeAt(c.pos);if(!u)continue;r.setNodeMarkup(r.mapping.map(t+1+c.pos),null,{...u.attrs,colwidth:c.colwidth})}else if(c.type=="zero_sized"){const u=r.mapping.map(t);r.delete(u,u+e.nodeSize)}}let o,a;for(let l=0;l<i.length;l++)i[l]&&(o==null&&(o=l),a=l);for(let l=0,c=t+1;l<s.height;l++){const u=e.child(l),d=c+u.nodeSize,h=i[l];if(h>0){let f="cell";u.firstChild&&(f=u.firstChild.type.spec.tableRole);const p=[];for(let g=0;g<h;g++){const b=Sn(n.schema)[f].createAndFill();b&&p.push(b)}const m=(l==0||o==l-1)&&a==l?c+1:d-1;r.insert(r.mapping.map(m),p)}c=d}return r.setMeta(aW,{fixTables:!0})}function Ms(n){const e=n.selection,t=Td(n),r=t.node(-1),s=t.start(-1),i=Be.get(r);return{...e instanceof Ge?i.rectBetween(e.$anchorCell.pos-s,e.$headCell.pos-s):i.findCell(t.pos-s),tableStart:s,map:i,table:r}}function qx(n,{map:e,tableStart:t,table:r},s){let i=s>0?-1:0;tW(e,r,s+i)&&(i=s==0||s==e.width?null:0);for(let o=0;o<e.height;o++){const a=o*e.width+s;if(s>0&&s<e.width&&e.map[a-1]==e.map[a]){const l=e.map[a],c=r.nodeAt(l);n.setNodeMarkup(n.mapping.map(t+l),null,eW(c.attrs,s-e.colCount(l))),o+=c.attrs.rowspan-1}else{const l=i==null?Sn(r.type.schema).cell:r.nodeAt(e.map[a+i]).type,c=e.positionAt(o,s,r);n.insert(n.mapping.map(t+c),l.createAndFill())}}return n}function uW(n,e){if(!On(n))return!1;if(e){const t=Ms(n);e(qx(n.tr,t,t.left))}return!0}function dW(n,e){if(!On(n))return!1;if(e){const t=Ms(n);e(qx(n.tr,t,t.right))}return!0}function hW(n,{map:e,table:t,tableStart:r},s){const i=n.mapping.maps.length;for(let o=0;o<e.height;){const a=o*e.width+s,l=e.map[a],c=t.nodeAt(l),u=c.attrs;if(s>0&&e.map[a-1]==l||s<e.width-1&&e.map[a+1]==l)n.setNodeMarkup(n.mapping.slice(i).map(r+l),null,wi(u,s-e.colCount(l)));else{const d=n.mapping.slice(i).map(r+l);n.delete(d,d+c.nodeSize)}o+=u.rowspan}}function fW(n,e){if(!On(n))return!1;if(e){const t=Ms(n),r=n.tr;if(t.left==0&&t.right==t.map.width)return!1;for(let s=t.right-1;hW(r,t,s),s!=t.left;s--){const i=t.tableStart?r.doc.nodeAt(t.tableStart-1):r.doc;if(!i)throw RangeError("No table found");t.table=i,t.map=Be.get(i)}e(r)}return!0}function pW(n,{map:e,table:t,tableStart:r},s){let i=0;for(let c=0;c<s;c++)i+=t.child(c).nodeSize;const o=i+t.child(s).nodeSize,a=n.mapping.maps.length;n.delete(i+r,o+r);const l=new Set;for(let c=0,u=s*e.width;c<e.width;c++,u++){const d=e.map[u];if(!l.has(d)){if(l.add(d),s>0&&d==e.map[u-e.width]){const h=t.nodeAt(d).attrs;n.setNodeMarkup(n.mapping.slice(a).map(d+r),null,{...h,rowspan:h.rowspan-1}),c+=h.colspan-1}else if(s<e.height&&d==e.map[u+e.width]){const h=t.nodeAt(d),f=h.attrs,p=h.type.create({...f,rowspan:h.attrs.rowspan-1},h.content),m=e.positionAt(s+1,c,t);n.insert(n.mapping.slice(a).map(r+m),p),c+=f.colspan-1}}}}function mW(n,e){if(!On(n))return!1;if(e){const t=Ms(n),r=n.tr;if(t.top==0&&t.bottom==t.map.height)return!1;for(let s=t.bottom-1;pW(r,t,s),s!=t.top;s--){const i=t.tableStart?r.doc.nodeAt(t.tableStart-1):r.doc;if(!i)throw RangeError("No table found");t.table=i,t.map=Be.get(t.table)}e(r)}return!0}function gW(n,e){return function(t,r){if(!On(t))return!1;const s=Td(t);if(s.nodeAfter.attrs[n]===e)return!1;if(r){const i=t.tr;t.selection instanceof Ge?t.selection.forEachCell((o,a)=>{o.attrs[n]!==e&&i.setNodeMarkup(a,null,{...o.attrs,[n]:e})}):i.setNodeMarkup(s.pos,null,{...s.nodeAfter.attrs,[n]:e}),r(i)}return!0}}function yW(n){return function(e,t){if(!On(e))return!1;if(t){const r=Sn(e.schema),s=Ms(e),i=e.tr,o=s.map.cellsInRect(n=="column"?{left:s.left,top:0,right:s.right,bottom:s.map.height}:n=="row"?{left:0,top:s.top,right:s.map.width,bottom:s.bottom}:s),a=o.map(l=>s.table.nodeAt(l));for(let l=0;l<o.length;l++)a[l].type==r.header_cell&&i.setNodeMarkup(s.tableStart+o[l],r.cell,a[l].attrs);if(i.steps.length==0)for(let l=0;l<o.length;l++)i.setNodeMarkup(s.tableStart+o[l],r.header_cell,a[l].attrs);t(i)}return!0}}function g0(n,e,t){const r=e.map.cellsInRect({left:0,top:0,right:n=="row"?e.map.width:1,bottom:n=="column"?e.map.height:1});for(let s=0;s<r.length;s++){const i=e.table.nodeAt(r[s]);if(i&&i.type!==t.header_cell)return!1}return!0}function dg(n,e){return e=e||{useDeprecatedLogic:!1},e.useDeprecatedLogic?yW(n):function(t,r){if(!On(t))return!1;if(r){const s=Sn(t.schema),i=Ms(t),o=t.tr,a=g0("row",i,s),l=g0("column",i,s),u=(n==="column"?a:n==="row"?l:!1)?1:0,d=n=="column"?{left:0,top:u,right:1,bottom:i.map.height}:n=="row"?{left:u,top:0,right:i.map.width,bottom:1}:i,h=n=="column"?l?s.cell:s.header_cell:n=="row"?a?s.cell:s.header_cell:s.cell;i.map.cellsInRect(d).forEach(f=>{const p=f+i.tableStart,m=o.doc.nodeAt(p);m&&o.setNodeMarkup(p,h,m.attrs)}),r(o)}return!0}}dg("row",{useDeprecatedLogic:!0});dg("column",{useDeprecatedLogic:!0});dg("cell",{useDeprecatedLogic:!0});function vW(n,e){if(e<0){const t=n.nodeBefore;if(t)return n.pos-t.nodeSize;for(let r=n.index(-1)-1,s=n.before();r>=0;r--){const i=n.node(-1).child(r),o=i.lastChild;if(o)return s-1-o.nodeSize;s-=i.nodeSize}}else{if(n.index()<n.parent.childCount-1)return n.pos+n.nodeAfter.nodeSize;const t=n.node(-1);for(let r=n.indexAfter(-1),s=n.after();r<t.childCount;r++){const i=t.child(r);if(i.childCount)return s+1;s+=i.nodeSize}}return null}function Yx(n){return function(e,t){if(!On(e))return!1;const r=vW(Td(e),n);if(r==null)return!1;if(t){const s=e.doc.resolve(r);t(e.tr.setSelection(we.between(s,ZH(s))).scrollIntoView())}return!0}}function bW(n,e){const t=n.selection.$anchor;for(let r=t.depth;r>0;r--)if(t.node(r).type.spec.tableRole=="table")return e&&e(n.tr.delete(t.before(r),t.after(r)).scrollIntoView()),!0;return!1}function Jl(n,e){const t=n.selection;if(!(t instanceof Ge))return!1;if(e){const r=n.tr,s=Sn(n.schema).cell.createAndFill().content;t.forEachCell((i,o)=>{i.content.eq(s)||r.replace(r.mapping.map(o+1),r.mapping.map(o+i.nodeSize-1),new Q(s,0,0))}),r.docChanged&&e(r)}return!0}function wW(n){if(!n.size)return null;let{content:e,openStart:t,openEnd:r}=n;for(;e.childCount==1&&(t>0&&r>0||e.child(0).type.spec.tableRole=="table");)t--,r--,e=e.child(0).content;const s=e.child(0),i=s.type.spec.tableRole,o=s.type.schema,a=[];if(i=="row")for(let l=0;l<e.childCount;l++){let c=e.child(l).content;const u=l?0:Math.max(0,t-1),d=l<e.childCount-1?0:Math.max(0,r-1);(u||d)&&(c=sp(Sn(o).row,new Q(c,u,d)).content),a.push(c)}else if(i=="cell"||i=="header_cell")a.push(t||r?sp(Sn(o).row,new Q(e,t,r)).content:e);else return null;return _W(o,a)}function _W(n,e){const t=[];for(let s=0;s<e.length;s++){const i=e[s];for(let o=i.childCount-1;o>=0;o--){const{rowspan:a,colspan:l}=i.child(o).attrs;for(let c=s;c<s+a;c++)t[c]=(t[c]||0)+l}}let r=0;for(let s=0;s<t.length;s++)r=Math.max(r,t[s]);for(let s=0;s<t.length;s++)if(s>=e.length&&e.push(j.empty),t[s]<r){const i=Sn(n).cell.createAndFill(),o=[];for(let a=t[s];a<r;a++)o.push(i);e[s]=e[s].append(j.from(o))}return{height:e.length,width:r,rows:e}}function sp(n,e){const t=n.createAndFill();return new Y_(t).replace(0,t.content.size,e).doc}function kW({width:n,height:e,rows:t},r,s){if(n!=r){const i=[],o=[];for(let a=0;a<t.length;a++){const l=t[a],c=[];for(let u=i[a]||0,d=0;u<r;d++){let h=l.child(d%l.childCount);u+h.attrs.colspan>r&&(h=h.type.createChecked(wi(h.attrs,h.attrs.colspan,u+h.attrs.colspan-r),h.content)),c.push(h),u+=h.attrs.colspan;for(let f=1;f<h.attrs.rowspan;f++)i[a+f]=(i[a+f]||0)+h.attrs.colspan}o.push(j.from(c))}t=o,n=r}if(e!=s){const i=[];for(let o=0,a=0;o<s;o++,a++){const l=[],c=t[a%e];for(let u=0;u<c.childCount;u++){let d=c.child(u);o+d.attrs.rowspan>s&&(d=d.type.create({...d.attrs,rowspan:Math.max(1,s-d.attrs.rowspan)},d.content)),l.push(d)}i.push(j.from(l))}t=i,e=s}return{width:n,height:e,rows:t}}function xW(n,e,t,r,s,i,o){const a=n.doc.type.schema,l=Sn(a);let c,u;if(s>e.width)for(let d=0,h=0;d<e.height;d++){const f=t.child(d);h+=f.nodeSize;const p=[];let m;f.lastChild==null||f.lastChild.type==l.cell?m=c||(c=l.cell.createAndFill()):m=u||(u=l.header_cell.createAndFill());for(let g=e.width;g<s;g++)p.push(m);n.insert(n.mapping.slice(o).map(h-1+r),p)}if(i>e.height){const d=[];for(let p=0,m=(e.height-1)*e.width;p<Math.max(e.width,s);p++){const g=p>=e.width?!1:t.nodeAt(e.map[m+p]).type==l.header_cell;d.push(g?u||(u=l.header_cell.createAndFill()):c||(c=l.cell.createAndFill()))}const h=l.row.create(null,j.from(d)),f=[];for(let p=e.height;p<i;p++)f.push(h);n.insert(n.mapping.slice(o).map(r+t.nodeSize-2),f)}return!!(c||u)}function y0(n,e,t,r,s,i,o,a){if(o==0||o==e.height)return!1;let l=!1;for(let c=s;c<i;c++){const u=o*e.width+c,d=e.map[u];if(e.map[u-e.width]==d){l=!0;const h=t.nodeAt(d),{top:f,left:p}=e.findCell(d);n.setNodeMarkup(n.mapping.slice(a).map(d+r),null,{...h.attrs,rowspan:o-f}),n.insert(n.mapping.slice(a).map(e.positionAt(o,p,t)),h.type.createAndFill({...h.attrs,rowspan:f+h.attrs.rowspan-o})),c+=h.attrs.colspan-1}}return l}function v0(n,e,t,r,s,i,o,a){if(o==0||o==e.width)return!1;let l=!1;for(let c=s;c<i;c++){const u=c*e.width+o,d=e.map[u];if(e.map[u-1]==d){l=!0;const h=t.nodeAt(d),f=e.colCount(d),p=n.mapping.slice(a).map(d+r);n.setNodeMarkup(p,null,wi(h.attrs,o-f,h.attrs.colspan-(o-f))),n.insert(p+h.nodeSize,h.type.createAndFill(wi(h.attrs,0,o-f))),c+=h.attrs.rowspan-1}}return l}function b0(n,e,t,r,s){let i=t?n.doc.nodeAt(t-1):n.doc;if(!i)throw new Error("No table found");let o=Be.get(i);const{top:a,left:l}=r,c=l+s.width,u=a+s.height,d=n.tr;let h=0;function f(){if(i=t?d.doc.nodeAt(t-1):d.doc,!i)throw new Error("No table found");o=Be.get(i),h=d.mapping.maps.length}xW(d,o,i,t,c,u,h)&&f(),y0(d,o,i,t,l,c,a,h)&&f(),y0(d,o,i,t,l,c,u,h)&&f(),v0(d,o,i,t,a,u,l,h)&&f(),v0(d,o,i,t,a,u,c,h)&&f();for(let p=a;p<u;p++){const m=o.positionAt(p,l,i),g=o.positionAt(p,c,i);d.replace(d.mapping.slice(h).map(m+t),d.mapping.slice(h).map(g+t),new Q(s.rows[p-a],0,0))}f(),d.setSelection(new Ge(d.doc.resolve(t+o.positionAt(a,l,i)),d.doc.resolve(t+o.positionAt(u-1,c-1,i)))),e(d)}var CW=Zk({ArrowLeft:Xl("horiz",-1),ArrowRight:Xl("horiz",1),ArrowUp:Xl("vert",-1),ArrowDown:Xl("vert",1),"Shift-ArrowLeft":Ql("horiz",-1),"Shift-ArrowRight":Ql("horiz",1),"Shift-ArrowUp":Ql("vert",-1),"Shift-ArrowDown":Ql("vert",1),Backspace:Jl,"Mod-Backspace":Jl,Delete:Jl,"Mod-Delete":Jl});function Wc(n,e,t){return t.eq(n.selection)?!1:(e&&e(n.tr.setSelection(t).scrollIntoView()),!0)}function Xl(n,e){return(t,r,s)=>{if(!s)return!1;const i=t.selection;if(i instanceof Ge)return Wc(t,r,ge.near(i.$headCell,e));if(n!="horiz"&&!i.empty)return!1;const o=Kx(s,n,e);if(o==null)return!1;if(n=="horiz")return Wc(t,r,ge.near(t.doc.resolve(i.head+e),e));{const a=t.doc.resolve(o),l=Wx(a,n,e);let c;return l?c=ge.near(l,1):e<0?c=ge.near(t.doc.resolve(a.before(-1)),-1):c=ge.near(t.doc.resolve(a.after(-1)),1),Wc(t,r,c)}}}function Ql(n,e){return(t,r,s)=>{if(!s)return!1;const i=t.selection;let o;if(i instanceof Ge)o=i;else{const l=Kx(s,n,e);if(l==null)return!1;o=new Ge(t.doc.resolve(l))}const a=Wx(o.$headCell,n,e);return a?Wc(t,r,new Ge(o.$anchorCell,a)):!1}}function SW(n,e){const t=n.state.doc,r=_l(t.resolve(e));return r?(n.dispatch(n.state.tr.setSelection(new Ge(r))),!0):!1}function MW(n,e,t){if(!On(n.state))return!1;let r=wW(t);const s=n.state.selection;if(s instanceof Ge){r||(r={width:1,height:1,rows:[j.from(sp(Sn(n.state.schema).cell,t))]});const i=s.$anchorCell.node(-1),o=s.$anchorCell.start(-1),a=Be.get(i).rectBetween(s.$anchorCell.pos-o,s.$headCell.pos-o);return r=kW(r,a.right-a.left,a.bottom-a.top),b0(n.state,n.dispatch,o,a,r),!0}else if(r){const i=Td(n.state),o=i.start(-1);return b0(n.state,n.dispatch,o,Be.get(i.node(-1)).findCell(i.pos-o),r),!0}else return!1}function TW(n,e){var t;if(e.ctrlKey||e.metaKey)return;const r=w0(n,e.target);let s;if(e.shiftKey&&n.state.selection instanceof Ge)i(n.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&r&&(s=_l(n.state.selection.$anchor))!=null&&((t=Rh(n,e))==null?void 0:t.pos)!=s.pos)i(s,e),e.preventDefault();else if(!r)return;function i(l,c){let u=Rh(n,c);const d=Jr.getState(n.state)==null;if(!u||!ug(l,u))if(d)u=l;else return;const h=new Ge(l,u);if(d||!n.state.selection.eq(h)){const f=n.state.tr.setSelection(h);d&&f.setMeta(Jr,l.pos),n.dispatch(f)}}function o(){n.root.removeEventListener("mouseup",o),n.root.removeEventListener("dragstart",o),n.root.removeEventListener("mousemove",a),Jr.getState(n.state)!=null&&n.dispatch(n.state.tr.setMeta(Jr,-1))}function a(l){const c=l,u=Jr.getState(n.state);let d;if(u!=null)d=n.state.doc.resolve(u);else if(w0(n,c.target)!=r&&(d=Rh(n,e),!d))return o();d&&i(d,c)}n.root.addEventListener("mouseup",o),n.root.addEventListener("dragstart",o),n.root.addEventListener("mousemove",a)}function Kx(n,e,t){if(!(n.state.selection instanceof we))return null;const{$head:r}=n.state.selection;for(let s=r.depth-1;s>=0;s--){const i=r.node(s);if((t<0?r.index(s):r.indexAfter(s))!=(t<0?0:i.childCount))return null;if(i.type.spec.tableRole=="cell"||i.type.spec.tableRole=="header_cell"){const a=r.before(s),l=e=="vert"?t>0?"down":"up":t>0?"right":"left";return n.endOfTextblock(l)?a:null}}return null}function w0(n,e){for(;e&&e!=n.dom;e=e.parentNode)if(e.nodeName=="TD"||e.nodeName=="TH")return e;return null}function Rh(n,e){const t=n.posAtCoords({left:e.clientX,top:e.clientY});return t&&t?_l(n.state.doc.resolve(t.pos)):null}var Gx=class{constructor(e,t){this.node=e,this.defaultCellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width","".concat(t,"px")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),ip(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!=this.node.type?!1:(this.node=e,ip(e,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(e){return e.type=="attributes"&&(e.target==this.table||this.colgroup.contains(e.target))}};function ip(n,e,t,r,s,i){var o;let a=0,l=!0,c=e.firstChild;const u=n.firstChild;if(u){for(let d=0,h=0;d<u.childCount;d++){const{colspan:f,colwidth:p}=u.child(d).attrs;for(let m=0;m<f;m++,h++){const g=s==h?i:p&&p[m],b=g?g+"px":"";if(a+=g||r,g||(l=!1),c)c.style.width!=b&&(c.style.width=b),c=c.nextSibling;else{const _=document.createElement("col");_.style.width=b,e.appendChild(_)}}}for(;c;){const d=c.nextSibling;(o=c.parentNode)==null||o.removeChild(c),c=d}l?(t.style.width=a+"px",t.style.minWidth=""):(t.style.width="",t.style.minWidth=a+"px")}}var dn=new Dt("tableColumnResizing");function Jx({handleWidth:n=5,cellMinWidth:e=25,defaultCellMinWidth:t=100,View:r=Gx,lastColumnResizable:s=!0}={}){const i=new Lt({key:dn,state:{init(o,a){var l,c;const u=(c=(l=i.spec)==null?void 0:l.props)==null?void 0:c.nodeViews,d=Sn(a.schema).table.name;return r&&u&&(u[d]=(h,f)=>new r(h,t,f)),new OW(-1,!1)},apply(o,a){return a.apply(o)}},props:{attributes:o=>{const a=dn.getState(o);return a&&a.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(o,a)=>{DW(o,a,n,s)},mouseleave:o=>{$W(o)},mousedown:(o,a)=>{EW(o,a,e,t)}},decorations:o=>{const a=dn.getState(o);if(a&&a.activeHandle>-1)return IW(o,a.activeHandle)},nodeViews:{}}});return i}var OW=class jc{constructor(e,t){this.activeHandle=e,this.dragging=t}apply(e){const t=this,r=e.getMeta(dn);if(r&&r.setHandle!=null)return new jc(r.setHandle,!1);if(r&&r.setDragging!==void 0)return new jc(t.activeHandle,r.setDragging);if(t.activeHandle>-1&&e.docChanged){let s=e.mapping.map(t.activeHandle,-1);return rp(e.doc.resolve(s))||(s=-1),new jc(s,t.dragging)}return t}};function DW(n,e,t,r){if(!n.editable)return;const s=dn.getState(n.state);if(s&&!s.dragging){const i=PW(e.target);let o=-1;if(i){const{left:a,right:l}=i.getBoundingClientRect();e.clientX-a<=t?o=_0(n,e,"left",t):l-e.clientX<=t&&(o=_0(n,e,"right",t))}if(o!=s.activeHandle){if(!r&&o!==-1){const a=n.state.doc.resolve(o),l=a.node(-1),c=Be.get(l),u=a.start(-1);if(c.colCount(a.pos-u)+a.nodeAfter.attrs.colspan-1==c.width-1)return}Xx(n,o)}}}function $W(n){if(!n.editable)return;const e=dn.getState(n.state);e&&e.activeHandle>-1&&!e.dragging&&Xx(n,-1)}function EW(n,e,t,r){var s;if(!n.editable)return!1;const i=(s=n.dom.ownerDocument.defaultView)!=null?s:window,o=dn.getState(n.state);if(!o||o.activeHandle==-1||o.dragging)return!1;const a=n.state.doc.nodeAt(o.activeHandle),l=AW(n,o.activeHandle,a.attrs);n.dispatch(n.state.tr.setMeta(dn,{setDragging:{startX:e.clientX,startWidth:l}}));function c(d){i.removeEventListener("mouseup",c),i.removeEventListener("mousemove",u);const h=dn.getState(n.state);h!=null&&h.dragging&&(RW(n,h.activeHandle,k0(h.dragging,d,t)),n.dispatch(n.state.tr.setMeta(dn,{setDragging:null})))}function u(d){if(!d.which)return c(d);const h=dn.getState(n.state);if(h&&h.dragging){const f=k0(h.dragging,d,t);x0(n,h.activeHandle,f,r)}}return x0(n,o.activeHandle,l,r),i.addEventListener("mouseup",c),i.addEventListener("mousemove",u),e.preventDefault(),!0}function AW(n,e,{colspan:t,colwidth:r}){const s=r&&r[r.length-1];if(s)return s;const i=n.domAtPos(e);let a=i.node.childNodes[i.offset].offsetWidth,l=t;if(r)for(let c=0;c<t;c++)r[c]&&(a-=r[c],l--);return a/l}function PW(n){for(;n&&n.nodeName!="TD"&&n.nodeName!="TH";)n=n.classList&&n.classList.contains("ProseMirror")?null:n.parentNode;return n}function _0(n,e,t,r){const s=t=="right"?-r:r,i=n.posAtCoords({left:e.clientX+s,top:e.clientY});if(!i)return-1;const{pos:o}=i,a=_l(n.state.doc.resolve(o));if(!a)return-1;if(t=="right")return a.pos;const l=Be.get(a.node(-1)),c=a.start(-1),u=l.map.indexOf(a.pos-c);return u%l.width==0?-1:c+l.map[u-1]}function k0(n,e,t){const r=e.clientX-n.startX;return Math.max(t,n.startWidth+r)}function Xx(n,e){n.dispatch(n.state.tr.setMeta(dn,{setHandle:e}))}function RW(n,e,t){const r=n.state.doc.resolve(e),s=r.node(-1),i=Be.get(s),o=r.start(-1),a=i.colCount(r.pos-o)+r.nodeAfter.attrs.colspan-1,l=n.state.tr;for(let c=0;c<i.height;c++){const u=c*i.width+a;if(c&&i.map[u]==i.map[u-i.width])continue;const d=i.map[u],h=s.nodeAt(d).attrs,f=h.colspan==1?0:a-i.colCount(d);if(h.colwidth&&h.colwidth[f]==t)continue;const p=h.colwidth?h.colwidth.slice():NW(h.colspan);p[f]=t,l.setNodeMarkup(o+d,null,{...h,colwidth:p})}l.docChanged&&n.dispatch(l)}function x0(n,e,t,r){const s=n.state.doc.resolve(e),i=s.node(-1),o=s.start(-1),a=Be.get(i).colCount(s.pos-o)+s.nodeAfter.attrs.colspan-1;let l=n.domAtPos(s.start(-1)).node;for(;l&&l.nodeName!="TABLE";)l=l.parentNode;l&&ip(i,l.firstChild,l,r,a,t)}function NW(n){return Array(n).fill(0)}function IW(n,e){var t;const r=[],s=n.doc.resolve(e),i=s.node(-1);if(!i)return Ue.empty;const o=Be.get(i),a=s.start(-1),l=o.colCount(s.pos-a)+s.nodeAfter.attrs.colspan-1;for(let c=0;c<o.height;c++){const u=l+c*o.width;if((l==o.width-1||o.map[u]!=o.map[u+1])&&(c==0||o.map[u]!=o.map[u-o.width])){const d=o.map[u],h=a+d+i.nodeAt(d).nodeSize-1,f=document.createElement("div");f.className="column-resize-handle",(t=dn.getState(n))!=null&&t.dragging&&r.push(Tt.node(a+d,a+d+i.nodeAt(d).nodeSize,{class:"column-resize-dragging"})),r.push(Tt.widget(h,f))}}return Ue.create(n.doc,r)}function LW({allowTableNodeSelection:n=!1}={}){return new Lt({key:Jr,state:{init(){return null},apply(e,t){const r=e.getMeta(Jr);if(r!=null)return r==-1?null:r;if(t==null||!e.docChanged)return t;const{deleted:s,pos:i}=e.mapping.mapResult(t);return s?null:i}},props:{decorations:rW,handleDOMEvents:{mousedown:TW},createSelectionBetween(e){return Jr.getState(e.state)!=null?e.state.selection:null},handleTripleClick:SW,handleKeyDown:CW,handlePaste:MW},appendTransaction(e,t,r){return oW(r,lW(r,t),n)}})}var Eu=typeof navigator<"u"?navigator:null,hg=Eu&&Eu.userAgent||"",zW=/Edge\/(\d+)/.exec(hg),BW=/MSIE \d/.exec(hg),FW=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(hg),VW=!!(BW||FW||zW),HW=!VW&&!!Eu&&/Apple Computer/.test(Eu.vendor),Qx=new Dt("safari-ime-span"),op=!1,WW={key:Qx,props:{decorations:jW,handleDOMEvents:{compositionstart:()=>{op=!0},compositionend:()=>{op=!1}}}};function jW(n){const{$from:e,$to:t,to:r}=n.selection;if(op&&e.sameParent(t)){const s=Tt.widget(r,UW,{ignoreSelection:!0,key:"safari-ime-span"});return Ue.create(n.doc,[s])}}function UW(n){const e=n.dom.ownerDocument.createElement("span");return e.className="ProseMirror-safari-ime-span",e}var qW=new Lt(HW?WW:{key:Qx});function he(n,e){return Object.assign(n,{meta:{package:"@milkdown/preset-gfm",...e}}),n}const fg=gl("strike_through");he(fg,{displayName:"Attr<strikethrough>",group:"Strikethrough"});const kl=ml("strike_through",n=>({parseDOM:[{tag:"del"},{style:"text-decoration",getAttrs:e=>e==="line-through"}],toDOM:e=>["del",n.get(fg.key)(e)],parseMarkdown:{match:e=>e.type==="delete",runner:(e,t,r)=>{e.openMark(r),e.next(t.children),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="strike_through",runner:(e,t)=>{e.withMark(t,"delete")}}}));he(kl.mark,{displayName:"MarkSchema<strikethrough>",group:"Strikethrough"});he(kl.ctx,{displayName:"MarkSchemaCtx<strikethrough>",group:"Strikethrough"});const pg=xe("ToggleStrikeThrough",n=>()=>fd(kl.type(n)));he(pg,{displayName:"Command<ToggleStrikethrough>",group:"Strikethrough"});const Zx=en(n=>pl(/~([^~]+)~$/,kl.type(n)));he(Zx,{displayName:"InputRule<strikethrough>",group:"Strikethrough"});const mg=nn("strikeThroughKeymap",{ToggleStrikethrough:{shortcuts:"Mod-Alt-x",command:n=>{const e=n.get(ve);return()=>e.call(pg.key)}}});he(mg.ctx,{displayName:"KeymapCtx<strikethrough>",group:"Strikethrough"});he(mg.shortcuts,{displayName:"Keymap<strikethrough>",group:"Strikethrough"});const xl=XH({tableGroup:"block",cellContent:"paragraph",cellAttributes:{alignment:{default:"left",getFromDOM:n=>n.style.textAlign||"left",setDOMAttr:(n,e)=>{e.style="text-align: ".concat(n||"left")}}}}),To=$t("table",()=>({...xl.table,content:"table_header_row table_row+",disableDropCursor:!0,parseMarkdown:{match:n=>n.type==="table",runner:(n,e,t)=>{const r=e.align,s=e.children.map((i,o)=>({...i,align:r,isHeader:o===0}));n.openNode(t),n.next(s),n.closeNode()}},toMarkdown:{match:n=>n.type.name==="table",runner:(n,e)=>{var t;const r=(t=e.content.firstChild)==null?void 0:t.content;if(!r)return;const s=[];r.forEach(i=>{s.push(i.attrs.alignment)}),n.openNode("table",void 0,{align:s}),n.next(e.content),n.closeNode()}}}));he(To.node,{displayName:"NodeSchema<table>",group:"Table"});he(To.ctx,{displayName:"NodeSchemaCtx<table>",group:"Table"});const Od=$t("table_header_row",()=>({...xl.table_row,disableDropCursor:!0,content:"(table_header)*",parseDOM:[{tag:"tr[data-is-header]"}],toDOM(){return["tr",{"data-is-header":!0},0]},parseMarkdown:{match:n=>!!(n.type==="tableRow"&&n.isHeader),runner:(n,e,t)=>{const r=e.align,s=e.children.map((i,o)=>({...i,align:r[o],isHeader:e.isHeader}));n.openNode(t),n.next(s),n.closeNode()}},toMarkdown:{match:n=>n.type.name==="table_header_row",runner:(n,e)=>{n.openNode("tableRow",void 0,{isHeader:!0}),n.next(e.content),n.closeNode()}}}));he(Od.node,{displayName:"NodeSchema<tableHeaderRow>",group:"Table"});he(Od.ctx,{displayName:"NodeSchemaCtx<tableHeaderRow>",group:"Table"});const Cl=$t("table_row",()=>({...xl.table_row,disableDropCursor:!0,content:"(table_cell)*",parseMarkdown:{match:n=>n.type==="tableRow",runner:(n,e,t)=>{const r=e.align,s=e.children.map((i,o)=>({...i,align:r[o]}));n.openNode(t),n.next(s),n.closeNode()}},toMarkdown:{match:n=>n.type.name==="table_row",runner:(n,e)=>{e.content.size!==0&&(n.openNode("tableRow"),n.next(e.content),n.closeNode())}}}));he(Cl.node,{displayName:"NodeSchema<tableRow>",group:"Table"});he(Cl.ctx,{displayName:"NodeSchemaCtx<tableRow>",group:"Table"});const Sl=$t("table_cell",()=>({...xl.table_cell,disableDropCursor:!0,parseMarkdown:{match:n=>n.type==="tableCell"&&!n.isHeader,runner:(n,e,t)=>{const r=e.align;n.openNode(t,{alignment:r}).openNode(n.schema.nodes.paragraph).next(e.children).closeNode().closeNode()}},toMarkdown:{match:n=>n.type.name==="table_cell",runner:(n,e)=>{n.openNode("tableCell").next(e.content).closeNode()}}}));he(Sl.node,{displayName:"NodeSchema<tableCell>",group:"Table"});he(Sl.ctx,{displayName:"NodeSchemaCtx<tableCell>",group:"Table"});const Dd=$t("table_header",()=>({...xl.table_header,disableDropCursor:!0,parseMarkdown:{match:n=>n.type==="tableCell"&&!!n.isHeader,runner:(n,e,t)=>{const r=e.align;n.openNode(t,{alignment:r}),n.openNode(n.schema.nodes.paragraph),n.next(e.children),n.closeNode(),n.closeNode()}},toMarkdown:{match:n=>n.type.name==="table_header",runner:(n,e)=>{n.openNode("tableCell"),n.next(e.content),n.closeNode()}}}));he(Dd.node,{displayName:"NodeSchema<tableHeader>",group:"Table"});he(Dd.ctx,{displayName:"NodeSchemaCtx<tableHeader>",group:"Table"});function e2(n,e=3,t=3){const r=Array(t).fill(0).map(()=>Sl.type(n).createAndFill()),s=Array(t).fill(0).map(()=>Dd.type(n).createAndFill()),i=Array(e).fill(0).map((o,a)=>a===0?Od.type(n).create(null,s):Cl.type(n).create(null,r));return To.type(n).create(null,i)}function Ml(n){return Xk(e=>e.type.spec.tableRole==="table")(n)}function Ws(n,e){const t=Ml(e.$from);if(!t)return;const r=Be.get(t.node);if(!(n<0||n>=r.width))return r.cellsInRect({left:n,right:n+1,top:0,bottom:r.height}).map(s=>{const i=t.node.nodeAt(s);if(!i)return;const o=s+t.start;return{pos:o,start:o+1,node:i}}).filter(s=>s!=null)}function js(n,e){const t=Ml(e.$from);if(!t)return;const r=Be.get(t.node);if(!(n<0||n>=r.height))return r.cellsInRect({left:0,right:r.width,top:n,bottom:n+1}).map(s=>{const i=t.node.nodeAt(s);if(!i)return;const o=s+t.start;return{pos:o,start:o+1,node:i}}).filter(s=>s!=null)}function YW(n){const e=Ml(n.$from);if(!e)return;const t=Be.get(e.node);return t.cellsInRect({left:0,right:t.width,top:0,bottom:t.height}).map(s=>{const i=e.node.nodeAt(s),o=s+e.start;return{pos:o,start:o+1,node:i}})}function KW(n){const e=YW(n.selection);if(e&&e[0]){const t=n.doc.resolve(e[0].pos),r=e[e.length-1];if(r){const s=n.doc.resolve(r.pos);return pd(n.setSelection(new Ge(s,t)))}}return n}function t2(n,e,{map:t,tableStart:r,table:s},i){const o=Array(i).fill(0).reduce((l,c,u)=>l+s.child(u).nodeSize,r),a=Array(t.width).fill(0).map((l,c)=>{const u=s.nodeAt(t.map[c]);return Sl.type(n).createAndFill({alignment:u==null?void 0:u.attrs.alignment})});return e.insert(o,Cl.type(n).create(null,a)),e}function n2(n){return(e,t)=>r=>{t=t!=null?t:r.selection.from;const s=r.doc.resolve(t),i=Xk(l=>l.type.name==="table")(s),o=i?{node:i.node,from:i.start}:void 0,a=n==="row";if(o){const l=Be.get(o.node);if(e>=0&&e<(a?l.height:l.width)){const c=l.positionAt(a?e:l.height-1,a?l.width-1:e,o.node),u=r.doc.resolve(o.from+c),d=a?Ge.rowSelection:Ge.colSelection,h=l.positionAt(a?e:0,a?0:e,o.node),f=r.doc.resolve(o.from+h);return pd(r.setSelection(d(u,f)))}}return r}}const GW=n2("row"),JW=n2("col");function C0(n){return n[0].map((e,t)=>n.map(r=>r[t]))}function r2(n,e){const t=[],r=Be.get(n);for(let i=0;i<r.height;i++){const o=n.child(i),a=[];for(let l=0;l<r.width;l++){if(!e[i][l])continue;const c=r.map[i*r.width+l],u=e[i][l],h=n.nodeAt(c).type.createChecked(Object.assign({},u.attrs),u.content,u.marks);a.push(h)}t.push(o.type.createChecked(o.attrs,a,o.marks))}return n.type.createChecked(n.attrs,t,n.marks)}function s2(n){const e=Be.get(n),t=[];for(let r=0;r<e.height;r++){const s=[],i={};for(let o=0;o<e.width;o++){const a=e.map[r*e.width+o],l=n.nodeAt(a),c=e.findCell(a);if(i[a]||c.top!==r){s.push(null);continue}i[a]=!0,s.push(l)}t.push(s)}return t}function i2(n,e,t,r){const s=e[0]>t[0]?-1:1,i=n.splice(e[0],e.length),o=i.length%2===0?1:0;let a;return a=s===-1?t[0]:t[t.length-1]-o,n.splice(a,0,...i),n}function XW(n,e,t,r){let s=C0(s2(n.node));return s=i2(s,e,t),s=C0(s),r2(n.node,s)}function QW(n,e,t,r){let s=s2(n.node);return s=i2(s,e,t),r2(n.node,s)}function S0(n,e){let t=n,r=n;for(let u=n;u>=0;u--){const d=Ws(u,e.selection);d&&d.forEach(h=>{const f=h.node.attrs.colspan+u-1;f>=t&&(t=u),f>r&&(r=f)})}for(let u=n;u<=r;u++){const d=Ws(u,e.selection);d&&d.forEach(h=>{const f=h.node.attrs.colspan+u-1;h.node.attrs.colspan>1&&f>r&&(r=f)})}const s=[];for(let u=t;u<=r;u++){const d=Ws(u,e.selection);d&&d.length&&s.push(u)}t=s[0],r=s[s.length-1];const i=Ws(t,e.selection),o=js(0,e.selection),a=e.doc.resolve(i[i.length-1].pos);let l;for(let u=r;u>=t;u--){const d=Ws(u,e.selection);if(d&&d.length){for(let h=o.length-1;h>=0;h--)if(o[h].pos===d[0].pos){l=d[0];break}if(l)break}}const c=e.doc.resolve(l.pos);return{$anchor:a,$head:c,indexes:s}}function M0(n,e){let t=n,r=n;for(let u=n;u>=0;u--)js(u,e.selection).forEach(h=>{const f=h.node.attrs.rowspan+u-1;f>=t&&(t=u),f>r&&(r=f)});for(let u=n;u<=r;u++)js(u,e.selection).forEach(h=>{const f=h.node.attrs.rowspan+u-1;h.node.attrs.rowspan>1&&f>r&&(r=f)});const s=[];for(let u=t;u<=r;u++){const d=js(u,e.selection);d&&d.length&&s.push(u)}t=s[0],r=s[s.length-1];const i=js(t,e.selection),o=Ws(0,e.selection),a=e.doc.resolve(i[i.length-1].pos);let l;for(let u=r;u>=t;u--){const d=js(u,e.selection);if(d&&d.length){for(let h=o.length-1;h>=0;h--)if(o[h].pos===d[0].pos){l=d[0];break}if(l)break}}const c=e.doc.resolve(l.pos);return{$anchor:a,$head:c,indexes:s}}function ZW(n){const{tr:e,origin:t,target:r,select:s=!0,pos:i}=n,o=i!=null?e.doc.resolve(i):e.selection.$from,a=Ml(o);if(!a)return e;const{indexes:l}=S0(t,e),{indexes:c}=S0(r,e);if(l.includes(r))return e;const u=XW(a,l,c),d=pd(e).replaceWith(a.pos,a.pos+a.node.nodeSize,u);if(!s)return d;const h=Be.get(u),f=a.start,p=r,m=h.positionAt(h.height-1,p,u),g=d.doc.resolve(f+m),b=Ge.colSelection,_=h.positionAt(0,p,u),M=d.doc.resolve(f+_);return d.setSelection(b(g,M))}function ej(n){const{tr:e,origin:t,target:r,select:s=!0,pos:i}=n,o=i!=null?e.doc.resolve(i):e.selection.$from,a=Ml(o);if(!a)return e;const{indexes:l}=M0(t,e),{indexes:c}=M0(r,e);if(l.includes(r))return e;const u=QW(a,l,c),d=pd(e).replaceWith(a.pos,a.pos+a.node.nodeSize,u);if(!s)return d;const h=Be.get(u),f=a.start,p=r,m=h.positionAt(p,h.width-1,u),g=d.doc.resolve(f+m),b=Ge.rowSelection,_=h.positionAt(p,0,u),M=d.doc.resolve(f+_);return d.setSelection(b(g,M))}const gg=xe("GoToPrevTableCell",()=>()=>Yx(-1));he(gg,{displayName:"Command<goToPrevTableCellCommand>",group:"Table"});const yg=xe("GoToNextTableCell",()=>()=>Yx(1));he(yg,{displayName:"Command<goToNextTableCellCommand>",group:"Table"});const vg=xe("ExitTable",n=>()=>(e,t)=>{if(!On(e))return!1;const{$head:r}=e.selection,s=_V(r,To.type(n));if(!s)return!1;const{to:i}=s,o=e.tr.replaceWith(i,i,Ss.type(n).createAndFill());return o.setSelection(ge.near(o.doc.resolve(i),1)).scrollIntoView(),t==null||t(o),!0});he(vg,{displayName:"Command<breakTableCommand>",group:"Table"});const bg=xe("InsertTable",n=>({row:e,col:t}={})=>(r,s)=>{const{selection:i,tr:o}=r,{from:a}=i,l=e2(n,e,t),c=o.replaceSelectionWith(l),u=ge.findFrom(c.doc.resolve(a),1,!0);return u&&c.setSelection(u),s==null||s(c),!0});he(bg,{displayName:"Command<insertTableCommand>",group:"Table"});const wg=xe("MoveRow",()=>({from:n,to:e,pos:t}={})=>(r,s)=>{const{tr:i}=r;return!!(s==null?void 0:s(ej({tr:i,origin:n!=null?n:0,target:e!=null?e:0,pos:t,select:!0})))});he(wg,{displayName:"Command<moveRowCommand>",group:"Table"});const _g=xe("MoveCol",()=>({from:n,to:e,pos:t}={})=>(r,s)=>{const{tr:i}=r;return!!(s==null?void 0:s(ZW({tr:i,origin:n!=null?n:0,target:e!=null?e:0,pos:t,select:!0})))});he(_g,{displayName:"Command<moveColCommand>",group:"Table"});const kg=xe("SelectRow",()=>(n={index:0})=>(e,t)=>{const{tr:r}=e;return!!(t==null?void 0:t(GW(n.index,n.pos)(r)))});he(kg,{displayName:"Command<selectRowCommand>",group:"Table"});const xg=xe("SelectCol",()=>(n={index:0})=>(e,t)=>{const{tr:r}=e;return!!(t==null?void 0:t(JW(n.index,n.pos)(r)))});he(xg,{displayName:"Command<selectColCommand>",group:"Table"});const Cg=xe("SelectTable",()=>()=>(n,e)=>{const{tr:t}=n;return!!(e==null?void 0:e(KW(t)))});he(Cg,{displayName:"Command<selectTableCommand>",group:"Table"});const Sg=xe("DeleteSelectedCells",()=>()=>(n,e)=>{const{selection:t}=n;if(!(t instanceof Ge))return!1;const r=t.isRowSelection(),s=t.isColSelection();return r&&s?bW(n,e):s?fW(n,e):mW(n,e)});he(Sg,{displayName:"Command<deleteSelectedCellsCommand>",group:"Table"});const Mg=xe("AddColBefore",()=>()=>uW);he(Mg,{displayName:"Command<addColBeforeCommand>",group:"Table"});const Tg=xe("AddColAfter",()=>()=>dW);he(Tg,{displayName:"Command<addColAfterCommand>",group:"Table"});const Og=xe("AddRowBefore",n=>()=>(e,t)=>{if(!On(e))return!1;if(t){const r=Ms(e);t(t2(n,e.tr,r,r.top))}return!0});he(Og,{displayName:"Command<addRowBeforeCommand>",group:"Table"});const Dg=xe("AddRowAfter",n=>()=>(e,t)=>{if(!On(e))return!1;if(t){const r=Ms(e);t(t2(n,e.tr,r,r.bottom))}return!0});he(Dg,{displayName:"Command<addRowAfterCommand>",group:"Table"});const Ea=xe("SetAlign",()=>(n="left")=>gW("alignment",n));he(Ea,{displayName:"Command<setAlignCommand>",group:"Table"});const o2=en(n=>new yn(new RegExp("^\\|(?<col>\\d+)[xX](?<row>\\d+)\\|\\s$"),(e,t,r,s)=>{var d;var i,o;const a=e.doc.resolve(r);if(!a.node(-1).canReplaceWith(a.index(-1),a.indexAfter(-1),To.type(n)))return null;const l=Math.max(Number((d=(i=t.groups)==null?void 0:i.row)!=null?d:0),2),c=e2(n,l,Number((o=t.groups)==null?void 0:o.col)),u=e.tr.replaceRangeWith(r,s,c);return u.setSelection(we.create(u.doc,r+3)).scrollIntoView()}));he(o2,{displayName:"InputRule<insertTableInputRule>",group:"Table"});const $g=nn("tableKeymap",{NextCell:{shortcuts:["Mod-]","Tab"],command:n=>{const e=n.get(ve);return()=>e.call(yg.key)}},PrevCell:{shortcuts:["Mod-[","Shift-Tab"],command:n=>{const e=n.get(ve);return()=>e.call(gg.key)}},ExitTable:{shortcuts:["Mod-Enter","Enter"],command:n=>{const e=n.get(ve);return()=>e.call(vg.key)}}});he($g.ctx,{displayName:"KeymapCtx<table>",group:"Table"});he($g.shortcuts,{displayName:"Keymap<table>",group:"Table"});const Nh="footnote_definition",T0="footnoteDefinition",Eg=$t("footnote_definition",()=>({group:"block",content:"block+",defining:!0,attrs:{label:{default:"",validate:"string"}},parseDOM:[{tag:'dl[data-type="'.concat(Nh,'"]'),getAttrs:n=>{if(!(n instanceof HTMLElement))throw cr(n);return{label:n.dataset.label}},contentElement:"dd"}],toDOM:n=>{const e=n.attrs.label;return["dl",{"data-label":e,"data-type":Nh},["dt",e],["dd",0]]},parseMarkdown:{match:({type:n})=>n===T0,runner:(n,e,t)=>{n.openNode(t,{label:e.label}).next(e.children).closeNode()}},toMarkdown:{match:n=>n.type.name===Nh,runner:(n,e)=>{n.openNode(T0,void 0,{label:e.attrs.label,identifier:e.attrs.label}).next(e.content).closeNode()}}}));he(Eg.ctx,{displayName:"NodeSchemaCtx<footnodeDef>",group:"footnote"});he(Eg.node,{displayName:"NodeSchema<footnodeDef>",group:"footnote"});const Ih="footnote_reference",Ag=$t("footnote_reference",()=>({group:"inline",inline:!0,atom:!0,attrs:{label:{default:"",validate:"string"}},parseDOM:[{tag:'sup[data-type="'.concat(Ih,'"]'),getAttrs:n=>{if(!(n instanceof HTMLElement))throw cr(n);return{label:n.dataset.label}}}],toDOM:n=>{const e=n.attrs.label;return["sup",{"data-label":e,"data-type":Ih},e]},parseMarkdown:{match:({type:n})=>n==="footnoteReference",runner:(n,e,t)=>{n.addNode(t,{label:e.label})}},toMarkdown:{match:n=>n.type.name===Ih,runner:(n,e)=>{n.addNode("footnoteReference",void 0,void 0,{label:e.attrs.label,identifier:e.attrs.label})}}}));he(Ag.ctx,{displayName:"NodeSchemaCtx<footnodeRef>",group:"footnote"});he(Ag.node,{displayName:"NodeSchema<footnodeRef>",group:"footnote"});const a2=ar.extendSchema(n=>e=>{const t=n(e);return{...t,attrs:{...t.attrs,checked:{default:null,validate:"boolean|null"}},parseDOM:[{tag:'li[data-item-type="task"]',getAttrs:r=>{if(!(r instanceof HTMLElement))throw cr(r);return{label:r.dataset.label,listType:r.dataset.listType,spread:r.dataset.spread,checked:r.dataset.checked?r.dataset.checked==="true":null}}},...(t==null?void 0:t.parseDOM)||[]],toDOM:r=>t.toDOM&&r.attrs.checked==null?t.toDOM(r):["li",{"data-item-type":"task","data-label":r.attrs.label,"data-list-type":r.attrs.listType,"data-spread":r.attrs.spread,"data-checked":r.attrs.checked},0],parseMarkdown:{match:({type:r})=>r==="listItem",runner:(r,s,i)=>{if(s.checked==null){t.parseMarkdown.runner(r,s,i);return}const o=s.label!=null?"".concat(s.label,"."):"•",a=s.checked!=null?!!s.checked:null,l=s.label!=null?"ordered":"bullet",c=s.spread!=null?"".concat(s.spread):"true";r.openNode(i,{label:o,listType:l,spread:c,checked:a}),r.next(s.children),r.closeNode()}},toMarkdown:{match:r=>r.type.name==="list_item",runner:(r,s)=>{if(s.attrs.checked==null){t.toMarkdown.runner(r,s);return}const i=s.attrs.label,o=s.attrs.listType,a=s.attrs.spread==="true",l=s.attrs.checked;r.openNode("listItem",void 0,{label:i,listType:o,spread:a,checked:l}),r.next(s.content),r.closeNode()}}}});he(a2,{displayName:"NodeSchema<listItem>",group:"ListItem"});const l2=en(()=>new yn(new RegExp("^\\[(?<checked>\\s|x)\\]\\s$"),(n,e,t,r)=>{var s;const i=n.doc.resolve(t);let o=0,a=i.node(o);for(;a&&a.type.name!=="list_item";)o--,a=i.node(o);if(!a||a.attrs.checked!=null)return null;const l=((s=e.groups)==null?void 0:s.checked)==="x",c=i.before(o),u=n.tr;return u.deleteRange(t,r).setNodeMarkup(c,void 0,{...a.attrs,checked:l}),u}));he(l2,{displayName:"InputRule<wrapInTaskListInputRule>",group:"ListItem"});const tj=[mg,$g].flat(),nj=[o2,l2],rj=[Zx],c2=vn(()=>qW);he(c2,{displayName:"Prose<autoInsertSpanPlugin>",group:"Prose"});const u2=vn(()=>Jx({}));he(u2,{displayName:"Prose<columnResizingPlugin>",group:"Prose"});const d2=vn(()=>LW({allowTableNodeSelection:!0}));he(d2,{displayName:"Prose<tableEditingPlugin>",group:"Prose"});const Pg=Ti("remarkGFM",()=>fC);he(Pg.plugin,{displayName:"Remark<remarkGFMPlugin>",group:"Remark"});he(Pg.options,{displayName:"RemarkConfig<remarkGFMPlugin>",group:"Remark"});const sj=new Dt("MILKDOWN_KEEP_TABLE_ALIGN_PLUGIN");function ij(n,e){let t=0;return e.forEach((r,s,i)=>{r===n&&(t=i)}),t}const h2=vn(()=>new Lt({key:sj,appendTransaction:(n,e,t)=>{let r;const s=(i,o)=>{if(r||(r=t.tr),i.type.name!=="table_cell")return;const a=t.doc.resolve(o),l=a.node(a.depth),u=a.node(a.depth-1).firstChild;if(!u)return;const d=ij(i,l),h=u.maybeChild(d);if(!h)return;const f=h.attrs.alignment,p=i.attrs.alignment;f!==p&&r.setNodeMarkup(o,void 0,{...i.attrs,alignment:f})};return e.doc!==t.doc&&t.doc.descendants(s),r}}));he(h2,{displayName:"Prose<keepTableAlignPlugin>",group:"Prose"});const oj=[h2,c2,Pg,d2].flat(),aj=[a2,To,Od,Cl,Dd,Sl,Eg,Ag,fg,kl].flat(),lj=[yg,gg,vg,bg,wg,_g,kg,xg,Cg,Sg,Og,Dg,Mg,Tg,Ea,pg],Lh=[aj,nj,rj,tj,lj,oj].flat(),on=B({__name:"EditorButton",props:{icon:{}},setup(n){return(e,t)=>(w(),S("button",{class:ue(["fr-btn fr-btn--secondary-grey-400 fr-btn--sm fr-btn--tertiary-no-outline",e.icon]),role:"menuitem"},[Ye(e.$slots,"default")],2))}}),cj=["aria-labelledby","id"],uj={class:"fr-container fr-container--fluid fr-container-md"},dj={class:"fr-grid-row fr-grid-row--center"},hj={class:"fr-col-12 fr-col-md-8 fr-col-lg-6"},fj={class:"fr-modal__body"},pj={class:"fr-modal__header"},mj={class:"fr-modal__content"},gj=["id"],yj={"data-testid":"summary"},vj={class:"fr-my-1w"},bj={class:"fr-modal__footer"},wj={class:"fr-btns-group fr-btns-group--right"},_j=B({inheritAttrs:!1,__name:"ImageModal",props:{id:{}},emits:["sendModal"],setup(n,{emit:e}){const t=n,r=e,{t:s}=Te(),i=A(()=>t.id+"-title"),o=$(),a={src:"",title:"",alt:""},l=ki({...a}),c={src:{required:jh}},{getErrorText:u,getFunctionalState:d,hasError:h,reset:f,validateRequiredRules:p,v$:m}=f_(l,c,c),g=A(()=>({src:d(m.value.src.$dirty,m.value.src.$error,!1)}));function b(k){return h(g,k)}function _(){globalThis.dsfr(o.value).modal.conceal(),l.src=a.src,l.title=a.title,l.alt=a.alt,f()}function M(){p().then(k=>{k&&(r("sendModal",{...l}),_())})}return(k,C)=>(w(),Y(ws,{to:"body"},[v("dialog",rr(k.$attrs,{"aria-labelledby":i.value,id:k.id,role:"dialog",class:"fr-modal",ref_key:"modalRef",ref:o}),[v("div",uj,[v("div",dj,[v("div",hj,[v("div",fj,[v("div",pj,[v("button",{class:"fr-btn--close fr-btn","aria-controls":"fr-modal-2",onClick:_},T(y(s)("Close")),1)]),v("div",mj,[v("h1",{id:i.value,class:"fr-mb-2w fr-modal__title"},[C[3]||(C[3]=v("span",{class:"fr-icon-image-line fr-icon--lg"},null,-1)),U(" "+T(y(s)("Add an image")),1)],8,gj),v("p",null,T(y(s)("Paste a link of your image to add it to your description. It is recommended to also provide a textual alternative for an informative image and a title.")),1),P(Wp),P(Gc,{label:y(s)("Image link"),placeholder:y(s)("Paste your link..."),required:!0,modelValue:l.src,"onUpdate:modelValue":C[0]||(C[0]=x=>l.src=x),type:"url",hasError:b("src"),errorText:y(u)("src")},null,8,["label","placeholder","modelValue","hasError","errorText"]),v("details",null,[v("summary",yj,T(y(s)("Customize accessibility options")),1),v("div",vj,[P(Gc,{label:y(s)("Image alternative text"),modelValue:l.alt,"onUpdate:modelValue":C[1]||(C[1]=x=>l.alt=x)},null,8,["label","modelValue"]),P(Gc,{label:y(s)("Image title"),modelValue:l.title,"onUpdate:modelValue":C[2]||(C[2]=x=>l.title=x)},null,8,["label","modelValue"])])])]),v("div",bj,[v("div",wj,[v("button",{class:"fr-btn",onClick:M,"data-testid":"add-image-button"},T(y(s)("Add image")),1)])])])])])])],16,cj)]))}}),kj=B({__name:"ImageModalButton",emits:["send"],setup(n,{emit:e}){const t=e,{t:r}=Te(),s=xi("image-modal");function i(o){t("send",o)}return(o,a)=>(w(),S(J,null,[P(on,{"data-fr-opened":"false","aria-controls":y(s),icon:"fr-icon-image-add-fill",title:y(r)("Image"),"data-testid":"image-modal-button"},null,8,["aria-controls","title"]),P(_j,{id:y(s),multiple:!0,onSendModal:i},null,8,["id"])],64))}});class xj extends Gx{constructor(e,t){super(e,t),this.dom.className="fr-table fr-table--no-caption fr-table--layout-fixed"}ignoreMutation(e){return super.ignoreMutation(e)||e.type==="attributes"&&e.target===this.dom}}const Cj=vn(()=>Jx({View:xj})),ap=Math.min,eo=Math.max,Au=Math.round,nr=n=>({x:n,y:n}),Sj={left:"right",right:"left",bottom:"top",top:"bottom"},Mj={start:"end",end:"start"};function O0(n,e,t){return eo(n,ap(e,t))}function $d(n,e){return typeof n=="function"?n(e):n}function _i(n){return n.split("-")[0]}function Ed(n){return n.split("-")[1]}function f2(n){return n==="x"?"y":"x"}function p2(n){return n==="y"?"height":"width"}function ai(n){return["top","bottom"].includes(_i(n))?"y":"x"}function m2(n){return f2(ai(n))}function Tj(n,e,t){t===void 0&&(t=!1);const r=Ed(n),s=m2(n),i=p2(s);let o=s==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=Pu(o)),[o,Pu(o)]}function Oj(n){const e=Pu(n);return[lp(n),e,lp(e)]}function lp(n){return n.replace(/start|end/g,e=>Mj[e])}function Dj(n,e,t){const r=["left","right"],s=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(n){case"top":case"bottom":return t?e?s:r:e?r:s;case"left":case"right":return e?i:o;default:return[]}}function $j(n,e,t,r){const s=Ed(n);let i=Dj(_i(n),t==="start",r);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(lp)))),i}function Pu(n){return n.replace(/left|right|bottom|top/g,e=>Sj[e])}function Ej(n){return{top:0,right:0,bottom:0,left:0,...n}}function Aj(n){return typeof n!="number"?Ej(n):{top:n,right:n,bottom:n,left:n}}function Ru(n){const{x:e,y:t,width:r,height:s}=n;return{width:r,height:s,top:t,left:e,right:e+r,bottom:t+s,x:e,y:t}}function D0(n,e,t){let{reference:r,floating:s}=n;const i=ai(e),o=m2(e),a=p2(o),l=_i(e),c=i==="y",u=r.x+r.width/2-s.width/2,d=r.y+r.height/2-s.height/2,h=r[a]/2-s[a]/2;let f;switch(l){case"top":f={x:u,y:r.y-s.height};break;case"bottom":f={x:u,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:d};break;case"left":f={x:r.x-s.width,y:d};break;default:f={x:r.x,y:r.y}}switch(Ed(e)){case"start":f[o]-=h*(t&&c?-1:1);break;case"end":f[o]+=h*(t&&c?-1:1);break}return f}const Pj=async(n,e,t)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=t,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:n,floating:e,strategy:s}),{x:u,y:d}=D0(c,r,l),h=r,f={},p=0;for(let m=0;m<a.length;m++){const{name:g,fn:b}=a[m],{x:_,y:M,data:k,reset:C}=await b({x:u,y:d,initialPlacement:r,placement:h,strategy:s,middlewareData:f,rects:c,platform:o,elements:{reference:n,floating:e}});u=_!=null?_:u,d=M!=null?M:d,f={...f,[g]:{...f[g],...k}},C&&p<=50&&(p++,typeof C=="object"&&(C.placement&&(h=C.placement),C.rects&&(c=C.rects===!0?await o.getElementRects({reference:n,floating:e,strategy:s}):C.rects),{x:u,y:d}=D0(c,h,l)),m=-1)}return{x:u,y:d,placement:h,strategy:s,middlewareData:f}};async function g2(n,e){var t;e===void 0&&(e={});const{x:r,y:s,platform:i,rects:o,elements:a,strategy:l}=n,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=$d(e,n),p=Aj(f),g=a[h?d==="floating"?"reference":"floating":d],b=Ru(await i.getClippingRect({element:(t=await(i.isElement==null?void 0:i.isElement(g)))==null||t?g:g.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),_=d==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,M=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),k=await(i.isElement==null?void 0:i.isElement(M))?await(i.getScale==null?void 0:i.getScale(M))||{x:1,y:1}:{x:1,y:1},C=Ru(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:_,offsetParent:M,strategy:l}):_);return{top:(b.top-C.top+p.top)/k.y,bottom:(C.bottom-b.bottom+p.bottom)/k.y,left:(b.left-C.left+p.left)/k.x,right:(C.right-b.right+p.right)/k.x}}const Rj=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...g}=$d(n,e);if((t=i.arrow)!=null&&t.alignmentOffset)return{};const b=_i(s),_=ai(a),M=_i(a)===a,k=await(l.isRTL==null?void 0:l.isRTL(c.floating)),C=h||(M||!m?[Pu(a)]:Oj(a)),x=p!=="none";!h&&x&&C.push(...$j(a,m,p,k));const D=[a,...C],O=await g2(e,g),E=[];let R=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&E.push(O[b]),d){const te=Tj(s,o,k);E.push(O[te[0]],O[te[1]])}if(R=[...R,{placement:s,overflows:E}],!E.every(te=>te<=0)){var W,K;const te=(((W=i.flip)==null?void 0:W.index)||0)+1,de=D[te];if(de){var _e;const De=d==="alignment"?_!==ai(de):!1,ye=((_e=R[0])==null?void 0:_e.overflows[0])>0;if(!De||ye)return{data:{index:te,overflows:R},reset:{placement:de}}}let me=(K=R.filter(De=>De.overflows[0]<=0).sort((De,ye)=>De.overflows[1]-ye.overflows[1])[0])==null?void 0:K.placement;if(!me)switch(f){case"bestFit":{var He;const De=(He=R.filter(ye=>{if(x){const fe=ai(ye.placement);return fe===_||fe==="y"}return!0}).map(ye=>[ye.placement,ye.overflows.filter(fe=>fe>0).reduce((fe,Xe)=>fe+Xe,0)]).sort((ye,fe)=>ye[1]-fe[1])[0])==null?void 0:He[0];De&&(me=De);break}case"initialPlacement":me=a;break}if(s!==me)return{reset:{placement:me}}}return{}}}};async function Nj(n,e){const{placement:t,platform:r,elements:s}=n,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=_i(t),a=Ed(t),l=ai(t)==="y",c=["left","top"].includes(o)?-1:1,u=i&&l?-1:1,d=$d(e,n);let{mainAxis:h,crossAxis:f,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof p=="number"&&(f=a==="end"?p*-1:p),l?{x:f*u,y:h*c}:{x:h*c,y:f*u}}const Ij=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:s,y:i,placement:o,middlewareData:a}=e,l=await Nj(e,n);return o===((t=a.offset)==null?void 0:t.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:o}}}}},Lj=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:g=>{let{x:b,y:_}=g;return{x:b,y:_}}},...l}=$d(n,e),c={x:t,y:r},u=await g2(e,l),d=ai(_i(s)),h=f2(d);let f=c[h],p=c[d];if(i){const g=h==="y"?"top":"left",b=h==="y"?"bottom":"right",_=f+u[g],M=f-u[b];f=O0(_,f,M)}if(o){const g=d==="y"?"top":"left",b=d==="y"?"bottom":"right",_=p+u[g],M=p-u[b];p=O0(_,p,M)}const m=a.fn({...e,[h]:f,[d]:p});return{...m,data:{x:m.x-t,y:m.y-r,enabled:{[h]:i,[d]:o}}}}}};function Ad(){return typeof window<"u"}function Oo(n){return y2(n)?(n.nodeName||"").toLowerCase():"#document"}function mn(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function Pr(n){var e;return(e=(y2(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function y2(n){return Ad()?n instanceof Node||n instanceof mn(n).Node:!1}function Ln(n){return Ad()?n instanceof Element||n instanceof mn(n).Element:!1}function lr(n){return Ad()?n instanceof HTMLElement||n instanceof mn(n).HTMLElement:!1}function $0(n){return!Ad()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof mn(n).ShadowRoot}function Tl(n){const{overflow:e,overflowX:t,overflowY:r,display:s}=zn(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!["inline","contents"].includes(s)}function zj(n){return["table","td","th"].includes(Oo(n))}function Pd(n){return[":popover-open",":modal"].some(e=>{try{return n.matches(e)}catch(t){return!1}})}function Rg(n){const e=Ng(),t=Ln(n)?zn(n):n;return["transform","translate","scale","rotate","perspective"].some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function Bj(n){let e=bs(n);for(;lr(e)&&!mo(e);){if(Rg(e))return e;if(Pd(e))return null;e=bs(e)}return null}function Ng(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function mo(n){return["html","body","#document"].includes(Oo(n))}function zn(n){return mn(n).getComputedStyle(n)}function Rd(n){return Ln(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function bs(n){if(Oo(n)==="html")return n;const e=n.assignedSlot||n.parentNode||$0(n)&&n.host||Pr(n);return $0(e)?e.host:e}function v2(n){const e=bs(n);return mo(e)?n.ownerDocument?n.ownerDocument.body:n.body:lr(e)&&Tl(e)?e:v2(e)}function cp(n,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const s=v2(n),i=s===((r=n.ownerDocument)==null?void 0:r.body),o=mn(s);if(i){const a=up(o);return e.concat(o,o.visualViewport||[],Tl(s)?s:[],a&&t?cp(a):[])}return e.concat(s,cp(s,[],t))}function up(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function b2(n){const e=zn(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=lr(n),i=s?n.offsetWidth:t,o=s?n.offsetHeight:r,a=Au(t)!==i||Au(r)!==o;return a&&(t=i,r=o),{width:t,height:r,$:a}}function w2(n){return Ln(n)?n:n.contextElement}function to(n){const e=w2(n);if(!lr(e))return nr(1);const t=e.getBoundingClientRect(),{width:r,height:s,$:i}=b2(e);let o=(i?Au(t.width):t.width)/r,a=(i?Au(t.height):t.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const Fj=nr(0);function _2(n){const e=mn(n);return!Ng()||!e.visualViewport?Fj:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Vj(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==mn(n)?!1:e}function el(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const s=n.getBoundingClientRect(),i=w2(n);let o=nr(1);e&&(r?Ln(r)&&(o=to(r)):o=to(n));const a=Vj(i,t,r)?_2(i):nr(0);let l=(s.left+a.x)/o.x,c=(s.top+a.y)/o.y,u=s.width/o.x,d=s.height/o.y;if(i){const h=mn(i),f=r&&Ln(r)?mn(r):r;let p=h,m=up(p);for(;m&&r&&f!==p;){const g=to(m),b=m.getBoundingClientRect(),_=zn(m),M=b.left+(m.clientLeft+parseFloat(_.paddingLeft))*g.x,k=b.top+(m.clientTop+parseFloat(_.paddingTop))*g.y;l*=g.x,c*=g.y,u*=g.x,d*=g.y,l+=M,c+=k,p=mn(m),m=up(p)}}return Ru({width:u,height:d,x:l,y:c})}function Ig(n,e){const t=Rd(n).scrollLeft;return e?e.left+t:el(Pr(n)).left+t}function k2(n,e,t){t===void 0&&(t=!1);const r=n.getBoundingClientRect(),s=r.left+e.scrollLeft-(t?0:Ig(n,r)),i=r.top+e.scrollTop;return{x:s,y:i}}function Hj(n){let{elements:e,rect:t,offsetParent:r,strategy:s}=n;const i=s==="fixed",o=Pr(r),a=e?Pd(e.floating):!1;if(r===o||a&&i)return t;let l={scrollLeft:0,scrollTop:0},c=nr(1);const u=nr(0),d=lr(r);if((d||!d&&!i)&&((Oo(r)!=="body"||Tl(o))&&(l=Rd(r)),lr(r))){const f=el(r);c=to(r),u.x=f.x+r.clientLeft,u.y=f.y+r.clientTop}const h=o&&!d&&!i?k2(o,l,!0):nr(0);return{width:t.width*c.x,height:t.height*c.y,x:t.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:t.y*c.y-l.scrollTop*c.y+u.y+h.y}}function Wj(n){return Array.from(n.getClientRects())}function jj(n){const e=Pr(n),t=Rd(n),r=n.ownerDocument.body,s=eo(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=eo(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-t.scrollLeft+Ig(n);const a=-t.scrollTop;return zn(r).direction==="rtl"&&(o+=eo(e.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:a}}function Uj(n,e){const t=mn(n),r=Pr(n),s=t.visualViewport;let i=r.clientWidth,o=r.clientHeight,a=0,l=0;if(s){i=s.width,o=s.height;const c=Ng();(!c||c&&e==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}return{width:i,height:o,x:a,y:l}}function qj(n,e){const t=el(n,!0,e==="fixed"),r=t.top+n.clientTop,s=t.left+n.clientLeft,i=lr(n)?to(n):nr(1),o=n.clientWidth*i.x,a=n.clientHeight*i.y,l=s*i.x,c=r*i.y;return{width:o,height:a,x:l,y:c}}function E0(n,e,t){let r;if(e==="viewport")r=Uj(n,t);else if(e==="document")r=jj(Pr(n));else if(Ln(e))r=qj(e,t);else{const s=_2(n);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return Ru(r)}function x2(n,e){const t=bs(n);return t===e||!Ln(t)||mo(t)?!1:zn(t).position==="fixed"||x2(t,e)}function Yj(n,e){const t=e.get(n);if(t)return t;let r=cp(n,[],!1).filter(a=>Ln(a)&&Oo(a)!=="body"),s=null;const i=zn(n).position==="fixed";let o=i?bs(n):n;for(;Ln(o)&&!mo(o);){const a=zn(o),l=Rg(o);!l&&a.position==="fixed"&&(s=null),(i?!l&&!s:!l&&a.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||Tl(o)&&!l&&x2(n,o))?r=r.filter(u=>u!==o):s=a,o=bs(o)}return e.set(n,r),r}function Kj(n){let{element:e,boundary:t,rootBoundary:r,strategy:s}=n;const o=[...t==="clippingAncestors"?Pd(e)?[]:Yj(e,this._c):[].concat(t),r],a=o[0],l=o.reduce((c,u)=>{const d=E0(e,u,s);return c.top=eo(d.top,c.top),c.right=ap(d.right,c.right),c.bottom=ap(d.bottom,c.bottom),c.left=eo(d.left,c.left),c},E0(e,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Gj(n){const{width:e,height:t}=b2(n);return{width:e,height:t}}function Jj(n,e,t){const r=lr(e),s=Pr(e),i=t==="fixed",o=el(n,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=nr(0);function c(){l.x=Ig(s)}if(r||!r&&!i)if((Oo(e)!=="body"||Tl(s))&&(a=Rd(e)),r){const f=el(e,!0,i,e);l.x=f.x+e.clientLeft,l.y=f.y+e.clientTop}else s&&c();i&&!r&&s&&c();const u=s&&!r&&!i?k2(s,a):nr(0),d=o.left+a.scrollLeft-l.x-u.x,h=o.top+a.scrollTop-l.y-u.y;return{x:d,y:h,width:o.width,height:o.height}}function zh(n){return zn(n).position==="static"}function A0(n,e){if(!lr(n)||zn(n).position==="fixed")return null;if(e)return e(n);let t=n.offsetParent;return Pr(n)===t&&(t=t.ownerDocument.body),t}function C2(n,e){const t=mn(n);if(Pd(n))return t;if(!lr(n)){let s=bs(n);for(;s&&!mo(s);){if(Ln(s)&&!zh(s))return s;s=bs(s)}return t}let r=A0(n,e);for(;r&&zj(r)&&zh(r);)r=A0(r,e);return r&&mo(r)&&zh(r)&&!Rg(r)?t:r||Bj(n)||t}const Xj=async function(n){const e=this.getOffsetParent||C2,t=this.getDimensions,r=await t(n.floating);return{reference:Jj(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Qj(n){return zn(n).direction==="rtl"}const Zj={convertOffsetParentRelativeRectToViewportRelativeRect:Hj,getDocumentElement:Pr,getClippingRect:Kj,getOffsetParent:C2,getElementRects:Xj,getClientRects:Wj,getDimensions:Gj,getScale:to,isElement:Ln,isRTL:Qj},P0=Ij,R0=Lj,N0=Rj,I0=(n,e,t)=>{const r=new Map,s={platform:Zj,...t},i={...s.platform,_c:r};return Pj(n,e,{...s,platform:i})};var S2="Expected a function",L0=0/0,eU="[object Symbol]",tU=/^\s+|\s+$/g,nU=/^[-+]0x[0-9a-f]+$/i,rU=/^0b[01]+$/i,sU=/^0o[0-7]+$/i,iU=parseInt,oU=typeof _r=="object"&&_r&&_r.Object===Object&&_r,aU=typeof self=="object"&&self&&self.Object===Object&&self,lU=oU||aU||Function("return this")(),cU=Object.prototype,uU=cU.toString,dU=Math.max,hU=Math.min,Bh=function(){return lU.Date.now()};function fU(n,e,t){var r,s,i,o,a,l,c=0,u=!1,d=!1,h=!0;if(typeof n!="function")throw new TypeError(S2);e=z0(e)||0,Nu(t)&&(u=!!t.leading,d="maxWait"in t,i=d?dU(z0(t.maxWait)||0,e):i,h="trailing"in t?!!t.trailing:h);function f(x){var D=r,O=s;return r=s=void 0,c=x,o=n.apply(O,D),o}function p(x){return c=x,a=setTimeout(b,e),u?f(x):o}function m(x){var D=x-l,O=x-c,E=e-D;return d?hU(E,i-O):E}function g(x){var D=x-l,O=x-c;return l===void 0||D>=e||D<0||d&&O>=i}function b(){var x=Bh();if(g(x))return _(x);a=setTimeout(b,m(x))}function _(x){return a=void 0,h&&r?f(x):(r=s=void 0,o)}function M(){a!==void 0&&clearTimeout(a),c=0,r=l=s=a=void 0}function k(){return a===void 0?o:_(Bh())}function C(){var x=Bh(),D=g(x);if(r=arguments,s=this,l=x,D){if(a===void 0)return p(l);if(d)return a=setTimeout(b,e),f(l)}return a===void 0&&(a=setTimeout(b,e)),o}return C.cancel=M,C.flush=k,C}function pU(n,e,t){var r=!0,s=!0;if(typeof n!="function")throw new TypeError(S2);return Nu(t)&&(r="leading"in t?!!t.leading:r,s="trailing"in t?!!t.trailing:s),fU(n,e,{leading:r,maxWait:e,trailing:s})}function Nu(n){var e=typeof n;return!!n&&(e=="object"||e=="function")}function mU(n){return!!n&&typeof n=="object"}function gU(n){return typeof n=="symbol"||mU(n)&&uU.call(n)==eU}function z0(n){if(typeof n=="number")return n;if(gU(n))return L0;if(Nu(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=Nu(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=n.replace(tU,"");var t=rU.test(n);return t||sU.test(n)?iU(n.slice(2),t?2:8):nU.test(n)?L0:+n}var yU=pU;const vU=yp(yU);var M2=n=>{throw TypeError(n)},Lg=(n,e,t)=>e.has(n)||M2("Cannot "+t),rn=(n,e,t)=>(Lg(n,e,"read from private field"),t?t.call(n):e.get(n)),Hn=(n,e,t)=>e.has(n)?M2("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Wn=(n,e,t,r)=>(Lg(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),bU=(n,e,t)=>(Lg(n,e,"access private method"),t),Uc,qc,ua,da,Yc,ha,fa,pa,Kc,dp,T2;class wU{constructor(e){var t,r,s,i;Hn(this,dp),Hn(this,Uc),Hn(this,qc),Hn(this,ua),Hn(this,da),Hn(this,Yc),Hn(this,ha),Hn(this,fa),Hn(this,pa),Hn(this,Kc),Wn(this,ha,!1),this.onShow=()=>{},this.onHide=()=>{},Wn(this,Kc,(o,a)=>{var b,_,M;const{state:l,composing:c}=o,{selection:u,doc:d}=l,{ranges:h}=u,f=Math.min(...h.map(k=>k.$from.pos)),p=Math.max(...h.map(k=>k.$to.pos)),m=a&&a.doc.eq(d)&&a.selection.eq(u);if(rn(this,ha)||(((_=(b=rn(this,Yc))!=null?b:o.dom.parentElement)!=null?_:document.body).appendChild(this.element),Wn(this,ha,!0)),c||m)return;if(!rn(this,qc).call(this,o,a)){this.hide();return}I0({getBoundingClientRect:()=>_m(o,f,p)},this.element,{placement:(M=rn(this,da).placement)!=null?M:"top",middleware:[N0(),P0(rn(this,fa)),R0(rn(this,pa)),...rn(this,ua)]}).then(({x:k,y:C})=>{Object.assign(this.element.style,{left:"".concat(k,"px"),top:"".concat(C,"px")})}).catch(console.error),this.show()}),this.update=(o,a)=>{vU(rn(this,Kc),rn(this,Uc))(o,a)},this.destroy=()=>{},this.show=o=>{this.element.dataset.show="true",o&&I0(o,this.element,{placement:"top",middleware:[N0(),P0(rn(this,fa)),R0(rn(this,pa)),...rn(this,ua)],...rn(this,da)}).then(({x:a,y:l})=>{Object.assign(this.element.style,{left:"".concat(a,"px"),top:"".concat(l,"px")})}).catch(console.error),this.onShow()},this.hide=()=>{this.element.dataset.show!=="false"&&(this.element.dataset.show="false",this.onHide())},this.element=e.content,Wn(this,Uc,(t=e.debounce)!=null?t:200),Wn(this,qc,(r=e.shouldShow)!=null?r:bU(this,dp,T2)),Wn(this,fa,e.offset),Wn(this,pa,e.shift),Wn(this,ua,(s=e.middleware)!=null?s:[]),Wn(this,da,(i=e.floatingUIOptions)!=null?i:{}),Wn(this,Yc,e.root),this.element.dataset.show="false"}}Uc=new WeakMap;qc=new WeakMap;ua=new WeakMap;da=new WeakMap;Yc=new WeakMap;ha=new WeakMap;fa=new WeakMap;pa=new WeakMap;Kc=new WeakMap;dp=new WeakSet;T2=function(n){const{doc:e,selection:t}=n.state,{empty:r,from:s,to:i}=t,o=!e.textBetween(s,i).length&&n.state.selection instanceof we,a=this.element.contains(document.activeElement),l=!n.hasFocus()&&!a,c=!n.editable;return!(l||r||o||c)};function zg(n){const e=tn({},"".concat(n,"_TOOLTIP_SPEC")),t=vn(s=>{const i=s.get(e.key);return new Lt({key:new Dt("".concat(n,"_TOOLTIP")),...i})}),r=[e,t];return r.key=e.key,r.pluginKey=t.key,e.meta={package:"@milkdown/plugin-tooltip",displayName:"Ctx<tooltipSpec>|".concat(n)},t.meta={package:"@milkdown/plugin-tooltip",displayName:"Prose<tooltip>|".concat(n)},r}const Bg=tn(null,"tableTooltip"),B0=zg("TABLE"),_U=["draggable"],kU=B({__name:"TableSelectorWidget",setup(n){var m;const{spec:e}=mF(),t=e==null?void 0:e.type,r=(m=e==null?void 0:e.index)!=null?m:0,[s,i]=cl(),o=$(null),a=$(!1),l=A(()=>"absolute bg-grey-200 "+(a.value?"border border-blue-400 border-2":"")),c=A(()=>t==="left"?"w-1w h-100 left-n3-5v top-0 fr-py-1v":t==="top"?"right-px h-1w w-100 left-0 top-n3-5v":"h-3v w-3v left-n2w top-n2w rounded-circle");function u(g){g.stopPropagation();const b=o.value;if(!b||s.value)return;i().action(M=>{var x;const k=M.get(Bg.key);(x=k==null?void 0:k.getInstance())==null||x.setProps({getReferenceClientRect:()=>b.getBoundingClientRect()}),k==null||k.show();const C=M.get(ve);t==="left"?C.call(kg.key,r):t==="top"?C.call(xg.key,r):C.call(Cg.key)})}function d(g){g.stopPropagation();const b={index:e==null?void 0:e.index,type:e==null?void 0:e.type};g.dataTransfer&&(g.dataTransfer.setData("application/milkdown-table-sort",JSON.stringify(b)),g.dataTransfer.effectAllowed="move")}function h(g){a.value=!0,g.stopPropagation(),g.preventDefault(),g.dataTransfer&&(g.dataTransfer.dropEffect="move")}function f(){a.value=!1}function p(g){var M,k;if(a.value=!1,t==="top-left")return;const b=e==null?void 0:e.index;if(s.value||b==null)return;const _=(k=(M=g.dataTransfer)==null?void 0:M.getData("application/milkdown-table-sort"))!=null?k:"";try{const{index:C,type:x}=JSON.parse(_);i().action(O=>{const E=O.get(ve),R={from:Number(C),to:b};E.call(x==="left"?wg.key:_g.key,R)})}catch(C){}}return(g,b)=>(w(),S("button",{ref_key:"containerRef",ref:o,draggable:y(t)!=="top-left",class:ue(["table-selector block fr-p-0",c.value+" "+l.value]),onClick:u,onDragstart:d,onDragover:h,onDragleave:f,onDrop:p},null,42,_U))}});const xU=$e(kU,[["__scopeId","data-v-e26c3559"]]);function CU(n){return vn(()=>{const e=new Dt("MILKDOWN_TABLE_SELECTOR");return new Lt({key:e,state:{init(){return{decorations:Ue.empty,pos:0}},apply(t,r,s,i){const o=Ws(0,t.selection);if(!o)return{decorations:Ue.empty,pos:0};const a=js(0,t.selection);if(!a)return{decorations:Ue.empty,pos:0};const l=n({as:"div",component:xU}),[c]=o;if(!c)return{decorations:Ue.empty,pos:0};const u=[];return u.push(l(c.pos+1,{type:"top-left"})),o.forEach((d,h)=>{u.push(l(d.pos+1,{type:"left",index:h}))}),a.forEach((d,h)=>{u.push(l(d.pos+1,{type:"top",index:h}))}),r.pos===c.pos&&s.doc.eq(i.doc)?r:{decorations:Ue.create(t.doc,u),pos:c.pos}}},props:{decorations(t){return e.getState(t).decorations}}})})}const Nd=tn(null,"linkEditTooltip"),go=tn({from:-1,to:-1,mark:null},"linkTooltipStateCtx"),O2=zg("LINK_EDIT"),D2=xe("InsertLink",n=>()=>()=>$2(n));function $2(n){var s;const e=n.get(Dr),{selection:t}=e.state;if(t.empty)return!1;n.update(go.key,()=>({from:t.from,to:t.to,mark:null})),e.dispatch(e.state.tr.setSelection(we.create(e.state.doc,t.from,t.to)));const r=n.get(Nd.key);return(s=r==null?void 0:r.getInstance())==null||s.setProps({getReferenceClientRect:()=>_m(e,t.from,t.to)}),r==null||r.show(),!0}const SU=[Nd,O2,go,D2].flat();function MU(n,e){const t=()=>Xc(n()),r=$(null);return{tooltipProvider:r,setTooltipProvider:i=>{r.value=i;const o=t();o!=null&&o.ctx&&o.ctx.isInjected(e)&&(o.ctx.set(e,i),r.value=i)}}}function Fg(n,e){const{view:t}=dd(),[r,s]=cl(),{tooltipProvider:i,setTooltipProvider:o}=MU(s,n);return et([e,r,i,t],([a,l,c,u],[d,h,f,p],m)=>{if(a&&!l&&!c&&u&&u.state){const g=qs(a);if(g instanceof HTMLElement){const b=new wU({content:g,tippyOptions:{zIndex:30},shouldShow:()=>!1});b.update(u),o(b)}m(()=>f==null?void 0:f.destroy())}}),{tooltipProvider:i}}const TU={},OU={class:"bg-white border border-default-grey fr-py-1w fr-px-3v rounded-xxs drop-shadow fr-grid-row fr-grid-row--middle no-wrap"};function DU(n,e){return w(),S("div",OU,[Ye(n.$slots,"default")])}const E2=$e(TU,[["render",DU]]);function $U(n,e,t){const r=n.state.tr;t&&r.removeMark(n.state.selection.from,n.state.selection.to,t),r.addMark(n.state.selection.from,n.state.selection.to,e),n.dispatch(r)}function EU(n,e,t,r){const s=n.state.tr;r&&s.removeMark(e,t,r),n.dispatch(s)}function AU(){const n=$("");xt(A2,n)}function Vg(){const n=ct(A2);return{link:zu(n),updateLink(e){n.value=e}}}const A2=Symbol(),PU=["placeholder","onKeydown"],RU=B({__name:"LinkEditTooltip",setup(n){const{t:e}=Te(),t=$(null),{link:r,updateLink:s}=Vg(),i=$("");It(()=>{i.value=r.value});const{view:o}=dd(),[a,l]=cl(),{tooltipProvider:c}=Fg(Nd.key,t);function u(){var f;s(""),(f=c.value)==null||f.hide()}function d(){const f=Xc(l());if(!f)return;const{mark:p}=f.ctx.get(go.key),m=hs.type(f.ctx);if(p&&p.attrs.href===i.value){u();return}$U(o.value,m.create({href:i.value}),p),u()}function h(f){f.key==="Escape"&&u()}return(f,p)=>(w(),Y(E2,{ref_key:"toolTipRef",ref:t},{default:q(()=>[yt(v("input",{class:"input-area",placeholder:y(e)("Paste link..."),ref:"linkInput",onKeydown:[fp(Se(d,["stop","prevent"]),["enter"]),h],"onUpdate:modelValue":p[0]||(p[0]=m=>i.value=m)},null,40,PU),[[fs,i.value]]),v("button",{class:ue(["fr-ml-1w fr-button fr-btn--sm fr-btn--tertiary-no-outline",{"fr-hidden":i.value.length===0}]),onClick:d},T(y(e)("Confirm ⏎")),3)]),_:1},512))}});function NU(n){const e=fm();n.set(O2.key,{view:e({component:RU})})}const Iu=tn(null,"linkPreviewTooltip"),Lu=zg("LINK_PREVIEW"),IU=[Iu,Lu].flat(),LU={class:"text-overflow-ellipsis"},zU=["href"],BU=["title"],FU=B({__name:"LinkPreviewTooltip",setup(n){const{t:e}=Te(),t=$(null),{tooltipProvider:r}=Fg(Iu.key,t),{view:s}=dd(),[i,o]=cl(),{link:a}=Vg();function l(){var f;const u=Xc(o());if(!u)return;const{from:d,to:h}=u.ctx.get(go.key);(f=r.value)==null||f.hide(),s.value.dispatch(s.value.state.tr.setSelection(we.create(s.value.state.doc,d,h))),$2(u.ctx)}function c(){var p;const u=Xc(o());if(!u)return;const{from:d,to:h,mark:f}=u.ctx.get(go.key);f&&EU(s.value,d,h,f),(p=r.value)==null||p.hide()}return(u,d)=>(w(),Y(E2,{ref_key:"toolTipRef",ref:t,class:ue({"fr-hidden":y(a).length===0})},{default:q(()=>[d[0]||(d[0]=v("span",{"aria-hidden":"true",class:"fr-icon-link fr-mr-1w"},null,-1)),v("div",LU,[v("a",{class:"fr-link",href:y(a)},T(y(a)),9,zU)]),v("button",{class:"fr-btn fr-btn--secondary fr-btn--sm fr-icon-pencil-line fr-mx-1w",onClick:l},T(y(e)("Edit link")),1),v("button",{class:"fr-btn fr-btn--tertiary fr-btn--sm fr-icon-link-unlink",title:y(e)("Remove link"),onClick:c},T(y(e)("Remove link")),9,BU)]),_:1},8,["class"]))}});function VU(n,e,t,r){let s={start:-1,end:-1};return e.nodesBetween(t,r,(i,o)=>{if(s.start>-1)return!1;s.start===-1&&n.isInSet(i.marks)&&(s={start:o,end:o+Math.max(i.textContent.length,1)})}),s}function HU(n,e){return n.marks.find(t=>t.type===e)}function WU(n,e){const t=e.posAtCoords(n);if(!t)return{node:null,pos:null};const{pos:r}=t;return{node:e.state.doc.nodeAt(r),pos:r}}function jU(n,e,t){const{node:r,pos:s}=WU({left:t.clientX,top:t.clientY},e);if(!r)return;const i=HU(r,hs.mark.type(n));if(!(!i||!Lu.pluginKey()))return{show:!0,pos:s,node:r,mark:i}}const F0=200;function UU(n,e){const t=fm(),r=$(!1),s=()=>{r.value=!0},i=()=>{r.value=!1},o=td((l,c)=>{var h,f,p;if(!l.hasFocus())return;const u=jU(n,l,c),d=n.get(Iu.key);if(u){const m=l.state.doc.resolve(u.pos),g=VU(u.mark,l.state.doc,m.before(),m.after()),b=n.get(Lu.key);if(!b||!b.view)return;(h=d==null?void 0:d.getInstance())==null||h.setProps({getReferenceClientRect:()=>_m(l,g.start,g.end)}),n.update(go.key,()=>({from:g.start,to:g.end,mark:u.mark})),e(u.mark.attrs.href),d==null||d.show(),(f=d==null?void 0:d.getInstance())==null||f.popper.addEventListener("mouseenter",s),(p=d==null?void 0:d.getInstance())==null||p.popper.addEventListener("mouseleave",i);return}a()},F0),a=()=>{setTimeout(()=>{var u,d,h;if(r.value)return;const l=n.get(Iu.key),c=n.get(Nd.key);l==null||l.hide(),(u=c==null?void 0:c.getInstance())!=null&&u.state.isVisible||e(""),(d=l==null?void 0:l.getInstance())==null||d.popper.removeEventListener("mouseenter",s),(h=l==null?void 0:l.getInstance())==null||h.popper.removeEventListener("mouseleave",i)},F0)};n.set(Lu.key,{props:{handleDOMEvents:{mousemove:o,mouseleave:a}},view:t({component:FU})})}const qU='<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M3 6H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 14H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M6 10L18 10" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M6 18L18 18" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',YU='<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M3 10L17 10" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 6H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 18L17 18" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 14H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',KU='<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M7 10L21 10" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 6H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M7 18L21 18" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 14H21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',GU=["innerHTML"],Ir=B({__name:"TooltipButton",props:{icon:{},svg:{}},emits:["click"],setup(n,{emit:e}){const t=n,r=t.icon?t.icon:"fr-icon-svg",s=e;return(i,o)=>(w(),S("button",{class:ue(["fr-btn fr-btn--secondary fr-btn--sm bg-white",y(r)]),onClick:o[0]||(o[0]=a=>s("click"))},[i.svg?(w(),S("div",{key:0,innerHTML:i.svg},null,8,GU)):I("",!0),Ye(i.$slots,"default")],2))}}),JU={class:"fr-hidden"},XU=B({__name:"TableTooltip",setup(n){const{t:e}=Te(),t=$(null),{view:r}=dd(),[s,i]=cl(),{tooltipProvider:o}=Fg(Bg.key,t),a=A(()=>r.value.state.selection instanceof Ge&&r.value.state.selection.isRowSelection()),l=A(()=>r.value.state.selection instanceof Ge&&r.value.state.selection.isColSelection()),c=A(()=>a.value&&l.value),u=A(()=>a.value||l.value),d=A(()=>{var h;return a.value&&((h=r.value.state.doc.nodeAt(r.value.state.selection.$headCell.pos))==null?void 0:h.type.name)==="table_header"});return(h,f)=>(w(),S("div",JU,[v("div",{class:"fr-grid-row",ref_key:"toolTipRef",ref:t},[!c.value&&!d.value&&a.value?(w(),Y(Ir,{key:0,icon:"fr-icon-arrow-up-line",class:"fr-mr-1v",title:y(e)("Add row before"),onClick:f[0]||(f[0]=()=>{var p,m;y(s)||((p=y(i)())==null||p.action(g=>{g.get(y(ve)).call(y(Og).key)}),(m=y(o))==null||m.hide())})},null,8,["title"])):I("",!0),!c.value&&l.value?(w(),Y(Ir,{key:1,icon:"fr-icon-arrow-left-line",class:"fr-mr-1v",title:y(e)("Add column before"),onClick:f[1]||(f[1]=()=>{var p,m;y(s)||((p=y(i)())==null||p.action(g=>{g.get(y(ve)).call(y(Mg).key)}),(m=y(o))==null||m.hide())})},null,8,["title"])):I("",!0),c.value||!d.value&&u.value?(w(),Y(Ir,{key:2,icon:"fr-icon-delete-line",class:"fr-mr-1v",title:y(e)("Delete selected cells"),onClick:f[2]||(f[2]=()=>{var p,m;y(s)||((p=y(i)())==null||p.action(g=>{g.get(y(ve)).call(y(Sg).key)}),(m=y(o))==null||m.hide())})},null,8,["title"])):I("",!0),!c.value&&a.value?(w(),Y(Ir,{key:3,icon:"fr-icon-arrow-down-line",class:"fr-mr-1v",title:y(e)("Add row after"),onClick:f[3]||(f[3]=()=>{var p,m;y(s)||((p=y(i)())==null||p.action(g=>{g.get(y(ve)).call(y(Dg).key)}),(m=y(o))==null||m.hide())})},null,8,["title"])):I("",!0),!c.value&&l.value?(w(),S(J,{key:4},[P(Ir,{icon:"fr-icon-arrow-right-line",class:"fr-mr-1v",title:y(e)("Add column after"),onClick:f[4]||(f[4]=()=>{var p,m;y(s)||((p=y(i)())==null||p.action(g=>{g.get(y(ve)).call(y(Tg).key)}),(m=y(o))==null||m.hide())})},null,8,["title"]),P(Ir,{svg:y(YU),class:"fr-mr-1v",title:y(e)("Align left"),onClick:f[5]||(f[5]=()=>{var p;y(s)||(p=y(i)())==null||p.action(m=>{m.get(y(ve)).call(y(Ea).key,"left")})})},null,8,["svg","title"]),P(Ir,{class:"fr-mr-1v",svg:y(qU),title:y(e)("Align center"),onClick:f[6]||(f[6]=()=>{var p;y(s)||(p=y(i)())==null||p.action(m=>{m.get(y(ve)).call(y(Ea).key,"center")})})},null,8,["svg","title"]),P(Ir,{class:"fr-mr-1v",svg:y(KU),title:y(e)("Align right"),onClick:f[7]||(f[7]=()=>{var p;y(s)||(p=y(i)())==null||p.action(m=>{m.get(y(ve)).call(y(Ea).key,"right")})})},null,8,["svg","title"])],64)):I("",!0)],512)]))}});const QU={class:"editor__container"},ZU={class:"fr-mx-auto fr-grid-row fr-pb-1v",role:"menubar"},eq={role:"group",class:"fr-pr-1w"},tq={role:"group",class:"fr-pr-1w"},nq={role:"group",class:"fr-px-1w"},rq={role:"group",class:"fr-pl-1w"},sq={class:"fr-p-1v"},iq=B({__name:"InternalEditor",props:{ariaLabel:{},ariaLabelledBy:{},id:{},disabled:{type:Boolean,default:!1},value:{default:""}},emits:["change","editorMounted"],setup(n,{emit:e}){const t=n,r=e,s=td(f=>r("change",f),300),{t:i}=Te(),o=fm(),a=gF(),{updateLink:l}=Vg(),c=Lh.findIndex(f=>f===u2);Lh[c]=Cj;const u=[Lh,B0,Bg,f=>async()=>{f.set(B0.key,{view:o({component:XU})})},CU(a)].flat(),d=xL(f=>FV.make().config(p=>{p.set(Vc,f),NU(p),UU(p,l),p.set(Lc,t.value),p.set(kd.key,m=>{const g=m.attrs.level;return g===1?{class:"fr-h1"}:g===2?{class:"fr-h2"}:g===3?{class:"fr-h3"}:g===4?{class:"fr-h4"}:g===5?{class:"fr-h5"}:g===6?{class:"fr-h6"}:{}}),p.update(Fc,m=>{const g=m.attributes;return{...m,attributes:b=>{const _=typeof g=="function"?g(b):g!=null?g:{};return _.id=t.id,_["data-testid"]="markdown-editor",t.ariaLabelledBy?_["aria-labelledby"]=t.ariaLabelledBy:t.ariaLabel&&(_.ariaLabel=t.ariaLabel),{..._}},editable:()=>!t.disabled}}),p.set(wd.key,()=>({class:"text-lg"})),p.get(Du).markdownUpdated((m,g,b)=>s(g)),p.get(Du).mounted(m=>{r("editorMounted")})}).use(UH).use(u).use(nH).use(SU).use(IU).use(bx));function h(f,p){var m;return(m=d.get())==null?void 0:m.action(tH(f,p))}return(f,p)=>(w(),S("div",QU,[v("div",ZU,[v("div",eq,[P(on,{icon:"fr-icon-arrow-go-back-line",onClick:p[0]||(p[0]=()=>h(y(md).key)),title:y(i)("Undo")},null,8,["title"]),P(on,{icon:"fr-icon-arrow-go-forward-line",onClick:p[1]||(p[1]=()=>h(y(gd).key)),title:y(i)("Redo")},null,8,["title"])]),p[13]||(p[13]=v("div",{role:"separator",class:"w-1px bg-grey-125 fr-my-1v"},null,-1)),v("div",tq,[P(on,{icon:"fr-icon-bold",onClick:p[2]||(p[2]=()=>h(y(vd).key)),title:y(i)("Bold")},null,8,["title"]),P(on,{icon:"fr-icon-italic",onClick:p[3]||(p[3]=()=>h(y(yd).key)),title:y(i)("Italic")},null,8,["title"]),P(on,{icon:"fr-icon-h-1",onClick:p[4]||(p[4]=()=>h(y(Gn).key,3)),title:y(i)("Title")},null,8,["title"]),P(on,{icon:"fr-icon-h-2",onClick:p[5]||(p[5]=()=>h(y(Gn).key,4)),title:y(i)("Subtitle")},null,8,["title"])]),p[14]||(p[14]=v("div",{role:"separator",class:"w-1px bg-grey-125 fr-my-1v"},null,-1)),v("div",nq,[P(on,{icon:"fr-icon-table-2",onClick:p[6]||(p[6]=()=>h(y(bg).key)),title:y(i)("Table")},null,8,["title"]),P(on,{icon:"fr-icon-link",onClick:p[7]||(p[7]=()=>h(y(D2).key)),title:y(i)("Link")},null,8,["title"]),P(kj,{onSend:p[8]||(p[8]=m=>h(y(Hm).key,m))})]),p[15]||(p[15]=v("div",{role:"separator",class:"w-1px bg-grey-125 fr-my-1v"},null,-1)),v("div",rq,[P(on,{icon:"fr-icon-list-unordered",onClick:p[9]||(p[9]=()=>h(y(Sd).key)),title:y(i)("List unordered")},null,8,["title"]),P(on,{icon:"fr-icon-list-ordered",onClick:p[10]||(p[10]=()=>h(y(Md).key)),title:y(i)("List ordered")},null,8,["title"]),P(on,{icon:"fr-icon-code-s-slash-line",onClick:p[11]||(p[11]=()=>h(y(Cd).key)),title:y(i)("Code block")},null,8,["title"]),P(on,{icon:"fr-icon-quote-line",onClick:p[12]||(p[12]=()=>h(y(xd).key)),title:y(i)("Quote")},null,8,["title"])])]),v("div",sq,[P(y(_L))])]))}}),oq=B({__name:"MarkdownEditor",props:{ariaLabel:{},ariaLabelledBy:{},id:{},disabled:{type:Boolean},value:{}},emits:["change","editorMounted"],setup(n){const e=n;return AU(),(t,r)=>(w(),Y(y(kL),null,{default:q(()=>[P(y(bF),null,{default:q(()=>[P(iq,rr(e,{onChange:r[0]||(r[0]=s=>t.$emit("change",s)),onEditorMounted:r[1]||(r[1]=s=>t.$emit("editorMounted"))}),null,16)]),_:1})]),_:1}))}}),aq=["for"],lq={key:0,class:"fr-hint-text"},cq=["aria-describedby","id","disabled","type","value","placeholder","required"],uq={key:1,class:"fr-mt-1w"},dq=["aria-describedby","id","disabled","type","placeholder","value","required"],hq=["id"],fq=["id"],Gc=B({__name:"InputGroup",props:{ariaDescribedby:{default:""},disabled:{type:Boolean,default:!1},errorText:{default:""},hasError:{type:Boolean,default:!1},hasWarning:{type:Boolean,default:!1},hintText:{default:""},isValid:{type:Boolean,default:!1},label:{},modelValue:{default:void 0},placeholder:{default:""},required:{type:Boolean,default:!1},type:{default:"text"},validText:{default:""}},emits:["change","update:modelValue"],setup(n,{expose:e,emit:t}){const r=t,s=n,{id:i}=bo("input");e({id:i});const o=A(()=>i+"-desc-error"),a=A(()=>i+"-desc-valid"),l=A(()=>{let h=s.ariaDescribedby?s.ariaDescribedby+" ":"";return s.isValid?h+=a.value:s.hasError&&(h+=o.value),h}),c=A(()=>({"fr-input-group--disabled":s.disabled,"fr-input-group--error":s.hasError,"fr-input-group--warning":!s.hasError&&s.hasWarning,"fr-input-group--valid":s.isValid})),u=K0(mp);function d(h){let f;if(h instanceof Event){const p=h.target;f=p==null?void 0:p.value}else f=h;r("update:modelValue",f),r("change",f)}return(h,f)=>(w(),S("div",{class:ue(["fr-input-group",c.value])},[v("label",{class:"fr-label",for:y(i)},[U(T(h.label)+" ",1),P(Up,{required:h.required},null,8,["required"]),h.hintText?(w(),S("span",lq,T(h.hintText),1)):I("",!0)],8,aq),h.type==="textarea"?(w(),S("textarea",{key:0,class:ue(["fr-input",{"fr-input--error":h.hasError,"fr-input--warning":!h.hasError&&y(Mf),"fr-input--valid":h.isValid}]),"aria-describedby":l.value,id:y(i),disabled:h.disabled,type:h.type,value:h.modelValue,placeholder:h.placeholder,onChange:d,required:h.required},null,42,cq)):h.type==="date"?(w(),S("div",uq,[P(y(p_),{class:ue(["fr-input",{"fr-input--error":h.hasError,"fr-input--valid":h.isValid}]),"aria-describedby":l.value,id:y(i),disabled:h.disabled,modelValue:h.modelValue,onChange:d,locale:y(u),inputFormat:"P"},null,8,["class","aria-describedby","id","disabled","modelValue","locale"])])):h.type==="range"?(w(),Y(bL,{key:2,modelValue:h.modelValue,onChange:d},null,8,["modelValue"])):h.type==="markdown"?(w(),Y(oq,{key:3,class:ue(["fr-mt-1w",{"fr-input--error":h.hasError,"fr-input--warning":!h.hasError&&y(Mf),"fr-input--valid":h.isValid}]),"aria-describedby":l.value,id:y(i),disabled:h.disabled,value:h.modelValue,placeholder:h.placeholder,onChange:d,required:h.required},null,8,["class","aria-describedby","id","disabled","value","placeholder","required"])):(w(),S("input",{key:4,class:ue(["fr-input",{"fr-input--error":h.hasError,"fr-input--valid":h.isValid}]),"aria-describedby":l.value,id:y(i),disabled:h.disabled,type:h.type,placeholder:h.placeholder,value:h.modelValue,onChange:d,required:h.required},null,42,dq)),h.isValid?(w(),S("p",{key:5,id:a.value,class:"fr-valid-text"},T(h.validText),9,hq)):h.hasError?(w(),S("p",{key:6,id:o.value,class:"fr-error-text"},T(h.errorText),9,fq)):I("",!0)],2))}}),pq=["aria-labelledby","id"],mq={class:"fr-container fr-container--fluid fr-container-md"},gq={class:"fr-grid-row fr-grid-row--center"},yq={class:"fr-col-12 fr-col-md-8"},vq={class:"fr-modal__body"},bq={class:"fr-modal__header"},wq=["title","aria-controls","disabled"],_q={class:"fr-modal__content"},kq=["id"],xq=["href"],Cq={class:"fr-modal__footer"},Sq={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-lg fr-btns-group--icon-left"},Mq=["aria-controls"],Tq={class:"fr-modal__content"},Oq=["id"],Dq=["href"],$q={class:"fr-modal__footer"},Eq={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-lg fr-btns-group--icon-left"},Aq=["aria-controls","disabled"],Pq=B({__name:"ReportModal",props:{id:{},loading:{type:Boolean},succeeded:{type:Boolean}},emits:["send"],setup(n,{emit:e}){const t=e,{t:r}=Te(),s=xi("modal-title"),i=$(),o={reason:"",message:""},a=ki({...o}),l=$([]),c={reason:{required:jh},message:{required:jh}},{getErrorText:u,getFunctionalState:d,hasError:h,reset:f,validateRequiredRules:p,v$:m}=f_(a,c,c),g=k=>h(b,k),b=A(()=>({reason:d(m.value.reason.$dirty,m.value.reason.$error,!1),message:d(m.value.message.$dirty,m.value.message.$error,!1)}));function _(){globalThis.dsfr(i.value).modal.conceal(),a.message=o.message,a.reason=o.reason,f()}function M(){p().then(k=>{k&&t("send",{...a})})}return Ve(async()=>{l.value=await uI()}),(k,C)=>{const x=dt("i18n-t");return w(),Y(ws,{to:"body"},[v("dialog",rr(k.$attrs,{"aria-labelledby":y(s),id:k.id,role:"dialog",class:"fr-modal",ref_key:"modalRef",ref:i}),[v("div",mq,[v("div",gq,[v("div",yq,[v("div",vq,[v("div",bq,[v("button",{class:"fr-btn--close fr-btn",title:y(r)("Close the modal dialog"),"aria-controls":k.id,target:"_self",disabled:k.loading,onClick:_},T(y(r)("Close")),9,wq)]),k.succeeded?(w(),S(J,{key:0},[v("div",_q,[v("h2",{id:y(s),class:"fr-mb-2w"},[C[2]||(C[2]=v("span",{class:"fr-icon-success-line fr-icon--lg"},null,-1)),U(T(y(r)("Thanks for reporting this content")),1)],8,kq),P(x,{keypath:"{site} team will examine the content to check if it breaks our {markup}. Thanks for your help.",tag:"p",class:"fr-mt-0 fr-mb-1w fr-text--xs",scope:"global"},{site:q(()=>[U(T(y(G0)),1)]),markup:q(()=>[v("a",{href:y(ny)},T(y(r)("usage policy")),9,xq)]),_:1})]),v("div",Cq,[v("div",Sq,[v("button",{class:"fr-btn","aria-controls":k.id,target:"_self",onClickCapture:Se(_,["prevent","stop"])},T(y(r)("Close")),41,Mq)])])],64)):(w(),S(J,{key:1},[v("div",Tq,[v("h2",{id:y(s),class:"fr-mb-2w"},T(y(r)("Report this content")),9,Oq),P(y(nu),{class:"fr-mb-2w",color:"warning",weight:"regular"},{default:q(()=>[C[3]||(C[3]=v("span",{class:"fr-icon-warning-line fr-mr-1v","aria-hidden":"true"},null,-1)),U(" "+T(y(r)("Please only report in case of serious concern."))+" ",1),v("a",{href:y(ny)},T(y(r)("See our usage policy")),9,Dq)]),_:1}),P(PI,{label:y(r)("Report reason"),required:!0,modelValue:a.reason,"onUpdate:modelValue":C[0]||(C[0]=D=>a.reason=D),hasError:g("reason"),errorText:y(u)("reason"),options:l.value},null,8,["label","modelValue","hasError","errorText","options"]),P(Gc,{type:"textarea",label:y(r)("Message"),required:!0,hasError:g("message"),errorText:y(u)("message"),modelValue:a.message,"onUpdate:modelValue":C[1]||(C[1]=D=>a.message=D),placeholder:y(r)("Reason of your report.{newline}Don't include any personal data.")},null,8,["label","hasError","errorText","modelValue","placeholder"])]),v("div",$q,[v("div",Eq,[v("button",{class:"fr-btn","aria-controls":k.id,target:"_self",disabled:k.loading,onClickCapture:Se(M,["prevent","stop"])},T(y(r)("Send")),41,Aq)])])],64))])])])])],16,pq)])}}}),Rq=["aria-controls","disabled","title"],Nq=B({__name:"ReportModalButton",props:{objectType:{},objectId:{}},setup(n){const e=n,{t}=Te(),{toast:r}=Mn(),s=$(!1),i=$(!1),o=xi();async function a(l){try{s.value=!0,await dI(e.objectType,e.objectId,l.reason,l.message),i.value=!0}catch(c){r.error(t("An unexpected error occured while reporting this content."))}finally{s.value=!1}}return(l,c)=>(w(),S(J,null,[v("button",rr({class:"fr-btn fr-btn--sm fr-btn--secondary fr-btn--secondary-grey-500 fr-icon-flag-line","data-fr-opened":"false","aria-controls":y(o)},l.$attrs,{disabled:s.value,title:y(t)("Make a report")}),T(y(t)("Make a report")),17,Rq),P(Pq,{id:y(o),loading:s.value,succeeded:i.value,onSend:a},null,8,["id","loading","succeeded"])],64))}}),Iq={class:"fr-grid-row fr-grid-row--middle justify-between","data-cy":"search"},Lq={class:"fr-search-bar fr-search-bar--lg w-100"},zq=["for"],Bq=["id","aria-label","placeholder"],Fq={class:"fr-btn",type:"submit"},Vq={class:"fr-grid-row fr-mt-1w fr-mt-md-5v"},Hq={class:"fr-col-12 fr-col-md-4 fr-col-lg-3"},Wq={class:"fr-sidemenu","aria-labelledby":"fr-sidemenu-title"},jq={class:"fr-sidemenu__inner"},Uq={class:"fr-sidemenu__btn fr-mt-1w",hidden:"","aria-controls":"fr-sidemenu-wrapper","aria-expanded":"false"},qq={class:"fr-collapse",id:"fr-sidemenu-wrapper"},Yq={class:"fr-sidemenu__title fr-mb-3v",id:"fr-sidemenu-title"},Kq={class:"fr-grid-row fr-grid-row--gutters"},Gq={key:0,class:"fr-col-12"},Jq={class:"fr-col-12"},Xq={class:"fr-select-group"},Qq=["for"],Zq=["id"],eY={value:null},tY={value:!1},nY={value:!0},rY={key:1,class:"fr-col-12 fr-mb-3w text-align-center"},sY={class:"fr-col-12 fr-col-md-8 fr-col-lg-9 fr-mt-2w fr-mt-md-0 search-results"},iY={key:0},oY={key:1,class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle justify-between fr-pb-1w"},aY={class:"fr-col-auto fr-my-0",role:"status"},lY={key:2},cY={class:"fr-mt-1w border-default-grey border-top relative z-2"},uY={key:3,class:"fr-mt-2w"},dY=B({__name:"DataservicesSearch",props:{organization:{default:""}},setup(n){const e=n,{t}=Te(),{toast:r}=K3(),s=$(null);et(s,()=>a.value=1);const i=$(null);et(i,()=>a.value=1);const o=Qg(),a=$(1),l=A(()=>s.value||i.value!==null),c=()=>{s.value="",i.value=null},u=()=>{h.value="",c(),m()},d=Qg(),h=$(""),f=HS(h,500),p=q2("searchInputRef"),m=()=>{p.value&&p.value.scrollIntoView({behavior:"smooth"})},g=A(()=>{const O={};return s.value&&(O.organization=s.value),f.value&&(O.q=f.value),i.value!==null&&(O.is_restricted=i.value.toString()),e.organization&&(O.organization=e.organization),a.value&&a.value!==1&&(O.page=a.value.toString()),new URLSearchParams(O)}),{ignoreUpdates:b}=WS(g,()=>{let O=new URL(window.location.href);O.search=g.value.toString(),window.history.pushState(null,"",O)}),_=A(()=>"/dataservices/search/?".concat(g.value)),M=$(null),k=$(null);et(h,()=>{k.value&&k.value.abort(),a.value=1});const C=async()=>{M.value=null,k.value=new AbortController;try{const O=await rl.get(_.value,{signal:k.value.signal});k.value=null,M.value=O.data}catch(O){Qn.isCancel(O)||r.error(t("Error getting search results."))}},x=()=>{const O=new URL(window.location.href);s.value=O.searchParams.get("organization"),h.value=O.searchParams.get("q")||"",O.searchParams.get("is_restricted")==="true"?i.value=!0:O.searchParams.get("is_restricted")==="false"?i.value=!1:i.value=null,a.value=parseInt(O.searchParams.get("page")||"1")};Ve(()=>{var O;x(),C(),(O=p.value)==null||O.focus(),window.addEventListener("popstate",()=>{b(()=>{x()})})}),et(_,()=>{C()});const D=O=>{a.value=O};return(O,E)=>(w(),S("form",{class:"fr-pt-3v",onSubmit:Se(C,["prevent"])},[v("div",Iq,[v("section",Lq,[v("label",{class:"fr-label",for:y(d)},T(y(t)("Search")),9,zq),yt(v("input",{id:y(d),type:"search","onUpdate:modelValue":E[0]||(E[0]=R=>h.value=R),ref:"searchInputRef",class:"fr-input","aria-label":y(t)("Search..."),placeholder:y(t)("Search..."),"data-cy":"search-input","data-testid":"search-input"},null,8,Bq),[[fs,h.value]]),v("button",Fq,T(y(t)("Search")),1)])]),v("div",Vq,[v("div",Hq,[v("nav",Wq,[v("div",jq,[v("button",Uq,T(y(t)("Filter results")),1),v("div",qq,[v("div",Yq,T(y(t)("Filters")),1),v("div",Kq,[e.organization?I("",!0):(w(),S("div",Gq,[P(vr,{placeholder:y(t)("Organizations"),searchPlaceholder:y(t)("Search an organization..."),allOption:y(t)("All organizations"),listUrl:"/organizations/?sort=-followers",suggestUrl:"/organizations/suggest/",entityUrl:"/organizations/",values:s.value,onChange:E[1]||(E[1]=R=>s.value=R),isBlue:!0},null,8,["placeholder","searchPlaceholder","allOption","values"])])),v("div",Jq,[v("div",Xq,[v("label",{class:"fr-label",for:y(o)},T(y(t)("Access terms")),9,Qq),yt(v("select",{class:ue(["fr-select",{"text-mention-grey":i.value===null}]),id:y(o),"onUpdate:modelValue":E[2]||(E[2]=R=>i.value=R)},[v("option",eY,T(y(t)("All access terms")),1),v("option",tY,T(y(t)("Open APIs to everyone")),1),v("option",nY,T(y(t)("Restricted access APIs")),1)],10,Zq),[[Bu,i.value]])])]),l.value?(w(),S("div",rY,[v("button",{class:"fr-btn fr-btn--secondary fr-icon-close-circle-line fr-btn--icon-left justify-center w-100",onClick:c},T(y(t)("Reset filters")),1)])):I("",!0)])])])])]),v("section",sY,[M.value===null?(w(),S("div",iY,[P(jp)])):I("",!0),M.value!==null?(w(),S("div",oY,[v("p",aY,T(y(t)("{count} API",M.value.total)),1)])):I("",!0),M.value!==null&&M.value.data.length?(w(),S("div",lY,[v("ul",cY,[(w(!0),S(J,null,Fe(M.value.data,R=>(w(),S("li",{key:R.id},[P(y(Nb),{dataservice:R,dataserviceUrl:R.self_web_url},null,8,["dataservice","dataserviceUrl"])]))),128))]),M.value!==null&&M.value.total>M.value.page_size?(w(),Y(y(Ci),{key:0,page:a.value,pageSize:M.value.page_size,totalResults:M.value.total,onChange:D,class:"fr-mt-2w"},null,8,["page","pageSize","totalResults"])):(w(),Y(mu,{key:1,onResetFilters:u}))])):I("",!0),M.value!==null&&M.value.data.length===0?(w(),S("div",uY,[P(mu,{onResetFilters:u})])):I("",!0)])])],32))}});pC({admin_root:mC,api_root:gC,api_2_root:yC,default_lang:Uh.global.locale.value,only_locales:Uh.global.locale.value,schema_documentation_url:vC,schema_validata_url:bC,show_copy_resource_permalink:!0,tabular_api_dataservice_id:wC,tabular_api_url:_C,tabular_page_size:kC,title:G0});const hY=n=>{const e=Y2({});xC(e),e.use(CC),e.use(l9),e.use(SC),e.use(Uh),e.component("chart",XE),e.component("dataset-resources",M9),e.component("dataset-resource-from-hash",o9),e.component("dataservice-card",Nb),e.component("dataservice-links",Z9),e.component("delete-button",wN),e.component("delete-user-button",LN),e.component("discussion-threads",SA),e.component("discussion-create",Lw),e.component("featured-button",WN),e.component("follow-button",KN),e.component("menu-search",BA),e.component("owner-type",zM),e.component("owner-type-icon",Cp),e.component("read-more",Lb),e.component("report-button",Nq),e.component("request-membership",XN),e.component("reuse-card",o_),e.component("search",lN),e.component("dataservices-search",dY),e.component("toggletip",Tp),e.component("user-dataset-list",E9),e.component("user-reuse-list",B9),e.config.compilerOptions.delimiters=["",""],e.mount(n)},fY=document.querySelectorAll(".vuejs");fY.forEach(n=>{const e=n.innerHTML;try{hY(n)}catch(t){throw n.innerHTML=e,console.log("VueJS template compilation failed for element ".concat(n.className,".\n      Aborted the process and rolled back the HTML.\n      See error(s) above and below (probably won't help you tho) :")),console.log(n),console.error(t),t}});globalThis.dsfr.start();console.log("JS is injected !");cI();export{zv as _,mY as __vite_legacy_guard,p7 as a,X as b,wH as l};
