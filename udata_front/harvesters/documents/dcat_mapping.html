<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa de Campos: evian.json para uData Database</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --primary: #2563eb;
            --primary-hover: #1d4ed8;
            --bg-color: #f1f5f9;
            --card-bg: #ffffff;
            --text-main: #1e293b;
            --text-muted: #64748b;
            --border-color: #e2e8f0;
            --code-bg: #f8fafc;
            --code-text: #0f172a;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            line-height: 1.6;
            margin: 0;
            padding: 40px 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: var(--card-bg);
            padding: 64px;
            border-radius: 16px;
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 800;
            letter-spacing: -0.04em;
            margin-top: 0;
            margin-bottom: 2rem;
            color: #0f172a;
            line-height: 1.1;
        }

        h1::after {
            content: '';
            display: block;
            width: 80px;
            height: 6px;
            background: var(--primary);
            margin-top: 1rem;
            border-radius: 3px;
        }

        h2 {
            font-size: 1.75rem;
            font-weight: 700;
            margin-top: 3.5rem;
            margin-bottom: 1.25rem;
            color: #0f172a;
            letter-spacing: -0.02em;
        }

        h3 {
            font-size: 1.35rem;
            font-weight: 600;
            margin-top: 2.5rem;
            margin-bottom: 1rem;
            color: #1e293b;
        }

        h4 {
            font-size: 1.1rem;
            font-weight: 600;
            margin-top: 1.5rem;
            color: #334155;
        }

        p {
            margin-bottom: 1.25rem;
            font-size: 1.05rem;
            color: #334155;
        }

        strong {
            color: #0f172a;
            font-weight: 600;
        }

        code {
            font-family: 'JetBrains Mono', monospace;
            background-color: var(--code-bg);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-size: 0.9em;
            border: 1px solid var(--border-color);
            color: #2563eb;
        }

        pre {
            background-color: #0f172a;
            color: #f8fafc;
            padding: 1.5rem;
            border-radius: 12px;
            overflow-x: auto;
            margin: 1.5rem 0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            box-shadow: inset 0 2px 4px 0 rgb(0 0 0 / 0.05);
        }

        pre code {
            background: transparent;
            border: none;
            padding: 0;
            color: inherit;
            font-size: inherit;
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 2.5rem 0;
            font-size: 0.95rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
        }

        th {
            background-color: #f8fafc;
            font-weight: 600;
            text-align: left;
            padding: 14px 20px;
            border-bottom: 2px solid var(--border-color);
            color: #475569;
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 0.05em;
        }

        td {
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
            vertical-align: top;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover {
            background-color: #f8fafc;
        }

        @media (max-width: 768px) {
            .container {
                padding: 32px;
            }

            h1 {
                font-size: 2rem;
            }

            table {
                display: block;
                overflow-x: auto;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Mapa de Campos: evian.json para uData Database</h1>
        <p>Este documento mapeia os campos do arquivo fonte <code>udata/harvest/tests/dcat/evian.json</code> (formato
            DCAT-AP JSON-LD) para os campos da tabela/coleção <code>datasets</code> na base de dados do uData (modelo
            <code>Dataset</code>).</p>
        <h2>Resumo do Mapeamento</h2>
        <table>
            <thead>
                <tr>
                    <th style="text-align: left;">Campo Fonte (<code>evian.json</code>)</th>
                    <th style="text-align: left;">Caminho RDF</th>
                    <th style="text-align: left;">Campo Destino (uData <code>Dataset</code>)</th>
                    <th style="text-align: left;">Notas / Lógica</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="text-align: left;"><strong>Dataset</strong></td>
                    <td style="text-align: left;"></td>
                    <td style="text-align: left;"></td>
                    <td style="text-align: left;"></td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>title</code></td>
                    <td style="text-align: left;"><code>dct:title</code></td>
                    <td style="text-align: left;"><code>title</code></td>
                    <td style="text-align: left;"></td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>description</code></td>
                    <td style="text-align: left;"><code>dct:description</code></td>
                    <td style="text-align: left;"><code>description</code></td>
                    <td style="text-align: left;">Sanitizado (HTML permitido mas limpo). Se ausente, usa
                        <code>dct:abstract</code>.</td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>identifier</code></td>
                    <td style="text-align: left;"><code>dct:identifier</code></td>
                    <td style="text-align: left;"><code>harvest.dct_identifier</code></td>
                    <td style="text-align: left;">O identificador remoto é armazenado nos metadados de harvest.</td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>landingPage</code></td>
                    <td style="text-align: left;"><code>dcat:landingPage</code></td>
                    <td style="text-align: left;"><code>harvest.remote_url</code></td>
                    <td style="text-align: left;"></td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>keyword</code></td>
                    <td style="text-align: left;"><code>dcat:keyword</code></td>
                    <td style="text-align: left;"><code>tags</code></td>
                    <td style="text-align: left;"></td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>theme</code></td>
                    <td style="text-align: left;"><code>dcat:theme</code></td>
                    <td style="text-align: left;"><code>tags</code></td>
                    <td style="text-align: left;">Os temas são misturados com as keywords nas <code>tags</code>.</td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>issued</code></td>
                    <td style="text-align: left;"><code>dct:issued</code></td>
                    <td style="text-align: left;"><code>harvest.issued_at</code></td>
                    <td style="text-align: left;">Armazenado em <code>dataset.harvest</code>. A data de criação do
                        dataset (<code>created_at</code>) pode assumir este valor se for criação.</td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>modified</code></td>
                    <td style="text-align: left;"><code>dct:modified</code></td>
                    <td style="text-align: left;"><code>harvest.modified_at</code></td>
                    <td style="text-align: left;">Armazenado em <code>dataset.harvest</code>.</td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>spatial</code></td>
                    <td style="text-align: left;"><code>dct:spatial</code></td>
                    <td style="text-align: left;"><code>spatial</code></td>
                    <td style="text-align: left;">Convertido para GeoJSON (MultiPolygon).</td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>license</code></td>
                    <td style="text-align: left;"><code>dct:license</code></td>
                    <td style="text-align: left;"><code>license</code></td>
                    <td style="text-align: left;">Tenta corresponder a uma licença existente via URL ou título. Também
                        armazenado em <code>extras.dcat.license</code>.</td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>publisher.name</code></td>
                    <td style="text-align: left;"><code>dct:publisher</code></td>
                    <td style="text-align: left;"><code>organization</code> (Contextual)</td>
                    <td style="text-align: left;">O mapeamento para a <code>organization</code> do uData geralmente
                        depende da configuração do harvester ou contexto, não é automático apenas pelo nome no JSON. Se
                        mapeado, o dataset pertence a essa organização.</td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>contactPoint</code></td>
                    <td style="text-align: left;"><code>dcat:contactPoint</code></td>
                    <td style="text-align: left;"><code>contact_points</code></td>
                    <td style="text-align: left;">Cria objetos <code>ContactPoint</code>.</td>
                </tr>
                <tr>
                    <td style="text-align: left;">&nbsp;&nbsp;<code>fn</code></td>
                    <td style="text-align: left;"><code>vcard:fn</code></td>
                    <td style="text-align: left;"><code>ContactPoint.name</code></td>
                    <td style="text-align: left;">Role: "contact".</td>
                </tr>
                <tr>
                    <td style="text-align: left;">&nbsp;&nbsp;<code>hasEmail</code></td>
                    <td style="text-align: left;"><code>vcard:hasEmail</code></td>
                    <td style="text-align: left;"><code>ContactPoint.email</code></td>
                    <td style="text-align: left;"></td>
                </tr>
                <tr>
                    <td style="text-align: left;"><strong>Distribution</strong></td>
                    <td style="text-align: left;"><code>dcat:distribution</code></td>
                    <td style="text-align: left;"><strong>Resource</strong></td>
                    <td style="text-align: left;">Item na lista <code>resources</code> do Dataset.</td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>title</code></td>
                    <td style="text-align: left;"><code>dct:title</code></td>
                    <td style="text-align: left;"><code>title</code></td>
                    <td style="text-align: left;"></td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>description</code></td>
                    <td style="text-align: left;"><code>dct:description</code></td>
                    <td style="text-align: left;"><code>description</code></td>
                    <td style="text-align: left;"></td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>accessURL</code></td>
                    <td style="text-align: left;"><code>dcat:accessURL</code></td>
                    <td style="text-align: left;"><code>url</code></td>
                    <td style="text-align: left;">URL principal do recurso.</td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>downloadURL</code></td>
                    <td style="text-align: left;"><code>dcat:downloadURL</code></td>
                    <td style="text-align: left;"><code>url</code></td>
                    <td style="text-align: left;">Se <code>accessURL</code> não existir.</td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>format</code></td>
                    <td style="text-align: left;"><code>dct:format</code></td>
                    <td style="text-align: left;"><code>format</code></td>
                    <td style="text-align: left;">Normalizado (ex: 'csv', 'json').</td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>mediaType</code></td>
                    <td style="text-align: left;"><code>dcat:mediaType</code></td>
                    <td style="text-align: left;"><code>mime</code></td>
                    <td style="text-align: left;">Ex: 'text/csv'.</td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>byteSize</code></td>
                    <td style="text-align: left;"><code>dcat:byteSize</code></td>
                    <td style="text-align: left;"><code>filesize</code></td>
                    <td style="text-align: left;"></td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>checksum</code></td>
                    <td style="text-align: left;"><code>spdx:checksum</code></td>
                    <td style="text-align: left;"><code>checksum</code></td>
                    <td style="text-align: left;">Objeto com <code>type</code> e <code>value</code>.</td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>issued</code></td>
                    <td style="text-align: left;"><code>dct:issued</code></td>
                    <td style="text-align: left;"><code>harvest.issued_at</code></td>
                    <td style="text-align: left;">No recurso.</td>
                </tr>
                <tr>
                    <td style="text-align: left;"><code>modified</code></td>
                    <td style="text-align: left;"><code>dct:modified</code></td>
                    <td style="text-align: left;"><code>harvest.modified_at</code></td>
                    <td style="text-align: left;">No recurso.</td>
                </tr>
            </tbody>
        </table>
        <h2>Detalhes Específicos</h2>
        <h3>1. Datas (<code>issued</code>, <code>modified</code>)</h3>
        <p>No uData, as datas de harvest não sobrescrevem diretamente <code>dataset.created_at_internal</code> ou
            <code>dataset.last_modified_internal</code> (que são datas de sistema), mas são armazenadas na estrutura
            <code>harvest</code>:
            - <code>dataset.harvest.issued_at</code>
            - <code>dataset.harvest.modified_at</code></p>
        <h3>2. Identificadores</h3>
        <p>O <code>identifier</code> do DCAT ("https://www.arcgis.com/...") é armazenado em
            <code>dataset.harvest.dct_identifier</code>.
            A URL de origem (<code>landingPage</code>) vai para <code>dataset.harvest.remote_url</code>.</p>
        <h3>3. Organização (<code>publisher</code>)</h3>
        <p>O campo <code>publisher</code> no JSON:</p>
        <pre><code class="language-json">&quot;publisher&quot;: {
    &quot;name&quot;: &quot;Ville d'Evian-les-Bains&quot;
}
</code></pre>
        <p>Não garante a atribuição automática à organização "Ville d'Evian-les-Bains" a menos que o backend de harvest
            (DcatBackend) consiga resolver este nome para uma organização existente na base do uData, ou se a harvest
            for executada especificamente para essa organização. O código de parsing RDF (<code>dataset_from_rdf</code>)
            usa o publisher para criar um <code>ContactPoint</code> com role="publisher".</p>
        <h3>4. Distribuições (<code>distribution</code>)</h3>
        <p>Cada item em <code>distribution</code> se torna um <code>Resource</code>.
            - O <code>accessURL</code> é preferido como a URL do recurso.
            - Metadados como <code>format</code> e <code>mediaType</code> são preenchidos.</p>
    </div>
</body>

</html>